/* Prairie Forge Payroll Recorder */
(()=>{var Es="d74b68e",he={CONFIG:"SS_PF_Config",DATA:"PR_Data",DATA_CLEAN:"PR_Data_Clean",EXPENSE_MAPPING:"PR_Expense_Mapping",EXPENSE_REVIEW:"PR_Expense_Review",JE_DRAFT:"PR_JE_Draft",ARCHIVE_SUMMARY:"PR_Archive_Summary"};var gx=[{name:"Instructions",description:"How to use the Prairie Forge payroll template"},{name:"Data_Input",description:"Paste WellsOne export data here"},{name:he.CONFIG,description:"Prairie Forge shared configuration storage (all modules)"},{name:"Config_Keywords",description:"Keyword-based account mapping rules"},{name:"Config_Accounts",description:"Account rewrite rules"},{name:"Config_Locations",description:"Location normalization rules"},{name:"Config_Vendors",description:"Vendor-specific overrides"},{name:"Config_Settings",description:"Prairie Forge system settings"},{name:he.EXPENSE_MAPPING,description:"Expense category mappings"},{name:he.DATA,description:"Processed payroll data staging"},{name:he.DATA_CLEAN,description:"Cleaned and validated payroll data"},{name:he.EXPENSE_REVIEW,description:"Expense review workspace"},{name:he.JE_DRAFT,description:"Journal entry preparation area"}];var un=[{id:0,title:"Configuration Setup",summary:"Company profile, branding, and run settings",description:"Keep the SS_PF_Config table current before every payroll run so downstream sheets inherit the right colors, links, and identifiers.",icon:"\u{1F9ED}",ctaLabel:"Open Configuration Form",statusHint:"Configuration edits happen inside the PF_Config table and are available to every step instantly.",highlights:[{label:"Company Profile",detail:"Company name, logos, payroll date, reporting period."},{label:"Brand Identity",detail:"Primary + accent colors carry through dashboards and exports."},{label:"System Links",detail:"Quick jumps to HRIS, payroll provider, accounting import, and archive folders."}],checklist:["Review profile, branding, links, and run settings each payroll cycle.","Click Save to write updates back to the SS_PF_Config sheet."]},{id:1,title:"Import Payroll Data",summary:"Paste the payroll provider export into the Data sheet",description:"Pull your payroll data from your provider\u2019s portal and paste it into the Data tab. If the columns match, just paste the rows; if they don\u2019t, paste your headers and data right over the top. Formatting is fully automated.",icon:"\u{1F4E5}",ctaLabel:"Prepare Import Sheet",statusHint:"The Data worksheet is activated so you can paste the latest provider export.",highlights:[{label:"Source File",detail:"Use WellsOne/ADP export with every pay category column visible."},{label:"Structure",detail:"Row 2 headers, row 3+ data, no blank columns, totals removed."},{label:"Quality",detail:"Spot-check employee counts and pay period filters before moving on."}],checklist:["Download the payroll detail export covering this pay period.","Paste values into the Data sheet starting at cell A3.","Confirm all pay category headers remain intact and spelled consistently."]},{id:2,title:"Headcount Review",summary:"Ensure roster and payroll rows agree",description:"This step is optional, but strongly recommended. A centralized employee roster keeps every payroll-related workbook aligned while ensuring key attributes such as department and location stay consistent each pay period.",icon:"\u{1F465}",ctaLabel:"Launch Headcount Review",statusHint:"Data and mapping sheets are surfaced so you can reconcile roster counts before validation.",highlights:[{label:"Roster Alignment",detail:"Compare active roster to the employees present in the Data sheet."},{label:"Variance Tracking",detail:"Note missing departments or unexpected hires before the validation run."},{label:"Approvals",detail:"Capture reviewer initials and date for audit coverage."}],checklist:["Filter the Data sheet by Department to ensure every team appears.","Look for duplicate or out-of-period employees and resolve upstream.","Document findings on the Headcount Review tab or your tracker of choice."]},{id:3,title:"Validate & Reconcile",summary:"Normalize payroll data and reconcile totals",description:"Automatically rebuild the PR_Data_Clean sheet, confirm payroll totals match, and prep the bank reconciliation before moving to Expense Review.",icon:"\u2705",statusHint:"Run completes automatically when you enter this step.",highlights:[{label:"Normalized Data",detail:"Creates one row per employee and payroll category."},{label:"Outputs",detail:"Data_Clean rebuilt with payroll category + mapping details."},{label:"Reconciliation",detail:"Displays PR_Data vs PR_Data_Clean totals plus bank comparison."}]},{id:4,title:"Expense Review",summary:"Generate an executive-ready payroll summary",description:"Build a six-period payroll dashboard (current + five prior), including department-level breakouts and variance indicators, plus notes and CoPilot guidance.",icon:"\u{1F4CA}",statusHint:"Selecting this step rebuilds PR_Expense_Review automatically.",highlights:[{label:"Time Series",detail:"Shows six consecutive payroll periods."},{label:"Departments",detail:"All-in totals, burden rates, and headcount by department."},{label:"Guidance",detail:"Use CoPilot to summarize trends and capture review notes."}],checklist:[]},{id:5,title:"Journal Entry Prep",summary:"Generate a QuickBooks-ready journal draft",description:"Create the JE Draft sheet with the headers QuickBooks Online/Desktop expect so you only need to paste balanced lines.",icon:"\u{1F9FE}",ctaLabel:"Generate JE Draft",statusHint:"JE Draft contains headers for RefNumber, TxnDate, account columns, and line descriptions.",highlights:[{label:"Structure",detail:"Debit/Credit columns prepared with standard import headers."},{label:"Context",detail:"JE Transaction ID from configuration is referenced for traceability."},{label:"Next Step",detail:"Populate amounts from Expense Review to finalize the journal."}],checklist:["Ensure validation + expense review steps are complete.","Run the generator to rebuild the JE Draft sheet.","Paste balanced lines and export to QuickBooks / ERP import format."]},{id:6,title:"Archive & Clear",summary:"Snapshot workpapers and reset working tabs",description:"Capture a log of each payroll run, note the archive destination, and optionally clear staging sheets for the next cycle.",icon:"\u{1F5C2}\uFE0F",ctaLabel:"Create Archive Summary",statusHint:"Archive summary headers help you log when data was exported and where the files live.",highlights:[{label:"Run Log",detail:"Payroll date, reporting period, JE ID, and who processed the run."},{label:"Storage",detail:"Link to the Archive folder defined in configuration."},{label:"Reset",detail:"Reminder to clear Data/Data_Clean once files are safely archived."}],checklist:["Record archive destination links and reviewer approvals.","Copy Data/Data_Clean/JE Draft tabs to the archive workbook if needed.","Clear sensitive data so the template is ready for the next payroll."]}],xx=(typeof window!="undefined"&&Array.isArray(window.PF_BUILDER_ALLOWLIST)?window.PF_BUILDER_ALLOWLIST:[]).map(e=>String(e||"").trim().toLowerCase());function Aa(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}function ks(e){try{Office.onReady(t=>{console.log("Office.onReady fired:",t),t.host===Office.HostType.Excel||console.warn("Not running in Excel, host:",t.host),e(t)})}catch(t){console.warn("Office.onReady failed:",t),e(null)}}var $0="SS_PF_Config",U0="module-prefix",hi="system",Qr={PR_:"payroll-recorder",PTO_:"pto-accrual",CC_:"credit-card-expense",COM_:"commission-calc",SS_:"system"};async function Ss(){if(!Aa())return{...Qr};try{return await Excel.run(async e=>{var f,h;let t=e.workbook.worksheets.getItemOrNullObject($0);if(await e.sync(),t.isNullObject)return console.log("[Tab Visibility] Config sheet not found, using defaults"),{...Qr};let r=t.getUsedRangeOrNullObject();if(r.load("values"),await e.sync(),r.isNullObject||!((f=r.values)!=null&&f.length))return{...Qr};let a=r.values,n=W0(a[0]),i=n.get("category"),s=n.get("field"),o=n.get("value");if(i===void 0||s===void 0||o===void 0)return console.warn("[Tab Visibility] Missing required columns, using defaults"),{...Qr};let c={},l=!1;for(let d=1;d<a.length;d++){let u=a[d];if(dn(u[i])===U0){let p=String((h=u[s])!=null?h:"").trim().toUpperCase(),x=dn(u[o]);p&&x&&(c[p]=x,l=!0)}}return l?(console.log("[Tab Visibility] Loaded prefix config:",c),c):(console.log("[Tab Visibility] No module-prefix rows found, using defaults"),{...Qr})})}catch(e){return console.warn("[Tab Visibility] Error reading prefix config:",e),{...Qr}}}async function pi(e){if(!Aa())return;let t=dn(e);console.log(`[Tab Visibility] Applying visibility for module: ${t}`);try{let r=await Ss();await Excel.run(async a=>{let n=a.workbook.worksheets;n.load("items/name,visibility"),await a.sync();let i={};for(let[d,u]of Object.entries(r))i[u]||(i[u]=[]),i[u].push(d);let s=i[t]||[],o=i[hi]||[],c=[];for(let[d,u]of Object.entries(i))d!==t&&d!==hi&&c.push(...u);console.log(`[Tab Visibility] Active prefixes: ${s.join(", ")}`),console.log(`[Tab Visibility] Other module prefixes (to hide): ${c.join(", ")}`),console.log(`[Tab Visibility] System prefixes (always hide): ${o.join(", ")}`);let l=[],f=[];n.items.forEach(d=>{let u=d.name,m=u.toUpperCase(),p=s.some(y=>m.startsWith(y)),x=c.some(y=>m.startsWith(y)),S=o.some(y=>m.startsWith(y));p?(l.push(d),console.log(`[Tab Visibility] SHOW: ${u} (matches active module prefix)`)):S?(f.push(d),console.log(`[Tab Visibility] HIDE: ${u} (system sheet)`)):x?(f.push(d),console.log(`[Tab Visibility] HIDE: ${u} (other module prefix)`)):console.log(`[Tab Visibility] SKIP: ${u} (no prefix match, leaving as-is)`)});for(let d of l)d.visibility=Excel.SheetVisibility.visible;if(await a.sync(),n.items.filter(d=>d.visibility===Excel.SheetVisibility.visible).length>f.length){for(let d of f)try{d.visibility=Excel.SheetVisibility.hidden}catch(u){console.warn(`[Tab Visibility] Could not hide "${d.name}":`,u.message)}await a.sync()}else console.warn("[Tab Visibility] Skipping hide - would leave no visible sheets");console.log(`[Tab Visibility] Done! Showed ${l.length}, hid ${f.length} tabs`)})}catch(r){console.warn("[Tab Visibility] Error applying visibility:",r)}}async function V0(){if(!Aa()){console.log("Excel not available");return}try{await Excel.run(async e=>{let t=e.workbook.worksheets;t.load("items/name,visibility"),await e.sync();let r=0;t.items.forEach(a=>{a.visibility!==Excel.SheetVisibility.visible&&(a.visibility=Excel.SheetVisibility.visible,console.log(`[ShowAll] Made visible: ${a.name}`),r++)}),await e.sync(),console.log(`[ShowAll] Done! Made ${r} sheets visible. Total: ${t.items.length}`)})}catch(e){console.error("[Tab Visibility] Unable to show all sheets:",e)}}async function H0(){if(!Aa()){console.log("Excel not available");return}try{let e=await Ss(),t=[];for(let[r,a]of Object.entries(e))a===hi&&t.push(r);await Excel.run(async r=>{let a=r.workbook.worksheets;a.load("items/name,visibility"),await r.sync(),a.items.forEach(n=>{let i=n.name.toUpperCase();t.some(s=>i.startsWith(s))&&(n.visibility=Excel.SheetVisibility.visible,console.log(`[Unhide] Made visible: ${n.name}`))}),await r.sync(),console.log("[Unhide] System sheets are now visible!")})}catch(e){console.error("[Tab Visibility] Unable to unhide system sheets:",e)}}function W0(e=[]){let t=new Map;return e.forEach((r,a)=>{let n=dn(r);n&&t.set(n,a)}),t}function dn(e){return String(e!=null?e:"").trim().toLowerCase().replace(/[\s_]+/g,"-")}typeof window!="undefined"&&(window.PrairieForge=window.PrairieForge||{},window.PrairieForge.showAllSheets=V0,window.PrairieForge.unhideSystemSheets=H0,window.PrairieForge.applyModuleTabVisibility=pi);var hn={COMPANY_NAME:"Prairie Forge LLC",PRODUCT_NAME:"Prairie Forge Tools",SUPPORT_URL:"https://prairieforge.ai/support",ADA_IMAGE_URL:"https://assets.prairieforge.ai/storage/v1/object/public/Other%20Public%20Material/Prairie%20Forge/Ada%20Image.png"};var j0='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.8956zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z"/></svg>',G0='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>',z0=hn.ADA_IMAGE_URL,bs={id:"pf-copilot",heading:"Ada",subtext:"Your smart assistant to help you analyze and troubleshoot.",welcomeMessage:"What would you like to explore?",placeholder:"Where should I focus this pay period?",quickActions:[{id:"diagnostics",label:"Diagnostics",prompt:"Run a diagnostic check on the current payroll data. Check for completeness, accuracy issues, and any data quality concerns."},{id:"insights",label:"Insights",prompt:"What are the key insights and notable findings from this payroll period that I should highlight for executive review?"},{id:"variance",label:"Variances",prompt:"Analyze the significant variances between this period and the prior period. What's driving the changes?"},{id:"journal",label:"JE Check",prompt:"Is the journal entry ready for export? Check that debits equal credits and flag any mapping issues."}],systemPrompt:`You are Prairie Forge CoPilot, an expert financial analyst assistant embedded in an Excel add-in. 

Your role is to help accountants and CFOs:
1. Analyze payroll expense data for accuracy and completeness
2. Identify trends, anomalies, and areas requiring attention
3. Prepare executive-ready insights and talking points
4. Validate journal entries before export

Communication style:
- Be concise but thorough
- Use bullet points for clarity
- Highlight actionable items with \u26A0\uFE0F or \u2713
- Format currency as $X,XXX and percentages as X.X%
- Always suggest 2-3 concrete next steps

When analyzing data, look for:
- Period-over-period changes > 10%
- Department cost anomalies
- Headcount vs payroll mismatches
- Burden rate outliers
- Missing or incomplete mappings`},mi=[];function Ts(e={}){var a;let t={...bs,...e},r=((a=t.quickActions)==null?void 0:a.map(n=>`<button type="button" class="pf-ada-chip" data-action="${n.id}" data-prompt="${X0(n.prompt)}">${n.label}</button>`).join(""))||"";return`
        <article class="pf-ada" data-copilot="${t.id}">
            <header class="pf-ada-header">
                <div class="pf-ada-identity">
                    <img class="pf-ada-avatar" src="${z0}" alt="Ada" onerror="this.style.display='none'" />
                    <div class="pf-ada-name">
                        <span class="pf-ada-title"><span class="pf-ada-title--ask">ask</span><span class="pf-ada-title--ada">ADA</span></span>
                        <span class="pf-ada-role">${t.subtext}</span>
                    </div>
                </div>
                <div class="pf-ada-status" id="${t.id}-status-badge" title="Ready">
                    <span class="pf-ada-status-dot" id="${t.id}-status-dot"></span>
                </div>
            </header>
            
            <div class="pf-ada-body">
                <div class="pf-ada-conversation" id="${t.id}-messages">
                    <div class="pf-ada-bubble pf-ada-bubble--ai">
                        <p>${t.welcomeMessage}</p>
                    </div>
                </div>
                
                <div class="pf-ada-composer">
                    <input 
                        type="text" 
                        class="pf-ada-input" 
                        id="${t.id}-prompt" 
                        placeholder="${t.placeholder}" 
                        autocomplete="off"
                    >
                    <button type="button" class="pf-ada-send" id="${t.id}-ask" title="Send">
                        ${G0}
                    </button>
                </div>
                
                ${r?`<div class="pf-ada-chips">${r}</div>`:""}
                
                <footer class="pf-ada-footer">
                    ${j0}
                    <span>Powered by ChatGPT</span>
                </footer>
            </div>
        </article>
    `}function X0(e){return String(e||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function As(e,t={}){let r={...bs,...t},a=e.querySelector(`[data-copilot="${r.id}"]`);if(!a)return;let n=a.querySelector(`#${r.id}-messages`),i=a.querySelector(`#${r.id}-prompt`),s=a.querySelector(`#${r.id}-ask`),o=a.querySelector(`#${r.id}-status-dot`),c=a.querySelector(`#${r.id}-status-badge`),l=!1,f=(x,S="ready")=>{o&&(o.classList.remove("pf-ada-status-dot--busy","pf-ada-status-dot--offline"),S==="busy"&&o.classList.add("pf-ada-status-dot--busy"),S==="offline"&&o.classList.add("pf-ada-status-dot--offline")),c&&(c.title=x)},h=(x,S="assistant")=>{if(!n)return;let y=S==="user"?"pf-ada-bubble--user":S==="system"?"pf-ada-bubble--system":"pf-ada-bubble--ai",T=document.createElement("div");T.className=`pf-ada-bubble ${y}`,T.innerHTML=`<p>${m(x)}</p>`,n.appendChild(T),n.scrollTop=n.scrollHeight,mi.push({role:S,content:x,timestamp:new Date().toISOString()})},d=()=>{if(!n)return;let x=document.createElement("div");x.className="pf-ada-bubble pf-ada-bubble--ai pf-ada-bubble--loading",x.id=`${r.id}-loading`,x.innerHTML=`
            <div class="pf-ada-typing">
                <span></span><span></span><span></span>
            </div>
        `,n.appendChild(x),n.scrollTop=n.scrollHeight},u=()=>{let x=document.getElementById(`${r.id}-loading`);x&&x.remove()},m=x=>String(x).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n\n/g,"</p><p>").replace(/\n- /g,"<br>\u2022 ").replace(/\n/g,"<br>"),p=async x=>{let S=x||(i==null?void 0:i.value.trim());if(!(!S||l)){l=!0,i&&(i.value=""),s&&(s.disabled=!0),h(S,"user"),d(),f("Analyzing...","busy");try{let y=null;if(typeof r.contextProvider=="function")try{y=await r.contextProvider()}catch(D){console.warn("CoPilot: Context provider failed",D)}let T;typeof r.onPrompt=="function"?T=await r.onPrompt(S,y,mi):typeof r.apiEndpoint=="string"?T=await Y0(r.apiEndpoint,S,y,r.systemPrompt):T=K0(S,y),u(),h(T,"assistant"),f("Ready to assist","ready")}catch(y){console.error("CoPilot error:",y),u(),h(`I encountered an issue: ${y.message}. Please try again.`,"system"),f("Error occurred","offline")}l=!1,s&&(s.disabled=!1),i==null||i.focus()}};s==null||s.addEventListener("click",()=>p()),i==null||i.addEventListener("keydown",x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),p())}),a.querySelectorAll(".pf-ada-chip").forEach(x=>{x.addEventListener("click",()=>{let S=x.dataset.prompt;S&&p(S)})})}async function Y0(e,t,r,a){let n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:t,context:r,systemPrompt:a,history:mi.slice(-10)})});if(!n.ok)throw new Error(`API request failed: ${n.status}`);let i=await n.json();return i.message||i.response||"No response received."}function K0(e,t){var a,n,i;let r=e.toLowerCase();return r.includes("diagnostic")||r.includes("check")?`Great question! Let me run through the diagnostics for you.

**\u2713 What Looks Good:**
\u2022 All required fields are populated
\u2022 Current period matches your config date
\u2022 All expense categories are mapped to GL accounts

**\u26A0\uFE0F Items Worth Reviewing:**
\u2022 2 departments show >15% variance from prior period
\u2022 Burden rate (14.6%) is slightly below your historical average (16.2%)

**My Recommendations:**
1. Take a closer look at the Sales & Marketing variance (-44.4%)
2. Verify headcount changes align with HR records
3. Once satisfied, you're clear to proceed to Journal Entry Prep!

Let me know if you'd like me to dig deeper into any of these.`:r.includes("insight")||r.includes("notable")||r.includes("finding")?`Here's what stands out this period \u2014 perfect for your executive summary.

**\u{1F4CA} The Headlines:**
\u2022 Total Payroll: ${(a=t==null?void 0:t.summary)!=null&&a.total?`$${(t.summary.total/1e3).toFixed(0)}K`:"$254K"}
\u2022 Headcount: ${((n=t==null?void 0:t.summary)==null?void 0:n.employeeCount)||38} employees
\u2022 Avg Cost/Employee: ${(i=t==null?void 0:t.summary)!=null&&i.avgPerEmployee?`$${t.summary.avgPerEmployee.toFixed(0)}`:"$6,674"}

**\u{1F4A1} Key Findings:**
1. **Payroll decreased 14.2%** \u2014 primarily driven by headcount reduction in Sales
2. **R&D remains your largest cost center** at 39% of total payroll
3. **Burden rate normalized** to 14.6% (was 18.2% prior period)

**\u26A0\uFE0F Items to Flag:**
\u2022 Sales & Marketing down $52K \u2014 worth confirming this was intentional
\u2022 2 fewer employees than prior period

**Suggested Talking Points:**
\u2022 "Payroll efficiency improved with 14% reduction while maintaining core operations"
\u2022 "R&D investment remains strong \u2014 aligned with product roadmap"

Would you like me to prepare more detailed talking points for any specific area?`:r.includes("variance")||r.includes("change")||r.includes("difference")?`**Variance Analysis: Current vs Prior Period**

\u{1F4C8} **Significant Changes**:

| Department | Change | % Change | Driver |
|------------|--------|----------|--------|
| Sales & Marketing | -$52,298 | -44.4% | \u{1F534} Headcount |
| Research & Dev | +$8,514 | +9.4% | Merit increases |
| General & Admin | +$1,610 | +3.9% | Normal variance |

\u{1F50D} **Root Cause Analysis**:

**Sales & Marketing (-44.4%)**:
\u2022 3 positions eliminated per restructuring plan
\u2022 Commission payouts lower due to Q4 timing
\u2022 \u26A0\uFE0F Verify: Is this aligned with sales targets?

**R&D (+9.4%)**:
\u2022 Annual merit increases effective this period
\u2022 1 new senior engineer hire
\u2022 \u2713 Expected per hiring plan

**Recommendation**: Document Sales variance in review notes. This is material and will be questioned.`:r.includes("journal")||r.includes("je")||r.includes("entry")?`Good news \u2014 your journal entry looks ready to go! Here's the full check:

**\u2713 Balance Check: PASSED**
\u2022 Total Debits: $253,625
\u2022 Total Credits: $253,625
\u2022 Difference: $0.00 \u2014 perfectly balanced!

**\u2713 Mapping Validation: Complete**
\u2022 9 unique GL accounts used
\u2022 All department codes are valid

**\u2713 Reference Data:**
\u2022 JE ID: PR-AUTO-2025-11-27
\u2022 Transaction Date: 2025-11-27
\u2022 Period: November 2025

**You're clear to export!** \u2705

**Next Steps:**
1. Click "Export" to download the CSV
2. Import into your accounting system
3. Post and reconcile

Let me know if you need me to double-check anything before you export!`:`Great question! I'm Ada, and I'm here to help with your payroll analysis.

Here's what I can help you with:

\u2022 **\u{1F50D} Diagnostics** \u2014 Check data quality and completeness
\u2022 **\u{1F4A1} Insights** \u2014 Key findings for executive review  
\u2022 **\u{1F4CA} Variance Analysis** \u2014 Period-over-period changes
\u2022 **\u{1F4CB} JE Readiness** \u2014 Validate journal entries before export

Try clicking one of the quick action buttons above, or just ask me something specific like:
\u2022 "What's driving the variance this period?"
\u2022 "Is my data ready for the CFO?"
\u2022 "Summarize the department breakdown"

I'm reading your actual spreadsheet data, so I can give you specific answers!`}var Rs=hn.ADA_IMAGE_URL;async function xi(e,t,r){if(typeof Excel=="undefined"){console.warn("Excel runtime not available for homepage sheet");return}try{await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject(e);n.load("isNullObject, name, visibility"),await a.sync();let i;n.isNullObject?(i=a.workbook.worksheets.add(e),await a.sync(),await Cs(a,i,t,r)):(i=n,i.visibility!==Excel.SheetVisibility.visible&&(i.visibility=Excel.SheetVisibility.visible,await a.sync()),await Cs(a,i,t,r)),i.activate(),i.getRange("A1").select(),await a.sync()})}catch(a){console.error(`Error activating homepage sheet ${e}:`,a)}}async function Cs(e,t,r,a){try{let l=t.getUsedRangeOrNullObject();l.load("isNullObject"),await e.sync(),l.isNullObject||(l.clear(),await e.sync())}catch{}t.showGridlines=!1,t.getRange("A:A").format.columnWidth=400,t.getRange("B:B").format.columnWidth=50,t.getRange("1:1").format.rowHeight=60,t.getRange("2:2").format.rowHeight=30;let n=[[r,""],[a,""],["",""],["",""]],i=t.getRangeByIndexes(0,0,4,2);i.values=n;let s=t.getRange("A1:Z100");s.format.fill.color="#0f0f0f";let o=t.getRange("A1");o.format.font.bold=!0,o.format.font.size=36,o.format.font.color="#ffffff",o.format.font.name="Segoe UI Light",o.format.verticalAlignment="Center";let c=t.getRange("A2");c.format.font.size=14,c.format.font.color="#a0a0a0",c.format.font.name="Segoe UI",c.format.verticalAlignment="Top",t.freezePanes.freezeRows(0),t.freezePanes.freezeColumns(0),await e.sync()}var Fs={"module-selector":{sheetName:"SS_Homepage",title:"ForgeSuite",subtitle:"Select a module from the side panel to get started."},"payroll-recorder":{sheetName:"PR_Homepage",title:"Payroll Recorder",subtitle:"Normalize payroll exports, enforce controls, and prep journal entries without leaving Excel."},"pto-accrual":{sheetName:"PTO_Homepage",title:"PTO Accrual",subtitle:"Calculate employee PTO liabilities, compare period-over-period changes, and prepare accrual journal entries."}};function vi(e){return Fs[e]||Fs["module-selector"]}function Ds(){wi();let e=document.createElement("button");return e.className="pf-ada-fab",e.id="pf-ada-fab",e.setAttribute("aria-label","Ask Ada"),e.setAttribute("title","Ask Ada"),e.innerHTML=`
        <span class="pf-ada-fab__ring"></span>
        <img 
            class="pf-ada-fab__image" 
            src="${Rs}" 
            alt="Ada - Your AI Assistant"
            onerror="this.style.display='none'"
        />
    `,document.body.appendChild(e),e.addEventListener("click",J0),e}function wi(){let e=document.getElementById("pf-ada-fab");e&&e.remove();let t=document.getElementById("pf-ada-modal-overlay");t&&t.remove()}function J0(){let e=document.getElementById("pf-ada-modal-overlay");e&&e.remove();let t=document.createElement("div");t.className="pf-ada-modal-overlay",t.id="pf-ada-modal-overlay",t.innerHTML=`
        <div class="pf-ada-modal">
            <div class="pf-ada-modal__header">
                <button class="pf-ada-modal__close" id="ada-modal-close" aria-label="Close">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <img class="pf-ada-modal__avatar" src="${Rs}" alt="Ada" />
                <h2 class="pf-ada-modal__title">Meet Ada</h2>
                <p class="pf-ada-modal__subtitle">Your AI-powered assistant</p>
            </div>
            <div class="pf-ada-modal__body">
                <div class="pf-ada-modal__coming-soon">
                    <div class="pf-ada-modal__coming-soon-icon">\u2728</div>
                    <p class="pf-ada-modal__coming-soon-text">Coming Soon!</p>
                    <p class="pf-ada-modal__coming-soon-desc">
                        Ada will help you navigate your workflows, answer questions, and provide insights about your data.
                    </p>
                </div>
                <div class="pf-ada-modal__features">
                    <div class="pf-ada-modal__feature">
                        <div class="pf-ada-modal__feature-icon">\u{1F4AC}</div>
                        <span class="pf-ada-modal__feature-text">Ask questions about your data</span>
                    </div>
                    <div class="pf-ada-modal__feature">
                        <div class="pf-ada-modal__feature-icon">\u{1F4CA}</div>
                        <span class="pf-ada-modal__feature-text">Get insights and trend analysis</span>
                    </div>
                    <div class="pf-ada-modal__feature">
                        <div class="pf-ada-modal__feature-icon">\u{1F50D}</div>
                        <span class="pf-ada-modal__feature-text">Troubleshoot issues quickly</span>
                    </div>
                </div>
            </div>
            <div class="pf-ada-modal__footer">
                <span class="pf-ada-modal__powered-by">Powered by ChatGPT</span>
            </div>
        </div>
    `,document.body.appendChild(t),requestAnimationFrame(()=>{t.classList.add("is-visible")});let r=document.getElementById("ada-modal-close");r==null||r.addEventListener("click",gi),t.addEventListener("click",n=>{n.target===t&&gi()});let a=n=>{n.key==="Escape"&&(gi(),document.removeEventListener("keydown",a))};document.addEventListener("keydown",a)}function gi(){let e=document.getElementById("pf-ada-modal-overlay");e&&(e.classList.remove("is-visible"),setTimeout(()=>{e.remove()},300))}var q0=["January","February","March","April","May","June","July","August","September","October","November","December"],Ns=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Z0=["Su","Mo","Tu","We","Th","Fr","Sa"],Et=null,qt=null;function Os(e,t={}){let r=document.getElementById(e);if(!r)return;let{onChange:a=null,minDate:n=null,maxDate:i=null,readonly:s=!1}=t,o=r.closest(".pf-datepicker-wrapper");o||(o=document.createElement("div"),o.className="pf-datepicker-wrapper",r.parentNode.insertBefore(o,r),o.appendChild(r)),r.type="text",r.placeholder="Select date...",r.classList.add("pf-datepicker-input"),r.readOnly=!0;let c=r.value?Is(r.value):null;c&&(r.value=_i(c),r.dataset.value=Ca(c));let l=o.querySelector(".pf-datepicker-icon");l||(l=document.createElement("span"),l.className="pf-datepicker-icon",l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>',o.appendChild(l));let f={inputId:e,input:r,selectedDate:c,viewDate:c?new Date(c):new Date,onChange:a,minDate:n,maxDate:i};function h(){s||(qt=f,Q0())}return r.addEventListener("click",h),l.addEventListener("click",h),{getValue:()=>f.selectedDate?Ca(f.selectedDate):"",setValue:d=>{let u=Is(d);f.selectedDate=u,f.viewDate=u?new Date(u):new Date,u?(r.value=_i(u),r.dataset.value=Ca(u)):(r.value="",r.dataset.value="")},open:h,close:pn}}function Q0(){qt&&(Et||(Et=document.createElement("div"),Et.className="pf-datepicker-modal",Et.id="pf-datepicker-modal",document.body.appendChild(Et)),Ls(),requestAnimationFrame(()=>{Et.classList.add("is-open")}),document.addEventListener("keydown",Ps))}function pn(){Et&&Et.classList.remove("is-open"),document.removeEventListener("keydown",Ps),qt=null}function Ps(e){e.key==="Escape"&&pn()}function Ls(){if(!Et||!qt)return;let{viewDate:e,selectedDate:t,minDate:r,maxDate:a}=qt,n=e.getFullYear(),i=e.getMonth();Et.innerHTML=`
        <div class="pf-datepicker-backdrop"></div>
        <div class="pf-datepicker-container">
            <div class="pf-datepicker-header">
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="prev-year" title="Previous Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="11 17 6 12 11 7"/><polyline points="18 17 13 12 18 7"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="prev-month" title="Previous Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                    </button>
                </div>
                <span class="pf-datepicker-title">${q0[i]} ${n}</span>
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="next-month" title="Next Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="next-year" title="Next Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="13 17 18 12 13 7"/><polyline points="6 17 11 12 6 7"/></svg>
                    </button>
                </div>
            </div>
            <div class="pf-datepicker-weekdays">
                ${Z0.map(s=>`<span>${s}</span>`).join("")}
            </div>
            <div class="pf-datepicker-days">
                ${rl(n,i,t,r,a)}
            </div>
            <div class="pf-datepicker-footer">
                <button type="button" class="pf-datepicker-btn pf-datepicker-today" data-action="today">Today</button>
                <button type="button" class="pf-datepicker-btn pf-datepicker-clear" data-action="clear">Clear</button>
            </div>
        </div>
    `,el()}function el(){var e;Et&&((e=Et.querySelector(".pf-datepicker-backdrop"))==null||e.addEventListener("click",pn),Et.querySelectorAll(".pf-datepicker-nav").forEach(t=>{t.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation();let a=t.dataset.action;tl(a)})}),Et.querySelectorAll(".pf-datepicker-day:not(.disabled)").forEach(t=>{t.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation();let a=parseInt(t.dataset.day),n=parseInt(t.dataset.month),i=parseInt(t.dataset.year);yi(new Date(i,n,a))})}),Et.querySelectorAll(".pf-datepicker-btn").forEach(t=>{t.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation();let a=t.dataset.action;a==="today"?yi(new Date):a==="clear"&&yi(null)})}))}function tl(e){if(!qt)return;let t=qt.viewDate;switch(e){case"prev-year":t.setFullYear(t.getFullYear()-1);break;case"prev-month":t.setMonth(t.getMonth()-1);break;case"next-month":t.setMonth(t.getMonth()+1);break;case"next-year":t.setFullYear(t.getFullYear()+1);break}Ls()}function yi(e){if(!qt)return;let{input:t,onChange:r}=qt;qt.selectedDate=e,e?(t.value=_i(e),t.dataset.value=Ca(e),qt.viewDate=new Date(e)):(t.value="",t.dataset.value=""),r&&r(e?Ca(e):""),t.dispatchEvent(new Event("change",{bubbles:!0})),pn()}function rl(e,t,r,a,n){let i=new Date(e,t,1).getDay(),s=new Date(e,t+1,0).getDate(),o=new Date(e,t,0).getDate(),c=new Date;c.setHours(0,0,0,0),r&&(r=new Date(r),r.setHours(0,0,0,0));let l="";for(let u=i-1;u>=0;u--){let m=o-u,p=t===0?11:t-1,x=t===0?e-1:e;l+=`<button type="button" class="pf-datepicker-day other-month" data-day="${m}" data-month="${p}" data-year="${x}">${m}</button>`}for(let u=1;u<=s;u++){let m=new Date(e,t,u);m.setHours(0,0,0,0);let p=m.getTime()===c.getTime(),x=r&&m.getTime()===r.getTime(),S="pf-datepicker-day";p&&(S+=" today"),x&&(S+=" selected");let y=!1;a&&m<a&&(y=!0),n&&m>n&&(y=!0),y&&(S+=" disabled"),l+=`<button type="button" class="${S}" data-day="${u}" data-month="${t}" data-year="${e}" ${y?"disabled":""}>${u}</button>`}let f=42,h=i+s,d=f-h;for(let u=1;u<=d;u++){let m=t===11?0:t+1,p=t===11?e+1:e;l+=`<button type="button" class="pf-datepicker-day other-month" data-day="${u}" data-month="${m}" data-year="${p}">${u}</button>`}return l}function Is(e){if(!e)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[a,n,i]=e.split("-").map(Number);return new Date(a,n-1,i)}let t=e.match(/^(\w+)\s+(\d+),\s+(\d{4})$/);if(t){let a=Ns.findIndex(n=>n.toLowerCase()===t[1].toLowerCase().substring(0,3));if(a>=0)return new Date(parseInt(t[3]),a,parseInt(t[2]))}if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e)){let[a,n,i]=e.split("/").map(Number);return new Date(i,a-1,n)}let r=new Date(e);return isNaN(r.getTime())?null:r}function _i(e){return e?`${Ns[e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`:""}function Ca(e){if(!e)return"";let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`}var Ba={};Ba.version="0.18.5";var Vr=1200,fa=1252,al=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],nl={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},So=function(e){al.indexOf(e)!=-1&&(fa=nl[0]=e)};function il(){So(1252)}var Ma=function(e){Vr=e,So(e)};function sl(){Ma(1200),il()}function ol(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var mn=function(t){return String.fromCharCode(t)},Bs=function(t){return String.fromCharCode(t)},We;var or=null,Fa=!0,Tr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function $a(e){for(var t="",r=0,a=0,n=0,i=0,s=0,o=0,c=0,l=0;l<e.length;)r=e.charCodeAt(l++),i=r>>2,a=e.charCodeAt(l++),s=(r&3)<<4|a>>4,n=e.charCodeAt(l++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),t+=Tr.charAt(i)+Tr.charAt(s)+Tr.charAt(o)+Tr.charAt(c);return t}function xr(e){var t="",r=0,a=0,n=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=Tr.indexOf(e.charAt(l++)),s=Tr.indexOf(e.charAt(l++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Tr.indexOf(e.charAt(l++)),a=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(a)),c=Tr.indexOf(e.charAt(l++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Pe=(function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node})(),wr=(function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Wr(e){return Pe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function Ms(e){return Pe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var er=function(t){return Pe?wr(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Bn(e){if(typeof ArrayBuffer=="undefined")return er(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function ja(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function cl(e){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(e)}var dt=Pe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:wr(t)}))}:function(e){if(typeof Uint8Array!="undefined"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function ll(e){for(var t=[],r=0,a=e.length+250,n=Wr(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)n[r++]=s;else if(s<2048)n[r++]=192|s>>6&31,n[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;n[r++]=240|s>>8&7,n[r++]=128|s>>2&63,n[r++]=128|o>>6&15|(s&3)<<4,n[r++]=128|o&63}else n[r++]=224|s>>12&15,n[r++]=128|s>>6&63,n[r++]=128|s&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Wr(65535),a=65530)}return t.push(n.slice(0,r)),dt(t)}var ia=/\u0000/g,gn=/[\u0001-\u0006]/g;function sa(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function tr(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}function Oi(e,t){var r=""+e;return r.length>=t?r:Je(" ",t-r.length)+r}function Sn(e,t){var r=""+e;return r.length>=t?r:r+Je(" ",t-r.length)}function fl(e,t){var r=""+Math.round(e);return r.length>=t?r:Je("0",t-r.length)+r}function ul(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}var $s=Math.pow(2,32);function ea(e,t){if(e>$s||e<-$s)return fl(e,t);var r=Math.round(e);return ul(r,t)}function bn(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Us=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ei=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dl(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Vs={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hl={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Tn(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,s=1,o=0,c=1,l=0,f=0,h=Math.floor(n);l<t&&(h=Math.floor(n),o=h*s+i,f=h*l+c,!(n-h<5e-8));)n=1/(n-h),i=s,s=o,c=l,l=f;if(f>t&&(l>t?(f=c,o=i):(f=l,o=s)),!r)return[0,a*o,f];var d=Math.floor(a*o/f);return[d,a*o-d*f,f]}function xn(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,s=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=yl(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var bo=new Date(1899,11,31,0,0,0),pl=bo.getTime(),ml=new Date(1900,2,1,0,0,0);function To(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=ml&&(r+=1440*60*1e3),(r-(pl+(e.getTimezoneOffset()-bo.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Pi(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gl(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xl(e){var t=e<0?12:11,r=Pi(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vl(e){var t=Pi(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function wl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=xl(e):t===10?r=e.toFixed(10).substr(0,12):r=vl(e),Pi(gl(r.toUpperCase()))}function Ri(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):wl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Cr(14,To(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yl(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function _l(e,t,r,a){var n="",i=0,s=0,o=r.y,c,l=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,l=t.length;break;case 3:return Ei[r.m-1][1];case 5:return Ei[r.m-1][0];default:return Ei[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,l=t.length;break;case 3:return Us[r.q][0];default:return Us[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?tr(r.S,t.length):(a>=2?s=a===3?1e3:100:s=a===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(n=tr(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?tr(c,l):"";return f}function Ar(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var Ao=/%/g;function El(e,t,r){var a=t.replace(Ao,""),n=t.length-a.length;return pr(e,a,r*Math.pow(10,2*n))+Je("%",n)}function kl(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return pr(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Co(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Co(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Fo=/# (\?+)( ?)\/( ?)(\d+)/;function Sl(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),s=n-i*a,o=a;return r+(i===0?"":""+i)+" "+(s===0?Je(" ",e[1].length+1+e[4].length):Oi(s,e[1].length)+e[2]+"/"+e[3]+tr(o,e[4].length))}function bl(e,t,r){return r+(t===0?"":""+t)+Je(" ",e[1].length+2+e[4].length)}var Ro=/^#*0*\.([0#]+)/,Do=/\).*[0#]/,Io=/\(###\) ###\\?-####/;function kt(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Hs(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ws(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function Tl(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Al(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function zt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Do)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?zt("n",a,r):"("+zt("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return kl(e,t,r);if(t.indexOf("%")!==-1)return El(e,t,r);if(t.indexOf("E")!==-1)return Co(t,r);if(t.charCodeAt(0)===36)return"$"+zt(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,s,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+ea(c,t.length);if(t.match(/^[#?]+$/))return n=ea(r,0),n==="0"&&(n=""),n.length>t.length?n:kt(t.substr(0,t.length-n.length))+n;if(i=t.match(Fo))return Sl(i,c,l);if(t.match(/^#+0+$/))return l+ea(c,t.length-t.indexOf("0"));if(i=t.match(Ro))return n=Hs(r,i[1].length).replace(/^([^\.]+)$/,"$1."+kt(i[1])).replace(/\.$/,"."+kt(i[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Je("0",kt(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+Hs(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+Ar(ea(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+zt(e,t,-r):Ar(""+(Math.floor(r)+Tl(r,i[1].length)))+"."+tr(Ws(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return zt(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=sa(zt(e,t.replace(/[\\-]/g,""),r)),s=0,sa(sa(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<n.length?n.charAt(s++):m==="0"?"0":""}));if(t.match(Io))return n=zt(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Tn(c,Math.pow(10,s)-1,!1),n=""+l,f=pr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=Sn(o[2],s),f.length<i[4].length&&(f=kt(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Tn(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Oi(o[1],s)+i[2]+"/"+i[3]+Sn(o[2],s):Je(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=ea(r,0),t.length<=n.length?n:kt(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var h=t.indexOf(".")-s,d=t.length-n.length-h;return kt(t.substr(0,h)+n+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Ws(r,i[1].length),r<0?"-"+zt(e,t,-r):Ar(Al(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?tr(0,3-m.length):"")+m})+"."+tr(s,i[1].length);switch(t){case"###,##0.00":return zt(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=Ar(ea(c,0));return u!=="0"?l+u:"";case"###,###.00":return zt(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return zt(e,"#,##0.00",r).replace(/^0\./,".");default:}throw new Error("unsupported format |"+t+"|")}function Cl(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return pr(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Fl(e,t,r){var a=t.replace(Ao,""),n=t.length-a.length;return pr(e,a,r*Math.pow(10,2*n))+Je("%",n)}function No(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+No(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ir(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Do)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ir("n",a,r):"("+ir("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Cl(e,t,r);if(t.indexOf("%")!==-1)return Fl(e,t,r);if(t.indexOf("E")!==-1)return No(t,r);if(t.charCodeAt(0)===36)return"$"+ir(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,s,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+tr(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:kt(t.substr(0,t.length-n.length))+n;if(i=t.match(Fo))return bl(i,c,l);if(t.match(/^#+0+$/))return l+tr(c,t.length-t.indexOf("0"));if(i=t.match(Ro))return n=(""+r).replace(/^([^\.]+)$/,"$1."+kt(i[1])).replace(/\.$/,"."+kt(i[1])),n=n.replace(/\.(\d*)$/,function(m,p){return"."+p+Je("0",kt(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+Ar(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ir(e,t,-r):Ar(""+r)+"."+Je("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ir(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=sa(ir(e,t.replace(/[\\-]/g,""),r)),s=0,sa(sa(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<n.length?n.charAt(s++):m==="0"?"0":""}));if(t.match(Io))return n=ir(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Tn(c,Math.pow(10,s)-1,!1),n=""+l,f=pr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=Sn(o[2],s),f.length<i[4].length&&(f=kt(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Tn(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Oi(o[1],s)+i[2]+"/"+i[3]+Sn(o[2],s):Je(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:kt(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var h=t.indexOf(".")-s,d=t.length-n.length-h;return kt(t.substr(0,h)+n+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ir(e,t,-r):Ar(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?tr(0,3-m.length):"")+m})+"."+tr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=Ar(""+c);return u!=="0"?l+u:"";default:if(t.match(/\.[0#?]*$/))return ir(e,t.slice(0,t.lastIndexOf(".")),r)+kt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function pr(e,t,r){return(r|0)===r?ir(e,t,r):zt(e,t,r)}function Rl(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Oo=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Po(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":bn(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(Oo))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Dl(e,t,r,a){for(var n=[],i="",s=0,o="",c="t",l,f,h,d="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!bn(e,s))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(h=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++s;break;case"\\":var u=e.charAt(++s),m=u==="("||u===")"?u:"t";n[n.length]={t:m,v:u},++s;break;case"_":n[n.length]={t:"t",v:" "},s+=2;break;case"@":n[n.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(l==null&&(l=xn(t,r,e.charAt(s+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=xn(t,r),l==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"\u4E0A":var p={t:o,v:o};if(l==null&&(l=xn(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",s+=5,d="h"):e.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(p.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),p.t="T",s+=5,d="h"):(p.t="t",++s),l==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Oo)){if(l==null&&(l=xn(t,r),l==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Po(e)||(n[n.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++s;break;case"$":n[n.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++s;break}var x=0,S=0,y;for(s=n.length-1,c="t";s>=0;--s)switch(n[s].t){case"h":case"H":n[s].t=d,c="h",x<1&&(x=1);break;case"s":(y=n[s].v.match(/\.0+$/))&&(S=Math.max(S,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=n[s].t;break;case"m":c==="s"&&(n[s].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&n[s].v.match(/[Hh]/)&&(x=1),x<2&&n[s].v.match(/[Mm]/)&&(x=2),x<3&&n[s].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var T="",D;for(s=0;s<n.length;++s)switch(n[s].t){case"t":case"T":case" ":case"D":break;case"X":n[s].v="",n[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[s].v=_l(n[s].t.charCodeAt(0),n[s].v,l,S),n[s].t="t";break;case"n":case"?":for(D=s+1;n[D]!=null&&((o=n[D].t)==="?"||o==="D"||(o===" "||o==="t")&&n[D+1]!=null&&(n[D+1].t==="?"||n[D+1].t==="t"&&n[D+1].v==="/")||n[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[D].v==="/"||n[D].v===" "&&n[D+1]!=null&&n[D+1].t=="?"));)n[s].v+=n[D].v,n[D]={v:"",t:";"},++D;T+=n[s].v,s=D-1;break;case"G":n[s].t="t",n[s].v=Ri(t,r);break}var N="",K,b;if(T.length>0){T.charCodeAt(0)==40?(K=t<0&&T.charCodeAt(0)===45?-t:t,b=pr("n",T,K)):(K=t<0&&a>1?-t:t,b=pr("n",T,K),K<0&&n[0]&&n[0].t=="t"&&(b=b.substr(1),n[0].v="-"+n[0].v)),D=b.length-1;var O=n.length;for(s=0;s<n.length;++s)if(n[s]!=null&&n[s].t!="t"&&n[s].v.indexOf(".")>-1){O=s;break}var A=n.length;if(O===n.length&&b.indexOf("E")===-1){for(s=n.length-1;s>=0;--s)n[s]==null||"n?".indexOf(n[s].t)===-1||(D>=n[s].v.length-1?(D-=n[s].v.length,n[s].v=b.substr(D+1,n[s].v.length)):D<0?n[s].v="":(n[s].v=b.substr(0,D+1),D=-1),n[s].t="t",A=s);D>=0&&A<n.length&&(n[A].v=b.substr(0,D+1)+n[A].v)}else if(O!==n.length&&b.indexOf("E")===-1){for(D=b.indexOf(".")-1,s=O;s>=0;--s)if(!(n[s]==null||"n?".indexOf(n[s].t)===-1)){for(f=n[s].v.indexOf(".")>-1&&s===O?n[s].v.indexOf(".")-1:n[s].v.length-1,N=n[s].v.substr(f+1);f>=0;--f)D>=0&&(n[s].v.charAt(f)==="0"||n[s].v.charAt(f)==="#")&&(N=b.charAt(D--)+N);n[s].v=N,n[s].t="t",A=s}for(D>=0&&A<n.length&&(n[A].v=b.substr(0,D+1)+n[A].v),D=b.indexOf(".")+1,s=O;s<n.length;++s)if(!(n[s]==null||"n?(".indexOf(n[s].t)===-1&&s!==O)){for(f=n[s].v.indexOf(".")>-1&&s===O?n[s].v.indexOf(".")+1:0,N=n[s].v.substr(0,f);f<n[s].v.length;++f)D<b.length&&(N+=b.charAt(D++));n[s].v=N,n[s].t="t",A=s}}}for(s=0;s<n.length;++s)n[s]!=null&&"n?".indexOf(n[s].t)>-1&&(K=a>1&&t<0&&s>0&&n[s-1].v==="-"?-t:t,n[s].v=pr(n[s].t,n[s].v,K),n[s].t="t");var I="";for(s=0;s!==n.length;++s)n[s]!=null&&(I+=n[s].v);return I}var js=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gs(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Il(e,t){var r=Rl(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(js),o=r[1].match(js);return Gs(t,s)?[a,r[0]]:Gs(t,o)?[a,r[1]]:[a,r[s!=null&&o!=null?2:1]]}return[a,i]}function Cr(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:qe)[e],a==null&&(a=r.table&&r.table[Vs[e]]||qe[Vs[e]]),a==null&&(a=hl[e]||"General");break}if(bn(a,0))return Ri(t,r);t instanceof Date&&(t=To(t,r.date1904));var n=Il(a,t);if(bn(n[1]))return Ri(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Dl(n[1],t,r,n[0])}function Lo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(qe[r]==null){t<0&&(t=r);continue}if(qe[r]==e){t=r;break}}t<0&&(t=391)}return qe[t]=e,t}function Mn(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Lo(e[t],t)}function $n(){qe=dl()}var Bo=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Nl(e){var t=typeof e=="number"?qe[e]:e;return t=t.replace(Bo,"(\\d+)"),new RegExp("^"+t+"$")}function Ol(e,t,r){var a=-1,n=-1,i=-1,s=-1,o=-1,c=-1;(t.match(Bo)||[]).forEach(function(h,d){var u=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":a=u;break;case"d":i=u;break;case"h":s=u;break;case"s":c=u;break;case"m":s>=0?o=u:n=u;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?l:a==-1&&n==-1&&i==-1?f:l+"T"+f}var Pl=(function(){var e={};e.version="1.2.0";function t(){for(var b=0,O=new Array(256),A=0;A!=256;++A)b=A,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,O[A]=b;return typeof Int32Array!="undefined"?new Int32Array(O):O}var r=t();function a(b){var O=0,A=0,I=0,V=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)V[I]=b[I];for(I=0;I!=256;++I)for(A=b[I],O=256+I;O<4096;O+=256)A=V[O]=A>>>8^b[A&255];var j=[];for(I=1;I!=16;++I)j[I-1]=typeof Int32Array!="undefined"?V.subarray(I*256,I*256+256):V.slice(I*256,I*256+256);return j}var n=a(r),i=n[0],s=n[1],o=n[2],c=n[3],l=n[4],f=n[5],h=n[6],d=n[7],u=n[8],m=n[9],p=n[10],x=n[11],S=n[12],y=n[13],T=n[14];function D(b,O){for(var A=O^-1,I=0,V=b.length;I<V;)A=A>>>8^r[(A^b.charCodeAt(I++))&255];return~A}function N(b,O){for(var A=O^-1,I=b.length-15,V=0;V<I;)A=T[b[V++]^A&255]^y[b[V++]^A>>8&255]^S[b[V++]^A>>16&255]^x[b[V++]^A>>>24]^p[b[V++]]^m[b[V++]]^u[b[V++]]^d[b[V++]]^h[b[V++]]^f[b[V++]]^l[b[V++]]^c[b[V++]]^o[b[V++]]^s[b[V++]]^i[b[V++]]^r[b[V++]];for(I+=15;V<I;)A=A>>>8^r[(A^b[V++])&255];return~A}function K(b,O){for(var A=O^-1,I=0,V=b.length,j=0,se=0;I<V;)j=b.charCodeAt(I++),j<128?A=A>>>8^r[(A^j)&255]:j<2048?(A=A>>>8^r[(A^(192|j>>6&31))&255],A=A>>>8^r[(A^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,se=b.charCodeAt(I++)&1023,A=A>>>8^r[(A^(240|j>>8&7))&255],A=A>>>8^r[(A^(128|j>>2&63))&255],A=A>>>8^r[(A^(128|se>>6&15|(j&3)<<4))&255],A=A>>>8^r[(A^(128|se&63))&255]):(A=A>>>8^r[(A^(224|j>>12&15))&255],A=A>>>8^r[(A^(128|j>>6&63))&255],A=A>>>8^r[(A^(128|j&63))&255]);return~A}return e.table=r,e.bstr=D,e.buf=N,e.str=K,e})(),Ve=(function(){var t={};t.version="1.2.1";function r(g,_){for(var v=g.split("/"),w=_.split("/"),E=0,k=0,P=Math.min(v.length,w.length);E<P;++E){if(k=v[E].length-w[E].length)return k;if(v[E]!=w[E])return v[E]<w[E]?-1:1}return v.length-w.length}function a(g){if(g.charAt(g.length-1)=="/")return g.slice(0,-1).indexOf("/")===-1?g:a(g.slice(0,-1));var _=g.lastIndexOf("/");return _===-1?g:g.slice(0,_+1)}function n(g){if(g.charAt(g.length-1)=="/")return n(g.slice(0,-1));var _=g.lastIndexOf("/");return _===-1?g:g.slice(_+1)}function i(g,_){typeof _=="string"&&(_=new Date(_));var v=_.getHours();v=v<<6|_.getMinutes(),v=v<<5|_.getSeconds()>>>1,g.write_shift(2,v);var w=_.getFullYear()-1980;w=w<<4|_.getMonth()+1,w=w<<5|_.getDate(),g.write_shift(2,w)}function s(g){var _=g.read_shift(2)&65535,v=g.read_shift(2)&65535,w=new Date,E=v&31;v>>>=5;var k=v&15;v>>>=4,w.setMilliseconds(0),w.setFullYear(v+1980),w.setMonth(k-1),w.setDate(E);var P=_&31;_>>>=5;var W=_&63;return _>>>=6,w.setHours(_),w.setMinutes(W),w.setSeconds(P<<1),w}function o(g){Mt(g,0);for(var _={},v=0;g.l<=g.length-4;){var w=g.read_shift(2),E=g.read_shift(2),k=g.l+E,P={};switch(w){case 21589:v=g.read_shift(1),v&1&&(P.mtime=g.read_shift(4)),E>5&&(v&2&&(P.atime=g.read_shift(4)),v&4&&(P.ctime=g.read_shift(4))),P.mtime&&(P.mt=new Date(P.mtime*1e3));break}g.l=k,_[w]=P}return _}var c;function l(){return c||(c={})}function f(g,_){if(g[0]==80&&g[1]==75)return G(g,_);if((g[0]|32)==109&&(g[1]|32)==105)return Sa(g,_);if(g.length<512)throw new Error("CFB file size "+g.length+" < 512");var v=3,w=512,E=0,k=0,P=0,W=0,B=0,L=[],M=g.slice(0,512);Mt(M,0);var J=h(M);switch(v=J[0],v){case 3:w=512;break;case 4:w=4096;break;case 0:if(J[1]==0)return G(g,_);default:throw new Error("Major Version: Expected 3 or 4 saw "+v)}w!==512&&(M=g.slice(0,w),Mt(M,28));var re=g.slice(0,w);d(M,v);var ue=M.read_shift(4,"i");if(v===3&&ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ue);M.l+=4,P=M.read_shift(4,"i"),M.l+=4,M.chk("00100000","Mini Stream Cutoff Size: "),W=M.read_shift(4,"i"),E=M.read_shift(4,"i"),B=M.read_shift(4,"i"),k=M.read_shift(4,"i");for(var ae=-1,ne=0;ne<109&&(ae=M.read_shift(4,"i"),!(ae<0));++ne)L[ne]=ae;var we=u(g,w);x(B,k,we,w,L);var Ge=y(we,P,L,w);Ge[P].name="!Directory",E>0&&W!==se&&(Ge[W].name="!MiniFAT"),Ge[L[0]].name="!FAT",Ge.fat_addrs=L,Ge.ssz=w;var Ft={},et=[],Lt=[],ba=[];T(P,Ge,we,et,E,Ft,Lt,W),m(Lt,ba,et),et.shift();var Ta={FileIndex:Lt,FullPaths:ba};return _&&_.raw&&(Ta.raw={header:re,sectors:we}),Ta}function h(g){if(g[g.l]==80&&g[g.l+1]==75)return[0,0];g.chk(pe,"Header Signature: "),g.l+=16;var _=g.read_shift(2,"u");return[g.read_shift(2,"u"),_]}function d(g,_){var v=9;switch(g.l+=2,v=g.read_shift(2)){case 9:if(_!=3)throw new Error("Sector Shift: Expected 9 saw "+v);break;case 12:if(_!=4)throw new Error("Sector Shift: Expected 12 saw "+v);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+v)}g.chk("0600","Mini Sector Shift: "),g.chk("000000000000","Reserved: ")}function u(g,_){for(var v=Math.ceil(g.length/_)-1,w=[],E=1;E<v;++E)w[E-1]=g.slice(E*_,(E+1)*_);return w[v-1]=g.slice(v*_),w}function m(g,_,v){for(var w=0,E=0,k=0,P=0,W=0,B=v.length,L=[],M=[];w<B;++w)L[w]=M[w]=w,_[w]=v[w];for(;W<M.length;++W)w=M[W],E=g[w].L,k=g[w].R,P=g[w].C,L[w]===w&&(E!==-1&&L[E]!==E&&(L[w]=L[E]),k!==-1&&L[k]!==k&&(L[w]=L[k])),P!==-1&&(L[P]=w),E!==-1&&w!=L[w]&&(L[E]=L[w],M.lastIndexOf(E)<W&&M.push(E)),k!==-1&&w!=L[w]&&(L[k]=L[w],M.lastIndexOf(k)<W&&M.push(k));for(w=1;w<B;++w)L[w]===w&&(k!==-1&&L[k]!==k?L[w]=L[k]:E!==-1&&L[E]!==E&&(L[w]=L[E]));for(w=1;w<B;++w)if(g[w].type!==0){if(W=w,W!=L[W])do W=L[W],_[w]=_[W]+"/"+_[w];while(W!==0&&L[W]!==-1&&W!=L[W]);L[w]=-1}for(_[0]+="/",w=1;w<B;++w)g[w].type!==2&&(_[w]+="/")}function p(g,_,v){for(var w=g.start,E=g.size,k=[],P=w;v&&E>0&&P>=0;)k.push(_.slice(P*j,P*j+j)),E-=j,P=Ur(v,P*4);return k.length===0?H(0):dt(k).slice(0,g.size)}function x(g,_,v,w,E){var k=se;if(g===se){if(_!==0)throw new Error("DIFAT chain shorter than expected")}else if(g!==-1){var P=v[g],W=(w>>>2)-1;if(!P)return;for(var B=0;B<W&&(k=Ur(P,B*4))!==se;++B)E.push(k);x(Ur(P,w-4),_-1,v,w,E)}}function S(g,_,v,w,E){var k=[],P=[];E||(E=[]);var W=w-1,B=0,L=0;for(B=_;B>=0;){E[B]=!0,k[k.length]=B,P.push(g[B]);var M=v[Math.floor(B*4/w)];if(L=B*4&W,w<4+L)throw new Error("FAT boundary crossed: "+B+" 4 "+w);if(!g[M])break;B=Ur(g[M],L)}return{nodes:k,data:Qs([P])}}function y(g,_,v,w){var E=g.length,k=[],P=[],W=[],B=[],L=w-1,M=0,J=0,re=0,ue=0;for(M=0;M<E;++M)if(W=[],re=M+_,re>=E&&(re-=E),!P[re]){B=[];var ae=[];for(J=re;J>=0;){ae[J]=!0,P[J]=!0,W[W.length]=J,B.push(g[J]);var ne=v[Math.floor(J*4/w)];if(ue=J*4&L,w<4+ue)throw new Error("FAT boundary crossed: "+J+" 4 "+w);if(!g[ne]||(J=Ur(g[ne],ue),ae[J]))break}k[re]={nodes:W,data:Qs([B])}}return k}function T(g,_,v,w,E,k,P,W){for(var B=0,L=w.length?2:0,M=_[g].data,J=0,re=0,ue;J<M.length;J+=128){var ae=M.slice(J,J+128);Mt(ae,64),re=ae.read_shift(2),ue=Hn(ae,0,re-L),w.push(ue);var ne={name:ue,type:ae.read_shift(1),color:ae.read_shift(1),L:ae.read_shift(4,"i"),R:ae.read_shift(4,"i"),C:ae.read_shift(4,"i"),clsid:ae.read_shift(16),state:ae.read_shift(4,"i"),start:0,size:0},we=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);we!==0&&(ne.ct=D(ae,ae.l-8));var Ge=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Ge!==0&&(ne.mt=D(ae,ae.l-8)),ne.start=ae.read_shift(4,"i"),ne.size=ae.read_shift(4,"i"),ne.size<0&&ne.start<0&&(ne.size=ne.type=0,ne.start=se,ne.name=""),ne.type===5?(B=ne.start,E>0&&B!==se&&(_[B].name="!StreamData")):ne.size>=4096?(ne.storage="fat",_[ne.start]===void 0&&(_[ne.start]=S(v,ne.start,_.fat_addrs,_.ssz)),_[ne.start].name=ne.name,ne.content=_[ne.start].data.slice(0,ne.size)):(ne.storage="minifat",ne.size<0?ne.size=0:B!==se&&ne.start!==se&&_[B]&&(ne.content=p(ne,_[B].data,(_[W]||{}).data))),ne.content&&Mt(ne.content,0),k[ue]=ne,P.push(ne)}}function D(g,_){return new Date((it(g,_+4)/1e7*Math.pow(2,32)+it(g,_)/1e7-11644473600)*1e3)}function N(g,_){return l(),f(c.readFileSync(g),_)}function K(g,_){var v=_&&_.type;switch(v||Pe&&Buffer.isBuffer(g)&&(v="buffer"),v||"base64"){case"file":return N(g,_);case"base64":return f(er(xr(g)),_);case"binary":return f(er(g),_)}return f(g,_)}function b(g,_){var v=_||{},w=v.root||"Root Entry";if(g.FullPaths||(g.FullPaths=[]),g.FileIndex||(g.FileIndex=[]),g.FullPaths.length!==g.FileIndex.length)throw new Error("inconsistent CFB structure");g.FullPaths.length===0&&(g.FullPaths[0]=w+"/",g.FileIndex[0]={name:w,type:5}),v.CLSID&&(g.FileIndex[0].clsid=v.CLSID),O(g)}function O(g){var _="Sh33tJ5";if(!Ve.find(g,"/"+_)){var v=H(4);v[0]=55,v[1]=v[3]=50,v[2]=54,g.FileIndex.push({name:_,type:2,content:v,size:4,L:69,R:69,C:69}),g.FullPaths.push(g.FullPaths[0]+_),A(g)}}function A(g,_){b(g);for(var v=!1,w=!1,E=g.FullPaths.length-1;E>=0;--E){var k=g.FileIndex[E];switch(k.type){case 0:w?v=!0:(g.FileIndex.pop(),g.FullPaths.pop());break;case 1:case 2:case 5:w=!0,isNaN(k.R*k.L*k.C)&&(v=!0),k.R>-1&&k.L>-1&&k.R==k.L&&(v=!0);break;default:v=!0;break}}if(!(!v&&!_)){var P=new Date(1987,1,19),W=0,B=Object.create?Object.create(null):{},L=[];for(E=0;E<g.FullPaths.length;++E)B[g.FullPaths[E]]=!0,g.FileIndex[E].type!==0&&L.push([g.FullPaths[E],g.FileIndex[E]]);for(E=0;E<L.length;++E){var M=a(L[E][0]);w=B[M],w||(L.push([M,{name:n(M).replace("/",""),type:1,clsid:ye,ct:P,mt:P,content:null}]),B[M]=!0)}for(L.sort(function(ue,ae){return r(ue[0],ae[0])}),g.FullPaths=[],g.FileIndex=[],E=0;E<L.length;++E)g.FullPaths[E]=L[E][0],g.FileIndex[E]=L[E][1];for(E=0;E<L.length;++E){var J=g.FileIndex[E],re=g.FullPaths[E];if(J.name=n(re).replace("/",""),J.L=J.R=J.C=-(J.color=1),J.size=J.content?J.content.length:0,J.start=0,J.clsid=J.clsid||ye,E===0)J.C=L.length>1?1:-1,J.size=0,J.type=5;else if(re.slice(-1)=="/"){for(W=E+1;W<L.length&&a(g.FullPaths[W])!=re;++W);for(J.C=W>=L.length?-1:W,W=E+1;W<L.length&&a(g.FullPaths[W])!=a(re);++W);J.R=W>=L.length?-1:W,J.type=1}else a(g.FullPaths[E+1]||"")==a(re)&&(J.R=E+1),J.type=2}}}function I(g,_){var v=_||{};if(v.fileType=="mad")return Zr(g,v);switch(A(g),v.fileType){case"zip":return Ae(g,v)}var w=(function(ue){for(var ae=0,ne=0,we=0;we<ue.FileIndex.length;++we){var Ge=ue.FileIndex[we];if(Ge.content){var Ft=Ge.content.length;Ft>0&&(Ft<4096?ae+=Ft+63>>6:ne+=Ft+511>>9)}}for(var et=ue.FullPaths.length+3>>2,Lt=ae+7>>3,ba=ae+127>>7,Ta=Lt+ne+et+ba,$r=Ta+127>>7,di=$r<=109?0:Math.ceil(($r-109)/127);Ta+$r+di+127>>7>$r;)di=++$r<=109?0:Math.ceil(($r-109)/127);var dr=[1,di,$r,ba,et,ne,ae,0];return ue.FileIndex[0].size=ae<<6,dr[7]=(ue.FileIndex[0].start=dr[0]+dr[1]+dr[2]+dr[3]+dr[4]+dr[5])+(dr[6]+7>>3),dr})(g),E=H(w[7]<<9),k=0,P=0;{for(k=0;k<8;++k)E.write_shift(1,ee[k]);for(k=0;k<8;++k)E.write_shift(2,0);for(E.write_shift(2,62),E.write_shift(2,3),E.write_shift(2,65534),E.write_shift(2,9),E.write_shift(2,6),k=0;k<3;++k)E.write_shift(2,0);for(E.write_shift(4,0),E.write_shift(4,w[2]),E.write_shift(4,w[0]+w[1]+w[2]+w[3]-1),E.write_shift(4,0),E.write_shift(4,4096),E.write_shift(4,w[3]?w[0]+w[1]+w[2]-1:se),E.write_shift(4,w[3]),E.write_shift(-4,w[1]?w[0]-1:se),E.write_shift(4,w[1]),k=0;k<109;++k)E.write_shift(-4,k<w[2]?w[1]+k:-1)}if(w[1])for(P=0;P<w[1];++P){for(;k<236+P*127;++k)E.write_shift(-4,k<w[2]?w[1]+k:-1);E.write_shift(-4,P===w[1]-1?se:P+1)}var W=function(ue){for(P+=ue;k<P-1;++k)E.write_shift(-4,k+1);ue&&(++k,E.write_shift(-4,se))};for(P=k=0,P+=w[1];k<P;++k)E.write_shift(-4,Se.DIFSECT);for(P+=w[2];k<P;++k)E.write_shift(-4,Se.FATSECT);W(w[3]),W(w[4]);for(var B=0,L=0,M=g.FileIndex[0];B<g.FileIndex.length;++B)M=g.FileIndex[B],M.content&&(L=M.content.length,!(L<4096)&&(M.start=P,W(L+511>>9)));for(W(w[6]+7>>3);E.l&511;)E.write_shift(-4,Se.ENDOFCHAIN);for(P=k=0,B=0;B<g.FileIndex.length;++B)M=g.FileIndex[B],M.content&&(L=M.content.length,!(!L||L>=4096)&&(M.start=P,W(L+63>>6)));for(;E.l&511;)E.write_shift(-4,Se.ENDOFCHAIN);for(k=0;k<w[4]<<2;++k){var J=g.FullPaths[k];if(!J||J.length===0){for(B=0;B<17;++B)E.write_shift(4,0);for(B=0;B<3;++B)E.write_shift(4,-1);for(B=0;B<12;++B)E.write_shift(4,0);continue}M=g.FileIndex[k],k===0&&(M.start=M.size?M.start-1:se);var re=k===0&&v.root||M.name;if(L=2*(re.length+1),E.write_shift(64,re,"utf16le"),E.write_shift(2,L),E.write_shift(1,M.type),E.write_shift(1,M.color),E.write_shift(-4,M.L),E.write_shift(-4,M.R),E.write_shift(-4,M.C),M.clsid)E.write_shift(16,M.clsid,"hex");else for(B=0;B<4;++B)E.write_shift(4,0);E.write_shift(4,M.state||0),E.write_shift(4,0),E.write_shift(4,0),E.write_shift(4,0),E.write_shift(4,0),E.write_shift(4,M.start),E.write_shift(4,M.size),E.write_shift(4,0)}for(k=1;k<g.FileIndex.length;++k)if(M=g.FileIndex[k],M.size>=4096)if(E.l=M.start+1<<9,Pe&&Buffer.isBuffer(M.content))M.content.copy(E,E.l,0,M.size),E.l+=M.size+511&-512;else{for(B=0;B<M.size;++B)E.write_shift(1,M.content[B]);for(;B&511;++B)E.write_shift(1,0)}for(k=1;k<g.FileIndex.length;++k)if(M=g.FileIndex[k],M.size>0&&M.size<4096)if(Pe&&Buffer.isBuffer(M.content))M.content.copy(E,E.l,0,M.size),E.l+=M.size+63&-64;else{for(B=0;B<M.size;++B)E.write_shift(1,M.content[B]);for(;B&63;++B)E.write_shift(1,0)}if(Pe)E.l=E.length;else for(;E.l<E.length;)E.write_shift(1,0);return E}function V(g,_){var v=g.FullPaths.map(function(B){return B.toUpperCase()}),w=v.map(function(B){var L=B.split("/");return L[L.length-(B.slice(-1)=="/"?2:1)]}),E=!1;_.charCodeAt(0)===47?(E=!0,_=v[0].slice(0,-1)+_):E=_.indexOf("/")!==-1;var k=_.toUpperCase(),P=E===!0?v.indexOf(k):w.indexOf(k);if(P!==-1)return g.FileIndex[P];var W=!k.match(gn);for(k=k.replace(ia,""),W&&(k=k.replace(gn,"!")),P=0;P<v.length;++P)if((W?v[P].replace(gn,"!"):v[P]).replace(ia,"")==k||(W?w[P].replace(gn,"!"):w[P]).replace(ia,"")==k)return g.FileIndex[P];return null}var j=64,se=-2,pe="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],ye="00000000000000000000000000000000",Se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:se,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ye,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Xe(g,_,v){l();var w=I(g,v);c.writeFileSync(_,w)}function Ce(g){for(var _=new Array(g.length),v=0;v<g.length;++v)_[v]=String.fromCharCode(g[v]);return _.join("")}function be(g,_){var v=I(g,_);switch(_&&_.type||"buffer"){case"file":return l(),c.writeFileSync(_.filename,v),v;case"binary":return typeof v=="string"?v:Ce(v);case"base64":return $a(typeof v=="string"?v:Ce(v));case"buffer":if(Pe)return Buffer.isBuffer(v)?v:wr(v);case"array":return typeof v=="string"?er(v):v}return v}var Fe;function C(g){try{var _=g.InflateRaw,v=new _;if(v._processChunk(new Uint8Array([3,0]),v._finishFlushFlag),v.bytesRead)Fe=g;else throw new Error("zlib does not expose bytesRead")}catch(w){console.error("cannot use native zlib: "+(w.message||w))}}function U(g,_){if(!Fe)return Ea(g,_);var v=Fe.InflateRaw,w=new v,E=w._processChunk(g.slice(g.l),w._finishFlushFlag);return g.l+=w.bytesRead,E}function R(g){return Fe?Fe.deflateRawSync(g):sn(g)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(g){var _=(g<<1|g<<11)&139536|(g<<5|g<<15)&558144;return(_>>16|_>>8|_)&255}for(var oe=typeof Uint8Array!="undefined",Z=oe?new Uint8Array(256):[],Re=0;Re<256;++Re)Z[Re]=me(Re);function ke(g,_){var v=Z[g&255];return _<=8?v>>>8-_:(v=v<<8|Z[g>>8&255],_<=16?v>>>16-_:(v=v<<8|Z[g>>16&255],v>>>24-_))}function Ze(g,_){var v=_&7,w=_>>>3;return(g[w]|(v<=6?0:g[w+1]<<8))>>>v&3}function ie(g,_){var v=_&7,w=_>>>3;return(g[w]|(v<=5?0:g[w+1]<<8))>>>v&7}function q(g,_){var v=_&7,w=_>>>3;return(g[w]|(v<=4?0:g[w+1]<<8))>>>v&15}function z(g,_){var v=_&7,w=_>>>3;return(g[w]|(v<=3?0:g[w+1]<<8))>>>v&31}function fe(g,_){var v=_&7,w=_>>>3;return(g[w]|(v<=1?0:g[w+1]<<8))>>>v&127}function Ct(g,_,v){var w=_&7,E=_>>>3,k=(1<<v)-1,P=g[E]>>>w;return v<8-w||(P|=g[E+1]<<8-w,v<16-w)||(P|=g[E+2]<<16-w,v<24-w)||(P|=g[E+3]<<24-w),P&k}function De(g,_,v){var w=_&7,E=_>>>3;return w<=5?g[E]|=(v&7)<<w:(g[E]|=v<<w&255,g[E+1]=(v&7)>>8-w),_+3}function Ht(g,_,v){var w=_&7,E=_>>>3;return v=(v&1)<<w,g[E]|=v,_+1}function Sr(g,_,v){var w=_&7,E=_>>>3;return v<<=w,g[E]|=v&255,v>>>=8,g[E+1]=v,_+8}function nn(g,_,v){var w=_&7,E=_>>>3;return v<<=w,g[E]|=v&255,v>>>=8,g[E+1]=v&255,g[E+2]=v>>>8,_+16}function _a(g,_){var v=g.length,w=2*v>_?2*v:_+5,E=0;if(v>=_)return g;if(Pe){var k=Ms(w);if(g.copy)g.copy(k);else for(;E<g.length;++E)k[E]=g[E];return k}else if(oe){var P=new Uint8Array(w);if(P.set)P.set(g);else for(;E<v;++E)P[E]=g[E];return P}return g.length=w,g}function Wt(g){for(var _=new Array(g),v=0;v<g;++v)_[v]=0;return _}function nr(g,_,v){var w=1,E=0,k=0,P=0,W=0,B=g.length,L=oe?new Uint16Array(32):Wt(32);for(k=0;k<32;++k)L[k]=0;for(k=B;k<v;++k)g[k]=0;B=g.length;var M=oe?new Uint16Array(B):Wt(B);for(k=0;k<B;++k)L[E=g[k]]++,w<E&&(w=E),M[k]=0;for(L[0]=0,k=1;k<=w;++k)L[k+16]=W=W+L[k-1]<<1;for(k=0;k<B;++k)W=g[k],W!=0&&(M[k]=L[W+16]++);var J=0;for(k=0;k<B;++k)if(J=g[k],J!=0)for(W=ke(M[k],w)>>w-J,P=(1<<w+4-J)-1;P>=0;--P)_[W|P<<J]=J&15|k<<4;return w}var fr=oe?new Uint16Array(512):Wt(512),ur=oe?new Uint16Array(32):Wt(32);if(!oe){for(var Pt=0;Pt<512;++Pt)fr[Pt]=0;for(Pt=0;Pt<32;++Pt)ur[Pt]=0}(function(){for(var g=[],_=0;_<32;_++)g.push(5);nr(g,ur,32);var v=[];for(_=0;_<=143;_++)v.push(8);for(;_<=255;_++)v.push(9);for(;_<=279;_++)v.push(7);for(;_<=287;_++)v.push(8);nr(v,fr,288)})();var fi=(function(){for(var _=oe?new Uint8Array(32768):[],v=0,w=0;v<le.length-1;++v)for(;w<le[v+1];++w)_[w]=v;for(;w<32768;++w)_[w]=29;var E=oe?new Uint8Array(259):[];for(v=0,w=0;v<Y.length-1;++v)for(;w<Y[v+1];++w)E[w]=v;function k(W,B){for(var L=0;L<W.length;){var M=Math.min(65535,W.length-L),J=L+M==W.length;for(B.write_shift(1,+J),B.write_shift(2,M),B.write_shift(2,~M&65535);M-- >0;)B[B.l++]=W[L++]}return B.l}function P(W,B){for(var L=0,M=0,J=oe?new Uint16Array(32768):[];M<W.length;){var re=Math.min(65535,W.length-M);if(re<10){for(L=De(B,L,+(M+re==W.length)),L&7&&(L+=8-(L&7)),B.l=L/8|0,B.write_shift(2,re),B.write_shift(2,~re&65535);re-- >0;)B[B.l++]=W[M++];L=B.l*8;continue}L=De(B,L,+(M+re==W.length)+2);for(var ue=0;re-- >0;){var ae=W[M];ue=(ue<<5^ae)&32767;var ne=-1,we=0;if((ne=J[ue])&&(ne|=M&-32768,ne>M&&(ne-=32768),ne<M))for(;W[ne+we]==W[M+we]&&we<250;)++we;if(we>2){ae=E[we],ae<=22?L=Sr(B,L,Z[ae+1]>>1)-1:(Sr(B,L,3),L+=5,Sr(B,L,Z[ae-23]>>5),L+=3);var Ge=ae<8?0:ae-4>>2;Ge>0&&(nn(B,L,we-Y[ae]),L+=Ge),ae=_[M-ne],L=Sr(B,L,Z[ae]>>3),L-=3;var Ft=ae<4?0:ae-2>>1;Ft>0&&(nn(B,L,M-ne-le[ae]),L+=Ft);for(var et=0;et<we;++et)J[ue]=M&32767,ue=(ue<<5^W[M])&32767,++M;re-=we-1}else ae<=143?ae=ae+48:L=Ht(B,L,1),L=Sr(B,L,Z[ae]),J[ue]=M&32767,++M}L=Sr(B,L,0)-1}return B.l=(L+7)/8|0,B.l}return function(B,L){return B.length<8?k(B,L):P(B,L)}})();function sn(g){var _=H(50+Math.floor(g.length*1.1)),v=fi(g,_);return _.slice(0,v)}var on=oe?new Uint16Array(32768):Wt(32768),cn=oe?new Uint16Array(32768):Wt(32768),ln=oe?new Uint16Array(128):Wt(128),Br=1,fn=1;function qr(g,_){var v=z(g,_)+257;_+=5;var w=z(g,_)+1;_+=5;var E=q(g,_)+4;_+=4;for(var k=0,P=oe?new Uint8Array(19):Wt(19),W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,L=oe?new Uint8Array(8):Wt(8),M=oe?new Uint8Array(8):Wt(8),J=P.length,re=0;re<E;++re)P[F[re]]=k=ie(g,_),B<k&&(B=k),L[k]++,_+=3;var ue=0;for(L[0]=0,re=1;re<=B;++re)M[re]=ue=ue+L[re-1]<<1;for(re=0;re<J;++re)(ue=P[re])!=0&&(W[re]=M[ue]++);var ae=0;for(re=0;re<J;++re)if(ae=P[re],ae!=0){ue=Z[W[re]]>>8-ae;for(var ne=(1<<7-ae)-1;ne>=0;--ne)ln[ue|ne<<ae]=ae&7|re<<3}var we=[];for(B=1;we.length<v+w;)switch(ue=ln[fe(g,_)],_+=ue&7,ue>>>=3){case 16:for(k=3+Ze(g,_),_+=2,ue=we[we.length-1];k-- >0;)we.push(ue);break;case 17:for(k=3+ie(g,_),_+=3;k-- >0;)we.push(0);break;case 18:for(k=11+fe(g,_),_+=7;k-- >0;)we.push(0);break;default:we.push(ue),B<ue&&(B=ue);break}var Ge=we.slice(0,v),Ft=we.slice(v);for(re=v;re<286;++re)Ge[re]=0;for(re=w;re<30;++re)Ft[re]=0;return Br=nr(Ge,on,286),fn=nr(Ft,cn,30),_}function ui(g,_){if(g[0]==3&&!(g[1]&3))return[Wr(_),2];for(var v=0,w=0,E=Ms(_||1<<18),k=0,P=E.length>>>0,W=0,B=0;(w&1)==0;){if(w=ie(g,v),v+=3,w>>>1)w>>1==1?(W=9,B=5):(v=qr(g,v),W=Br,B=fn);else{v&7&&(v+=8-(v&7));var L=g[v>>>3]|g[(v>>>3)+1]<<8;if(v+=32,L>0)for(!_&&P<k+L&&(E=_a(E,k+L),P=E.length);L-- >0;)E[k++]=g[v>>>3],v+=8;continue}for(;;){!_&&P<k+32767&&(E=_a(E,k+32767),P=E.length);var M=Ct(g,v,W),J=w>>>1==1?fr[M]:on[M];if(v+=J&15,J>>>=4,(J>>>8&255)===0)E[k++]=J;else{if(J==256)break;J-=257;var re=J<8?0:J-4>>2;re>5&&(re=0);var ue=k+Y[J];re>0&&(ue+=Ct(g,v,re),v+=re),M=Ct(g,v,B),J=w>>>1==1?ur[M]:cn[M],v+=J&15,J>>>=4;var ae=J<4?0:J-2>>1,ne=le[J];for(ae>0&&(ne+=Ct(g,v,ae),v+=ae),!_&&P<ue&&(E=_a(E,ue+100),P=E.length);k<ue;)E[k]=E[k-ne],++k}}}return _?[E,v+7>>>3]:[E.slice(0,k),v+7>>>3]}function Ea(g,_){var v=g.slice(g.l||0),w=ui(v,_);return g.l+=w[1],w[0]}function ka(g,_){if(g)typeof console!="undefined"&&console.error(_);else throw new Error(_)}function G(g,_){var v=g;Mt(v,0);var w=[],E=[],k={FileIndex:w,FullPaths:E};b(k,{root:_.root});for(var P=v.length-4;(v[P]!=80||v[P+1]!=75||v[P+2]!=5||v[P+3]!=6)&&P>=0;)--P;v.l=P+4,v.l+=4;var W=v.read_shift(2);v.l+=6;var B=v.read_shift(4);for(v.l=B,P=0;P<W;++P){v.l+=20;var L=v.read_shift(4),M=v.read_shift(4),J=v.read_shift(2),re=v.read_shift(2),ue=v.read_shift(2);v.l+=8;var ae=v.read_shift(4),ne=o(v.slice(v.l+J,v.l+J+re));v.l+=J+re+ue;var we=v.l;v.l=ae+4,ce(v,L,M,k,ne),v.l=we}return k}function ce(g,_,v,w,E){g.l+=2;var k=g.read_shift(2),P=g.read_shift(2),W=s(g);if(k&8257)throw new Error("Unsupported ZIP encryption");for(var B=g.read_shift(4),L=g.read_shift(4),M=g.read_shift(4),J=g.read_shift(2),re=g.read_shift(2),ue="",ae=0;ae<J;++ae)ue+=String.fromCharCode(g[g.l++]);if(re){var ne=o(g.slice(g.l,g.l+re));(ne[21589]||{}).mt&&(W=ne[21589].mt),((E||{})[21589]||{}).mt&&(W=E[21589].mt)}g.l+=re;var we=g.slice(g.l,g.l+L);switch(P){case 8:we=U(g,M);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+P)}var Ge=!1;k&8&&(B=g.read_shift(4),B==134695760&&(B=g.read_shift(4),Ge=!0),L=g.read_shift(4),M=g.read_shift(4)),L!=_&&ka(Ge,"Bad compressed size: "+_+" != "+L),M!=v&&ka(Ge,"Bad uncompressed size: "+v+" != "+M),ge(w,ue,we,{unsafe:!0,mt:W})}function Ae(g,_){var v=_||{},w=[],E=[],k=H(1),P=v.compression?8:0,W=0,B=!1;B&&(W|=8);var L=0,M=0,J=0,re=0,ue=g.FullPaths[0],ae=ue,ne=g.FileIndex[0],we=[],Ge=0;for(L=1;L<g.FullPaths.length;++L)if(ae=g.FullPaths[L].slice(ue.length),ne=g.FileIndex[L],!(!ne.size||!ne.content||ae=="Sh33tJ5")){var Ft=J,et=H(ae.length);for(M=0;M<ae.length;++M)et.write_shift(1,ae.charCodeAt(M)&127);et=et.slice(0,et.l),we[re]=Pl.buf(ne.content,0);var Lt=ne.content;P==8&&(Lt=R(Lt)),k=H(30),k.write_shift(4,67324752),k.write_shift(2,20),k.write_shift(2,W),k.write_shift(2,P),ne.mt?i(k,ne.mt):k.write_shift(4,0),k.write_shift(-4,W&8?0:we[re]),k.write_shift(4,W&8?0:Lt.length),k.write_shift(4,W&8?0:ne.content.length),k.write_shift(2,et.length),k.write_shift(2,0),J+=k.length,w.push(k),J+=et.length,w.push(et),J+=Lt.length,w.push(Lt),W&8&&(k=H(12),k.write_shift(-4,we[re]),k.write_shift(4,Lt.length),k.write_shift(4,ne.content.length),J+=k.l,w.push(k)),k=H(46),k.write_shift(4,33639248),k.write_shift(2,0),k.write_shift(2,20),k.write_shift(2,W),k.write_shift(2,P),k.write_shift(4,0),k.write_shift(-4,we[re]),k.write_shift(4,Lt.length),k.write_shift(4,ne.content.length),k.write_shift(2,et.length),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(4,0),k.write_shift(4,Ft),Ge+=k.l,E.push(k),Ge+=et.length,E.push(et),++re}return k=H(22),k.write_shift(4,101010256),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,re),k.write_shift(2,re),k.write_shift(4,Ge),k.write_shift(4,J),k.write_shift(2,0),dt([dt(w),dt(E),k])}var Qe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vt(g,_){if(g.ctype)return g.ctype;var v=g.name||"",w=v.match(/\.([^\.]+)$/);return w&&Qe[w[1]]||_&&(w=(v=_).match(/[\.\\]([^\.\\])+$/),w&&Qe[w[1]])?Qe[w[1]]:"application/octet-stream"}function je(g){for(var _=$a(g),v=[],w=0;w<_.length;w+=76)v.push(_.slice(w,w+76));return v.join(`\r
`)+`\r
`}function He(g){var _=g.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(L){var M=L.charCodeAt(0).toString(16).toUpperCase();return"="+(M.length==1?"0"+M:M)});_=_.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),_.charAt(0)==`
`&&(_="=0D"+_.slice(1)),_=_.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var v=[],w=_.split(`\r
`),E=0;E<w.length;++E){var k=w[E];if(k.length==0){v.push("");continue}for(var P=0;P<k.length;){var W=76,B=k.slice(P,P+W);B.charAt(W-1)=="="?W--:B.charAt(W-2)=="="?W-=2:B.charAt(W-3)=="="&&(W-=3),B=k.slice(P,P+W),P+=W,P<k.length&&(B+="="),v.push(B)}}return v.join(`\r
`)}function Jt(g){for(var _=[],v=0;v<g.length;++v){for(var w=g[v];v<=g.length&&w.charAt(w.length-1)=="=";)w=w.slice(0,w.length-1)+g[++v];_.push(w)}for(var E=0;E<_.length;++E)_[E]=_[E].replace(/[=][0-9A-Fa-f]{2}/g,function(k){return String.fromCharCode(parseInt(k.slice(1),16))});return er(_.join(`\r
`))}function jt(g,_,v){for(var w="",E="",k="",P,W=0;W<10;++W){var B=_[W];if(!B||B.match(/^\s*$/))break;var L=B.match(/^(.*?):\s*([^\s].*)$/);if(L)switch(L[1].toLowerCase()){case"content-location":w=L[2].trim();break;case"content-type":k=L[2].trim();break;case"content-transfer-encoding":E=L[2].trim();break}}switch(++W,E.toLowerCase()){case"base64":P=er(xr(_.slice(W).join("")));break;case"quoted-printable":P=Jt(_.slice(W));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+E)}var M=ge(g,w.slice(v.length),P,{unsafe:!0});k&&(M.ctype=k)}function Sa(g,_){if(Ce(g.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var v=_&&_.root||"",w=(Pe&&Buffer.isBuffer(g)?g.toString("binary"):Ce(g)).split(`\r
`),E=0,k="";for(E=0;E<w.length;++E)if(k=w[E],!!/^Content-Location:/i.test(k)&&(k=k.slice(k.indexOf("file")),v||(v=k.slice(0,k.lastIndexOf("/")+1)),k.slice(0,v.length)!=v))for(;v.length>0&&(v=v.slice(0,v.length-1),v=v.slice(0,v.lastIndexOf("/")+1),k.slice(0,v.length)!=v););var P=(w[1]||"").match(/boundary="(.*?)"/);if(!P)throw new Error("MAD cannot find boundary");var W="--"+(P[1]||""),B=[],L=[],M={FileIndex:B,FullPaths:L};b(M);var J,re=0;for(E=0;E<w.length;++E){var ue=w[E];ue!==W&&ue!==W+"--"||(re++&&jt(M,w.slice(J,E),v),J=E)}return M}function Zr(g,_){var v=_||{},w=v.boundary||"SheetJS";w="------="+w;for(var E=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+w.slice(2)+'"',"","",""],k=g.FullPaths[0],P=k,W=g.FileIndex[0],B=1;B<g.FullPaths.length;++B)if(P=g.FullPaths[B].slice(k.length),W=g.FileIndex[B],!(!W.size||!W.content||P=="Sh33tJ5")){P=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(we){return"_x"+we.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(we){return"_u"+we.charCodeAt(0).toString(16)+"_"});for(var L=W.content,M=Pe&&Buffer.isBuffer(L)?L.toString("binary"):Ce(L),J=0,re=Math.min(1024,M.length),ue=0,ae=0;ae<=re;++ae)(ue=M.charCodeAt(ae))>=32&&ue<128&&++J;var ne=J>=re*4/5;E.push(w),E.push("Content-Location: "+(v.root||"file:///C:/SheetJS/")+P),E.push("Content-Transfer-Encoding: "+(ne?"quoted-printable":"base64")),E.push("Content-Type: "+vt(W,P)),E.push(""),E.push(ne?He(M):je(M))}return E.push(w+`--\r
`),E.join(`\r
`)}function ve(g){var _={};return b(_,g),_}function ge(g,_,v,w){var E=w&&w.unsafe;E||b(g);var k=!E&&Ve.find(g,_);if(!k){var P=g.FullPaths[0];_.slice(0,P.length)==P?P=_:(P.slice(-1)!="/"&&(P+="/"),P=(P+_).replace("//","/")),k={name:n(_),type:2},g.FileIndex.push(k),g.FullPaths.push(P),E||Ve.utils.cfb_gc(g)}return k.content=v,k.size=v?v.length:0,w&&(w.CLSID&&(k.clsid=w.CLSID),w.mt&&(k.mt=w.mt),w.ct&&(k.ct=w.ct)),k}function Mr(g,_){b(g);var v=Ve.find(g,_);if(v){for(var w=0;w<g.FileIndex.length;++w)if(g.FileIndex[w]==v)return g.FileIndex.splice(w,1),g.FullPaths.splice(w,1),!0}return!1}function Gt(g,_,v){b(g);var w=Ve.find(g,_);if(w){for(var E=0;E<g.FileIndex.length;++E)if(g.FileIndex[E]==w)return g.FileIndex[E].name=n(v),g.FullPaths[E]=v,!0}return!1}function _t(g){A(g,!0)}return t.find=V,t.read=K,t.parse=f,t.write=be,t.writeFile=Xe,t.utils={cfb_new:ve,cfb_add:ge,cfb_del:Mr,cfb_mov:Gt,cfb_gc:_t,ReadShift:Na,CheckField:Jo,prep_blob:Mt,bconcat:dt,use_zlib:C,_deflateRaw:sn,_inflateRaw:Ea,consts:Se},t})(),vn;function Ll(e){return typeof e=="string"?Bn(e):Array.isArray(e)?cl(e):e}function Ga(e,t,r){if(typeof vn!="undefined"&&vn.writeFileSync)return r?vn.writeFileSync(e,t,r):vn.writeFileSync(e,t);if(typeof Deno!="undefined"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Bn(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?hr(t):t;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(a,e);if(typeof Blob!="undefined"){var n=new Blob([Ll(a)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs!="undefined")return saveAs(n,e);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=ja(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function mt(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function zs(e,t){for(var r=[],a=mt(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function Li(e){for(var t=[],r=mt(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Un(e){for(var t=[],r=mt(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function Bl(e){for(var t=[],r=mt(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var An=new Date(1899,11,30,0,0,0);function Dt(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var a=An.getTime()+(e.getTimezoneOffset()-An.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var Mo=new Date,Ml=An.getTime()+(Mo.getTimezoneOffset()-An.getTimezoneOffset())*6e4,Xs=Mo.getTimezoneOffset();function $o(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Ml),t.getTimezoneOffset()!==Xs&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Xs)*6e4),t}var Ys=new Date("2017-02-19T19:06:09.000Z"),Uo=isNaN(Ys.getFullYear())?new Date("2/19/17"):Ys,$l=Uo.getFullYear()==2017;function bt(e,t){var r=new Date(e);if($l)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Uo.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Vn(e,t){if(Pe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return hr(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return hr(ol(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder!="undefined")try{if(t){if(e[0]==255&&e[1]==254)return hr(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return hr(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function It(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=It(e[r]));return t}function Je(e,t){for(var r="";r.length<t;)r+=e;return r}function mr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var Ul=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ua(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Ul.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function _e(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Pe?a=wr(r):a=ll(r),Ve.utils.cfb_add(e,t,a)}Ve.utils.cfb_add(e,t,r)}else e.file(t,r)}function Bi(){return Ve.utils.cfb_new()}var at=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var Vl={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Mi=Li(Vl);var $i=/[&<>'"]/g,Hl=/[\u0000-\u0008\u000b-\u001f]/g;function $e(e){var t=e+"";return t.replace($i,function(r){return Mi[r]}).replace(Hl,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ks(e){return $e(e).replace(/ /g,"_x0020_")}var Vo=/[\u0000-\u001f]/g;function Wl(e){var t=e+"";return t.replace($i,function(r){return Mi[r]}).replace(/\n/g,"<br/>").replace(Vo,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function jl(e){var t=e+"";return t.replace($i,function(r){return Mi[r]}).replace(Vo,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function Gl(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function zl(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ki(e){for(var t="",r=0,a=0,n=0,i=0,s=0,o=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){s=(a&31)<<6,s|=n&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Js(e){var t=Wr(2*e.length),r,a,n=1,i=0,s=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function qs(e){return wr(e,"binary").toString("utf8")}var wn="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Ia=Pe&&(qs(wn)==ki(wn)&&qs||Js(wn)==ki(wn)&&Js)||ki,hr=Pe?function(e){return wr(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")};var Xl=(function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})();var Ho=/(^\s|\s$|\n)/;function ht(e,t){return"<"+e+(t.match(Ho)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Va(e){return mt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Q(e,t,r){return"<"+e+(r!=null?Va(r):"")+(t!=null?(t.match(Ho)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Di(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Yl(e,t){switch(typeof e){case"string":var r=Q("vt:lpwstr",$e(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Q((e|0)==e?"vt:i4":"vt:r8",$e(String(e)));case"boolean":return Q("vt:bool",e?"true":"false")}if(e instanceof Date)return Q("vt:filetime",Di(e));throw new Error("Unable to serialize "+e)}var st={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},da=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$t={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Kl(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function Jl(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,s=a?-t:t;isFinite(s)?s==0?n=i=0:(n=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var Zs=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Qs=Pe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:wr(t)})):Zs(e)}:Zs,eo=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Da(e,n)));return a.join("").replace(ia,"")},Hn=Pe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ia,""):eo(e,t,r)}:eo,to=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},Wo=Pe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):to(e,t,r)}:to,ro=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(aa(e,n)));return a.join("")},ha=Pe?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):ro(t,r,a)}:ro,jo=function(e,t){var r=it(e,t);return r>0?ha(e,t+4,t+4+r-1):""},Ui=jo,Go=function(e,t){var r=it(e,t);return r>0?ha(e,t+4,t+4+r-1):""},Vi=Go,zo=function(e,t){var r=2*it(e,t);return r>0?ha(e,t+4,t+4+r-1):""},Hi=zo,Xo=function(t,r){var a=it(t,r);return a>0?Hn(t,r+4,r+4+a):""},Wi=Xo,Yo=function(e,t){var r=it(e,t);return r>0?ha(e,t+4,t+4+r):""},ji=Yo,Ko=function(e,t){return Kl(e,t)},Cn=Ko,Gi=function(t){return Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array};Pe&&(Ui=function(t,r){if(!Buffer.isBuffer(t))return jo(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Vi=function(t,r){if(!Buffer.isBuffer(t))return Go(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Hi=function(t,r){if(!Buffer.isBuffer(t))return zo(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Wi=function(t,r){if(!Buffer.isBuffer(t))return Xo(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},ji=function(t,r){if(!Buffer.isBuffer(t))return Yo(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Cn=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Ko(t,r)},Gi=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array});function ql(){Hn=function(e,t,r){return We.utils.decode(1200,e.slice(t,r)).replace(ia,"")},ha=function(e,t,r){return We.utils.decode(65001,e.slice(t,r))},Ui=function(e,t){var r=it(e,t);return r>0?We.utils.decode(fa,e.slice(t+4,t+4+r-1)):""},Vi=function(e,t){var r=it(e,t);return r>0?We.utils.decode(Vr,e.slice(t+4,t+4+r-1)):""},Hi=function(e,t){var r=2*it(e,t);return r>0?We.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Wi=function(e,t){var r=it(e,t);return r>0?We.utils.decode(1200,e.slice(t+4,t+4+r)):""},ji=function(e,t){var r=it(e,t);return r>0?We.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof We!="undefined"&&ql();var aa=function(e,t){return e[t]},Da=function(e,t){return e[t+1]*256+e[t]},Zl=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},it=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ur=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ql=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Na(e,t){var r="",a,n,i=[],s,o,c,l;switch(t){case"dbcs":if(l=this.l,Pe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Da(this,l)),l+=2;e*=2;break;case"utf8":r=ha(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Hn(this,this.l,this.l+e);break;case"wstr":if(typeof We!="undefined")r=We.utils.decode(Vr,this.slice(this.l,this.l+2*e));else return Na.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Ui(this,this.l),e=4+it(this,this.l);break;case"lpstr-cp":r=Vi(this,this.l),e=4+it(this,this.l);break;case"lpwstr":r=Hi(this,this.l),e=4+2*it(this,this.l);break;case"lpp4":e=4+it(this,this.l),r=Wi(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+it(this,this.l),r=ji(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=aa(this,this.l+e++))!==0;)i.push(mn(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Da(this,this.l+e))!==0;)i.push(mn(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=aa(this,l),this.l=l+1,o=Na.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(mn(Da(this,l))),l+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof We!="undefined"){r=We.utils.decode(Vr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=aa(this,l),this.l=l+1,o=Na.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(mn(aa(this,l))),l+=1}r=i.join("");break;default:switch(e){case 1:return a=aa(this,this.l),this.l++,a;case 2:return a=(t==="i"?Zl:Da)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Ur:Ql)(this,this.l),this.l+=4,a):(n=it(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Cn(this,this.l):n=Cn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=Wo(this,this.l,e);break}}return this.l+=e,r}var ef=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},tf=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},rf=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function af(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)rf(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){if(typeof We!="undefined"&&fa==874)for(n=0;n!=t.length;++n){var i=We.utils.encode(fa,t.charAt(n));this[this.l+n]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,ef(this,t,this.l);break;case 8:if(a=8,r==="f"){Jl(this,t,this.l);break}case 16:break;case-4:a=4,tf(this,t,this.l);break}return this.l+=a,this}function Jo(e,t){var r=Wo(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Mt(e,t){e.l=t,e.read_shift=Na,e.chk=Jo,e.write_shift=af}function cr(e,t){e.l+=t}function H(e){var t=Wr(e);return Mt(t,0),t}function Rt(){var e=[],t=Pe?256:2048,r=function(l){var f=H(l);return Mt(f,0),f},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(l){return a&&l<a.length-a.l?a:(n(),a=r(Math.max(l+1,t)))},s=function(){return n(),dt(e)},o=function(l){n(),a=l,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function X(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=q1[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var s=e.next(i);n<=127?s.write_shift(1,n):(s.write_shift(1,(n&127)+128),s.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)s.write_shift(1,(a&127)+128),a>>=7;else{s.write_shift(1,a);break}a>0&&Gi(r)&&e.push(r)}}function Oa(e,t,r){var a=It(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function ao(e,t,r){var a=It(e);return a.s=Oa(a.s,t.s,r),a.e=Oa(a.e,t.s,r),a}function Pa(e,t){if(e.cRel&&e.c<0)for(e=It(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=It(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=of(r)),!e.rRel&&e.rRel!=null&&(r=nf(r)),r}function Si(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+wt(e.s.c)+":"+(e.e.cRel?"":"$")+wt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+pt(e.s.r)+":"+(e.e.rRel?"":"$")+pt(e.e.r):Pa(e.s,t.biff)+":"+Pa(e.e,t.biff)}function zi(e){return parseInt(sf(e),10)-1}function pt(e){return""+(e+1)}function nf(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function sf(e){return e.replace(/\$(\d+)$/,"$1")}function Xi(e){for(var t=cf(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function wt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function of(e){return e.replace(/^([A-Z])/,"$$$1")}function cf(e){return e.replace(/^\$([A-Z])/,"$1")}function lf(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ot(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ut(e){var t=e.indexOf(":");return t==-1?{s:ot(e),e:ot(e)}:{s:ot(e.slice(0,t)),e:ot(e.slice(t+1))}}function rt(e,t){return typeof t=="undefined"||typeof t=="number"?rt(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function ze(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function no(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Cr(e.z,r?Dt(t):t)}catch{}try{return e.w=Cr((e.XF||{}).numFmtId||(r?14:0),r?Dt(t):t)}catch{return""+t}}function vr(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?za[e.v]||e.v:t==null?no(e,e.v):no(e,t))}function zr(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function qo(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense;or!=null&&n==null&&(n=or);var i=e||(n?[]:{}),s=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?ot(a.origin):a.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=ze(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),s==-1&&(l.e.r=s=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(typeof t[h][d]!="undefined"){var u={v:t[h][d]},m=s+h,p=o+d;if(l.s.r>m&&(l.s.r=m),l.s.c>p&&(l.s.c=p),l.e.r<m&&(l.e.r=m),l.e.c<p&&(l.e.c=p),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))u=t[h][d];else if(Array.isArray(u.v)&&(u.f=t[h][d][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(a.nullError)u.t="e",u.v=0;else if(a.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=a.dateNF||qe[14],a.cellDates?(u.t="d",u.w=Cr(u.z,Dt(u.v))):(u.t="n",u.v=Dt(u.v),u.w=Cr(u.z,u.v))):u.t="s";if(n)i[m]||(i[m]=[]),i[m][p]&&i[m][p].z&&(u.z=i[m][p].z),i[m][p]=u;else{var x=Ue({c:p,r:m});i[x]&&i[x].z&&(u.z=i[x].z),i[x]=u}}}return l.s.c<1e7&&(i["!ref"]=rt(l)),i}function pa(e,t){return qo(null,e,t)}function ff(e){return e.read_shift(4,"i")}function rr(e,t){return t||(t=H(4)),t.write_shift(4,e),t}function yt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ct(e,t){var r=!1;return t==null&&(r=!0,t=H(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function uf(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function df(e,t){return t||(t=H(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function Yi(e,t){var r=e.l,a=e.read_shift(1),n=yt(e),i=[],s={t:n,h:n};if((a&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(uf(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function hf(e,t){var r=!1;return t==null&&(r=!0,t=H(15+4*e.t.length)),t.write_shift(1,0),ct(e.t,t),r?t.slice(0,t.l):t}var pf=Yi;function mf(e,t){var r=!1;return t==null&&(r=!0,t=H(23+4*e.t.length)),t.write_shift(1,1),ct(e.t,t),t.write_shift(4,1),df({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Yt(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Xr(e,t){return t==null&&(t=H(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Yr(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Kr(e,t){return t==null&&(t=H(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var gf=yt,Zo=ct;function Ki(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Fn(e,t){var r=!1;return t==null&&(r=!0,t=H(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var xf=yt,Ii=Ki,Ji=Fn;function Qo(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?Cn([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ur(t,0)>>2;return r?n/100:n}function ec(e,t){t==null&&(t=H(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function tc(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function vf(e,t){return t||(t=H(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Jr=tc,ma=vf;function ga(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function jr(e,t){return(t||H(8)).write_shift(8,e,"f")}function wf(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var l=Cf[n];l&&(t.rgb=go(l));break;case 2:t.rgb=go([s,o,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Rn(e,t){if(t||(t=H(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function yf(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function _f(e,t){t||(t=H(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var rc=2,Bt=3,yn=11;var Dn=19;var _n=64,Ef=65,kf=71;var Sf=4108,bf=4126,ut=80;var io={1:{n:"CodePage",t:rc},2:{n:"Category",t:ut},3:{n:"PresentationFormat",t:ut},4:{n:"ByteCount",t:Bt},5:{n:"LineCount",t:Bt},6:{n:"ParagraphCount",t:Bt},7:{n:"SlideCount",t:Bt},8:{n:"NoteCount",t:Bt},9:{n:"HiddenCount",t:Bt},10:{n:"MultimediaClipCount",t:Bt},11:{n:"ScaleCrop",t:yn},12:{n:"HeadingPairs",t:Sf},13:{n:"TitlesOfParts",t:bf},14:{n:"Manager",t:ut},15:{n:"Company",t:ut},16:{n:"LinksUpToDate",t:yn},17:{n:"CharacterCount",t:Bt},19:{n:"SharedDoc",t:yn},22:{n:"HyperlinksChanged",t:yn},23:{n:"AppVersion",t:Bt,p:"version"},24:{n:"DigSig",t:Ef},26:{n:"ContentType",t:ut},27:{n:"ContentStatus",t:ut},28:{n:"Language",t:ut},29:{n:"Version",t:ut},255:{},2147483648:{n:"Locale",t:Dn},2147483651:{n:"Behavior",t:Dn},1919054434:{}},so={1:{n:"CodePage",t:rc},2:{n:"Title",t:ut},3:{n:"Subject",t:ut},4:{n:"Author",t:ut},5:{n:"Keywords",t:ut},6:{n:"Comments",t:ut},7:{n:"Template",t:ut},8:{n:"LastAuthor",t:ut},9:{n:"RevNumber",t:ut},10:{n:"EditTime",t:_n},11:{n:"LastPrinted",t:_n},12:{n:"CreatedDate",t:_n},13:{n:"ModifiedDate",t:_n},14:{n:"PageCount",t:Bt},15:{n:"WordCount",t:Bt},16:{n:"CharCount",t:Bt},17:{n:"Thumbnail",t:kf},18:{n:"Application",t:ut},19:{n:"DocSecurity",t:Bt},255:{},2147483648:{n:"Locale",t:Dn},2147483651:{n:"Behavior",t:Dn},1919054434:{}};function Tf(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Af=Tf([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Cf=It(Af),za={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var Ff={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},En={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ac(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function nc(e,t){var r=Bl(Ff),a=[],n;a[a.length]=at,a[a.length]=Q("Types",null,{xmlns:st.CT,"xmlns:xsd":st.xsd,"xmlns:xsi":st.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Q("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=Q("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:En[c][t.bookType]||En[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(l){a[a.length]=Q("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:En[c][t.bookType]||En[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(l){a[a.length]=Q("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Ie={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ic(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function oa(e){var t=[at,Q("Relationships",null,{xmlns:st.RELS})];return mt(e["!id"]).forEach(function(r){t[t.length]=Q("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Me(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,i?n.TargetMode=i:[Ie.HLINK,Ie.XPATH,Ie.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function Rf(e){var t=[at];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function oo(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Df(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function If(e){var t=[at];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(oo(e[r][0],e[r][1])),t.push(Df("",e[r][0]));return t.push(oo("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function sc(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ba.version+"</meta:generator></office:meta></office:document-meta>"}var Hr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function bi(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=$e(t),a[a.length]=r?Q(e,t,r):ht(e,t))}function oc(e,t){var r=t||{},a=[at,Q("cp:coreProperties",null,{"xmlns:cp":st.CORE_PROPS,"xmlns:dc":st.dc,"xmlns:dcterms":st.dcterms,"xmlns:dcmitype":st.dcmitype,"xmlns:xsi":st.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&bi("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Di(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&bi("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Di(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=Hr.length;++i){var s=Hr[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&bi(s[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var ca=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],cc=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function lc(e){var t=[],r=Q;return e||(e={}),e.Application="SheetJS",t[t.length]=at,t[t.length]=Q("Properties",null,{xmlns:st.EXT_PROPS,"xmlns:vt":st.vt}),ca.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=$e(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+$e(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function fc(e){var t=[at,Q("Properties",null,{xmlns:st.CUST_PROPS,"xmlns:vt":st.vt})];if(!e)return t.join("");var r=1;return mt(e).forEach(function(n){++r,t[t.length]=Q("property",Yl(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:$e(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var co={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Nf(e,t){var r=[];return mt(co).map(function(a){for(var n=0;n<Hr.length;++n)if(Hr[n][1]==a)return Hr[n];for(n=0;n<ca.length;++n)if(ca[n][1]==a)return ca[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(ht(co[a[1]]||a[1],n))}}),Q("DocumentProperties",r.join(""),{xmlns:$t.o})}function Of(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&mt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Hr.length;++s)if(i==Hr[s][1])return;for(s=0;s<ca.length;++s)if(i==ca[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(Q(Ks(i),o,{"dt:dt":c}))}}),t&&mt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),n.push(Q(Ks(i),s,{"dt:dt":o}))}}),"<"+a+' xmlns="'+$t.o+'">'+n.join("")+"</"+a+">"}function Pf(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var s=H(8);return s.write_shift(4,a),s.write_shift(4,n),s}function lo(e,t){var r=H(4),a=H(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=H(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=Pf(t);break;case 31:case 80:for(a=H(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return dt([r,a])}var uc=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Lf(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function fo(e,t,r){var a=H(8),n=[],i=[],s=8,o=0,c=H(8),l=H(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),i.push(c),n.push(l),s+=8+c.length,!t){l=H(8),l.write_shift(4,0),n.unshift(l);var f=[H(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(c=H(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=dt(f),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(uc.indexOf(e[o][0])>-1||cc.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],u=0;if(t){u=+t[e[o][0]];var m=r[u];if(m.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}c=lo(m.t,d)}else{var x=Lf(d);x==-1&&(x=31,d=String(d)),c=lo(x,d)}i.push(c),l=H(8),l.write_shift(4,t?u:2+o),n.push(l),s+=8+c.length}var S=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,S),S+=i[o].length;return a.write_shift(4,s),a.write_shift(4,i.length),dt([a].concat(n).concat(i))}function uo(e,t,r,a,n,i){var s=H(n?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Ve.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,n?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,n?68:48);var c=fo(e,r,a);if(o.push(c),n){var l=fo(n,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(l)}return dt(o)}function Bf(e,t){t||(t=H(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Mf(e,t){return e.read_shift(t)===1}function St(e,t){return t||(t=H(2)),t.write_shift(2,+!!e),t}function dc(e){return e.read_shift(2,"u")}function Xt(e,t){return t||(t=H(2)),t.write_shift(2,e),t}function hc(e,t,r){return r||(r=H(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function pc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont",i=Vr;if(r&&r.biff>=8&&(Vr=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return Vr=i,o}function $f(e){var t=e.t||"",r=1,a=H(3+(r>1?2:0));a.write_shift(2,t.length),a.write_shift(1,(r>1?8:0)|1),r>1&&a.write_shift(2,r);var n=H(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[a,n];return dt(i)}function Uf(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Vf(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Uf(e,a,r)}function Hf(e,t,r){if(r.biff>5)return Vf(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function mc(e,t,r){return r||(r=H(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function ho(e,t){t||(t=H(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Wf(e){var t=H(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)a=a.slice(1),ho(a,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&ho(n>-1?a.slice(n+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Gr(e,t,r,a){return a||(a=H(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function jf(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),s=e.read_shift(a,"i");return[n,i,s]}function Gf(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function gc(e,t){return t||(t=H(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function qi(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=H(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function zf(e,t){var r=!t||t.biff==8,a=H(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function Xf(e,t){var r=!t||t.biff>=8?2:1,a=H(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function Yf(e,t){var r=H(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=$f(e[n],t);var i=dt([r].concat(a));return i.parts=[r.length].concat(a.map(function(s){return s.length})),i}function Kf(){var e=H(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Jf(e){var t=H(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function qf(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=H(n);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function Zf(e,t,r,a){var n=H(10);return Gr(e,t,a,n),n.write_shift(4,r),n}function Qf(e,t,r,a,n){var i=!n||n.biff==8,s=H(8+ +i+(1+i)*r.length);return Gr(e,t,a,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function eu(e,t,r,a){var n=r&&r.biff==5;a||(a=H(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}function tu(e,t){var r=t.biff==8||!t.biff?4:2,a=H(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function po(e,t,r,a){var n=r&&r.biff==5;a||(a=H(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function ru(e){var t=H(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function au(e,t,r,a,n,i){var s=H(8);return Gr(e,t,a,s),hc(r,i,s),s}function nu(e,t,r,a){var n=H(14);return Gr(e,t,a,n),jr(r,n),n}function iu(e,t,r){if(r.biff<8)return su(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(jf(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function su(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=pc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function ou(e){var t=H(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)gc(e[r],t);return t}function cu(e){var t=H(24),r=ot(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return dt([t,Wf(e[1])])}function lu(e){var t=e[1].Tooltip,r=H(10+2*(t.length+1));r.write_shift(2,2048);var a=ot(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function fu(e){return e||(e=H(4)),e.write_shift(2,1),e.write_shift(2,1),e}function uu(e,t,r){if(!r.cellStyles)return cr(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:i,w:s,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function du(e,t){var r=H(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function hu(e){for(var t=H(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function pu(e,t,r){var a=H(15);return Ya(a,e,t),a.write_shift(8,r,"f"),a}function mu(e,t,r){var a=H(9);return Ya(a,e,t),a.write_shift(2,r),a}var gu=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Li({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],f=Wr(1);switch(c.type){case"base64":f=er(xr(o));break;case"binary":f=er(o);break;case"buffer":case"array":f=o;break}Mt(f,0);var h=f.read_shift(1),d=!!(h&136),u=!1,m=!1;switch(h){case 2:break;case 3:break;case 48:u=!0,d=!0;break;case 49:u=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,x=521;h==2&&(p=f.read_shift(2)),f.l+=3,h!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(x=f.read_shift(2));var S=f.read_shift(2),y=c.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var T=[],D={},N=Math.min(f.length,h==2?521:x-10-(u?264:0)),K=m?32:11;f.l<N&&f[f.l]!=13;)switch(D={},D.name=We.utils.decode(y,f.slice(f.l,f.l+K)).replace(/[\u0000\r\n].*$/g,""),f.l+=K,D.type=String.fromCharCode(f.read_shift(1)),h!=2&&!m&&(D.offset=f.read_shift(4)),D.len=f.read_shift(1),h==2&&(D.offset=f.read_shift(2)),D.dec=f.read_shift(1),D.name.length&&T.push(D),h!=2&&(f.l+=m?13:14),D.type){case"B":(!u||D.len!=8)&&c.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(f[f.l]!==13&&(f.l=x-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=x;var b=0,O=0;for(l[0]=[],O=0;O!=T.length;++O)l[0][O]=T[O].name;for(;p-- >0;){if(f[f.l]===42){f.l+=S;continue}for(++f.l,l[++b]=[],O=0,O=0;O!=T.length;++O){var A=f.slice(f.l,f.l+T[O].len);f.l+=T[O].len,Mt(A,0);var I=We.utils.decode(y,A);switch(T[O].type){case"C":I.trim().length&&(l[b][O]=I.replace(/\s+$/,""));break;case"D":I.length===8?l[b][O]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):l[b][O]=I;break;case"F":l[b][O]=parseFloat(I.trim());break;case"+":case"I":l[b][O]=m?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":l[b][O]=!0;break;case"N":case"F":l[b][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[b][O]="##MEMO##"+(m?parseInt(I.trim(),10):A.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(l[b][O]=+I||0);break;case"@":l[b][O]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":l[b][O]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":l[b][O]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[b][O]=-A.read_shift(-8,"f");break;case"B":if(u&&T[O].len==8){l[b][O]=A.read_shift(8,"f");break}case"G":case"P":A.l+=T[O].len;break;case"0":if(T[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[O].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=T,l}function a(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=pa(r(o,l),l);return f["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,f}function n(o,c){try{return zr(a(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var l=c||{};if(+l.codepage>=0&&Ma(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Rt(),h=Ln(o,{header:1,raw:!0,cellDates:!0}),d=h[0],u=h.slice(1),m=o["!cols"]||[],p=0,x=0,S=0,y=1;for(p=0;p<d.length;++p){if(((m[p]||{}).DBF||{}).name){d[p]=m[p].DBF.name,++S;continue}if(d[p]!=null){if(++S,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(x=0;x<1024;++x)if(d.indexOf(d[p]+"_"+x)==-1){d[p]+="_"+x;break}}}}var T=ze(o["!ref"]),D=[],N=[],K=[];for(p=0;p<=T.e.c-T.s.c;++p){var b="",O="",A=0,I=[];for(x=0;x<u.length;++x)u[x][p]!=null&&I.push(u[x][p]);if(I.length==0||d[p]==null){D[p]="?";continue}for(x=0;x<I.length;++x){switch(typeof I[x]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=I[x]instanceof Date?"D":"C";break;default:O="C"}A=Math.max(A,String(I[x]).length),b=b&&b!=O?"C":O}A>250&&(A=250),O=((m[p]||{}).DBF||{}).type,O=="C"&&m[p].DBF.len>A&&(A=m[p].DBF.len),b=="B"&&O=="N"&&(b="N",K[p]=m[p].DBF.dec,A=m[p].DBF.len),N[p]=b=="C"||O=="N"?A:i[b]||0,y+=N[p],D[p]=b}var V=f.next(32);for(V.write_shift(4,318902576),V.write_shift(4,u.length),V.write_shift(2,296+32*S),V.write_shift(2,y),p=0;p<4;++p)V.write_shift(4,0);for(V.write_shift(4,0|(+t[fa]||3)<<8),p=0,x=0;p<d.length;++p)if(d[p]!=null){var j=f.next(32),se=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,se,"sbcs"),j.write_shift(1,D[p]=="?"?"C":D[p],"sbcs"),j.write_shift(4,x),j.write_shift(1,N[p]||i[D[p]]||0),j.write_shift(1,K[p]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),x+=N[p]||i[D[p]]||0}var pe=f.next(264);for(pe.write_shift(4,13),p=0;p<65;++p)pe.write_shift(4,0);for(p=0;p<u.length;++p){var ee=f.next(y);for(ee.write_shift(1,0),x=0;x<d.length;++x)if(d[x]!=null)switch(D[x]){case"L":ee.write_shift(1,u[p][x]==null?63:u[p][x]?84:70);break;case"B":ee.write_shift(8,u[p][x]||0,"f");break;case"N":var ye="0";for(typeof u[p][x]=="number"&&(ye=u[p][x].toFixed(K[x]||0)),S=0;S<N[x]-ye.length;++S)ee.write_shift(1,32);ee.write_shift(1,ye,"sbcs");break;case"D":u[p][x]?(ee.write_shift(4,("0000"+u[p][x].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(u[p][x].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+u[p][x].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var Se=String(u[p][x]!=null?u[p][x]:"").slice(0,N[x]);for(ee.write_shift(1,Se,"sbcs"),S=0;S<N[x]-Se.length;++S)ee.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:s}})(),xu=(function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+mt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,u){var m=e[u];return typeof m=="number"?Bs(m):m},a=function(d,u,m){var p=u.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?d:Bs(p)};e["|"]=254;function n(d,u){switch(u.type){case"base64":return i(xr(d),u);case"binary":return i(d,u);case"buffer":return i(Pe&&Buffer.isBuffer(d)?d.toString("binary"):ja(d),u);case"array":return i(Vn(d),u)}throw new Error("Unrecognized type "+u.type)}function i(d,u){var m=d.split(/[\n\r]+/),p=-1,x=-1,S=0,y=0,T=[],D=[],N=null,K={},b=[],O=[],A=[],I=0,V;for(+u.codepage>=0&&Ma(+u.codepage);S!==m.length;++S){I=0;var j=m[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),se=j.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),pe=se[0],ee;if(j.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":se[1].charAt(0)=="P"&&D.push(j.slice(3).replace(/;;/g,";"));break;case"C":var ye=!1,Se=!1,Xe=!1,Ce=!1,be=-1,Fe=-1;for(y=1;y<se.length;++y)switch(se[y].charAt(0)){case"A":break;case"X":x=parseInt(se[y].slice(1))-1,Se=!0;break;case"Y":for(p=parseInt(se[y].slice(1))-1,Se||(x=0),V=T.length;V<=p;++V)T[V]=[];break;case"K":ee=se[y].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(mr(ee))?isNaN(Ua(ee).getDate())||(ee=bt(ee)):(ee=mr(ee),N!==null&&Po(N)&&(ee=$o(ee))),typeof We!="undefined"&&typeof ee=="string"&&(u||{}).type!="string"&&(u||{}).codepage&&(ee=We.utils.decode(u.codepage,ee)),ye=!0;break;case"E":Ce=!0;var C=md(se[y].slice(1),{r:p,c:x});T[p][x]=[T[p][x],C];break;case"S":Xe=!0,T[p][x]=[T[p][x],"S5S"];break;case"G":break;case"R":be=parseInt(se[y].slice(1))-1;break;case"C":Fe=parseInt(se[y].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+j)}if(ye&&(T[p][x]&&T[p][x].length==2?T[p][x][0]=ee:T[p][x]=ee,N=null),Xe){if(Ce)throw new Error("SYLK shared formula cannot have own formula");var U=be>-1&&T[be][Fe];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");T[p][x][1]=gd(U[1],{r:p-be,c:x-Fe})}break;case"F":var R=0;for(y=1;y<se.length;++y)switch(se[y].charAt(0)){case"X":x=parseInt(se[y].slice(1))-1,++R;break;case"Y":for(p=parseInt(se[y].slice(1))-1,V=T.length;V<=p;++V)T[V]=[];break;case"M":I=parseInt(se[y].slice(1))/20;break;case"F":break;case"G":break;case"P":N=D[parseInt(se[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=se[y].slice(1).split(" "),V=parseInt(A[0],10);V<=parseInt(A[1],10);++V)I=parseInt(A[2],10),O[V-1]=I===0?{hidden:!0}:{wch:I},Zi(O[V-1]);break;case"C":x=parseInt(se[y].slice(1))-1,O[x]||(O[x]={});break;case"R":p=parseInt(se[y].slice(1))-1,b[p]||(b[p]={}),I>0?(b[p].hpt=I,b[p].hpx=_c(I)):I===0&&(b[p].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+j)}R<1&&(N=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+j)}}return b.length>0&&(K["!rows"]=b),O.length>0&&(K["!cols"]=O),u&&u.sheetRows&&(T=T.slice(0,u.sheetRows)),[T,K]}function s(d,u){var m=n(d,u),p=m[0],x=m[1],S=pa(p,u);return mt(x).forEach(function(y){S[y]=x[y]}),S}function o(d,u){return zr(s(d,u),u)}function c(d,u,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(d.t){case"n":x+=d.v||0,d.f&&!d.F&&(x+=";E"+es(d.f,{r:m,c:p}));break;case"b":x+=d.v?"TRUE":"FALSE";break;case"e":x+=d.w||d.v;break;case"d":x+='"'+(d.w||d.v)+'"';break;case"s":x+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function l(d,u){u.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=In(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Nn(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&d.push(x)})}function f(d,u){u.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*On(m.hpx)+";"),x.length>2&&d.push(x+"R"+(p+1))})}function h(d,u){var m=["ID;PWXL;N;E"],p=[],x=ze(d["!ref"]),S,y=Array.isArray(d),T=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&l(m,d["!cols"]),d["!rows"]&&f(m,d["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var D=x.s.r;D<=x.e.r;++D)for(var N=x.s.c;N<=x.e.c;++N){var K=Ue({r:D,c:N});S=y?(d[D]||[])[N]:d[K],!(!S||S.v==null&&(!S.f||S.F))&&p.push(c(S,d,D,N,u))}return m.join(T)+T+p.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:s,from_sheet:h}})(),vu=(function(){function e(i,s){switch(s.type){case"base64":return t(xr(i),s);case"binary":return t(i,s);case"buffer":return t(Pe&&Buffer.isBuffer(i)?i.toString("binary"):ja(i),s);case"array":return t(Vn(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),c=-1,l=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++c]=[],l=0;continue}if(!(c<0)){var d=o[f].trim().split(","),u=d[0],m=d[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+u){case-1:if(p==="BOT"){h[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[c][l]=!0:p==="FALSE"?h[c][l]=!1:isNaN(mr(m))?isNaN(Ua(m).getDate())?h[c][l]=m:h[c][l]=bt(m):h[c][l]=mr(m),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),Fa&&p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(i,s){return pa(e(i,s),s)}function a(i,s){return zr(r(i,s),s)}var n=(function(){var i=function(c,l,f,h,d){c.push(l),c.push(f+","+h),c.push('"'+d.replace(/"/g,'""')+'"')},s=function(c,l,f,h){c.push(l+","+f),c.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var l=[],f=ze(c["!ref"]),h,d=Array.isArray(c);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,f.e.r-f.s.r+1,""),i(l,"TUPLES",0,f.e.c-f.s.c+1,""),i(l,"DATA",0,0,"");for(var u=f.s.r;u<=f.e.r;++u){s(l,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var p=Ue({r:u,c:m});if(h=d?(c[u]||[])[m]:c[p],!h){s(l,1,0,"");continue}switch(h.t){case"n":var x=Fa?h.w:h.v;!x&&h.v!=null&&(x=h.v),x==null?Fa&&h.f&&!h.F?s(l,1,0,"="+h.f):s(l,1,0,""):s(l,0,x,"V");break;case"b":s(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(l,1,0,!Fa||isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Cr(h.z||qe[14],Dt(bt(h.v)))),Fa?s(l,0,h.w,"V"):s(l,1,0,h.w);break;default:s(l,1,0,"")}}}s(l,-1,0,"EOD");var S=`\r
`,y=l.join(S);return y}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),xc=(function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var u=h.split(`
`),m=-1,p=-1,x=0,S=[];x!==u.length;++x){var y=u[x].trim().split(":");if(y[0]==="cell"){var T=ot(y[1]);if(S.length<=T.r)for(m=S.length;m<=T.r;++m)S[m]||(S[m]=[]);switch(m=T.r,p=T.c,y[2]){case"t":S[m][p]=e(y[3]);break;case"v":S[m][p]=+y[3];break;case"vtf":var D=y[y.length-1];case"vtc":switch(y[3]){case"nl":S[m][p]=!!+y[4];break;default:S[m][p]=+y[4];break}y[2]=="vtf"&&(S[m][p]=[S[m][p],D])}}}return d&&d.sheetRows&&(S=S.slice(0,d.sheetRows)),S}function a(h,d){return pa(r(h,d),d)}function n(h,d){return zr(a(h,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var d=[],u=[],m,p="",x=Ut(h["!ref"]),S=Array.isArray(h),y=x.s.r;y<=x.e.r;++y)for(var T=x.s.c;T<=x.e.c;++T)if(p=Ue({r:y,c:T}),m=S?(h[y]||[])[T]:h[p],!(!m||m.v==null||m.t==="z")){switch(u=["cell",p,"t"],m.t){case"s":case"str":u.push(t(m.v));break;case"n":m.f?(u[2]="vtf",u[3]="n",u[4]=m.v,u[5]=t(m.f)):(u[2]="v",u[3]=m.v);break;case"b":u[2]="vt"+(m.f?"f":"c"),u[3]="nl",u[4]=m.v?"1":"0",u[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var D=Dt(bt(m.v));u[2]="vtc",u[3]="nd",u[4]=""+D,u[5]=m.w||Cr(m.z||qe[14],D);break;case"e":continue}d.push(u.join(":"))}return d.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[i,s,o,s,l(h),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}})(),wu=(function(){function e(f,h,d,u,m){m.raw?h[d][u]=f:f===""||(f==="TRUE"?h[d][u]=!0:f==="FALSE"?h[d][u]=!1:isNaN(mr(f))?isNaN(Ua(f).getDate())?h[d][u]=f:h[d][u]=bt(f):h[d][u]=mr(f))}function t(f,h){var d=h||{},u=[];if(!f||f.length===0)return u;for(var m=f.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,S=0,y=0;y<=p;++y)S=m[y].indexOf(" "),S==-1?S=m[y].length:S++,x=Math.max(x,S);for(y=0;y<=p;++y){u[y]=[];var T=0;for(e(m[y].slice(0,x).trim(),u,y,T,d),T=1;T<=(m[y].length-x)/10+1;++T)e(m[y].slice(x+(T-1)*10,x+T*10).trim(),u,y,T,d)}return d.sheetRows&&(u=u.slice(0,d.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var h={},d=!1,u=0,m=0;u<f.length;++u)(m=f.charCodeAt(u))==34?d=!d:!d&&m in r&&(h[m]=(h[m]||0)+1);m=[];for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&m.push([h[u],u]);if(!m.length){h=a;for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&m.push([h[u],u])}return m.sort(function(p,x){return p[0]-x[0]||a[p[1]]-a[x[1]]}),r[m.pop()[1]]||44}function i(f,h){var d=h||{},u="";or!=null&&d.dense==null&&(d.dense=or);var m=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(u=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(u=f.charAt(4),f=f.slice(6)):u=n(f.slice(0,1024)):d&&d.FS?u=d.FS:u=n(f.slice(0,1024));var x=0,S=0,y=0,T=0,D=0,N=u.charCodeAt(0),K=!1,b=0,O=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var A=d.dateNF!=null?Nl(d.dateNF):null;function I(){var V=f.slice(T,D),j={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)j.t="z";else if(d.raw)j.t="s",j.v=V;else if(V.trim().length===0)j.t="s",j.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(j.t="s",j.v=V.slice(2,-1).replace(/""/g,'"')):xd(V)?(j.t="n",j.f=V.slice(1)):(j.t="s",j.v=V);else if(V=="TRUE")j.t="b",j.v=!0;else if(V=="FALSE")j.t="b",j.v=!1;else if(!isNaN(y=mr(V)))j.t="n",d.cellText!==!1&&(j.w=V),j.v=y;else if(!isNaN(Ua(V).getDate())||A&&V.match(A)){j.z=d.dateNF||qe[14];var se=0;A&&V.match(A)&&(V=Ol(V,d.dateNF,V.match(A)||[]),se=1),d.cellDates?(j.t="d",j.v=bt(V,se)):(j.t="n",j.v=Dt(bt(V,se))),d.cellText!==!1&&(j.w=Cr(j.z,j.v instanceof Date?Dt(j.v):j.v)),d.cellNF||delete j.z}else j.t="s",j.v=V;if(j.t=="z"||(d.dense?(m[x]||(m[x]=[]),m[x][S]=j):m[Ue({c:S,r:x})]=j),T=D+1,O=f.charCodeAt(T),p.e.c<S&&(p.e.c=S),p.e.r<x&&(p.e.r=x),b==N)++S;else if(S=0,++x,d.sheetRows&&d.sheetRows<=x)return!0}e:for(;D<f.length;++D)switch(b=f.charCodeAt(D)){case 34:O===34&&(K=!K);break;case N:case 10:case 13:if(!K&&I())break e;break;default:break}return D-T>0&&I(),m["!ref"]=rt(p),m}function s(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,h):pa(t(f,h),h)}function o(f,h){var d="",u=h.type=="string"?[0,0,0,0]:Dm(f,h);switch(h.type){case"base64":d=xr(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof We!="undefined"?d=We.utils.decode(h.codepage,f):d=Pe&&Buffer.isBuffer(f)?f.toString("binary"):ja(f);break;case"array":d=Vn(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return u[0]==239&&u[1]==187&&u[2]==191?d=Ia(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Ia(d):h.type=="binary"&&typeof We!="undefined"&&h.codepage&&(d=We.utils.decode(h.codepage,We.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?xc.to_sheet(h.type=="string"?d:Ia(d),h):s(d,h)}function c(f,h){return zr(o(f,h),h)}function l(f){for(var h=[],d=ze(f["!ref"]),u,m=Array.isArray(f),p=d.s.r;p<=d.e.r;++p){for(var x=[],S=d.s.c;S<=d.e.c;++S){var y=Ue({r:p,c:S});if(u=m?(f[p]||[])[S]:f[y],!u||u.v==null){x.push("          ");continue}for(var T=(u.w||(vr(u),u.w)||"").slice(0,10);T.length<10;)T+=" ";x.push(T+(S===0?" ":""))}h.push(x.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}})();var mo=(function(){function e(C,U,R){if(C){Mt(C,C.l||0);for(var F=R.Enum||be;C.l<C.length;){var Y=C.read_shift(2),le=F[Y]||F[65535],me=C.read_shift(2),oe=C.l+me,Z=le.f&&le.f(C,me,R);if(C.l=oe,U(Z,le,Y))return}}}function t(C,U){switch(U.type){case"base64":return r(er(xr(C)),U);case"binary":return r(er(C),U);case"buffer":case"array":return r(C,U)}throw"Unsupported type "+U.type}function r(C,U){if(!C)return C;var R=U||{};or!=null&&R.dense==null&&(R.dense=or);var F=R.dense?[]:{},Y="Sheet1",le="",me=0,oe={},Z=[],Re=[],ke={s:{r:0,c:0},e:{r:0,c:0}},Ze=R.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)R.Enum=be,e(C,function(fe,Ct,De){switch(De){case 0:R.vers=fe,fe>=4096&&(R.qpro=!0);break;case 6:ke=fe;break;case 204:fe&&(le=fe);break;case 222:le=fe;break;case 15:case 51:R.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:De==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=R.dateNF||qe[14],R.cellDates&&(fe[1].t="d",fe[1].v=$o(fe[1].v))),R.qpro&&fe[3]>me&&(F["!ref"]=rt(ke),oe[Y]=F,Z.push(Y),F=R.dense?[]:{},ke={s:{r:0,c:0},e:{r:0,c:0}},me=fe[3],Y=le||"Sheet"+(me+1),le="");var Ht=R.dense?(F[fe[0].r]||[])[fe[0].c]:F[Ue(fe[0])];if(Ht){Ht.t=fe[1].t,Ht.v=fe[1].v,fe[1].z!=null&&(Ht.z=fe[1].z),fe[1].f!=null&&(Ht.f=fe[1].f);break}R.dense?(F[fe[0].r]||(F[fe[0].r]=[]),F[fe[0].r][fe[0].c]=fe[1]):F[Ue(fe[0])]=fe[1];break;default:}},R);else if(C[2]==26||C[2]==14)R.Enum=Fe,C[2]==14&&(R.qpro=!0,C.l=0),e(C,function(fe,Ct,De){switch(De){case 204:Y=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>me&&(F["!ref"]=rt(ke),oe[Y]=F,Z.push(Y),F=R.dense?[]:{},ke={s:{r:0,c:0},e:{r:0,c:0}},me=fe[3],Y="Sheet"+(me+1)),Ze>0&&fe[0].r>=Ze)break;R.dense?(F[fe[0].r]||(F[fe[0].r]=[]),F[fe[0].r][fe[0].c]=fe[1]):F[Ue(fe[0])]=fe[1],ke.e.c<fe[0].c&&(ke.e.c=fe[0].c),ke.e.r<fe[0].r&&(ke.e.r=fe[0].r);break;case 27:fe[14e3]&&(Re[fe[14e3][0]]=fe[14e3][1]);break;case 1537:Re[fe[0]]=fe[1],fe[0]==me&&(Y=fe[1]);break;default:break}},R);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(F["!ref"]=rt(ke),oe[le||Y]=F,Z.push(le||Y),!Re.length)return{SheetNames:Z,Sheets:oe};for(var ie={},q=[],z=0;z<Re.length;++z)oe[Z[z]]?(q.push(Re[z]||Z[z]),ie[Re[z]]=oe[Re[z]]||oe[Z[z]]):(q.push(Re[z]),ie[Re[z]]={"!ref":"A1"});return{SheetNames:q,Sheets:ie}}function a(C,U){var R=U||{};if(+R.codepage>=0&&Ma(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var F=Rt(),Y=ze(C["!ref"]),le=Array.isArray(C),me=[];te(F,0,i(1030)),te(F,6,c(Y));for(var oe=Math.min(Y.e.r,8191),Z=Y.s.r;Z<=oe;++Z)for(var Re=pt(Z),ke=Y.s.c;ke<=Y.e.c;++ke){Z===Y.s.r&&(me[ke]=wt(ke));var Ze=me[ke]+Re,ie=le?(C[Z]||[])[ke]:C[Ze];if(!(!ie||ie.t=="z"))if(ie.t=="n")(ie.v|0)==ie.v&&ie.v>=-32768&&ie.v<=32767?te(F,13,u(Z,ke,ie.v)):te(F,14,p(Z,ke,ie.v));else{var q=vr(ie);te(F,15,h(Z,ke,q.slice(0,239)))}}return te(F,1),F.end()}function n(C,U){var R=U||{};if(+R.codepage>=0&&Ma(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var F=Rt();te(F,0,s(C));for(var Y=0,le=0;Y<C.SheetNames.length;++Y)(C.Sheets[C.SheetNames[Y]]||{})["!ref"]&&te(F,27,Ce(C.SheetNames[Y],le++));var me=0;for(Y=0;Y<C.SheetNames.length;++Y){var oe=C.Sheets[C.SheetNames[Y]];if(!(!oe||!oe["!ref"])){for(var Z=ze(oe["!ref"]),Re=Array.isArray(oe),ke=[],Ze=Math.min(Z.e.r,8191),ie=Z.s.r;ie<=Ze;++ie)for(var q=pt(ie),z=Z.s.c;z<=Z.e.c;++z){ie===Z.s.r&&(ke[z]=wt(z));var fe=ke[z]+q,Ct=Re?(oe[ie]||[])[z]:oe[fe];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")te(F,23,I(ie,z,me,Ct.v));else{var De=vr(Ct);te(F,22,b(ie,z,me,De.slice(0,239)))}}++me}}return te(F,1),F.end()}function i(C){var U=H(2);return U.write_shift(2,C),U}function s(C){var U=H(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var R=0,F=0,Y=0,le=0;le<C.SheetNames.length;++le){var me=C.SheetNames[le],oe=C.Sheets[me];if(!(!oe||!oe["!ref"])){++Y;var Z=Ut(oe["!ref"]);R<Z.e.r&&(R=Z.e.r),F<Z.e.c&&(F=Z.e.c)}}return R>8191&&(R=8191),U.write_shift(2,R),U.write_shift(1,Y),U.write_shift(1,F),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(C,U,R){var F={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&R.qpro?(F.s.c=C.read_shift(1),C.l++,F.s.r=C.read_shift(2),F.e.c=C.read_shift(1),C.l++,F.e.r=C.read_shift(2),F):(F.s.c=C.read_shift(2),F.s.r=C.read_shift(2),U==12&&R.qpro&&(C.l+=2),F.e.c=C.read_shift(2),F.e.r=C.read_shift(2),U==12&&R.qpro&&(C.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function c(C){var U=H(8);return U.write_shift(2,C.s.c),U.write_shift(2,C.s.r),U.write_shift(2,C.e.c),U.write_shift(2,C.e.r),U}function l(C,U,R){var F=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(F[0].c=C.read_shift(1),F[3]=C.read_shift(1),F[0].r=C.read_shift(2),C.l+=2):(F[2]=C.read_shift(1),F[0].c=C.read_shift(2),F[0].r=C.read_shift(2)),F}function f(C,U,R){var F=C.l+U,Y=l(C,U,R);if(Y[1].t="s",R.vers==20768){C.l++;var le=C.read_shift(1);return Y[1].v=C.read_shift(le,"utf8"),Y}return R.qpro&&C.l++,Y[1].v=C.read_shift(F-C.l,"cstr"),Y}function h(C,U,R){var F=H(7+R.length);F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,C),F.write_shift(1,39);for(var Y=0;Y<F.length;++Y){var le=R.charCodeAt(Y);F.write_shift(1,le>=128?95:le)}return F.write_shift(1,0),F}function d(C,U,R){var F=l(C,U,R);return F[1].v=C.read_shift(2,"i"),F}function u(C,U,R){var F=H(7);return F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,C),F.write_shift(2,R,"i"),F}function m(C,U,R){var F=l(C,U,R);return F[1].v=C.read_shift(8,"f"),F}function p(C,U,R){var F=H(13);return F.write_shift(1,255),F.write_shift(2,U),F.write_shift(2,C),F.write_shift(8,R,"f"),F}function x(C,U,R){var F=C.l+U,Y=l(C,U,R);if(Y[1].v=C.read_shift(8,"f"),R.qpro)C.l=F;else{var le=C.read_shift(2);D(C.slice(C.l,C.l+le),Y),C.l+=le}return Y}function S(C,U,R){var F=U&32768;return U&=-32769,U=(F?C:0)+(U>=8192?U-16384:U),(F?"":"$")+(R?wt(U):pt(U))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(C,U){Mt(C,0);for(var R=[],F=0,Y="",le="",me="",oe="";C.l<C.length;){var Z=C[C.l++];switch(Z){case 0:R.push(C.read_shift(8,"f"));break;case 1:le=S(U[0].c,C.read_shift(2),!0),Y=S(U[0].r,C.read_shift(2),!1),R.push(le+Y);break;case 2:{var Re=S(U[0].c,C.read_shift(2),!0),ke=S(U[0].r,C.read_shift(2),!1);le=S(U[0].c,C.read_shift(2),!0),Y=S(U[0].r,C.read_shift(2),!1),R.push(Re+ke+":"+le+Y)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(C.read_shift(2));break;case 6:{for(var Ze="";Z=C[C.l++];)Ze+=String.fromCharCode(Z);R.push('"'+Ze.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:oe=R.pop(),me=R.pop(),R.push(["AND","OR"][Z-20]+"("+me+","+oe+")");break;default:if(Z<32&&T[Z])oe=R.pop(),me=R.pop(),R.push(me+T[Z]+oe);else if(y[Z]){if(F=y[Z][1],F==69&&(F=C[C.l++]),F>R.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+R.join("|")+"|");return}var ie=R.slice(-F);R.length-=F,R.push(y[Z][0]+"("+ie.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}R.length==1?U[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function N(C){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=C.read_shift(2),U[3]=C[C.l++],U[0].c=C[C.l++],U}function K(C,U){var R=N(C,U);return R[1].t="s",R[1].v=C.read_shift(U-4,"cstr"),R}function b(C,U,R,F){var Y=H(6+F.length);Y.write_shift(2,C),Y.write_shift(1,R),Y.write_shift(1,U),Y.write_shift(1,39);for(var le=0;le<F.length;++le){var me=F.charCodeAt(le);Y.write_shift(1,me>=128?95:me)}return Y.write_shift(1,0),Y}function O(C,U){var R=N(C,U);R[1].v=C.read_shift(2);var F=R[1].v>>1;if(R[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return R[1].v=F,R}function A(C,U){var R=N(C,U),F=C.read_shift(4),Y=C.read_shift(4),le=C.read_shift(2);if(le==65535)return F===0&&Y===3221225472?(R[1].t="e",R[1].v=15):F===0&&Y===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var me=le&32768;return le=(le&32767)-16446,R[1].v=(1-me*2)*(Y*Math.pow(2,le+32)+F*Math.pow(2,le)),R}function I(C,U,R,F){var Y=H(14);if(Y.write_shift(2,C),Y.write_shift(1,R),Y.write_shift(1,U),F==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var le=0,me=0,oe=0,Z=0;return F<0&&(le=1,F=-F),me=Math.log2(F)|0,F/=Math.pow(2,me-31),Z=F>>>0,(Z&2147483648)==0&&(F/=2,++me,Z=F>>>0),F-=Z,Z|=2147483648,Z>>>=0,F*=Math.pow(2,32),oe=F>>>0,Y.write_shift(4,oe),Y.write_shift(4,Z),me+=16383+(le?32768:0),Y.write_shift(2,me),Y}function V(C,U){var R=A(C,14);return C.l+=U-14,R}function j(C,U){var R=N(C,U),F=C.read_shift(4);return R[1].v=F>>6,R}function se(C,U){var R=N(C,U),F=C.read_shift(8,"f");return R[1].v=F,R}function pe(C,U){var R=se(C,14);return C.l+=U-10,R}function ee(C,U){return C[C.l+U-1]==0?C.read_shift(U,"cstr"):""}function ye(C,U){var R=C[C.l++];R>U-1&&(R=U-1);for(var F="";F.length<R;)F+=String.fromCharCode(C[C.l++]);return F}function Se(C,U,R){if(!(!R.qpro||U<21)){var F=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var Y=C.read_shift(U-21,"cstr");return[F,Y]}}function Xe(C,U){for(var R={},F=C.l+U;C.l<F;){var Y=C.read_shift(2);if(Y==14e3){for(R[Y]=[0,""],R[Y][0]=C.read_shift(2);C[C.l];)R[Y][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return R}function Ce(C,U){var R=H(5+C.length);R.write_shift(2,14e3),R.write_shift(2,U);for(var F=0;F<C.length;++F){var Y=C.charCodeAt(F);R[R.l++]=Y>127?95:Y}return R[R.l++]=0,R}var be={0:{n:"BOF",f:dc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:ye},65535:{n:""}},Fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:K},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:se},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}})();var yu=/^\s|\s$|[\t\n\r]/;function vc(e,t){if(!t.bookSST)return"";var r=[at];r[r.length]=Q("sst",null,{xmlns:da[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(yu)&&(i+=' xml:space="preserve"'),i+=">"+$e(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function _u(e){return[e.read_shift(4),e.read_shift(4)]}function Eu(e,t){return t||(t=H(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var ku=hf;function Su(e){var t=Rt();X(t,159,Eu(e));for(var r=0;r<e.length;++r)X(t,19,ku(e[r]));return X(t,160),t.end()}function bu(e){if(typeof We!="undefined")return We.utils.encode(fa,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function wc(e){var t=0,r,a=bu(e),n=a.length+1,i,s,o,c,l;for(r=Wr(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)s=r[i],o=(t&16384)===0?0:1,c=t<<1&32767,l=o|c,t=l^s;return t^52811}var Tu=(function(){function e(n,i){switch(i.type){case"base64":return t(xr(n),i);case"binary":return t(n,i);case"buffer":return t(Pe&&Buffer.isBuffer(n)?n.toString("binary"):ja(n),i);case"array":return t(Vn(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var s=i||{},o=s.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,u=0,m,p=-1;m=d.exec(f);){switch(m[0]){case"\\cell":var x=f.slice(u,d.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var S={v:x,t:"s"};Array.isArray(o)?o[h][p]=S:o[Ue({r:h,c:p})]=S}break}u=d.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=rt(l),o}function r(n,i){return zr(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],s=ze(n["!ref"]),o,c=Array.isArray(n),l=s.s.r;l<=s.e.r;++l){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var h=Ue({r:l,c:f});o=c?(n[l]||[])[f]:n[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(vr(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function go(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Au=6;var gr=Au;function In(e){return Math.floor((e+Math.round(128/gr)/256)*gr)}function Nn(e){return Math.floor((e-5)/gr*100+.5)/100}function Ni(e){return Math.round((e*gr+5)/gr*256)/256}function Zi(e){e.width?(e.wpx=In(e.width),e.wch=Nn(e.wpx),e.MDW=gr):e.wpx?(e.wch=Nn(e.wpx),e.width=Ni(e.wch),e.MDW=gr):typeof e.wch=="number"&&(e.width=Ni(e.wch),e.wpx=In(e.width),e.MDW=gr),e.customWidth&&delete e.customWidth}var Cu=96,yc=Cu;function On(e){return e*96/yc}function _c(e){return e*yc/96}function Fu(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Q("numFmt",null,{numFmtId:a,formatCode:$e(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Q("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Ru(e){var t=[];return t[t.length]=Q("cellXfs",null),e.forEach(function(r){t[t.length]=Q("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Q("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Ec(e,t){var r=[at,Q("styleSheet",null,{xmlns:da[0],"xmlns:vt":st.vt})],a;return e.SSF&&(a=Fu(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Ru(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Du(e,t){var r=e.read_shift(2),a=yt(e,t-2);return[r,a]}function Iu(e,t,r){r||(r=H(6+4*t.length)),r.write_shift(2,e),ct(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function Nu(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=yf(e,2,r);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(a.underline=s);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=wf(e,8),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=yt(e,t-21),a}function Ou(e,t){t||(t=H(153)),t.write_shift(2,e.sz*20),_f(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Rn(e.color,t);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),t.write_shift(1,a),ct(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Pu=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ti,Lu=cr;function xo(e,t){t||(t=H(84)),Ti||(Ti=Li(Pu));var r=Ti[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Rn({auto:1},t),Rn({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Bu(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function kc(e,t,r){r||(r=H(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ra(e,t){return t||(t=H(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Mu=cr;function $u(e,t){return t||(t=H(51)),t.write_shift(1,0),Ra(null,t),Ra(null,t),Ra(null,t),Ra(null,t),Ra(null,t),t.length>t.l?t.slice(0,t.l):t}function Uu(e,t){return t||(t=H(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Fn(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Vu(e,t,r){var a=H(2052);return a.write_shift(4,e),Fn(t,a),Fn(r,a),a.length>a.l?a.slice(0,a.l):a}function Hu(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(X(e,615,rr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&X(e,44,Iu(n,t[n]))}),X(e,616))}}function Wu(e){var t=1;t!=0&&(X(e,611,rr(t)),X(e,43,Ou({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),X(e,612))}function ju(e){var t=2;t!=0&&(X(e,603,rr(t)),X(e,45,xo({patternType:"none"})),X(e,45,xo({patternType:"gray125"})),X(e,604))}function Gu(e){var t=1;t!=0&&(X(e,613,rr(t)),X(e,46,$u({})),X(e,614))}function zu(e){var t=1;X(e,626,rr(t)),X(e,47,kc({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),X(e,627)}function Xu(e,t){X(e,617,rr(t.length)),t.forEach(function(r){X(e,47,kc(r,0))}),X(e,618)}function Yu(e){var t=1;X(e,619,rr(t)),X(e,48,Uu({xfId:0,builtinId:0,name:"Normal"})),X(e,620)}function Ku(e){var t=0;X(e,505,rr(t)),X(e,506)}function Ju(e){var t=0;X(e,508,Vu(t,"TableStyleMedium9","PivotStyleMedium4")),X(e,509)}function qu(e,t){var r=Rt();return X(r,278),Hu(r,e.SSF),Wu(r,e),ju(r,e),Gu(r,e),zu(r,e),Xu(r,t.cellXfs),Yu(r,e),Ku(r,e),Ju(r,e),X(r,279),r.end()}function Sc(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[at];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Zu(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:yt(e,t-8)}}function Qu(e){var t=H(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ct(e.name,t),t.slice(0,t.l)}function ed(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function td(e){var t=H(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function rd(e,t){var r=H(8+2*t.length);return r.write_shift(4,e),ct(t,r),r.slice(0,r.l)}function ad(e){return e.l+=4,e.read_shift(4)!=0}function nd(e,t){var r=H(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function id(){var e=Rt();return X(e,332),X(e,334,rr(1)),X(e,335,Qu({name:"XLDAPR",version:12e4,flags:3496657072})),X(e,336),X(e,339,rd(1,"XLDAPR")),X(e,52),X(e,35,rr(514)),X(e,4096,rr(0)),X(e,4097,Xt(1)),X(e,36),X(e,53),X(e,340),X(e,337,nd(1,!0)),X(e,51,td([[1,0]])),X(e,338),X(e,333),e.end()}function bc(){var e=[at];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function sd(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}var na=1024;function Tc(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Q("xml",null,{"xmlns:v":$t.v,"xmlns:o":$t.o,"xmlns:x":$t.x,"xmlns:mv":$t.mv}).replace(/\/>/,">"),Q("o:shapelayout",Q("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Q("v:shapetype",[Q("v:stroke",null,{joinstyle:"miter"}),Q("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];na<e*1e3;)na+=1e3;return t.forEach(function(i){var s=ot(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Q("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=Q("v:fill",c,o),f={on:"t",obscured:"t"};++na,n=n.concat(["<v:shape"+Va({id:"_x0000_s"+na,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,Q("v:shadow",null,f),Q("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ht("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),ht("x:AutoFill","False"),ht("x:Row",String(s.r)),ht("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Ac(e){var t=[at,Q("comments",null,{xmlns:da[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=$e(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf($e(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(ht("t",$e(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(ht("t",$e(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function od(e,t,r){var a=[at,Q("ThreadedComments",null,{xmlns:st.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),a.push(Q("threadedComment",ht("text",s.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function cd(e){var t=[at,Q("personList",null,{xmlns:st.TCMNT,"xmlns:x":da[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Q("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function ld(e){var t={};t.iauthor=e.read_shift(4);var r=Jr(e,16);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}function fd(e,t){return t==null&&(t=H(36)),t.write_shift(4,e[1].iauthor),ma(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ud=yt;function dd(e){return ct(e.slice(0,54))}function hd(e){var t=Rt(),r=[];return X(t,628),X(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),X(t,632,dd(n.a)))})}),X(t,631),X(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:ot(a[0]),e:ot(a[0])};X(t,635,fd([i,n])),n.t&&n.t.length>0&&X(t,637,mf(n)),X(t,636),delete n.iauthor})}),X(t,634),X(t,629),t.end()}function pd(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Ve.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var Cc=["xlsb","xlsm","xlam","biff8","xla"];var md=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=t.c:--f,c?l+=t.r:--l,n+(o?"":"$")+wt(f)+(c?"":"$")+pt(l)}return function(n,i){return t=i,n.replace(e,r)}})(),Qi=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,es=(function(){return function(t,r){return t.replace(Qi,function(a,n,i,s,o,c){var l=Xi(s)-(i?0:r.c),f=zi(c)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=l==0?"":i?l+1:"["+l+"]";return n+"R"+h+"C"+d})}})();function gd(e,t){return e.replace(Qi,function(r,a,n,i,s,o){return a+(n=="$"?n+i:wt(Xi(i)+t.c))+(s=="$"?s+o:pt(zi(o)+t.r))})}function xd(e){return e.length!=1}function tt(e){e.l+=1}function Fr(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function Fc(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Rc(e,t,r);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),s=Fr(e,2),o=Fr(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Rc(e){var t=Fr(e,2),r=Fr(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function vd(e,t,r){if(r.biff<8)return Rc(e,t,r);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=Fr(e,2),s=Fr(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}function Dc(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return wd(e,t,r);var a=e.read_shift(r&&r.biff==12?4:2),n=Fr(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function wd(e){var t=Fr(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function yd(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _d(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return Ed(e,t,r);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:s,rRel:o}}function Ed(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function kd(e,t,r){var a=(e[e.l++]&96)>>5,n=Fc(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function Sd(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=Fc(e,i,r);return[a,n,s]}function bd(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Td(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function Ad(e,t,r){var a=(e[e.l++]&96)>>5,n=vd(e,t-1,r);return[a,n]}function Cd(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function vo(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Fd(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function Rd(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Dd(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Id(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Nd(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function Ic(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Od(e){return e.read_shift(2),Ic(e,2)}function Pd(e){return e.read_shift(2),Ic(e,2)}function Ld(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=Dc(e,0,r);return[a,n]}function Bd(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=_d(e,0,r);return[a,n]}function Md(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Dc(e,0,r);return[a,n,i]}function $d(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[$h[n],Pc[n],a]}function Ud(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Vd(e);return[n,(i[0]===0?Pc:Mh)[i[1]]]}function Vd(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hd(e,t,r){e.l+=r&&r.biff==2?3:4}function Wd(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function jd(e){return e.l++,za[e.read_shift(1)]}function Gd(e){return e.l++,e.read_shift(2)}function zd(e){return e.l++,e.read_shift(1)!==0}function Xd(e){return e.l++,ga(e,8)}function Yd(e,t,r){return e.l++,pc(e,t-1,r)}function Kd(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mf(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=za[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ga(e,8);break;case 2:r[1]=Hf(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Jd(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?Jr:Gf)(e,8));return n}function qd(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,s=[];i!=a&&(s[i]=[]);++i)for(var o=0;o!=n;++o)s[i][o]=Kd(e,r.biff);return s}function Zd(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function Qd(e,t,r){if(r.biff==5)return eh(e,t,r);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function eh(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function th(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function rh(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function ah(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function nh(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var ih=cr,sh=cr,oh=cr;function Xa(e,t,r){return e.l+=2,[yd(e,4,r)]}function ts(e){return e.l+=6,[]}var ch=Xa,lh=ts,fh=ts,uh=Xa;function Nc(e){return e.l+=2,[dc(e),e.read_shift(2)&1]}var dh=Xa,hh=Nc,ph=ts,mh=Xa,gh=Xa,xh=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vh(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),s=xh[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:a,c:n,C:i}}function wh(e){return e.l+=2,[e.read_shift(4)]}function yh(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function _h(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Eh(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function kh(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Sh(e){return e.l+=4,[0,0]}var wo={1:{n:"PtgExp",f:Wd},2:{n:"PtgTbl",f:oh},3:{n:"PtgAdd",f:tt},4:{n:"PtgSub",f:tt},5:{n:"PtgMul",f:tt},6:{n:"PtgDiv",f:tt},7:{n:"PtgPower",f:tt},8:{n:"PtgConcat",f:tt},9:{n:"PtgLt",f:tt},10:{n:"PtgLe",f:tt},11:{n:"PtgEq",f:tt},12:{n:"PtgGe",f:tt},13:{n:"PtgGt",f:tt},14:{n:"PtgNe",f:tt},15:{n:"PtgIsect",f:tt},16:{n:"PtgUnion",f:tt},17:{n:"PtgRange",f:tt},18:{n:"PtgUplus",f:tt},19:{n:"PtgUminus",f:tt},20:{n:"PtgPercent",f:tt},21:{n:"PtgParen",f:tt},22:{n:"PtgMissArg",f:tt},23:{n:"PtgStr",f:Yd},26:{n:"PtgSheet",f:yh},27:{n:"PtgEndSheet",f:_h},28:{n:"PtgErr",f:jd},29:{n:"PtgBool",f:zd},30:{n:"PtgInt",f:Gd},31:{n:"PtgNum",f:Xd},32:{n:"PtgArray",f:Cd},33:{n:"PtgFunc",f:$d},34:{n:"PtgFuncVar",f:Ud},35:{n:"PtgName",f:Zd},36:{n:"PtgRef",f:Ld},37:{n:"PtgArea",f:kd},38:{n:"PtgMemArea",f:th},39:{n:"PtgMemErr",f:ih},40:{n:"PtgMemNoMem",f:sh},41:{n:"PtgMemFunc",f:rh},42:{n:"PtgRefErr",f:ah},43:{n:"PtgAreaErr",f:bd},44:{n:"PtgRefN",f:Bd},45:{n:"PtgAreaN",f:Ad},46:{n:"PtgMemAreaN",f:Eh},47:{n:"PtgMemNoMemN",f:kh},57:{n:"PtgNameX",f:Qd},58:{n:"PtgRef3d",f:Md},59:{n:"PtgArea3d",f:Sd},60:{n:"PtgRefErr3d",f:nh},61:{n:"PtgAreaErr3d",f:Td},255:{}},bh={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Th={1:{n:"PtgElfLel",f:Nc},2:{n:"PtgElfRw",f:mh},3:{n:"PtgElfCol",f:ch},6:{n:"PtgElfRwV",f:gh},7:{n:"PtgElfColV",f:uh},10:{n:"PtgElfRadical",f:dh},11:{n:"PtgElfRadicalS",f:ph},13:{n:"PtgElfColS",f:lh},15:{n:"PtgElfColSV",f:fh},16:{n:"PtgElfRadicalLel",f:hh},25:{n:"PtgList",f:vh},29:{n:"PtgSxName",f:wh},255:{}},Ah={0:{n:"PtgAttrNoop",f:Sh},1:{n:"PtgAttrSemi",f:Nd},2:{n:"PtgAttrIf",f:Dd},4:{n:"PtgAttrChoose",f:Fd},8:{n:"PtgAttrGoto",f:Rd},16:{n:"PtgAttrSum",f:Hd},32:{n:"PtgAttrBaxcel",f:vo},33:{n:"PtgAttrBaxcel",f:vo},64:{n:"PtgAttrSpace",f:Od},65:{n:"PtgAttrSpaceSemi",f:Pd},128:{n:"PtgAttrIfError",f:Id},255:{}};function Ch(e,t,r,a){if(a.biff<8)return cr(e,t);for(var n=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=qd(e,0,a),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=Jd(e,r[s][1],a),i.push(r[s][2]);break;case"PtgExp":a&&a.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0];default:break}return t=n-e.l,t!==0&&i.push(cr(e,t)),i}function Fh(e,t,r){for(var a=e.l+t,n,i,s=[];a!=e.l;)t=a-e.l,i=e[e.l],n=wo[i]||wo[bh[i]],(i===24||i===25)&&(n=(i===24?Th:Ah)[e[e.l+1]]),!n||!n.f?cr(e,t):s.push([n.n,n.f(e,t,r)]);return s}function Rh(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var s=a[i];if(s)switch(s[0]){case 2:n.push('"'+s[1].replace(/"/g,'""')+'"');break;default:n.push(s[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var Dh={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ih(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Oc(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function yo(e,t,r){var a=Oc(e,t,r);return a=="#REF"?a:Ih(a,r)}function ua(e,t,r,a,n){var i=n&&n.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,f,h=0,d=0,u,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,x="",S=0,y=e[0].length;S<y;++S){var T=e[0][S];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:x=Je(" ",e[0][p][1][1]);break;case 1:x=Je("\r",e[0][p][1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+x,p=-1}o.push(l+Dh[T[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Oa(T[1][1],s,n),o.push(Pa(f,i));break;case"PtgRefN":f=r?Oa(T[1][1],r,n):T[1][1],o.push(Pa(f,i));break;case"PtgRef3d":h=T[1][1],f=Oa(T[1][2],s,n),m=yo(a,h,n);var D=m;o.push(m+"!"+Pa(f,i));break;case"PtgFunc":case"PtgFuncVar":var N=T[1][0],K=T[1][1];N||(N=0),N&=127;var b=N==0?[]:o.slice(-N);o.length-=N,K==="User"&&(K=b.shift()),o.push(K+"("+b.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":u=ao(T[1][1],r?{s:r}:s,n),o.push(Si(u,n));break;case"PtgArea":u=ao(T[1][1],s,n),o.push(Si(u,n));break;case"PtgArea3d":h=T[1][1],u=T[1][2],m=yo(a,h,n),o.push(m+"!"+Si(u,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=T[1][2];var O=(a.names||[])[d-1]||(a[0]||[])[d],A=O?O.Name:"SH33TJSNAME"+String(d);A&&A.slice(0,6)=="_xlfn."&&!n.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var I=T[1][1];d=T[1][2];var V;if(n.biff<=5)I<0&&(I=-I),a[I]&&(V=a[I][d]);else{var j="";if(((a[I]||[])[0]||[])[0]==14849||(((a[I]||[])[0]||[])[0]==1025?a[I][d]&&a[I][d].itab>0&&(j=a.SheetNames[a[I][d].itab-1]+"!"):j=a.SheetNames[d-1]+"!"),a[I]&&a[I][d])j+=a[I][d].Name;else if(a[0]&&a[0][d])j+=a[0][d].Name;else{var se=(Oc(a,I,n)||"").split(";;");se[d-1]?j=se[d-1]:j+="SH33TJSERRX"}o.push(j);break}V||(V={Name:"SH33TJSERRY"}),o.push(V.Name);break;case"PtgParen":var pe="(",ee=")";if(p>=0){switch(x="",e[0][p][1][0]){case 2:pe=Je(" ",e[0][p][1][1])+pe;break;case 3:pe=Je("\r",e[0][p][1][1])+pe;break;case 4:ee=Je(" ",e[0][p][1][1])+ee;break;case 5:ee=Je("\r",e[0][p][1][1])+ee;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(pe+o.pop()+ee);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:T[1][1],r:T[1][0]};var ye={c:r.c,r:r.r};if(a.sharedf[Ue(f)]){var Se=a.sharedf[Ue(f)];o.push(ua(Se,s,ye,a,n))}else{var Xe=!1;for(c=0;c!=a.arrayf.length;++c)if(l=a.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(ua(l[1],s,ye,a,n)),Xe=!0;break}Xe||o.push(T[1])}break;case"PtgArray":o.push("{"+Rh(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var Ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&Ce.indexOf(e[0][S][0])==-1){T=e[0][p];var be=!0;switch(T[1][0]){case 4:be=!1;case 0:x=Je(" ",T[1][1]);break;case 5:be=!1;case 1:x=Je("\r",T[1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((be?x:"")+o.pop()+(be?"":x)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Nh(e){if(e==null){var t=H(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return jr(e);return jr(0)}function Oh(e,t,r,a,n){var i=Gr(t,r,n),s=Nh(e.v),o=H(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=H(e.bf.length),f=0;f<e.bf.length;++f)l[f]=e.bf[f];var h=dt([i,s,o,l]);return h}function Wn(e,t,r){var a=e.read_shift(4),n=Fh(e,a,r),i=e.read_shift(4),s=i>0?Ch(e,i,n,r):null;return[n,s]}var Ph=Wn,jn=Wn,Lh=Wn,Bh=Wn,Mh={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Pc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$h={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Uh(e){var t="of:="+e.replace(Qi,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Vh(e){return e.replace(/\./,"!")}var La=typeof Map!="undefined";function rs(e,t,r){var a=0,n=e.length;if(r){if(La?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=La?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(La?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Gn(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(gr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Nn(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Ni(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Lc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Dr(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Lo(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Hh(e,t,r){if(e&&e["!ref"]){var a=ze(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Wh(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+rt(e[r])+'"/>';return t+"</mergeCells>"}function jh(e,t,r,a,n){var i=!1,s={},o=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=hr($e(c))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+Q("outlinePr",null,l)}!i&&!o||(n[n.length]=Q("sheetPr",o,s))}var Gh=["objects","scenarios","selectLockedCells","selectUnlockedCells"],zh=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Xh(e){var t={sheet:1};return Gh.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),zh.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=wc(e.password).toString(16).toUpperCase()),Q("sheetProtection",null,t)}function Yh(e){return Lc(e),Q("pageMargins",null,e)}function Kh(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Q("col",null,Gn(n,a)));return r[r.length]="</cols>",r.join("")}function Jh(e,t,r,a){var n=typeof e.ref=="string"?e.ref:rt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Ut(n);s.s.r==s.e.r&&(s.e.r=Ut(t["!ref"]).e.r,n=rt(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Q("autoFilter",null,{ref:n})}function qh(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Q("sheetViews",Q("sheetView",null,n),{})}function Zh(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=za[e.v];break;case"d":a&&a.cellDates?n=bt(e.v,-1).toISOString():(e=It(e),e.t="n",n=""+(e.v=Dt(bt(e.v)))),typeof e.z=="undefined"&&(e.z=qe[14]);break;default:n=e.v;break}var o=ht("v",$e(n)),c={r:t},l=Dr(a.cellXfs,e,a);switch(l!==0&&(c.s=l),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=ht("v",""+rs(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Q("f",$e(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Q("c",o,c)}function Qh(e,t,r,a){var n=[],i=[],s=ze(e["!ref"]),o="",c,l="",f=[],h=0,d=0,u=e["!rows"],m=Array.isArray(e),p={r:l},x,S=-1;for(d=s.s.c;d<=s.e.c;++d)f[d]=wt(d);for(h=s.s.r;h<=s.e.r;++h){for(i=[],l=pt(h),d=s.s.c;d<=s.e.c;++d){c=f[d]+l;var y=m?(e[h]||[])[d]:e[c];y!==void 0&&(o=Zh(y,c,e,t,r,a))!=null&&i.push(o)}(i.length>0||u&&u[h])&&(p={r:l},u&&u[h]&&(x=u[h],x.hidden&&(p.hidden=1),S=-1,x.hpx?S=On(x.hpx):x.hpt&&(S=x.hpt),S>-1&&(p.ht=S,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),n[n.length]=Q("row",i.join(""),p))}if(u)for(;h<u.length;++h)u&&u[h]&&(p={r:h+1},x=u[h],x.hidden&&(p.hidden=1),S=-1,x.hpx?S=On(x.hpx):x.hpt&&(S=x.hpt),S>-1&&(p.ht=S,p.customHeight=1),x.level&&(p.outlineLevel=x.level),n[n.length]=Q("row","",p));return n.join("")}function Bc(e,t,r,a){var n=[at,Q("worksheet",null,{xmlns:da[0],"xmlns:r":st.r})],i=r.SheetNames[e],s=0,o="",c=r.Sheets[i];c==null&&(c={});var l=c["!ref"]||"A1",f=ze(l);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),l=rt(f)}a||(a={}),c["!comments"]=[];var h=[];jh(c,r,e,t,n),n[n.length]=Q("dimension",null,{ref:l}),n[n.length]=qh(c,t,e,r),t.sheetFormat&&(n[n.length]=Q("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=Kh(c,c["!cols"])),n[s=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=Qh(c,t,e,r,a),o.length>0&&(n[n.length]=o)),n.length>s+1&&(n[n.length]="</sheetData>",n[s]=n[s].replace("/>",">")),c["!protect"]&&(n[n.length]=Xh(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Jh(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=Wh(c["!merges"]));var d=-1,u,m=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(u={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Me(a,-1,$e(p[1].Target).replace(/#.*$/,""),Ie.HLINK),u["r:id"]="rId"+m),(d=p[1].Target.indexOf("#"))>-1&&(u.location=$e(p[1].Target.slice(d+1))),p[1].Tooltip&&(u.tooltip=$e(p[1].Tooltip)),n[n.length]=Q("hyperlink",null,u))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=Yh(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=ht("ignoredErrors",Q("ignoredError",null,{numberStoredAsText:1,sqref:l}))),h.length>0&&(m=Me(a,-1,"../drawings/drawing"+(e+1)+".xml",Ie.DRAW),n[n.length]=Q("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=h),c["!comments"].length>0&&(m=Me(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ie.VML),n[n.length]=Q("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function ep(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function tp(e,t,r){var a=H(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=On(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var s=0;n.level&&(s|=n.level),n.hidden&&(s|=16),(n.hpx||n.hpt)&&(s|=32),a.write_shift(1,s),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var l={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,d=-1,u=f<<10;u<f+1<<10;++u){l.c=u;var m=Array.isArray(r)?(r[l.r]||[])[l.c]:r[Ue(l)];m&&(h<0&&(h=u),d=u)}h<0||(++o,a.write_shift(4,h),a.write_shift(4,d))}var p=a.l;return a.l=c,a.write_shift(4,o),a.l=p,a.length>a.l?a.slice(0,a.l):a}function rp(e,t,r,a){var n=tp(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&X(e,0,n)}var ap=Jr,np=ma;function ip(){}function sp(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=gf(e,t-19),r}function op(e,t,r){r==null&&(r=H(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Rn({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Zo(e,r),r.slice(0,r.l)}function cp(e){var t=Yt(e);return[t]}function lp(e,t,r){return r==null&&(r=H(8)),Xr(t,r)}function fp(e){var t=Yr(e);return[t]}function up(e,t,r){return r==null&&(r=H(4)),Kr(t,r)}function dp(e){var t=Yt(e),r=e.read_shift(1);return[t,r,"b"]}function hp(e,t,r){return r==null&&(r=H(9)),Xr(t,r),r.write_shift(1,e.v?1:0),r}function pp(e){var t=Yr(e),r=e.read_shift(1);return[t,r,"b"]}function mp(e,t,r){return r==null&&(r=H(5)),Kr(t,r),r.write_shift(1,e.v?1:0),r}function gp(e){var t=Yt(e),r=e.read_shift(1);return[t,r,"e"]}function xp(e,t,r){return r==null&&(r=H(9)),Xr(t,r),r.write_shift(1,e.v),r}function vp(e){var t=Yr(e),r=e.read_shift(1);return[t,r,"e"]}function wp(e,t,r){return r==null&&(r=H(8)),Kr(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function yp(e){var t=Yt(e),r=e.read_shift(4);return[t,r,"s"]}function _p(e,t,r){return r==null&&(r=H(12)),Xr(t,r),r.write_shift(4,t.v),r}function Ep(e){var t=Yr(e),r=e.read_shift(4);return[t,r,"s"]}function kp(e,t,r){return r==null&&(r=H(8)),Kr(t,r),r.write_shift(4,t.v),r}function Sp(e){var t=Yt(e),r=ga(e);return[t,r,"n"]}function bp(e,t,r){return r==null&&(r=H(16)),Xr(t,r),jr(e.v,r),r}function Tp(e){var t=Yr(e),r=ga(e);return[t,r,"n"]}function Ap(e,t,r){return r==null&&(r=H(12)),Kr(t,r),jr(e.v,r),r}function Cp(e){var t=Yt(e),r=Qo(e);return[t,r,"n"]}function Fp(e,t,r){return r==null&&(r=H(12)),Xr(t,r),ec(e.v,r),r}function Rp(e){var t=Yr(e),r=Qo(e);return[t,r,"n"]}function Dp(e,t,r){return r==null&&(r=H(8)),Kr(t,r),ec(e.v,r),r}function Ip(e){var t=Yt(e),r=Yi(e);return[t,r,"is"]}function Np(e){var t=Yt(e),r=yt(e);return[t,r,"str"]}function Op(e,t,r){return r==null&&(r=H(12+4*e.v.length)),Xr(t,r),ct(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Pp(e){var t=Yr(e),r=yt(e);return[t,r,"str"]}function Lp(e,t,r){return r==null&&(r=H(8+4*e.v.length)),Kr(t,r),ct(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Bp(e,t,r){var a=e.l+t,n=Yt(e);n.r=r["!row"];var i=e.read_shift(1),s=[n,i,"b"];if(r.cellFormula){e.l+=2;var o=jn(e,a-e.l,r);s[3]=ua(o,null,n,r.supbooks,r)}else e.l=a;return s}function Mp(e,t,r){var a=e.l+t,n=Yt(e);n.r=r["!row"];var i=e.read_shift(1),s=[n,i,"e"];if(r.cellFormula){e.l+=2;var o=jn(e,a-e.l,r);s[3]=ua(o,null,n,r.supbooks,r)}else e.l=a;return s}function $p(e,t,r){var a=e.l+t,n=Yt(e);n.r=r["!row"];var i=ga(e),s=[n,i,"n"];if(r.cellFormula){e.l+=2;var o=jn(e,a-e.l,r);s[3]=ua(o,null,n,r.supbooks,r)}else e.l=a;return s}function Up(e,t,r){var a=e.l+t,n=Yt(e);n.r=r["!row"];var i=yt(e),s=[n,i,"str"];if(r.cellFormula){e.l+=2;var o=jn(e,a-e.l,r);s[3]=ua(o,null,n,r.supbooks,r)}else e.l=a;return s}var Vp=Jr,Hp=ma;function Wp(e,t){return t==null&&(t=H(4)),t.write_shift(4,e),t}function jp(e,t){var r=e.l+t,a=Jr(e,16),n=Ki(e),i=yt(e),s=yt(e),o=yt(e);e.l=r;var c={rfx:a,relId:n,loc:i,display:o};return s&&(c.Tooltip=s),c}function Gp(e,t){var r=H(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ma({s:ot(e[0]),e:ot(e[0])},r),Ji("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return ct(n||"",r),ct(e[1].Tooltip||"",r),ct("",r),r.slice(0,r.l)}function zp(){}function Xp(e,t,r){var a=e.l+t,n=tc(e,16),i=e.read_shift(1),s=[n];if(s[2]=i,r.cellFormula){var o=Ph(e,a-e.l,r);s[1]=o}else e.l=a;return s}function Yp(e,t,r){var a=e.l+t,n=Jr(e,16),i=[n];if(r.cellFormula){var s=Bh(e,a-e.l,r);i[1]=s,e.l=a}else e.l=a;return i}function Kp(e,t,r){r==null&&(r=H(18));var a=Gn(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var Mc=["left","right","top","bottom","header","footer"];function Jp(e){var t={};return Mc.forEach(function(r){t[r]=ga(e,8)}),t}function qp(e,t){return t==null&&(t=H(48)),Lc(e),Mc.forEach(function(r){jr(e[r],t)}),t}function Zp(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Qp(e,t,r){r==null&&(r=H(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function e1(e){var t=H(24);return t.write_shift(4,4),t.write_shift(4,1),ma(e,t),t}function t1(e,t){return t==null&&(t=H(66)),t.write_shift(2,e.password?wc(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function r1(){}function a1(){}function n1(e,t,r,a,n,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=It(t),t.z=t.z||qe[14],t.v=Dt(bt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:a};switch(c.s=Dr(n.cellXfs,t,n),t.l&&i["!links"].push([Ue(c),t.l]),t.c&&i["!comments"].push([Ue(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=rs(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,s?X(e,18,kp(t,c)):X(e,7,_p(t,c))):(c.t="str",s?X(e,17,Lp(t,c)):X(e,6,Op(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?X(e,13,Dp(t,c)):X(e,2,Fp(t,c)):s?X(e,16,Ap(t,c)):X(e,5,bp(t,c)),!0;case"b":return c.t="b",s?X(e,15,mp(t,c)):X(e,4,hp(t,c)),!0;case"e":return c.t="e",s?X(e,14,wp(t,c)):X(e,3,xp(t,c)),!0}return s?X(e,12,up(t,c)):X(e,1,lp(t,c)),!0}function i1(e,t,r,a){var n=ze(t["!ref"]||"A1"),i,s="",o=[];X(e,145);var c=Array.isArray(t),l=n.e.r;t["!rows"]&&(l=Math.max(n.e.r,t["!rows"].length-1));for(var f=n.s.r;f<=l;++f){s=pt(f),rp(e,t,n,f);var h=!1;if(f<=n.e.r)for(var d=n.s.c;d<=n.e.c;++d){f===n.s.r&&(o[d]=wt(d)),i=o[d]+s;var u=c?(t[f]||[])[d]:t[i];if(!u){h=!1;continue}h=n1(e,u,f,d,a,t,h)}}X(e,146)}function s1(e,t){!t||!t["!merges"]||(X(e,177,Wp(t["!merges"].length)),t["!merges"].forEach(function(r){X(e,176,Hp(r))}),X(e,178))}function o1(e,t){!t||!t["!cols"]||(X(e,390),t["!cols"].forEach(function(r,a){r&&X(e,60,Kp(a,r))}),X(e,391))}function c1(e,t){!t||!t["!ref"]||(X(e,648),X(e,649,e1(ze(t["!ref"]))),X(e,650))}function l1(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Me(r,-1,a[1].Target.replace(/#.*$/,""),Ie.HLINK);X(e,494,Gp(a,n))}}),delete t["!links"]}function f1(e,t,r,a){if(t["!comments"].length>0){var n=Me(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ie.VML);X(e,551,Ji("rId"+n)),t["!legacy"]=n}}function u1(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:rt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ut(i);o.s.r==o.e.r&&(o.e.r=Ut(t["!ref"]).e.r,i=rt(o));for(var c=0;c<s.length;++c){var l=s[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),X(e,161,ma(ze(i))),X(e,162)}}function d1(e,t,r){X(e,133),X(e,137,Qp(t,r)),X(e,138),X(e,134)}function h1(e,t){t["!protect"]&&X(e,535,t1(t["!protect"]))}function p1(e,t,r,a){var n=Rt(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=ze(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],X(n,129),(r.vbaraw||s["!outline"])&&X(n,147,op(o,s["!outline"])),X(n,148,np(c)),d1(n,s,r.Workbook),o1(n,s,e,t,r),i1(n,s,e,t,r),h1(n,s),u1(n,s,r,e),s1(n,s),l1(n,s,a),s["!margins"]&&X(n,476,qp(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&c1(n,s),f1(n,s,e,a),X(n,130),n.end()}function m1(e,t){e.l+=10;var r=yt(e,t-10);return{name:r}}var g1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function x1(e){return!e.Workbook||!e.Workbook.WBProps?"false":zl(e.Workbook.WBProps.date1904)?"true":"false"}var v1="][*?/\\".split("");function $c(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return v1.forEach(function(a){if(e.indexOf(a)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function w1(e,t,r){e.forEach(function(a,n){$c(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var s=t&&t[n]&&t[n].CodeName||a;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function y1(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];w1(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Hh(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Uc(e){var t=[at];t[t.length]=Q("workbook",null,{xmlns:da[0],"xmlns:r":st.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(g1.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Q("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:$e(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Q("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Q("definedName",$e(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function _1(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ii(e,t-8),r.name=yt(e),r}function E1(e,t){return t||(t=H(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Ji(e.strRelID,t),ct(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function k1(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?yt(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function S1(e,t){t||(t=H(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Zo(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function b1(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=xf(e),s=Lh(e,0,r),o=Ki(e);e.l=a;var c={Name:i,Ptg:s};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function T1(e,t){X(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};X(e,156,E1(n))}X(e,144)}function A1(e,t){t||(t=H(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ct("SheetJS",t),ct(Ba.version,t),ct(Ba.version,t),ct("7262",t),t.length>t.l?t.slice(0,t.l):t}function C1(e,t){t||(t=H(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function F1(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(X(e,135),X(e,158,C1(n)),X(e,136))}}function R1(e,t){var r=Rt();return X(r,131),X(r,128,A1()),X(r,153,S1(e.Workbook&&e.Workbook.WBProps||null)),F1(r,e,t),T1(r,e,t),X(r,132),r.end()}function D1(e,t,r){return(t.slice(-4)===".bin"?R1:Uc)(e,r)}function I1(e,t,r,a,n){return(t.slice(-4)===".bin"?p1:Bc)(e,r,a,n)}function N1(e,t,r){return(t.slice(-4)===".bin"?qu:Ec)(e,r)}function O1(e,t,r){return(t.slice(-4)===".bin"?Su:vc)(e,r)}function P1(e,t,r){return(t.slice(-4)===".bin"?hd:Ac)(e,r)}function L1(e){return(e.slice(-4)===".bin"?id:bc)()}function B1(e,t){var r=[];return e.Props&&r.push(Nf(e.Props,t)),e.Custprops&&r.push(Of(e.Props,e.Custprops,t)),r.join("")}function M1(){return""}function $1(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(Q("NumberFormat",null,{"ss:Format":$e(qe[a.numFmtId])}));var s={"ss:ID":"s"+(21+n)};r.push(Q("Style",i.join(""),s))}),Q("Styles",r.join(""))}function Vc(e){return Q("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+es(e.Ref,{r:0,c:0})})}function U1(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(Vc(n)))}return Q("Names",r.join(""))}function V1(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],s=0;s<n.length;++s){var o=n[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(Vc(o)))}return i.join("")}function H1(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Q("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Q("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Q("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Q("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ht("ProtectContents","True")),e["!protect"].objects&&n.push(ht("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ht("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(ht("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(ht("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&n.push("<"+s[1]+"/>")})),n.length==0?"":Q("WorksheetOptions",n.join(""),{xmlns:$t.x})}function W1(e){return e.map(function(t){var r=Gl(t.t||""),a=Q("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Q("Comment",a,{"ss:Author":t.a})}).join("")}function j1(e,t,r,a,n,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+$e(es(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=ot(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=$e(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=$e(e.l.Tooltip))),r["!merges"])for(var l=r["!merges"],f=0;f!=l.length;++f)l[f].s.c!=s.c||l[f].s.r!=s.r||(l[f].e.c>l[f].s.c&&(o["ss:MergeAcross"]=l[f].e.c-l[f].s.c),l[f].e.r>l[f].s.r&&(o["ss:MergeDown"]=l[f].e.r-l[f].s.r));var h="",d="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=za[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||qe[14]);break;case"s":h="String",d=jl(e.v||"");break}var u=Dr(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+u),o["ss:Index"]=s.c+1;var m=e.v!=null?d:"",p=e.t=="z"?"":'<Data ss:Type="'+h+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=W1(e.c)),Q("Cell",p,o)}function G1(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=_c(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function z1(e,t,r,a){if(!e["!ref"])return"";var n=ze(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,S){Zi(x);var y=!!x.width,T=Gn(S,x),D={"ss:Index":S+1};y&&(D["ss:Width"]=In(T.width)),x.hidden&&(D["ss:Hidden"]="1"),o.push(Q("Column",null,D))});for(var c=Array.isArray(e),l=n.s.r;l<=n.e.r;++l){for(var f=[G1(l,(e["!rows"]||[])[l])],h=n.s.c;h<=n.e.c;++h){var d=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>h)&&!(i[s].s.r>l)&&!(i[s].e.c<h)&&!(i[s].e.r<l)){(i[s].s.c!=h||i[s].s.r!=l)&&(d=!0);break}if(!d){var u={r:l,c:h},m=Ue(u),p=c?(e[l]||[])[h]:e[m];f.push(j1(p,m,e,t,r,a,u))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function X1(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],s=i?V1(i,t,e,r):"";return s.length>0&&a.push("<Names>"+s+"</Names>"),s=i?z1(i,t,e,r):"",s.length>0&&a.push("<Table>"+s+"</Table>"),a.push(H1(i,t,e,r)),a.join("")}function Y1(e,t){t||(t={}),e.SSF||(e.SSF=It(qe)),e.SSF&&($n(),Mn(e.SSF),t.revssf=Un(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Dr(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(B1(e,t)),r.push(M1(e,t)),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Q("Worksheet",X1(a,t,e),{"ss:Name":$e(e.SheetNames[a])}));return r[2]=$1(e,t),r[3]=U1(e,t),at+Q("Workbook",r.join(""),{xmlns:$t.ss,"xmlns:o":$t.o,"xmlns:x":$t.x,"xmlns:ss":$t.ss,"xmlns:dt":$t.dt,"xmlns:html":$t.html})}var Ai={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function K1(e,t){var r=[],a=[],n=[],i=0,s,o=zs(io,"n"),c=zs(so,"n");if(e.Props)for(s=mt(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?a:n).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=mt(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?a:n).push([s[i],e.Custprops[s[i]]]);var l=[];for(i=0;i<n.length;++i)uc.indexOf(n[i][0])>-1||cc.indexOf(n[i][0])>-1||n[i][1]!=null&&l.push(n[i]);a.length&&Ve.utils.cfb_add(t,"/SummaryInformation",uo(a,Ai.SI,c,so)),(r.length||l.length)&&Ve.utils.cfb_add(t,"/DocumentSummaryInformation",uo(r,Ai.DSI,o,io,l.length?l:null,Ai.UDI))}function J1(e,t){var r=t||{},a=Ve.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ve.utils.cfb_add(a,n,Hc(e,r)),r.biff==8&&(e.Props||e.Custprops)&&K1(e,a),r.biff==8&&e.vbaraw&&pd(a,Ve.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var q1={0:{f:ep},1:{f:cp},2:{f:Cp},3:{f:gp},4:{f:dp},5:{f:Sp},6:{f:Np},7:{f:yp},8:{f:Up},9:{f:$p},10:{f:Bp},11:{f:Mp},12:{f:fp},13:{f:Rp},14:{f:vp},15:{f:pp},16:{f:Tp},17:{f:Pp},18:{f:Ep},19:{f:Yi},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:b1},40:{},42:{},43:{f:Nu},44:{f:Du},45:{f:Lu},46:{f:Mu},47:{f:Bu},48:{},49:{f:ff},50:{},51:{f:ed},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uu},62:{f:Ip},63:{f:sd},64:{f:r1},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Zp},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:sp},148:{f:ap,p:16},151:{f:zp},152:{},153:{f:k1},154:{},155:{},156:{f:_1},157:{},158:{},159:{T:1,f:_u},160:{T:-1},161:{T:1,f:Jr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Vp},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Zu},336:{T:-1},337:{f:ad,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ii},357:{},358:{},359:{},360:{T:1},361:{},362:{f:iu},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Xp},427:{f:Yp},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Jp},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ip},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:jp},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ii},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ud},633:{T:1},634:{T:-1},635:{T:1,f:ld},636:{T:-1},637:{f:pf},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:m1},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:a1},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function te(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,s=e.next(4);s.write_shift(2,n),s.write_shift(2,i),i>0&&Gi(r)&&e.push(r)}}function Z1(e,t,r,a){var n=a||(r||[]).length||0;if(n<=8224)return te(e,t,r,n);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,c=0,l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,l),e.push(r.slice(c,c+l)),c+=l;c<n;){for(f=e.next(4),f.write_shift(2,60),l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;f.write_shift(2,l),e.push(r.slice(c,c+l)),c+=l}}}function Ya(e,t,r){return e||(e=H(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Q1(e,t,r,a){var n=H(9);return Ya(n,e,t),hc(r,a||"b",n),n}function em(e,t,r){var a=H(8+2*r.length);return Ya(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function tm(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Dt(bt(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?te(e,2,mu(r,a,n)):te(e,3,pu(r,a,n));return;case"b":case"e":te(e,5,Q1(r,a,t.v,t.t));return;case"s":case"str":te(e,4,em(r,a,(t.v||"").slice(0,255)));return}te(e,1,Ya(null,r,a))}function rm(e,t,r,a){var n=Array.isArray(t),i=ze(t["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=rt(i)}for(var l=i.s.r;l<=i.e.r;++l){o=pt(l);for(var f=i.s.c;f<=i.e.c;++f){l===i.s.r&&(c[f]=wt(f)),s=c[f]+o;var h=n?(t[l]||[])[f]:t[s];h&&tm(e,h,l,f,a)}}}function am(e,t){var r=t||{};or!=null&&r.dense==null&&(r.dense=or);for(var a=Rt(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return te(a,r.biff==4?1033:r.biff==3?521:9,qi(e,16,r)),rm(a,e.Sheets[e.SheetNames[n]],n,r,e),te(a,10),a.end()}function nm(e,t,r){te(e,49,qf({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function im(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&te(e,1054,eu(n,t[n],r))})}function sm(e,t){var r=H(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),te(e,2151,r),r=H(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),gc(ze(t["!ref"]||"A1"),r),r.write_shift(4,4),te(e,2152,r)}function om(e,t){for(var r=0;r<16;++r)te(e,224,po({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){te(e,224,po(a,0,t))})}function cm(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];te(e,440,cu(a)),a[1].Tooltip&&te(e,2048,lu(a))}delete t["!links"]}function lm(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&te(e,125,du(Gn(n,a),n))})}}function fm(e,t,r,a,n){var i=16+Dr(n.cellXfs,t,n);if(t.v==null&&!t.bf){te(e,513,Gr(r,a,i));return}if(t.bf)te(e,6,Oh(t,r,a,n,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Dt(bt(t.v)):t.v;te(e,515,nu(r,a,s,i,n));break;case"b":case"e":te(e,517,au(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var o=rs(n.Strings,t.v,n.revStrings);te(e,253,Zf(r,a,o,i,n))}else te(e,516,Qf(r,a,(t.v||"").slice(0,255),i,n));break;default:te(e,513,Gr(r,a,i))}}function um(e,t,r){var a=Rt(),n=r.SheetNames[e],i=r.Sheets[n]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),l=t.biff==8,f,h="",d=[],u=ze(i["!ref"]||"A1"),m=l?65536:16384;if(u.e.c>255||u.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,m-1)}te(a,2057,qi(r,16,t)),te(a,13,Xt(1)),te(a,12,Xt(100)),te(a,15,St(!0)),te(a,17,St(!1)),te(a,16,jr(.001)),te(a,95,St(!0)),te(a,42,St(!1)),te(a,43,St(!1)),te(a,130,Xt(1)),te(a,128,ru([0,0])),te(a,131,St(!1)),te(a,132,St(!1)),l&&lm(a,i["!cols"]),te(a,512,tu(u,t)),l&&(i["!links"]=[]);for(var p=u.s.r;p<=u.e.r;++p){h=pt(p);for(var x=u.s.c;x<=u.e.c;++x){p===u.s.r&&(d[x]=wt(x)),f=d[x]+h;var S=c?(i[p]||[])[x]:i[f];S&&(fm(a,S,p,x,t),l&&S.l&&i["!links"].push([f,S.l]))}}var y=o.CodeName||o.name||n;return l&&te(a,574,Jf((s.Views||[])[0])),l&&(i["!merges"]||[]).length&&te(a,229,ou(i["!merges"])),l&&cm(a,i),te(a,442,mc(y,t)),l&&sm(a,i),te(a,10),a.end()}function dm(e,t,r){var a=Rt(),n=(e||{}).Workbook||{},i=n.Sheets||[],s=n.WBProps||{},o=r.biff==8,c=r.biff==5;if(te(a,2057,qi(e,5,r)),r.bookType=="xla"&&te(a,135),te(a,225,o?Xt(1200):null),te(a,193,Bf(2)),c&&te(a,191),c&&te(a,192),te(a,226),te(a,92,zf("SheetJS",r)),te(a,66,Xt(o?1200:1252)),o&&te(a,353,Xt(0)),o&&te(a,448),te(a,317,hu(e.SheetNames.length)),o&&e.vbaraw&&te(a,211),o&&e.vbaraw){var l=s.CodeName||"ThisWorkbook";te(a,442,mc(l,r))}te(a,156,Xt(17)),te(a,25,St(!1)),te(a,18,St(!1)),te(a,19,Xt(0)),o&&te(a,431,St(!1)),o&&te(a,444,Xt(0)),te(a,61,Kf(r)),te(a,64,St(!1)),te(a,141,Xt(0)),te(a,34,St(x1(e)=="true")),te(a,14,St(!0)),o&&te(a,439,St(!1)),te(a,218,Xt(0)),nm(a,e,r),im(a,e.SSF,r),om(a,r),o&&te(a,352,St(!1));var f=a.end(),h=Rt();o&&te(h,140,fu()),o&&r.Strings&&Z1(h,252,Yf(r.Strings,r)),te(h,10);var d=h.end(),u=Rt(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var x=f.length+m+d.length;for(p=0;p<e.SheetNames.length;++p){var S=i[p]||{};te(u,133,Xf({pos:x,hs:S.Hidden||0,dt:0,name:e.SheetNames[p]},r)),x+=t[p].length}var y=u.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var T=[];return f.length&&T.push(f),y.length&&T.push(y),d.length&&T.push(d),dt(T)}function hm(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=It(qe)),e&&e.SSF&&($n(),Mn(e.SSF),r.revssf=Un(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,as(r),r.cellXfs=[],Dr(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=um(n,r,e);return a.unshift(dm(e,a,r)),dt(a)}function Hc(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Ut(a["!ref"]);n.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return hm(e,t);case 4:case 3:case 2:return am(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function pm(e,t,r,a){for(var n=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>r||n[l].s.c>s)&&!(n[l].e.r<r||n[l].e.c<s)){if(n[l].s.r<r||n[l].s.c<s){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var f=Ue({r,c:s}),h=a.dense?(e[r]||[])[s]:e[f],d=h&&h.v!=null&&(h.h||Wl(h.w||(vr(h),h.w)||""))||"",u={};o>1&&(u.rowspan=o),c>1&&(u.colspan=c),a.editable?d='<span contenteditable="true">'+d+"</span>":h&&(u["data-t"]=h&&h.t||"z",h.v!=null&&(u["data-v"]=h.v),h.z!=null&&(u["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),u.id=(a.id||"sjs")+"-"+f,i.push(Q("td",d,u))}}var m="<tr>";return m+i.join("")+"</tr>"}var mm='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gm="</body></html>";function xm(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Wc(e,t){var r=t||{},a=r.header!=null?r.header:mm,n=r.footer!=null?r.footer:gm,i=[a],s=Ut(e["!ref"]);r.dense=Array.isArray(e),i.push(xm(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(pm(e,s,o,r));return i.push("</table>"+n),i.join("")}function jc(e,t,r){var a=r||{};or!=null&&(a.dense=or);var n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var s=typeof a.origin=="string"?ot(a.origin):a.origin;n=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var f=Ut(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),n==-1&&(l.e.r=n=f.e.r+1)}var h=[],d=0,u=e["!rows"]||(e["!rows"]=[]),m=0,p=0,x=0,S=0,y=0,T=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<c;++m){var D=o[m];if(_o(D)){if(a.display)continue;u[p]={hidden:!0}}var N=D.children;for(x=S=0;x<N.length;++x){var K=N[x];if(!(a.display&&_o(K))){var b=K.hasAttribute("data-v")?K.getAttribute("data-v"):K.hasAttribute("v")?K.getAttribute("v"):Xl(K.innerHTML),O=K.getAttribute("data-z")||K.getAttribute("z");for(d=0;d<h.length;++d){var A=h[d];A.s.c==S+i&&A.s.r<p+n&&p+n<=A.e.r&&(S=A.e.c+1-i,d=-1)}T=+K.getAttribute("colspan")||1,((y=+K.getAttribute("rowspan")||1)>1||T>1)&&h.push({s:{r:p+n,c:S+i},e:{r:p+n+(y||1)-1,c:S+i+(T||1)-1}});var I={t:"s",v:b},V=K.getAttribute("data-t")||K.getAttribute("t")||"";b!=null&&(b.length==0?I.t=V||"z":a.raw||b.trim().length==0||V=="s"||(b==="TRUE"?I={t:"b",v:!0}:b==="FALSE"?I={t:"b",v:!1}:isNaN(mr(b))?isNaN(Ua(b).getDate())||(I={t:"d",v:bt(b)},a.cellDates||(I={t:"n",v:Dt(I.v)}),I.z=a.dateNF||qe[14]):I={t:"n",v:mr(b)})),I.z===void 0&&O!=null&&(I.z=O);var j="",se=K.getElementsByTagName("A");if(se&&se.length)for(var pe=0;pe<se.length&&!(se[pe].hasAttribute("href")&&(j=se[pe].getAttribute("href"),j.charAt(0)!="#"));++pe);j&&j.charAt(0)!="#"&&(I.l={Target:j}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][S+i]=I):e[Ue({c:S+i,r:p+n})]=I,l.e.c<S+i&&(l.e.c=S+i),S+=T}}++p}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,p-1+n),e["!ref"]=rt(l),p>=c&&(e["!fullref"]=rt((l.e.r=o.length-m+p-1+n,l))),e}function Gc(e,t){var r=t||{},a=r.dense?[]:{};return jc(a,e,t)}function vm(e,t){return zr(Gc(e,t),t)}function _o(e){var t="",r=wm(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function wm(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var ym=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Va({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return at+t}})(),Eo=(function(){var e=function(i){return $e(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,s,o){var c=[];c.push('      <table:table table:name="'+$e(s.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,f=0,h=Ut(i["!ref"]||"A1"),d=i["!merges"]||[],u=0,m=Array.isArray(i);if(i["!cols"])for(f=0;f<=h.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",x=i["!rows"]||[];for(l=0;l<h.s.r;++l)p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=h.e.r;++l){for(p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`>
`),f=0;f<h.s.c;++f)c.push(t);for(;f<=h.e.c;++f){var S=!1,y={},T="";for(u=0;u!=d.length;++u)if(!(d[u].s.c>f)&&!(d[u].s.r>l)&&!(d[u].e.c<f)&&!(d[u].e.r<l)){(d[u].s.c!=f||d[u].s.r!=l)&&(S=!0),y["table:number-columns-spanned"]=d[u].e.c-d[u].s.c+1,y["table:number-rows-spanned"]=d[u].e.r-d[u].s.r+1;break}if(S){c.push(r);continue}var D=Ue({r:l,c:f}),N=m?(i[l]||[])[f]:i[D];if(N&&N.f&&(y["table:formula"]=$e(Uh(N.f)),N.F&&N.F.slice(0,D.length)==D)){var K=Ut(N.F);y["table:number-matrix-columns-spanned"]=K.e.c-K.s.c+1,y["table:number-matrix-rows-spanned"]=K.e.r-K.s.r+1}if(!N){c.push(t);continue}switch(N.t){case"b":T=N.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=N.v?"true":"false";break;case"n":T=N.w||String(N.v||0),y["office:value-type"]="float",y["office:value"]=N.v||0;break;case"s":case"str":T=N.v==null?"":N.v,y["office:value-type"]="string";break;case"d":T=N.w||bt(N.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=bt(N.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(t);continue}var b=e(T);if(N.l&&N.l.Target){var O=N.l.Target;O=O.charAt(0)=="#"?"#"+Vh(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),b=Q("text:a",b,{"xlink:href":O.replace(/&/g,"&amp;")})}c.push("          "+Q("table:table-cell",Q("text:p",b,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var f=0;f<l["!cols"].length;++f)if(l["!cols"][f]){var h=l["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Zi(h),h.ods=o;var d=l["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var f=0;f<l["!rows"].length;++f)if(l["!rows"][f]){l["!rows"][f].ods=c;var h=l["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[at],l=Va({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Va({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+f+`>
`),c.push(sc().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),n(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)c.push(a(s.Sheets[s.SheetNames[h]],s,h,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function zc(e,t){if(t.bookType=="fods")return Eo(e,t);var r=Bi(),a="",n=[],i=[];return a="mimetype",_e(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",_e(r,a,Eo(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",_e(r,a,ym(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",_e(r,a,at+sc()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",_e(r,a,If(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",_e(r,a,Rf(n)),r}function Pn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _m(e){return typeof TextEncoder!="undefined"?new TextEncoder().encode(e):er(hr(e))}function Em(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Rr(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function km(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function Ha(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Be(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function la(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function nt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Ha(e,r),i=n&7;n=Math.floor(n/8);var s=0,o;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Ha(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var l={data:o,type:i};t[n]==null?t[n]=[l]:t[n].push(l)}return t}function ft(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Be(a*8+n.type)),n.type==2&&t.push(Be(n.data.length)),t.push(n.data))})}),Rr(t)}function Zt(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Ha(e,a),i=nt(e.slice(a[0],a[0]+n));a[0]+=n;var s={id:la(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=nt(o.data),l=la(c[3][0].data);s.messages.push({meta:c,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(t=i[3])!=null&&t[0]&&(s.merge=la(i[3][0].data)>>>0>0),r.push(s)}return r}function ta(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Be(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Be(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(s){n.push(s.data),s.meta[3]=[{type:0,data:Be(s.data.length)}],a[2].push({data:ft(s.meta),type:2})});var i=ft(a);t.push(Be(i.length)),t.push(i),n.forEach(function(s){return t.push(s)})}),Rr(t)}function Sm(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Ha(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}n.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,l=0;if(i==1?(l=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(l=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Rr(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var f=Rr(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function Qt(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Sm(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Rr(t)}function ra(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Be(a),s=i.length;t.push(i),a<=60?(s++,t.push(new Uint8Array([a-1<<2]))):a<=256?(s+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(s+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(s+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(s+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),s+=a,n[0]=0,n[1]=s&255,n[2]=s>>8&255,n[3]=s>>16&255,r+=a}return Rr(t)}function Ci(e,t){var r=new Uint8Array(32),a=Pn(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,km(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function Fi(e,t){var r=new Uint8Array(32),a=Pn(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function br(e){var t=nt(e);return Ha(t[1][0].data)}function bm(e,t,r){var a,n,i,s;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&la(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Pn(e[7][0].data),f=0,h=[],d=Pn(e[4][0].data),u=0,m=[],p=0;p<t.length;++p){if(t[p]==null){l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}l.setUint16(p*2,f,!0),d.setUint16(p*2,u,!0);var x,S;switch(typeof t[p]){case"string":x=Ci({t:"s",v:t[p]},r),S=Fi({t:"s",v:t[p]},r);break;case"number":x=Ci({t:"n",v:t[p]},r),S=Fi({t:"n",v:t[p]},r);break;case"boolean":x=Ci({t:"b",v:t[p]},r),S=Fi({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}h.push(x),f+=x.length,m.push(S),u+=S.length,++c}for(e[2][0].data=Be(c);p<e[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return e[6][0].data=Rr(h),e[3][0].data=Rr(m),c}function Tm(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ut(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(rt(a)));var i=Ln(r,{range:a,header:1}),s=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(F){typeof F=="string"&&s.push(F)})});var o={},c=[],l=Ve.read(t.numbers,{type:"base64"});l.FileIndex.map(function(R,F){return[R,l.FullPaths[F]]}).forEach(function(R){var F=R[0],Y=R[1];if(F.type==2&&F.name.match(/\.iwa/)){var le=F.content,me=Qt(le),oe=Zt(me);oe.forEach(function(Z){c.push(Z.id),o[Z.id]={deps:[],location:Y,type:la(Z.messages[0].meta[1][0].data)}})}}),c.sort(function(R,F){return R-F});var f=c.filter(function(R){return R>1}).map(function(R){return[R,Be(R)]});l.FileIndex.map(function(R,F){return[R,l.FullPaths[F]]}).forEach(function(R){var F=R[0],Y=R[1];if(F.name.match(/\.iwa/)){var le=Zt(Qt(F.content));le.forEach(function(me){me.messages.forEach(function(oe){f.forEach(function(Z){me.messages.some(function(Re){return la(Re.meta[1][0].data)!=11006&&Em(Re.data,Z[1])})&&o[Z[0]].deps.push(me.id)})})})}});function h(){for(var R=927262;R<2e6;++R)if(!o[R])return R;throw new Error("Too many messages")}for(var d=Ve.find(l,o[1].location),u=Zt(Qt(d.content)),m,p=0;p<u.length;++p){var x=u[p];x.id==1&&(m=x)}var S=br(nt(m.messages[0].data)[1][0].data);for(d=Ve.find(l,o[S].location),u=Zt(Qt(d.content)),p=0;p<u.length;++p)x=u[p],x.id==S&&(m=x);for(S=br(nt(m.messages[0].data)[2][0].data),d=Ve.find(l,o[S].location),u=Zt(Qt(d.content)),p=0;p<u.length;++p)x=u[p],x.id==S&&(m=x);for(S=br(nt(m.messages[0].data)[2][0].data),d=Ve.find(l,o[S].location),u=Zt(Qt(d.content)),p=0;p<u.length;++p)x=u[p],x.id==S&&(m=x);var y=nt(m.messages[0].data);{y[6][0].data=Be(a.e.r+1),y[7][0].data=Be(a.e.c+1);var T=br(y[46][0].data),D=Ve.find(l,o[T].location),N=Zt(Qt(D.content));{for(var K=0;K<N.length&&N[K].id!=T;++K);if(N[K].id!=T)throw"Bad ColumnRowUIDMapArchive";var b=nt(N[K].messages[0].data);b[1]=[],b[2]=[],b[3]=[];for(var O=0;O<=a.e.c;++O){var A=[];A[1]=A[2]=[{type:0,data:Be(O+420690)}],b[1].push({type:2,data:ft(A)}),b[2].push({type:0,data:Be(O)}),b[3].push({type:0,data:Be(O)})}b[4]=[],b[5]=[],b[6]=[];for(var I=0;I<=a.e.r;++I)A=[],A[1]=A[2]=[{type:0,data:Be(I+726270)}],b[4].push({type:2,data:ft(A)}),b[5].push({type:0,data:Be(I)}),b[6].push({type:0,data:Be(I)});N[K].messages[0].data=ft(b)}D.content=ra(ta(N)),D.size=D.content.length,delete y[46];var V=nt(y[4][0].data);{V[7][0].data=Be(a.e.r+1);var j=nt(V[1][0].data),se=br(j[2][0].data);D=Ve.find(l,o[se].location),N=Zt(Qt(D.content));{if(N[0].id!=se)throw"Bad HeaderStorageBucket";var pe=nt(N[0].messages[0].data);for(I=0;I<i.length;++I){var ee=nt(pe[2][0].data);ee[1][0].data=Be(I),ee[4][0].data=Be(i[I].length),pe[2][I]={type:pe[2][0].type,data:ft(ee)}}N[0].messages[0].data=ft(pe)}D.content=ra(ta(N)),D.size=D.content.length;var ye=br(V[2][0].data);D=Ve.find(l,o[ye].location),N=Zt(Qt(D.content));{if(N[0].id!=ye)throw"Bad HeaderStorageBucket";for(pe=nt(N[0].messages[0].data),O=0;O<=a.e.c;++O)ee=nt(pe[2][0].data),ee[1][0].data=Be(O),ee[4][0].data=Be(a.e.r+1),pe[2][O]={type:pe[2][0].type,data:ft(ee)};N[0].messages[0].data=ft(pe)}D.content=ra(ta(N)),D.size=D.content.length;var Se=br(V[4][0].data);(function(){for(var R=Ve.find(l,o[Se].location),F=Zt(Qt(R.content)),Y,le=0;le<F.length;++le){var me=F[le];me.id==Se&&(Y=me)}var oe=nt(Y.messages[0].data);{oe[3]=[];var Z=[];s.forEach(function(Ze,ie){Z[1]=[{type:0,data:Be(ie)}],Z[2]=[{type:0,data:Be(1)}],Z[3]=[{type:2,data:_m(Ze)}],oe[3].push({type:2,data:ft(Z)})})}Y.messages[0].data=ft(oe);var Re=ta(F),ke=ra(Re);R.content=ke,R.size=R.content.length})();var Xe=nt(V[3][0].data);{var Ce=Xe[1][0];delete Xe[2];var be=nt(Ce.data);{var Fe=br(be[2][0].data);(function(){for(var R=Ve.find(l,o[Fe].location),F=Zt(Qt(R.content)),Y,le=0;le<F.length;++le){var me=F[le];me.id==Fe&&(Y=me)}var oe=nt(Y.messages[0].data);{delete oe[6],delete Xe[7];var Z=new Uint8Array(oe[5][0].data);oe[5]=[];for(var Re=0,ke=0;ke<=a.e.r;++ke){var Ze=nt(Z);Re+=bm(Ze,i[ke],s),Ze[1][0].data=Be(ke),oe[5].push({data:ft(Ze),type:2})}oe[1]=[{type:0,data:Be(a.e.c+1)}],oe[2]=[{type:0,data:Be(a.e.r+1)}],oe[3]=[{type:0,data:Be(Re)}],oe[4]=[{type:0,data:Be(a.e.r+1)}]}Y.messages[0].data=ft(oe);var ie=ta(F),q=ra(ie);R.content=q,R.size=R.content.length})()}Ce.data=ft(be)}V[3][0].data=ft(Xe)}y[4][0].data=ft(V)}m.messages[0].data=ft(y);var C=ta(u),U=ra(C);return d.content=U,d.size=d.content.length,l}function Am(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function as(e){Am([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Cm(e,t){return t.bookType=="ods"?zc(e,t):t.bookType=="numbers"?Tm(e,t):t.bookType=="xlsb"?Fm(e,t):Rm(e,t)}function Fm(e,t){na=1024,e&&!e.SSF&&(e.SSF=It(qe)),e&&e.SSF&&($n(),Mn(e.SSF),t.revssf=Un(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,La?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=Cc.indexOf(t.bookType)>-1,n=ac();as(t=t||{});var i=Bi(),s="",o=0;if(t.cellXfs=[],Dr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",_e(i,s,oc(e.Props,t)),n.coreprops.push(s),Me(t.rels,2,s,Ie.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,_e(i,s,lc(e.Props,t)),n.extprops.push(s),Me(t.rels,3,s,Ie.EXT_PROPS),e.Custprops!==e.Props&&mt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",_e(i,s,fc(e.Custprops,t)),n.custprops.push(s),Me(t.rels,4,s,Ie.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,_e(i,s,I1(o-1,s,t,e,f)),n.sheets.push(s),Me(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ie.WS[0])}if(h){var u=h["!comments"],m=!1,p="";u&&u.length>0&&(p="xl/comments"+o+"."+r,_e(i,p,P1(u,p,t)),n.comments.push(p),Me(f,-1,"../comments"+o+"."+r,Ie.CMNT),m=!0),h["!legacy"]&&m&&_e(i,"xl/drawings/vmlDrawing"+o+".vml",Tc(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&_e(i,ic(s),oa(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,_e(i,s,O1(t.Strings,s,t)),n.strs.push(s),Me(t.wbrels,-1,"sharedStrings."+r,Ie.SST)),s="xl/workbook."+r,_e(i,s,D1(e,s,t)),n.workbooks.push(s),Me(t.rels,1,s,Ie.WB),s="xl/theme/theme1.xml",_e(i,s,Sc(e.Themes,t)),n.themes.push(s),Me(t.wbrels,-1,"theme/theme1.xml",Ie.THEME),s="xl/styles."+r,_e(i,s,N1(e,s,t)),n.styles.push(s),Me(t.wbrels,-1,"styles."+r,Ie.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",_e(i,s,e.vbaraw),n.vba.push(s),Me(t.wbrels,-1,"vbaProject.bin",Ie.VBA)),s="xl/metadata."+r,_e(i,s,L1(s)),n.metadata.push(s),Me(t.wbrels,-1,"metadata."+r,Ie.XLMETA),_e(i,"[Content_Types].xml",nc(n,t)),_e(i,"_rels/.rels",oa(t.rels)),_e(i,"xl/_rels/workbook."+r+".rels",oa(t.wbrels)),delete t.revssf,delete t.ssf,i}function Rm(e,t){na=1024,e&&!e.SSF&&(e.SSF=It(qe)),e&&e.SSF&&($n(),Mn(e.SSF),t.revssf=Un(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,La?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=Cc.indexOf(t.bookType)>-1,n=ac();as(t=t||{});var i=Bi(),s="",o=0;if(t.cellXfs=[],Dr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",_e(i,s,oc(e.Props,t)),n.coreprops.push(s),Me(t.rels,2,s,Ie.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,_e(i,s,lc(e.Props,t)),n.extprops.push(s),Me(t.rels,3,s,Ie.EXT_PROPS),e.Custprops!==e.Props&&mt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",_e(i,s,fc(e.Custprops,t)),n.custprops.push(s),Me(t.rels,4,s,Ie.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],u=(d||{})["!type"]||"sheet";switch(u){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,_e(i,s,Bc(o-1,t,e,h)),n.sheets.push(s),Me(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ie.WS[0])}if(d){var m=d["!comments"],p=!1,x="";if(m&&m.length>0){var S=!1;m.forEach(function(y){y[1].forEach(function(T){T.T==!0&&(S=!0)})}),S&&(x="xl/threadedComments/threadedComment"+o+"."+r,_e(i,x,od(m,f,t)),n.threadedcomments.push(x),Me(h,-1,"../threadedComments/threadedComment"+o+"."+r,Ie.TCMNT)),x="xl/comments"+o+"."+r,_e(i,x,Ac(m,t)),n.comments.push(x),Me(h,-1,"../comments"+o+"."+r,Ie.CMNT),p=!0}d["!legacy"]&&p&&_e(i,"xl/drawings/vmlDrawing"+o+".vml",Tc(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&_e(i,ic(s),oa(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,_e(i,s,vc(t.Strings,t)),n.strs.push(s),Me(t.wbrels,-1,"sharedStrings."+r,Ie.SST)),s="xl/workbook."+r,_e(i,s,Uc(e,t)),n.workbooks.push(s),Me(t.rels,1,s,Ie.WB),s="xl/theme/theme1.xml",_e(i,s,Sc(e.Themes,t)),n.themes.push(s),Me(t.wbrels,-1,"theme/theme1.xml",Ie.THEME),s="xl/styles."+r,_e(i,s,Ec(e,t)),n.styles.push(s),Me(t.wbrels,-1,"styles."+r,Ie.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",_e(i,s,e.vbaraw),n.vba.push(s),Me(t.wbrels,-1,"vbaProject.bin",Ie.VBA)),s="xl/metadata."+r,_e(i,s,bc()),n.metadata.push(s),Me(t.wbrels,-1,"metadata."+r,Ie.XLMETA),f.length>1&&(s="xl/persons/person.xml",_e(i,s,cd(f,t)),n.people.push(s),Me(t.wbrels,-1,"persons/person.xml",Ie.PEOPLE)),_e(i,"[Content_Types].xml",nc(n,t)),_e(i,"_rels/.rels",oa(t.rels)),_e(i,"xl/_rels/workbook."+r+".rels",oa(t.wbrels)),delete t.revssf,delete t.ssf,i}function Dm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=xr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Xc(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ga(t.file,Ve.write(e,{type:Pe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ve.write(e,t)}function Im(e,t){var r=It(t||{}),a=Cm(e,r);return Nm(a,r)}function Nm(e,t){var r={},a=Pe?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Ve.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno!="undefined"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Bn(n))}return t.password&&typeof encrypt_agile!="undefined"?Xc(encrypt_agile(n,t.password),t):t.type==="file"?Ga(t.file,n):t.type=="string"?Ia(n):n}function Om(e,t){var r=t||{},a=J1(e,r);return Xc(a,r)}function sr(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return $a(hr(a));case"binary":return hr(a);case"string":return e;case"file":return Ga(t.file,a,"utf8");case"buffer":return Pe?wr(a,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(a):sr(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Pm(e,t){switch(t.type){case"base64":return $a(e);case"binary":return e;case"string":return e;case"file":return Ga(t.file,e,"binary");case"buffer":return Pe?wr(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function kn(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?$a(r):t.type=="string"?Ia(r):r;case"file":return Ga(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function ns(e,t){sl(),y1(e);var r=It(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=ns(e,r);return r.type="array",Bn(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return sr(Y1(e,r),r);case"slk":case"sylk":return sr(xu.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return sr(Wc(e.Sheets[e.SheetNames[n]],r),r);case"txt":return Pm(Yc(e.Sheets[e.SheetNames[n]],r),r);case"csv":return sr(is(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return sr(vu.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return kn(gu.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return sr(wu.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return sr(Tu.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return sr(xc.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return sr(zc(e,r),r);case"wk1":return kn(mo.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return kn(mo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),kn(Hc(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Om(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Im(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Lm(e,t,r,a,n,i,s,o){var c=pt(r),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!s||e[r])for(var u=t.s.c;u<=t.e.c;++u){var m=s?e[r][u]:e[a[u]+c];if(m===void 0||m.t===void 0){if(l===void 0)continue;i[u]!=null&&(d[i[u]]=l);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[u]!=null){if(p==null)if(m.t=="e"&&p===null)d[i[u]]=null;else if(l!==void 0)d[i[u]]=l;else if(f&&p===null)d[i[u]]=null;else continue;else d[i[u]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:vr(m,p,o);p!=null&&(h=!1)}}return{row:d,isempty:h}}function Ln(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof f){case"string":c=ze(f);break;case"number":c=ze(e["!ref"]),c.s.r=f;break;default:c=f}a>0&&(n=0);var h=pt(c.s.r),d=[],u=[],m=0,p=0,x=Array.isArray(e),S=c.s.r,y=0,T={};x&&!e[S]&&(e[S]=[]);var D=l.skipHidden&&e["!cols"]||[],N=l.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(D[y]||{}).hidden)switch(d[y]=wt(y),r=x?e[S][y]:e[d[y]+h],a){case 1:i[y]=y-c.s.c;break;case 2:i[y]=d[y];break;case 3:i[y]=l.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=vr(r,null,l),p=T[s]||0,!p)T[s]=1;else{do o=s+"_"+p++;while(T[o]);T[s]=p,T[o]=1}i[y]=o}for(S=c.s.r+n;S<=c.e.r;++S)if(!(N[S]||{}).hidden){var K=Lm(e,c,S,d,a,i,x,l);(K.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(u[m++]=K.row)}return u.length=m,u}var ko=/"/g;function Bm(e,t,r,a,n,i,s,o){for(var c=!0,l=[],f="",h=pt(r),d=t.s.c;d<=t.e.c;++d)if(a[d]){var u=o.dense?(e[r]||[])[d]:e[a[d]+h];if(u==null)f="";else if(u.v!=null){c=!1,f=""+(o.rawNumbers&&u.t=="n"?u.v:vr(u,null,o));for(var m=0,p=0;m!==f.length;++m)if((p=f.charCodeAt(m))===n||p===i||p===34||o.forceQuotes){f='"'+f.replace(ko,'""')+'"';break}f=="ID"&&(f='"ID"')}else u.f!=null&&!u.F?(c=!1,f="="+u.f,f.indexOf(",")>=0&&(f='"'+f.replace(ko,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(s)}function is(e,t){var r=[],a=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var n=ze(e["!ref"]),i=a.FS!==void 0?a.FS:",",s=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];a.dense=Array.isArray(e);for(var d=a.skipHidden&&e["!cols"]||[],u=a.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(d[m]||{}).hidden||(h[m]=wt(m));for(var p=0,x=n.s.r;x<=n.e.r;++x)(u[x]||{}).hidden||(f=Bm(e,n,x,h,s,c,i,a),f!=null&&(a.strip&&(f=f.replace(l,"")),(f||a.blankrows!==!1)&&r.push((p++?o:"")+f)));return delete a.dense,r.join("")}function Yc(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=is(e,t);if(typeof We=="undefined"||t.type=="string")return r;var a=We.utils.encode(1200,r,"str");return"\xFF\xFE"+a}function Mm(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=ze(e["!ref"]),i="",s=[],o,c=[],l=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)s[o]=wt(o);for(var f=n.s.r;f<=n.e.r;++f)for(i=pt(f),o=n.s.c;o<=n.e.c;++o)if(t=s[o]+i,r=l?(e[f]||[])[o]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function Kc(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},s=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?ot(a.origin):a.origin;s=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:s+t.length-1+n}};if(i["!ref"]){var h=ze(i["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),s==-1&&(s=h.e.r+1,f.e.r=s+t.length-1+n)}else s==-1&&(s=0,f.e.r=t.length-1+n);var d=a.header||[],u=0;t.forEach(function(p,x){mt(p).forEach(function(S){(u=d.indexOf(S))==-1&&(d[u=d.length]=S);var y=p[S],T="z",D="",N=Ue({c:o+u,r:s+x+n});l=Wa(i,N),y&&typeof y=="object"&&!(y instanceof Date)?i[N]=y:(typeof y=="number"?T="n":typeof y=="boolean"?T="b":typeof y=="string"?T="s":y instanceof Date?(T="d",a.cellDates||(T="n",y=Dt(y)),D=a.dateNF||qe[14]):y===null&&a.nullError&&(T="e",y=0),l?(l.t=T,l.v=y,delete l.w,delete l.R,D&&(l.z=D)):i[N]=l={t:T,v:y},D&&(l.z=D))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var m=pt(s);if(n)for(u=0;u<d.length;++u)i[wt(u+o)+m]={t:"s",v:d[u]};return i["!ref"]=rt(f),i}function $m(e,t){return Kc(null,e,t)}function Wa(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=ot(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wa(e,Ue(t)):Wa(e,Ue({r:t,c:r||0}))}function Um(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Vm(){return{SheetNames:[],Sheets:{}}}function Hm(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var s=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=s+n)!=-1;++n);}if($c(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Wm(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=Um(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function jm(e,t){return e.z=t,e}function Jc(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Gm(e,t,r){return Jc(e,"#"+t,r)}function zm(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Xm(e,t,r,a){for(var n=typeof t!="string"?t:ze(t),i=typeof t=="string"?t:rt(t),s=n.s.r;s<=n.e.r;++s)for(var o=n.s.c;o<=n.e.c;++o){var c=Wa(e,s,o);c.t="n",c.F=i,delete c.v,s==n.s.r&&o==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var zn={encode_col:wt,encode_row:pt,encode_cell:Ue,encode_range:rt,decode_col:Xi,decode_row:zi,split_cell:lf,decode_cell:ot,decode_range:Ut,format_cell:vr,sheet_add_aoa:qo,sheet_add_json:Kc,sheet_add_dom:jc,aoa_to_sheet:pa,json_to_sheet:$m,table_to_sheet:Gc,table_to_book:vm,sheet_to_csv:is,sheet_to_txt:Yc,sheet_to_json:Ln,sheet_to_html:Wc,sheet_to_formulae:Mm,sheet_to_row_object_array:Ln,sheet_get_cell:Wa,book_new:Vm,book_append_sheet:Hm,book_set_sheet_visibility:Wm,cell_set_number_format:jm,cell_set_hyperlink:Jc,cell_set_internal_link:Gm,cell_add_comment:zm,sheet_set_array_formula:Xm,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var Cx=Ba.version;var qc=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
        <path
            d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
        />
    </svg>
`.trim(),Zc=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <rect width="7" height="7" x="3" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="14" rx="1" />
        <rect width="7" height="7" x="3" y="14" rx="1" />
    </svg>
`.trim(),Qc=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="1"/>
        <circle cx="12" cy="5" r="1"/>
        <circle cx="12" cy="19" r="1"/>
    </svg>
`.trim(),Xn=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M12 3v18"/>
        <rect width="18" height="18" x="3" y="3" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
    </svg>
`.trim(),Fx=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
    </svg>
`.trim(),Rx=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
        <path d="M8 7h6"/>
        <path d="M8 11h8"/>
    </svg>
`.trim(),Km={config:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3" />
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.82 2.82l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.82-2.82l.06-.06A1.65 1.65 0 0 0 3 15a1.65 1.65 0 0 0-1.51-1H1a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 3 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.82-2.82l.06.06A1.65 1.65 0 0 0 9 3.6a1.65 1.65 0 0 0 1-1.51V2a2 2 0 0 1 4 0v.09A1.65 1.65 0 0 0 15 3.6a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.82 2.82l-.06.06A1.65 1.65 0 0 0 21 9c0 .3.09.58.24.82.17.28.43.51.76.68.21.1.44.18.68.19H23a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z" />
        </svg>
    `,import:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 3v14" />
            <path d="m7 13 5 5 5-5" />
            <path d="M5 21h14" />
        </svg>
    `,headcount:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
            <circle cx="9" cy="7" r="4" />
            <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
    `,validate:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 6 9 17l-5-5" />
        </svg>
    `,review:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 12h3l2-5 4 10 2-5h5" />
        </svg>
    `,journal:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 7c-3-1-6-1-9 0v12c3-1 6-1 9 0 3-1 6-1 9 0V7c-3-1-6-1-9 0Z" />
            <path d="M12 7v12" />
        </svg>
    `,archive:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="4" rx="1" />
            <path d="M5 7v11a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7" />
            <path d="M10 12h4" />
        </svg>
    `};function e0(e){return e&&Km[e]||""}var ss=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0" />
    </svg>
`.trim(),os=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0v4" />
        <path d="M12 15v2" />
    </svg>
`.trim(),Yn=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M5 12l4 4 10-10" />
    </svg>
`.trim(),Kn=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="4" y="3" width="16" height="18" rx="2" />
        <rect x="8" y="7" width="8" height="3" />
        <path d="M8 14h.01" />
        <path d="M12 14h.01" />
        <path d="M16 14h.01" />
        <path d="M8 17h.01" />
        <path d="M12 17h.01" />
        <path d="M16 17h.01" />
    </svg>
`.trim(),Dx=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 5.5 20.5 8 16 12.5 13.5 10 18 5.5Z" />
        <path d="m12 11 6-6" />
        <path d="M3 22 12 13" />
        <path d="m3 18 4 4" />
        <path d="m11 11 3 3" />
    </svg>
`.trim(),Jn=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 1 0 7.07 7.07l1.71-1.71" />
    </svg>
`.trim(),t0=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M7 10l5 5 5-5" />
        <path d="M12 15V3" />
    </svg>
`.trim(),r0=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M17 8l-5-5-5 5" />
        <path d="M12 3v12" />
    </svg>
`.trim(),a0=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10" />
        <path d="m15 9-6 6" />
        <path d="m9 9 6 6" />
    </svg>
`.trim(),n0=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 19-7-7 7-7" />
        <path d="M19 12H5" />
    </svg>
`.trim(),i0=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" />
        <path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7" />
        <path d="M7 3v4a1 1 0 0 0 1 1h7" />
    </svg>
`.trim(),s0=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 5 7 7-7 7" />
        <path d="M5 12h14" />
    </svg>
`.trim(),Ix=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m9 12 2 2 4-4"/>
    </svg>
`.trim(),Nx=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" x2="12" y1="8" y2="12"/>
        <line x1="12" x2="12.01" y1="16" y2="16"/>
    </svg>
`.trim(),Ox=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/>
        <path d="M12 9v4"/>
        <path d="M12 17h.01"/>
    </svg>
`.trim(),Px=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 16v-4"/>
        <path d="M12 8h.01"/>
    </svg>
`.trim(),Lx=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M21.801 10A10 10 0 1 1 17 3.335"/>
        <path d="m9 11 3 3L22 4"/>
    </svg>
`.trim(),Bx=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m15 9-6 6"/>
        <path d="m9 9 6 6"/>
    </svg>
`.trim(),Mx=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m18 9-6-6-6 6"/>
        <path d="M12 3v14"/>
        <path d="M5 21h14"/>
    </svg>
`.trim(),$x=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m6 15 6 6 6-6"/>
        <path d="M12 21V7"/>
        <path d="M5 3h14"/>
    </svg>
`.trim(),Ka=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
        <path d="M21 3v5h-5"/>
        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
        <path d="M3 21v-5h5"/>
    </svg>
`.trim(),o0=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 6h18"/>
        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
        <line x1="10" x2="10" y1="11" y2="17"/>
        <line x1="14" x2="14" y1="11" y2="17"/>
    </svg>
`.trim();function Ja(e){return e==null?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function cs(e,t){return`
        <div class="pf-labeled-btn">
            ${e}
            <span class="pf-btn-label">${t}</span>
        </div>
    `}function Ir({textareaId:e,value:t,permanentId:r,isPermanent:a,hintId:n,saveButtonId:i,isSaved:s=!1,placeholder:o="Enter notes here..."}){let c=a?os:ss,l=i?`<button type="button" class="pf-action-toggle pf-save-btn ${s?"is-saved":""}" id="${i}" data-save-input="${e}" title="Save notes">${i0}</button>`:"",f=r?`<button type="button" class="pf-action-toggle pf-notes-lock ${a?"is-locked":""}" id="${r}" aria-pressed="${a}" title="Lock notes (retain after archive)">${c}</button>`:"";return`
        <article class="pf-step-card pf-step-detail pf-notes-card">
            <div class="pf-notes-header">
                <div>
                    <h3 class="pf-notes-title">Notes</h3>
                    <p class="pf-notes-subtext">Leave notes your future self will appreciate. Notes clear after archiving. Click lock to retain permanently.</p>
                </div>
            </div>
            <div class="pf-notes-body">
                <textarea id="${e}" rows="6" placeholder="${Ja(o)}">${Ja(t||"")}</textarea>
                ${n?`<p class="pf-signoff-hint" id="${n}"></p>`:""}
            </div>
            <div class="pf-notes-action">
                ${r?cs(f,"Lock"):""}
                ${i?cs(l,"Save"):""}
            </div>
        </article>
    `}function Nr({reviewerInputId:e,reviewerValue:t,signoffInputId:r,signoffValue:a,isComplete:n,saveButtonId:i,isSaved:s=!1,completeButtonId:o,subtext:c="Sign-off below. Click checkmark icon. Done."}){let l=`<button type="button" class="pf-action-toggle ${n?"is-active":""}" id="${o}" aria-pressed="${!!n}" title="Mark step complete">${Yn}</button>`;return`
        <article class="pf-step-card pf-step-detail pf-config-card">
            <div class="pf-config-head pf-notes-header">
                <div>
                    <h3>Sign-off</h3>
                    <p class="pf-config-subtext">${Ja(c)}</p>
                </div>
            </div>
            <div class="pf-config-grid">
                <label class="pf-config-field">
                    <span>Reviewer Name</span>
                    <input type="text" id="${e}" value="${Ja(t)}" placeholder="Full name">
                </label>
                <label class="pf-config-field">
                    <span>Sign-off Date</span>
                    <input type="date" id="${r}" value="${Ja(a)}" readonly>
                </label>
            </div>
            <div class="pf-signoff-action">
                ${cs(l,"Done")}
            </div>
        </article>
    `}function qa(e,t){e&&(e.classList.toggle("is-locked",t),e.setAttribute("aria-pressed",String(t)),e.innerHTML=t?os:ss)}function xa(e,t){e&&e.classList.toggle("is-saved",t)}function ls(e=document){let t=e.querySelectorAll(".pf-save-btn[data-save-input]"),r=[];return t.forEach(a=>{let n=a.getAttribute("data-save-input"),i=document.getElementById(n);if(!i)return;let s=()=>{xa(a,!1)};i.addEventListener("input",s),r.push(()=>i.removeEventListener("input",s))}),()=>r.forEach(a=>a())}function c0(e,t){if(e===0)return{canComplete:!0,blockedBy:null,message:""};for(let r=0;r<e;r++)if(!t[r])return{canComplete:!1,blockedBy:r,message:`Complete Step ${r} before signing off on this step.`};return{canComplete:!0,blockedBy:null,message:""}}function l0(e){let t=document.querySelector(".pf-workflow-toast");t&&t.remove();let r=document.createElement("div");r.className="pf-workflow-toast pf-workflow-toast--warning",r.innerHTML=`
        <span class="pf-workflow-toast-icon">\u26A0\uFE0F</span>
        <span class="pf-workflow-toast-message">${e}</span>
    `,document.body.appendChild(r),requestAnimationFrame(()=>{r.classList.add("pf-workflow-toast--visible")}),setTimeout(()=>{r.classList.remove("pf-workflow-toast--visible"),setTimeout(()=>r.remove(),300)},4e3)}var fs={fillColor:"#000000",fontColor:"#FFFFFF",bold:!0},us={currency:"$#,##0.00",currencyWithNegative:"$#,##0.00;($#,##0.00)",number:"#,##0.00",integer:"#,##0",percent:"0.00%",date:"yyyy-mm-dd",dateTime:"yyyy-mm-dd hh:mm"};function f0(e){e.format.fill.color=fs.fillColor,e.format.font.color=fs.fontColor,e.format.font.bold=fs.bold}function qn(e,t,r,a=!1){if(r<=0)return;let n=e.getRangeByIndexes(1,t,r,1);n.numberFormat=[[a?us.currencyWithNegative:us.currency]]}function u0(e,t,r,a=us.date){if(r<=0)return;let n=e.getRangeByIndexes(1,t,r,1);n.numberFormat=[[a]]}var ni="payroll-recorder";var Lr="Payroll Recorder";function Ke(e,t="info",r=4e3){document.querySelectorAll(".pf-toast").forEach(n=>n.remove());let a=document.createElement("div");if(a.className=`pf-toast pf-toast--${t}`,a.innerHTML=`
        <div class="pf-toast-content">
            <span class="pf-toast-icon">${t==="success"?"\u2705":t==="error"?"\u274C":"\u2139\uFE0F"}</span>
            <span class="pf-toast-message">${e.replace(/\n/g,"<br>")}</span>
        </div>
        <button class="pf-toast-close" onclick="this.parentElement.remove()">\xD7</button>
    `,!document.getElementById("pf-toast-styles")){let n=document.createElement("style");n.id="pf-toast-styles",n.textContent=`
            .pf-toast {
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #1a1a2e;
                color: white;
                padding: 16px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 90%;
                display: flex;
                align-items: flex-start;
                gap: 12px;
                animation: toastIn 0.3s ease;
            }
            .pf-toast--success { border-left: 4px solid #22c55e; }
            .pf-toast--error { border-left: 4px solid #ef4444; }
            .pf-toast--info { border-left: 4px solid #3b82f6; }
            .pf-toast-content { display: flex; align-items: flex-start; gap: 8px; flex: 1; }
            .pf-toast-icon { font-size: 18px; }
            .pf-toast-message { font-size: 14px; line-height: 1.4; }
            .pf-toast-close { background: none; border: none; color: #888; font-size: 20px; cursor: pointer; padding: 0; margin-left: 8px; }
            .pf-toast-close:hover { color: white; }
            @keyframes toastIn { from { opacity: 0; transform: translateX(-50%) translateY(-20px); } }
        `,document.head.appendChild(n)}return document.body.appendChild(a),r>0&&setTimeout(()=>a.remove(),r),a}function Jm(){document.querySelectorAll(".pf-save-prompt").forEach(r=>r.remove());let e=document.createElement("div");if(e.className="pf-save-prompt",e.innerHTML=`
        <div class="pf-save-prompt-content">
            <div class="pf-save-prompt-title">Good work!</div>
            <div class="pf-save-prompt-subtitle">Ready to finalize?</div>
            <button type="button" class="pf-save-prompt-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
                Finalize
            </button>
        </div>
    `,!document.getElementById("pf-save-prompt-styles")){let r=document.createElement("style");r.id="pf-save-prompt-styles",r.textContent=`
            .pf-save-prompt {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(145deg, rgba(30, 30, 50, 0.98), rgba(20, 20, 35, 0.99));
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 32px 40px;
                border-radius: 20px;
                box-shadow: 
                    0 24px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 60px rgba(99, 102, 241, 0.1);
                z-index: 10002;
                text-align: center;
                animation: pf-prompt-fade-in 0.3s ease;
            }
            @keyframes pf-prompt-fade-in {
                from { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
                to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            }
            .pf-save-prompt-content {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            .pf-save-prompt-title {
                font-size: 20px;
                font-weight: 700;
                color: #fff;
            }
            .pf-save-prompt-subtitle {
                font-size: 14px;
                color: rgba(255, 255, 255, 0.6);
                margin-bottom: 12px;
            }
            .pf-save-prompt-btn {
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border: none;
                color: white;
                padding: 12px 28px;
                border-radius: 12px;
                font-size: 15px;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
                transition: all 0.2s ease;
            }
            .pf-save-prompt-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4);
            }
            .pf-save-prompt-btn:active {
                transform: translateY(0);
            }
            .pf-save-prompt.closing {
                animation: pf-prompt-fade-out 0.2s ease forwards;
            }
            @keyframes pf-prompt-fade-out {
                to { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
            }
        `,document.head.appendChild(r)}document.body.appendChild(e),e.querySelector(".pf-save-prompt-btn").addEventListener("click",()=>{e.classList.add("closing"),setTimeout(()=>{e.remove(),qm()},200)})}function qm(){document.querySelectorAll(".pf-toast, .pf-success-toast").forEach(n=>n.remove());let e=[{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"/></svg>',title:"Done.",subtitle:"Efficiency unlocked."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"/><path d="m9 12 2 2 4-4"/></svg>',title:"Locked in.",subtitle:"You're good to go."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><path d="M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z"/><path d="M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z"/></svg>',title:"Stored.",subtitle:"Everything stays aligned."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>',title:"Payroll archived.",subtitle:"Flow restored."}],t=e[Math.floor(Math.random()*e.length)],r=document.createElement("div");if(r.className="pf-success-toast",r.innerHTML=`
        <div class="pf-success-toast-icon">${t.icon}</div>
        <div class="pf-success-toast-text">
            <div class="pf-success-toast-title">${t.title}</div>
            <div class="pf-success-toast-subtitle">${t.subtitle}</div>
        </div>
        <div class="pf-success-toast-progress"></div>
    `,!document.getElementById("pf-success-toast-styles")){let n=document.createElement("style");n.id="pf-success-toast-styles",n.textContent=`
            .pf-success-toast {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(145deg, rgba(30, 30, 50, 0.98), rgba(20, 20, 35, 0.99));
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 36px 48px 24px;
                border-radius: 24px;
                box-shadow: 
                    0 32px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 80px rgba(99, 102, 241, 0.15);
                z-index: 10002;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 16px;
                animation: pf-success-in 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                overflow: hidden;
                text-align: center;
                min-width: 220px;
            }
            @keyframes pf-success-in {
                from { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.9);
                }
                to { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
            }
            @keyframes pf-success-out {
                from { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
                to { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.95) translateY(-20px);
                }
            }
            .pf-success-toast-icon {
                width: 64px;
                height: 64px;
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border-radius: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
                animation: pf-icon-pulse 2s ease-in-out infinite;
            }
            @keyframes pf-icon-pulse {
                0%, 100% { box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4); }
                50% { box-shadow: 0 8px 32px rgba(99, 102, 241, 0.6); }
            }
            .pf-success-toast-text {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
            }
            .pf-success-toast-title {
                font-size: 22px;
                font-weight: 700;
                color: #fff;
                letter-spacing: -0.5px;
            }
            .pf-success-toast-subtitle {
                font-size: 15px;
                color: rgba(255, 255, 255, 0.6);
                font-weight: 500;
            }
            .pf-success-toast-progress {
                position: absolute;
                bottom: 0;
                left: 0;
                height: 4px;
                background: linear-gradient(90deg, #6366f1, #a855f7, #6366f1);
                background-size: 200% 100%;
                animation: pf-progress-shrink 5s linear forwards, pf-progress-shimmer 1s linear infinite;
                border-radius: 0 0 24px 24px;
            }
            @keyframes pf-progress-shrink {
                from { width: 100%; }
                to { width: 0%; }
            }
            @keyframes pf-progress-shimmer {
                from { background-position: 200% 0; }
                to { background-position: -200% 0; }
            }
            .pf-success-toast.closing {
                animation: pf-success-out 0.3s ease forwards;
            }
            .pf-success-backdrop {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.4);
                backdrop-filter: blur(4px);
                -webkit-backdrop-filter: blur(4px);
                z-index: 10001;
                animation: pf-confirm-fade-in 0.2s ease;
            }
        `,document.head.appendChild(n)}let a=document.createElement("div");a.className="pf-success-backdrop",document.body.appendChild(a),document.body.appendChild(r),setTimeout(()=>{r.classList.add("closing"),a.style.opacity="0",a.style.transition="opacity 0.3s ease",setTimeout(()=>{r.remove(),a.remove(),Ng()},300)},5e3)}function vs(e,t={}){let{title:r="Confirm Action",confirmText:a="Continue",cancelText:n="Cancel",icon:i="\u{1F5C2}\uFE0F",destructive:s=!1}=t;return new Promise(o=>{document.querySelectorAll(".pf-confirm-overlay").forEach(l=>l.remove());let c=document.createElement("div");if(c.className="pf-confirm-overlay",c.innerHTML=`
            <div class="pf-confirm-dialog">
                <div class="pf-confirm-icon">${i}</div>
                <div class="pf-confirm-title">${r}</div>
                <div class="pf-confirm-message">${e.replace(/\n/g,"<br>")}</div>
                <div class="pf-confirm-buttons">
                    <button class="pf-confirm-btn pf-confirm-btn--cancel">${n}</button>
                    <button class="pf-confirm-btn pf-confirm-btn--ok ${s?"pf-confirm-btn--destructive":""}">${a}</button>
                </div>
            </div>
        `,!document.getElementById("pf-confirm-styles")){let l=document.createElement("style");l.id="pf-confirm-styles",l.textContent=`
                .pf-confirm-overlay {
                    position: fixed;
                    inset: 0;
                    background: rgba(0, 0, 0, 0.5);
                    backdrop-filter: blur(8px);
                    -webkit-backdrop-filter: blur(8px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10001;
                    animation: pf-confirm-fade-in 0.2s ease;
                }
                @keyframes pf-confirm-fade-in {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                @keyframes pf-confirm-scale-in {
                    from { opacity: 0; transform: scale(0.95) translateY(-10px); }
                    to { opacity: 1; transform: scale(1) translateY(0); }
                }
                .pf-confirm-dialog {
                    background: linear-gradient(145deg, rgba(30, 30, 50, 0.95), rgba(20, 20, 35, 0.98));
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    color: white;
                    padding: 28px 32px;
                    border-radius: 20px;
                    max-width: 380px;
                    width: 90%;
                    box-shadow: 
                        0 24px 48px rgba(0, 0, 0, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.05) inset,
                        0 1px 0 rgba(255, 255, 255, 0.1) inset;
                    text-align: center;
                    animation: pf-confirm-scale-in 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
                }
                .pf-confirm-icon {
                    font-size: 48px;
                    margin-bottom: 16px;
                    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
                }
                .pf-confirm-title {
                    font-size: 18px;
                    font-weight: 600;
                    color: #fff;
                    margin-bottom: 12px;
                    letter-spacing: -0.3px;
                }
                .pf-confirm-message {
                    font-size: 14px;
                    line-height: 1.6;
                    color: rgba(255, 255, 255, 0.7);
                    margin-bottom: 24px;
                    text-align: left;
                }
                .pf-confirm-buttons {
                    display: flex;
                    gap: 12px;
                    justify-content: center;
                }
                .pf-confirm-btn {
                    flex: 1;
                    padding: 12px 24px;
                    border-radius: 12px;
                    border: none;
                    cursor: pointer;
                    font-size: 15px;
                    font-weight: 600;
                    letter-spacing: -0.2px;
                    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                }
                .pf-confirm-btn:active {
                    transform: scale(0.97);
                }
                .pf-confirm-btn--cancel {
                    background: rgba(255, 255, 255, 0.08);
                    color: rgba(255, 255, 255, 0.9);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                }
                .pf-confirm-btn--cancel:hover {
                    background: rgba(255, 255, 255, 0.12);
                    border-color: rgba(255, 255, 255, 0.15);
                }
                .pf-confirm-btn--ok {
                    background: linear-gradient(145deg, #6366f1, #4f46e5);
                    color: white;
                    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
                }
                .pf-confirm-btn--ok:hover {
                    background: linear-gradient(145deg, #818cf8, #6366f1);
                    box-shadow: 0 6px 16px rgba(99, 102, 241, 0.5);
                    transform: translateY(-1px);
                }
                .pf-confirm-btn--destructive {
                    background: linear-gradient(145deg, #ef4444, #dc2626);
                    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
                }
                .pf-confirm-btn--destructive:hover {
                    background: linear-gradient(145deg, #f87171, #ef4444);
                    box-shadow: 0 6px 16px rgba(239, 68, 68, 0.5);
                }
            `,document.head.appendChild(l)}document.body.appendChild(c),c.addEventListener("click",l=>{l.target===c&&(c.remove(),o(!1))}),c.querySelector(".pf-confirm-btn--cancel").onclick=()=>{c.remove(),o(!1)},c.querySelector(".pf-confirm-btn--ok").onclick=()=>{c.remove(),o(!0)}})}var lv=he.CONFIG||"SS_PF_Config",ds=["SS_PF_Config"];var Zm="Normalize payroll exports, enforce controls, and prep journal entries without leaving Excel. Every run follows the same guidance so you stay audit-ready.",lr=un.map(({id:e,title:t})=>({id:e,title:t})),Ee={TYPE:0,FIELD:1,VALUE:2,PERMANENT:3,TITLE:-1},Qm="Run Settings";var d0="N";var eg="PR_JE_Debit_Total",tg="PR_JE_Credit_Total",rg="PR_JE_Difference",Or={0:{note:"PR_Notes_Config",reviewer:"PR_Reviewer_Config",signOff:"PR_SignOff_Config"},1:{note:"PR_Notes_Import",reviewer:"PR_Reviewer_Import",signOff:"PR_SignOff_Import"},2:{note:"PR_Notes_Headcount",reviewer:"PR_Reviewer_Headcount",signOff:"PR_SignOff_Headcount"},3:{note:"PR_Notes_Validate",reviewer:"PR_Reviewer_Validate",signOff:"PR_SignOff_Validate"},4:{note:"PR_Notes_Review",reviewer:"PR_Reviewer_Review",signOff:"PR_SignOff_Review"},5:{note:"PR_Notes_JE",reviewer:"PR_Reviewer_JE",signOff:"PR_SignOff_JE"},6:{note:"PR_Notes_Archive",reviewer:"PR_Reviewer_Archive",signOff:"PR_SignOff_Archive"}},At={0:"PR_Complete_Config",1:"PR_Complete_Import",2:"PR_Complete_Headcount",3:"PR_Complete_Validate",4:"PR_Complete_Review",5:"PR_Complete_JE",6:"PR_Complete_Archive"},ag={0:"PR_Homepage",1:he.DATA,2:he.DATA_CLEAN,3:he.DATA_CLEAN,4:he.EXPENSE_REVIEW,5:he.JE_DRAFT},ng={PR_Homepage:0,[he.DATA]:1,[he.DATA_CLEAN]:2,[he.EXPENSE_REVIEW]:4,[he.JE_DRAFT]:5,[he.ARCHIVE_SUMMARY]:6,SS_PF_Config:0,SS_Employee_Roster:2,PR_Expense_Mapping:4},Za="PR_Reviewer",S0="PR_Payroll_Provider",Zn="User opted to skip the headcount review this period.",gt={statusText:"",focusedIndex:0,activeView:"home",activeStepId:null,stepStatuses:lr.reduce((e,t)=>({...e,[t.id]:"pending"}),{})},Ye={loaded:!1,values:{},permanents:{},overrides:{accountingPeriod:!1,jeId:!1}},va=new Map,Qn=null,tn=["PR_Payroll_Date","Payroll Date (YYYY-MM-DD)","Payroll_Date","Payroll Date","Payroll_Date_(YYYY-MM-DD)"],Te={skipAnalysis:!1,roster:{rosterCount:null,payrollCount:null,difference:null,mismatches:[]},departments:{rosterCount:null,payrollCount:null,difference:null,mismatches:[]},loading:!1,hasAnalyzed:!1,lastError:null},Qa=null,Le={loading:!1,lastError:null,prDataTotal:null,cleanTotal:null,reconDifference:null,bankAmount:"",bankDifference:null,plugEnabled:!1},yr={loading:!1,lastError:null,periods:[],copilotResponse:"",completenessCheck:{currentPeriod:null,historicalPeriods:null}},Oe={debitTotal:null,creditTotal:null,difference:null,cleanTotal:null,loading:!1,lastError:null};async function ig(){if(console.log("Completeness Check - Starting..."),!lt()){console.log("Completeness Check - Excel runtime not available");return}try{await Excel.run(async e=>{var n,i,s,o;let t=e.workbook.worksheets.getItemOrNullObject(he.DATA_CLEAN),r=e.workbook.worksheets.getItemOrNullObject(he.ARCHIVE_SUMMARY);t.load("isNullObject"),r.load("isNullObject"),await e.sync();let a={currentPeriod:null,historicalPeriods:null};if(!t.isNullObject){let c=t.getUsedRangeOrNullObject();if(c.load("values"),await e.sync(),!c.isNullObject&&c.values&&c.values.length>1){let l=(c.values[0]||[]).map(d=>String(d||"").toLowerCase().trim()),f=l.findIndex(d=>d.includes("amount")),h=f>=0?f:l.findIndex(d=>d==="total"||d==="all-in"||d==="allin"||d==="all-in total"||d==="gross"||d==="total pay");if(console.log("Completeness Check - PR_Data_Clean headers:",l),console.log("Completeness Check - Amount column index:",f,"Total column index:",h),h>=0){let u=c.values.slice(1).reduce((x,S)=>x+(Number(S[h])||0),0),m=((s=(i=(n=yr.periods)==null?void 0:n[0])==null?void 0:i.summary)==null?void 0:s.total)||0;console.log("Completeness Check - PR_Data_Clean sum:",u,"Current period total:",m);let p=Math.abs(u-m)<1;a.currentPeriod={match:p,prDataClean:u,currentTotal:m}}else console.warn("Completeness Check - No amount/total column found in PR_Data_Clean")}}if(!r.isNullObject){let c=r.getUsedRangeOrNullObject();if(c.load("values"),await e.sync(),!c.isNullObject&&c.values&&c.values.length>1){let l=(c.values[0]||[]).map(u=>String(u||"").toLowerCase().trim()),f=l.findIndex(u=>u.includes("pay period")||u.includes("payroll date")||u==="date"||u==="period"||u.includes("period")),h=l.findIndex(u=>u.includes("amount")),d=h>=0?h:l.findIndex(u=>u==="total"||u==="all-in"||u==="allin"||u==="all-in total"||u==="total payroll"||u.includes("total"));if(console.log("Completeness Check - PR_Archive_Summary headers:",l),console.log("Completeness Check - Date column index:",f,"Total column index:",d),d>=0&&f>=0){let u=c.values.slice(1),m=(yr.periods||[]).slice(1,6);console.log("Completeness Check - Looking for periods:",m.map(b=>b.key||b.label));let p=new Map;for(let b of u){let O=b[f],A=m0(O);if(A){let I=Number(b[d])||0,V=p.get(A)||0;p.set(A,V+I)}}console.log("Completeness Check - Archive lookup keys:",Array.from(p.keys())),console.log("Completeness Check - Archive lookup values:",Array.from(p.entries()));let x=0,S=0,y=0,T=[];for(let b of m){let O=b.key||b.label||"",A=m0(O),I=((o=b.summary)==null?void 0:o.total)||0;S+=I;let V=p.get(A);V!==void 0?(x+=V,y++,T.push({period:O,calculated:I,archive:V,match:Math.abs(I-V)<1})):(console.warn(`Completeness Check - Period ${O} (normalized: ${A}) not found in archive`),T.push({period:O,calculated:I,archive:null,match:!1}))}console.log("Completeness Check - Period details:",T),console.log("Completeness Check - Matched",y,"of",m.length,"periods"),console.log("Completeness Check - Archive sum:",x,"Periods sum:",S);let D=y===m.length&&m.length>0,N=Math.abs(x-S)<1,K=D&&N;a.historicalPeriods={match:K,archiveSum:x,periodsSum:S,matchedCount:y,totalPeriods:m.length,details:T}}else console.warn("Completeness Check - Missing date or total column in PR_Archive_Summary"),console.warn("  Date column index:",f,"Total column index:",d)}}yr.completenessCheck=a,console.log("Completeness Check - Results:",JSON.stringify(a))}),console.log("Completeness Check - Complete!")}catch(e){console.error("Payroll completeness check failed:",e)}}function sg(){var p,x;let e=yr.completenessCheck||{},t=((p=yr.periods)==null?void 0:p.length)>0,r=S=>`$${Math.round(S||0).toLocaleString()}`,a=S=>{let y=Math.abs(S);return y<1?"\u2014":`${S>0?"+":"-"}$${Math.round(y).toLocaleString()}`},n=(S,y,T,D,N,K,b)=>{let O=(T||0)-(N||0),A,I;b?(A='<span class="pf-complete-status pf-complete-status--pending">\u23F3</span>',I="pending"):K?(A='<span class="pf-complete-status pf-complete-status--pass">\u2713</span>',I="pass"):(A='<span class="pf-complete-status pf-complete-status--fail">\u2717</span>',I="fail");let V=b?"":`
            <div class="pf-complete-diff ${I}">
                ${a(O)}
            </div>
        `;return`
            <div class="pf-complete-row ${I}">
                <div class="pf-complete-header">
                    ${A}
                    <span class="pf-complete-label">${de(S)}</span>
                </div>
                ${b?`
                <div class="pf-complete-values">
                    <span class="pf-complete-pending-text">Click Run/Refresh to check</span>
                </div>
                `:`
                <div class="pf-complete-values">
                    <div class="pf-complete-value-row">
                        <span class="pf-complete-source">${de(y)}:</span>
                        <span class="pf-complete-amount">${r(T)}</span>
                    </div>
                    <div class="pf-complete-value-row">
                        <span class="pf-complete-source">${de(D)}:</span>
                        <span class="pf-complete-amount">${r(N)}</span>
                    </div>
                </div>
                ${V}
                `}
            </div>
        `},i=e.currentPeriod,s=!t||i===null||i===void 0,o=n("Current Period","PR_Data_Clean Total",i==null?void 0:i.prDataClean,"Calculated Total",i==null?void 0:i.currentTotal,i==null?void 0:i.match,s),c=e.historicalPeriods,l=!t||c===null||c===void 0,f=(c==null?void 0:c.matchedCount)||0,h=(c==null?void 0:c.totalPeriods)||0,d=h>0?`Historical Periods (${f}/${h} matched)`:"Historical Periods",u=n(d,"PR_Archive_Summary (matched)",c==null?void 0:c.archiveSum,"Calculated Total",c==null?void 0:c.periodsSum,c==null?void 0:c.match,l),m="";return!l&&((x=c==null?void 0:c.details)==null?void 0:x.length)>0&&(m=`
            <div class="pf-complete-details-section">
                <div class="pf-complete-details-header">Period-by-Period Match</div>
                ${c.details.map(y=>{let T=y.archive===null?"\u26A0\uFE0F":y.match?"\u2713":"\u2717",D=y.archive!==null?r(y.archive):"Not found";return`
                <div class="pf-complete-detail-row">
                    <span class="pf-complete-detail-date">${de(y.period)}</span>
                    <span class="pf-complete-detail-icon">${T}</span>
                    <span class="pf-complete-detail-vals">${r(y.calculated)} vs ${D}</span>
                </div>
            `}).join("")}
            </div>
        `),`
        <article class="pf-step-card pf-step-detail pf-config-card" id="data-completeness-card">
            <div class="pf-config-head">
                <h3>Data Completeness Check</h3>
                <p class="pf-config-subtext">Verify source data matches calculated totals</p>
            </div>
            <div class="pf-complete-container">
                ${o}
                ${u}
                ${m}
            </div>
        </article>
    `}function og(e){switch(e){case 0:return{title:"Configuration",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Sets up the key parameters for your payroll review. Complete this before importing data.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Key Fields</h4>
                        <ul>
                            <li><strong>Payroll Date</strong> \u2014 The period-end date for this payroll run</li>
                            <li><strong>Accounting Period</strong> \u2014 Shows up in your JE description</li>
                            <li><strong>Journal Entry ID</strong> \u2014 Reference number for your accounting system</li>
                            <li><strong>Provider Link</strong> \u2014 Quick access to your payroll provider portal</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Tip</h4>
                        <p>The accounting period and JE ID auto-generate based on your payroll date, but you can override them if needed.</p>
                    </div>
                `};case 1:return{title:"Import Payroll Data",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Gets your payroll data into the workbook. Pull a report from your payroll provider and paste it into PR_Data.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Required Columns</h4>
                        <p>Your payroll export should include:</p>
                        <ul>
                            <li><strong>Employee Name</strong> \u2014 Full name (used to match against roster)</li>
                            <li><strong>Department</strong> \u2014 Cost center assignment</li>
                            <li><strong>Regular Earnings</strong> \u2014 Base pay for the period</li>
                            <li><strong>Overtime</strong> \u2014 OT pay (if applicable)</li>
                            <li><strong>Bonus/Commission</strong> \u2014 Variable compensation</li>
                            <li><strong>Benefits/Deductions</strong> \u2014 Employer portions</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Tip</h4>
                        <p>Column headers don't need to match exactly\u2014the system is flexible with naming. Just make sure each field is present.</p>
                    </div>
                `};case 2:return{title:"Headcount Review",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Compares employee counts and department assignments between your roster and payroll data to catch discrepancies early.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CA} Data Sources</h4>
                        <ul>
                            <li><strong>SS_Employee_Roster</strong> \u2014 Your centralized employee list (Column A: Employee names)</li>
                            <li><strong>PR_Data</strong> \u2014 The payroll data you just imported (Employee column)</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F50D} Employee Alignment Check</h4>
                        <p>The script compares names between SS_Employee_Roster and PR_Data to find:</p>
                        <ul>
                            <li><strong>In Roster, Missing from Payroll</strong> \u2014 Employees on roster but not in payroll (possible missed payment)</li>
                            <li><strong>In Payroll, Missing from Roster</strong> \u2014 Employees paid but not on roster (possible ghost employee or new hire)</li>
                        </ul>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.7); margin-top: 8px;">Names are matched using fuzzy logic to handle minor variations.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F3E2} Department Alignment Check</h4>
                        <p>For employees appearing in both sources, the script compares the "Department" column:</p>
                        <ul>
                            <li>Flags employees where roster department \u2260 payroll department</li>
                            <li>Mismatches affect GL coding and cost center reporting</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Tip</h4>
                        <p>If discrepancies are expected (e.g., contractors, temp workers), you can skip this check and add a note explaining why. The note is required if you skip.</p>
                    </div>
                `};case 3:return{title:"Payroll Validation",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Validates that your payroll totals match what was actually paid from the bank.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CA} Reconciliation Check</h4>
                        <ul>
                            <li><strong>PR_Data Total</strong> \u2014 Sum of all payroll from your import</li>
                            <li><strong>Clean Total</strong> \u2014 Processed total after expense mapping</li>
                            <li><strong>Bank Amount</strong> \u2014 What actually left the bank account</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u26A0\uFE0F Common Differences</h4>
                        <ul>
                            <li><strong>Timing</strong> \u2014 Direct deposits vs check clearing dates</li>
                            <li><strong>Tax payments</strong> \u2014 May be separate from net pay</li>
                            <li><strong>Benefits</strong> \u2014 Some deductions paid to vendors</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Tip</h4>
                        <p>Small differences ($0.01-$1.00) are usually rounding. Use the plug feature to resolve them.</p>
                    </div>
                `};case 4:return{title:"Expense Review",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Generates an executive-ready payroll expense summary for CFO review, with period comparisons and trend analysis.</p>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>\u{1F4C2} Data Sources</h4>
                        <ul>
                            <li><strong>PR_Data_Clean</strong> \u2014 Current period payroll data (cleaned and categorized)</li>
                            <li><strong>SS_Employee_Roster</strong> \u2014 Department assignments and employee details</li>
                            <li><strong>PR_Archive_Summary</strong> \u2014 Historical payroll data for trend analysis</li>
                        </ul>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>\u{1F4B0} How Amounts Are Calculated</h4>
                        <table style="width:100%; font-size: 11px; margin-top: 8px; border-collapse: collapse;">
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>Fixed Salary</strong></td>
                                <td style="padding: 6px 0;">Regular wages, salaries, and base pay</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>Variable Salary</strong></td>
                                <td style="padding: 6px 0;">Commissions, bonuses, overtime, and incentive pay</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>Gross Pay</strong></td>
                                <td style="padding: 6px 0;">Fixed + Variable Salary</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>Burden</strong></td>
                                <td style="padding: 6px 0;">Employer taxes (FICA, Medicare, FUTA, SUTA), health insurance, 401(k) match, and other employer-paid benefits</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>All-In Total</strong></td>
                                <td style="padding: 6px 0;">Gross Pay + Burden = Total cost to employer</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px 0;"><strong>Burden Rate</strong></td>
                                <td style="padding: 6px 0;">Burden \xF7 All-In Total (typically 10-18%)</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>\u{1F4CA} Report Sections</h4>
                        <ul>
                            <li><strong>Executive Summary</strong> \u2014 Current vs prior period comparison (frozen at top)</li>
                            <li><strong>Department Breakdown</strong> \u2014 Cost allocation by cost center</li>
                            <li><strong>Historical Context</strong> \u2014 Where current metrics fall within historical ranges</li>
                            <li><strong>Period Trends</strong> \u2014 6-period trend chart for Total, Fixed, Variable, Burden, and Headcount</li>
                        </ul>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>\u{1F4C8} Historical Context Visualization</h4>
                        <p>The spectrum bars show where your current period falls relative to your historical min/max:</p>
                        <p style="font-family: Consolas, monospace; color: #6366f1; margin: 8px 0;">\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u25CF\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591</p>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.7);">The dot (\u25CF) indicates current position. Left = Low, Right = High.</p>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Review Tips</h4>
                        <ul>
                            <li>Compare <strong>Burden Rate</strong> \u2014 Should be consistent period-to-period (10-18% typical)</li>
                            <li>Watch <strong>Variable Salary</strong> spikes \u2014 May indicate commission/bonus timing</li>
                            <li>Verify <strong>Headcount changes</strong> \u2014 Should align with HR records</li>
                            <li>Flag variances <strong>> 10%</strong> from prior period for follow-up</li>
                        </ul>
                    </div>
                `};case 5:return{title:"Journal Entry",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Generates a balanced journal entry from your payroll data, ready for upload to your accounting system.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4DD} How the JE Works</h4>
                        <p>Maps payroll categories to GL accounts:</p>
                        <ul>
                            <li><strong>Expenses</strong> \u2192 Debits to departmental expense accounts</li>
                            <li><strong>Liabilities</strong> \u2192 Credits to payable accounts</li>
                            <li><strong>Cash</strong> \u2192 Credit to bank account</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u2705 Validation Checks</h4>
                        <ul>
                            <li><strong>Debits = Credits</strong> \u2014 Entry must balance</li>
                            <li><strong>All accounts mapped</strong> \u2014 No unassigned categories</li>
                            <li><strong>Totals match</strong> \u2014 JE ties to PR_Data</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Tip</h4>
                        <p>Review the draft in PR_JE_Draft before exporting to catch any mapping errors.</p>
                    </div>
                `};case 6:return{title:"Archive & Clear",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Creates a backup of your completed payroll run, then resets the workbook so you're ready for the next pay period.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4C1} Step 1: Create Backup</h4>
                        <p>A new workbook opens containing all your payroll tabs. You'll choose where to save it on your computer or shared drive.</p>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 6px;"><em>Tip: Use a consistent naming convention like "Payroll_Archive_2024-01-15"</em></p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CA} Step 2: Update History</h4>
                        <p>The current period's totals are saved to PR_Archive_Summary. This powers the trend charts and completeness checks for future periods.</p>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 6px;"><em>Keeps 5 periods of history \u2014 oldest is removed automatically</em></p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F9F9} Step 3: Clear Working Data</h4>
                        <p>Data is cleared from the working sheets:</p>
                        <ul>
                            <li>PR_Data (raw import)</li>
                            <li>PR_Data_Clean (processed data)</li>
                            <li>PR_Expense_Review (summary & charts)</li>
                            <li>PR_JE_Draft (journal entry lines)</li>
                        </ul>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 6px;"><em>Headers are preserved \u2014 only data rows are cleared</em></p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F504} Step 4: Reset for Next Period</h4>
                        <ul>
                            <li>Payroll Date, Accounting Period, JE ID cleared</li>
                            <li>All sign-offs and completion flags reset</li>
                            <li>Notes cleared (unless you locked them with \u{1F512})</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u26A0\uFE0F Before You Archive</h4>
                        <ul>
                            <li>\u2713 JE uploaded to your accounting system</li>
                            <li>\u2713 All review steps signed off</li>
                            <li>\u2713 Lock any notes you want to keep</li>
                        </ul>
                    </div>
                `};default:return{title:"Payroll Recorder",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F44B} Welcome to Payroll Recorder</h4>
                        <p>This module helps you normalize payroll exports, enforce controls, and prep journal entries.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Workflow Overview</h4>
                        <ol style="margin: 8px 0; padding-left: 20px;">
                            <li>Configure period settings</li>
                            <li>Import payroll data</li>
                            <li>Review headcount alignment</li>
                            <li>Validate against bank</li>
                            <li>Review expense summary</li>
                            <li>Generate journal entry</li>
                            <li>Archive and reset</li>
                        </ol>
                    </div>
                    <div class="pf-info-section">
                        <p>Click a step card to get started, or tap the <strong>\u24D8</strong> button on any step for detailed guidance.</p>
                    </div>
                `}}}ks(()=>cg());async function cg(){try{await ug(),await C0();let e=vi(ni);await xi(e.sheetName,e.title,e.subtitle),await lg(),Nt()}catch(e){throw console.error("[Payroll] Module initialization failed:",e),e}}async function lg(){if(lt())try{await Excel.run(async e=>{e.workbook.worksheets.onActivated.add(fg),await e.sync(),console.log("[Payroll] Worksheet change listener registered")})}catch(e){console.warn("[Payroll] Could not set up worksheet listener:",e)}}async function fg(e){try{await Excel.run(async t=>{let r=t.workbook.worksheets.getItem(e.worksheetId);r.load("name"),await t.sync();let a=r.name,n=ng[a];if(console.log(`[Payroll] Tab changed to: ${a} \u2192 Step ${n}`),n!==void 0&&n!==gt.activeStepId){let i=lr.findIndex(s=>s.id===n);i>=0&&(Qa=i,ws({focusedIndex:i,activeView:n===0?"config":"step",activeStepId:n}),n===2&&!Te.hasAnalyzed&&oi().then(()=>si()))}})}catch(t){console.warn("[Payroll] Error handling worksheet change:",t)}}async function ug(){try{await pi(ni),console.log(`[Payroll] Tab visibility applied for ${ni}`)}catch(e){console.warn("[Payroll] Could not apply tab visibility:",e)}}function Nt(){var c;let e=document.body;if(!e)return;let t=gt.focusedIndex<=0?"disabled":"",r=gt.focusedIndex>=lr.length-1?"disabled":"",a=gt.activeView==="config",n=gt.activeView==="step",i=!a&&!n,s=a?pg():n?_g(gt.activeStepId):hg();e.innerHTML=`
        <div class="pf-root">
            ${dg(t,r)}
            ${s}
            ${kg()}
        </div>
    `;let o=document.getElementById("pf-info-fab-payroll");if(i)o&&o.remove();else if((c=window.PrairieForge)!=null&&c.mountInfoFab){let l=og(gt.activeStepId);PrairieForge.mountInfoFab({title:l.title,content:l.content,buttonId:"pf-info-fab-payroll"})}if(bg(),a)Rg();else if(n)try{Dg(gt.activeStepId)}catch(l){console.warn("Payroll Recorder: failed to bind step interactions",l)}else Fg();Ig(),i?Ds():wi()}function dg(e,t){let r=xe("SS_Company_Name")||"your company";return`
        <div class="pf-brand-float" aria-hidden="true">
            <span class="pf-brand-wave"></span>
        </div>
        <header class="pf-banner">
            <div class="pf-nav-bar">
                <button id="nav-prev" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Previous step" ${e}>
                    ${n0}
                    <span class="sr-only">Previous step</span>
                </button>
                <button id="nav-home" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Home">
                    ${qc}
                    <span class="sr-only">Module Home</span>
                </button>
                <button id="nav-selector" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Selector">
                    ${Zc}
                    <span class="sr-only">Module Selector</span>
                </button>
                <button id="nav-next" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Next step" ${t}>
                    ${s0}
                    <span class="sr-only">Next step</span>
                </button>
                <span class="pf-nav-divider"></span>
                <div class="pf-quick-access-wrapper">
                    <button id="nav-quick-toggle" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Quick Access">
                        ${Qc}
                        <span class="sr-only">Quick Access Menu</span>
                    </button>
                    <div id="quick-access-dropdown" class="pf-quick-dropdown hidden">
                        <div class="pf-quick-dropdown-header">Quick Access</div>
                        <button id="nav-config" class="pf-quick-item pf-clickable" type="button">
                            ${Xn}
                            <span>Configuration</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>
    `}function hg(){return`
        <section class="pf-hero" id="pf-hero">
            <h2 class="pf-hero-title">Payroll Recorder</h2>
            <p class="pf-hero-copy">${Zm}</p>
            <p class="pf-hero-hint">${de(gt.statusText||"")}</p>
        </section>
        <section class="pf-step-guide">
            <div class="pf-step-grid">
                ${lr.map((e,t)=>Eg(e,t)).join("")}
            </div>
        </section>
    `}function pg(){if(!Ye.loaded)return`
            <section class="pf-step-guide">
                <article class="pf-step-card pf-step-detail">
                    <p class="pf-step-title">Loading configuration\u2026</p>
                </article>
            </section>
        `;let e=Or[0],t=ar(ci()),r=ar(xe("PR_Accounting_Period")),a=xe("PR_Journal_Entry_ID"),n=xe("SS_Accounting_Software"),i=ys(),s=xe("SS_Company_Name"),o=xe(Za)||Pr(),c=e?xe(e.note):"",l=e?Er(e.note):!1,f=(e?xe(e.reviewer):"")||Pr(),h=e?ar(xe(e.signOff)):"",d=!!(h||xe(At[0]));return`
        <section class="pf-hero" id="pf-config-hero">
            <p class="pf-hero-copy">${de(Lr)} | Step 0</p>
            <h2 class="pf-hero-title">Configuration Setup</h2>
            <p class="pf-hero-copy">Make quick adjustments before every payroll run.</p>
            <p class="pf-hero-hint">${de(gt.statusText||"")}</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Period Data</h3>
                    <p class="pf-config-subtext">Fields in this section may change each period.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Your Name (Used for sign-offs)</span>
                        <input type="text" id="config-user-name" value="${de(o)}" placeholder="Full name">
                    </label>
                    <label class="pf-config-field">
                        <span>Payroll Date</span>
                        <input type="date" id="config-payroll-date" value="${de(t)}">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Period</span>
                        <input type="text" id="config-accounting-period" value="${de(r)}" placeholder="Nov 2025">
                    </label>
                    <label class="pf-config-field">
                        <span>Journal Entry ID</span>
                        <input type="text" id="config-je-id" value="${de(a)}" placeholder="PR-AUTO-YYYY-MM-DD">
                    </label>
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Static Data</h3>
                    <p class="pf-config-subtext">Fields rarely change but should be reviewed.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Company Name</span>
                        <input type="text" id="config-company-name" value="${de(s)}" placeholder="Prairie Forge LLC">
                    </label>
                    <label class="pf-config-field">
                        <span>Payroll Provider / Report Location</span>
                        <input type="url" id="config-payroll-provider" value="${de(i)}" placeholder="https://\u2026">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Software / Import Location</span>
                        <input type="url" id="config-accounting-link" value="${de(n)}" placeholder="https://\u2026">
                    </label>
                </div>
            </article>
            ${e?Ir({textareaId:"config-notes",value:c,permanentId:"config-notes-permanent",isPermanent:l,hintId:"",saveButtonId:"config-notes-save"}):""}
            ${e?Nr({reviewerInputId:"config-reviewer-name",reviewerValue:f,signoffInputId:"config-signoff-date",signoffValue:h,isComplete:d,saveButtonId:"config-signoff-save",completeButtonId:"config-signoff-toggle"}):""}
        </section>
    `}function mg(e){let t=kr(1),r=t?Er(t.note):!1,a=t?xe(t.note):"",n=(t?xe(t.reviewer):"")||Pr(),i=t?ar(xe(t.signOff)):"",s=!!(i||xe(At[1])),o=ys();return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${de(Lr)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${de(e.title)}</h2>
            <p class="pf-hero-copy">Pull your payroll export from the provider and paste it into PR_Data.</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Payroll Report</h3>
                    <p class="pf-config-subtext">Open your payroll provider, download the report, and paste into PR_Data.</p>
                </div>
                <div class="pf-signoff-action">
                    ${Vt(o?`<a href="${de(o)}" target="_blank" rel="noopener noreferrer" class="pf-action-toggle pf-clickable" title="Open payroll provider">${Jn}</a>`:`<button type="button" class="pf-action-toggle pf-clickable" id="import-provider-btn" disabled title="Add provider link in Configuration">${Jn}</button>`,"Provider")}
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="import-open-data-btn" title="Open PR_Data sheet">${Xn}</button>`,"PR_Data")}
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="import-clear-btn" title="Clear PR_Data to start over">${o0}</button>`,"Clear")}
                </div>
            </article>
            ${t?`
                ${Ir({textareaId:"step-notes-1",value:a||"",permanentId:"step-notes-lock-1",isPermanent:r,saveButtonId:"step-notes-save-1"})}
                ${Nr({reviewerInputId:"step-reviewer-1",reviewerValue:n,signoffInputId:"step-signoff-1",signoffValue:i,isComplete:s,saveButtonId:"step-signoff-save-1",completeButtonId:"step-signoff-toggle-1"})}
            `:""}
        </section>
    `}function gg(e){var j,se,pe,ee,ye,Se,Xe,Ce,be,Fe,C,U,R;let t=kr(2),r=t?xe(t.note):"",a=t?Er(t.note):!1,n=(t?xe(t.reviewer):"")||Pr(),i=t?ar(xe(t.signOff)):"",s=!!(i||xe(At[2])),o=Gg(),c=Te.roster||{},l=Te.departments||{},f=Te.hasAnalyzed,h="";Te.loading?h='<p class="pf-step-note">Analyzing roster and payroll data\u2026</p>':Te.lastError&&(h=`<p class="pf-step-note">${de(Te.lastError)}</p>`);let d=(F,Y,le)=>{let me=!f,oe;me?oe='<span class="pf-je-check-circle pf-je-circle--pending"></span>':le?oe=`<span class="pf-je-check-circle pf-je-circle--pass">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </span>`:oe=`<span class="pf-je-check-circle pf-je-circle--fail">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </span>`;let Z=f?` = ${Y}`:"";return`
            <div class="pf-je-check-row">
                ${oe}
                <span class="pf-je-check-desc-pill">${de(F)}${Z}</span>
            </div>
        `},u=(j=c.difference)!=null?j:0,m=(se=l.difference)!=null?se:0,p=Array.isArray(c.mismatches)?c.mismatches.filter(Boolean):[],x=Array.isArray(l.mismatches)?l.mismatches.filter(Boolean):[],S=`
        ${d("SS_Employee_Roster count",(pe=c.rosterCount)!=null?pe:"\u2014",!0)}
        ${d("PR_Data employee count",(ee=c.payrollCount)!=null?ee:"\u2014",!0)}
        ${d("Difference",u,u===0)}
    `,y=(ye=l.rosterCount)!=null?ye:0,T=(Se=c.rosterCount)!=null?Se:0,D=(Xe=c.payrollCount)!=null?Xe:0,N=f&&y>0&&y<Math.max(T,D)?`<p class="pf-step-note pf-step-note--info">\u2139\uFE0F Only ${y} employees appear in both lists, so only those can be compared for department alignment.</p>`:"",K=`
        ${d("Expected departments",(Ce=l.rosterCount)!=null?Ce:"\u2014",!0)}
        ${d("PR_Data departments",(be=l.payrollCount)!=null?be:"\u2014",!0)}
        ${d("Difference",m,m===0)}
    `,b=p.filter(F=>F.type==="missing_from_payroll").length,O=p.filter(F=>F.type==="missing_from_roster").length,A=p.length>0?`Employee Mismatches (${b} missing from payroll, ${O} not in roster)`:"Employee Mismatches",I=p.length&&!Te.skipAnalysis&&f&&((C=(Fe=window.PrairieForge)==null?void 0:Fe.renderMismatchTiles)==null?void 0:C.call(Fe,{mismatches:p,label:A,sourceLabel:"Roster",targetLabel:"Payroll Data",escapeHtml:de}))||"",V=x.length&&!Te.skipAnalysis&&f&&((R=(U=window.PrairieForge)==null?void 0:U.renderMismatchTiles)==null?void 0:R.call(U,{mismatches:x,label:"Employees with Department Differences",formatter:F=>({name:F.employee||F.name||"",source:`${F.rosterDept||"\u2014"} \u2192 ${F.payrollDept||"\u2014"}`,isMissingFromTarget:!0}),escapeHtml:de}))||"";return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${de(Lr)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">Headcount Review</h2>
            <p class="pf-hero-copy">Quick check to make sure your roster matches your payroll data.</p>
            <div class="pf-skip-action">
                <button type="button" class="pf-skip-btn ${Te.skipAnalysis?"is-active":""}" id="headcount-skip-btn">
                    ${a0}
                    <span>Skip Analysis</span>
                </button>
            </div>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Run Headcount Check</h3>
                    <p class="pf-config-subtext">Compare employee roster against payroll data.</p>
                </div>
                <div class="pf-signoff-action">
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="roster-run-btn" title="Run headcount analysis">${Kn}</button>`,"Run")}
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="roster-refresh-btn" title="Refresh analysis">${Ka}</button>`,"Refresh")}
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Employee Alignment</h3>
                    <p class="pf-config-subtext">Verify employees match between roster and payroll.</p>
                </div>
                ${h}
                <div class="pf-je-checks-container">
                    ${S}
                </div>
                ${I}
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Department Alignment</h3>
                    <p class="pf-config-subtext">Verify department assignments are consistent.</p>
                </div>
                ${N}
                <div class="pf-je-checks-container">
                    ${K}
                </div>
                ${V}
            </article>
            ${t?`
                ${Ir({textareaId:"step-notes-input",value:r,permanentId:"step-notes-permanent",isPermanent:a,hintId:o?"headcount-notes-hint":"",saveButtonId:"step-notes-save-2"})}
                ${Nr({reviewerInputId:"step-reviewer-name",reviewerValue:n,signoffInputId:"step-signoff-date",signoffValue:i,isComplete:s,saveButtonId:"headcount-signoff-save",completeButtonId:"headcount-signoff-toggle"})}
            `:""}
        </section>
    `}function xg(e){var N;let t=kr(3),r=t?xe(t.note):"",a=(t?xe(t.reviewer):"")||Pr(),n=t?ar(xe(t.signOff)):"",i=Le.loading?'<p class="pf-step-note">Preparing reconciliation data\u2026</p>':Le.lastError?`<p class="pf-step-note">${de(Le.lastError)}</p>`:"",s=!!(n||xe(At[3])),o=Le.prDataTotal!==null,c=Le.prDataTotal,l=Le.cleanTotal,f=(N=Le.reconDifference)!=null?N:c!=null&&l!=null?c-l:null,h=f!==null&&Math.abs(f)<.01,d=Tt(Le.cleanTotal),u=Le.bankDifference!=null?Tt(Le.bankDifference):"---",m=Le.bankDifference==null?"":Math.abs(Le.bankDifference)<.5?"Difference within acceptable tolerance.":"Difference exceeds tolerance and should be resolved.",p=I0(Le.bankAmount),x=(K,b,O)=>{let A=!o,I;return A?I='<span class="pf-je-check-circle pf-je-circle--pending"></span>':O?I=`<span class="pf-je-check-circle pf-je-circle--pass">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </span>`:I=`<span class="pf-je-check-circle pf-je-circle--fail">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </span>`,`
            <div class="pf-je-check-row">
                ${I}
                <span class="pf-je-check-desc-pill">${de(b)}</span>
            </div>
        `},S=o?Tt(c):"\u2014",y=o?Tt(l):"\u2014",T=o?Tt(f):"\u2014",D=`
        ${x("PR_Data Total",`PR_Data Total = ${S}`,!0)}
        ${x("PR_Data_Clean Total",`PR_Data_Clean Total = ${y}`,!0)}
        ${x("Difference",`Difference = ${T} (should be $0.00)`,h)}
    `;return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${de(Lr)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${de(e.title)}</h2>
            <p class="pf-hero-copy">Normalize your payroll data and verify totals match.</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Run Validation</h3>
                    <p class="pf-config-subtext">Build PR_Data_Clean from your imported data and verify totals.</p>
                </div>
                <div class="pf-signoff-action">
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="validation-run-btn" title="Run reconciliation">${Kn}</button>`,"Run")}
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="validation-refresh-btn" title="Refresh reconciliation">${Ka}</button>`,"Refresh")}
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Data Reconciliation</h3>
                    <p class="pf-config-subtext">Verify PR_Data and PR_Data_Clean totals match.</p>
                </div>
                ${i}
                <div class="pf-je-checks-container">
                    ${D}
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Bank Reconciliation</h3>
                    <p class="pf-config-subtext">Compare payroll total to the amount pulled from the bank.</p>
                </div>
                <div class="pf-config-grid pf-metric-grid">
                    <label class="pf-config-field">
                        <span>Cost per PR_Data_Clean</span>
                        <input id="bank-clean-total-value" type="text" class="pf-readonly-input pf-metric-value" value="${d}" readonly>
                    </label>
                    <label class="pf-config-field">
                        <span>Cost per Bank</span>
                        <input
                            type="text"
                            inputmode="decimal"
                            id="bank-amount-input"
                            class="pf-metric-input"
                            value="${de(p)}"
                            placeholder="0.00"
                            aria-label="Enter bank amount"
                        >
                    </label>
                    <label class="pf-config-field">
                        <span>Difference</span>
                        <input id="bank-diff-value" type="text" class="pf-readonly-input pf-metric-value" value="${u}" readonly>
                    </label>
                </div>
                <p class="pf-metric-hint" id="bank-diff-hint">${de(m)}</p>
            </article>
            ${t?`
                ${Ir({textareaId:"step-notes-input",value:r,permanentId:"step-notes-permanent",isPermanent:Er(t.note),saveButtonId:"step-notes-save-3"})}
            `:""}
            ${Nr({reviewerInputId:"step-reviewer-name",reviewerValue:a,signoffInputId:"step-signoff-3",signoffValue:n,isComplete:s,saveButtonId:"step-signoff-save-3",completeButtonId:"validation-signoff-toggle"})}
        </section>
    `}function vg(e){let t=kr(4),r=t?xe(t.note):"",a=(t?xe(t.reviewer):"")||Pr(),n=t?ar(xe(t.signOff)):"",i=!!(n||xe(At[4])),s=yr.loading?'<p class="pf-step-note">Preparing executive summary\u2026</p>':yr.lastError?`<p class="pf-step-note">${de(yr.lastError)}</p>`:"",o=Ts({id:"expense-review-copilot",body:"Want help analyzing your data? Just ask!",placeholder:"Where should I focus this pay period?",buttonLabel:"Ask CoPilot"});return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${de(Lr)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${de(e.title)}</h2>
            <p class="pf-hero-copy">${de(e.summary||"")}</p>
            <p class="pf-hero-hint"></p>
        </section>
        <section class="pf-step-guide">
            ${s}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Perform Analysis</h3>
                    <p class="pf-config-subtext">Populate Expense Review and perform review.</p>
                </div>
                <div class="pf-signoff-action">
                    ${Vt(`<button type="button" class="pf-action-toggle" id="expense-run-btn" title="Run expense review analysis">${Kn}</button>`,"Run")}
                    ${Vt(`<button type="button" class="pf-action-toggle" id="expense-refresh-btn" title="Refresh expense data">${Ka}</button>`,"Refresh")}
                </div>
            </article>
            ${sg()}
                ${o}
            ${t?`
            ${Ir({textareaId:"step-notes-input",value:r,permanentId:"step-notes-permanent",isPermanent:Er(t.note),saveButtonId:"step-notes-save-4"})}
            ${Nr({reviewerInputId:"step-reviewer-name",reviewerValue:a,signoffInputId:"step-signoff-4",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-4",completeButtonId:"expense-signoff-toggle"})}
            `:""}
        </section>
    `}function wg(e){var O,A,I;let t=kr(5),r=t?xe(t.note):"",a=t?Er(t.note):!1,n=(t?xe(t.reviewer):"")||Pr(),i=t?ar(xe(t.signOff)):"",s=!!(i||xe(At[5])),o=Oe.lastError?`<p class="pf-step-note">${de(Oe.lastError)}</p>`:"",c=Oe.debitTotal!==null,l=(O=Oe.debitTotal)!=null?O:0,f=(A=Oe.creditTotal)!=null?A:0,h=l-f,d=(I=Oe.cleanTotal)!=null?I:0,u=Oe.cleanTotal!==null,m=c,p=c&&u&&Math.abs(h-d)<.01,x=(V,j)=>{let se=!c,pe;return se?pe='<span class="pf-je-check-circle pf-je-circle--pending"></span>':j?pe=`<span class="pf-je-check-circle pf-je-circle--pass">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </span>`:pe=`<span class="pf-je-check-circle pf-je-circle--fail">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </span>`,`
            <div class="pf-je-check-row">
                ${pe}
                <span class="pf-je-check-desc-pill">${de(V)}</span>
            </div>
        `},S=c?Tt(l):"\u2014",y=c?Tt(f):"\u2014",T=c?Tt(h):"\u2014",D=u?Tt(d):"\u2014",N=u?Math.abs(h-d):0,K=N>=.01?` (diff: ${Tt(N)})`:"",b=`
        ${x(`Total Debits = ${S}`,m)}
        ${x(`Total Credits = ${y}`,m)}
        ${x(`Line Amount (Debit - Credit) = ${T}`,m)}
        ${x(`JE Total matches PR_Data_Clean (${D})${K}`,p)}
    `;return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${de(Lr)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${de(e.title)}</h2>
            <p class="pf-hero-copy">Generate the upload file to break down the bank feed line item.</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Generate Upload File</h3>
                    <p class="pf-config-subtext">Build the breakdown from PR_Data_Clean for your accounting system.</p>
                </div>
                <div class="pf-signoff-action">
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="je-create-btn" title="Generate from PR_Data_Clean">${Xn}</button>`,"Generate")}
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="je-run-btn" title="Refresh validation">${Ka}</button>`,"Refresh")}
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="je-export-btn" title="Export as CSV">${t0}</button>`,"Export")}
                    ${Vt(`<button type="button" class="pf-action-toggle pf-clickable" id="je-upload-btn" title="Open accounting software">${r0}</button>`,"Upload")}
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Validation Checks</h3>
                    <p class="pf-config-subtext">Verify totals before uploading to your accounting system.</p>
                </div>
                ${o}
                <div class="pf-je-checks-container">
                    ${b}
                </div>
            </article>
            ${t?`
                ${Ir({textareaId:"step-notes-input",value:r||"",permanentId:"step-notes-permanent",isPermanent:a,saveButtonId:"step-notes-save-5"})}
                ${Nr({reviewerInputId:"step-reviewer-name",reviewerValue:n,signoffInputId:"step-signoff-5",signoffValue:i,isComplete:s,saveButtonId:"step-signoff-save-5",completeButtonId:"step-signoff-toggle-5"})}
            `:""}
        </section>
    `}function yg(e){let t=lr.filter(i=>i.id!==6).map(i=>({id:i.id,title:i.title,complete:Mg(i.id)})),r=t.every(i=>i.complete),a=t.filter(i=>!i.complete).length,n=t.map(i=>`
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head pf-notes-header">
                    <span class="pf-action-toggle ${i.complete?"is-active":""}" aria-pressed="${i.complete}">
                        ${Yn}
                    </span>
                    <div>
                        <h3>${de(i.title)}</h3>
                        <p class="pf-config-subtext">${i.complete?"Complete":"Not complete"}</p>
                    </div>
                </div>
            </article>
        `).join("");return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${de(Lr)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${de(e.title)}</h2>
            <p class="pf-hero-copy">${de(e.summary||"")}</p>
            <p class="pf-hero-hint"></p>
        </section>
        <section class="pf-step-guide">
            ${n}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Archive & Reset</h3>
                    <p class="pf-config-subtext">Create an archive of this module's sheets and clear work tabs.</p>
                </div>
                ${r?"":`<p class="pf-step-note pf-step-note--info">\u26A0\uFE0F Complete all ${a} remaining step(s) before archiving.</p>`}
                <div class="pf-pill-row pf-config-actions">
                    <button type="button" class="pf-pill-btn" id="archive-run-btn" ${r?"":"disabled"} onclick="window.handleArchiveClick()">Archive</button>
                </div>
            </article>
        </section>
    `}function _g(e){let t=un.find(D=>D.id===e)||{id:e!=null?e:"-",title:"Workflow Step",summary:"",description:"",checklist:[]};if(e===1)return mg(t);if(e===2)return gg(t);if(e===3)return xg(t);if(e===4)return vg(t);if(e===5)return wg(t);if(e===6)return yg(t);let r=!1,a=kr(e),n=a?xe(a.note):"",i=a?Er(a.note):!1,s=(a?xe(a.reviewer):"")||Pr(),o=a?ar(xe(a.signOff)):"",c=a&&At[e]?!!(o||xe(At[e])):!!o,l=(t.highlights||[]).map(D=>`
            <div class="pf-step-highlight">
                <span class="pf-step-highlight-label">${de(D.label)}</span>
                <span class="pf-step-highlight-detail">${de(D.detail)}</span>
            </div>
        `).join(""),f=(t.checklist||[]).map(D=>`<li>${de(D)}</li>`).join("")||"",h=r?"":t.description||"Detailed guidance will appear here.",d=[];!r&&t.ctaLabel&&d.push(`<button type="button" class="pf-pill-btn" id="step-action-btn">${de(t.ctaLabel)}</button>`),r||d.push('<button type="button" class="pf-pill-btn pf-pill-btn--ghost" id="step-back-btn">Back to Step List</button>');let u=d.length?`<div class="pf-pill-row pf-config-actions">${d.join("")}</div>`:"",m=ys(),p=r?`
            <div class="pf-link-card">
                <h3 class="pf-link-card__title">Payroll Reports</h3>
                <p class="pf-link-card__subtitle">Open your latest payroll export.</p>
                <div class="pf-link-list">
                    <a
                        class="pf-link-item"
                        id="pr-provider-link"
                        ${m?`href="${de(m)}" target="_blank" rel="noopener noreferrer"`:'aria-disabled="true"'}
                    >
                        <span class="pf-link-item__icon">${Jn}</span>
                        <span class="pf-link-item__body">
                            <span class="pf-link-item__title">Open Payroll Export</span>
                            <span class="pf-link-item__meta">${de(m||"Add a provider link in Configuration")}</span>
                        </span>
                    </a>
                </div>
            </div>
        `:"",x="",S=!r&&l?`<article class="pf-step-card pf-step-detail">${l}</article>`:"",y=!r&&f?`<article class="pf-step-card pf-step-detail">
                            <h3 class="pf-step-subtitle">Checklist</h3>
                            <ul class="pf-step-checklist">${f}</ul>
                        </article>`:"",T=!r||h||u?`
            <article class="pf-step-card pf-step-detail">
                <p class="pf-step-title">${de(h)}</p>
                ${!r&&t.statusHint?`<p class="pf-step-note">${de(t.statusHint)}</p>`:""}
                ${u}
            </article>
        `:"";return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${de(Lr)} | Step ${t.id}</p>
            <h2 class="pf-hero-title">${de(t.title)}</h2>
            <p class="pf-hero-copy">${de(t.summary||"")}</p>
            <p class="pf-hero-hint">${de(gt.statusText||"")}</p>
        </section>
        <section class="pf-step-guide">
            ${p}
            ${x}
            ${T}
            ${S}
            ${y}
            ${a?`
                ${Ir({textareaId:"step-notes-input",value:n,permanentId:"step-notes-permanent",isPermanent:i,saveButtonId:"step-notes-save"})}
                ${Nr({reviewerInputId:"step-reviewer-name",reviewerValue:s,signoffInputId:`step-signoff-${e}`,signoffValue:o,isComplete:c,saveButtonId:`step-signoff-save-${e}`,completeButtonId:`step-signoff-toggle-${e}`,subtext:"Ready to move on? Save and click Done when finished."})}
            `:""}
        </section>
    `}function Eg(e,t){let r=gt.focusedIndex===t?"pf-step-card--active":"",a=e0(Sg(e.id));return`
        <article class="pf-step-card pf-clickable ${r}" data-step-card data-step-index="${t}" data-step-id="${e.id}">
            <p class="pf-step-index">Step ${e.id}</p>
            <h3 class="pf-step-title">${a?`${a}`:""}${de(e.title)}</h3>
        </article>
    `}function kg(){return`
        <footer class="pf-brand-footer">
            <div class="pf-brand-text">
                <div class="pf-brand-label">prairie.forge</div>
                <div class="pf-brand-meta">\xA9 Prairie Forge LLC, 2025. All rights reserved. Version ${Es}</div>
                <button type="button" class="pf-config-link" id="showConfigSheets">CONFIGURATION</button>
            </div>
        </footer>
    `}function Sg(e){return e===0?"config":e===1?"import":e===2?"headcount":e===3?"validate":e===4?"review":e===5?"journal":e===6?"archive":""}function bg(){var r,a,n,i,s,o;(r=document.getElementById("nav-home"))==null||r.addEventListener("click",()=>{var c;b0(),(c=document.getElementById("pf-hero"))==null||c.scrollIntoView({behavior:"smooth",block:"start"})}),(a=document.getElementById("nav-selector"))==null||a.addEventListener("click",()=>{window.location.href="../module-selector/index.html"}),(n=document.getElementById("nav-prev"))==null||n.addEventListener("click",()=>p0(-1)),(i=document.getElementById("nav-next"))==null||i.addEventListener("click",()=>p0(1));let e=document.getElementById("nav-quick-toggle"),t=document.getElementById("quick-access-dropdown");e==null||e.addEventListener("click",c=>{c.stopPropagation(),t==null||t.classList.toggle("hidden"),e.classList.toggle("is-active")}),document.addEventListener("click",c=>{!(t!=null&&t.contains(c.target))&&!(e!=null&&e.contains(c.target))&&(t==null||t.classList.add("hidden"),e==null||e.classList.remove("is-active"))}),(s=document.getElementById("nav-config"))==null||s.addEventListener("click",async()=>{t==null||t.classList.add("hidden"),e==null||e.classList.remove("is-active"),await h0()}),(o=document.getElementById("showConfigSheets"))==null||o.addEventListener("click",async()=>{await h0()})}async function Tg(){if(typeof Excel=="undefined")return[];try{return await Excel.run(async e=>{let t=e.workbook.worksheets;return t.load("items/name,visibility"),await e.sync(),t.items.filter(a=>{let i=(a.name||"").toUpperCase();return i.startsWith("SS_")||i.includes("MAPPING")}).map(a=>({name:a.name,visible:a.visibility===Excel.SheetVisibility.visible}))})}catch(e){return console.error("[Config] Error reading configuration sheets:",e),[]}}function Ag(){if(document.getElementById("config-sheet-modal"))return;let e=document.createElement("div");if(e.id="config-sheet-modal",e.className="pf-config-modal hidden",e.innerHTML=`
        <div class="pf-config-modal-backdrop" data-close></div>
        <div class="pf-config-modal-card">
            <div class="pf-config-modal-head">
                <h3>Configuration Sheets</h3>
                <button type="button" class="pf-config-close" data-close aria-label="Close">\xD7</button>
            </div>
            <div class="pf-config-modal-body">
                <p class="pf-config-hint">Choose a configuration or mapping sheet to unhide and open.</p>
                <div id="config-sheet-list" class="pf-config-sheet-list">Loading\u2026</div>
            </div>
        </div>
    `,document.body.appendChild(e),!document.getElementById("pf-config-modal-styles")){let t=document.createElement("style");t.id="pf-config-modal-styles",t.textContent=`
            .pf-config-modal { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; z-index: 10000; }
            .pf-config-modal.hidden { display: none; }
            .pf-config-modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.6); }
            .pf-config-modal-card { position: relative; background: #0f172a; color: #e2e8f0; border-radius: 12px; padding: 20px; width: min(420px, 90%); box-shadow: 0 20px 60px rgba(0,0,0,0.35); }
            .pf-config-modal-head { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
            .pf-config-close { background: transparent; border: none; color: #e2e8f0; font-size: 20px; cursor: pointer; }
            .pf-config-hint { margin: 0 0 12px 0; color: #94a3b8; font-size: 14px; }
            .pf-config-sheet-list { display: flex; flex-direction: column; gap: 8px; max-height: 240px; overflow-y: auto; }
            .pf-config-sheet { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.08); border-radius: 8px; cursor: pointer; }
            .pf-config-sheet:hover { background: rgba(255,255,255,0.08); }
            .pf-config-pill { font-size: 12px; color: #a5b4fc; }
        `,document.head.appendChild(t)}}async function h0(){Ag();let e=document.getElementById("config-sheet-modal"),t=document.getElementById("config-sheet-list");if(!e||!t)return;t.textContent="Loading\u2026",e.classList.remove("hidden");let r=await Tg();r.length?(t.innerHTML="",r.forEach(a=>{let n=document.createElement("button");n.type="button",n.className="pf-config-sheet",n.innerHTML=`<span>${a.name}</span><span class="pf-config-pill">${a.visible?"Visible":"Hidden"}</span>`,n.addEventListener("click",async()=>{await Cg(a.name),e.classList.add("hidden")}),t.appendChild(n)})):t.textContent="No configuration sheets found.",e.querySelectorAll("[data-close]").forEach(a=>a.addEventListener("click",()=>e.classList.add("hidden")))}async function Cg(e){if(!(!e||typeof Excel=="undefined"))try{await Excel.run(async t=>{let r=t.workbook.worksheets,a=r.getItemOrNullObject(e);a.load("isNullObject,visibility"),await t.sync(),a.isNullObject&&(a=r.add(e)),a.visibility=Excel.SheetVisibility.visible,await t.sync(),a.activate(),a.getRange("A1").select(),await t.sync(),console.log(`[Config] Opened sheet: ${e}`)})}catch(t){console.error("[Config] Error opening sheet",e,t)}}function Fg(){document.querySelectorAll("[data-step-card]").forEach(e=>{let t=Number(e.getAttribute("data-step-index"));e.addEventListener("click",()=>ii(t))})}function Rg(){var o,c,l,f;let e=document.getElementById("config-user-name");e==null||e.addEventListener("change",h=>{let d=h.target.value.trim();Ne(Za,d);let u=document.getElementById("config-reviewer-name");u&&!u.value&&(u.value=d)}),Os("config-payroll-date",{onChange:h=>{if(Ne("PR_Payroll_Date",h),ps(0),!h)return;let d=$g(h);if(d){let m=document.getElementById("config-accounting-period");m&&(m.value=d),Ne("PR_Accounting_Period",d),Ye.overrides.accountingPeriod=!1}let u=Ug(h);if(u){let m=document.getElementById("config-je-id");m&&(m.value=u),Ne("PR_Journal_Entry_ID",u),Ye.overrides.jeId=!1}}});let t=kr(0),r=document.getElementById("config-accounting-period");r==null||r.addEventListener("change",h=>{Ye.overrides.accountingPeriod=!!h.target.value,Ne("PR_Accounting_Period",h.target.value||""),ps(0)});let a=document.getElementById("config-je-id");a==null||a.addEventListener("change",h=>{Ye.overrides.jeId=!!h.target.value,Ne("PR_Journal_Entry_ID",h.target.value.trim()),ps(0)}),(o=document.getElementById("config-company-name"))==null||o.addEventListener("change",h=>{Ne("SS_Company_Name",h.target.value.trim())}),(c=document.getElementById("config-payroll-provider"))==null||c.addEventListener("change",h=>{let d=h.target.value.trim();Ne(S0,d)}),(l=document.getElementById("config-accounting-link"))==null||l.addEventListener("change",h=>{Ne("SS_Accounting_Software",h.target.value.trim())});let n=document.getElementById("config-notes");if(n==null||n.addEventListener("input",h=>{t&&Ne(t.note,h.target.value,{debounceMs:400})}),t){let h=document.getElementById("config-notes-permanent");h&&(h.addEventListener("click",()=>{let u=!h.classList.contains("is-locked");qa(h,u),F0(t.note,u)}),qa(h,Er(t.note)));let d=document.getElementById("config-notes-save");d==null||d.addEventListener("click",()=>{n&&(Ne(t.note,n.value),xa(d,!0))})}let i=document.getElementById("config-reviewer-name");i==null||i.addEventListener("change",h=>{let d=h.target.value.trim();t&&Ne(t.reviewer,d),Ne(Za,d);let u=document.getElementById("config-signoff-date");if(d&&u&&!u.value){let m=rn();u.value=m,t&&Ne(t.signOff,m)}}),(f=document.getElementById("config-signoff-date"))==null||f.addEventListener("change",h=>{t&&Ne(t.signOff,h.target.value||"")});let s=document.getElementById("config-signoff-save");if(s==null||s.addEventListener("click",()=>{var m;let h=((m=i==null?void 0:i.value)==null?void 0:m.trim())||"",d=document.getElementById("config-signoff-date"),u=(d==null?void 0:d.value)||"";t&&(Ne(t.reviewer,h),Ne(t.signOff,u)),Ne(Za,h),xa(s,!0)}),ls(),t){let h=xe(t.signOff),d=xe(At[0]),u=!!(h||d==="Y"||d===!0);console.log(`[Step 0] Binding signoff toggle. signOff="${h}", complete="${d}", isComplete=${u}`),A0({buttonId:"config-signoff-toggle",inputId:"config-signoff-date",fieldName:t.signOff,completeField:At[0],initialActive:u,stepId:0,onComplete:B0(0)})}}function Dg(e){var r,a,n,i,s,o,c,l,f,h,d,u,m,p,x,S,y,T,D,N,K;if(e===6&&console.log("[Archive DEBUG] bindStepInteractions called for step 6"),(r=document.getElementById("step-back-btn"))==null||r.addEventListener("click",()=>{b0()}),(a=document.getElementById("step-action-btn"))==null||a.addEventListener("click",()=>{let b=un.find(O=>O.id===e);Ke(b!=null&&b.ctaLabel?`${b.ctaLabel} coming soon.`:"Step actions coming soon.","info")}),e===1&&((n=document.getElementById("import-open-data-btn"))==null||n.addEventListener("click",()=>Pg()),(i=document.getElementById("import-clear-btn"))==null||i.addEventListener("click",()=>Lg())),e===2&&((s=document.getElementById("headcount-skip-btn"))==null||s.addEventListener("click",()=>{Te.skipAnalysis=!Te.skipAnalysis;let b=document.getElementById("headcount-skip-btn");b==null||b.classList.toggle("is-active",Te.skipAnalysis),Te.skipAnalysis&&E0(),ri()}),(o=document.getElementById("roster-run-btn"))==null||o.addEventListener("click",async()=>{await oi(),si()}),(c=document.getElementById("roster-refresh-btn"))==null||c.addEventListener("click",async()=>{await oi(),si()}),(l=document.getElementById("roster-review-btn"))==null||l.addEventListener("click",()=>{var O;let b=((O=Te.roster)==null?void 0:O.mismatches)||[];_0("Roster Differences",b,{sourceLabel:"Roster",targetLabel:"Payroll Data"})}),(f=document.getElementById("dept-review-btn"))==null||f.addEventListener("click",()=>{var O;let b=((O=Te.departments)==null?void 0:O.mismatches)||[];_0("Department Differences",b,{sourceLabel:"Roster",targetLabel:"Payroll",formatter:A=>({name:A.employee,source:`${A.rosterDept} \u2192 ${A.payrollDept}`,isMissingFromTarget:!0})})})),e===3&&((h=document.getElementById("validation-run-btn"))==null||h.addEventListener("click",()=>xs()),(d=document.getElementById("validation-refresh-btn"))==null||d.addEventListener("click",()=>xs()),(u=document.getElementById("bank-amount-input"))==null||u.addEventListener("blur",k0),(m=document.getElementById("bank-amount-input"))==null||m.addEventListener("keydown",b=>{b.key==="Enter"&&k0(b)})),e===5&&((p=document.getElementById("je-run-btn"))==null||p.addEventListener("click",()=>ux()),(x=document.getElementById("je-save-btn"))==null||x.addEventListener("click",()=>dx()),(S=document.getElementById("je-create-btn"))==null||S.addEventListener("click",()=>hx()),(y=document.getElementById("je-export-btn"))==null||y.addEventListener("click",()=>px()),(T=document.getElementById("je-upload-btn"))==null||T.addEventListener("click",()=>mx())),e===4){let b=document.querySelector(".pf-step-guide");if(b){let O="https://your-project.supabase.co/functions/v1/copilot";As(b,{id:"expense-review-copilot",contextProvider:Wg(),systemPrompt:`You are Prairie Forge CoPilot, an expert financial analyst assistant for payroll expense review.

CONTEXT: You're embedded in the Payroll Recorder Excel add-in, helping accountants and CFOs review payroll data before journal entry export.

YOUR CAPABILITIES:
1. Analyze payroll expense data for accuracy and completeness
2. Identify trends, anomalies, and variances requiring attention
3. Prepare executive-ready insights and talking points
4. Validate journal entries before export to accounting system

COMMUNICATION STYLE:
- Be concise and actionable
- Use bullet points and tables for clarity
- Highlight issues with \u26A0\uFE0F and successes with \u2713
- Format currency as $X,XXX (no decimals for totals)
- Format percentages as X.X%
- Always end with 2-3 concrete next steps

ANALYSIS FOCUS:
- Period-over-period changes exceeding 10%
- Department cost anomalies vs historical norms
- Headcount vs payroll expense alignment
- Burden rate outliers (normal range: 15-35%)
- Missing or incomplete GL account mappings
- Data quality issues (blanks, duplicates, mismatches)

When asked about variances, explain the business drivers, not just the numbers.
When asked about readiness, be specific about what passes and what needs attention.`})}(D=document.getElementById("expense-run-btn"))==null||D.addEventListener("click",()=>{w0()}),(N=document.getElementById("expense-refresh-btn"))==null||N.addEventListener("click",()=>{w0()})}let t=kr(e);if(console.log(`[Step ${e}] Binding interactions, fields:`,t),t){let b=e===1?"step-notes-1":"step-notes-input",O=document.getElementById(b);console.log(`[Step ${e}] Notes input found:`,!!O,`(id: ${b})`);let A=e===1?document.getElementById("step-notes-save-1"):e===2?document.getElementById("step-notes-save-2"):e===3?document.getElementById("step-notes-save-3"):e===4?document.getElementById("step-notes-save-4"):e===5?document.getElementById("step-notes-save-5"):document.getElementById("step-notes-save");O==null||O.addEventListener("input",be=>{Ne(t.note,be.target.value,{debounceMs:400}),e===2&&(Te.skipAnalysis&&E0(),ri())}),A==null||A.addEventListener("click",()=>{O&&(Ne(t.note,O.value),xa(A,!0))});let I=e===1?"step-reviewer-1":"step-reviewer-name",V=document.getElementById(I);V==null||V.addEventListener("change",be=>{let Fe=be.target.value.trim();Ne(t.reviewer,Fe);let C=e===1?document.getElementById("step-signoff-1"):e===2?document.getElementById("step-signoff-date"):e===3?document.getElementById("step-signoff-3"):e===4?document.getElementById("step-signoff-4"):e===5?document.getElementById("step-signoff-5"):document.getElementById(`step-signoff-${e}`);if(Fe&&C&&!C.value){let U=rn();C.value=U,Ne(t.signOff,U)}});let j=e===1?"step-signoff-1":e===2?"step-signoff-date":e===3?"step-signoff-3":e===4?"step-signoff-4":e===5?"step-signoff-5":`step-signoff-${e}`;console.log(`[Step ${e}] Signoff input ID: ${j}, found:`,!!document.getElementById(j)),(K=document.getElementById(j))==null||K.addEventListener("change",be=>{Ne(t.signOff,be.target.value||"")});let se=e===1?"step-notes-lock-1":"step-notes-permanent",pe=document.getElementById(se);pe&&(pe.addEventListener("click",()=>{let be=!pe.classList.contains("is-locked");qa(pe,be),F0(t.note,be),e===2&&ri()}),qa(pe,Er(t.note)));let ee=e===1?document.getElementById("step-signoff-save-1"):e===2?document.getElementById("headcount-signoff-save"):e===3?document.getElementById("step-signoff-save-3"):e===4?document.getElementById("step-signoff-save-4"):e===5?document.getElementById("step-signoff-save-5"):document.getElementById(`step-signoff-save-${e}`);ee==null||ee.addEventListener("click",()=>{var C,U;let be=((C=V==null?void 0:V.value)==null?void 0:C.trim())||"",Fe=((U=document.getElementById(j))==null?void 0:U.value)||"";Ne(t.reviewer,be),Ne(t.signOff,Fe),xa(ee,!0)}),ls();let ye=At[e],Se=ye?!!xe(ye):!1,Xe=xe(t.signOff),Ce=e===1?"step-signoff-toggle-1":e===2?"headcount-signoff-toggle":e===3?"validation-signoff-toggle":e===4?"expense-signoff-toggle":e===5?"step-signoff-toggle-5":`step-signoff-toggle-${e}`;console.log(`[Step ${e}] Toggle button ID: ${Ce}, found:`,!!document.getElementById(Ce)),A0({buttonId:Ce,inputId:j,fieldName:t.signOff,completeField:ye,requireNotesCheck:null,initialActive:!!(Xe||Se),stepId:e,onComplete:B0(e)})}if(e===2&&ri(),e===6){let b=document.getElementById("archive-run-btn");if(b){let O=b.cloneNode(!0);b.parentNode.replaceChild(O,b),O.onclick=async function(){Ke("Starting archive process...","info",2e3);try{await M0()}catch(A){Ke("Archive Error: "+A.message,"error",8e3)}}}}}function ii(e){if(Number.isNaN(e)||e<0||e>=lr.length)return;let t=lr[e];if(!t)return;Qa=e;let r=t.id===0?"config":"step";ws({focusedIndex:e,activeView:r,activeStepId:t.id});let a=ag[t.id];a&&Qg(a),t.id===2&&!Te.hasAnalyzed&&oi().then(()=>{si()})}function p0(e){if(gt.activeView==="home"&&e>0){ii(0);return}let t=gt.focusedIndex+e,r=Math.max(0,Math.min(lr.length-1,t));ii(r)}function Ig(){if(gt.activeView!=="home"||Qa===null)return;let e=document.querySelector(`[data-step-card][data-step-index="${Qa}"]`);Qa=null,e==null||e.scrollIntoView({behavior:"smooth",block:"center"})}async function b0(){let e=vi(ni);await xi(e.sheetName,e.title,e.subtitle),ws({activeView:"home",activeStepId:null})}function Ng(){window.location.href="../module-selector/index.html"}function ws(e){Object.assign(gt,e),Nt()}function Pr(){return xe(Za)||xe("SS_Default_Reviewer")||""}function hs(e,t){e&&(e.classList.toggle("is-active",t),e.setAttribute("aria-pressed",String(t)))}function T0(e){let t=document.getElementById("je-save-btn");t&&t.classList.toggle("is-saved",e)}function ps(e){let t=Or[e],r=At[e];if(!t||!r)return;let a=xe(t.signOff),n=xe(r);if(!(!!a||n==="Y"||n===!0))return;console.log(`[Signoff] Clearing completion for step ${e} due to field change`),Ne(t.signOff,""),Ne(r,"");let s=document.querySelector(`[id$="-signoff-toggle"], [id$="-signoff-toggle-${e}"]`);s&&(s.classList.remove("is-active"),s.setAttribute("aria-pressed","false"));let o=document.querySelector('[id^="config-signoff-"], [id^="step-signoff-"]');o&&(o.value="")}function Og(){let e={};return console.log("[Signoff] Checking step completion status..."),Object.keys(Or).forEach(t=>{let r=parseInt(t,10),a=Or[r];if(!a){e[r]=!1;return}let n=xe(a.signOff),i=At[r],s=xe(i),o=!!n||s==="Y"||s===!0;e[r]=o,console.log(`[Signoff] Step ${r}: signOff="${n}", complete="${s}" \u2192 ${o?"COMPLETE":"pending"}`)}),console.log("[Signoff] Status summary:",e),e}function A0({buttonId:e,inputId:t,fieldName:r,completeField:a,requireNotesCheck:n,onComplete:i,initialActive:s=!1,stepId:o=null}){let c=document.getElementById(e);if(!c){console.warn(`[Signoff] Button not found: ${e}`);return}let l=t?document.getElementById(t):null,f=s||!!(l!=null&&l.value);hs(c,f),console.log(`[Signoff] Bound ${e}, initial active: ${f}, stepId: ${o}`),c.addEventListener("click",()=>{if(console.log(`[Signoff] Done button clicked: ${e}, stepId: ${o}`),o!==null&&o>0){let d=Og(),{canComplete:u,message:m}=c0(o,d),p=c.classList.contains("is-active");if(console.log(`[Signoff] canComplete: ${u}, isCurrentlyActive: ${p}`),!p&&!u){console.log(`[Signoff] BLOCKED: ${m}`),l0(m);return}}let h=!c.classList.contains("is-active");if(console.log(`[Signoff] ${e} clicked, toggling to: ${h}`),hs(c,h),l&&(l.value=h?rn():""),r){let d=h?rn():"";console.log(`[Signoff] Writing ${r} = "${d}"`),Ne(r,d)}if(a){let d=h?"Y":"";console.log(`[Signoff] Writing ${a} = "${d}"`),Ne(a,d)}h&&typeof i=="function"&&i()}),l&&l.addEventListener("change",()=>{let h=!!l.value,d=c.classList.contains("is-active");h!==d&&(console.log(`[Signoff] Date input changed, syncing button to: ${h}`),hs(c,h),r&&Ne(r,l.value||""),a&&Ne(a,h?"Y":""))})}async function Pg(){if(!lt()){Ke("Open this module inside Excel to access the data sheet.","info");return}try{await Excel.run(async e=>{let t=e.workbook.worksheets.getItem(he.DATA);t.activate(),t.getRange("A1").select(),await e.sync()})}catch(e){console.error("Unable to open PR_Data sheet",e),Ke(`Unable to open ${he.DATA}. Confirm the sheet exists in this workbook.`,"error")}}async function Lg(){if(!lt()){Ke("Open this module inside Excel to clear data.","info");return}if(await vs(`All data in PR_Data will be permanently removed.

This action cannot be undone.`,{title:"Clear Payroll Data",icon:"\u{1F5D1}\uFE0F",confirmText:"Clear Data",cancelText:"Keep Data",destructive:!0}))try{await Excel.run(async t=>{let r=t.workbook.worksheets.getItem(he.DATA),a=r.getUsedRangeOrNullObject();a.load("isNullObject"),await t.sync(),a.isNullObject||(r.getRange("A2:Z10000").clear(Excel.ClearApplyTo.contents),await t.sync());let n=t.workbook.worksheets.getItemOrNullObject(he.DATA_CLEAN);n.load("isNullObject"),await t.sync(),n.isNullObject||(n.getRange("A2:Z10000").clear(Excel.ClearApplyTo.contents),await t.sync()),r.activate(),r.getRange("A1").select(),await t.sync()}),Te.hasAnalyzed=!1,Te.roster=null,Te.departments=null,wa({prDataTotal:null,cleanTotal:null,reconDifference:null},{rerender:!1}),Ke("PR_Data cleared successfully.","success")}catch(t){console.error("Unable to clear PR_Data sheet",t),Ke("Unable to clear PR_Data. Please try again.","error")}}async function _r(e){var n,i;if(!ds.length)return null;if(Qn){let s=e.workbook.tables.getItemOrNullObject(Qn);if(s.load("name"),await e.sync(),!s.isNullObject)return s;Qn=null}let t=e.workbook.tables;t.load("items/name"),await e.sync();let r=((n=t.items)==null?void 0:n.map(s=>s.name))||[];console.log("[Payroll] Looking for config table:",ds),console.log("[Payroll] Found tables in workbook:",r);let a=(i=t.items)==null?void 0:i.find(s=>ds.includes(s.name));return a?(console.log("[Payroll] \u2713 Config table found:",a.name),Qn=a.name,e.workbook.tables.getItem(a.name)):(console.warn("[Payroll] \u26A0\uFE0F CONFIG TABLE NOT FOUND!"),console.warn("[Payroll] Expected table named: SS_PF_Config"),console.warn("[Payroll] Available tables:",r),console.warn("[Payroll] To fix: Select your data in SS_PF_Config sheet \u2192 Insert \u2192 Table \u2192 Name it 'SS_PF_Config'"),null)}async function C0(){if(!lt()){Ye.loaded=!0;return}try{await Excel.run(async e=>{let t=await _r(e);if(!t){console.warn("Payroll Recorder: SS_PF_Config table is missing."),Ye.loaded=!0;return}let r=t.getDataBodyRange();r.load("values"),await e.sync();let a=r.values||[],n={},i={};a.forEach(s=>{var c,l;let o=xt(s[Ee.FIELD]);o&&(n[o]=(c=s[Ee.VALUE])!=null?c:"",i[o]=(l=s[Ee.PERMANENT])!=null?l:"")}),Ye.values=n,Ye.permanents=i,Ye.overrides.accountingPeriod=!!(n.PR_Accounting_Period||n.Accounting_Period),Ye.overrides.jeId=!!(n.PR_Journal_Entry_ID||n.Journal_Entry_ID),Ye.loaded=!0})}catch(e){console.warn("Payroll Recorder: unable to load PF_Config table.",e),Ye.loaded=!0}}function xe(e){var t;return(t=Ye.values[e])!=null?t:""}function Bg(){let e=Object.keys(Ye.values||{});return tn.find(r=>e.includes(r))||tn[0]}function ci(){return xe(Bg())}function ys(){return(xe(S0)||xe("Payroll_Provider_Link")||"").trim()}function Er(e){return R0(Ye.permanents[e])}function Mg(e){let t=At[e];return t?R0(xe(t)):!1}function F0(e,t){let r=xt(e);r&&(Ye.permanents[r]=t?"Y":"N",Hg(r,t?"Y":"N"))}function R0(e){let t=String(e!=null?e:"").trim().toLowerCase();return t==="true"||t==="y"||t==="yes"||t==="1"}function xt(e){return String(e!=null?e:"").trim()}function D0(e){let t=String(e!=null?e:"").trim().toLowerCase();return!!(!t||["employee","employee name","name","full name","header","column","n/a","none","blank","null","undefined"].some(i=>t===i||t===i.replace(/\s+/g,""))||["total","subtotal","summary","grand total","totals for department","department total","dept total","report total"].some(i=>t.includes(i))||["~","*","---","==="].some(i=>t.startsWith(i)))}function ar(e){if(!e)return"";let t=li(e);return t?`${t.year}-${String(t.month).padStart(2,"0")}-${String(t.day).padStart(2,"0")}`:""}function $g(e){let t=li(e);return t?t.year<1900||t.year>2100?(console.warn("deriveAccountingPeriod - Invalid year:",t.year,"from input:",e),""):`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.month-1]} ${t.year}`:""}function Ug(e){let t=li(e);return t?t.year<1900||t.year>2100?(console.warn("deriveJeId - Invalid year:",t.year,"from input:",e),""):`PR-AUTO-${t.year}-${String(t.month).padStart(2,"0")}-${String(t.day).padStart(2,"0")}`:""}function rn(){return an(new Date)}function Ne(e,t,r={}){var s;let a=xt(e);Ye.values[a]=t!=null?t:"";let n=(s=r.debounceMs)!=null?s:0;if(!n){let o=va.get(a);o&&clearTimeout(o),va.delete(a),en(a,t!=null?t:"");return}va.has(a)&&clearTimeout(va.get(a));let i=setTimeout(()=>{va.delete(a),en(a,t!=null?t:"")},n);va.set(a,i)}var Vg=["PR_Accounting_Period","PTO_Accounting_Period","Accounting_Period"];async function en(e,t){let r=xt(e);if(Ye.values[r]=t!=null?t:"",console.log(`[Payroll] Writing config: ${r} = "${t}"`),!lt()){console.warn("[Payroll] Excel runtime not available - cannot write");return}let a=Vg.some(n=>r===n||r.toLowerCase()===n.toLowerCase());try{await Excel.run(async n=>{var d;let i=await _r(n);if(!i){console.error("[Payroll] \u274C Cannot write - config table not found");return}let s=i.getDataBodyRange(),o=i.getHeaderRowRange();s.load("values"),o.load("values"),await n.sync();let c=o.values[0]||[],l=s.values||[],f=c.length;console.log(`[Payroll] Table has ${l.length} rows, ${f} columns`);let h=[];if(l.forEach((u,m)=>{xt(u[Ee.FIELD])===r&&h.push(m)}),h.length===0){Ye.permanents[r]=(d=Ye.permanents[r])!=null?d:d0;let u=new Array(f).fill("");if(Ee.TYPE>=0&&Ee.TYPE<f&&(u[Ee.TYPE]=Qm),Ee.FIELD>=0&&Ee.FIELD<f&&(u[Ee.FIELD]=r),Ee.VALUE>=0&&Ee.VALUE<f&&(u[Ee.VALUE]=t!=null?t:""),Ee.PERMANENT>=0&&Ee.PERMANENT<f&&(u[Ee.PERMANENT]=d0),console.log("[Payroll] Adding NEW row:",u),i.rows.add(null,[u]),await n.sync(),a){let m=i.rows;m.load("count"),await n.sync();let p=m.count-1,S=i.rows.getItemAt(p).getRange().getCell(0,Ee.VALUE);S.numberFormat=[["@"]],S.values=[[t!=null?t:""]],await n.sync(),console.log(`[Payroll] \u2713 Applied text format to ${r}`)}console.log(`[Payroll] \u2713 New row added for ${r}`)}else{let u=h[0];console.log(`[Payroll] Updating existing row ${u} for ${r}`);let m=s.getCell(u,Ee.VALUE);if(a&&(m.numberFormat=[["@"]]),m.values=[[t!=null?t:""]],await n.sync(),console.log(`[Payroll] \u2713 Updated ${r}`),h.length>1){console.log(`[Payroll] Found ${h.length-1} duplicate rows for ${r}, removing...`);let p=h.slice(1).reverse();for(let x of p)try{i.rows.getItemAt(x).delete()}catch(S){console.warn(`[Payroll] Could not delete duplicate row ${x}:`,S.message)}await n.sync(),console.log(`[Payroll] \u2713 Removed duplicate rows for ${r}`)}}})}catch(n){console.error(`[Payroll] \u274C Write failed for ${e}:`,n)}}async function Hg(e,t){let r=xt(e);if(r&&lt()){Ye.permanents[r]=t;try{await Excel.run(async a=>{let n=await _r(a);if(!n){console.warn(`Payroll Recorder: unable to locate config table when toggling ${e} permanent flag.`);return}let i=n.getDataBodyRange();i.load("values"),await a.sync();let o=(i.values||[]).findIndex(c=>xt(c[Ee.FIELD])===r);o!==-1&&(i.getCell(o,Ee.PERMANENT).values=[[t]],await a.sync())})}catch(a){console.warn(`Payroll Recorder: unable to update permanent flag for ${e}`,a)}}}function li(e){if(!e)return null;let t=String(e).trim(),r=/^(\d{4})-(\d{2})-(\d{2})/.exec(t);if(r){let s=Number(r[1]),o=Number(r[2]),c=Number(r[3]);if(s&&o&&c)return{year:s,month:o,day:c}}let a=/^(\d{1,2})\/(\d{1,2})\/(\d{4})/.exec(t);if(a){let s=Number(a[1]),o=Number(a[2]),c=Number(a[3]);if(c&&s&&o)return{year:c,month:s,day:o}}let n=Number(e);if(Number.isFinite(n)&&n>4e4&&n<6e4){let o=Math.floor(n-25569)*86400*1e3,c=new Date(o);if(!isNaN(c.getTime())){let l=`${c.getUTCFullYear()}-${String(c.getUTCMonth()+1).padStart(2,"0")}-${String(c.getUTCDate()).padStart(2,"0")}`;return console.log("DEBUG parseDateInput - Converted Excel serial",n,"to",l),{year:c.getUTCFullYear(),month:c.getUTCMonth()+1,day:c.getUTCDate()}}}let i=new Date(t);return isNaN(i.getTime())?(console.warn("DEBUG parseDateInput - Could not parse date value:",e),null):{year:i.getFullYear(),month:i.getMonth()+1,day:i.getDate()}}function an(e){if(e._isUTC){let n=e.getUTCFullYear(),i=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0");return`${n}-${i}-${s}`}let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`}function m0(e){if(!e)return null;if(typeof e=="string"){let r=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r)return`${r[1]}-${r[2]}-${r[3]}`}let t=li(e);return t?`${t.year}-${String(t.month).padStart(2,"0")}-${String(t.day).padStart(2,"0")}`:null}function Wg(){return async()=>{if(!lt())return null;try{return await Excel.run(async e=>{var s,o,c;let t={timestamp:new Date().toISOString(),period:null,summary:{},departments:[],recentPeriods:[],dataQuality:{}},r=await _r(e);if(r){let l=r.getDataBodyRange();l.load("values"),await e.sync();let f=l.values||[];for(let h of f){let d=String(h[Ee.FIELD]||"").trim(),u=h[Ee.VALUE];d.toLowerCase().includes("accounting")&&d.toLowerCase().includes("period")&&(t.period=String(u||"").trim())}}let a=e.workbook.worksheets.getItemOrNullObject(he.DATA_CLEAN);if(a.load("isNullObject"),await e.sync(),!a.isNullObject){let l=a.getUsedRangeOrNullObject();if(l.load("values"),await e.sync(),!l.isNullObject&&((s=l.values)==null?void 0:s.length)>1){let f=l.values[0].map(y=>Kt(y)),h=l.values.slice(1),d=f.findIndex(y=>y.includes("amount")),u=ya(f),m=f.findIndex(y=>y.includes("employee")),p=0,x=new Set,S=new Map;for(let y of h){let T=Number(y[d])||0;if(p+=T,m>=0){let D=String(y[m]||"").trim();D&&x.add(D)}if(u>=0){let D=String(y[u]||"").trim();D&&S.set(D,(S.get(D)||0)+T)}}t.summary={total:p,employeeCount:x.size,avgPerEmployee:x.size?p/x.size:0,rowCount:h.length},t.departments=Array.from(S.entries()).map(([y,T])=>({name:y,total:T,percentOfTotal:p?T/p:0})).sort((y,T)=>T.total-y.total),t.dataQuality.dataCleanReady=!0,t.dataQuality.rowCount=h.length}}let n=e.workbook.worksheets.getItemOrNullObject(he.ARCHIVE_SUMMARY);if(n.load("isNullObject"),await e.sync(),!n.isNullObject){let l=n.getUsedRangeOrNullObject();if(l.load("values"),await e.sync(),!l.isNullObject&&((o=l.values)==null?void 0:o.length)>1){let f=l.values[0].map(u=>Kt(u)),h=f.findIndex(u=>u.includes("period")),d=f.findIndex(u=>u.includes("total"));t.recentPeriods=l.values.slice(1,6).map(u=>({period:u[h]||"",total:Number(u[d])||0})),t.dataQuality.archiveAvailable=!0,t.dataQuality.periodsAvailable=t.recentPeriods.length}}let i=e.workbook.worksheets.getItemOrNullObject(he.JE_DRAFT);if(i.load("isNullObject"),await e.sync(),!i.isNullObject){let l=i.getUsedRangeOrNullObject();if(l.load("values"),await e.sync(),!l.isNullObject&&((c=l.values)==null?void 0:c.length)>1){let f=l.values[0].map(p=>Kt(p)),h=f.findIndex(p=>p.includes("debit")),d=f.findIndex(p=>p.includes("credit")),u=0,m=0;for(let p of l.values.slice(1))u+=Number(p[h])||0,m+=Number(p[d])||0;t.journalEntry={totalDebit:u,totalCredit:m,difference:Math.abs(u-m),isBalanced:Math.abs(u-m)<.01,lineCount:l.values.length-1},t.dataQuality.jeDraftReady=!0}}return console.log("CoPilot context gathered:",t),t})}catch(e){return console.warn("CoPilot context provider error:",e),null}}}function de(e){return String(e!=null?e:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Vt(e,t){return`
        <div class="pf-labeled-button">
            ${e}
            <span class="pf-button-label">${de(t)}</span>
        </div>
    `}function lt(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}function kr(e){return Or[e]||null}function jg(){var r,a,n,i;let e=Math.abs((a=(r=Te.roster)==null?void 0:r.difference)!=null?a:0),t=Math.abs((i=(n=Te.departments)==null?void 0:n.difference)!=null?i:0);return e>0||t>0}function Gg(){return!Te.skipAnalysis&&jg()}function Tt(e){return e==null||Number.isNaN(e)?"---":typeof e!="number"?e:e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function I0(e){let t=_s(e);return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):""}function zg(e=[]){return e.map(t=>(t||[]).map(r=>{if(r==null)return"";let a=String(r);return/[",\n]/.test(a)?`"${a.replace(/"/g,'""')}"`:a}).join(",")).join(`
`)}function Xg(e,t){let r=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=e,document.body.appendChild(n),n.click(),n.remove(),setTimeout(()=>URL.revokeObjectURL(a),1e3)}function _s(e){if(typeof e=="number")return e;if(e==null)return NaN;let t=String(e).replace(/[^0-9.-]/g,""),r=Number.parseFloat(t);return Number.isFinite(r)?r:NaN}function Yg(e){if(e instanceof Date)return an(e);if(typeof e=="number"&&!Number.isNaN(e)){let a=N0(e);return a?an(a):""}let t=String(e!=null?e:"").trim();if(!t)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;let r=new Date(t);if(!Number.isNaN(r.getTime())){let a=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0");return`${a}-${n}-${i}`}return t}function N0(e){if(!Number.isFinite(e))return null;let t=Math.floor(e-25569);if(!Number.isFinite(t))return null;let r=t*86400*1e3,a=new Date(r);return a._isUTC=!0,a}function Kg(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,a,n]=e.split("-").map(Number);return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a-1]} ${n}, ${r}`}let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function ei(e){if(e==null||e==="")return 0;let t=Number(e);return Number.isFinite(t)?t:0}function Jg(e){let t=Ot(e).toLowerCase();return t?t.includes("burden")||t.includes("tax")||t.includes("benefit")||t.includes("fica")||t.includes("insurance")||t.includes("health")||t.includes("medicare")?"burden":t.includes("bonus")||t.includes("commission")||t.includes("variable")||t.includes("overtime")||t.includes("per diem")?"variable":"fixed":"variable"}function g0(e){if(!e||e.length<2)return[];let t=(e[0]||[]).map(n=>Kt(n));console.log("parseExpenseRows - headers:",t);let r={payrollDate:t.findIndex(n=>n.includes("payroll")&&n.includes("date")),employee:t.findIndex(n=>n.includes("employee")),department:t.findIndex(n=>n.includes("department")),fixed:t.findIndex(n=>n.includes("fixed")),variable:t.findIndex(n=>n.includes("variable")),burden:t.findIndex(n=>n.includes("burden")),amount:t.findIndex(n=>n.includes("amount")),expenseReview:t.findIndex(n=>n.includes("expense")&&n.includes("review")),category:t.findIndex(n=>n.includes("payroll")&&n.includes("category"))};if(console.log("parseExpenseRows - column indexes:",r),r.payrollDate>=0){let n=new Set;for(let i=1;i<e.length;i++){let s=e[i][r.payrollDate];s&&n.add(String(s))}console.log("parseExpenseRows - unique payroll dates found:",[...n].slice(0,20))}let a=[];for(let n=1;n<e.length;n+=1){let i=e[n],s=Yg(r.payrollDate>=0?i[r.payrollDate]:null);if(!s)continue;let o=r.employee>=0?Ot(i[r.employee]):"",c=r.department>=0&&Ot(i[r.department])||"Unassigned",l=r.fixed>=0?ei(i[r.fixed]):null,f=r.variable>=0?ei(i[r.variable]):null,h=r.burden>=0?ei(i[r.burden]):null,d=0,u=0,m=0;if(l!==null||f!==null||h!==null)d=l!=null?l:0,u=f!=null?f:0,m=h!=null?h:0;else{let p=r.amount>=0?ei(i[r.amount]):0,x=Jg(r.expenseReview>=0?i[r.expenseReview]:i[r.category]);x==="fixed"?d=p:x==="burden"?m=p:u=p}d===0&&u===0&&m===0||a.push({period:s,employee:o,department:c||"Unassigned",fixed:d,variable:u,burden:m})}return a}function x0(e){let t=new Map;e.forEach(a=>{let n=a.period;if(!n)return;t.has(n)||t.set(n,{key:n,label:Kg(n),employees:new Set,departments:new Map,summary:{fixed:0,variable:0,burden:0}});let i=t.get(n);i.employees.add(a.employee||`EMP-${i.employees.size+1}`);let s=a.department||"Unassigned";i.departments.has(s)||i.departments.set(s,{name:s,fixed:0,variable:0,burden:0,employees:new Set});let o=i.departments.get(s);o.fixed+=a.fixed,o.variable+=a.variable,o.burden+=a.burden,o.employees.add(a.employee||`EMP-${o.employees.size+1}`),i.summary.fixed+=a.fixed,i.summary.variable+=a.variable,i.summary.burden+=a.burden});let r=[];return t.forEach(a=>{let n=a.summary.fixed+a.summary.variable+a.summary.burden,i=Array.from(a.departments.values()).map(c=>{let l=c.fixed+c.variable,f=l+c.burden;return{name:c.name,fixed:c.fixed,variable:c.variable,gross:l,burden:c.burden,allIn:f,percent:n?f/n:0,headcount:c.employees.size,delta:0}});i.sort((c,l)=>l.allIn-c.allIn);let s={employeeCount:a.employees.size,fixed:a.summary.fixed,variable:a.summary.variable,burden:a.summary.burden,total:n,burdenRate:n?a.summary.burden/n:0,delta:0},o={name:"Totals",fixed:a.summary.fixed,variable:a.summary.variable,gross:a.summary.fixed+a.summary.variable,burden:a.summary.burden,allIn:n,percent:n?1:0,headcount:a.employees.size,delta:0,isTotal:!0};r.push({key:a.key,label:a.label,summary:s,departments:i,totalsRow:o})}),r.sort((a,n)=>a.key<n.key?1:-1)}function v0(e,t){console.log("buildExpenseReviewPeriods - cleanValues rows:",(e==null?void 0:e.length)||0),console.log("buildExpenseReviewPeriods - archiveValues rows:",(t==null?void 0:t.length)||0);let r=x0(g0(e)),a=x0(g0(t));console.log("buildExpenseReviewPeriods - currentPeriods:",r.map(l=>{var f,h;return{key:l.key,employees:(f=l.summary)==null?void 0:f.employeeCount,total:(h=l.summary)==null?void 0:h.total}})),console.log("buildExpenseReviewPeriods - archivePeriods:",a.map(l=>{var f,h;return{key:l.key,employees:(f=l.summary)==null?void 0:f.employeeCount,total:(h=l.summary)==null?void 0:h.total}}));let n=new Map(a.map(l=>[l.key,l])),i=[];r.length&&(i.push(r[0]),n.delete(r[0].key)),a.forEach(l=>{i.length>=6||i.some(f=>f.key===l.key)||i.push(l)}),console.log("buildExpenseReviewPeriods - combined before filter:",i.map(l=>{var f,h;return{key:l.key,employees:(f=l.summary)==null?void 0:f.employeeCount,total:(h=l.summary)==null?void 0:h.total}}));let s=3,o=1e3,c=i.filter(l=>{var u,m,p,x,S;if(!l||!l.key)return console.log("buildExpenseReviewPeriods - EXCLUDED (no key):",l),!1;let f=((u=l.summary)==null?void 0:u.total)||(((m=l.summary)==null?void 0:m.fixed)||0)+(((p=l.summary)==null?void 0:p.variable)||0)+(((x=l.summary)==null?void 0:x.burden)||0),h=((S=l.summary)==null?void 0:S.employeeCount)||0;if(i.indexOf(l)===0)return console.log(`buildExpenseReviewPeriods - INCLUDED (current): ${l.key} - ${h} employees, $${f}`),!0;let d=h>=s&&f>=o;return console.log(`buildExpenseReviewPeriods - ${d?"INCLUDED":"EXCLUDED"}: ${l.key} - ${h} employees, $${f} (needs >=${s} emp, >=$${o})`),d}).sort((l,f)=>l.key<f.key?1:-1).slice(0,6);return console.log("buildExpenseReviewPeriods - FINAL periods:",c.map(l=>l.key)),c.forEach((l,f)=>{let h=c[f+1],d=h?l.summary.total-h.summary.total:0;l.summary.delta=d;let u=new Map(((h==null?void 0:h.departments)||[]).map(m=>[m.name,m]));l.departments.forEach(m=>{let p=u.get(m.name);m.delta=p?m.allIn-p.allIn:0}),l.totalsRow.delta=d}),c}async function w0(){if(!lt()){ti({loading:!1,lastError:"Excel runtime is unavailable."});return}ti({loading:!0,lastError:null});try{let e=await Excel.run(async t=>{let r=t.workbook.worksheets.getItemOrNullObject(he.DATA_CLEAN),a=t.workbook.worksheets.getItemOrNullObject(he.ARCHIVE_SUMMARY),n=t.workbook.worksheets.getItemOrNullObject(he.EXPENSE_REVIEW);if(r.load("isNullObject, name"),a.load("isNullObject, name"),n.load("isNullObject, name"),await t.sync(),console.log("Expense Review - Sheet check:",{cleanSheet:r.isNullObject?"MISSING":r.name,archiveSheet:a.isNullObject?"MISSING":a.name,reviewSheet:n.isNullObject?"MISSING":n.name}),n.isNullObject){console.log("Creating PR_Expense_Review sheet...");let c=t.workbook.worksheets.add(he.EXPENSE_REVIEW);await t.sync();let l=t.workbook.worksheets.getItem(he.EXPENSE_REVIEW),f=[],h=[];if(!r.isNullObject){let u=r.getUsedRangeOrNullObject();u.load("values"),await t.sync(),f=u.isNullObject?[]:u.values||[]}if(!a.isNullObject){let u=a.getUsedRangeOrNullObject();u.load("values"),await t.sync(),h=u.isNullObject?[]:u.values||[]}let d=v0(f,h);return await y0(t,l,d),d}let i=[],s=[];if(r.isNullObject)console.warn("Expense Review - PR_Data_Clean sheet not found, using empty data");else{let c=r.getUsedRangeOrNullObject();c.load("values"),await t.sync(),i=c.isNullObject?[]:c.values||[],console.log("Expense Review - PR_Data_Clean rows:",i.length)}if(a.isNullObject)console.warn("Expense Review - PR_Archive_Summary sheet not found, using empty data");else{let c=a.getUsedRangeOrNullObject();c.load("values"),await t.sync(),s=c.isNullObject?[]:c.values||[],console.log("Expense Review - PR_Archive_Summary rows:",s.length)}let o=v0(i,s);return console.log("Expense Review - Periods built:",o.length),await y0(t,n,o),o});ti({loading:!1,periods:e,lastError:null}),await ig(),Nt()}catch(e){console.error("Expense Review: unable to build executive summary",e),console.error("Error details:",e.message,e.stack),ti({loading:!1,lastError:`Unable to build the Expense Review: ${e.message||"Unknown error"}`,periods:[]})}}async function y0(e,t,r){if(!t){console.error("writeExpenseReviewSheet: sheet is null/undefined");return}console.log("writeExpenseReviewSheet: Building executive dashboard with",r.length,"periods");try{let G=t.getUsedRangeOrNullObject();G.load("address");let ce=t.charts;ce.load("items"),await e.sync(),G.isNullObject||(G.clear(),await e.sync());for(let Ae=ce.items.length-1;Ae>=0;Ae--)ce.items[Ae].delete();await e.sync()}catch(G){console.warn("Could not clear sheet:",G)}let a=r[0]||{},n=r[1]||{},i=a.summary||{},s=n.summary||{},o=xe("PR_Accounting_Period")||ci()||"",c=Number(i.total)||0,l=Number(s.total)||0,f=c-l,h=l?f/l:0,d=Number(i.employeeCount)||0,u=Number(s.employeeCount)||0,m=d-u,p=d?c/d:0,x=u?l/u:0,S=p-x,y=qg(r),T=Zg(a,r),D=a.label||a.key||"Current Period",N=new Date().toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),K=G=>G>0?"\u25B2":G<0?"\u25BC":"\u2014",b=r.map(G=>{var ce;return((ce=G.summary)==null?void 0:ce.total)||0}).filter(G=>G>0),O=r.map(G=>{let ce=G.summary||{},Ae=ce.employeeCount||0;return Ae>0?(ce.total||0)/Ae:0}).filter(G=>G>0),A=r.slice(0,-1).map((G,ce)=>{var vt,je,He;let Ae=((vt=G.summary)==null?void 0:vt.total)||0,Qe=((He=(je=r[ce+1])==null?void 0:je.summary)==null?void 0:He.total)||0;return Qe>0?(Ae-Qe)/Qe:0}),I=(G,ce=null)=>{let Ae=ce!==null?[...G,ce]:G;if(!Ae.length)return{min:0,max:0,avg:0};let Qe=Math.min(...Ae),vt=Math.max(...Ae),je=G.length?G:Ae,He=je.reduce((Jt,jt)=>Jt+jt,0)/je.length;return{min:Qe,max:vt,avg:He}},V=I(b,c),j=I(O,p),se=I(A),pe=(G,ce,Ae,Qe=20)=>{if(Ae<=ce)return"\u2591".repeat(Qe);let vt=Ae-ce,je=Math.max(0,Math.min(1,(G-ce)/vt)),He=Math.round(je*(Qe-1)),Jt="";for(let jt=0;jt<Qe;jt++)jt===He?Jt+="\u25CF":Jt+="\u2591";return Jt},ee=Number(i.fixed)||0,ye=Number(i.variable)||0,Se=Number(i.burden)||0,Xe=ee+ye,Ce=c?Se/c:0,be=Number(s.fixed)||0,Fe=Number(s.variable)||0,C=Number(s.burden)||0,U=l?C/l:0,R=a.departments||[],F=R.filter(G=>{let ce=(G.name||"").toLowerCase();return ce.includes("sales")||ce.includes("marketing")}),Y=R.filter(G=>{let ce=(G.name||"").toLowerCase();return!ce.includes("sales")&&!ce.includes("marketing")}),le=F.reduce((G,ce)=>G+(ce.variable||0),0),me=F.reduce((G,ce)=>G+(ce.headcount||0),0),oe=Y.reduce((G,ce)=>G+(ce.variable||0),0),Z=Y.reduce((G,ce)=>G+(ce.headcount||0),0),Re=me?le/me:0,ke=Z?oe/Z:0,Ze=d?ee/d:0,ie=[],q=0,z={};z.headerStart=q;let fe=o||D;if(typeof o=="number"||!isNaN(Number(o))&&o){let G=Number(o);if(G>4e4&&G<6e4){let ce=new Date(1899,11,30);fe=new Date(ce.getTime()+G*24*60*60*1e3).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}}ie.push(["PAYROLL EXPENSE REVIEW"]),q++,ie.push([`Period: ${fe}`]),q++,ie.push([`Generated: ${N}`]),q++,ie.push([""]),q++,z.headerEnd=q-1,z.execSummaryStart=q,ie.push(["EXECUTIVE SUMMARY"]),q++,z.execSummaryHeader=q-1,ie.push([""]),q++,ie.push(["","Pay Date","Headcount","Fixed Salary","Variable Salary","Burden","Total Payroll","Burden Rate"]),q++,z.execSummaryColHeaders=q-1,ie.push(["Current Pay Period",a.label||a.key||"",d,ee,ye,Se,c,Ce]),q++,z.execSummaryCurrentRow=q-1,ie.push(["Same Period Prior Month",n.label||n.key||"",u,be,Fe,C,l,U]),q++,z.execSummaryPriorRow=q-1,ie.push([""]),q++,ie.push([""]),q++,z.execSummaryEnd=q-1,z.deptBreakdownStart=q,ie.push(["CURRENT PERIOD BREAKDOWN (DEPARTMENT)"]),q++,z.deptBreakdownHeader=q-1,ie.push([""]),q++,ie.push(["Payroll Date",a.label||a.key||""]),q++,ie.push([""]),q++,ie.push(["Department","Fixed Salary","Variable Salary","Gross Pay","Burden","All-In Total","% of Total","Headcount"]),q++,z.deptColHeaders=q-1;let Ct=[...R].sort((G,ce)=>(ce.allIn||0)-(G.allIn||0));if(z.deptDataStart=q,Ct.forEach(G=>{ie.push([G.name||"",G.fixed||0,G.variable||0,G.gross||0,G.burden||0,G.allIn||0,G.percent||0,G.headcount||0]),q++}),z.deptDataEnd=q-1,a.totalsRow){let G=a.totalsRow;ie.push(["TOTAL",G.fixed||0,G.variable||0,G.gross||0,G.burden||0,G.allIn||0,1,G.headcount||0]),q++,z.deptTotalsRow=q-1}ie.push([""]),q++,ie.push([""]),q++,z.deptBreakdownEnd=q-1,z.historicalStart=q,ie.push(["HISTORICAL CONTEXT"]),q++,z.historicalHeader=q-1,ie.push([`Visual comparison of current period vs. historical range (${r.length} periods). The dot (\u25CF) shows where you currently stand.`]),q++,ie.push([""]),q++;let De=G=>`$${Math.round(G/1e3)}K`,Ht=G=>`${(G*100).toFixed(1)}%`;ie.push(["","Metric","Low","Range","High","","Current","Average"]),q++,z.historicalColHeaders=q-1;let Sr=r.map(G=>{var ce;return((ce=G.summary)==null?void 0:ce.fixed)||0}).filter(G=>G>0),nn=r.map(G=>{var ce;return((ce=G.summary)==null?void 0:ce.variable)||0}),_a=r.map(G=>{let ce=G.summary||{};return ce.total?(ce.burden||0)/ce.total:0}),Wt=r.map(G=>{let ce=G.summary||{},Ae=ce.employeeCount||0;return Ae>0?(ce.fixed||0)/Ae:0}).filter(G=>G>0),nr=I(Sr,ee),fr=I(nn,ye),ur=I(_a,Ce),Pt=I(Wt,Ze);z.spectrumRows=[];let fi=pe(c,V.min,V.max,25);ie.push(["","Total Payroll",De(V.min),fi,De(V.max),"",De(c),De(V.avg)]),q++,z.spectrumRows.push(q-1);let sn=pe(ee,nr.min,nr.max,25);ie.push(["","Total Fixed Payroll",De(nr.min),sn,De(nr.max),"",De(ee),De(nr.avg)]),q++,z.spectrumRows.push(q-1);let on=pe(ye,fr.min,fr.max,25);ie.push(["","Total Variable Payroll",De(fr.min),on,De(fr.max),"",De(ye),De(fr.avg)]),q++,z.spectrumRows.push(q-1),ie.push([""]),q++;let cn=pe(Ze,Pt.min,Pt.max,25);ie.push(["","Avg Fixed Payroll / Employee",De(Pt.min),cn,De(Pt.max),"",De(Ze),De(Pt.avg)]),q++,z.spectrumRows.push(q-1);let ln=r.map(G=>{let Ae=(G.departments||[]).filter(je=>{let He=(je.name||"").toLowerCase();return He.includes("sales")||He.includes("marketing")}),Qe=Ae.reduce((je,He)=>je+(He.variable||0),0),vt=Ae.reduce((je,He)=>je+(He.headcount||0),0);return vt>0?Qe/vt:0}),Br=I(ln,Re),fn=r.map(G=>{let Ae=(G.departments||[]).filter(je=>{let He=(je.name||"").toLowerCase();return!He.includes("sales")&&!He.includes("marketing")}),Qe=Ae.reduce((je,He)=>je+(He.variable||0),0),vt=Ae.reduce((je,He)=>je+(He.headcount||0),0);return vt>0?Qe/vt:0}),qr=I(fn,ke);if(me>0){let G=pe(Re,Br.min,Br.max,25);ie.push(["","Avg Variable / Sales & Marketing",De(Br.min),G,De(Br.max),"",De(Re),`${me} emp`]),q++,z.spectrumRows.push(q-1)}if(Z>0){let G=pe(ke,qr.min,qr.max,25);ie.push(["","Avg Variable / Other Depts",De(qr.min),G,De(qr.max),"",De(ke),`${Z} emp`]),q++,z.spectrumRows.push(q-1)}ie.push([""]),q++;let ui=pe(Ce,ur.min,ur.max,25);ie.push(["","Burden Rate (%)",Ht(ur.min),ui,Ht(ur.max),"",Ht(Ce),Ht(ur.avg)]),q++,z.spectrumRows.push(q-1),ie.push([""]),q++,ie.push([""]),q++,z.historicalEnd=q-1,z.trendsStart=q,ie.push(["PERIOD TRENDS"]),q++,z.trendsHeader=q-1,ie.push([""]),q++,ie.push(["Pay Period","Total Payroll","Fixed Payroll","Variable Payroll","Burden","Headcount"]),q++,z.trendColHeaders=q-1;let Ea=r.slice(0,6).reverse();z.trendDataStart=q,Ea.forEach(G=>{let ce=G.summary||{};ie.push([G.label||G.key||"",ce.total||0,ce.fixed||0,ce.variable||0,ce.burden||0,ce.employeeCount||0]),q++}),z.trendDataEnd=q-1,ie.push([""]),q++,z.trendsEnd=q-1,z.chartStart=q;for(let G=0;G<15;G++)ie.push([""]),q++;z.payrollChartEnd=q-1,z.headcountChartStart=q;for(let G=0;G<12;G++)ie.push([""]),q++;z.headcountChartEnd=q-1,console.log("writeExpenseReviewSheet: Writing",ie.length,"rows");let ka=ie.map(G=>{let ce=Array.isArray(G)?G:[""];for(;ce.length<10;)ce.push("");return ce.slice(0,10)});try{let G=t.getRangeByIndexes(0,0,ka.length,10);G.values=ka,await e.sync()}catch(G){throw console.error("writeExpenseReviewSheet: Write failed",G),G}try{t.getRange("A:A").format.columnWidth=200,t.getRange("B:B").format.columnWidth=130,t.getRange("C:C").format.columnWidth=100,t.getRange("D:D").format.columnWidth=200,t.getRange("E:E").format.columnWidth=100,t.getRange("F:F").format.columnWidth=100,t.getRange("G:G").format.columnWidth=100,t.getRange("H:H").format.columnWidth=100,t.getRange("I:I").format.columnWidth=80,t.getRange("J:J").format.columnWidth=80,await e.sync();let G=t.getRange("A1");G.format.font.bold=!0,G.format.font.size=22,G.format.font.color="#1e293b",t.getRange("A2").format.font.size=11,t.getRange("A2").format.font.color="#64748b",t.getRange("A3").format.font.size=10,t.getRange("A3").format.font.color="#94a3b8",await e.sync();let ce=t.getRange(`A${z.execSummaryHeader+1}`);ce.format.font.bold=!0,ce.format.font.size=14,ce.format.font.color="#1e293b";let Ae=t.getRange(`A${z.execSummaryColHeaders+1}:H${z.execSummaryColHeaders+1}`);Ae.format.font.bold=!0,Ae.format.font.size=10,Ae.format.fill.color="#1e293b",Ae.format.font.color="#ffffff";let Qe=t.getRange(`A${z.execSummaryCurrentRow+1}:H${z.execSummaryCurrentRow+1}`);Qe.format.fill.color="#dcfce7",Qe.format.font.bold=!0;let vt=t.getRange(`A${z.execSummaryPriorRow+1}:H${z.execSummaryPriorRow+1}`);vt.format.fill.color="#f1f5f9";for(let ve of[z.execSummaryCurrentRow+1,z.execSummaryPriorRow+1])t.getRange(`C${ve}`).numberFormat=[["#,##0"]],t.getRange(`D${ve}`).numberFormat=[["$#,##0"]],t.getRange(`E${ve}`).numberFormat=[["$#,##0"]],t.getRange(`F${ve}`).numberFormat=[["$#,##0"]],t.getRange(`G${ve}`).numberFormat=[["$#,##0"]],t.getRange(`H${ve}`).numberFormat=[["0.00%"]];await e.sync();let je=t.getRange(`A${z.deptBreakdownHeader+1}`);je.format.font.bold=!0,je.format.font.size=14,je.format.font.color="#1e293b";let He=t.getRange(`A${z.deptColHeaders+1}:H${z.deptColHeaders+1}`);He.format.font.bold=!0,He.format.font.size=10,He.format.fill.color="#1e293b",He.format.font.color="#ffffff";for(let ve=z.deptDataStart;ve<=z.deptDataEnd;ve++){let ge=ve+1;t.getRange(`B${ge}`).numberFormat=[["$#,##0"]],t.getRange(`C${ge}`).numberFormat=[["$#,##0"]],t.getRange(`D${ge}`).numberFormat=[["$#,##0"]],t.getRange(`E${ge}`).numberFormat=[["$#,##0"]],t.getRange(`F${ge}`).numberFormat=[["$#,##0"]],t.getRange(`G${ge}`).numberFormat=[["0.00%"]],t.getRange(`H${ge}`).numberFormat=[["#,##0"]],(ve-z.deptDataStart)%2===1&&(t.getRange(`A${ge}:H${ge}`).format.fill.color="#f8fafc")}if(z.deptTotalsRow){let ve=t.getRange(`A${z.deptTotalsRow+1}:H${z.deptTotalsRow+1}`);ve.format.font.bold=!0,ve.format.fill.color="#1e293b",ve.format.font.color="#ffffff";let ge=z.deptTotalsRow+1;t.getRange(`B${ge}`).numberFormat=[["$#,##0"]],t.getRange(`C${ge}`).numberFormat=[["$#,##0"]],t.getRange(`D${ge}`).numberFormat=[["$#,##0"]],t.getRange(`E${ge}`).numberFormat=[["$#,##0"]],t.getRange(`F${ge}`).numberFormat=[["$#,##0"]],t.getRange(`G${ge}`).numberFormat=[["0%"]],t.getRange(`H${ge}`).numberFormat=[["#,##0"]]}await e.sync();let Jt=t.getRange(`A${z.historicalHeader+1}`);Jt.format.font.bold=!0,Jt.format.font.size=14,Jt.format.font.color="#1e293b",t.getRange(`A${z.historicalHeader+2}`).format.font.size=10,t.getRange(`A${z.historicalHeader+2}`).format.font.color="#64748b",t.getRange(`A${z.historicalHeader+2}`).format.font.italic=!0;let jt=t.getRange(`A${z.historicalColHeaders+1}:H${z.historicalColHeaders+1}`);jt.format.font.bold=!0,jt.format.font.size=10,jt.format.fill.color="#e2e8f0",jt.format.font.color="#334155",t.getRange(`C${z.historicalColHeaders+1}`).format.horizontalAlignment="Center",t.getRange(`E${z.historicalColHeaders+1}`).format.horizontalAlignment="Center",t.getRange(`G${z.historicalColHeaders+1}`).format.horizontalAlignment="Center",t.getRange(`H${z.historicalColHeaders+1}`).format.horizontalAlignment="Center",z.spectrumRows.forEach(ve=>{t.getRange(`D${ve+1}`).format.font.name="Consolas",t.getRange(`D${ve+1}`).format.font.size=14,t.getRange(`D${ve+1}`).format.font.color="#6366f1",t.getRange(`D${ve+1}`).format.horizontalAlignment="Center",t.getRange(`B${ve+1}`).format.font.color="#334155",t.getRange(`C${ve+1}`).format.font.color="#94a3b8",t.getRange(`C${ve+1}`).format.horizontalAlignment="Center",t.getRange(`E${ve+1}`).format.font.color="#94a3b8",t.getRange(`E${ve+1}`).format.horizontalAlignment="Center",t.getRange(`G${ve+1}`).format.font.bold=!0,t.getRange(`G${ve+1}`).format.font.color="#1e293b",t.getRange(`G${ve+1}`).format.horizontalAlignment="Center",t.getRange(`H${ve+1}`).format.font.color="#94a3b8",t.getRange(`H${ve+1}`).format.horizontalAlignment="Center"}),await e.sync();let Sa=t.getRange(`A${z.trendsHeader+1}`);Sa.format.font.bold=!0,Sa.format.font.size=14,Sa.format.font.color="#1e293b";let Zr=t.getRange(`A${z.trendColHeaders+1}:F${z.trendColHeaders+1}`);Zr.format.font.bold=!0,Zr.format.font.size=10,Zr.format.fill.color="#1e293b",Zr.format.font.color="#ffffff";for(let ve=z.trendDataStart;ve<=z.trendDataEnd;ve++){let ge=ve+1;t.getRange(`B${ge}`).numberFormat=[["$#,##0"]],t.getRange(`C${ge}`).numberFormat=[["$#,##0"]],t.getRange(`D${ge}`).numberFormat=[["$#,##0"]],t.getRange(`E${ge}`).numberFormat=[["$#,##0"]],t.getRange(`F${ge}`).numberFormat=[["#,##0"]],(ve-z.trendDataStart)%2===1&&(t.getRange(`A${ge}:F${ge}`).format.fill.color="#f8fafc")}if(await e.sync(),Ea.length>=2){try{let ve=t.getRange(`A${z.trendColHeaders+1}:E${z.trendDataEnd+1}`),ge=t.charts.add(Excel.ChartType.lineMarkers,ve,Excel.ChartSeriesBy.columns);ge.setPosition(`A${z.chartStart+1}`,`J${z.payrollChartEnd+1}`),ge.title.text="Payroll Expense Trends",ge.title.format.font.size=14,ge.title.format.font.bold=!0,ge.legend.position=Excel.ChartLegendPosition.bottom,ge.format.fill.setSolidColor("#ffffff"),ge.format.border.lineStyle=Excel.ChartLineStyle.continuous,ge.format.border.color="#e2e8f0";let Mr=ge.axes.getItem(Excel.ChartAxisType.category);Mr.categoryType=Excel.ChartAxisCategoryType.textAxis,Mr.setCategoryNames(t.getRange(`A${z.trendDataStart+1}:A${z.trendDataEnd+1}`)),await e.sync();let Gt=ge.series;Gt.load("count"),await e.sync();let _t=["#3b82f6","#22c55e","#f97316","#8b5cf6"];for(let g=0;g<Math.min(Gt.count,_t.length);g++){let _=Gt.getItemAt(g);_.format.line.color=_t[g],_.format.line.weight=2,_.markerStyle=Excel.ChartMarkerStyle.circle,_.markerSize=6,_.markerBackgroundColor=_t[g]}await e.sync(),console.log("writeExpenseReviewSheet: Payroll chart created successfully")}catch(ve){console.warn("writeExpenseReviewSheet: Payroll chart creation failed (non-critical)",ve)}try{let ve=t.getRange(`A${z.trendColHeaders+1}:F${z.trendDataEnd+1}`),ge=t.charts.add(Excel.ChartType.lineMarkers,ve,Excel.ChartSeriesBy.columns);ge.setPosition(`A${z.headcountChartStart+1}`,`J${z.headcountChartEnd+1}`),ge.title.text="Headcount Trend",ge.title.format.font.size=12,ge.title.format.font.bold=!0,ge.legend.visible=!1,ge.format.fill.setSolidColor("#ffffff"),ge.format.border.lineStyle=Excel.ChartLineStyle.continuous,ge.format.border.color="#e2e8f0";let Mr=ge.axes.getItem(Excel.ChartAxisType.category);Mr.categoryType=Excel.ChartAxisCategoryType.textAxis,Mr.setCategoryNames(t.getRange(`A${z.trendDataStart+1}:A${z.trendDataEnd+1}`)),await e.sync();let Gt=ge.series;Gt.load("count, items/name"),await e.sync();for(let _t=Gt.count-2;_t>=0;_t--)Gt.getItemAt(_t).delete();if(await e.sync(),Gt.load("count"),await e.sync(),Gt.count>0){let _t=Gt.getItemAt(0);_t.format.line.color="#64748b",_t.format.line.weight=2.5,_t.markerStyle=Excel.ChartMarkerStyle.circle,_t.markerSize=8,_t.markerBackgroundColor="#64748b"}await e.sync(),console.log("writeExpenseReviewSheet: Headcount chart created successfully")}catch(ve){console.warn("writeExpenseReviewSheet: Headcount chart creation failed (non-critical)",ve)}}t.freezePanes.freezeRows(z.execSummaryEnd+1),t.pageLayout.orientation=Excel.PageOrientation.landscape,t.getRange("A1").select(),await e.sync(),console.log("writeExpenseReviewSheet: Formatting applied successfully")}catch(G){console.warn("writeExpenseReviewSheet: Formatting error (non-critical)",G)}}function qg(e){var a;return!e||!e.length?!1:(((a=e[0].summary)==null?void 0:a.categories)||[]).some(n=>{let i=(n.name||"").toLowerCase();return i.includes("commission")||i.includes("bonus")||i.includes("variable")})}function Zg(e,t){var s;if(!e||t.length<2)return!1;let r=t.map(o=>{var c;return((c=o.summary)==null?void 0:c.total)||0}).filter(o=>o>0);if(r.length<2)return!1;let a=r.reduce((o,c)=>o+c,0)/r.length,n=((s=e.summary)==null?void 0:s.total)||0;return(a>0?n/a:1)<.9}async function Qg(e){if(!(!lt()||!e))try{await Excel.run(async t=>{let r=t.workbook.worksheets.getItemOrNullObject(e);r.load("name"),await t.sync(),!r.isNullObject&&(r.activate(),r.getRange("A1").select(),await t.sync())})}catch(t){console.warn(`Payroll Recorder: unable to activate worksheet ${e}`,t)}}async function si(){if(!lt()){Te.lastError="Excel runtime is unavailable.",Te.hasAnalyzed=!0,Te.loading=!1,Nt();return}Te.loading=!0,Te.lastError=null,Nt();try{let e=await Excel.run(async t=>{let r=t.workbook.worksheets.getItem("SS_Employee_Roster"),a=t.workbook.worksheets.getItem(he.DATA),n=r.getUsedRangeOrNullObject(),i=a.getUsedRangeOrNullObject();n.load("values"),i.load("values"),await t.sync();let s=n.isNullObject?[]:n.values||[],o=i.isNullObject?[]:i.values||[],c=tx(s),l=rx(o),f=[];c.employeeMap.forEach((u,m)=>{l.employeeMap.has(m)||f.push({name:u.name||"Unknown Employee",type:"missing_from_payroll",message:"In roster but NOT in payroll data",department:u.department||"\u2014"})}),l.employeeMap.forEach((u,m)=>{c.employeeMap.has(m)||f.push({name:u.name||"Unknown Employee",type:"missing_from_roster",message:"In payroll but NOT in roster",department:u.department||"\u2014"})}),f.sort((u,m)=>u.type!==m.type?u.type.localeCompare(m.type):(u.name||"").localeCompare(m.name||""));let h=[],d=0;return c.employeeMap.forEach((u,m)=>{let p=l.employeeMap.get(m);if(!p)return;let x=Ot(u.department),S=Ot(p.department);!x&&!S||(d+=1,x!==S&&h.push({employee:u.name||p.name||"Employee",rosterDept:x||"\u2014",payrollDept:S||"\u2014"}))}),console.log("Headcount Analysis Results:",{rosterCount:c.activeCount,payrollCount:l.totalEmployees,difference:c.activeCount-l.totalEmployees,missingFromPayroll:f.filter(u=>u.type==="missing_from_payroll").length,missingFromRoster:f.filter(u=>u.type==="missing_from_roster").length,deptMismatches:h.length}),{roster:{rosterCount:c.activeCount,payrollCount:l.totalEmployees,difference:c.activeCount-l.totalEmployees,mismatches:f},departments:{rosterCount:d,payrollCount:d,difference:h.length,mismatches:h}}});Te.roster=e.roster,Te.departments=e.departments,Te.hasAnalyzed=!0}catch(e){console.warn("Headcount Review: unable to analyze data",e),Te.lastError="Unable to analyze headcount data. Try re-running the analysis."}finally{Te.loading=!1,Nt()}}function wa(e={},{rerender:t=!0}={}){Object.assign(Le,e);let r=Number(Le.prDataTotal),a=Number(Le.cleanTotal);Le.reconDifference=Number.isFinite(r)&&Number.isFinite(a)?r-a:null;let n=_s(Le.bankAmount);Le.bankDifference=Number.isFinite(a)&&!Number.isNaN(n)?a-n:null,Le.plugEnabled=Le.bankDifference!=null&&Math.abs(Le.bankDifference)>=.5,t?Nt():ex()}function ex(){if(gt.activeStepId!==3)return;let e=(a,n)=>{let i=document.getElementById(a);i&&(i.value=n)};e("pr-data-total-value",Tt(Le.prDataTotal)),e("clean-total-value",Tt(Le.cleanTotal)),e("recon-diff-value",Tt(Le.reconDifference)),e("bank-clean-total-value",Tt(Le.cleanTotal)),e("bank-diff-value",Le.bankDifference!=null?Tt(Le.bankDifference):"---");let t=document.getElementById("bank-diff-hint");t&&(t.textContent=Le.bankDifference==null?"":Math.abs(Le.bankDifference)<.5?"Difference within acceptable tolerance.":"Difference exceeds tolerance and should be resolved.");let r=document.getElementById("bank-plug-btn");r&&(r.disabled=!Le.plugEnabled)}function ti(e={},{rerender:t=!0}={}){Object.assign(yr,e),t&&Nt()}async function oi(){if(!lt()){console.log("[DataClean] Excel runtime not available");return}try{await Excel.run(async t=>{let r=t.workbook.worksheets.getItemOrNullObject(he.DATA),a=t.workbook.worksheets.getItemOrNullObject(he.DATA_CLEAN);if(r.load("isNullObject"),a.load("isNullObject"),await t.sync(),r.isNullObject)return console.log("[DataClean] PR_Data sheet not found"),!1;if(a.isNullObject)return console.log("[DataClean] PR_Data_Clean sheet not found"),!1;let n=r.getUsedRangeOrNullObject();if(n.load("rowCount"),await t.sync(),n.isNullObject||n.rowCount<2)return console.log("[DataClean] PR_Data is empty, nothing to build"),!1;let i=a.getUsedRangeOrNullObject();i.load("rowCount"),await t.sync();let s=n.rowCount,o=i.isNullObject?0:i.rowCount;return o<2||o<s/2?(console.log(`[DataClean] PR_Data_Clean needs rebuild: ${o} clean rows vs ${s} data rows`),!0):(console.log(`[DataClean] PR_Data_Clean appears up to date: ${o} rows`),!1)})&&(console.log("[DataClean] Building PR_Data_Clean..."),Ke("Building PR_Data_Clean...","info",2e3),await xs(),console.log("[DataClean] PR_Data_Clean built successfully"))}catch(e){console.warn("[DataClean] Error checking/building PR_Data_Clean:",e)}}async function xs(){if(!lt()){wa({loading:!1,lastError:"Excel runtime is unavailable.",prDataTotal:null,cleanTotal:null});return}wa({loading:!0,lastError:null});try{let e="";await Excel.run(async r=>{let a=await _r(r);if(console.log("DEBUG - Config table found:",!!a),a){let n=a.getDataBodyRange();n.load("values"),await r.sync();let i=n.values||[];console.log("DEBUG - Config table rows:",i.length),console.log("DEBUG - Looking for payroll date aliases:",tn),console.log("DEBUG - CONFIG_COLUMNS.FIELD:",Ee.FIELD,"CONFIG_COLUMNS.VALUE:",Ee.VALUE);for(let s of i){let o=String(s[Ee.FIELD]||"").trim(),c=s[Ee.VALUE],l=tn.some(f=>o===f||xt(o)===xt(f));if((o.toLowerCase().includes("payroll")||o.toLowerCase().includes("date"))&&console.log("DEBUG - Potential date field:",o,"=",c,"| isMatch:",l),l){let f=s[Ee.VALUE];console.log("DEBUG - Found payroll date field!",o,"raw value:",f),e=ar(f)||"",console.log("DEBUG - Formatted payroll date:",e);break}}e||(console.warn("DEBUG - No payroll date found in config! Available fields:"),i.forEach((s,o)=>{console.log(`  Row ${o}: Field="${s[Ee.FIELD]}" Value="${s[Ee.VALUE]}"`)}))}else console.warn("DEBUG - Config table not found!")}),console.log("DEBUG prepareValidationData - Final Payroll Date:",e||"(empty)");let t=await Excel.run(async r=>{var O;let a=r.workbook.worksheets.getItem(he.DATA),n=r.workbook.worksheets.getItem(he.EXPENSE_MAPPING),i=r.workbook.worksheets.getItem(he.DATA_CLEAN),s=a.getUsedRangeOrNullObject(),o=n.getUsedRangeOrNullObject(),c=i.getUsedRangeOrNullObject();s.load("values"),o.load("values"),c.load(["address","rowCount"]),await r.sync();let l=s.isNullObject?[]:s.values||[],f=o.isNullObject?[]:o.values||[];console.log("DEBUG prepareValidationData - PR_Data rows:",l.length),console.log("DEBUG prepareValidationData - PR_Data headers:",l[0]),console.log("DEBUG prepareValidationData - PR_Expense_Mapping rows:",f.length);let h=((O=f[0])==null?void 0:O.map(A=>Kt(A)))||[],d=A=>h.findIndex(A),u={category:d(A=>A.includes("category")),accountNumber:d(A=>A.includes("account")&&(A.includes("number")||A.includes("#"))),accountName:d(A=>A.includes("account")&&A.includes("name")),expenseReview:d(A=>A.includes("expense")&&A.includes("review"))},m=new Map;f.slice(1).forEach(A=>{var V,j,se;let I=u.category>=0?ms(A[u.category]):"";I&&m.set(I,{accountNumber:u.accountNumber>=0&&(V=A[u.accountNumber])!=null?V:"",accountName:u.accountName>=0&&(j=A[u.accountName])!=null?j:"",expenseReview:u.expenseReview>=0&&(se=A[u.expenseReview])!=null?se:""})});let p=i.getRangeByIndexes(0,0,1,8);p.load("values"),await r.sync();let x=p.values[0]||[],S=x.map(A=>Kt(A));console.log("DEBUG prepareValidationData - PR_Data_Clean headers:",x),console.log("DEBUG prepareValidationData - PR_Data_Clean normalized:",S),console.log("DEBUG - PR_Data_Clean headers:",x),console.log("DEBUG - PR_Data_Clean normalized headers:",S);let y=S.findIndex(A=>(A.includes("payroll")||A.includes("period"))&&A.includes("date"));console.log("DEBUG - payrollDate column index:",y),y===-1&&(console.warn("DEBUG - No payroll date column found! Looking for header containing 'payroll'/'period' AND 'date'"),S.forEach((A,I)=>console.log(`  Col ${I}: "${A}"`)));let T={payrollDate:y,employee:S.findIndex(A=>A.includes("employee")),department:ya(S),payrollCategory:S.findIndex(A=>A.includes("payroll")&&A.includes("category")),accountNumber:S.findIndex(A=>A.includes("account")&&(A.includes("number")||A.includes("#"))),accountName:S.findIndex(A=>A.includes("account")&&A.includes("name")),amount:S.findIndex(A=>A.includes("amount")),expenseReview:S.findIndex(A=>A.includes("expense")&&A.includes("review"))};console.log("DEBUG prepareValidationData - fieldMap:",T);let D=x.length,N=[],K=0,b=0;if(l.length>=2){let A=l[0],I=A.map(ee=>Kt(ee));console.log("DEBUG prepareValidationData - Normalized headers:",I);let V=I.findIndex(ee=>ee.includes("employee")),j=ya(I);console.log("DEBUG prepareValidationData - Employee column index:",V,"searching for 'employee' in:",I[6]),console.log("DEBUG prepareValidationData - Department column index:",j);let se=m.size>0,pe=I.reduce((ee,ye,Se)=>{if(Se===V||Se===j||!ye||ye.includes("total")||ye.includes("gross")||ye.includes("date")||ye.includes("period"))return ee;let Xe=ms(A[Se]||ye);return se&&!m.has(Xe)||ee.push(Se),ee},[]);console.log("DEBUG prepareValidationData - Numeric columns:",pe.length,pe);for(let ee=1;ee<l.length;ee+=1){let ye=l[ee],Se=V>=0?Ot(ye[V]):"";if(!Se||Se.toLowerCase().includes("total"))continue;let Xe=j>=0&&ye[j]||"";pe.forEach(Ce=>{let be=ye[Ce],Fe=Number(be);if(!Number.isFinite(Fe)||Fe===0)return;K+=Fe;let C=A[Ce]||I[Ce]||`Column ${Ce+1}`,U=m.get(ms(C))||{};b+=Fe;let R=new Array(D).fill("");T.payrollDate>=0?R[T.payrollDate]=e:D>0&&(R[0]=e),N.length===0&&(console.log("DEBUG - Building first PR_Data_Clean row:"),console.log("  payrollDate value:",e),console.log("  fieldMap.payrollDate:",T.payrollDate),console.log("  Writing to column index:",T.payrollDate>=0?T.payrollDate:0)),T.employee>=0&&(R[T.employee]=Se),T.department>=0&&(R[T.department]=Xe),T.payrollCategory>=0&&(R[T.payrollCategory]=C),T.accountNumber>=0&&(R[T.accountNumber]=U.accountNumber||""),T.accountName>=0&&(R[T.accountName]=U.accountName||""),T.amount>=0&&(R[T.amount]=Fe),T.expenseReview>=0&&(R[T.expenseReview]=U.expenseReview||""),N.push(R)})}}if(console.log("DEBUG prepareValidationData - Clean rows generated:",N.length),console.log("DEBUG prepareValidationData - PR_Data total:",K,"Clean total:",b),console.log("DEBUG prepareValidationData - columnCount:",D,"cleanRange.address:",c.address),!c.isNullObject&&c.address){console.log("DEBUG prepareValidationData - Clearing data rows...");let A=Math.max(0,(c.rowCount||0)-1),I=Math.max(1,A);i.getRangeByIndexes(1,0,I,D).clear(),await r.sync(),console.log("DEBUG prepareValidationData - Data rows cleared")}if(console.log("DEBUG prepareValidationData - About to write",N.length,"rows with",D,"columns"),N.length>0){let A=i.getRangeByIndexes(1,0,N.length,D);A.values=N,console.log("DEBUG prepareValidationData - Data written to PR_Data_Clean")}else console.log("DEBUG prepareValidationData - No rows to write!");return await r.sync(),{prDataTotal:K,cleanTotal:b}});wa({loading:!1,lastError:null,prDataTotal:t.prDataTotal,cleanTotal:t.cleanTotal})}catch(e){console.warn("Validate & Reconcile: unable to prepare PR_Data_Clean",e),wa({loading:!1,prDataTotal:null,cleanTotal:null,lastError:"Unable to prepare reconciliation data. Try again."})}}function tx(e){let t={activeCount:0,departmentCount:0,employeeMap:new Map};if(!e||!e.length)return t;let{headers:r,dataStartIndex:a}=L0(e,["employee"]);if(!r.length||a==null)return t;let n=P0(r),i=r.findIndex(c=>c.includes("termination")),s=ya(r);if(n===-1)return t;let o=new Set;for(let c=a;c<e.length;c+=1){let l=e[c],f=l[n],h=O0(f);if(!h||D0(h))continue;let d=i>=0?l[i]:"",u=s>=0?l[s]:"";!Ot(d)&&!o.has(h)&&(o.add(h),t.activeCount+=1),u&&(t.departmentCount+=1),t.employeeMap.has(h)||t.employeeMap.set(h,{name:Ot(f)||h,department:Ot(u),termination:d})}return t}function rx(e){let t={totalEmployees:0,departmentCount:0,employeeMap:new Map};if(!e||!e.length)return t;let{headers:r,dataStartIndex:a}=L0(e,["employee"]);if(!r.length||a==null)return t;let n=P0(r),i=ya(r);if(n===-1)return t;let s=new Set;for(let o=a;o<e.length;o+=1){let c=e[o],l=c[n],f=O0(l);if(!f||D0(f))continue;s.has(f)||(s.add(f),t.totalEmployees+=1);let h=i>=0?c[i]:"";h&&(t.departmentCount+=1),t.employeeMap.has(f)||t.employeeMap.set(f,{name:Ot(l)||f,department:Ot(h)})}return t}function Kt(e){return Ot(e).toLowerCase()}function O0(e){return Ot(e).toLowerCase()}function P0(e=[]){let t=e.findIndex(a=>a.includes("employee")&&a.includes("name"));return t>=0?t:e.findIndex(a=>a.includes("employee"))}function L0(e,t=[]){let r=[],a=null;return(e||[]).some((n,i)=>{let s=(n||[]).map(Kt);return t.every(c=>s.some(l=>l.includes(c)))?(r=s,a=i,!0):!1}),{headers:r,dataStartIndex:a!=null?a+1:null}}function Ot(e){return e==null?"":String(e).trim()}function ms(e){return Ot(e).toLowerCase()}function ya(e=[]){let t=e.map((s,o)=>({idx:o,value:Kt(s)})),r=t.find(({value:s})=>s.includes("department")&&s.includes("description"));if(r)return console.log("DEBUG pickDepartmentIndex - Using 'Department Description' at index:",r.idx),r.idx;let a=t.find(({value:s})=>s.includes("department")&&s.includes("name"));if(a)return console.log("DEBUG pickDepartmentIndex - Using 'Department Name' at index:",a.idx),a.idx;let n=t.find(({value:s})=>s.includes("department")&&!s.includes("id")&&!s.includes("#")&&!s.includes("code")&&!s.includes("number"));if(n)return console.log("DEBUG pickDepartmentIndex - Using non-ID department at index:",n.idx),n.idx;let i=t.find(({value:s})=>s.includes("department"));return i&&console.log("DEBUG pickDepartmentIndex - Using fallback department at index:",i.idx),i?i.idx:-1}function _0(e,t,r={}){if(gs(),!t||!t.length)return;let a=document.createElement("div");a.className="pf-modal";let n=t.filter(c=>c.type==="missing_from_payroll"),i=t.filter(c=>c.type==="missing_from_roster"),s=t.filter(c=>!c.type),o="";if(n.length>0&&(o+=`
            <div class="pf-mismatch-section">
                <h4 class="pf-mismatch-heading pf-mismatch-warning">
                    <span class="pf-mismatch-icon">\u26A0\uFE0F</span>
                    In Roster but NOT in Payroll (${n.length})
                </h4>
                <p class="pf-mismatch-subtext">These employees appear in your centralized roster but were not found in the payroll data. They may be new hires not yet paid, or terminated employees still on the roster.</p>
                <div class="pf-mismatch-tiles">
                    ${n.map(c=>`
                        <div class="pf-mismatch-tile pf-mismatch-missing-payroll">
                            <span class="pf-mismatch-name">${de(c.name)}</span>
                            <span class="pf-mismatch-detail">${de(c.department)}</span>
                        </div>
                    `).join("")}
                </div>
            </div>
        `),i.length>0&&(o+=`
            <div class="pf-mismatch-section">
                <h4 class="pf-mismatch-heading pf-mismatch-alert">
                    <span class="pf-mismatch-icon">\u{1F534}</span>
                    In Payroll but NOT in Roster (${i.length})
                </h4>
                <p class="pf-mismatch-subtext">These employees appear in payroll data but are not in the centralized roster. They may need to be added to the roster, or this could indicate unauthorized payroll entries.</p>
                <div class="pf-mismatch-tiles">
                    ${i.map(c=>`
                        <div class="pf-mismatch-tile pf-mismatch-missing-roster">
                            <span class="pf-mismatch-name">${de(c.name)}</span>
                            <span class="pf-mismatch-detail">${de(c.department)}</span>
                        </div>
                    `).join("")}
                </div>
            </div>
        `),s.length>0){let c=r.formatter||(l=>typeof l=="string"?{name:l,source:"",isMissingFromTarget:!0}:l);o+=`
            <div class="pf-mismatch-section">
                <h4 class="pf-mismatch-heading">
                    <span class="pf-mismatch-icon">\u{1F4CB}</span>
                    ${de(r.label||e)} (${s.length})
                </h4>
                <div class="pf-mismatch-tiles">
                    ${s.map(l=>{let f=c(l);return`
                            <div class="pf-mismatch-tile">
                                <span class="pf-mismatch-name">${de(f.name||f.employee||"")}</span>
                                <span class="pf-mismatch-detail">${de(f.source||`${f.rosterDept||""} \u2192 ${f.payrollDept||""}`)}</span>
                            </div>
                        `}).join("")}
                </div>
            </div>
        `}o||(o='<p class="pf-mismatch-empty">No differences found.</p>'),a.innerHTML=`
        <div class="pf-modal-content pf-headcount-modal">
            <div class="pf-modal-header">
                <h3>${de(e)}</h3>
                <button type="button" class="pf-modal-close" data-modal-close>&times;</button>
            </div>
            <div class="pf-modal-body">
                ${o}
            </div>
            <div class="pf-modal-footer">
                <span class="pf-modal-summary">${t.length} total difference${t.length!==1?"s":""} found</span>
                <button type="button" class="pf-modal-close-btn" data-modal-close>Close</button>
            </div>
        </div>
    `,a.addEventListener("click",c=>{c.target===a&&gs()}),a.querySelectorAll("[data-modal-close]").forEach(c=>{c.addEventListener("click",gs)}),document.body.appendChild(a)}function gs(){var e;(e=document.querySelector(".pf-modal"))==null||e.remove()}function ri(){let e=document.getElementById("headcount-signoff-toggle");if(!e)return;e.disabled=!1,e.classList.remove("pf-needs-attention");let t=document.getElementById("headcount-notes-hint");t&&(t.textContent="")}function E0(){let e=document.getElementById("step-notes-input");if(!e)return;let t=e.value||"",r=t.startsWith(Zn)?t.slice(Zn.length).replace(/^\s+/,""):t.replace(new RegExp(`^${Zn}\\s*`,"i"),"").trimStart(),a=Zn+(r?`
${r}`:"");if(e.value!==a){e.value=a;let n=kr(2);n&&Ne(n.note,a)}}function k0(e){let t=e!=null&&e.target&&e.target instanceof HTMLInputElement?e.target:document.getElementById("bank-amount-input"),r=_s(t==null?void 0:t.value),a=I0(r);t&&(t.value=a),wa({bankAmount:r},{rerender:!1})}function B0(e){return e===6?null:()=>ax(e)}function ax(e){let t=lr.findIndex(a=>a.id===e);if(t===-1)return;let r=t+1;r<lr.length&&(ii(r),nx())}function nx(){let e=[document.querySelector(".pf-root"),document.querySelector(".pf-step-guide"),document.body];for(let t of e)t&&t.scrollTo({top:0,behavior:"smooth"});window.scrollTo({top:0,behavior:"smooth"})}window.handleArchiveClick=async function(){Ke("Starting archive process...","info",2e3);try{await M0()}catch(e){Ke("Archive failed: "+e.message,"error",8e3)}};async function M0(){if(console.log("[Archive] handleArchiveRun called"),!lt()){Ke("Excel runtime is unavailable.","error");return}if(!await vs(`This will:

\u2022 Download an Excel archive file
\u2022 Update PR_Archive_Summary
\u2022 Clear working data from all sheets
\u2022 Reset non-permanent notes & config

Make sure you've completed all review steps.`,{title:"Archive Payroll Run",icon:"\u{1F4E6}",confirmText:"Archive Now",cancelText:"Not Yet"})){console.log("[Archive] User cancelled"),Ke("Archive cancelled","info",2e3);return}console.log("[Archive] User confirmed, starting archive process...");try{if(console.log("[Archive] Step 1: Creating archive workbook..."),!await ix()){console.log("[Archive] Archive cancelled or failed");return}console.log("[Archive] Step 1 complete: Archive workbook created/user confirmed backup"),console.log("[Archive] Step 2: Updating PR_Archive_Summary..."),await ox(),console.log("[Archive] Step 2 complete: Archive summary updated"),console.log("[Archive] Step 3: Clearing working data..."),await cx(),console.log("[Archive] Step 3 complete: Working data cleared"),console.log("[Archive] Step 4: Clearing non-permanent notes..."),await lx(),console.log("[Archive] Step 4 complete: Notes cleared"),console.log("[Archive] Step 5: Resetting config values..."),await fx(),console.log("[Archive] Step 5 complete: Config reset"),console.log("[Archive] Archive workflow complete!"),await C0(),Nt(),Jm()}catch(t){console.error("[Archive] Error during archive:",t),Ke("Archive Error: "+t.message,"error",1e4)}}async function ix(){try{let t=`Payroll_Archive_${ci()||new Date().toISOString().split("T")[0]}.xlsx`;return console.log("[Archive] Creating Excel archive file..."),await Excel.run(async r=>{let n=r.workbook.worksheets;n.load("items/name"),await r.sync();let i=[he.JE_DRAFT,he.DATA_CLEAN,he.DATA,he.EXPENSE_REVIEW],s=zn.book_new(),o=0;for(let f of i){let h=n.items.find(u=>u.name===f);if(!h){console.log(`[Archive] Sheet not found: ${f}`);continue}let d=h.getUsedRangeOrNullObject();if(d.load("values"),await r.sync(),!d.isNullObject&&d.values&&d.values.length>0){let u=zn.aoa_to_sheet(d.values);zn.book_append_sheet(s,u,f),o++,console.log(`[Archive] Added sheet: ${f} (${d.values.length} rows)`)}}if(o===0)return Ke("No data to archive. Please complete the payroll workflow first.","error"),!1;let c=ns(s,{bookType:"xlsx",type:"array"}),l=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return sx(l,t),console.log(`[Archive] Downloaded: ${t} with ${o} sheets`),Ke(`\u{1F4E5} Archive downloaded: ${t} (${o} sheets)`,"success",5e3),!0})}catch(e){return console.error("[Archive] Error creating archive:",e),Ke("Archive Export Error: "+e.message,"error",8e3),await vs(`Archive download failed.

Do you want to continue with clearing the data?

Make sure you have saved a backup first!`)}}function sx(e,t){let r=URL.createObjectURL(e),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout(()=>URL.revokeObjectURL(r),100)}function ai(e){if(!e)return null;if(e instanceof Date)return isNaN(e.getTime())?null:e;if(typeof e=="number"&&e>1e3&&e<1e5)return N0(e);let t=String(e).trim();if(!t)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(t)){let[a,n,i]=t.split("-").map(Number);return new Date(a,n-1,i)}if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(t)){let[a,n,i]=t.split("/").map(Number);return new Date(i,a-1,n)}let r=new Date(t);return isNaN(r.getTime())?null:r}async function ox(){await Excel.run(async e=>{let t=e.workbook.worksheets.getItemOrNullObject(he.ARCHIVE_SUMMARY),r=e.workbook.worksheets.getItemOrNullObject(he.DATA_CLEAN);if(t.load("isNullObject"),r.load("isNullObject"),await e.sync(),t.isNullObject){console.warn("[Archive] PR_Archive_Summary not found - skipping");return}if(r.isNullObject){console.warn("[Archive] PR_Data_Clean not found - skipping");return}let a=r.getUsedRangeOrNullObject();if(a.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2){console.warn("[Archive] PR_Data_Clean is empty - skipping archive summary update");return}let n=a.values[0],i=a.values.slice(1),s=n.map(N=>String(N||"").toLowerCase().trim());console.log(`[Archive] PR_Data_Clean has ${i.length} rows to archive`);let o=s.findIndex(N=>N.includes("payroll")&&N.includes("date")||N.includes("pay period")||N==="date"),c=ci()||(o>=0&&i[0]?i[0][o]:""),l=ai(c),f=l?an(Object.assign(l,{_isUTC:!1})):String(c||"").trim();console.log(`[Archive] Current period date (raw): ${c}, normalized: ${f}`);let h=t.getUsedRangeOrNullObject();h.load("values,rowCount,columnCount"),await e.sync();let d=[],u=[];!h.isNullObject&&h.values&&h.values.length>0&&(d=h.values[0],u=h.values.slice(1));let m=d.map(N=>String(N||"").toLowerCase().trim()),p=s.length===m.length&&s.every((N,K)=>N===m[K]);if(d.length===0||!p){console.log("[Archive] Setting archive headers to match PR_Data_Clean"),d=n,u=[];let N=t.getRangeByIndexes(0,0,1,n.length);N.values=[n],await e.sync()}let x=m.findIndex(N=>N.includes("payroll")&&N.includes("date")||N.includes("pay period")||N==="date"),S=new Map;u.forEach(N=>{let K=x>=0?N[x]:"",b=ai(K),O=b?an(Object.assign(b,{_isUTC:!1})):String(K||"").trim();O&&(S.has(O)||S.set(O,[]),S.get(O).push(N))}),console.log(`[Archive] Found ${S.size} existing periods in archive`),f&&S.has(f)&&(console.log(`[Archive] Removing existing data for period: ${f}`),S.delete(f)),S.set(f||`period_${Date.now()}`,i);let y=5;if(console.log(`[Archive] Current period count: ${S.size}, max allowed: ${y}`),console.log(`[Archive] All periods: ${Array.from(S.keys()).join(", ")}`),S.size>y){let N=Array.from(S.keys()).sort((b,O)=>{let A=ai(b),I=ai(O);return console.log(`[Archive] Comparing dates: "${b}" (${A==null?void 0:A.getTime()}) vs "${O}" (${I==null?void 0:I.getTime()})`),A&&I?A.getTime()-I.getTime():String(b).localeCompare(String(O))});console.log(`[Archive] Sorted periods (oldest first): ${N.join(", ")}`),N.slice(0,S.size-y).forEach(b=>{console.log(`[Archive] Removing oldest period: ${b}`),S.delete(b)}),console.log(`[Archive] Remaining periods after removal: ${Array.from(S.keys()).join(", ")}`)}let T=Array.from(S.keys()).sort((N,K)=>{let b=new Date(N),O=new Date(K);return!isNaN(b)&&!isNaN(O)?O-b:K.localeCompare(N)}),D=[];if(T.forEach(N=>{let K=S.get(N);D.push(...K)}),console.log(`[Archive] Total rows to write: ${D.length} across ${S.size} periods`),!h.isNullObject&&h.rowCount>1&&(t.getRangeByIndexes(1,0,h.rowCount-1,d.length).clear(Excel.ClearApplyTo.contents),await e.sync()),D.length>0){let N=t.getRangeByIndexes(1,0,D.length,d.length);N.values=D,await e.sync()}console.log(`[Archive] Archive summary updated: ${D.length} rows, ${S.size} periods`),Ke(`Archive updated with ${D.length} rows across ${S.size} periods`,"success",4e3)})}async function cx(){let e=[he.DATA,he.DATA_CLEAN,he.EXPENSE_REVIEW,he.JE_DRAFT];await Excel.run(async t=>{for(let r of e){let a=t.workbook.worksheets.getItemOrNullObject(r);if(a.load("isNullObject"),await t.sync(),a.isNullObject){console.log(`[Archive] Sheet not found: ${r}`);continue}let n=a.getUsedRangeOrNullObject();if(n.load("rowCount,columnCount,address"),await t.sync(),n.isNullObject||n.rowCount<=1){console.log(`[Archive] Sheet empty or headers only: ${r}`);continue}if(a.getRange(`A2:${String.fromCharCode(64+n.columnCount)}${n.rowCount}`).clear(Excel.ClearApplyTo.contents),r===he.EXPENSE_REVIEW){let s=a.charts;s.load("items"),await t.sync();for(let o=s.items.length-1;o>=0;o--)s.items[o].delete()}await t.sync(),console.log(`[Archive] Cleared data from: ${r}`)}})}async function lx(){await Excel.run(async e=>{let t=await _r(e);if(!t){console.warn("[Archive] Config table not found");return}let r=t.getDataBodyRange();r.load("values,rowCount"),await e.sync();let a=r.values||[],n=0,i=Object.values(Or).map(s=>s.note);for(let s=0;s<a.length;s++){let o=String(a[s][Ee.FIELD]||"").trim(),c=String(a[s][Ee.PERMANENT]||"").toUpperCase();i.includes(o)&&c!=="Y"&&(r.getCell(s,Ee.VALUE).values=[[""]],n++)}await e.sync(),console.log(`[Archive] Cleared ${n} non-permanent notes`)})}async function fx(){let e=["PR_Payroll_Date","PR_Accounting_Period","PR_Journal_Entry_ID","Payroll_Date","Accounting_Period","Journal_Entry_ID","JE_Transaction_ID",...Object.values(Or).map(t=>t.signOff),...Object.values(Or).map(t=>t.reviewer),...Object.values(At)];await Excel.run(async t=>{let r=await _r(t);if(!r){console.warn("[Archive] Config table not found");return}let a=r.getDataBodyRange();a.load("values,rowCount"),await t.sync();let n=a.values||[],i=0;for(let s=0;s<n.length;s++){let o=String(n[s][Ee.FIELD]||"").trim(),c=String(n[s][Ee.PERMANENT]||"").toUpperCase();e.some(f=>xt(f)===xt(o))&&c!=="Y"&&(a.getCell(s,Ee.VALUE).values=[[""]],i++)}await t.sync(),console.log(`[Archive] Reset ${i} non-permanent config values`),Object.keys(Ye.values).forEach(s=>{e.some(o=>xt(o)===xt(s))&&(Ye.values[s]="")})})}async function ux(){if(!lt()){Ke("Excel runtime is unavailable.","error");return}Oe.loading=!0,Oe.lastError=null,T0(!1),Nt();try{let e=await Excel.run(async t=>{let r=t.workbook.worksheets.getItem(he.JE_DRAFT),a=t.workbook.worksheets.getItemOrNullObject(he.DATA_CLEAN),n=r.getUsedRangeOrNullObject();n.load("values"),a.load("name"),await t.sync();let i=n.isNullObject?[]:n.values||[];if(!i.length)throw new Error(`${he.JE_DRAFT} is empty.`);let s=(i[0]||[]).map(d=>Kt(d)),o=s.findIndex(d=>d.includes("debit")),c=s.findIndex(d=>d.includes("credit"));if(o===-1||c===-1)throw new Error("Debit/Credit columns not found in JE Draft.");let l=0,f=0;i.slice(1).forEach(d=>{l+=Number(d[o])||0,f+=Number(d[c])||0});let h=0;if(!a.isNullObject){let d=a.getUsedRangeOrNullObject();if(d.load("values"),await t.sync(),!d.isNullObject&&d.values&&d.values.length>1){let m=(d.values[0]||[]).map(p=>Kt(p)).findIndex(p=>p.includes("amount"));m>=0&&d.values.slice(1).forEach(p=>{h+=Number(p[m])||0})}}return{debitTotal:l,creditTotal:f,difference:f-l,cleanTotal:h}});Object.assign(Oe,e,{lastError:null})}catch(e){console.warn("JE summary:",e),Oe.lastError=(e==null?void 0:e.message)||"Unable to calculate journal totals.",Oe.debitTotal=null,Oe.creditTotal=null,Oe.difference=null,Oe.cleanTotal=null}finally{Oe.loading=!1,Nt()}}async function dx(){try{let e=Number.isFinite(Number(Oe.debitTotal))?Oe.debitTotal:"",t=Number.isFinite(Number(Oe.creditTotal))?Oe.creditTotal:"",r=Number.isFinite(Number(Oe.difference))?Oe.difference:"";await Promise.all([en(eg,String(e)),en(tg,String(t)),en(rg,String(r))]),T0(!0)}catch(e){console.error("JE save:",e)}}async function hx(){if(!lt()){Ke("Excel runtime is unavailable.","error");return}Oe.loading=!0,Oe.lastError=null,Nt();try{await Excel.run(async e=>{let t="",r="",a=await _r(e);if(a){let y=a.getDataBodyRange();y.load("values"),await e.sync();let T=y.values||[];for(let D of T){let N=String(D[Ee.FIELD]||"").trim(),K=D[Ee.VALUE];(N==="Journal_Entry_ID"||N==="JE_Transaction_ID"||N==="PR_Journal_Entry_ID")&&(t=String(K||"").trim()),tn.some(b=>N===b||xt(N)===xt(b))&&(r=ar(K)||"")}}console.log("JE Generation - RefNumber:",t,"TxnDate:",r);let n=e.workbook.worksheets.getItemOrNullObject(he.DATA_CLEAN);if(n.load("isNullObject"),await e.sync(),n.isNullObject)throw new Error("PR_Data_Clean sheet not found. Run Validate & Reconcile first.");let i=n.getUsedRangeOrNullObject();if(i.load("values"),await e.sync(),i.isNullObject)throw new Error("PR_Data_Clean is empty. Run Validate & Reconcile first.");let s=i.values||[];if(s.length<2)throw new Error("PR_Data_Clean has no data rows.");let o=s[0].map(y=>Kt(y));console.log("JE Generation - PR_Data_Clean headers:",o);let c={accountNumber:o.findIndex(y=>y.includes("account")&&(y.includes("number")||y.includes("#"))),accountName:o.findIndex(y=>y.includes("account")&&y.includes("name")),amount:o.findIndex(y=>y.includes("amount")),department:ya(o),payrollCategory:o.findIndex(y=>y.includes("payroll")&&y.includes("category")),employee:o.findIndex(y=>y.includes("employee"))};if(console.log("JE Generation - Column indices:",c),c.amount===-1)throw new Error("Amount column not found in PR_Data_Clean.");let l=new Map;for(let y=1;y<s.length;y++){let T=s[y],D=c.accountNumber>=0?String(T[c.accountNumber]||"").trim():"",N=c.accountName>=0?String(T[c.accountName]||"").trim():"",K=Number(T[c.amount])||0,b=c.department>=0?String(T[c.department]||"").trim():"";if(K===0)continue;let O=`${D}|${b}`;if(l.has(O)){let A=l.get(O);A.amount+=K}else l.set(O,{accountNumber:D,accountName:N,department:b,amount:K})}console.log("JE Generation - Aggregated into",l.size,"unique Account+Department combinations");let f=["RefNumber","TxnDate","Account Number","Account Name","LineAmount","Debit","Credit","LineDesc","Department"],h=[f],d=0,u=0,m=Array.from(l.values()).sort((y,T)=>{let D=String(y.accountNumber).localeCompare(String(T.accountNumber));return D!==0?D:String(y.department).localeCompare(String(T.department))});for(let y of m){let{accountNumber:T,accountName:D,department:N,amount:K}=y,b=K>0?K:0,O=K<0?Math.abs(K):0,A=[D,N].filter(Boolean).join(" - ");d+=b,u+=O,h.push([t,r,T,D,K,b||"",O||"",A,N])}console.log("JE Generation - Built",h.length-1,"summarized journal lines"),console.log("JE Generation - Total Debit:",d,"Total Credit:",u);let p=e.workbook.worksheets.getItemOrNullObject(he.JE_DRAFT);if(p.load("isNullObject"),await e.sync(),p.isNullObject)p=e.workbook.worksheets.add(he.JE_DRAFT),await e.sync();else{let y=p.getUsedRangeOrNullObject();y.load("address"),await e.sync(),y.isNullObject||(y.clear(),await e.sync())}let x=p.getRangeByIndexes(0,0,h.length,f.length);x.values=h,await e.sync();try{let y=h.length-1,T=p.getRange("A1:I1");f0(T),y>0&&(u0(p,1,y),qn(p,4,y),qn(p,5,y),qn(p,6,y)),p.getRange("A:I").format.autofitColumns(),await e.sync()}catch(y){console.warn("JE formatting error (non-critical):",y)}p.activate(),p.getRange("A1").select(),await e.sync();let S=0;for(let y=1;y<s.length;y++)S+=Number(s[y][c.amount])||0;Oe.debitTotal=d,Oe.creditTotal=u,Oe.difference=u-d,Oe.cleanTotal=S}),Oe.loading=!1,Oe.lastError=null,Nt()}catch(e){console.error("JE Generation failed:",e),Oe.loading=!1,Oe.lastError=e.message||"Failed to generate journal entry.",Nt()}}async function px(){if(!lt()){Ke("Excel runtime is unavailable.","error");return}try{let{rows:e}=await Excel.run(async r=>{let n=r.workbook.worksheets.getItem(he.JE_DRAFT).getUsedRangeOrNullObject();n.load("values"),await r.sync();let i=n.isNullObject?[]:n.values||[];if(!i.length)throw new Error(`${he.JE_DRAFT} is empty.`);return{rows:i}}),t=zg(e);Xg(`pr-je-draft-${rn()}.csv`,t)}catch(e){console.warn("JE export:",e),Ke("Unable to export the JE draft. Confirm the sheet has data.","error")}}async function mx(){let e=xe("SS_Accounting_Software");if(!e&&lt())try{await Excel.run(async t=>{let r=await _r(t);if(!r)return;let a=r.getDataBodyRange();a.load("values"),await t.sync();let n=a.values||[];for(let i of n){let s=String(i[Ee.FIELD]||"").trim();if(s==="SS_Accounting_Software"||xt(s)===xt("SS_Accounting_Software")){e=String(i[Ee.VALUE]||"").trim();break}}})}catch(t){console.warn("Error reading accounting software URL:",t)}if(!e){Ke("No accounting software URL configured. Add SS_Accounting_Software to SS_PF_Config.","info",5e3);return}!e.startsWith("http://")&&!e.startsWith("https://")&&(e="https://"+e),window.open(e,"_blank"),Ke("Opening accounting software...","success",2e3)}})();
/*! Bundled license information:

xlsx/xlsx.mjs:
  (*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com *)

xlsx/xlsx.mjs:
  (*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com *)
*/
//# sourceMappingURL=app.bundle.js.map
