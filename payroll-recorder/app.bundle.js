/* Prairie Forge Payroll Recorder */
(()=>{var Pd=Object.defineProperty;var Xl=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ld=(e,t)=>{for(var r in t)Pd(e,r,{get:t[r],enumerable:!0})};var Yn,Xs=Xl(()=>{Yn={COMPANY_NAME:"Prairie Forge LLC",PRODUCT_NAME:"Prairie Forge Tools",SUPPORT_URL:"https://prairieforge.ai/support",ADA_IMAGE_URL:"https://assets.prairieforge.ai/storage/v1/object/public/Other%20Public%20Material/Prairie%20Forge/Ada%20Image.png"}});var ql={};Ld(ql,{DEFAULT_OPTIONS:()=>qi,bindCopilotCard:()=>Ks,createExcelContextProvider:()=>Js,renderCopilotCard:()=>Zi});function Zi(e={}){var a,n;let t={...qi,...e},r=((a=t.quickActions)==null?void 0:a.map(s=>`<option value="${Jd(s.prompt)}">${s.label}</option>`).join(""))||"";return`
        <article class="pf-ada" data-copilot="${t.id}">
            <div class="pf-ada-search-bar">
                <img class="pf-ada-avatar-inline" src="${Kd}" alt="Ada" onerror="this.style.display='none'" />
                <input 
                    type="text" 
                    class="pf-ada-input-inline" 
                    id="${t.id}-prompt" 
                    placeholder="Ask Ada" 
                    autocomplete="off"
                >
                <button type="button" class="pf-ada-send-inline" id="${t.id}-ask" title="Send">
                    ${Yd}
                </button>
            </div>
            
            ${r?`
            <div class="pf-ada-suggestions">
                <button type="button" class="pf-ada-suggestions-toggle" id="${t.id}-suggestions-toggle">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    <span>Need Inspiration?</span>
                    <svg class="pf-ada-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"/>
                    </svg>
                </button>
                <div class="pf-ada-suggestions-dropdown" id="${t.id}-suggestions-dropdown">
                    <select class="pf-ada-suggestions-select" id="${t.id}-suggestions-select" size="${Math.min(((n=t.quickActions)==null?void 0:n.length)||4,6)}">
                        ${r}
                    </select>
                </div>
            </div>
            `:""}
            
            <div class="pf-ada-conversation" id="${t.id}-messages" style="display: none;">
            </div>
            
            <div class="pf-ada-status-bar">
                <div class="pf-ada-status-indicator">
                    <span class="pf-ada-status-dot" id="${t.id}-status-dot"></span>
                    <span class="pf-ada-status-text" id="${t.id}-status-text">Ready</span>
                </div>
                <div class="pf-ada-powered">
                    ${Xd}
                    <span>GPT-4 Turbo</span>
                </div>
            </div>
        </article>
    `}function Jd(e){return String(e||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ks(e,t={}){let r={...qi,...t},a=e.querySelector(`[data-copilot="${r.id}"]`);if(!a)return;let n=a.querySelector(`#${r.id}-messages`),s=a.querySelector(`#${r.id}-prompt`),i=a.querySelector(`#${r.id}-ask`),o=a.querySelector(`#${r.id}-status-dot`),l=a.querySelector(`#${r.id}-status-text`),c=a.querySelector(`#${r.id}-suggestions-toggle`),f=a.querySelector(`#${r.id}-suggestions-dropdown`),d=a.querySelector(`#${r.id}-suggestions-select`),h=!1,p=(x,b="ready")=>{o&&(o.classList.remove("pf-ada-status-dot--busy","pf-ada-status-dot--offline"),b==="busy"&&o.classList.add("pf-ada-status-dot--busy"),b==="offline"&&o.classList.add("pf-ada-status-dot--offline")),l&&(l.textContent=x)},m=(x,b="assistant")=>{if(!n)return;let C=b==="user"?"pf-ada-bubble--user":b==="system"?"pf-ada-bubble--system":"pf-ada-bubble--ai",w=document.createElement("div");w.className=`pf-ada-bubble ${C}`,w.innerHTML=`<p>${v(x)}</p>`,n.appendChild(w),n.scrollTop=n.scrollHeight,Ji.push({role:b,content:x,timestamp:new Date().toISOString()})},u=()=>{if(!n)return;let x=document.createElement("div");x.className="pf-ada-bubble pf-ada-bubble--ai pf-ada-bubble--loading",x.id=`${r.id}-loading`,x.innerHTML=`
            <div class="pf-ada-typing">
                <span></span><span></span><span></span>
            </div>
        `,n.appendChild(x),n.scrollTop=n.scrollHeight},g=()=>{let x=document.getElementById(`${r.id}-loading`);x&&x.remove()},v=x=>String(x).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n\n/g,"</p><p>").replace(/\n- /g,"<br>\u2022 ").replace(/\n/g,"<br>"),y=async x=>{let b=x||(s==null?void 0:s.value.trim());if(!(!b||h)){h=!0,s&&(s.value=""),i&&(i.disabled=!0),n&&n.style.display==="none"&&(n.style.display="flex"),m(b,"user"),u(),p("Analyzing...","busy");try{let C=null;if(typeof r.contextProvider=="function")try{C=await r.contextProvider()}catch(_){console.warn("CoPilot: Context provider failed",_)}let w;typeof r.onPrompt=="function"?w=await r.onPrompt(b,C,Ji):typeof r.apiEndpoint=="string"?w=await qd(r.apiEndpoint,b,C,r.systemPrompt):w=Zd(b,C),g(),m(w,"assistant"),p("Ready to assist","ready")}catch(C){console.error("CoPilot error:",C),g(),m(`I encountered an issue: ${C.message}. Please try again.`,"system"),p("Error occurred","offline")}h=!1,i&&(i.disabled=!1),s==null||s.focus()}};i==null||i.addEventListener("click",()=>y()),s==null||s.addEventListener("keydown",x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),y())}),c&&f&&c.addEventListener("click",()=>{f.classList.contains("is-open")?(f.classList.remove("is-open"),c.classList.remove("is-active")):(f.classList.add("is-open"),c.classList.add("is-active"))}),d&&(d.addEventListener("change",()=>{let x=d.value;x&&(s&&(s.value=x),f&&(f.classList.remove("is-open"),c==null||c.classList.remove("is-active")),s==null||s.focus())}),d.addEventListener("dblclick",()=>{let x=d.value;x&&(f&&(f.classList.remove("is-open"),c==null||c.classList.remove("is-active")),y(x))}))}async function qd(e,t,r,a){let n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:t,context:r,systemPrompt:a,history:Ji.slice(-10)})});if(!n.ok)throw new Error(`API request failed: ${n.status}`);let s=await n.json();return s.message||s.response||"No response received."}function Zd(e,t){var a,n,s;let r=e.toLowerCase();return r.includes("diagnostic")||r.includes("check")?`Great question! Let me run through the diagnostics for you.

**\u2713 What Looks Good:**
\u2022 All required fields are populated
\u2022 Current period matches your config date
\u2022 All expense categories are mapped to GL accounts

**\u26A0\uFE0F Items Worth Reviewing:**
\u2022 2 departments show >15% variance from prior period
\u2022 Burden rate (14.6%) is slightly below your historical average (16.2%)

**My Recommendations:**
1. Take a closer look at the Sales & Marketing variance (-44.4%)
2. Verify headcount changes align with HR records
3. Once satisfied, you're clear to proceed to Journal Entry Prep!

Let me know if you'd like me to dig deeper into any of these.`:r.includes("insight")||r.includes("notable")||r.includes("finding")?`Here's what stands out this period \u2014 perfect for your executive summary.

**\u{1F4CA} The Headlines:**
\u2022 Total Payroll: ${(a=t==null?void 0:t.summary)!=null&&a.total?`$${(t.summary.total/1e3).toFixed(0)}K`:"$254K"}
\u2022 Headcount: ${((n=t==null?void 0:t.summary)==null?void 0:n.employeeCount)||38} employees
\u2022 Avg Cost/Employee: ${(s=t==null?void 0:t.summary)!=null&&s.avgPerEmployee?`$${t.summary.avgPerEmployee.toFixed(0)}`:"$6,674"}

**\u{1F4A1} Key Findings:**
1. **Payroll decreased 14.2%** \u2014 primarily driven by headcount reduction in Sales
2. **R&D remains your largest cost center** at 39% of total payroll
3. **Burden rate normalized** to 14.6% (was 18.2% prior period)

**\u26A0\uFE0F Items to Flag:**
\u2022 Sales & Marketing down $52K \u2014 worth confirming this was intentional
\u2022 2 fewer employees than prior period

**Suggested Talking Points:**
\u2022 "Payroll efficiency improved with 14% reduction while maintaining core operations"
\u2022 "R&D investment remains strong \u2014 aligned with product roadmap"

Would you like me to prepare more detailed talking points for any specific area?`:r.includes("variance")||r.includes("change")||r.includes("difference")?`**Variance Analysis: Current vs Prior Period**

\u{1F4C8} **Significant Changes**:

| Department | Change | % Change | Driver |
|------------|--------|----------|--------|
| Sales & Marketing | -$52,298 | -44.4% | \u{1F534} Headcount |
| Research & Dev | +$8,514 | +9.4% | Merit increases |
| General & Admin | +$1,610 | +3.9% | Normal variance |

\u{1F50D} **Root Cause Analysis**:

**Sales & Marketing (-44.4%)**:
\u2022 3 positions eliminated per restructuring plan
\u2022 Commission payouts lower due to Q4 timing
\u2022 \u26A0\uFE0F Verify: Is this aligned with sales targets?

**R&D (+9.4%)**:
\u2022 Annual merit increases effective this period
\u2022 1 new senior engineer hire
\u2022 \u2713 Expected per hiring plan

**Recommendation**: Document Sales variance in review notes. This is material and will be questioned.`:r.includes("journal")||r.includes("je")||r.includes("entry")?`Good news \u2014 your journal entry looks ready to go! Here's the full check:

**\u2713 Balance Check: PASSED**
\u2022 Total Debits: $253,625
\u2022 Total Credits: $253,625
\u2022 Difference: $0.00 \u2014 perfectly balanced!

**\u2713 Mapping Validation: Complete**
\u2022 9 unique GL accounts used
\u2022 All department codes are valid

**\u2713 Reference Data:**
\u2022 JE ID: PR-AUTO-2025-11-27
\u2022 Transaction Date: 2025-11-27
\u2022 Period: November 2025

**You're clear to export!** \u2705

**Next Steps:**
1. Click "Export" to download the CSV
2. Import into your accounting system
3. Post and reconcile

Let me know if you need me to double-check anything before you export!`:`Great question! I'm Ada, and I'm here to help with your payroll analysis.

Here's what I can help you with:

\u2022 **\u{1F50D} Diagnostics** \u2014 Check data quality and completeness
\u2022 **\u{1F4A1} Insights** \u2014 Key findings for executive review  
\u2022 **\u{1F4CA} Variance Analysis** \u2014 Period-over-period changes
\u2022 **\u{1F4CB} JE Readiness** \u2014 Validate journal entries before export

Try clicking one of the quick action buttons above, or just ask me something specific like:
\u2022 "What's driving the variance this period?"
\u2022 "Is my data ready for the CFO?"
\u2022 "Summarize the department breakdown"

I'm reading your actual spreadsheet data, so I can give you specific answers!`}function Js(e={}){return async()=>{if(typeof Excel=="undefined")return null;try{return await Excel.run(async t=>{var s;let r={},a=t.workbook.worksheets.getItemOrNullObject(e.dataClean||"PR_Data_Clean");if(a.load("isNullObject"),await t.sync(),!a.isNullObject){let i=a.getUsedRangeOrNullObject();i.load("values, rowCount"),await t.sync(),!i.isNullObject&&((s=i.values)==null?void 0:s.length)>1&&(r.rowCount=i.rowCount-1,r.dataAvailable=!0)}let n=t.workbook.worksheets.getItemOrNullObject(e.config||"SS_PF_Config");return n.load("isNullObject"),await t.sync(),n.isNullObject||(r.configAvailable=!0),{timestamp:new Date().toISOString(),summary:r}})}catch(t){return console.warn("CoPilot: Failed to read Excel context",t),null}}}var Xd,Yd,Kd,qi,Ji,Qi=Xl(()=>{Xs();Xd='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.8956zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z"/></svg>',Yd='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>',Kd=Yn.ADA_IMAGE_URL,qi={id:"pf-copilot",heading:"Ada",subtext:"Your smart assistant to help you analyze and troubleshoot.",welcomeMessage:"What would you like to explore?",placeholder:"Where should I focus this pay period?",quickActions:[{id:"diagnostics",label:"Diagnostics",prompt:"Run a diagnostic check on the current payroll data. Check for completeness, accuracy issues, and any data quality concerns."},{id:"insights",label:"Insights",prompt:"What are the key insights and notable findings from this payroll period that I should highlight for executive review?"},{id:"variance",label:"Variances",prompt:"Analyze the significant variances between this period and the prior period. What's driving the changes?"},{id:"journal",label:"JE Check",prompt:"Is the journal entry ready for export? Check that debits equal credits and flag any mapping issues."}],systemPrompt:`You are Prairie Forge CoPilot, an expert financial analyst assistant embedded in an Excel add-in. 

Your role is to help accountants and CFOs:
1. Analyze payroll expense data for accuracy and completeness
2. Identify trends, anomalies, and areas requiring attention
3. Prepare executive-ready insights and talking points
4. Validate journal entries before export

Communication style:
- Be concise but thorough
- Use bullet points for clarity
- Highlight actionable items with \u26A0\uFE0F or \u2713
- Format currency as $X,XXX and percentages as X.X%
- Always suggest 2-3 concrete next steps

When analyzing data, look for:
- Period-over-period changes > 10%
- Department cost anomalies
- Headcount vs payroll mismatches
- Burden rate outliers
- Missing or incomplete mappings`},Ji=[]});var Yl="750d641",Fe={CONFIG:"SS_PF_Config",DATA_CLEAN:"PR_Data_Clean",EXPENSE_MAPPING:"PR_Expense_Mapping",EXPENSE_REVIEW:"PR_Expense_Review",JE_DRAFT:"PR_JE_Draft",ARCHIVE_SUMMARY:"PR_Archive_Summary",ARCHIVE_TOTALS:"PR_Archive_Totals"};var pS=[{name:"Instructions",description:"How to use the Prairie Forge payroll template"},{name:"Data_Input",description:"Paste WellsOne export data here"},{name:Fe.CONFIG,description:"Prairie Forge shared configuration storage (all modules)"},{name:"Config_Keywords",description:"Keyword-based account mapping rules"},{name:"Config_Accounts",description:"Account rewrite rules"},{name:"Config_Locations",description:"Location normalization rules"},{name:"Config_Vendors",description:"Vendor-specific overrides"},{name:"Config_Settings",description:"Prairie Forge system settings"},{name:Fe.EXPENSE_MAPPING,description:"Expense category mappings"},{name:Fe.DATA,description:"Processed payroll data staging"},{name:Fe.DATA_CLEAN,description:"Cleaned and validated payroll data"},{name:Fe.EXPENSE_REVIEW,description:"Expense review workspace"},{name:Fe.JE_DRAFT,description:"Journal entry preparation area"},{name:Fe.ARCHIVE_TOTALS,description:"Historical payroll totals by department and period"}];var zs=[{id:0,title:"Configuration Setup",summary:"Company profile, branding, and run settings",description:"Keep the SS_PF_Config table current before every payroll run so downstream sheets inherit the right colors, links, and identifiers.",icon:"\u{1F9ED}",ctaLabel:"Open Configuration Form",statusHint:"Configuration edits happen inside the PF_Config table and are available to every step instantly.",highlights:[{label:"Company Profile",detail:"Company name, logos, payroll date, reporting period."},{label:"Brand Identity",detail:"Primary + accent colors carry through dashboards and exports."},{label:"System Links",detail:"Quick jumps to HRIS, payroll provider, accounting import, and archive folders."}],checklist:["Review profile, branding, links, and run settings each payroll cycle.","Click Save to write updates back to the SS_PF_Config sheet."]},{id:1,title:"Upload & Validate",summary:"Import payroll data, create matrix, and run validation checks",description:"Upload your payroll data, auto-map columns, create the data matrix (PR_Data_Clean), and run advisory validation checks including bank reconciliation and payroll coverage.",icon:"\u{1F4E5}",ctaLabel:"Upload & Validate",statusHint:"Upload file, create matrix, review validation checks (advisory).",highlights:[{label:"Upload & Map",detail:"Drop your payroll file and auto-map columns to standard fields."},{label:"Create Matrix",detail:"Generate PR_Data_Clean with normalized, mapped data."},{label:"Validation",detail:"Bank reconciliation + payroll coverage checks (advisory, non-blocking)."}],checklist:["Download the payroll detail export covering this pay period.","Upload file (we auto-detect and map columns).","Resolve any ambiguous mappings, then click 'Create Matrix'.","Review bank reconciliation and payroll coverage (advisory)."]},{id:2,title:"Expense Review",summary:"Generate an executive-ready payroll summary",description:"Build a six-period payroll dashboard (current + five prior), including department-level breakouts and variance indicators, plus notes and CoPilot guidance.",icon:"\u{1F4CA}",statusHint:"Selecting this step rebuilds PR_Expense_Review automatically.",highlights:[{label:"Time Series",detail:"Shows six consecutive payroll periods."},{label:"Departments",detail:"All-in totals, burden rates, and headcount by department."},{label:"Guidance",detail:"Use CoPilot to summarize trends and capture review notes."}],checklist:[]},{id:3,title:"Journal Entry Prep",summary:"Generate a QuickBooks-ready journal draft",description:"Create the JE Draft sheet with the headers QuickBooks Online/Desktop expect so you only need to paste balanced lines.",icon:"\u{1F9FE}",ctaLabel:"Generate JE Draft",statusHint:"JE Draft contains headers for RefNumber, TxnDate, account columns, and line descriptions.",highlights:[{label:"Structure",detail:"Debit/Credit columns prepared with standard import headers."},{label:"Context",detail:"JE Transaction ID from configuration is referenced for traceability."},{label:"Next Step",detail:"Populate amounts from Expense Review to finalize the journal."}],checklist:["Ensure validation + expense review steps are complete.","Run the generator to rebuild the JE Draft sheet.","Paste balanced lines and export to QuickBooks / ERP import format."]},{id:4,title:"Archive & Clear",summary:"Snapshot workpapers and reset working tabs",description:"Capture a log of each payroll run, note the archive destination, and optionally clear staging sheets for the next cycle.",icon:"\u{1F5C2}\uFE0F",ctaLabel:"Create Archive Summary",statusHint:"Archive summary headers help you log when data was exported and where the files live.",highlights:[{label:"Run Log",detail:"Payroll date, reporting period, JE ID, and who processed the run."},{label:"Storage",detail:"Link to the Archive folder defined in configuration."},{label:"Reset",detail:"Reminder to clear Data/Data_Clean once files are safely archived."}],checklist:["Record archive destination links and reviewer approvals.","Copy Data/Data_Clean/JE Draft tabs to the archive workbook if needed.","Clear sensitive data so the template is ready for the next payroll."]}],hS=(typeof window!="undefined"&&Array.isArray(window.PF_BUILDER_ALLOWLIST)?window.PF_BUILDER_ALLOWLIST:[]).map(e=>String(e||"").trim().toLowerCase());Xs();function dn(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}function Kl(e){try{Office.onReady(t=>{console.log("Office.onReady fired:",t),t.host===Office.HostType.Excel||console.warn("Not running in Excel, host:",t.host),e(t)})}catch(t){console.warn("Office.onReady failed:",t),e(null)}}var $d="SS_PF_Config",Md="module-prefix",Bd="system",Ki="module-selector",Ud="SS_Homepage",Hd=["SS_Employee_Roster","SS_Chart_of_Accounts","SS_PF_Config"],pn={PR_:"payroll-recorder",PTO_:"pto-accrual",CC_:"credit-card-expense",COM_:"commission-calc",SS_:"system"};async function Jl(){if(!dn())return{...pn};try{return await Excel.run(async e=>{var f,d;let t=e.workbook.worksheets.getItemOrNullObject($d);if(await e.sync(),t.isNullObject)return console.log("[Tab Visibility] Config sheet not found, using defaults"),{...pn};let r=t.getUsedRangeOrNullObject();if(r.load("values"),await e.sync(),r.isNullObject||!((f=r.values)!=null&&f.length))return{...pn};let a=r.values,n=Wd(a[0]),s=n.get("category"),i=n.get("field"),o=n.get("value");if(s===void 0||i===void 0||o===void 0)return console.warn("[Tab Visibility] Missing required columns, using defaults"),{...pn};let l={},c=!1;for(let h=1;h<a.length;h++){let p=a[h];if(va(p[s])===Md){let u=String((d=p[i])!=null?d:"").trim().toUpperCase(),g=va(p[o]);u&&g&&(l[u]=g,c=!0)}}return c?(console.log("[Tab Visibility] Loaded prefix config:",l),l):(console.log("[Tab Visibility] No module-prefix rows found, using defaults"),{...pn})})}catch(e){return console.warn("[Tab Visibility] Error reading prefix config:",e),{...pn}}}async function Ys(e){var r;if(!dn())return;let t=va(e);console.log(`[Tab Visibility] Applying visibility for module: ${t}`);try{let a=await Jl(),n=Object.keys(a).map(o=>String(o!=null?o:"").trim().toUpperCase()).filter(Boolean).sort((o,l)=>l.length-o.length),s=Gd(a),i=t===va(Ki)?null:(r=s[t])!=null?r:null;if(t!==va(Ki)&&!i){console.warn(`[Tab Visibility] No active prefix found for moduleKey="${t}". Skipping visibility changes.`);return}await Excel.run(async o=>{let l=o.workbook.worksheets;l.load("items/name,visibility"),await o.sync();let c=[],f=[],d=[],h=[];l.items.forEach(u=>{let g=u.name,v=g.toUpperCase(),y=!1,x=!1,b=Hd.some(C=>v===C.toUpperCase());if(t===va(Ki))v===Ud.toUpperCase()?y=!0:x=!0;else{let C=zd(v,n);C&&(C===i?y=!0:x=!0),b&&(y=!1,x=!0)}y?(c.push(u),console.log(`[Tab Visibility] SHOW: ${g}`),d.push(g)):x?(f.push(u),console.log(`[Tab Visibility] HIDE: ${g}`),h.push(g)):console.log(`[Tab Visibility] SKIP: ${g} (no prefix match)`)});for(let u of c)u.visibility=Excel.SheetVisibility.visible;if(await o.sync(),l.items.filter(u=>u.visibility===Excel.SheetVisibility.visible).filter(u=>!f.includes(u)).length>=1){for(let u of f)try{u.visibility=Excel.SheetVisibility.hidden}catch(g){console.warn(`[Tab Visibility] Could not hide "${u.name}":`,g.message)}await o.sync()}else console.warn("[Tab Visibility] Skipping hide - would leave no visible sheets");console.log(`[Tab Visibility] Done! Showed ${c.length}, hid ${f.length} tabs`),console.log("[Tab Visibility] Summary:",{moduleKey:t,activePrefix:i,shownSheets:d,hiddenSheets:h})})}catch(a){console.warn("[Tab Visibility] Error applying visibility:",a)}}async function Vd(){if(!dn()){console.log("Excel not available");return}try{await Excel.run(async e=>{let t=e.workbook.worksheets;t.load("items/name,visibility"),await e.sync();let r=0;t.items.forEach(a=>{a.visibility!==Excel.SheetVisibility.visible&&(a.visibility=Excel.SheetVisibility.visible,console.log(`[ShowAll] Made visible: ${a.name}`),r++)}),await e.sync(),console.log(`[ShowAll] Done! Made ${r} sheets visible. Total: ${t.items.length}`)})}catch(e){console.error("[Tab Visibility] Unable to show all sheets:",e)}}async function jd(){if(!dn()){console.log("Excel not available");return}try{let e=await Jl(),t=[];for(let[r,a]of Object.entries(e))a===Bd&&t.push(r);await Excel.run(async r=>{let a=r.workbook.worksheets;a.load("items/name,visibility"),await r.sync(),a.items.forEach(n=>{let s=n.name.toUpperCase();t.some(i=>s.startsWith(i))&&(n.visibility=Excel.SheetVisibility.visible,console.log(`[Unhide] Made visible: ${n.name}`))}),await r.sync(),console.log("[Unhide] System sheets are now visible!")})}catch(e){console.error("[Tab Visibility] Unable to unhide system sheets:",e)}}function Wd(e=[]){let t=new Map;return e.forEach((r,a)=>{let n=va(r);n&&t.set(n,a)}),t}function va(e){return String(e!=null?e:"").trim().toLowerCase().replace(/[\s_]+/g,"-")}function Gd(e){let t={};for(let[r,a]of Object.entries(e!=null?e:{})){let n=String(r!=null?r:"").trim().toUpperCase(),s=va(a);!n||!s||t[s]||(t[s]=n)}return t}function zd(e,t){for(let r of t)if(e.startsWith(r))return r;return null}async function hn(e){if(!dn())return!1;try{return await Excel.run(async t=>{let r=t.workbook.worksheets.getItemOrNullObject(e);return await t.sync(),r.isNullObject?(console.warn(`[Tab Visibility] Sheet "${e}" not found`),!1):(r.visibility=Excel.SheetVisibility.visible,r.activate(),await t.sync(),console.log(`[Tab Visibility] Showed and activated: ${e}`),!0)}),!0}catch(t){return console.error(`[Tab Visibility] Error showing sheet "${e}":`,t),!1}}typeof window!="undefined"&&(window.PrairieForge=window.PrairieForge||{},window.PrairieForge.showAllSheets=Vd,window.PrairieForge.unhideSystemSheets=jd,window.PrairieForge.applyModuleTabVisibility=Ys,window.PrairieForge.showAndActivateSheet=hn);Qi();Xs();var rc=Yn.ADA_IMAGE_URL,Qd="https://jgciqwzwacaesqjaoadc.supabase.co",Zl="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE";async function Ql(e,t,r){let a=`${Qd}/functions/v1/copilot`;try{console.log("[Ada Popup] Calling copilot API...");let n=await fetch(a,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Zl}`,apikey:Zl},body:JSON.stringify({prompt:e,context:t,module:"general",function:"analysis",history:(r==null?void 0:r.slice(-10))||[]})});if(!n.ok){let i=await n.text();throw console.error("[Ada Popup] API error:",n.status,i),new Error(`API request failed: ${n.status}`)}let s=await n.json();return console.log("[Ada Popup] API response received"),s.message||s.response?s.message||s.response:"I received your question but couldn't generate a response. Please try again."}catch(n){return console.error("[Ada Popup] API call failed:",n),`I'm having trouble connecting right now. Error: ${n.message}. Please try again in a moment.`}}async function to(e,t,r){if(typeof Excel=="undefined"){console.warn("Excel runtime not available for homepage sheet");return}try{await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject(e);n.load("isNullObject, name, visibility"),await a.sync();let s;n.isNullObject?(s=a.workbook.worksheets.add(e),await a.sync(),await ec(a,s,t,r)):(s=n,s.visibility!==Excel.SheetVisibility.visible&&(s.visibility=Excel.SheetVisibility.visible,await a.sync()),await ec(a,s,t,r)),s.activate(),s.getRange("A1").select(),await a.sync()})}catch(a){console.error(`Error activating homepage sheet ${e}:`,a)}}async function ec(e,t,r,a){try{let c=t.getUsedRangeOrNullObject();c.load("isNullObject"),await e.sync(),c.isNullObject||(c.clear(),await e.sync())}catch{}t.showGridlines=!1,t.getRange("A:A").format.columnWidth=400,t.getRange("B:B").format.columnWidth=50,t.getRange("1:1").format.rowHeight=60,t.getRange("2:2").format.rowHeight=30;let n=[[r,""],[a,""],["",""],["",""]],s=t.getRangeByIndexes(0,0,4,2);s.values=n;let i=t.getRange("A1:Z100");i.format.fill.color="#0f0f0f";let o=t.getRange("A1");o.format.font.bold=!0,o.format.font.size=36,o.format.font.color="#ffffff",o.format.font.name="Segoe UI Light",o.format.verticalAlignment="Center";let l=t.getRange("A2");l.format.font.size=14,l.format.font.color="#a0a0a0",l.format.font.name="Segoe UI",l.format.verticalAlignment="Top",t.freezePanes.freezeRows(0),t.freezePanes.freezeColumns(0),await e.sync()}var tc={"module-selector":{sheetName:"SS_Homepage",title:"ForgeSuite",subtitle:"Select a module from the side panel to get started."},"payroll-recorder":{sheetName:"PR_Homepage",title:"Payroll Recorder",subtitle:"Normalize payroll exports, enforce controls, and prep journal entries without leaving Excel."},"pto-accrual":{sheetName:"PTO_Homepage",title:"PTO Accrual",subtitle:"Calculate employee PTO liabilities, compare period-over-period changes, and prepare accrual journal entries."}};function ro(e){return tc[e]||tc["module-selector"]}function ac(){ao();let e=document.createElement("button");return e.className="pf-ada-fab",e.id="pf-ada-fab",e.setAttribute("aria-label","Ask Ada"),e.setAttribute("title","Ask Ada"),e.innerHTML=`
        <span class="pf-ada-fab__ring"></span>
        <img 
            class="pf-ada-fab__image" 
            src="${rc}" 
            alt="Ada - Your AI Assistant"
            onerror="this.style.display='none'"
        />
    `,document.body.appendChild(e),e.addEventListener("click",tp),e}function ao(){let e=document.getElementById("pf-ada-fab");e&&e.remove();let t=document.getElementById("pf-ada-modal-overlay");t&&t.remove()}function ep(){let e,t,r,a=async()=>{try{let s=await Promise.resolve().then(()=>(Qi(),ql));e=s.renderCopilotCard,t=s.bindCopilotCard,r=s.createExcelContextProvider}catch(s){console.warn("Could not load copilot functions:",s)}};return{subtext:"Your AI-powered assistant",copilotHtml:"",bindFunction:async()=>{if(await a(),e&&t){let s=document.getElementById("ada-modal-copilot");s&&(s.innerHTML=e({id:"ada-modal-copilot",heading:"Ada",subtext:"Ask questions about your data",welcomeMessage:"Hi! I'm Ada, your AI assistant. How can I help you today?",placeholder:"Ask about your data, analysis, or insights...",quickActions:[{id:"help",label:"What can you do?",prompt:"What kinds of questions can you help me with? What data do you have access to?"},{id:"overview",label:"Data Overview",prompt:"Give me an overview of the data available in this workbook."},{id:"tips",label:"Best Practices",prompt:"What are some best practices for using this tool effectively?"}],contextProvider:r?r({config:"SS_PF_Config"}):null,onPrompt:Ql}),setTimeout(()=>{t(s,{id:"ada-modal-copilot",contextProvider:r?r({config:"SS_PF_Config"}):null,onPrompt:Ql})},200))}}}}function tp(){let e=document.getElementById("pf-ada-modal-overlay");e&&e.remove();let t=ep(),r=document.createElement("div");r.className="pf-ada-modal-overlay",r.id="pf-ada-modal-overlay",r.innerHTML=`
        <div class="pf-ada-modal pf-ada-modal--chat">
            <div class="pf-ada-modal__header">
                <button class="pf-ada-modal__close" id="ada-modal-close" aria-label="Close">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <img class="pf-ada-modal__avatar" src="${rc}" alt="Ada" />
                <h2 class="pf-ada-modal__title">Ask Ada <span class="pf-ada-beta-tag">BETA</span></h2>
                <p class="pf-ada-modal__subtitle">${t.subtext}</p>
            </div>
            <div class="pf-ada-modal__body">
                <div class="pf-ada-copilot-container" id="ada-modal-copilot">
                    <div class="pf-ada-loading">
                        <div class="pf-ada-typing"><span></span><span></span><span></span></div>
                        <p>Loading Ada...</p>
                    </div>
                </div>
            </div>
        </div>
    `,document.body.appendChild(r),requestAnimationFrame(()=>{r.classList.add("is-visible")});let a=document.getElementById("ada-modal-close");a==null||a.addEventListener("click",eo),r.addEventListener("click",s=>{s.target===r&&eo()});let n=s=>{s.key==="Escape"&&(eo(),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n),t.bindFunction&&t.bindFunction()}function eo(){let e=document.getElementById("pf-ada-modal-overlay");e&&(e.classList.remove("is-visible"),setTimeout(()=>{e.remove()},300))}var rp=["January","February","March","April","May","June","July","August","September","October","November","December"],sc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ap=["Su","Mo","Tu","We","Th","Fr","Sa"],cr=null,Mr=null;function ic(e,t={}){let r=document.getElementById(e);if(!r)return;let{onChange:a=null,minDate:n=null,maxDate:s=null,readonly:i=!1}=t,o=r.closest(".pf-datepicker-wrapper");o||(o=document.createElement("div"),o.className="pf-datepicker-wrapper",r.parentNode.insertBefore(o,r),o.appendChild(r)),r.type="text",r.placeholder="Select date...",r.classList.add("pf-datepicker-input"),r.readOnly=!0;let l=r.value?nc(r.value):null;l&&(r.value=so(l),r.dataset.value=Kn(l));let c=o.querySelector(".pf-datepicker-icon");c||(c=document.createElement("span"),c.className="pf-datepicker-icon",c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>',o.appendChild(c));let f={inputId:e,input:r,selectedDate:l,viewDate:l?new Date(l):new Date,onChange:a,minDate:n,maxDate:s};function d(){i||(Mr=f,np())}return r.addEventListener("click",d),c.addEventListener("click",d),{getValue:()=>f.selectedDate?Kn(f.selectedDate):"",setValue:h=>{let p=nc(h);f.selectedDate=p,f.viewDate=p?new Date(p):new Date,p?(r.value=so(p),r.dataset.value=Kn(p)):(r.value="",r.dataset.value="")},open:d,close:qs}}function np(){Mr&&(cr||(cr=document.createElement("div"),cr.className="pf-datepicker-modal",cr.id="pf-datepicker-modal",document.body.appendChild(cr)),lc(),requestAnimationFrame(()=>{cr.classList.add("is-open")}),document.addEventListener("keydown",oc))}function qs(){cr&&cr.classList.remove("is-open"),document.removeEventListener("keydown",oc),Mr=null}function oc(e){e.key==="Escape"&&qs()}function lc(){if(!cr||!Mr)return;let{viewDate:e,selectedDate:t,minDate:r,maxDate:a}=Mr,n=e.getFullYear(),s=e.getMonth();cr.innerHTML=`
        <div class="pf-datepicker-backdrop"></div>
        <div class="pf-datepicker-container">
            <div class="pf-datepicker-header">
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="prev-year" title="Previous Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="11 17 6 12 11 7"/><polyline points="18 17 13 12 18 7"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="prev-month" title="Previous Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                    </button>
                </div>
                <span class="pf-datepicker-title">${rp[s]} ${n}</span>
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="next-month" title="Next Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="next-year" title="Next Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="13 17 18 12 13 7"/><polyline points="6 17 11 12 6 7"/></svg>
                    </button>
                </div>
            </div>
            <div class="pf-datepicker-weekdays">
                ${ap.map(i=>`<span>${i}</span>`).join("")}
            </div>
            <div class="pf-datepicker-days">
                ${op(n,s,t,r,a)}
            </div>
            <div class="pf-datepicker-footer">
                <button type="button" class="pf-datepicker-btn pf-datepicker-today" data-action="today">Today</button>
                <button type="button" class="pf-datepicker-btn pf-datepicker-clear" data-action="clear">Clear</button>
            </div>
        </div>
    `,sp()}function sp(){var e;cr&&((e=cr.querySelector(".pf-datepicker-backdrop"))==null||e.addEventListener("click",qs),cr.querySelectorAll(".pf-datepicker-nav").forEach(t=>{t.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation();let a=t.dataset.action;ip(a)})}),cr.querySelectorAll(".pf-datepicker-day:not(.disabled)").forEach(t=>{t.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation();let a=parseInt(t.dataset.day),n=parseInt(t.dataset.month),s=parseInt(t.dataset.year);no(new Date(s,n,a))})}),cr.querySelectorAll(".pf-datepicker-btn").forEach(t=>{t.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation();let a=t.dataset.action;a==="today"?no(new Date):a==="clear"&&no(null)})}))}function ip(e){if(!Mr)return;let t=Mr.viewDate;switch(e){case"prev-year":t.setFullYear(t.getFullYear()-1);break;case"prev-month":t.setMonth(t.getMonth()-1);break;case"next-month":t.setMonth(t.getMonth()+1);break;case"next-year":t.setFullYear(t.getFullYear()+1);break}lc()}function no(e){if(!Mr)return;let{input:t,onChange:r}=Mr;Mr.selectedDate=e,e?(t.value=so(e),t.dataset.value=Kn(e),Mr.viewDate=new Date(e)):(t.value="",t.dataset.value=""),r&&r(e?Kn(e):""),t.dispatchEvent(new Event("change",{bubbles:!0})),qs()}function op(e,t,r,a,n){let s=new Date(e,t,1).getDay(),i=new Date(e,t+1,0).getDate(),o=new Date(e,t,0).getDate(),l=new Date;l.setHours(0,0,0,0),r&&(r=new Date(r),r.setHours(0,0,0,0));let c="";for(let p=s-1;p>=0;p--){let m=o-p,u=t===0?11:t-1,g=t===0?e-1:e;c+=`<button type="button" class="pf-datepicker-day other-month" data-day="${m}" data-month="${u}" data-year="${g}">${m}</button>`}for(let p=1;p<=i;p++){let m=new Date(e,t,p);m.setHours(0,0,0,0);let u=m.getTime()===l.getTime(),g=r&&m.getTime()===r.getTime(),v="pf-datepicker-day";u&&(v+=" today"),g&&(v+=" selected");let y=!1;a&&m<a&&(y=!0),n&&m>n&&(y=!0),y&&(v+=" disabled"),c+=`<button type="button" class="${v}" data-day="${p}" data-month="${t}" data-year="${e}" ${y?"disabled":""}>${p}</button>`}let f=42,d=s+i,h=f-d;for(let p=1;p<=h;p++){let m=t===11?0:t+1,u=t===11?e+1:e;c+=`<button type="button" class="pf-datepicker-day other-month" data-day="${p}" data-month="${m}" data-year="${u}">${p}</button>`}return c}function nc(e){if(!e)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[a,n,s]=e.split("-").map(Number);return new Date(a,n-1,s)}let t=e.match(/^(\w+)\s+(\d+),\s+(\d{4})$/);if(t){let a=sc.findIndex(n=>n.toLowerCase()===t[1].toLowerCase().substring(0,3));if(a>=0)return new Date(parseInt(t[3]),a,parseInt(t[2]))}if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e)){let[a,n,s]=e.split("/").map(Number);return new Date(s,a-1,n)}let r=new Date(e);return isNaN(r.getTime())?null:r}function so(e){return e?`${sc[e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`:""}function Kn(e){if(!e)return"";let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`}var lp="pf.routeState.v1";function cp(e){return`${lp}.${e}`}function io(e,t,r={}){let a={route:t,params:r,ts:Date.now()};try{localStorage.setItem(cp(e),JSON.stringify(a)),console.debug(`[RouterState] Saved: ${t}`,r)}catch(n){console.warn("[RouterState] Failed to save route state",n)}}function oo(e,t,r){let a=e.replace("-recorder","").replace("-","/");switch(t){case"config":return`${a}/config`;case"step":return`${a}/step/${r}`;case"home":default:return`${a}/home`}}var cs={};cs.version="0.18.5";var Qr=1200,Sn=1252,fp=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Po={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Lo=function(e){fp.indexOf(e)!=-1&&(Sn=Po[0]=e)};function up(){Lo(1252)}var Ur=function(e){Qr=e,Lo(e)};function $o(){Ur(1200),up()}function bo(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function dp(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function x0(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Zn=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?dp(e.slice(2)):t==254&&r==255?x0(e.slice(2)):t==65279?e.slice(1):e},Zs=function(t){return String.fromCharCode(t)},cc=function(t){return String.fromCharCode(t)},st;var At=null,Jn=!0,_a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function fs(e){for(var t="",r=0,a=0,n=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,a=e.charCodeAt(c++),i=(r&3)<<4|a>>4,n=e.charCodeAt(c++),o=(a&15)<<2|n>>6,l=n&63,isNaN(a)?o=l=64:isNaN(n)&&(l=64),t+=_a.charAt(s)+_a.charAt(i)+_a.charAt(o)+_a.charAt(l);return t}function br(e){var t="",r=0,a=0,n=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=_a.indexOf(e.charAt(c++)),i=_a.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=_a.indexOf(e.charAt(c++)),a=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(a)),l=_a.indexOf(e.charAt(c++)),n=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(n));return t}var Xe=(function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node})(),fa=(function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ea(e){return Xe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function fc(e){return Xe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var wr=function(t){return Xe?fa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ei(e){if(typeof ArrayBuffer=="undefined")return wr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Ca(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function pp(e){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(e)}function Mo(e){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Mo(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Xt=Xe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:fa(t)}))}:function(e){if(typeof Uint8Array!="undefined"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function hp(e){for(var t=[],r=0,a=e.length+250,n=Ea(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|o>>6&15|(i&3)<<4,n[r++]=128|o&63}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|i&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Ea(65535),a=65530)}return t.push(n.slice(0,r)),Xt(t)}var nr=/\u0000/g,Qn=/[\u0001-\u0006]/g;function wn(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Hr(e,t){var r=""+e;return r.length>=t?r:Ct("0",t-r.length)+r}function Bo(e,t){var r=""+e;return r.length>=t?r:Ct(" ",t-r.length)+r}function ci(e,t){var r=""+e;return r.length>=t?r:r+Ct(" ",t-r.length)}function mp(e,t){var r=""+Math.round(e);return r.length>=t?r:Ct("0",t-r.length)+r}function gp(e,t){var r=""+e;return r.length>=t?r:Ct("0",t-r.length)+r}var uc=Math.pow(2,32);function mn(e,t){if(e>uc||e<-uc)return mp(e,t);var r=Math.round(e);return gp(r,t)}function fi(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var dc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],lo=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function xp(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},pc={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},vp={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ui(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,i=1,o=0,l=1,c=0,f=0,d=Math.floor(n);c<t&&(d=Math.floor(n),o=d*i+s,f=d*c+l,!(n-d<5e-8));)n=1/(n-d),s=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=s):(f=c,o=i)),!r)return[0,a*o,f];var h=Math.floor(a*o/f);return[h,a*o-h*f,f]}function Ma(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,i=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),a<60&&(s=(s+6)%7),r&&(s=kp(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var v0=new Date(1899,11,31,0,0,0),yp=v0.getTime(),_p=new Date(1900,2,1,0,0,0);function y0(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=_p&&(r+=1440*60*1e3),(r-(yp+(e.getTimezoneOffset()-v0.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Uo(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function wp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Ep(e){var t=e<0?12:11,r=Uo(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function bp(e){var t=Uo(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function us(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Ep(e):t===10?r=e.toFixed(10).substr(0,12):r=bp(e),Uo(wp(r.toUpperCase()))}function ja(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):us(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Nr(14,y0(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function kp(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Sp(e,t,r,a){var n="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return lo[r.m-1][1];case 5:return lo[r.m-1][0];default:return lo[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return dc[r.q][0];default:return dc[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Hr(r.S,t.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(n=Hr(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Hr(l,c):"";return f}function wa(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var _0=/%/g;function Cp(e,t,r){var a=t.replace(_0,""),n=t.length-a.length;return ia(e,a,r*Math.pow(10,2*n))+Ct("%",n)}function Tp(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ia(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function w0(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+w0(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var E0=/# (\?+)( ?)\/( ?)(\d+)/;function Ap(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),i=n-s*a,o=a;return r+(s===0?"":""+s)+" "+(i===0?Ct(" ",e[1].length+1+e[4].length):Bo(i,e[1].length)+e[2]+"/"+e[3]+Hr(o,e[4].length))}function Rp(e,t,r){return r+(t===0?"":""+t)+Ct(" ",e[1].length+2+e[4].length)}var b0=/^#*0*\.([0#]+)/,k0=/\).*[0#]/,S0=/\(###\) ###\\?-####/;function fr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function hc(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function mc(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function Ip(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Fp(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Tr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(k0)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tr("n",a,r):"("+Tr("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Tp(e,t,r);if(t.indexOf("%")!==-1)return Cp(e,t,r);if(t.indexOf("E")!==-1)return w0(t,r);if(t.charCodeAt(0)===36)return"$"+Tr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+mn(l,t.length);if(t.match(/^[#?]+$/))return n=mn(r,0),n==="0"&&(n=""),n.length>t.length?n:fr(t.substr(0,t.length-n.length))+n;if(s=t.match(E0))return Ap(s,l,c);if(t.match(/^#+0+$/))return c+mn(l,t.length-t.indexOf("0"));if(s=t.match(b0))return n=hc(r,s[1].length).replace(/^([^\.]+)$/,"$1."+fr(s[1])).replace(/\.$/,"."+fr(s[1])).replace(/\.(\d*)$/,function(m,u){return"."+u+Ct("0",fr(s[1]).length-u.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+hc(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+wa(mn(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tr(e,t,-r):wa(""+(Math.floor(r)+Ip(r,s[1].length)))+"."+Hr(mc(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Tr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=wn(Tr(e,t.replace(/[\\-]/g,""),r)),i=0,wn(wn(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<n.length?n.charAt(i++):m==="0"?"0":""}));if(t.match(S0))return n=Tr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=ui(l,Math.pow(10,i)-1,!1),n=""+c,f=ia("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=ci(o[2],i),f.length<s[4].length&&(f=fr(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=ui(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bo(o[1],i)+s[2]+"/"+s[3]+ci(o[2],i):Ct(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=mn(r,0),t.length<=n.length?n:fr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var d=t.indexOf(".")-i,h=t.length-n.length-d;return fr(t.substr(0,d)+n+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=mc(r,s[1].length),r<0?"-"+Tr(e,t,-r):wa(Fp(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Hr(0,3-m.length):"")+m})+"."+Hr(i,s[1].length);switch(t){case"###,##0.00":return Tr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=wa(mn(l,0));return p!=="0"?c+p:"";case"###,###.00":return Tr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tr(e,"#,##0.00",r).replace(/^0\./,".");default:}throw new Error("unsupported format |"+t+"|")}function Dp(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ia(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Np(e,t,r){var a=t.replace(_0,""),n=t.length-a.length;return ia(e,a,r*Math.pow(10,2*n))+Ct("%",n)}function C0(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+C0(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(k0)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jr("n",a,r):"("+Jr("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Dp(e,t,r);if(t.indexOf("%")!==-1)return Np(e,t,r);if(t.indexOf("E")!==-1)return C0(t,r);if(t.charCodeAt(0)===36)return"$"+Jr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Hr(l,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:fr(t.substr(0,t.length-n.length))+n;if(s=t.match(E0))return Rp(s,l,c);if(t.match(/^#+0+$/))return c+Hr(l,t.length-t.indexOf("0"));if(s=t.match(b0))return n=(""+r).replace(/^([^\.]+)$/,"$1."+fr(s[1])).replace(/\.$/,"."+fr(s[1])),n=n.replace(/\.(\d*)$/,function(m,u){return"."+u+Ct("0",fr(s[1]).length-u.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+wa(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):wa(""+r)+"."+Ct("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Jr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=wn(Jr(e,t.replace(/[\\-]/g,""),r)),i=0,wn(wn(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<n.length?n.charAt(i++):m==="0"?"0":""}));if(t.match(S0))return n=Jr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=ui(l,Math.pow(10,i)-1,!1),n=""+c,f=ia("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=ci(o[2],i),f.length<s[4].length&&(f=fr(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=ui(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bo(o[1],i)+s[2]+"/"+s[3]+ci(o[2],i):Ct(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:fr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var d=t.indexOf(".")-i,h=t.length-n.length-d;return fr(t.substr(0,d)+n+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):wa(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Hr(0,3-m.length):"")+m})+"."+Hr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=wa(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return Jr(e,t.slice(0,t.lastIndexOf(".")),r)+fr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ia(e,t,r){return(r|0)===r?Jr(e,t,r):Tr(e,t,r)}function Op(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var T0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Rn(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":fi(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(T0))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Pp(e,t,r,a){for(var n=[],s="",i=0,o="",l="t",c,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!fi(e,i))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);n[n.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),m=p==="("||p===")"?p:"t";n[n.length]={t:m,v:p},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=Ma(t,r,e.charAt(i+1)==="2"),c==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Ma(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),n[n.length]={t:o,v:s},l=o;break;case"A":case"a":case"\u4E0A":var u={t:o,v:o};if(c==null&&(c=Ma(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(u.v=c.H>=12?"P":"A"),u.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(u.v=c.H>=12?"PM":"AM"),u.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(u.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),u.t="T",i+=5,h="h"):(u.t="t",++i),c==null&&u.t==="T")return"";n[n.length]=u,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(T0)){if(c==null&&(c=Ma(t,r),c==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Rn(e)||(n[n.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;n[n.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++i;break}var g=0,v=0,y;for(i=n.length-1,l="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=h,l="h",g<1&&(g=1);break;case"s":(y=n[i].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=n[i].t;break;case"m":l==="s"&&(n[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[i].v.match(/[Hh]/)&&(g=1),g<2&&n[i].v.match(/[Mm]/)&&(g=2),g<3&&n[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",b;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=Sp(n[i].t.charCodeAt(0),n[i].v,c,v),n[i].t="t";break;case"n":case"?":for(b=i+1;n[b]!=null&&((o=n[b].t)==="?"||o==="D"||(o===" "||o==="t")&&n[b+1]!=null&&(n[b+1].t==="?"||n[b+1].t==="t"&&n[b+1].v==="/")||n[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[b].v==="/"||n[b].v===" "&&n[b+1]!=null&&n[b+1].t=="?"));)n[i].v+=n[b].v,n[b]={v:"",t:";"},++b;x+=n[i].v,i=b-1;break;case"G":n[i].t="t",n[i].v=ja(t,r);break}var C="",w,_;if(x.length>0){x.charCodeAt(0)==40?(w=t<0&&x.charCodeAt(0)===45?-t:t,_=ia("n",x,w)):(w=t<0&&a>1?-t:t,_=ia("n",x,w),w<0&&n[0]&&n[0].t=="t"&&(_=_.substr(1),n[0].v="-"+n[0].v)),b=_.length-1;var k=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){k=i;break}var S=n.length;if(k===n.length&&_.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(b>=n[i].v.length-1?(b-=n[i].v.length,n[i].v=_.substr(b+1,n[i].v.length)):b<0?n[i].v="":(n[i].v=_.substr(0,b+1),b=-1),n[i].t="t",S=i);b>=0&&S<n.length&&(n[S].v=_.substr(0,b+1)+n[S].v)}else if(k!==n.length&&_.indexOf("E")===-1){for(b=_.indexOf(".")-1,i=k;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(f=n[i].v.indexOf(".")>-1&&i===k?n[i].v.indexOf(".")-1:n[i].v.length-1,C=n[i].v.substr(f+1);f>=0;--f)b>=0&&(n[i].v.charAt(f)==="0"||n[i].v.charAt(f)==="#")&&(C=_.charAt(b--)+C);n[i].v=C,n[i].t="t",S=i}for(b>=0&&S<n.length&&(n[S].v=_.substr(0,b+1)+n[S].v),b=_.indexOf(".")+1,i=k;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==k)){for(f=n[i].v.indexOf(".")>-1&&i===k?n[i].v.indexOf(".")+1:0,C=n[i].v.substr(0,f);f<n[i].v.length;++f)b<_.length&&(C+=_.charAt(b++));n[i].v=C,n[i].t="t",S=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(w=a>1&&t<0&&i>0&&n[i-1].v==="-"?-t:t,n[i].v=ia(n[i].t,n[i].v,w),n[i].t="t");var D="";for(i=0;i!==n.length;++i)n[i]!=null&&(D+=n[i].v);return D}var gc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xc(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Lp(e,t){var r=Op(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(gc),o=r[1].match(gc);return xc(t,i)?[a,r[0]]:xc(t,o)?[a,r[1]]:[a,r[i!=null&&o!=null?2:1]]}return[a,s]}function Nr(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:De)[e],a==null&&(a=r.table&&r.table[pc[e]]||De[pc[e]]),a==null&&(a=vp[e]||"General");break}if(fi(a,0))return ja(t,r);t instanceof Date&&(t=y0(t,r.date1904));var n=Lp(a,t);if(fi(n[1]))return ja(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Pp(n[1],t,r,n[0])}function oa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(De[r]==null){t<0&&(t=r);continue}if(De[r]==e){t=r;break}}t<0&&(t=391)}return De[t]=e,t}function bi(e){for(var t=0;t!=392;++t)e[t]!==void 0&&oa(e[t],t)}function In(){De=xp()}var $p={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},A0=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Mp(e){var t=typeof e=="number"?De[e]:e;return t=t.replace(A0,"(\\d+)"),new RegExp("^"+t+"$")}function Bp(e,t,r){var a=-1,n=-1,s=-1,i=-1,o=-1,l=-1;(t.match(A0)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":a=p;break;case"d":s=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:n=p;break}}),l>=0&&o==-1&&n>=0&&(o=n,n=-1);var c=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:a==-1&&n==-1&&s==-1?f:c+"T"+f}var Up=(function(){var e={};e.version="1.2.0";function t(){for(var _=0,k=new Array(256),S=0;S!=256;++S)_=S,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,k[S]=_;return typeof Int32Array!="undefined"?new Int32Array(k):k}var r=t();function a(_){var k=0,S=0,D=0,R=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)R[D]=_[D];for(D=0;D!=256;++D)for(S=_[D],k=256+D;k<4096;k+=256)S=R[k]=S>>>8^_[S&255];var T=[];for(D=1;D!=16;++D)T[D-1]=typeof Int32Array!="undefined"?R.subarray(D*256,D*256+256):R.slice(D*256,D*256+256);return T}var n=a(r),s=n[0],i=n[1],o=n[2],l=n[3],c=n[4],f=n[5],d=n[6],h=n[7],p=n[8],m=n[9],u=n[10],g=n[11],v=n[12],y=n[13],x=n[14];function b(_,k){for(var S=k^-1,D=0,R=_.length;D<R;)S=S>>>8^r[(S^_.charCodeAt(D++))&255];return~S}function C(_,k){for(var S=k^-1,D=_.length-15,R=0;R<D;)S=x[_[R++]^S&255]^y[_[R++]^S>>8&255]^v[_[R++]^S>>16&255]^g[_[R++]^S>>>24]^u[_[R++]]^m[_[R++]]^p[_[R++]]^h[_[R++]]^d[_[R++]]^f[_[R++]]^c[_[R++]]^l[_[R++]]^o[_[R++]]^i[_[R++]]^s[_[R++]]^r[_[R++]];for(D+=15;R<D;)S=S>>>8^r[(S^_[R++])&255];return~S}function w(_,k){for(var S=k^-1,D=0,R=_.length,T=0,V=0;D<R;)T=_.charCodeAt(D++),T<128?S=S>>>8^r[(S^T)&255]:T<2048?(S=S>>>8^r[(S^(192|T>>6&31))&255],S=S>>>8^r[(S^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,V=_.charCodeAt(D++)&1023,S=S>>>8^r[(S^(240|T>>8&7))&255],S=S>>>8^r[(S^(128|T>>2&63))&255],S=S>>>8^r[(S^(128|V>>6&15|(T&3)<<4))&255],S=S>>>8^r[(S^(128|V&63))&255]):(S=S>>>8^r[(S^(224|T>>12&15))&255],S=S>>>8^r[(S^(128|T>>6&63))&255],S=S>>>8^r[(S^(128|T&63))&255]);return~S}return e.table=r,e.bstr=b,e.buf=C,e.str=w,e})(),Re=(function(){var t={};t.version="1.2.1";function r(E,N){for(var A=E.split("/"),I=N.split("/"),L=0,M=0,ee=Math.min(A.length,I.length);L<ee;++L){if(M=A[L].length-I[L].length)return M;if(A[L]!=I[L])return A[L]<I[L]?-1:1}return A.length-I.length}function a(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:a(E.slice(0,-1));var N=E.lastIndexOf("/");return N===-1?E:E.slice(0,N+1)}function n(E){if(E.charAt(E.length-1)=="/")return n(E.slice(0,-1));var N=E.lastIndexOf("/");return N===-1?E:E.slice(N+1)}function s(E,N){typeof N=="string"&&(N=new Date(N));var A=N.getHours();A=A<<6|N.getMinutes(),A=A<<5|N.getSeconds()>>>1,E.write_shift(2,A);var I=N.getFullYear()-1980;I=I<<4|N.getMonth()+1,I=I<<5|N.getDate(),E.write_shift(2,I)}function i(E){var N=E.read_shift(2)&65535,A=E.read_shift(2)&65535,I=new Date,L=A&31;A>>>=5;var M=A&15;A>>>=4,I.setMilliseconds(0),I.setFullYear(A+1980),I.setMonth(M-1),I.setDate(L);var ee=N&31;N>>>=5;var le=N&63;return N>>>=6,I.setHours(N),I.setMinutes(le),I.setSeconds(ee<<1),I}function o(E){Jt(E,0);for(var N={},A=0;E.l<=E.length-4;){var I=E.read_shift(2),L=E.read_shift(2),M=E.l+L,ee={};switch(I){case 21589:A=E.read_shift(1),A&1&&(ee.mtime=E.read_shift(4)),L>5&&(A&2&&(ee.atime=E.read_shift(4)),A&4&&(ee.ctime=E.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}E.l=M,N[I]=ee}return N}var l;function c(){return l||(l={})}function f(E,N){if(E[0]==80&&E[1]==75)return Wn(E,N);if((E[0]|32)==109&&(E[1]|32)==105)return $r(E,N);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var A=3,I=512,L=0,M=0,ee=0,le=0,re=0,te=[],ne=E.slice(0,512);Jt(ne,0);var me=d(ne);switch(A=me[0],A){case 3:I=512;break;case 4:I=4096;break;case 0:if(me[1]==0)return Wn(E,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}I!==512&&(ne=E.slice(0,I),Jt(ne,28));var ve=E.slice(0,I);h(ne,A);var Ce=ne.read_shift(4,"i");if(A===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);ne.l+=4,ee=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),le=ne.read_shift(4,"i"),L=ne.read_shift(4,"i"),re=ne.read_shift(4,"i"),M=ne.read_shift(4,"i");for(var ye=-1,_e=0;_e<109&&(ye=ne.read_shift(4,"i"),!(ye<0));++_e)te[_e]=ye;var Ue=p(E,I);g(re,M,Ue,I,te);var xt=y(Ue,ee,te,I);xt[ee].name="!Directory",L>0&&le!==V&&(xt[le].name="!MiniFAT"),xt[te[0]].name="!FAT",xt.fat_addrs=te,xt.ssz=I;var pr={},Lt=[],yr=[],zn=[];x(ee,xt,Ue,Lt,L,pr,yr,le),m(yr,zn,Lt),Lt.shift();var Xn={FileIndex:yr,FullPaths:zn};return N&&N.raw&&(Xn.raw={header:ve,sectors:Ue}),Xn}function d(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(G,"Header Signature: "),E.l+=16;var N=E.read_shift(2,"u");return[E.read_shift(2,"u"),N]}function h(E,N){var A=9;switch(E.l+=2,A=E.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function p(E,N){for(var A=Math.ceil(E.length/N)-1,I=[],L=1;L<A;++L)I[L-1]=E.slice(L*N,(L+1)*N);return I[A-1]=E.slice(A*N),I}function m(E,N,A){for(var I=0,L=0,M=0,ee=0,le=0,re=A.length,te=[],ne=[];I<re;++I)te[I]=ne[I]=I,N[I]=A[I];for(;le<ne.length;++le)I=ne[le],L=E[I].L,M=E[I].R,ee=E[I].C,te[I]===I&&(L!==-1&&te[L]!==L&&(te[I]=te[L]),M!==-1&&te[M]!==M&&(te[I]=te[M])),ee!==-1&&(te[ee]=I),L!==-1&&I!=te[I]&&(te[L]=te[I],ne.lastIndexOf(L)<le&&ne.push(L)),M!==-1&&I!=te[I]&&(te[M]=te[I],ne.lastIndexOf(M)<le&&ne.push(M));for(I=1;I<re;++I)te[I]===I&&(M!==-1&&te[M]!==M?te[I]=te[M]:L!==-1&&te[L]!==L&&(te[I]=te[L]));for(I=1;I<re;++I)if(E[I].type!==0){if(le=I,le!=te[le])do le=te[le],N[I]=N[le]+"/"+N[I];while(le!==0&&te[le]!==-1&&le!=te[le]);te[I]=-1}for(N[0]+="/",I=1;I<re;++I)E[I].type!==2&&(N[I]+="/")}function u(E,N,A){for(var I=E.start,L=E.size,M=[],ee=I;A&&L>0&&ee>=0;)M.push(N.slice(ee*T,ee*T+T)),L-=T,ee=$a(A,ee*4);return M.length===0?ie(0):Xt(M).slice(0,E.size)}function g(E,N,A,I,L){var M=V;if(E===V){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var ee=A[E],le=(I>>>2)-1;if(!ee)return;for(var re=0;re<le&&(M=$a(ee,re*4))!==V;++re)L.push(M);g($a(ee,I-4),N-1,A,I,L)}}function v(E,N,A,I,L){var M=[],ee=[];L||(L=[]);var le=I-1,re=0,te=0;for(re=N;re>=0;){L[re]=!0,M[M.length]=re,ee.push(E[re]);var ne=A[Math.floor(re*4/I)];if(te=re*4&le,I<4+te)throw new Error("FAT boundary crossed: "+re+" 4 "+I);if(!E[ne])break;re=$a(E[ne],te)}return{nodes:M,data:Rc([ee])}}function y(E,N,A,I){var L=E.length,M=[],ee=[],le=[],re=[],te=I-1,ne=0,me=0,ve=0,Ce=0;for(ne=0;ne<L;++ne)if(le=[],ve=ne+N,ve>=L&&(ve-=L),!ee[ve]){re=[];var ye=[];for(me=ve;me>=0;){ye[me]=!0,ee[me]=!0,le[le.length]=me,re.push(E[me]);var _e=A[Math.floor(me*4/I)];if(Ce=me*4&te,I<4+Ce)throw new Error("FAT boundary crossed: "+me+" 4 "+I);if(!E[_e]||(me=$a(E[_e],Ce),ye[me]))break}M[ve]={nodes:le,data:Rc([re])}}return M}function x(E,N,A,I,L,M,ee,le){for(var re=0,te=I.length?2:0,ne=N[E].data,me=0,ve=0,Ce;me<ne.length;me+=128){var ye=ne.slice(me,me+128);Jt(ye,64),ve=ye.read_shift(2),Ce=Ti(ye,0,ve-te),I.push(Ce);var _e={name:Ce,type:ye.read_shift(1),color:ye.read_shift(1),L:ye.read_shift(4,"i"),R:ye.read_shift(4,"i"),C:ye.read_shift(4,"i"),clsid:ye.read_shift(16),state:ye.read_shift(4,"i"),start:0,size:0},Ue=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);Ue!==0&&(_e.ct=b(ye,ye.l-8));var xt=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);xt!==0&&(_e.mt=b(ye,ye.l-8)),_e.start=ye.read_shift(4,"i"),_e.size=ye.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=V,_e.name=""),_e.type===5?(re=_e.start,L>0&&re!==V&&(N[re].name="!StreamData")):_e.size>=4096?(_e.storage="fat",N[_e.start]===void 0&&(N[_e.start]=v(A,_e.start,N.fat_addrs,N.ssz)),N[_e.start].name=_e.name,_e.content=N[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:re!==V&&_e.start!==V&&N[re]&&(_e.content=u(_e,N[re].data,(N[le]||{}).data))),_e.content&&Jt(_e.content,0),M[Ce]=_e,ee.push(_e)}}function b(E,N){return new Date((zt(E,N+4)/1e7*Math.pow(2,32)+zt(E,N)/1e7-11644473600)*1e3)}function C(E,N){return c(),f(l.readFileSync(E),N)}function w(E,N){var A=N&&N.type;switch(A||Xe&&Buffer.isBuffer(E)&&(A="buffer"),A||"base64"){case"file":return C(E,N);case"base64":return f(wr(br(E)),N);case"binary":return f(wr(E),N)}return f(E,N)}function _(E,N){var A=N||{},I=A.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=I+"/",E.FileIndex[0]={name:I,type:5}),A.CLSID&&(E.FileIndex[0].clsid=A.CLSID),k(E)}function k(E){var N="Sh33tJ5";if(!Re.find(E,"/"+N)){var A=ie(4);A[0]=55,A[1]=A[3]=50,A[2]=54,E.FileIndex.push({name:N,type:2,content:A,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+N),S(E)}}function S(E,N){_(E);for(var A=!1,I=!1,L=E.FullPaths.length-1;L>=0;--L){var M=E.FileIndex[L];switch(M.type){case 0:I?A=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(M.R*M.L*M.C)&&(A=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!N)){var ee=new Date(1987,1,19),le=0,re=Object.create?Object.create(null):{},te=[];for(L=0;L<E.FullPaths.length;++L)re[E.FullPaths[L]]=!0,E.FileIndex[L].type!==0&&te.push([E.FullPaths[L],E.FileIndex[L]]);for(L=0;L<te.length;++L){var ne=a(te[L][0]);I=re[ne],I||(te.push([ne,{name:n(ne).replace("/",""),type:1,clsid:j,ct:ee,mt:ee,content:null}]),re[ne]=!0)}for(te.sort(function(Ce,ye){return r(Ce[0],ye[0])}),E.FullPaths=[],E.FileIndex=[],L=0;L<te.length;++L)E.FullPaths[L]=te[L][0],E.FileIndex[L]=te[L][1];for(L=0;L<te.length;++L){var me=E.FileIndex[L],ve=E.FullPaths[L];if(me.name=n(ve).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||j,L===0)me.C=te.length>1?1:-1,me.size=0,me.type=5;else if(ve.slice(-1)=="/"){for(le=L+1;le<te.length&&a(E.FullPaths[le])!=ve;++le);for(me.C=le>=te.length?-1:le,le=L+1;le<te.length&&a(E.FullPaths[le])!=a(ve);++le);me.R=le>=te.length?-1:le,me.type=1}else a(E.FullPaths[L+1]||"")==a(ve)&&(me.R=L+1),me.type=2}}}function D(E,N){var A=N||{};if(A.fileType=="mad")return Sr(E,A);switch(S(E),A.fileType){case"zip":return ue(E,A)}var I=(function(Ce){for(var ye=0,_e=0,Ue=0;Ue<Ce.FileIndex.length;++Ue){var xt=Ce.FileIndex[Ue];if(xt.content){var pr=xt.content.length;pr>0&&(pr<4096?ye+=pr+63>>6:_e+=pr+511>>9)}}for(var Lt=Ce.FullPaths.length+3>>2,yr=ye+7>>3,zn=ye+127>>7,Xn=yr+_e+Lt+zn,La=Xn+127>>7,Yi=La<=109?0:Math.ceil((La-109)/127);Xn+La+Yi+127>>7>La;)Yi=++La<=109?0:Math.ceil((La-109)/127);var na=[1,Yi,La,zn,Lt,_e,ye,0];return Ce.FileIndex[0].size=ye<<6,na[7]=(Ce.FileIndex[0].start=na[0]+na[1]+na[2]+na[3]+na[4]+na[5])+(na[6]+7>>3),na})(E),L=ie(I[7]<<9),M=0,ee=0;{for(M=0;M<8;++M)L.write_shift(1,W[M]);for(M=0;M<8;++M)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),M=0;M<3;++M)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,I[2]),L.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:V),L.write_shift(4,I[3]),L.write_shift(-4,I[1]?I[0]-1:V),L.write_shift(4,I[1]),M=0;M<109;++M)L.write_shift(-4,M<I[2]?I[1]+M:-1)}if(I[1])for(ee=0;ee<I[1];++ee){for(;M<236+ee*127;++M)L.write_shift(-4,M<I[2]?I[1]+M:-1);L.write_shift(-4,ee===I[1]-1?V:ee+1)}var le=function(Ce){for(ee+=Ce;M<ee-1;++M)L.write_shift(-4,M+1);Ce&&(++M,L.write_shift(-4,V))};for(ee=M=0,ee+=I[1];M<ee;++M)L.write_shift(-4,se.DIFSECT);for(ee+=I[2];M<ee;++M)L.write_shift(-4,se.FATSECT);le(I[3]),le(I[4]);for(var re=0,te=0,ne=E.FileIndex[0];re<E.FileIndex.length;++re)ne=E.FileIndex[re],ne.content&&(te=ne.content.length,!(te<4096)&&(ne.start=ee,le(te+511>>9)));for(le(I[6]+7>>3);L.l&511;)L.write_shift(-4,se.ENDOFCHAIN);for(ee=M=0,re=0;re<E.FileIndex.length;++re)ne=E.FileIndex[re],ne.content&&(te=ne.content.length,!(!te||te>=4096)&&(ne.start=ee,le(te+63>>6)));for(;L.l&511;)L.write_shift(-4,se.ENDOFCHAIN);for(M=0;M<I[4]<<2;++M){var me=E.FullPaths[M];if(!me||me.length===0){for(re=0;re<17;++re)L.write_shift(4,0);for(re=0;re<3;++re)L.write_shift(4,-1);for(re=0;re<12;++re)L.write_shift(4,0);continue}ne=E.FileIndex[M],M===0&&(ne.start=ne.size?ne.start-1:V);var ve=M===0&&A.root||ne.name;if(te=2*(ve.length+1),L.write_shift(64,ve,"utf16le"),L.write_shift(2,te),L.write_shift(1,ne.type),L.write_shift(1,ne.color),L.write_shift(-4,ne.L),L.write_shift(-4,ne.R),L.write_shift(-4,ne.C),ne.clsid)L.write_shift(16,ne.clsid,"hex");else for(re=0;re<4;++re)L.write_shift(4,0);L.write_shift(4,ne.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,ne.start),L.write_shift(4,ne.size),L.write_shift(4,0)}for(M=1;M<E.FileIndex.length;++M)if(ne=E.FileIndex[M],ne.size>=4096)if(L.l=ne.start+1<<9,Xe&&Buffer.isBuffer(ne.content))ne.content.copy(L,L.l,0,ne.size),L.l+=ne.size+511&-512;else{for(re=0;re<ne.size;++re)L.write_shift(1,ne.content[re]);for(;re&511;++re)L.write_shift(1,0)}for(M=1;M<E.FileIndex.length;++M)if(ne=E.FileIndex[M],ne.size>0&&ne.size<4096)if(Xe&&Buffer.isBuffer(ne.content))ne.content.copy(L,L.l,0,ne.size),L.l+=ne.size+63&-64;else{for(re=0;re<ne.size;++re)L.write_shift(1,ne.content[re]);for(;re&63;++re)L.write_shift(1,0)}if(Xe)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function R(E,N){var A=E.FullPaths.map(function(re){return re.toUpperCase()}),I=A.map(function(re){var te=re.split("/");return te[te.length-(re.slice(-1)=="/"?2:1)]}),L=!1;N.charCodeAt(0)===47?(L=!0,N=A[0].slice(0,-1)+N):L=N.indexOf("/")!==-1;var M=N.toUpperCase(),ee=L===!0?A.indexOf(M):I.indexOf(M);if(ee!==-1)return E.FileIndex[ee];var le=!M.match(Qn);for(M=M.replace(nr,""),le&&(M=M.replace(Qn,"!")),ee=0;ee<A.length;++ee)if((le?A[ee].replace(Qn,"!"):A[ee]).replace(nr,"")==M||(le?I[ee].replace(Qn,"!"):I[ee]).replace(nr,"")==M)return E.FileIndex[ee];return null}var T=64,V=-2,G="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],j="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:j,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(E,N,A){c();var I=D(E,A);l.writeFileSync(N,I)}function K(E){for(var N=new Array(E.length),A=0;A<E.length;++A)N[A]=String.fromCharCode(E[A]);return N.join("")}function Z(E,N){var A=D(E,N);switch(N&&N.type||"buffer"){case"file":return c(),l.writeFileSync(N.filename,A),A;case"binary":return typeof A=="string"?A:K(A);case"base64":return fs(typeof A=="string"?A:K(A));case"buffer":if(Xe)return Buffer.isBuffer(A)?A:fa(A);case"array":return typeof A=="string"?wr(A):A}return A}var X;function F(E){try{var N=E.InflateRaw,A=new N;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)X=E;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function U(E,N){if(!X)return Oa(E,N);var A=X.InflateRaw,I=new A,L=I._processChunk(E.slice(E.l),I._finishFlushFlag);return E.l+=I.bytesRead,L}function P(E){return X?X.deflateRawSync(E):Ae(E)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(E){var N=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(N>>16|N>>8|N)&255}for(var oe=typeof Uint8Array!="undefined",ae=oe?new Uint8Array(256):[],be=0;be<256;++be)ae[be]=J(be);function O(E,N){var A=ae[E&255];return N<=8?A>>>8-N:(A=A<<8|ae[E>>8&255],N<=16?A>>>16-N:(A=A<<8|ae[E>>16&255],A>>>24-N))}function Se(E,N){var A=N&7,I=N>>>3;return(E[I]|(A<=6?0:E[I+1]<<8))>>>A&3}function ke(E,N){var A=N&7,I=N>>>3;return(E[I]|(A<=5?0:E[I+1]<<8))>>>A&7}function Ne(E,N){var A=N&7,I=N>>>3;return(E[I]|(A<=4?0:E[I+1]<<8))>>>A&15}function pe(E,N){var A=N&7,I=N>>>3;return(E[I]|(A<=3?0:E[I+1]<<8))>>>A&31}function z(E,N){var A=N&7,I=N>>>3;return(E[I]|(A<=1?0:E[I+1]<<8))>>>A&127}function ce(E,N,A){var I=N&7,L=N>>>3,M=(1<<A)-1,ee=E[L]>>>I;return A<8-I||(ee|=E[L+1]<<8-I,A<16-I)||(ee|=E[L+2]<<16-I,A<24-I)||(ee|=E[L+3]<<24-I),ee&M}function ft(E,N,A){var I=N&7,L=N>>>3;return I<=5?E[L]|=(A&7)<<I:(E[L]|=A<<I&255,E[L+1]=(A&7)>>8-I),N+3}function Ot(E,N,A){var I=N&7,L=N>>>3;return A=(A&1)<<I,E[L]|=A,N+1}function ze(E,N,A){var I=N&7,L=N>>>3;return A<<=I,E[L]|=A&255,A>>>=8,E[L+1]=A,N+8}function Pt(E,N,A){var I=N&7,L=N>>>3;return A<<=I,E[L]|=A&255,A>>>=8,E[L+1]=A&255,E[L+2]=A>>>8,N+16}function vr(E,N){var A=E.length,I=2*A>N?2*A:N+5,L=0;if(A>=N)return E;if(Xe){var M=fc(I);if(E.copy)E.copy(M);else for(;L<E.length;++L)M[L]=E[L];return M}else if(oe){var ee=new Uint8Array(I);if(ee.set)ee.set(E);else for(;L<A;++L)ee[L]=E[L];return ee}return E.length=I,E}function jt(E){for(var N=new Array(E),A=0;A<E;++A)N[A]=0;return N}function dr(E,N,A){var I=1,L=0,M=0,ee=0,le=0,re=E.length,te=oe?new Uint16Array(32):jt(32);for(M=0;M<32;++M)te[M]=0;for(M=re;M<A;++M)E[M]=0;re=E.length;var ne=oe?new Uint16Array(re):jt(re);for(M=0;M<re;++M)te[L=E[M]]++,I<L&&(I=L),ne[M]=0;for(te[0]=0,M=1;M<=I;++M)te[M+16]=le=le+te[M-1]<<1;for(M=0;M<re;++M)le=E[M],le!=0&&(ne[M]=te[le+16]++);var me=0;for(M=0;M<re;++M)if(me=E[M],me!=0)for(le=O(ne[M],I)>>I-me,ee=(1<<I+4-me)-1;ee>=0;--ee)N[le|ee<<me]=me&15|M<<4;return I}var H=oe?new Uint16Array(512):jt(512),fe=oe?new Uint16Array(32):jt(32);if(!oe){for(var Oe=0;Oe<512;++Oe)H[Oe]=0;for(Oe=0;Oe<32;++Oe)fe[Oe]=0}(function(){for(var E=[],N=0;N<32;N++)E.push(5);dr(E,fe,32);var A=[];for(N=0;N<=143;N++)A.push(8);for(;N<=255;N++)A.push(9);for(;N<=279;N++)A.push(7);for(;N<=287;N++)A.push(8);dr(A,H,288)})();var Je=(function(){for(var N=oe?new Uint8Array(32768):[],A=0,I=0;A<Q.length-1;++A)for(;I<Q[A+1];++I)N[I]=A;for(;I<32768;++I)N[I]=29;var L=oe?new Uint8Array(259):[];for(A=0,I=0;A<Y.length-1;++A)for(;I<Y[A+1];++I)L[I]=A;function M(le,re){for(var te=0;te<le.length;){var ne=Math.min(65535,le.length-te),me=te+ne==le.length;for(re.write_shift(1,+me),re.write_shift(2,ne),re.write_shift(2,~ne&65535);ne-- >0;)re[re.l++]=le[te++]}return re.l}function ee(le,re){for(var te=0,ne=0,me=oe?new Uint16Array(32768):[];ne<le.length;){var ve=Math.min(65535,le.length-ne);if(ve<10){for(te=ft(re,te,+(ne+ve==le.length)),te&7&&(te+=8-(te&7)),re.l=te/8|0,re.write_shift(2,ve),re.write_shift(2,~ve&65535);ve-- >0;)re[re.l++]=le[ne++];te=re.l*8;continue}te=ft(re,te,+(ne+ve==le.length)+2);for(var Ce=0;ve-- >0;){var ye=le[ne];Ce=(Ce<<5^ye)&32767;var _e=-1,Ue=0;if((_e=me[Ce])&&(_e|=ne&-32768,_e>ne&&(_e-=32768),_e<ne))for(;le[_e+Ue]==le[ne+Ue]&&Ue<250;)++Ue;if(Ue>2){ye=L[Ue],ye<=22?te=ze(re,te,ae[ye+1]>>1)-1:(ze(re,te,3),te+=5,ze(re,te,ae[ye-23]>>5),te+=3);var xt=ye<8?0:ye-4>>2;xt>0&&(Pt(re,te,Ue-Y[ye]),te+=xt),ye=N[ne-_e],te=ze(re,te,ae[ye]>>3),te-=3;var pr=ye<4?0:ye-2>>1;pr>0&&(Pt(re,te,ne-_e-Q[ye]),te+=pr);for(var Lt=0;Lt<Ue;++Lt)me[Ce]=ne&32767,Ce=(Ce<<5^le[ne])&32767,++ne;ve-=Ue-1}else ye<=143?ye=ye+48:te=Ot(re,te,1),te=ze(re,te,ae[ye]),me[Ce]=ne&32767,++ne}te=ze(re,te,0)-1}return re.l=(te+7)/8|0,re.l}return function(re,te){return re.length<8?M(re,te):ee(re,te)}})();function Ae(E){var N=ie(50+Math.floor(E.length*1.1)),A=Je(E,N);return N.slice(0,A)}var tt=oe?new Uint16Array(32768):jt(32768),pt=oe?new Uint16Array(32768):jt(32768),je=oe?new Uint16Array(128):jt(128),Ye=1,Wt=1;function Yr(E,N){var A=pe(E,N)+257;N+=5;var I=pe(E,N)+1;N+=5;var L=Ne(E,N)+4;N+=4;for(var M=0,ee=oe?new Uint8Array(19):jt(19),le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,te=oe?new Uint8Array(8):jt(8),ne=oe?new Uint8Array(8):jt(8),me=ee.length,ve=0;ve<L;++ve)ee[B[ve]]=M=ke(E,N),re<M&&(re=M),te[M]++,N+=3;var Ce=0;for(te[0]=0,ve=1;ve<=re;++ve)ne[ve]=Ce=Ce+te[ve-1]<<1;for(ve=0;ve<me;++ve)(Ce=ee[ve])!=0&&(le[ve]=ne[Ce]++);var ye=0;for(ve=0;ve<me;++ve)if(ye=ee[ve],ye!=0){Ce=ae[le[ve]]>>8-ye;for(var _e=(1<<7-ye)-1;_e>=0;--_e)je[Ce|_e<<ye]=ye&7|ve<<3}var Ue=[];for(re=1;Ue.length<A+I;)switch(Ce=je[z(E,N)],N+=Ce&7,Ce>>>=3){case 16:for(M=3+Se(E,N),N+=2,Ce=Ue[Ue.length-1];M-- >0;)Ue.push(Ce);break;case 17:for(M=3+ke(E,N),N+=3;M-- >0;)Ue.push(0);break;case 18:for(M=11+z(E,N),N+=7;M-- >0;)Ue.push(0);break;default:Ue.push(Ce),re<Ce&&(re=Ce);break}var xt=Ue.slice(0,A),pr=Ue.slice(A);for(ve=A;ve<286;++ve)xt[ve]=0;for(ve=I;ve<30;++ve)pr[ve]=0;return Ye=dr(xt,tt,286),Wt=dr(pr,pt,30),N}function ga(E,N){if(E[0]==3&&!(E[1]&3))return[Ea(N),2];for(var A=0,I=0,L=fc(N||1<<18),M=0,ee=L.length>>>0,le=0,re=0;(I&1)==0;){if(I=ke(E,A),A+=3,I>>>1)I>>1==1?(le=9,re=5):(A=Yr(E,A),le=Ye,re=Wt);else{A&7&&(A+=8-(A&7));var te=E[A>>>3]|E[(A>>>3)+1]<<8;if(A+=32,te>0)for(!N&&ee<M+te&&(L=vr(L,M+te),ee=L.length);te-- >0;)L[M++]=E[A>>>3],A+=8;continue}for(;;){!N&&ee<M+32767&&(L=vr(L,M+32767),ee=L.length);var ne=ce(E,A,le),me=I>>>1==1?H[ne]:tt[ne];if(A+=me&15,me>>>=4,(me>>>8&255)===0)L[M++]=me;else{if(me==256)break;me-=257;var ve=me<8?0:me-4>>2;ve>5&&(ve=0);var Ce=M+Y[me];ve>0&&(Ce+=ce(E,A,ve),A+=ve),ne=ce(E,A,re),me=I>>>1==1?fe[ne]:pt[ne],A+=me&15,me>>>=4;var ye=me<4?0:me-2>>1,_e=Q[me];for(ye>0&&(_e+=ce(E,A,ye),A+=ye),!N&&ee<Ce&&(L=vr(L,Ce+100),ee=L.length);M<Ce;)L[M]=L[M-_e],++M}}}return N?[L,A+7>>>3]:[L.slice(0,M),A+7>>>3]}function Oa(E,N){var A=E.slice(E.l||0),I=ga(A,N);return E.l+=I[1],I[0]}function Ws(E,N){if(E)typeof console!="undefined"&&console.error(N);else throw new Error(N)}function Wn(E,N){var A=E;Jt(A,0);var I=[],L=[],M={FileIndex:I,FullPaths:L};_(M,{root:N.root});for(var ee=A.length-4;(A[ee]!=80||A[ee+1]!=75||A[ee+2]!=5||A[ee+3]!=6)&&ee>=0;)--ee;A.l=ee+4,A.l+=4;var le=A.read_shift(2);A.l+=6;var re=A.read_shift(4);for(A.l=re,ee=0;ee<le;++ee){A.l+=20;var te=A.read_shift(4),ne=A.read_shift(4),me=A.read_shift(2),ve=A.read_shift(2),Ce=A.read_shift(2);A.l+=8;var ye=A.read_shift(4),_e=o(A.slice(A.l+me,A.l+me+ve));A.l+=me+ve+Ce;var Ue=A.l;A.l=ye+4,Gs(A,te,ne,M,_e),A.l=Ue}return M}function Gs(E,N,A,I,L){E.l+=2;var M=E.read_shift(2),ee=E.read_shift(2),le=i(E);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var re=E.read_shift(4),te=E.read_shift(4),ne=E.read_shift(4),me=E.read_shift(2),ve=E.read_shift(2),Ce="",ye=0;ye<me;++ye)Ce+=String.fromCharCode(E[E.l++]);if(ve){var _e=o(E.slice(E.l,E.l+ve));(_e[21589]||{}).mt&&(le=_e[21589].mt),((L||{})[21589]||{}).mt&&(le=L[21589].mt)}E.l+=ve;var Ue=E.slice(E.l,E.l+te);switch(ee){case 8:Ue=U(E,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var xt=!1;M&8&&(re=E.read_shift(4),re==134695760&&(re=E.read_shift(4),xt=!0),te=E.read_shift(4),ne=E.read_shift(4)),te!=N&&Ws(xt,"Bad compressed size: "+N+" != "+te),ne!=A&&Ws(xt,"Bad uncompressed size: "+A+" != "+ne),xa(I,Ce,Ue,{unsafe:!0,mt:le})}function ue(E,N){var A=N||{},I=[],L=[],M=ie(1),ee=A.compression?8:0,le=0,re=!1;re&&(le|=8);var te=0,ne=0,me=0,ve=0,Ce=E.FullPaths[0],ye=Ce,_e=E.FileIndex[0],Ue=[],xt=0;for(te=1;te<E.FullPaths.length;++te)if(ye=E.FullPaths[te].slice(Ce.length),_e=E.FileIndex[te],!(!_e.size||!_e.content||ye=="Sh33tJ5")){var pr=me,Lt=ie(ye.length);for(ne=0;ne<ye.length;++ne)Lt.write_shift(1,ye.charCodeAt(ne)&127);Lt=Lt.slice(0,Lt.l),Ue[ve]=Up.buf(_e.content,0);var yr=_e.content;ee==8&&(yr=P(yr)),M=ie(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,le),M.write_shift(2,ee),_e.mt?s(M,_e.mt):M.write_shift(4,0),M.write_shift(-4,le&8?0:Ue[ve]),M.write_shift(4,le&8?0:yr.length),M.write_shift(4,le&8?0:_e.content.length),M.write_shift(2,Lt.length),M.write_shift(2,0),me+=M.length,I.push(M),me+=Lt.length,I.push(Lt),me+=yr.length,I.push(yr),le&8&&(M=ie(12),M.write_shift(-4,Ue[ve]),M.write_shift(4,yr.length),M.write_shift(4,_e.content.length),me+=M.l,I.push(M)),M=ie(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,le),M.write_shift(2,ee),M.write_shift(4,0),M.write_shift(-4,Ue[ve]),M.write_shift(4,yr.length),M.write_shift(4,_e.content.length),M.write_shift(2,Lt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,pr),xt+=M.l,L.push(M),xt+=Lt.length,L.push(Lt),++ve}return M=ie(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,ve),M.write_shift(2,ve),M.write_shift(4,xt),M.write_shift(4,me),M.write_shift(2,0),Xt([Xt(I),Xt(L),M])}var Ee={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ke(E,N){if(E.ctype)return E.ctype;var A=E.name||"",I=A.match(/\.([^\.]+)$/);return I&&Ee[I[1]]||N&&(I=(A=N).match(/[\.\\]([^\.\\])+$/),I&&Ee[I[1]])?Ee[I[1]]:"application/octet-stream"}function Ut(E){for(var N=fs(E),A=[],I=0;I<N.length;I+=76)A.push(N.slice(I,I+76));return A.join(`\r
`)+`\r
`}function Zt(E){var N=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var ne=te.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],I=N.split(`\r
`),L=0;L<I.length;++L){var M=I[L];if(M.length==0){A.push("");continue}for(var ee=0;ee<M.length;){var le=76,re=M.slice(ee,ee+le);re.charAt(le-1)=="="?le--:re.charAt(le-2)=="="?le-=2:re.charAt(le-3)=="="&&(le-=3),re=M.slice(ee,ee+le),ee+=le,ee<M.length&&(re+="="),A.push(re)}}return A.join(`\r
`)}function gt(E){for(var N=[],A=0;A<E.length;++A){for(var I=E[A];A<=E.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+E[++A];N.push(I)}for(var L=0;L<N.length;++L)N[L]=N[L].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return wr(N.join(`\r
`))}function dt(E,N,A){for(var I="",L="",M="",ee,le=0;le<10;++le){var re=N[le];if(!re||re.match(/^\s*$/))break;var te=re.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":I=te[2].trim();break;case"content-type":M=te[2].trim();break;case"content-transfer-encoding":L=te[2].trim();break}}switch(++le,L.toLowerCase()){case"base64":ee=wr(br(N.slice(le).join("")));break;case"quoted-printable":ee=gt(N.slice(le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var ne=xa(E,I.slice(A.length),ee,{unsafe:!0});M&&(ne.ctype=M)}function $r(E,N){if(K(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=N&&N.root||"",I=(Xe&&Buffer.isBuffer(E)?E.toString("binary"):K(E)).split(`\r
`),L=0,M="";for(L=0;L<I.length;++L)if(M=I[L],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),A||(A=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),M.slice(0,A.length)!=A););var ee=(I[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var le="--"+(ee[1]||""),re=[],te=[],ne={FileIndex:re,FullPaths:te};_(ne);var me,ve=0;for(L=0;L<I.length;++L){var Ce=I[L];Ce!==le&&Ce!==le+"--"||(ve++&&dt(ne,I.slice(me,L),A),me=L)}return ne}function Sr(E,N){var A=N||{},I=A.boundary||"SheetJS";I="------="+I;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],M=E.FullPaths[0],ee=M,le=E.FileIndex[0],re=1;re<E.FullPaths.length;++re)if(ee=E.FullPaths[re].slice(M.length),le=E.FileIndex[re],!(!le.size||!le.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var te=le.content,ne=Xe&&Buffer.isBuffer(te)?te.toString("binary"):K(te),me=0,ve=Math.min(1024,ne.length),Ce=0,ye=0;ye<=ve;++ye)(Ce=ne.charCodeAt(ye))>=32&&Ce<128&&++me;var _e=me>=ve*4/5;L.push(I),L.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+ee),L.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),L.push("Content-Type: "+Ke(le,ee)),L.push(""),L.push(_e?Zt(ne):Ut(ne))}return L.push(I+`--\r
`),L.join(`\r
`)}function Gn(E){var N={};return _(N,E),N}function xa(E,N,A,I){var L=I&&I.unsafe;L||_(E);var M=!L&&Re.find(E,N);if(!M){var ee=E.FullPaths[0];N.slice(0,ee.length)==ee?ee=N:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+N).replace("//","/")),M={name:n(N),type:2},E.FileIndex.push(M),E.FullPaths.push(ee),L||Re.utils.cfb_gc(E)}return M.content=A,M.size=A?A.length:0,I&&(I.CLSID&&(M.clsid=I.CLSID),I.mt&&(M.mt=I.mt),I.ct&&(M.ct=I.ct)),M}function Be(E,N){_(E);var A=Re.find(E,N);if(A){for(var I=0;I<E.FileIndex.length;++I)if(E.FileIndex[I]==A)return E.FileIndex.splice(I,1),E.FullPaths.splice(I,1),!0}return!1}function Pe(E,N,A){_(E);var I=Re.find(E,N);if(I){for(var L=0;L<E.FileIndex.length;++L)if(E.FileIndex[L]==I)return E.FileIndex[L].name=n(A),E.FullPaths[L]=A,!0}return!1}function Pa(E){S(E,!0)}return t.find=R,t.read=w,t.parse=f,t.write=Z,t.writeFile=q,t.utils={cfb_new:Gn,cfb_add:xa,cfb_del:Be,cfb_mov:Pe,cfb_gc:Pa,ReadShift:ts,CheckField:z0,prep_blob:Jt,bconcat:Xt,use_zlib:F,_deflateRaw:Ae,_inflateRaw:Oa,consts:se},t})(),yn;function Hp(e){return typeof e=="string"?Ei(e):Array.isArray(e)?pp(e):e}function bs(e,t,r){if(typeof yn!="undefined"&&yn.writeFileSync)return r?yn.writeFileSync(e,t,r):yn.writeFileSync(e,t);if(typeof Deno!="undefined"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ei(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Zr(t):t;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(a,e);if(typeof Blob!="undefined"){var n=new Blob([Hp(a)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs!="undefined")return saveAs(n,e);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ca(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Vp(e){if(typeof yn!="undefined")return yn.readFileSync(e);if(typeof Deno!="undefined")return Deno.readFileSync(e);if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Rt(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function vc(e,t){for(var r=[],a=Rt(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function ki(e){for(var t=[],r=Rt(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Si(e){for(var t=[],r=Rt(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function jp(e){for(var t=[],r=Rt(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var di=new Date(1899,11,30,0,0,0);function Vt(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var a=di.getTime()+(e.getTimezoneOffset()-di.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var R0=new Date,Wp=di.getTime()+(R0.getTimezoneOffset()-di.getTimezoneOffset())*6e4,yc=R0.getTimezoneOffset();function Ci(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Wp),t.getTimezoneOffset()!==yc&&t.setTime(t.getTime()+(t.getTimezoneOffset()-yc)*6e4),t}function Gp(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}t+=r*parseInt(n[s],10)}return t}var _c=new Date("2017-02-19T19:06:09.000Z"),I0=isNaN(_c.getFullYear())?new Date("2/19/17"):_c,zp=I0.getFullYear()==2017;function yt(e,t){var r=new Date(e);if(zp)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(I0.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Wa(e,t){if(Xe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Zr(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Zr(x0(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder!="undefined")try{if(t){if(e[0]==255&&e[1]==254)return Zr(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Zr(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function _t(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=_t(e[r]));return t}function Ct(e,t){for(var r="";r.length<t;)r+=e;return r}function Vr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var Xp=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cn(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Xp.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Yp=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var s=r.split(a),i=[s[0]],o=1;o<s.length;++o)i.push(n),i.push(s[o]);return i}})();function F0(e){return e?e.content&&e.type?Wa(e.content,!0):e.data?Zn(e.data):e.asNodeBuffer&&Xe?Zn(e.asNodeBuffer().toString("binary")):e.asBinary?Zn(e.asBinary()):e._data&&e._data.getContent?Zn(Wa(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function D0(e){if(!e)return null;if(e.data)return bo(e.data);if(e.asNodeBuffer&&Xe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?bo(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Kp(e){return e&&e.name.slice(-4)===".bin"?D0(e):F0(e)}function Ir(e,t){for(var r=e.FullPaths||Rt(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||n==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Ho(e,t){var r=Ir(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mt(e,t,r){if(!r)return Kp(Ho(e,t));if(!t)return null;try{return Mt(e,t)}catch{return null}}function Er(e,t,r){if(!r)return F0(Ho(e,t));if(!t)return null;try{return Er(e,t)}catch{return null}}function N0(e,t,r){if(!r)return D0(Ho(e,t));if(!t)return null;try{return N0(e,t)}catch{return null}}function wc(e){for(var t=e.FullPaths||Rt(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function We(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Xe?a=fa(r):a=hp(r),Re.utils.cfb_add(e,t,a)}Re.utils.cfb_add(e,t,r)}else e.file(t,r)}function Vo(){return Re.utils.cfb_new()}function O0(e,t){switch(t.type){case"base64":return Re.read(e,{type:"base64"});case"binary":return Re.read(e,{type:"binary"});case"buffer":case"array":return Re.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function es(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Nt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Jp=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ec=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,qp=/<[^>]*>/g,or=Nt.match(Ec)?Ec:qp,Zp=/<\w*:/,Qp=/<(\/?)\w+:/;function $e(e,t,r){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var i=e.match(Jp),o=0,l="",c=0,f="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(n=d.charCodeAt(s+1))==34||n==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=l,r||(a[f.toLowerCase()]=l);else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(a[p]&&f.slice(o-3,o)=="ext")continue;a[p]=l,r||(a[p.toLowerCase()]=l)}}return a}function ea(e){return e.replace(Qp,"<$1")}var P0={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},jo=ki(P0),qe=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(o,l){return P0[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,i)+r(n.slice(i+3))}})(),Wo=/[&<>'"]/g,eh=/[\u0000-\u0008\u000b-\u001f]/g;function ct(e){var t=e+"";return t.replace(Wo,function(r){return jo[r]}).replace(eh,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bc(e){return ct(e).replace(/ /g,"_x0020_")}var L0=/[\u0000-\u001f]/g;function Go(e){var t=e+"";return t.replace(Wo,function(r){return jo[r]}).replace(/\n/g,"<br/>").replace(L0,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function th(e){var t=e+"";return t.replace(Wo,function(r){return jo[r]}).replace(L0,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var kc=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function rh(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function co(e){for(var t="",r=0,a=0,n=0,s=0,i=0,o=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){i=(a&31)<<6,i|=n&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((a&7)<<18|(n&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Sc(e){var t=Ea(2*e.length),r,a,n=1,s=0,i=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Cc(e){return fa(e,"binary").toString("utf8")}var Qs="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",ut=Xe&&(Cc(Qs)==co(Qs)&&Cc||Sc(Qs)==co(Qs)&&Sc)||co,Zr=Xe?function(e){return fa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},ds=(function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),$0=(function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),ah=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),nh=/<\/?(?:vt:)?variant>/g,sh=/<(?:vt:)([^>]*)>([\s\S]*)</;function Tc(e,t){var r=$e(e),a=e.match(ah(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var i=s.replace(nh,"").match(sh);i&&n.push({v:ut(i[2]),t:i[1]})}),n}var M0=/(^\s|\s$|\n)/;function qt(e,t){return"<"+e+(t.match(M0)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ps(e){return Rt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ge(e,t,r){return"<"+e+(r!=null?ps(r):"")+(t!=null?(t.match(M0)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ko(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function ih(e,t){switch(typeof e){case"string":var r=ge("vt:lpwstr",ct(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return ge((e|0)==e?"vt:i4":"vt:r8",ct(String(e)));case"boolean":return ge("vt:bool",e?"true":"false")}if(e instanceof Date)return ge("vt:filetime",ko(e));throw new Error("Unable to serialize "+e)}function zo(e){if(Xe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return ut(Ca(Mo(e)));throw new Error("Bad input format: expected Buffer or string")}var hs=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ht={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ka=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_r={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function oh(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function lh(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,i=a?-t:t;isFinite(i)?i==0?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var Ac=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Rc=Xe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:fa(t)})):Ac(e)}:Ac,Ic=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(sa(e,n)));return a.join("").replace(nr,"")},Ti=Xe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(nr,""):Ic(e,t,r)}:Ic,Fc=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},B0=Xe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Fc(e,t,r)}:Fc,Dc=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(vn(e,n)));return a.join("")},Fn=Xe?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Dc(t,r,a)}:Dc,U0=function(e,t){var r=zt(e,t);return r>0?Fn(e,t+4,t+4+r-1):""},Xo=U0,H0=function(e,t){var r=zt(e,t);return r>0?Fn(e,t+4,t+4+r-1):""},Yo=H0,V0=function(e,t){var r=2*zt(e,t);return r>0?Fn(e,t+4,t+4+r-1):""},Ko=V0,j0=function(t,r){var a=zt(t,r);return a>0?Ti(t,r+4,r+4+a):""},Jo=j0,W0=function(e,t){var r=zt(e,t);return r>0?Fn(e,t+4,t+4+r):""},qo=W0,G0=function(e,t){return oh(e,t)},pi=G0,Zo=function(t){return Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array};Xe&&(Xo=function(t,r){if(!Buffer.isBuffer(t))return U0(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Yo=function(t,r){if(!Buffer.isBuffer(t))return H0(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Ko=function(t,r){if(!Buffer.isBuffer(t))return V0(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Jo=function(t,r){if(!Buffer.isBuffer(t))return j0(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},qo=function(t,r){if(!Buffer.isBuffer(t))return W0(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},pi=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):G0(t,r)},Zo=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array});function ch(){Ti=function(e,t,r){return st.utils.decode(1200,e.slice(t,r)).replace(nr,"")},Fn=function(e,t,r){return st.utils.decode(65001,e.slice(t,r))},Xo=function(e,t){var r=zt(e,t);return r>0?st.utils.decode(Sn,e.slice(t+4,t+4+r-1)):""},Yo=function(e,t){var r=zt(e,t);return r>0?st.utils.decode(Qr,e.slice(t+4,t+4+r-1)):""},Ko=function(e,t){var r=2*zt(e,t);return r>0?st.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Jo=function(e,t){var r=zt(e,t);return r>0?st.utils.decode(1200,e.slice(t+4,t+4+r)):""},qo=function(e,t){var r=zt(e,t);return r>0?st.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof st!="undefined"&&ch();var vn=function(e,t){return e[t]},sa=function(e,t){return e[t+1]*256+e[t]},fh=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},zt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},$a=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},uh=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ts(e,t){var r="",a,n,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Xe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(sa(this,c)),c+=2;e*=2;break;case"utf8":r=Fn(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Ti(this,this.l,this.l+e);break;case"wstr":if(typeof st!="undefined")r=st.utils.decode(Qr,this.slice(this.l,this.l+2*e));else return ts.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Xo(this,this.l),e=4+zt(this,this.l);break;case"lpstr-cp":r=Yo(this,this.l),e=4+zt(this,this.l);break;case"lpwstr":r=Ko(this,this.l),e=4+2*zt(this,this.l);break;case"lpp4":e=4+zt(this,this.l),r=Jo(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+zt(this,this.l),r=qo(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=vn(this,this.l+e++))!==0;)s.push(Zs(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=sa(this,this.l+e))!==0;)s.push(Zs(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=vn(this,c),this.l=c+1,o=ts.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Zs(sa(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":if(typeof st!="undefined"){r=st.utils.decode(Qr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=vn(this,c),this.l=c+1,o=ts.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Zs(vn(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return a=vn(this,this.l),this.l++,a;case 2:return a=(t==="i"?fh:sa)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?$a:uh)(this,this.l),this.l+=4,a):(n=zt(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=pi(this,this.l):n=pi([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=B0(this,this.l,e);break}}return this.l+=e,r}var dh=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},ph=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},hh=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function mh(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)hh(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){if(typeof st!="undefined"&&Sn==874)for(n=0;n!=t.length;++n){var s=st.utils.encode(Sn,t.charAt(n));this[this.l+n]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,dh(this,t,this.l);break;case 8:if(a=8,r==="f"){lh(this,t,this.l);break}case 16:break;case-4:a=4,ph(this,t,this.l);break}return this.l+=a,this}function z0(e,t){var r=B0(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Jt(e,t){e.l=t,e.read_shift=ts,e.chk=z0,e.write_shift=mh}function ir(e,t){e.l+=t}function ie(e){var t=Ea(e);return Jt(t,0),t}function ua(e,t,r){if(e){var a,n,s;Jt(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=_s[o]||_s[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;l=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=l,t(f,c,o))return}}}function mr(){var e=[],t=Xe?256:2048,r=function(c){var f=ie(c);return Jt(f,0),f},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(c){return a&&c<a.length-a.l?a:(n(),a=r(Math.max(c+1,t)))},i=function(){return n(),Xt(e)},o=function(c){n(),a=c,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function de(e,t,r,a){var n=+t,s;if(!isNaN(n)){a||(a=_s[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var i=e.next(s);n<=127?i.write_shift(1,n):(i.write_shift(1,(n&127)+128),i.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)i.write_shift(1,(a&127)+128),a>>=7;else{i.write_shift(1,a);break}a>0&&Zo(r)&&e.push(r)}}function rs(e,t,r){var a=_t(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Nc(e,t,r){var a=_t(e);return a.s=rs(a.s,t.s,r),a.e=rs(a.e,t.s,r),a}function as(e,t){if(e.cRel&&e.c<0)for(e=_t(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=_t(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Le(e);return!e.cRel&&e.cRel!=null&&(r=vh(r)),!e.rRel&&e.rRel!=null&&(r=gh(r)),r}function fo(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+kt(e.s.c)+":"+(e.e.cRel?"":"$")+kt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Dt(e.s.r)+":"+(e.e.rRel?"":"$")+Dt(e.e.r):as(e.s,t.biff)+":"+as(e.e,t.biff)}function Qo(e){return parseInt(xh(e),10)-1}function Dt(e){return""+(e+1)}function gh(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xh(e){return e.replace(/\$(\d+)$/,"$1")}function el(e){for(var t=yh(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function kt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function vh(e){return e.replace(/^([A-Z])/,"$$$1")}function yh(e){return e.replace(/^\$([A-Z])/,"$1")}function _h(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function St(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Le(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function gr(e){var t=e.indexOf(":");return t==-1?{s:St(e),e:St(e)}:{s:St(e.slice(0,t)),e:St(e.slice(t+1))}}function He(e,t){return typeof t=="undefined"||typeof t=="number"?He(e.s,e.e):(typeof e!="string"&&(e=Le(e)),typeof t!="string"&&(t=Le(t)),e==t?e:e+":"+t)}function Ze(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function Oc(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Nr(e.z,r?Vt(t):t)}catch{}try{return e.w=Nr((e.XF||{}).numFmtId||(r?14:0),r?Vt(t):t)}catch{return""+t}}function ca(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?da[e.v]||e.v:t==null?Oc(e,e.v):Oc(e,t))}function Ta(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function X0(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense;At!=null&&n==null&&(n=At);var s=e||(n?[]:{}),i=0,o=0;if(s&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var l=typeof a.origin=="string"?St(a.origin):a.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Ze(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(typeof t[d][h]!="undefined"){var p={v:t[d][h]},m=i+d,u=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>u&&(c.s.c=u),c.e.r<m&&(c.e.r=m),c.e.c<u&&(c.e.c=u),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(a.nullError)p.t="e",p.v=0;else if(a.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=a.dateNF||De[14],a.cellDates?(p.t="d",p.w=Nr(p.z,Vt(p.v))):(p.t="n",p.v=Vt(p.v),p.w=Nr(p.z,p.v))):p.t="s";if(n)s[m]||(s[m]=[]),s[m][u]&&s[m][u].z&&(p.z=s[m][u].z),s[m][u]=p;else{var g=Le({c:u,r:m});s[g]&&s[g].z&&(p.z=s[g].z),s[g]=p}}}return c.s.c<1e7&&(s["!ref"]=He(c)),s}function Dn(e,t){return X0(null,e,t)}function wh(e){return e.read_shift(4,"i")}function jr(e,t){return t||(t=ie(4)),t.write_shift(4,e),t}function sr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Yt(e,t){var r=!1;return t==null&&(r=!0,t=ie(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Eh(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bh(e,t){return t||(t=ie(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function tl(e,t){var r=e.l,a=e.read_shift(1),n=sr(e),s=[],i={t:n,h:n};if((a&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(Eh(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function kh(e,t){var r=!1;return t==null&&(r=!0,t=ie(15+4*e.t.length)),t.write_shift(1,0),Yt(e.t,t),r?t.slice(0,t.l):t}var Sh=tl;function Ch(e,t){var r=!1;return t==null&&(r=!0,t=ie(23+4*e.t.length)),t.write_shift(1,1),Yt(e.t,t),t.write_shift(4,1),bh({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Or(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ja(e,t){return t==null&&(t=ie(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function qa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Za(e,t){return t==null&&(t=ie(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Th=sr,Y0=Yt;function rl(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function hi(e,t){var r=!1;return t==null&&(r=!0,t=ie(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Ah=sr,So=rl,al=hi;function nl(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?pi([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):$a(t,0)>>2;return r?n/100:n}function K0(e,t){t==null&&(t=ie(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function J0(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Rh(e,t){return t||(t=ie(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Qa=J0,Nn=Rh;function ar(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ga(e,t){return(t||ie(8)).write_shift(8,e,"f")}function Ih(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var c=Ba[n];c&&(t.rgb=gs(c));break;case 2:t.rgb=gs([i,o,l]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function mi(e,t){if(t||(t=ie(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function Fh(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Dh(e,t){t||(t=ie(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function q0(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Nh(e){return q0(e,1)}function Oh(e){return q0(e,2)}var sl=2,hr=3,ei=11,Pc=12,gi=19;var ti=64,Ph=65,Lh=71;var $h=4108,Mh=4126,Gt=80,Z0=81,Bh=[Gt,Z0],Co={1:{n:"CodePage",t:sl},2:{n:"Category",t:Gt},3:{n:"PresentationFormat",t:Gt},4:{n:"ByteCount",t:hr},5:{n:"LineCount",t:hr},6:{n:"ParagraphCount",t:hr},7:{n:"SlideCount",t:hr},8:{n:"NoteCount",t:hr},9:{n:"HiddenCount",t:hr},10:{n:"MultimediaClipCount",t:hr},11:{n:"ScaleCrop",t:ei},12:{n:"HeadingPairs",t:$h},13:{n:"TitlesOfParts",t:Mh},14:{n:"Manager",t:Gt},15:{n:"Company",t:Gt},16:{n:"LinksUpToDate",t:ei},17:{n:"CharacterCount",t:hr},19:{n:"SharedDoc",t:ei},22:{n:"HyperlinksChanged",t:ei},23:{n:"AppVersion",t:hr,p:"version"},24:{n:"DigSig",t:Ph},26:{n:"ContentType",t:Gt},27:{n:"ContentStatus",t:Gt},28:{n:"Language",t:Gt},29:{n:"Version",t:Gt},255:{},2147483648:{n:"Locale",t:gi},2147483651:{n:"Behavior",t:gi},1919054434:{}},To={1:{n:"CodePage",t:sl},2:{n:"Title",t:Gt},3:{n:"Subject",t:Gt},4:{n:"Author",t:Gt},5:{n:"Keywords",t:Gt},6:{n:"Comments",t:Gt},7:{n:"Template",t:Gt},8:{n:"LastAuthor",t:Gt},9:{n:"RevNumber",t:Gt},10:{n:"EditTime",t:ti},11:{n:"LastPrinted",t:ti},12:{n:"CreatedDate",t:ti},13:{n:"ModifiedDate",t:ti},14:{n:"PageCount",t:hr},15:{n:"WordCount",t:hr},16:{n:"CharCount",t:hr},17:{n:"Thumbnail",t:Lh},18:{n:"Application",t:Gt},19:{n:"DocSecurity",t:hr},255:{},2147483648:{n:"Locale",t:gi},2147483651:{n:"Behavior",t:gi},1919054434:{}},Lc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Uh=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Hh(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Vh=Hh([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ba=_t(Vh),da={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Q0={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ao={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ri={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function il(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function jh(e){var t=il();if(!e||!e.match)return t;var r={};if((e.match(or)||[]).forEach(function(a){var n=$e(a);switch(n[0].replace(Zp,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Ao[n.ContentType]]!==void 0&&t[Ao[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Ht.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function ef(e,t){var r=jp(Ao),a=[],n;a[a.length]=Nt,a[a.length]=ge("Types",null,{xmlns:Ht.CT,"xmlns:xsd":Ht.xsd,"xmlns:xsi":Ht.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ge("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(n=e[l][0],a[a.length]=ge("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:ri[l][t.bookType]||ri[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(c){a[a.length]=ge("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:ri[l][t.bookType]||ri[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){a[a.length]=ge("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Ge={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ms(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ns(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(or)||[]).forEach(function(n){var s=$e(n);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:es(s.Target,t);r[o]=i,a[s.Id]=i}}),r["!id"]=a,r}function En(e){var t=[Nt,ge("Relationships",null,{xmlns:Ht.RELS})];return Rt(e["!id"]).forEach(function(r){t[t.length]=ge("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function lt(e,t,r,a,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,s?n.TargetMode=s:[Ge.HLINK,Ge.XPATH,Ge.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var Wh="application/vnd.oasis.opendocument.spreadsheet";function Gh(e,t){for(var r=zo(e),a,n;a=hs.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=$e(a[0],!1),n.path=="/"&&n.type!==Wh)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function zh(e){var t=[Nt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function $c(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Xh(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Yh(e){var t=[Nt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push($c(e[r][0],e[r][1])),t.push(Xh("",e[r][0]));return t.push($c("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function tf(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+cs.version+"</meta:generator></office:meta></office:document-meta>"}var Dr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Kh=(function(){for(var e=new Array(Dr.length),t=0;t<Dr.length;++t){var r=Dr[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function rf(e){var t={};e=ut(e);for(var r=0;r<Dr.length;++r){var a=Dr[r],n=e.match(Kh[r]);n!=null&&n.length>0&&(t[a[1]]=qe(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=yt(t[a[1]]))}return t}function uo(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=ct(t),a[a.length]=r?ge(e,t,r):qt(e,t))}function af(e,t){var r=t||{},a=[Nt,ge("cp:coreProperties",null,{"xmlns:cp":Ht.CORE_PROPS,"xmlns:dc":Ht.dc,"xmlns:dcterms":Ht.dcterms,"xmlns:dcmitype":Ht.dcmitype,"xmlns:xsi":Ht.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&uo("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:ko(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&uo("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:ko(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=Dr.length;++s){var i=Dr[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&uo(i[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Ua=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],nf=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sf(e,t,r,a){var n=[];if(typeof e=="string")n=Tc(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?Tc(t,a).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==n.length;c+=2){switch(l=+n[c+1].v,n[c].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function Jh(e,t,r){var a={};return t||(t={}),e=ut(e),Ua.forEach(function(n){var s=(e.match(ds(n[0]))||[])[1];switch(n[2]){case"string":s&&(t[n[1]]=qe(s));break;case"bool":t[n[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(a[n[1]]=i[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&sf(a.HeadingPairs,a.TitlesOfParts,t,r),t}function of(e){var t=[],r=ge;return e||(e={}),e.Application="SheetJS",t[t.length]=Nt,t[t.length]=ge("Properties",null,{xmlns:Ht.EXT_PROPS,"xmlns:vt":Ht.vt}),Ua.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=ct(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+ct(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var qh=/<[^>]+>[^<]*/g;function Zh(e,t){var r={},a="",n=e.match(qh);if(n)for(var s=0;s!=n.length;++s){var i=n[s],o=$e(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=qe(o.name);break;case"</property>":a=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[a]=qe(f);break;case"bool":r[a]=vt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(f);break;case"filetime":case"date":r[a]=yt(f);break;case"cy":case"error":r[a]=qe(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console!="undefined"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function lf(e){var t=[Nt,ge("Properties",null,{xmlns:Ht.CUST_PROPS,"xmlns:vt":Ht.vt})];if(!e)return t.join("");var r=1;return Rt(e).forEach(function(n){++r,t[t.length]=ge("property",ih(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ct(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Ro={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},po;function Qh(e,t,r){po||(po=ki(Ro)),t=po[t]||t,e[t]=r}function em(e,t){var r=[];return Rt(Ro).map(function(a){for(var n=0;n<Dr.length;++n)if(Dr[n][1]==a)return Dr[n];for(n=0;n<Ua.length;++n)if(Ua[n][1]==a)return Ua[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(qt(Ro[a[1]]||a[1],n))}}),ge("DocumentProperties",r.join(""),{xmlns:_r.o})}function tm(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Rt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<Dr.length;++i)if(s==Dr[i][1])return;for(i=0;i<Ua.length;++i)if(s==Ua[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),n.push(ge(bc(s),o,{"dt:dt":l}))}}),t&&Rt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),n.push(ge(bc(s),i,{"dt:dt":o}))}}),"<"+a+' xmlns="'+_r.o+'">'+n.join("")+"</"+a+">"}function ol(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function rm(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var i=ie(8);return i.write_shift(4,a),i.write_shift(4,n),i}function cf(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function ff(e,t,r){var a=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(a.length+1&3)&3),a}function uf(e,t,r){return t===31?ff(e):cf(e,t,r)}function Io(e,t,r){return uf(e,t,r===!1?0:4)}function am(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return uf(e,t,0)}function nm(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(nr,""),e.l-n&2&&(e.l+=2)}return r}function sm(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(nr,"");return r}function im(e){var t=e.l,r=xi(e,Z0);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=xi(e,hr);return[r,a]}function om(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(im(e));return r}function Mc(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),i=e.read_shift(4);a[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(nr,"").replace(Qn,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function df(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function lm(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function xi(e,t,r){var a=e.read_shift(2),n,s=r||{};if(e.l+=2,t!==Pc&&a!==t&&Bh.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Pc?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return cf(e,a,4).replace(nr,"");case 31:return ff(e);case 64:return ol(e);case 65:return df(e);case 71:return lm(e);case 80:return Io(e,a,!s.raw).replace(nr,"");case 81:return am(e,a).replace(nr,"");case 4108:return om(e);case 4126:case 4127:return a==4127?nm(e):sm(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Bc(e,t){var r=ie(4),a=ie(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ie(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=rm(t);break;case 31:case 80:for(a=ie(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Xt([r,a])}function Uc(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=n;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(y,x){return y[1]-x[1]});var h={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(h[m.n]=xi(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ur(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(s[i][0]===1){if(o=h.CodePage=xi(e,sl),Ur(o),l!==-1){var u=e.l;e.l=s[l][1],c=Mc(e,o),e.l=u}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=Mc(e,o)}else{var g=c[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=df(e);break;case 30:e.l+=4,v=Io(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Io(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Ft(e,4);break;case 64:e.l+=4,v=yt(ol(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=r+a,h}var pf=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function cm(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Hc(e,t,r){var a=ie(8),n=[],s=[],i=8,o=0,l=ie(8),c=ie(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),n.push(c),i+=8+l.length,!t){c=ie(8),c.write_shift(4,0),n.unshift(c);var f=[ie(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=ie(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Xt(f),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(pf.indexOf(e[o][0])>-1||nf.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var m=r[p];if(m.p=="version"&&typeof h=="string"){var u=h.split(".");h=(+u[0]<<16)+(+u[1]||0)}l=Bc(m.t,h)}else{var g=cm(h);g==-1&&(g=31,h=String(h)),l=Bc(g,h)}s.push(l),c=ie(8),c.write_shift(4,t?p:2+o),n.push(c),i+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,v),v+=s[o].length;return a.write_shift(4,i),a.write_shift(4,s.length),Xt([a].concat(n).concat(s))}function Vc(e,t,r){var a=e.content;if(!a)return{};Jt(a,0);var n,s,i,o,l=0;a.chk("feff","Byte Order: "),a.read_shift(2);var c=a.read_shift(4),f=a.read_shift(16);if(f!==Re.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(i=a.read_shift(16),l=a.read_shift(4));var d=Uc(a,t),h={SystemIdentifier:c};for(var p in d)h[p]=d[p];if(h.FMTID=s,n===1)return h;if(l-a.l==2&&(a.l+=2),a.l!==l)throw new Error("Length mismatch 2: "+a.l+" !== "+l);var m;try{m=Uc(a,null)}catch{}for(p in m)h[p]=m[p];return h.FMTID=[s,i],h}function jc(e,t,r,a,n,s){var i=ie(n?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Re.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var l=Hc(e,r,a);if(o.push(l),n){var c=Hc(n,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return Xt(o)}function ya(e,t){return e.read_shift(t),null}function fm(e,t){t||(t=ie(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function um(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Ft(e,t){return e.read_shift(t)===1}function ur(e,t){return t||(t=ie(2)),t.write_shift(2,+!!e),t}function Bt(e){return e.read_shift(2,"u")}function Fr(e,t){return t||(t=ie(2)),t.write_shift(2,e),t}function hf(e,t){return um(e,t,Bt)}function dm(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function mf(e,t,r){return r||(r=ie(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ks(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont",s=Qr;if(r&&r.biff>=8&&(Qr=1200),!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return Qr=s,o}function pm(e){var t=Qr;Qr=1200;var r=e.read_shift(2),a=e.read_shift(1),n=a&4,s=a&8,i=1+(a&1),o=0,l,c={};s&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",d=r===0?"":e.read_shift(r,f);return s&&(e.l+=4*o),n&&(e.l+=l),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Qr=t,c}function hm(e){var t=e.t||"",r=1,a=ie(3+(r>1?2:0));a.write_shift(2,t.length),a.write_shift(1,(r>1?8:0)|1),r>1&&a.write_shift(2,r);var n=ie(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[a,n];return Xt(s)}function za(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Ss(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):za(e,a,r)}function en(e,t,r){if(r.biff>5)return Ss(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function gf(e,t,r){return r||(r=ie(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function mm(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function gm(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(nr,"");return a&&(e.l+=24),n}function xm(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(nr,"");return r+i}function vm(e,t){var r=e.read_shift(16);switch(t-=16,r){case"e0c9ea79f9bace118c8200aa004ba90b":return gm(e,t);case"0303000000000000c000000000000046":return xm(e,t);default:throw new Error("Unsupported Moniker "+r)}}function ai(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(nr,""):"";return r}function Wc(e,t){t||(t=ie(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function ym(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,i,o,l,c="",f,d;n&16&&(s=ai(e,r-e.l)),n&128&&(i=ai(e,r-e.l)),(n&257)===257&&(o=ai(e,r-e.l)),(n&257)===1&&(l=vm(e,r-e.l)),n&8&&(c=ai(e,r-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(d=ol(e)),e.l=r;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return f&&(p.guid=f),d&&(p.time=d),s&&(p.Tooltip=s),p}function _m(e){var t=ie(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)a=a.slice(1),Wc(a,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Wc(n>-1?a.slice(n+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;a.slice(l*3,l*3+3)=="../"||a.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,a.length-3*l+1),r=0;r<a.length-3*l;++r)t.write_shift(1,a.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function xf(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function vf(e,t){var r=xf(e,t);return r[3]=0,r}function ta(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Xa(e,t,r,a){return a||(a=ie(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function wm(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Em(e,t,r){return t===0?"":en(e,t,r)}function bm(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[n,s,i]}function yf(e){var t=e.read_shift(2),r=nl(e);return[t,r]}function km(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=ks(e,t,r),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function Ai(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function _f(e,t){return t||(t=ie(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function wf(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var Sm=wf;function Ef(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function Cm(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Tm(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Qt(e){e.l+=2,e.l+=e.read_shift(2)}var Am={0:Qt,4:Qt,5:Qt,6:Qt,7:Tm,8:Qt,9:Qt,10:Qt,11:Qt,12:Qt,13:Cm,14:Qt,15:Qt,16:Qt,17:Qt,18:Qt,19:Qt,20:Qt,21:Ef};function Rm(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(Am[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function ni(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ll(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ie(n);return s.write_shift(2,a),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Im(e,t){return t===0||e.read_shift(2),1200}function Fm(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=en(e,0,r);return e.read_shift(t+a-e.l),n}function Dm(e,t){var r=!t||t.biff==8,a=ie(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function Nm(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Om(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=ks(e,0,r);return i.length===0&&(i="Sheet1"),{pos:a,hs:n,dt:s,name:i}}function Pm(e,t){var r=!t||t.biff>=8?2:1,a=ie(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function Lm(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<r;++i)s.push(pm(e));return s.Count=a,s.Unique=n,s}function $m(e,t){var r=ie(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=hm(e[n],t);var s=Xt([r].concat(a));return s.parts=[r.length].concat(a.map(function(i){return i.length})),s}function Mm(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Bm(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function Um(e){var t=wm(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Hm(e){return e.read_shift(2),e.read_shift(4)}function Gc(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function Vm(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function jm(){var e=ie(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Wm(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Gm(e){var t=ie(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function zm(){}function Xm(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=ks(e,0,r),a}function Ym(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,s=ie(n);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function Km(e){var t=ta(e);return t.isst=e.read_shift(4),t}function Jm(e,t,r,a){var n=ie(10);return Xa(e,t,a,n),n.write_shift(4,r),n}function qm(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=ta(e,6);r.biff==2&&e.l++;var s=Ss(e,a-e.l,r);return n.val=s,n}function Zm(e,t,r,a,n){var s=!n||n.biff==8,i=ie(8+ +s+(1+s)*r.length);return Xa(e,t,a,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function Qm(e,t,r){var a=e.read_shift(2),n=en(e,0,r);return[a,n]}function eg(e,t,r,a){var n=r&&r.biff==5;a||(a=ie(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}var tg=en;function zc(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(2),l=e.read_shift(2);return e.l=a,{s:{r:s,c:o},e:{r:i,c:l}}}function rg(e,t){var r=t.biff==8||!t.biff?4:2,a=ie(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function ag(e){var t=e.read_shift(2),r=e.read_shift(2),a=yf(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function ng(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(yf(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:i,rkrec:s}}function sg(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:i,ixfe:s}}function ig(e,t,r,a){var n={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return n.patternType=Uh[o>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=l&127,n.icvBack=l>>7&127,n.fsxButton=l>>14&1),n}function og(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=ig(e,t,a.fStyle,r),a}function Xc(e,t,r,a){var n=r&&r.biff==5;a||(a=ie(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function lg(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function cg(e){var t=ie(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function Yc(e,t,r){var a=ta(e,6);(r.biff==2||t==9)&&++e.l;var n=dm(e,2);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function fg(e,t,r,a,n,s){var i=ie(8);return Xa(e,t,a,i),mf(r,s,i),i}function ug(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=ta(e,6),n=ar(e,8);return a.val=n,a}function dg(e,t,r,a){var n=ie(14);return Xa(e,t,a,n),Ga(r,n),n}var Kc=Em;function pg(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=za(e,s),o=[];a>e.l;)o.push(Ss(e));return[s,n,i,o]}function Jc(e,t,r){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=km(e,t-2,r)),s.body=n||e.read_shift(t-2),typeof n=="string"&&(s.Name=n),s}var hg=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qc(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=za(e,i,r);n&32&&(c=hg[c.charCodeAt(0)]);var f=a-e.l;r&&r.biff==2&&--f;var d=a==e.l||o===0||!(f>0)?[]:Ry(e,f,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function bf(e,t,r){if(r.biff<8)return mg(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(bm(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function mg(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=ks(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function gg(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),s=za(e,a,r),i=za(e,n,r);return[s,i]}function xg(e,t,r){var a=wf(e,6);e.l++;var n=e.read_shift(1);return t-=8,[Iy(e,t,r),n,a]}function Zc(e,t,r){var a=Sm(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,Ty(e,t,r,a)]}function vg(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function yg(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=en(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},o,i,s]}}function _g(e,t,r){return yg(e,t,r)}function wg(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Ai(e,t));return r}function Eg(e){var t=ie(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)_f(e[r],t);return t}function bg(e,t,r){if(r&&r.biff<8)return Sg(e,t,r);var a=Ef(e,22),n=Rm(e,t-22,a[1]);return{cmo:a,ft:n}}var kg={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function Sg(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((kg[a]||ir)(e,t,r)),{cmo:[n,a,s],ft:i}}function Cg(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=mm(e,6,r);var o=e.read_shift(2);e.read_shift(2),Bt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-a!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],d=za(e,e.lens[c+1]-e.lens[c]-1);if(n+=d,n.length>=(f?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function Tg(e,t){var r=Ai(e,8);e.l+=16;var a=ym(e,t-24);return[r,a]}function Ag(e){var t=ie(24),r=St(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return Xt([t,_m(e[1])])}function Rg(e,t){e.read_shift(2);var r=Ai(e,8),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(nr,""),[r,a]}function Ig(e){var t=e[1].Tooltip,r=ie(10+2*(t.length+1));r.write_shift(2,2048);var a=St(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function Fg(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Lc[r]||r,r=e.read_shift(2),t[1]=Lc[r]||r,t}function Dg(e){return e||(e=ie(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Ng(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(vf(e,8));return r}function Og(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(vf(e,8));return r}function Pg(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function kf(e,t,r){if(!r.cellStyles)return ir(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2);a==2&&(e.l+=2);var c={s:n,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Lg(e,t){var r=ie(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function $g(e,t){var r={};return t<32||(e.l+=16,r.header=ar(e,8),r.footer=ar(e,8),e.l+=2),r}function Mg(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function Bg(e){for(var t=ie(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Ug=ta,Hg=hf,Vg=Ss;function jg(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function Wg(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=ta(e,6);++e.l;var n=en(e,t-7,r);return a.t="str",a.val=n,a}function Gg(e){var t=ta(e,6);++e.l;var r=ar(e,8);return t.t="n",t.val=r,t}function zg(e,t,r){var a=ie(15);return Rs(a,e,t),a.write_shift(8,r,"f"),a}function Xg(e){var t=ta(e,6);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Yg(e,t,r){var a=ie(9);return Rs(a,e,t),a.write_shift(2,r),a}function Kg(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Jg(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function qg(e,t,r){var a=e.l+t,n=ta(e,6),s=e.read_shift(2),i=za(e,s,r);return e.l=a,n.t="str",n.val=i,n}var Zg=[2,3,48,49,131,139,140,245],Fo=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ki({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Ea(1);switch(l.type){case"base64":f=wr(br(o));break;case"binary":f=wr(o);break;case"buffer":case"array":f=o;break}Jt(f,0);var d=f.read_shift(1),h=!!(d&136),p=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var u=0,g=521;d==2&&(u=f.read_shift(2)),f.l+=3,d!=2&&(u=f.read_shift(4)),u>1048576&&(u=1e6),d!=2&&(g=f.read_shift(2));var v=f.read_shift(2),y=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var x=[],b={},C=Math.min(f.length,d==2?521:g-10-(p?264:0)),w=m?32:11;f.l<C&&f[f.l]!=13;)switch(b={},b.name=st.utils.decode(y,f.slice(f.l,f.l+w)).replace(/[\u0000\r\n].*$/g,""),f.l+=w,b.type=String.fromCharCode(f.read_shift(1)),d!=2&&!m&&(b.offset=f.read_shift(4)),b.len=f.read_shift(1),d==2&&(b.offset=f.read_shift(2)),b.dec=f.read_shift(1),b.name.length&&x.push(b),d!=2&&(f.l+=m?13:14),b.type){case"B":(!p||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var _=0,k=0;for(c[0]=[],k=0;k!=x.length;++k)c[0][k]=x[k].name;for(;u-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,c[++_]=[],k=0,k=0;k!=x.length;++k){var S=f.slice(f.l,f.l+x[k].len);f.l+=x[k].len,Jt(S,0);var D=st.utils.decode(y,S);switch(x[k].type){case"C":D.trim().length&&(c[_][k]=D.replace(/\s+$/,""));break;case"D":D.length===8?c[_][k]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):c[_][k]=D;break;case"F":c[_][k]=parseFloat(D.trim());break;case"+":case"I":c[_][k]=m?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":c[_][k]=!0;break;case"N":case"F":c[_][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[_][k]="##MEMO##"+(m?parseInt(D.trim(),10):S.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(c[_][k]=+D||0);break;case"@":c[_][k]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[_][k]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[_][k]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[_][k]=-S.read_shift(-8,"f");break;case"B":if(p&&x[k].len==8){c[_][k]=S.read_shift(8,"f");break}case"G":case"P":S.l+=x[k].len;break;case"0":if(x[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[k].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function a(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=Dn(r(o,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function n(o,l){try{return Ta(a(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Ur(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=mr(),d=wi(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),m=o["!cols"]||[],u=0,g=0,v=0,y=1;for(u=0;u<h.length;++u){if(((m[u]||{}).DBF||{}).name){h[u]=m[u].DBF.name,++v;continue}if(h[u]!=null){if(++v,typeof h[u]=="number"&&(h[u]=h[u].toString(10)),typeof h[u]!="string")throw new Error("DBF Invalid column name "+h[u]+" |"+typeof h[u]+"|");if(h.indexOf(h[u])!==u){for(g=0;g<1024;++g)if(h.indexOf(h[u]+"_"+g)==-1){h[u]+="_"+g;break}}}}var x=Ze(o["!ref"]),b=[],C=[],w=[];for(u=0;u<=x.e.c-x.s.c;++u){var _="",k="",S=0,D=[];for(g=0;g<p.length;++g)p[g][u]!=null&&D.push(p[g][u]);if(D.length==0||h[u]==null){b[u]="?";continue}for(g=0;g<D.length;++g){switch(typeof D[g]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=D[g]instanceof Date?"D":"C";break;default:k="C"}S=Math.max(S,String(D[g]).length),_=_&&_!=k?"C":k}S>250&&(S=250),k=((m[u]||{}).DBF||{}).type,k=="C"&&m[u].DBF.len>S&&(S=m[u].DBF.len),_=="B"&&k=="N"&&(_="N",w[u]=m[u].DBF.dec,S=m[u].DBF.len),C[u]=_=="C"||k=="N"?S:s[_]||0,y+=C[u],b[u]=_}var R=f.next(32);for(R.write_shift(4,318902576),R.write_shift(4,p.length),R.write_shift(2,296+32*v),R.write_shift(2,y),u=0;u<4;++u)R.write_shift(4,0);for(R.write_shift(4,0|(+t[Sn]||3)<<8),u=0,g=0;u<h.length;++u)if(h[u]!=null){var T=f.next(32),V=(h[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,V,"sbcs"),T.write_shift(1,b[u]=="?"?"C":b[u],"sbcs"),T.write_shift(4,g),T.write_shift(1,C[u]||s[b[u]]||0),T.write_shift(1,w[u]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),g+=C[u]||s[b[u]]||0}var G=f.next(264);for(G.write_shift(4,13),u=0;u<65;++u)G.write_shift(4,0);for(u=0;u<p.length;++u){var W=f.next(y);for(W.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(b[g]){case"L":W.write_shift(1,p[u][g]==null?63:p[u][g]?84:70);break;case"B":W.write_shift(8,p[u][g]||0,"f");break;case"N":var j="0";for(typeof p[u][g]=="number"&&(j=p[u][g].toFixed(w[g]||0)),v=0;v<C[g]-j.length;++v)W.write_shift(1,32);W.write_shift(1,j,"sbcs");break;case"D":p[u][g]?(W.write_shift(4,("0000"+p[u][g].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(p[u][g].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+p[u][g].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var se=String(p[u][g]!=null?p[u][g]:"").slice(0,C[g]);for(W.write_shift(1,se,"sbcs"),v=0;v<C[g]-se.length;++v)W.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:i}})(),Sf=(function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Rt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var m=e[p];return typeof m=="number"?cc(m):m},a=function(h,p,m){var u=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return u==59?h:cc(u)};e["|"]=254;function n(h,p){switch(p.type){case"base64":return s(br(h),p);case"binary":return s(h,p);case"buffer":return s(Xe&&Buffer.isBuffer(h)?h.toString("binary"):Ca(h),p);case"array":return s(Wa(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var m=h.split(/[\n\r]+/),u=-1,g=-1,v=0,y=0,x=[],b=[],C=null,w={},_=[],k=[],S=[],D=0,R;for(+p.codepage>=0&&Ur(+p.codepage);v!==m.length;++v){D=0;var T=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),V=T.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),G=V[0],W;if(T.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&b.push(T.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,se=!1,q=!1,K=!1,Z=-1,X=-1;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"A":break;case"X":g=parseInt(V[y].slice(1))-1,se=!0;break;case"Y":for(u=parseInt(V[y].slice(1))-1,se||(g=0),R=x.length;R<=u;++R)x[R]=[];break;case"K":W=V[y].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(Vr(W))?isNaN(Cn(W).getDate())||(W=yt(W)):(W=Vr(W),C!==null&&Rn(C)&&(W=Ci(W))),typeof st!="undefined"&&typeof W=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(W=st.utils.decode(p.codepage,W)),j=!0;break;case"E":K=!0;var F=bn(V[y].slice(1),{r:u,c:g});x[u][g]=[x[u][g],F];break;case"S":q=!0,x[u][g]=[x[u][g],"S5S"];break;case"G":break;case"R":Z=parseInt(V[y].slice(1))-1;break;case"C":X=parseInt(V[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}if(j&&(x[u][g]&&x[u][g].length==2?x[u][g][0]=W:x[u][g]=W,C=null),q){if(K)throw new Error("SYLK shared formula cannot have own formula");var U=Z>-1&&x[Z][X];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");x[u][g][1]=jf(U[1],{r:u-Z,c:g-X})}break;case"F":var P=0;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"X":g=parseInt(V[y].slice(1))-1,++P;break;case"Y":for(u=parseInt(V[y].slice(1))-1,R=x.length;R<=u;++R)x[R]=[];break;case"M":D=parseInt(V[y].slice(1))/20;break;case"F":break;case"G":break;case"P":C=b[parseInt(V[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=V[y].slice(1).split(" "),R=parseInt(S[0],10);R<=parseInt(S[1],10);++R)D=parseInt(S[2],10),k[R-1]=D===0?{hidden:!0}:{wch:D},ba(k[R-1]);break;case"C":g=parseInt(V[y].slice(1))-1,k[g]||(k[g]={});break;case"R":u=parseInt(V[y].slice(1))-1,_[u]||(_[u]={}),D>0?(_[u].hpt=D,_[u].hpx=An(D)):D===0&&(_[u].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}P<1&&(C=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}}return _.length>0&&(w["!rows"]=_),k.length>0&&(w["!cols"]=k),p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),[x,w]}function i(h,p){var m=n(h,p),u=m[0],g=m[1],v=Dn(u,p);return Rt(g).forEach(function(y){v[y]=g[y]}),v}function o(h,p){return Ta(i(h,p),p)}function l(h,p,m,u){var g="C;Y"+(m+1)+";X"+(u+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+hl(h.f,{r:m,c:u}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,p){p.forEach(function(m,u){var g="F;W"+(u+1)+" "+(u+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=xs(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=vs(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function f(h,p){p.forEach(function(m,u){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*ys(m.hpx)+";"),g.length>2&&h.push(g+"R"+(u+1))})}function d(h,p){var m=["ID;PWXL;N;E"],u=[],g=Ze(h["!ref"]),v,y=Array.isArray(h),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&c(m,h["!cols"]),h["!rows"]&&f(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var b=g.s.r;b<=g.e.r;++b)for(var C=g.s.c;C<=g.e.c;++C){var w=Le({r:b,c:C});v=y?(h[b]||[])[C]:h[w],!(!v||v.v==null&&(!v.f||v.F))&&u.push(l(v,h,b,C,p))}return m.join(x)+x+u.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:i,from_sheet:d}})(),Cf=(function(){function e(s,i){switch(i.type){case"base64":return t(br(s),i);case"binary":return t(s,i);case"buffer":return t(Xe&&Buffer.isBuffer(s)?s.toString("binary"):Ca(s),i);case"array":return t(Wa(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[f].trim().split(","),p=h[0],m=h[1];++f;for(var u=o[f]||"";(u.match(/["]/g)||[]).length&1&&f<o.length-1;)u+=`
`+o[++f];switch(u=u.trim(),+p){case-1:if(u==="BOT"){d[++l]=[],c=0;continue}else if(u!=="EOD")throw new Error("Unrecognized DIF special command "+u);break;case 0:u==="TRUE"?d[l][c]=!0:u==="FALSE"?d[l][c]=!1:isNaN(Vr(m))?isNaN(Cn(m).getDate())?d[l][c]=m:d[l][c]=yt(m):d[l][c]=Vr(m),++c;break;case 1:u=u.slice(1,u.length-1),u=u.replace(/""/g,'"'),Jn&&u&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),d[l][c++]=u!==""?u:null;break}if(u==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return Dn(e(s,i),i)}function a(s,i){return Ta(r(s,i),i)}var n=(function(){var s=function(l,c,f,d,h){l.push(c),l.push(f+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,f,d){l.push(c+","+f),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],f=Ze(l["!ref"]),d,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(c,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var u=Le({r:p,c:m});if(d=h?(l[p]||[])[m]:l[u],!d){i(c,1,0,"");continue}switch(d.t){case"n":var g=Jn?d.w:d.v;!g&&d.v!=null&&(g=d.v),g==null?Jn&&d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,g,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,!Jn||isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Nr(d.z||De[14],Vt(yt(d.v)))),Jn?i(c,0,d.w,"V"):i(c,1,0,d.w);break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var v=`\r
`,y=c.join(v);return y}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),Tf=(function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),m=-1,u=-1,g=0,v=[];g!==p.length;++g){var y=p[g].trim().split(":");if(y[0]==="cell"){var x=St(y[1]);if(v.length<=x.r)for(m=v.length;m<=x.r;++m)v[m]||(v[m]=[]);switch(m=x.r,u=x.c,y[2]){case"t":v[m][u]=e(y[3]);break;case"v":v[m][u]=+y[3];break;case"vtf":var b=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][u]=!!+y[4];break;default:v[m][u]=+y[4];break}y[2]=="vtf"&&(v[m][u]=[v[m][u],b])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function a(d,h){return Dn(r(d,h),h)}function n(d,h){return Ta(a(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],m,u="",g=gr(d["!ref"]),v=Array.isArray(d),y=g.s.r;y<=g.e.r;++y)for(var x=g.s.c;x<=g.e.c;++x)if(u=Le({r:y,c:x}),m=v?(d[y]||[])[x]:d[u],!(!m||m.v==null||m.t==="z")){switch(p=["cell",u,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var b=Vt(yt(m.v));p[2]="vtc",p[3]="nd",p[4]=""+b,p[5]=m.w||Nr(m.z||De[14],b);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[s,i,o,i,c(d),l].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}})(),Tn=(function(){function e(f,d,h,p,m){m.raw?d[h][p]=f:f===""||(f==="TRUE"?d[h][p]=!0:f==="FALSE"?d[h][p]=!1:isNaN(Vr(f))?isNaN(Cn(f).getDate())?d[h][p]=f:d[h][p]=yt(f):d[h][p]=Vr(f))}function t(f,d){var h=d||{},p=[];if(!f||f.length===0)return p;for(var m=f.split(/[\r\n]/),u=m.length-1;u>=0&&m[u].length===0;)--u;for(var g=10,v=0,y=0;y<=u;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,g=Math.max(g,v);for(y=0;y<=u;++y){p[y]=[];var x=0;for(e(m[y].slice(0,g).trim(),p,y,x,h),x=1;x<=(m[y].length-g)/10+1;++x)e(m[y].slice(g+(x-1)*10,g+x*10).trim(),p,y,x,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var d={},h=!1,p=0,m=0;p<f.length;++p)(m=f.charCodeAt(p))==34?h=!h:!h&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p]);if(!m.length){d=a;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p])}return m.sort(function(u,g){return u[0]-g[0]||a[u[1]]-a[g[1]]}),r[m.pop()[1]]||44}function s(f,d){var h=d||{},p="";At!=null&&h.dense==null&&(h.dense=At);var m=h.dense?[]:{},u={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=n(f.slice(0,1024)):h&&h.FS?p=h.FS:p=n(f.slice(0,1024));var g=0,v=0,y=0,x=0,b=0,C=p.charCodeAt(0),w=!1,_=0,k=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?Mp(h.dateNF):null;function D(){var R=f.slice(x,b),T={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)T.t="z";else if(h.raw)T.t="s",T.v=R;else if(R.trim().length===0)T.t="s",T.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(T.t="s",T.v=R.slice(2,-1).replace(/""/g,'"')):pv(R)?(T.t="n",T.f=R.slice(1)):(T.t="s",T.v=R);else if(R=="TRUE")T.t="b",T.v=!0;else if(R=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=Vr(R)))T.t="n",h.cellText!==!1&&(T.w=R),T.v=y;else if(!isNaN(Cn(R).getDate())||S&&R.match(S)){T.z=h.dateNF||De[14];var V=0;S&&R.match(S)&&(R=Bp(R,h.dateNF,R.match(S)||[]),V=1),h.cellDates?(T.t="d",T.v=yt(R,V)):(T.t="n",T.v=Vt(yt(R,V))),h.cellText!==!1&&(T.w=Nr(T.z,T.v instanceof Date?Vt(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=R;if(T.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][v]=T):m[Le({c:v,r:g})]=T),x=b+1,k=f.charCodeAt(x),u.e.c<v&&(u.e.c=v),u.e.r<g&&(u.e.r=g),_==C)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;b<f.length;++b)switch(_=f.charCodeAt(b)){case 34:k===34&&(w=!w);break;case C:case 10:case 13:if(!w&&D())break e;break;default:break}return b-x>0&&D(),m["!ref"]=He(u),m}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):Dn(t(f,d),d)}function o(f,d){var h="",p=d.type=="string"?[0,0,0,0]:El(f,d);switch(d.type){case"base64":h=br(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof st!="undefined"?h=st.utils.decode(d.codepage,f):h=Xe&&Buffer.isBuffer(f)?f.toString("binary"):Ca(f);break;case"array":h=Wa(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=ut(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=ut(h):d.type=="binary"&&typeof st!="undefined"&&d.codepage&&(h=st.utils.decode(d.codepage,st.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Tf.to_sheet(d.type=="string"?h:ut(h),d):i(h,d)}function l(f,d){return Ta(o(f,d),d)}function c(f){for(var d=[],h=Ze(f["!ref"]),p,m=Array.isArray(f),u=h.s.r;u<=h.e.r;++u){for(var g=[],v=h.s.c;v<=h.e.c;++v){var y=Le({r:u,c:v});if(p=m?(f[u]||[])[v]:f[y],!p||p.v==null){g.push("          ");continue}for(var x=(p.w||(ca(p),p.w)||"").slice(0,10);x.length<10;)x+=" ";g.push(x+(v===0?" ":""))}d.push(g.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})();function Qg(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=Sf.to_workbook(e,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return Tn.to_workbook(e,t)}}var Ha=(function(){function e(F,U,P){if(F){Jt(F,F.l||0);for(var B=P.Enum||Z;F.l<F.length;){var Y=F.read_shift(2),Q=B[Y]||B[65535],J=F.read_shift(2),oe=F.l+J,ae=Q.f&&Q.f(F,J,P);if(F.l=oe,U(ae,Q,Y))return}}}function t(F,U){switch(U.type){case"base64":return r(wr(br(F)),U);case"binary":return r(wr(F),U);case"buffer":case"array":return r(F,U)}throw"Unsupported type "+U.type}function r(F,U){if(!F)return F;var P=U||{};At!=null&&P.dense==null&&(P.dense=At);var B=P.dense?[]:{},Y="Sheet1",Q="",J=0,oe={},ae=[],be=[],O={s:{r:0,c:0},e:{r:0,c:0}},Se=P.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)P.Enum=Z,e(F,function(z,ce,ft){switch(ft){case 0:P.vers=z,z>=4096&&(P.qpro=!0);break;case 6:O=z;break;case 204:z&&(Q=z);break;case 222:Q=z;break;case 15:case 51:P.qpro||(z[1].v=z[1].v.slice(1));case 13:case 14:case 16:ft==14&&(z[2]&112)==112&&(z[2]&15)>1&&(z[2]&15)<15&&(z[1].z=P.dateNF||De[14],P.cellDates&&(z[1].t="d",z[1].v=Ci(z[1].v))),P.qpro&&z[3]>J&&(B["!ref"]=He(O),oe[Y]=B,ae.push(Y),B=P.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},J=z[3],Y=Q||"Sheet"+(J+1),Q="");var Ot=P.dense?(B[z[0].r]||[])[z[0].c]:B[Le(z[0])];if(Ot){Ot.t=z[1].t,Ot.v=z[1].v,z[1].z!=null&&(Ot.z=z[1].z),z[1].f!=null&&(Ot.f=z[1].f);break}P.dense?(B[z[0].r]||(B[z[0].r]=[]),B[z[0].r][z[0].c]=z[1]):B[Le(z[0])]=z[1];break;default:}},P);else if(F[2]==26||F[2]==14)P.Enum=X,F[2]==14&&(P.qpro=!0,F.l=0),e(F,function(z,ce,ft){switch(ft){case 204:Y=z;break;case 22:z[1].v=z[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(z[3]>J&&(B["!ref"]=He(O),oe[Y]=B,ae.push(Y),B=P.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},J=z[3],Y="Sheet"+(J+1)),Se>0&&z[0].r>=Se)break;P.dense?(B[z[0].r]||(B[z[0].r]=[]),B[z[0].r][z[0].c]=z[1]):B[Le(z[0])]=z[1],O.e.c<z[0].c&&(O.e.c=z[0].c),O.e.r<z[0].r&&(O.e.r=z[0].r);break;case 27:z[14e3]&&(be[z[14e3][0]]=z[14e3][1]);break;case 1537:be[z[0]]=z[1],z[0]==J&&(Y=z[1]);break;default:break}},P);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(B["!ref"]=He(O),oe[Q||Y]=B,ae.push(Q||Y),!be.length)return{SheetNames:ae,Sheets:oe};for(var ke={},Ne=[],pe=0;pe<be.length;++pe)oe[ae[pe]]?(Ne.push(be[pe]||ae[pe]),ke[be[pe]]=oe[be[pe]]||oe[ae[pe]]):(Ne.push(be[pe]),ke[be[pe]]={"!ref":"A1"});return{SheetNames:Ne,Sheets:ke}}function a(F,U){var P=U||{};if(+P.codepage>=0&&Ur(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var B=mr(),Y=Ze(F["!ref"]),Q=Array.isArray(F),J=[];xe(B,0,s(1030)),xe(B,6,l(Y));for(var oe=Math.min(Y.e.r,8191),ae=Y.s.r;ae<=oe;++ae)for(var be=Dt(ae),O=Y.s.c;O<=Y.e.c;++O){ae===Y.s.r&&(J[O]=kt(O));var Se=J[O]+be,ke=Q?(F[ae]||[])[O]:F[Se];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?xe(B,13,p(ae,O,ke.v)):xe(B,14,u(ae,O,ke.v));else{var Ne=ca(ke);xe(B,15,d(ae,O,Ne.slice(0,239)))}}return xe(B,1),B.end()}function n(F,U){var P=U||{};if(+P.codepage>=0&&Ur(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var B=mr();xe(B,0,i(F));for(var Y=0,Q=0;Y<F.SheetNames.length;++Y)(F.Sheets[F.SheetNames[Y]]||{})["!ref"]&&xe(B,27,K(F.SheetNames[Y],Q++));var J=0;for(Y=0;Y<F.SheetNames.length;++Y){var oe=F.Sheets[F.SheetNames[Y]];if(!(!oe||!oe["!ref"])){for(var ae=Ze(oe["!ref"]),be=Array.isArray(oe),O=[],Se=Math.min(ae.e.r,8191),ke=ae.s.r;ke<=Se;++ke)for(var Ne=Dt(ke),pe=ae.s.c;pe<=ae.e.c;++pe){ke===ae.s.r&&(O[pe]=kt(pe));var z=O[pe]+Ne,ce=be?(oe[ke]||[])[pe]:oe[z];if(!(!ce||ce.t=="z"))if(ce.t=="n")xe(B,23,D(ke,pe,J,ce.v));else{var ft=ca(ce);xe(B,22,_(ke,pe,J,ft.slice(0,239)))}}++J}}return xe(B,1),B.end()}function s(F){var U=ie(2);return U.write_shift(2,F),U}function i(F){var U=ie(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var P=0,B=0,Y=0,Q=0;Q<F.SheetNames.length;++Q){var J=F.SheetNames[Q],oe=F.Sheets[J];if(!(!oe||!oe["!ref"])){++Y;var ae=gr(oe["!ref"]);P<ae.e.r&&(P=ae.e.r),B<ae.e.c&&(B=ae.e.c)}}return P>8191&&(P=8191),U.write_shift(2,P),U.write_shift(1,Y),U.write_shift(1,B),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(F,U,P){var B={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&P.qpro?(B.s.c=F.read_shift(1),F.l++,B.s.r=F.read_shift(2),B.e.c=F.read_shift(1),F.l++,B.e.r=F.read_shift(2),B):(B.s.c=F.read_shift(2),B.s.r=F.read_shift(2),U==12&&P.qpro&&(F.l+=2),B.e.c=F.read_shift(2),B.e.r=F.read_shift(2),U==12&&P.qpro&&(F.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(F){var U=ie(8);return U.write_shift(2,F.s.c),U.write_shift(2,F.s.r),U.write_shift(2,F.e.c),U.write_shift(2,F.e.r),U}function c(F,U,P){var B=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(B[0].c=F.read_shift(1),B[3]=F.read_shift(1),B[0].r=F.read_shift(2),F.l+=2):(B[2]=F.read_shift(1),B[0].c=F.read_shift(2),B[0].r=F.read_shift(2)),B}function f(F,U,P){var B=F.l+U,Y=c(F,U,P);if(Y[1].t="s",P.vers==20768){F.l++;var Q=F.read_shift(1);return Y[1].v=F.read_shift(Q,"utf8"),Y}return P.qpro&&F.l++,Y[1].v=F.read_shift(B-F.l,"cstr"),Y}function d(F,U,P){var B=ie(7+P.length);B.write_shift(1,255),B.write_shift(2,U),B.write_shift(2,F),B.write_shift(1,39);for(var Y=0;Y<B.length;++Y){var Q=P.charCodeAt(Y);B.write_shift(1,Q>=128?95:Q)}return B.write_shift(1,0),B}function h(F,U,P){var B=c(F,U,P);return B[1].v=F.read_shift(2,"i"),B}function p(F,U,P){var B=ie(7);return B.write_shift(1,255),B.write_shift(2,U),B.write_shift(2,F),B.write_shift(2,P,"i"),B}function m(F,U,P){var B=c(F,U,P);return B[1].v=F.read_shift(8,"f"),B}function u(F,U,P){var B=ie(13);return B.write_shift(1,255),B.write_shift(2,U),B.write_shift(2,F),B.write_shift(8,P,"f"),B}function g(F,U,P){var B=F.l+U,Y=c(F,U,P);if(Y[1].v=F.read_shift(8,"f"),P.qpro)F.l=B;else{var Q=F.read_shift(2);b(F.slice(F.l,F.l+Q),Y),F.l+=Q}return Y}function v(F,U,P){var B=U&32768;return U&=-32769,U=(B?F:0)+(U>=8192?U-16384:U),(B?"":"$")+(P?kt(U):Dt(U))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(F,U){Jt(F,0);for(var P=[],B=0,Y="",Q="",J="",oe="";F.l<F.length;){var ae=F[F.l++];switch(ae){case 0:P.push(F.read_shift(8,"f"));break;case 1:Q=v(U[0].c,F.read_shift(2),!0),Y=v(U[0].r,F.read_shift(2),!1),P.push(Q+Y);break;case 2:{var be=v(U[0].c,F.read_shift(2),!0),O=v(U[0].r,F.read_shift(2),!1);Q=v(U[0].c,F.read_shift(2),!0),Y=v(U[0].r,F.read_shift(2),!1),P.push(be+O+":"+Q+Y)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(F.read_shift(2));break;case 6:{for(var Se="";ae=F[F.l++];)Se+=String.fromCharCode(ae);P.push('"'+Se.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:oe=P.pop(),J=P.pop(),P.push(["AND","OR"][ae-20]+"("+J+","+oe+")");break;default:if(ae<32&&x[ae])oe=P.pop(),J=P.pop(),P.push(J+x[ae]+oe);else if(y[ae]){if(B=y[ae][1],B==69&&(B=F[F.l++]),B>P.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+P.join("|")+"|");return}var ke=P.slice(-B);P.length-=B,P.push(y[ae][0]+"("+ke.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}P.length==1?U[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function C(F){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=F.read_shift(2),U[3]=F[F.l++],U[0].c=F[F.l++],U}function w(F,U){var P=C(F,U);return P[1].t="s",P[1].v=F.read_shift(U-4,"cstr"),P}function _(F,U,P,B){var Y=ie(6+B.length);Y.write_shift(2,F),Y.write_shift(1,P),Y.write_shift(1,U),Y.write_shift(1,39);for(var Q=0;Q<B.length;++Q){var J=B.charCodeAt(Q);Y.write_shift(1,J>=128?95:J)}return Y.write_shift(1,0),Y}function k(F,U){var P=C(F,U);P[1].v=F.read_shift(2);var B=P[1].v>>1;if(P[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return P[1].v=B,P}function S(F,U){var P=C(F,U),B=F.read_shift(4),Y=F.read_shift(4),Q=F.read_shift(2);if(Q==65535)return B===0&&Y===3221225472?(P[1].t="e",P[1].v=15):B===0&&Y===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var J=Q&32768;return Q=(Q&32767)-16446,P[1].v=(1-J*2)*(Y*Math.pow(2,Q+32)+B*Math.pow(2,Q)),P}function D(F,U,P,B){var Y=ie(14);if(Y.write_shift(2,F),Y.write_shift(1,P),Y.write_shift(1,U),B==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var Q=0,J=0,oe=0,ae=0;return B<0&&(Q=1,B=-B),J=Math.log2(B)|0,B/=Math.pow(2,J-31),ae=B>>>0,(ae&2147483648)==0&&(B/=2,++J,ae=B>>>0),B-=ae,ae|=2147483648,ae>>>=0,B*=Math.pow(2,32),oe=B>>>0,Y.write_shift(4,oe),Y.write_shift(4,ae),J+=16383+(Q?32768:0),Y.write_shift(2,J),Y}function R(F,U){var P=S(F,14);return F.l+=U-14,P}function T(F,U){var P=C(F,U),B=F.read_shift(4);return P[1].v=B>>6,P}function V(F,U){var P=C(F,U),B=F.read_shift(8,"f");return P[1].v=B,P}function G(F,U){var P=V(F,14);return F.l+=U-10,P}function W(F,U){return F[F.l+U-1]==0?F.read_shift(U,"cstr"):""}function j(F,U){var P=F[F.l++];P>U-1&&(P=U-1);for(var B="";B.length<P;)B+=String.fromCharCode(F[F.l++]);return B}function se(F,U,P){if(!(!P.qpro||U<21)){var B=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var Y=F.read_shift(U-21,"cstr");return[B,Y]}}function q(F,U){for(var P={},B=F.l+U;F.l<B;){var Y=F.read_shift(2);if(Y==14e3){for(P[Y]=[0,""],P[Y][0]=F.read_shift(2);F[F.l];)P[Y][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return P}function K(F,U){var P=ie(5+F.length);P.write_shift(2,14e3),P.write_shift(2,U);for(var B=0;B<F.length;++B){var Y=F.charCodeAt(B);P[P.l++]=Y>127?95:Y}return P[P.l++]=0,P}var Z={0:{n:"BOF",f:Bt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:j},65535:{n:""}},X={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:w},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}})();function e1(e){var t={},r=e.match(or),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=$e(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Po[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}var t1=(function(){var e=ds("t"),t=ds("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:qe(i[1])},l=s.match(t);return l&&(o.s=e1(l[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(a,"").split(n).map(r).filter(function(o){return o.v})}})(),r1=(function(){var t=/(\r\n|\n)/g;function r(n,s,i){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),n.b&&(s.push("<b>"),i.push("</b>")),n.i&&(s.push("<i>"),i.push("</i>")),n.strike&&(s.push("<s>"),i.push("</s>"));var l=n.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}})(),a1=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,n1=/<(?:\w+:)?r>/,s1=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cl(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=qe(ut(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ut(e),r&&(a.h=Go(a.t))):e.match(n1)&&(a.r=ut(e),a.t=qe(ut((e.replace(s1,"").match(a1)||[]).join("").replace(or,""))),r&&(a.h=r1(t1(a.r)))),a):{t:""}}var i1=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,o1=/<(?:\w+:)?(?:si|sstItem)>/g,l1=/<\/(?:\w+:)?(?:si|sstItem)>/;function c1(e,t){var r=[],a="";if(!e)return r;var n=e.match(i1);if(n){a=n[2].replace(o1,"").split(l1);for(var s=0;s!=a.length;++s){var i=cl(a[s].trim(),t);i!=null&&(r[r.length]=i)}n=$e(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var f1=/^\s|\s$|[\t\n\r]/;function Af(e,t){if(!t.bookSST)return"";var r=[Nt];r[r.length]=ge("sst",null,{xmlns:Ka[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(f1)&&(s+=' xml:space="preserve"'),s+=">"+ct(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function u1(e){return[e.read_shift(4),e.read_shift(4)]}function d1(e,t){var r=[],a=!1;return ua(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.T,!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function p1(e,t){return t||(t=ie(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var h1=kh;function m1(e){var t=mr();de(t,159,p1(e));for(var r=0;r<e.length;++r)de(t,19,h1(e[r]));return de(t,160),t.end()}function Rf(e){if(typeof st!="undefined")return st.utils.encode(Sn,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function la(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function g1(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=la(e,4),t.U=la(e,4),t.W=la(e,4),t}function x1(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function v1(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(x1(e));return t}function y1(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function _1(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=la(e,4),t.U=la(e,4),t.W=la(e,4),t}function w1(e){var t=_1(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function If(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function Ff(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function E1(e){var t=la(e);switch(t.Minor){case 2:return[t.Minor,b1(e,t)];case 3:return[t.Minor,k1(e,t)];case 4:return[t.Minor,S1(e,t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function b1(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=If(e,r),n=Ff(e,e.length-e.l);return{t:"Std",h:a,v:n}}function k1(){throw new Error("File is password-protected: ECMA-376 Extensible")}function S1(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(or,function(s){var i=$e(s);switch(ea(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){a[o]=i[o]});break;case"<dataIntegrity":a.encryptedHmacKey=i.encryptedHmacKey,a.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(i);break;default:throw i[0]}}),a}function C1(e,t){var r={},a=r.EncryptionVersionInfo=la(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=If(e,n),t-=n,r.EncryptionVerifier=Ff(e,t),r}function T1(e){var t={},r=t.EncryptionVersionInfo=la(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function fl(e){var t=0,r,a=Rf(e),n=a.length+1,s,i,o,l,c;for(r=Ea(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)i=r[s],o=(t&16384)===0?0:1,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var Df=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(i){return(i/2|i*128)&255},n=function(i,o){return a(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=Rf(i),l=s(o),c=o.length,f=Ea(16),d=0;d!=16;++d)f[d]=0;var h,p,m;for((c&1)===1&&(h=l>>8,f[c]=n(e[0],h),--c,h=l&255,p=o[o.length-1],f[c]=n(p,h));c>0;)--c,h=l>>8,f[c]=n(o[c],h),--c,h=l&255,f[c]=n(o[c],h);for(c=15,m=15-o.length;m>0;)h=l>>8,f[c]=n(e[m],h),--c,--m,h=l&255,f[c]=n(o[c],h),--c,--m;return f}})(),A1=function(e,t,r,a,n){n||(n=t),a||(a=Df(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=a[r],i=(i>>5|i<<3)&255,n[s]=i,++r;return[n,r,a]},R1=function(e){var t=0,r=Df(e);return function(a){var n=A1("",a,t,r);return t=n[1],n[0]}};function I1(e,t,r,a){var n={key:Bt(e),verificationBytes:Bt(e)};return r.password&&(n.verifier=fl(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=R1(r.password)),n}function F1(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=T1(e,t):a.Data=C1(e,t),a}function D1(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?F1(e,t-2,a):I1(e,r.biff>=8?t:t-2,r,a),a}var Nf=(function(){function e(n,s){switch(s.type){case"base64":return t(br(n),s);case"binary":return t(n,s);case"buffer":return t(Xe&&Buffer.isBuffer(n)?n.toString("binary"):Ca(n),s);case"array":return t(Wa(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var i=s||{},o=i.dense?[]:{},l=n.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,m,u=-1;m=h.exec(f);){switch(m[0]){case"\\cell":var g=f.slice(p,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++u,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[d][u]=v:o[Le({r:d,c:u})]=v}break}p=h.lastIndex}u>c.e.c&&(c.e.c=u)}),o["!ref"]=He(c),o}function r(n,s){return Ta(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],i=Ze(n["!ref"]),o,l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Le({r:c,c:f});o=l?(n[c]||[])[f]:n[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ca(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function N1(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function gs(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function O1(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),i=n-s;if(i===0)return[0,0,t];var o=0,l=0,c=n+s;switch(l=i/(c>1?2-c:c),n){case t:o=((r-a)/i+6)%6;break;case r:o=(a-t)/i+2;break;case a:o=(t-r)/i+4;break}return[o/6,l,c/2]}function P1(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),s=a-n/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=n*o,i[0]+=n,i[1]+=l;break;case 1:l=n*(2-o),i[0]+=l,i[1]+=n;break;case 2:l=n*(o-2),i[1]+=n,i[2]+=l;break;case 3:l=n*(4-o),i[1]+=l,i[2]+=n;break;case 4:l=n*(o-4),i[2]+=n,i[0]+=l;break;case 5:l=n*(6-o),i[2]+=l,i[0]+=n;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function vi(e,t){if(t===0)return e;var r=O1(N1(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),gs(P1(r))}var Of=6,L1=15,$1=1,rr=Of;function xs(e){return Math.floor((e+Math.round(128/rr)/256)*rr)}function vs(e){return Math.floor((e-5)/rr*100+.5)/100}function yi(e){return Math.round((e*rr+5)/rr*256)/256}function ho(e){return yi(vs(xs(e)))}function ul(e){var t=Math.abs(e-ho(e)),r=rr;if(t>.005)for(rr=$1;rr<L1;++rr)Math.abs(e-ho(e))<=t&&(t=Math.abs(e-ho(e)),r=rr);rr=r}function ba(e){e.width?(e.wpx=xs(e.width),e.wch=vs(e.wpx),e.MDW=rr):e.wpx?(e.wch=vs(e.wpx),e.width=yi(e.wch),e.MDW=rr):typeof e.wch=="number"&&(e.width=yi(e.wch),e.wpx=xs(e.width),e.MDW=rr),e.customWidth&&delete e.customWidth}var M1=96,Pf=M1;function ys(e){return e*96/Pf}function An(e){return e*Pf/96}var B1={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function U1(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(or)||[]).forEach(function(i){var o=$e(i);switch(ea(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=vt(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=vt(o.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function H1(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(or)||[]).forEach(function(i){var o=$e(i);switch(ea(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function V1(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(or)||[]).forEach(function(i){var o=$e(i);switch(ea(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=ut(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?vt(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?vt(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?vt(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?vt(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?vt(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?vt(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?vt(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Po[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=vt(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var l=Ba[n.color.index];n.color.index==81&&(l=Ba[1]),l||(l=Ba[1]),n.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=vi(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function j1(e,t,r){t.NumberFmt=[];for(var a=Rt(De),n=0;n<a.length;++n)t.NumberFmt[a[n]]=De[a[n]];var s=e[0].match(or);if(s)for(n=0;n<s.length;++n){var i=$e(s[n]);switch(ea(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=qe(ut(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}oa(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function W1(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=ge("numFmt",null,{numFmtId:a,formatCode:ct(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ge("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var si=["numFmtId","fillId","fontId","borderId","xfId"],ii=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function G1(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(or)||[]).forEach(function(s){var i=$e(s),o=0;switch(ea(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=i,delete a[0],o=0;o<si.length;++o)a[si[o]]&&(a[si[o]]=parseInt(a[si[o]],10));for(o=0;o<ii.length;++o)a[ii[o]]&&(a[ii[o]]=vt(a[ii[o]]));if(t.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[o]){a.numFmtId=o;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=vt(i.wrapText)),a.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function z1(e){var t=[];return t[t.length]=ge("cellXfs",null),e.forEach(function(r){t[t.length]=ge("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ge("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var X1=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&j1(d,f,c),(d=o.match(n))&&V1(d,f,l,c),(d=o.match(a))&&H1(d,f,l,c),(d=o.match(s))&&U1(d,f,l,c),(d=o.match(r))&&G1(d,f,c),f}})();function Lf(e,t){var r=[Nt,ge("styleSheet",null,{xmlns:Ka[0],"xmlns:vt":Ht.vt})],a;return e.SSF&&(a=W1(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=z1(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Y1(e,t){var r=e.read_shift(2),a=sr(e,t-2);return[r,a]}function K1(e,t,r){r||(r=ie(6+4*t.length)),r.write_shift(2,e),Yt(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function J1(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=Fh(e,2,r);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var o=e.read_shift(1);o>0&&(a.family=o);var l=e.read_shift(1);switch(l>0&&(a.charset=l),e.l++,a.color=Ih(e,8),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=sr(e,t-21),a}function q1(e,t){t||(t=ie(153)),t.write_shift(2,e.sz*20),Dh(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),mi(e.color,t);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),t.write_shift(1,a),Yt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Z1=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],mo,Q1=ir;function Qc(e,t){t||(t=ie(84)),mo||(mo=ki(Z1));var r=mo[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(mi({auto:1},t),mi({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ex(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function $f(e,t,r){r||(r=ie(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function qn(e,t){return t||(t=ie(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var tx=ir;function rx(e,t){return t||(t=ie(51)),t.write_shift(1,0),qn(null,t),qn(null,t),qn(null,t),qn(null,t),qn(null,t),t.length>t.l?t.slice(0,t.l):t}function ax(e,t){return t||(t=ie(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),hi(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function nx(e,t,r){var a=ie(2052);return a.write_shift(4,e),hi(t,a),hi(r,a),a.length>a.l?a.slice(0,a.l):a}function sx(e,t,r){var a={};a.NumberFmt=[];for(var n in De)a.NumberFmt[n]=De[n];a.CellXf=[],a.Fonts=[];var s=[],i=!1;return ua(e,function(l,c,f){switch(f){case 44:a.NumberFmt[l[0]]=l[1],oa(l[1],l[0]);break;case 43:a.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=vi(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}function ix(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(de(e,615,jr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&de(e,44,K1(n,t[n]))}),de(e,616))}}function ox(e){var t=1;t!=0&&(de(e,611,jr(t)),de(e,43,q1({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),de(e,612))}function lx(e){var t=2;t!=0&&(de(e,603,jr(t)),de(e,45,Qc({patternType:"none"})),de(e,45,Qc({patternType:"gray125"})),de(e,604))}function cx(e){var t=1;t!=0&&(de(e,613,jr(t)),de(e,46,rx({})),de(e,614))}function fx(e){var t=1;de(e,626,jr(t)),de(e,47,$f({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),de(e,627)}function ux(e,t){de(e,617,jr(t.length)),t.forEach(function(r){de(e,47,$f(r,0))}),de(e,618)}function dx(e){var t=1;de(e,619,jr(t)),de(e,48,ax({xfId:0,builtinId:0,name:"Normal"})),de(e,620)}function px(e){var t=0;de(e,505,jr(t)),de(e,506)}function hx(e){var t=0;de(e,508,nx(t,"TableStyleMedium9","PivotStyleMedium4")),de(e,509)}function mx(e,t){var r=mr();return de(r,278),ix(r,e.SSF),ox(r,e),lx(r,e),cx(r,e),fx(r,e),ux(r,t.cellXfs),dx(r,e),px(r,e),hx(r,e),de(r,279),r.end()}var gx=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xx(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(or)||[]).forEach(function(n){var s=$e(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[gx.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function vx(){}function yx(){}var _x=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,wx=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function bx(e,t,r){t.themeElements={};var a;[["clrScheme",_x,xx],["fontScheme",wx,vx],["fmtScheme",Ex,yx]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var kx=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Mf(e,t){(!e||e.length===0)&&(e=dl());var r,a={};if(!(r=e.match(kx)))throw new Error("themeElements not found in theme");return bx(r[0],a,t),a.raw=e,a}function dl(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Nt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Sx(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var i;try{i=O0(s,{type:"array"})}catch{return}var o=Er(i,"theme/theme/theme1.xml",!0);if(o)return Mf(o,r)}}function Cx(e){return e.read_shift(4)}function Tx(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Ax(e,4);break;case 2:t.xclrValue=xf(e,4);break;case 3:t.xclrValue=Cx(e,4);break;case 4:e.l+=4;break}return e.l+=8,t}function Ax(e,t){return ir(e,t)}function Rx(e,t){return ir(e,t)}function Ix(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Tx(e,r);break;case 6:a[1]=Rx(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Fx(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(Ix(e,r-e.l));return{ixfe:a,ext:s}}function Dx(e,t){t.forEach(function(r){switch(r[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function Nx(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:sr(e,t-8)}}function Ox(e){var t=ie(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Yt(e.name,t),t.slice(0,t.l)}function Px(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Lx(e){var t=ie(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function $x(e,t){var r=ie(8+2*t.length);return r.write_shift(4,e),Yt(t,r),r.slice(0,r.l)}function Mx(e){return e.l+=4,e.read_shift(4)!=0}function Bx(e,t){var r=ie(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function Ux(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],i=!1,o=2;return ua(e,function(l,c,f){switch(f){case 335:a.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?a.Cell.push({type:a.Types[d[0]-1].name,index:d[1]}):o==0&&a.Value.push({type:a.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function Hx(){var e=mr();return de(e,332),de(e,334,jr(1)),de(e,335,Ox({name:"XLDAPR",version:12e4,flags:3496657072})),de(e,336),de(e,339,$x(1,"XLDAPR")),de(e,52),de(e,35,jr(514)),de(e,4096,jr(0)),de(e,4097,Fr(1)),de(e,36),de(e,53),de(e,340),de(e,337,Bx(1,!0)),de(e,51,Lx([[1,0]])),de(e,338),de(e,333),e.end()}function Vx(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,i;return e.replace(or,function(o){var l=$e(o);switch(ea(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<a.Types.length;++c)a.Types[c].name==l.name&&(i=a.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[l.t-1].name,index:+l.v}):s==0&&a.Value.push({type:a.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),a}function Bf(){var e=[Nt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function jx(e){var t=[];if(!e)return t;var r=1;return(e.match(or)||[]).forEach(function(a){var n=$e(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function Wx(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Le(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Gx(e,t,r){var a=[],n=!1;return ua(e,function(i,o,l){switch(l){case 63:a.push(i);break;default:if(!o.T){if(!n||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),a}function zx(e,t,r,a){if(!e)return e;var n=a||{},s=!1,i=!1;ua(e,function(l,c,f){if(!i)switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},n)}function Xx(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var _n=1024;function Uf(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[ge("xml",null,{"xmlns:v":_r.v,"xmlns:o":_r.o,"xmlns:x":_r.x,"xmlns:mv":_r.mv}).replace(/\/>/,">"),ge("o:shapelayout",ge("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ge("v:shapetype",[ge("v:stroke",null,{joinstyle:"miter"}),ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];_n<e*1e3;)_n+=1e3;return t.forEach(function(s){var i=St(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ge("v:fill",l,o),f={on:"t",obscured:"t"};++_n,n=n.concat(["<v:shape"+ps({id:"_x0000_s"+_n,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ge("v:shadow",null,f),ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",qt("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),qt("x:AutoFill","False"),qt("x:Row",String(i.r)),qt("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function e0(e,t,r,a){var n=Array.isArray(e),s;t.forEach(function(i){var o=St(i.ref);if(n?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},n?e[o.r][o.c]=s:e[i.ref]=s;var l=Ze(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=He(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&a){for(d=0;d<a.length;++d)if(f.a==a[d].id){f.a=a[d].name||f.a;break}}s.c.push(f)})}function Yx(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=$e(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=St(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&cl(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),a.push(c)}}}}),a}function Hf(e){var t=[Nt,ge("comments",null,{xmlns:Ka[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var s=ct(n.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(l){l.a&&(n=r.indexOf(ct(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(qt("t",ct(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(qt("t",ct(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Kx(e,t){var r=[],a=!1,n={},s=0;return e.replace(or,function(o,l){var c=$e(o);switch(ea(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":n.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Jx(e,t,r){var a=[Nt,ge("ThreadedComments",null,{xmlns:Ht.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var s="";(n[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),a.push(ge("threadedComment",qt("text",i.t||""),l))})}),a.push("</ThreadedComments>"),a.join("")}function qx(e,t){var r=[],a=!1;return e.replace(or,function(s){var i=$e(s);switch(ea(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function Zx(e){var t=[Nt,ge("personList",null,{xmlns:Ht.TCMNT,"xmlns:x":Ka[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Qx(e){var t={};t.iauthor=e.read_shift(4);var r=Qa(e,16);return t.rfx=r.s,t.ref=Le(r.s),e.l+=16,t}function ev(e,t){return t==null&&(t=ie(36)),t.write_shift(4,e[1].iauthor),Nn(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var tv=sr;function rv(e){return Yt(e.slice(0,54))}function av(e,t){var r=[],a=[],n={},s=!1;return ua(e,function(o,l,c){switch(c){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function nv(e){var t=mr(),r=[];return de(t,628),de(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),de(t,632,rv(n.a)))})}),de(t,631),de(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:St(a[0]),e:St(a[0])};de(t,635,ev([s,n])),n.t&&n.t.length>0&&de(t,637,Ch(n)),de(t,636),delete n.iauthor})}),de(t,634),de(t,629),t.end()}var sv="application/vnd.ms-office.vbaProject";function iv(e){var t=Re.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Re.utils.cfb_add(t,n,e.FileIndex[a].content)}}),Re.write(t)}function ov(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Re.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var Vf=["xlsb","xlsm","xlam","biff8","xla"];function lv(){return{"!type":"dialog"}}function cv(){return{"!type":"dialog"}}function fv(){return{"!type":"macro"}}function uv(){return{"!type":"macro"}}var bn=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,n+(o?"":"$")+kt(f)+(l?"":"$")+Dt(c)}return function(n,s){return t=s,n.replace(e,r)}})(),pl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hl=(function(){return function(t,r){return t.replace(pl,function(a,n,s,i,o,l){var c=el(i)-(s?0:r.c),f=Qo(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=c==0?"":s?c+1:"["+c+"]";return n+"R"+d+"C"+h})}})();function jf(e,t){return e.replace(pl,function(r,a,n,s,i,o){return a+(n=="$"?n+s:kt(el(s)+t.c))+(i=="$"?i+o:Dt(Qo(o)+t.r))})}function dv(e,t,r){var a=gr(t),n=a.s,s=St(r),i={r:s.r-n.r,c:s.c-n.c};return jf(e,i)}function pv(e){return e.length!=1}function t0(e){return e.replace(/_xlfn\./g,"")}function $t(e){e.l+=1}function ka(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function Wf(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Gf(e,t,r);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),i=ka(e,2),o=ka(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Gf(e){var t=ka(e,2),r=ka(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function hv(e,t,r){if(r.biff<8)return Gf(e,t,r);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=ka(e,2),i=ka(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function zf(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return mv(e,t,r);var a=e.read_shift(r&&r.biff==12?4:2),n=ka(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function mv(e){var t=ka(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function gv(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function xv(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return vv(e,t,r);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:i,rRel:o}}function vv(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function yv(e,t,r){var a=(e[e.l++]&96)>>5,n=Wf(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function _v(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=Wf(e,s,r);return[a,n,i]}function wv(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Ev(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function bv(e,t,r){var a=(e[e.l++]&96)>>5,n=hv(e,t-1,r);return[a,n]}function kv(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function r0(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Sv(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function Cv(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Tv(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Av(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Rv(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function Xf(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Iv(e){return e.read_shift(2),Xf(e,2)}function Fv(e){return e.read_shift(2),Xf(e,2)}function Dv(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=zf(e,0,r);return[a,n]}function Nv(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=xv(e,0,r);return[a,n]}function Ov(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=zf(e,0,r);return[a,n,s]}function Pv(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[My[n],Jf[n],a]}function Lv(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:$v(e);return[n,(s[0]===0?Jf:$y)[s[1]]]}function $v(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Mv(e,t,r){e.l+=r&&r.biff==2?3:4}function Bv(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Uv(e){return e.l++,da[e.read_shift(1)]}function Hv(e){return e.l++,e.read_shift(2)}function Vv(e){return e.l++,e.read_shift(1)!==0}function jv(e){return e.l++,ar(e,8)}function Wv(e,t,r){return e.l++,ks(e,t-1,r)}function Gv(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ft(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=da[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ar(e,8);break;case 2:r[1]=en(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zv(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?Qa:Ai)(e,8));return n}function Xv(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var o=0;o!=n;++o)i[s][o]=Gv(e,r.biff);return i}function Yv(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function Kv(e,t,r){if(r.biff==5)return Jv(e,t,r);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function Jv(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function qv(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Zv(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Qv(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function ey(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var ty=ir,ry=ir,ay=ir;function Cs(e,t,r){return e.l+=2,[gv(e,4,r)]}function ml(e){return e.l+=6,[]}var ny=Cs,sy=ml,iy=ml,oy=Cs;function Yf(e){return e.l+=2,[Bt(e),e.read_shift(2)&1]}var ly=Cs,cy=Yf,fy=ml,uy=Cs,dy=Cs,py=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function hy(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),i=py[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:a,c:n,C:s}}function my(e){return e.l+=2,[e.read_shift(4)]}function gy(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function xy(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function vy(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function yy(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _y(e){return e.l+=4,[0,0]}var a0={1:{n:"PtgExp",f:Bv},2:{n:"PtgTbl",f:ay},3:{n:"PtgAdd",f:$t},4:{n:"PtgSub",f:$t},5:{n:"PtgMul",f:$t},6:{n:"PtgDiv",f:$t},7:{n:"PtgPower",f:$t},8:{n:"PtgConcat",f:$t},9:{n:"PtgLt",f:$t},10:{n:"PtgLe",f:$t},11:{n:"PtgEq",f:$t},12:{n:"PtgGe",f:$t},13:{n:"PtgGt",f:$t},14:{n:"PtgNe",f:$t},15:{n:"PtgIsect",f:$t},16:{n:"PtgUnion",f:$t},17:{n:"PtgRange",f:$t},18:{n:"PtgUplus",f:$t},19:{n:"PtgUminus",f:$t},20:{n:"PtgPercent",f:$t},21:{n:"PtgParen",f:$t},22:{n:"PtgMissArg",f:$t},23:{n:"PtgStr",f:Wv},26:{n:"PtgSheet",f:gy},27:{n:"PtgEndSheet",f:xy},28:{n:"PtgErr",f:Uv},29:{n:"PtgBool",f:Vv},30:{n:"PtgInt",f:Hv},31:{n:"PtgNum",f:jv},32:{n:"PtgArray",f:kv},33:{n:"PtgFunc",f:Pv},34:{n:"PtgFuncVar",f:Lv},35:{n:"PtgName",f:Yv},36:{n:"PtgRef",f:Dv},37:{n:"PtgArea",f:yv},38:{n:"PtgMemArea",f:qv},39:{n:"PtgMemErr",f:ty},40:{n:"PtgMemNoMem",f:ry},41:{n:"PtgMemFunc",f:Zv},42:{n:"PtgRefErr",f:Qv},43:{n:"PtgAreaErr",f:wv},44:{n:"PtgRefN",f:Nv},45:{n:"PtgAreaN",f:bv},46:{n:"PtgMemAreaN",f:vy},47:{n:"PtgMemNoMemN",f:yy},57:{n:"PtgNameX",f:Kv},58:{n:"PtgRef3d",f:Ov},59:{n:"PtgArea3d",f:_v},60:{n:"PtgRefErr3d",f:ey},61:{n:"PtgAreaErr3d",f:Ev},255:{}},wy={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ey={1:{n:"PtgElfLel",f:Yf},2:{n:"PtgElfRw",f:uy},3:{n:"PtgElfCol",f:ny},6:{n:"PtgElfRwV",f:dy},7:{n:"PtgElfColV",f:oy},10:{n:"PtgElfRadical",f:ly},11:{n:"PtgElfRadicalS",f:fy},13:{n:"PtgElfColS",f:sy},15:{n:"PtgElfColSV",f:iy},16:{n:"PtgElfRadicalLel",f:cy},25:{n:"PtgList",f:hy},29:{n:"PtgSxName",f:my},255:{}},by={0:{n:"PtgAttrNoop",f:_y},1:{n:"PtgAttrSemi",f:Rv},2:{n:"PtgAttrIf",f:Tv},4:{n:"PtgAttrChoose",f:Sv},8:{n:"PtgAttrGoto",f:Cv},16:{n:"PtgAttrSum",f:Mv},32:{n:"PtgAttrBaxcel",f:r0},33:{n:"PtgAttrBaxcel",f:r0},64:{n:"PtgAttrSpace",f:Iv},65:{n:"PtgAttrSpaceSemi",f:Fv},128:{n:"PtgAttrIfError",f:Av},255:{}};function Ts(e,t,r,a){if(a.biff<8)return ir(e,t);for(var n=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Xv(e,0,a),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=zv(e,r[i][1],a),s.push(r[i][2]);break;case"PtgExp":a&&a.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0];default:break}return t=n-e.l,t!==0&&s.push(ir(e,t)),s}function As(e,t,r){for(var a=e.l+t,n,s,i=[];a!=e.l;)t=a-e.l,s=e[e.l],n=a0[s]||a0[wy[s]],(s===24||s===25)&&(n=(s===24?Ey:by)[e[e.l+1]]),!n||!n.f?ir(e,t):i.push([n.n,n.f(e,t,r)]);return i}function ky(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var i=a[s];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var Sy={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Cy(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Kf(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function n0(e,t,r){var a=Kf(e,t,r);return a=="#REF"?a:Cy(a,r)}function tr(e,t,r,a,n){var s=n&&n.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,f,d=0,h=0,p,m="";if(!e[0]||!e[0][0])return"";for(var u=-1,g="",v=0,y=e[0].length;v<y;++v){var x=e[0][v];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),u>=0){switch(e[0][u][1][0]){case 0:g=Ct(" ",e[0][u][1][1]);break;case 1:g=Ct("\r",e[0][u][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][u][1][0])}c=c+g,u=-1}o.push(c+Sy[x[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=rs(x[1][1],i,n),o.push(as(f,s));break;case"PtgRefN":f=r?rs(x[1][1],r,n):x[1][1],o.push(as(f,s));break;case"PtgRef3d":d=x[1][1],f=rs(x[1][2],i,n),m=n0(a,d,n);var b=m;o.push(m+"!"+as(f,s));break;case"PtgFunc":case"PtgFuncVar":var C=x[1][0],w=x[1][1];C||(C=0),C&=127;var _=C==0?[]:o.slice(-C);o.length-=C,w==="User"&&(w=_.shift()),o.push(w+"("+_.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":p=Nc(x[1][1],r?{s:r}:i,n),o.push(fo(p,n));break;case"PtgArea":p=Nc(x[1][1],i,n),o.push(fo(p,n));break;case"PtgArea3d":d=x[1][1],p=x[1][2],m=n0(a,d,n),o.push(m+"!"+fo(p,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var k=(a.names||[])[h-1]||(a[0]||[])[h],S=k?k.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!n.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var D=x[1][1];h=x[1][2];var R;if(n.biff<=5)D<0&&(D=-D),a[D]&&(R=a[D][h]);else{var T="";if(((a[D]||[])[0]||[])[0]==14849||(((a[D]||[])[0]||[])[0]==1025?a[D][h]&&a[D][h].itab>0&&(T=a.SheetNames[a[D][h].itab-1]+"!"):T=a.SheetNames[h-1]+"!"),a[D]&&a[D][h])T+=a[D][h].Name;else if(a[0]&&a[0][h])T+=a[0][h].Name;else{var V=(Kf(a,D,n)||"").split(";;");V[h-1]?T=V[h-1]:T+="SH33TJSERRX"}o.push(T);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var G="(",W=")";if(u>=0){switch(g="",e[0][u][1][0]){case 2:G=Ct(" ",e[0][u][1][1])+G;break;case 3:G=Ct("\r",e[0][u][1][1])+G;break;case 4:W=Ct(" ",e[0][u][1][1])+W;break;case 5:W=Ct("\r",e[0][u][1][1])+W;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][u][1][0])}u=-1}o.push(G+o.pop()+W);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var j={c:r.c,r:r.r};if(a.sharedf[Le(f)]){var se=a.sharedf[Le(f)];o.push(tr(se,i,j,a,n))}else{var q=!1;for(l=0;l!=a.arrayf.length;++l)if(c=a.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(tr(c[1],i,j,a,n)),q=!0;break}q||o.push(x[1])}break;case"PtgArray":o.push("{"+ky(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":u=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&u>=0&&K.indexOf(e[0][v][0])==-1){x=e[0][u];var Z=!0;switch(x[1][0]){case 4:Z=!1;case 0:g=Ct(" ",x[1][1]);break;case 5:Z=!1;case 1:g=Ct("\r",x[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((Z?g:"")+o.pop()+(Z?"":g)),u=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Ty(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],ir(e,t-2)];var o=As(e,i,r);return t!==i+n&&(s=Ts(e,t-i-n,o,r)),e.l=a,[o,s]}function Ay(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],ir(e,t-2)];var o=As(e,i,r);return t!==i+n&&(s=Ts(e,t-i-n,o,r)),e.l=a,[o,s]}function Ry(e,t,r,a){var n=e.l+t,s=As(e,a,r),i;return n!==e.l&&(i=Ts(e,n-e.l,s,r)),[s,i]}function Iy(e,t,r){var a=e.l+t,n,s=e.read_shift(2),i=As(e,s,r);return s==65535?[[],ir(e,t-2)]:(t!==s+2&&(n=Ts(e,a-s-2,i,r)),[i,n])}function Fy(e){var t;if(sa(e,e.l+6)!==65535)return[ar(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Dy(e){if(e==null){var t=ie(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ga(e);return Ga(0)}function go(e,t,r){var a=e.l+t,n=ta(e,6);r.biff==2&&++e.l;var s=Fy(e,8),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Ay(e,a-e.l,r);return{cell:n,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function Ny(e,t,r,a,n){var s=Xa(t,r,n),i=Dy(e.v),o=ie(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ie(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var d=Xt([s,i,o,c]);return d}function Ri(e,t,r){var a=e.read_shift(4),n=As(e,a,r),s=e.read_shift(4),i=s>0?Ts(e,s,n,r):null;return[n,i]}var Oy=Ri,Ii=Ri,Py=Ri,Ly=Ri,$y={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Jf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},My={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function s0(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function By(e){var t="of:="+e.replace(pl,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function xo(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Uy(e){return e.replace(/\./,"!")}var ss={},kn={},is=typeof Map!="undefined";function gl(e,t,r){var a=0,n=e.length;if(r){if(is?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=is?r.get(t):r[t];a<s.length;++a)if(e[s[a]].t===t)return e.Count++,s[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(is?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Fi(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(rr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=vs(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=yi(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Va(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Aa(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,s=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){oa(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=s;++n)if(e[n].numFmtId===a)return n;return e[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function qf(e,t,r,a,n,s){try{a.cellNF&&(e.z=De[t])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=yt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(De[t]==null&&oa($p[t]||"General",t),e.t==="e")e.w=e.w||da[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=us(e.v);else if(e.t==="d"){var i=Vt(e.v);(i|0)===i?e.w=i.toString(10):e.w=us(i)}else{if(e.v===void 0)return"";e.w=ja(e.v,kn)}else e.t==="d"?e.w=Nr(t,Vt(e.v),kn):e.w=Nr(t,e.v,kn)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=vi(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=vi(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&s.Fills)throw o}}}function Hy(e,t,r){if(e&&e["!ref"]){var a=Ze(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Vy(e,t){var r=Ze(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=He(r))}var jy=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Wy=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Gy=/<(?:\w:)?hyperlink [^>]*>/mg,zy=/"(\w*:\w*)"/,Xy=/<(?:\w:)?col\b[^>]*[\/]?>/g,Yy=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Ky=/<(?:\w:)?pageMargins[^>]*\/>/g,Zf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Jy=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qy=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Zy(e,t,r,a,n,s,i){if(!e)return e;a||(a={"!id":{}}),At!=null&&t.dense==null&&(t.dense=At);var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",d=e.match(Wy);d?(c=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):c=f=e;var h=c.match(Zf);h?xl(h[0],o,n,r):(h=c.match(Jy))&&e_(h[0],h[1]||"",o,n,r,i,s);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=c.slice(p,p+50).match(zy);m&&Vy(o,m[1])}var u=c.match(qy);u&&u[1]&&p_(u[1],n);var g=[];if(t.cellStyles){var v=c.match(Xy);v&&l_(g,v)}d&&g_(d[1],o,t,l,s,i);var y=f.match(Yy);y&&(o["!autofilter"]=f_(y[0]));var x=[],b=f.match(jy);if(b)for(p=0;p!=b.length;++p)x[p]=Ze(b[p].slice(b[p].indexOf('"')+1));var C=f.match(Gy);C&&s_(o,C,a);var w=f.match(Ky);if(w&&(o["!margins"]=i_($e(w[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=He(l)),t.sheetRows>0&&o["!ref"]){var _=Ze(o["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>l.e.r&&(_.e.r=l.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>l.e.c&&(_.e.c=l.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=He(_))}return g.length>0&&(o["!cols"]=g),x.length>0&&(o["!merges"]=x),o}function Qy(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+He(e[r])+'"/>';return t+"</mergeCells>"}function xl(e,t,r,a){var n=$e(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=qe(ut(n.codeName)))}function e_(e,t,r,a,n){xl(e.slice(0,e.indexOf(">")),r,a,n)}function t_(e,t,r,a,n){var s=!1,i={},o=null;if(a.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,i.codeName=Zr(ct(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+ge("outlinePr",null,c)}!s&&!o||(n[n.length]=ge("sheetPr",o,i))}var r_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],a_=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function n_(e){var t={sheet:1};return r_.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),a_.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=fl(e.password).toString(16).toUpperCase()),ge("sheetProtection",null,t)}function s_(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=$e(ut(t[n]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+qe(s.location))):(s.Target="#"+qe(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ze(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Le({c,r:l});a?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function i_(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function o_(e){return Va(e),ge("pageMargins",null,e)}function l_(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=$e(t[a],!0);n.hidden&&(n.hidden=vt(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,ul(n.width)),ba(n);s<=i;)e[s++]=_t(n)}}function c_(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=ge("col",null,Fi(n,a)));return r[r.length]="</cols>",r.join("")}function f_(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function u_(e,t,r,a){var n=typeof e.ref=="string"?e.ref:He(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=gr(n);i.s.r==i.e.r&&(i.e.r=gr(t["!ref"]).e.r,n=He(i));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),ge("autoFilter",null,{ref:n})}var d_=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function p_(e,t){t.Views||(t.Views=[{}]),(e.match(d_)||[]).forEach(function(r,a){var n=$e(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),vt(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function h_(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),ge("sheetViews",ge("sheetView",null,n),{})}function m_(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=da[e.v];break;case"d":a&&a.cellDates?n=yt(e.v,-1).toISOString():(e=_t(e),e.t="n",n=""+(e.v=Vt(yt(e.v)))),typeof e.z=="undefined"&&(e.z=De[14]);break;default:n=e.v;break}var o=qt("v",ct(n)),l={r:t},c=Aa(a.cellXfs,e,a);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=qt("v",""+gl(a.Strings,e.v,a.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ge("f",ct(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),ge("c",o,l)}var g_=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=ds("v"),i=ds("f");return function(l,c,f,d,h,p){for(var m=0,u="",g=[],v=[],y=0,x=0,b=0,C="",w,_,k=0,S=0,D,R,T=0,V=0,G=Array.isArray(p.CellXf),W,j=[],se=[],q=Array.isArray(c),K=[],Z={},X=!1,F=!!f.sheetStubs,U=l.split(t),P=0,B=U.length;P!=B;++P){u=U[P].trim();var Y=u.length;if(Y!==0){var Q=0;e:for(m=0;m<Y;++m)switch(u[m]){case">":if(u[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(_=$e(u.slice(Q,m),!0),k=_.r!=null?parseInt(_.r,10):k+1,S=-1,f.sheetRows&&f.sheetRows<k)continue;Z={},X=!1,_.ht&&(X=!0,Z.hpt=parseFloat(_.ht),Z.hpx=An(Z.hpt)),_.hidden=="1"&&(X=!0,Z.hidden=!0),_.outlineLevel!=null&&(X=!0,Z.level=+_.outlineLevel),X&&(K[k-1]=Z)}break;case"<":Q=m;break}if(Q>=m)break;if(_=$e(u.slice(Q,m),!0),k=_.r!=null?parseInt(_.r,10):k+1,S=-1,!(f.sheetRows&&f.sheetRows<k)){d.s.r>k-1&&(d.s.r=k-1),d.e.r<k-1&&(d.e.r=k-1),f&&f.cellStyles&&(Z={},X=!1,_.ht&&(X=!0,Z.hpt=parseFloat(_.ht),Z.hpx=An(Z.hpt)),_.hidden=="1"&&(X=!0,Z.hidden=!0),_.outlineLevel!=null&&(X=!0,Z.level=+_.outlineLevel),X&&(K[k-1]=Z)),g=u.slice(m).split(e);for(var J=0;J!=g.length&&g[J].trim().charAt(0)=="<";++J);for(g=g.slice(J),m=0;m!=g.length;++m)if(u=g[m].trim(),u.length!==0){if(v=u.match(r),y=m,x=0,b=0,u="<c "+(u.slice(0,1)=="<"?">":"")+u,v!=null&&v.length===2){for(y=0,C=v[1],x=0;x!=C.length&&!((b=C.charCodeAt(x)-64)<1||b>26);++x)y=26*y+b;--y,S=y}else++S;for(x=0;x!=u.length&&u.charCodeAt(x)!==62;++x);if(++x,_=$e(u.slice(0,x),!0),_.r||(_.r=Le({r:k-1,c:S})),C=u.slice(x),w={t:""},(v=C.match(s))!=null&&v[1]!==""&&(w.v=qe(v[1])),f.cellFormula){if((v=C.match(i))!=null&&v[1]!==""){if(w.f=qe(ut(v[1])).replace(/\r\n/g,`
`),f.xlfn||(w.f=t0(w.f)),v[0].indexOf('t="array"')>-1)w.F=(C.match(n)||[])[1],w.F.indexOf(":")>-1&&j.push([Ze(w.F),w.F]);else if(v[0].indexOf('t="shared"')>-1){R=$e(v[0]);var oe=qe(ut(v[1]));f.xlfn||(oe=t0(oe)),se[parseInt(R.si,10)]=[R,oe,_.r]}}else(v=C.match(/<f[^>]*\/>/))&&(R=$e(v[0]),se[R.si]&&(w.f=dv(se[R.si][1],se[R.si][2],_.r)));var ae=St(_.r);for(x=0;x<j.length;++x)ae.r>=j[x][0].s.r&&ae.r<=j[x][0].e.r&&ae.c>=j[x][0].s.c&&ae.c<=j[x][0].e.c&&(w.F=j[x][1])}if(_.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else if(F)w.t="z";else continue;else w.t=_.t||"n";switch(d.s.c>S&&(d.s.c=S),d.e.c<S&&(d.e.c=S),w.t){case"n":if(w.v==""||w.v==null){if(!F)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(typeof w.v=="undefined"){if(!F)continue;w.t="z"}else D=ss[parseInt(w.v,10)],w.v=D.t,w.r=D.r,f.cellHTML&&(w.h=D.h);break;case"str":w.t="s",w.v=w.v!=null?ut(w.v):"",f.cellHTML&&(w.h=Go(w.v));break;case"inlineStr":v=C.match(a),w.t="s",v!=null&&(D=cl(v[1]))?(w.v=D.t,f.cellHTML&&(w.h=D.h)):w.v="";break;case"b":w.v=vt(w.v);break;case"d":f.cellDates?w.v=yt(w.v,1):(w.v=Vt(yt(w.v,1)),w.t="n");break;case"e":(!f||f.cellText!==!1)&&(w.w=w.v),w.v=Q0[w.v];break}if(T=V=0,W=null,G&&_.s!==void 0&&(W=p.CellXf[_.s],W!=null&&(W.numFmtId!=null&&(T=W.numFmtId),f.cellStyles&&W.fillId!=null&&(V=W.fillId))),qf(w,T,V,f,h,p),f.cellDates&&G&&w.t=="n"&&Rn(De[T])&&(w.t="d",w.v=Ci(w.v)),_.cm&&f.xlmeta){var be=(f.xlmeta.Cell||[])[+_.cm-1];be&&be.type=="XLDAPR"&&(w.D=!0)}if(q){var O=St(_.r);c[O.r]||(c[O.r]=[]),c[O.r][O.c]=w}else c[_.r]=w}}}}K.length>0&&(c["!rows"]=K)}})();function x_(e,t,r,a){var n=[],s=[],i=Ze(e["!ref"]),o="",l,c="",f=[],d=0,h=0,p=e["!rows"],m=Array.isArray(e),u={r:c},g,v=-1;for(h=i.s.c;h<=i.e.c;++h)f[h]=kt(h);for(d=i.s.r;d<=i.e.r;++d){for(s=[],c=Dt(d),h=i.s.c;h<=i.e.c;++h){l=f[h]+c;var y=m?(e[d]||[])[h]:e[l];y!==void 0&&(o=m_(y,l,e,t,r,a))!=null&&s.push(o)}(s.length>0||p&&p[d])&&(u={r:c},p&&p[d]&&(g=p[d],g.hidden&&(u.hidden=1),v=-1,g.hpx?v=ys(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(u.ht=v,u.customHeight=1),g.level&&(u.outlineLevel=g.level)),n[n.length]=ge("row",s.join(""),u))}if(p)for(;d<p.length;++d)p&&p[d]&&(u={r:d+1},g=p[d],g.hidden&&(u.hidden=1),v=-1,g.hpx?v=ys(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(u.ht=v,u.customHeight=1),g.level&&(u.outlineLevel=g.level),n[n.length]=ge("row","",u));return n.join("")}function Qf(e,t,r,a){var n=[Nt,ge("worksheet",null,{xmlns:Ka[0],"xmlns:r":Ht.r})],s=r.SheetNames[e],i=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",f=Ze(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=He(f)}a||(a={}),l["!comments"]=[];var d=[];t_(l,r,e,t,n),n[n.length]=ge("dimension",null,{ref:c}),n[n.length]=h_(l,t,e,r),t.sheetFormat&&(n[n.length]=ge("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(n[n.length]=c_(l,l["!cols"])),n[i=n.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=x_(l,t,e,r,a),o.length>0&&(n[n.length]=o)),n.length>i+1&&(n[n.length]="</sheetData>",n[i]=n[i].replace("/>",">")),l["!protect"]&&(n[n.length]=n_(l["!protect"])),l["!autofilter"]!=null&&(n[n.length]=u_(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(n[n.length]=Qy(l["!merges"]));var h=-1,p,m=-1;return l["!links"].length>0&&(n[n.length]="<hyperlinks>",l["!links"].forEach(function(u){u[1].Target&&(p={ref:u[0]},u[1].Target.charAt(0)!="#"&&(m=lt(a,-1,ct(u[1].Target).replace(/#.*$/,""),Ge.HLINK),p["r:id"]="rId"+m),(h=u[1].Target.indexOf("#"))>-1&&(p.location=ct(u[1].Target.slice(h+1))),u[1].Tooltip&&(p.tooltip=ct(u[1].Tooltip)),n[n.length]=ge("hyperlink",null,p))}),n[n.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(n[n.length]=o_(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=qt("ignoredErrors",ge("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(m=lt(a,-1,"../drawings/drawing"+(e+1)+".xml",Ge.DRAW),n[n.length]=ge("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=d),l["!comments"].length>0&&(m=lt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ge.VML),n[n.length]=ge("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function v_(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function y_(e,t,r){var a=ie(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var s=320;n.hpx?s=ys(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),a.write_shift(1,i),a.write_shift(1,0);var o=0,l=a.l;a.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,p=f<<10;p<f+1<<10;++p){c.c=p;var m=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Le(c)];m&&(d<0&&(d=p),h=p)}d<0||(++o,a.write_shift(4,d),a.write_shift(4,h))}var u=a.l;return a.l=l,a.write_shift(4,o),a.l=u,a.length>a.l?a.slice(0,a.l):a}function __(e,t,r,a){var n=y_(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&de(e,0,n)}var w_=Qa,E_=Nn;function b_(){}function k_(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=Th(e,t-19),r}function S_(e,t,r){r==null&&(r=ie(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return mi({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Y0(e,r),r.slice(0,r.l)}function C_(e){var t=Or(e);return[t]}function T_(e,t,r){return r==null&&(r=ie(8)),Ja(t,r)}function A_(e){var t=qa(e);return[t]}function R_(e,t,r){return r==null&&(r=ie(4)),Za(t,r)}function I_(e){var t=Or(e),r=e.read_shift(1);return[t,r,"b"]}function F_(e,t,r){return r==null&&(r=ie(9)),Ja(t,r),r.write_shift(1,e.v?1:0),r}function D_(e){var t=qa(e),r=e.read_shift(1);return[t,r,"b"]}function N_(e,t,r){return r==null&&(r=ie(5)),Za(t,r),r.write_shift(1,e.v?1:0),r}function O_(e){var t=Or(e),r=e.read_shift(1);return[t,r,"e"]}function P_(e,t,r){return r==null&&(r=ie(9)),Ja(t,r),r.write_shift(1,e.v),r}function L_(e){var t=qa(e),r=e.read_shift(1);return[t,r,"e"]}function $_(e,t,r){return r==null&&(r=ie(8)),Za(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function M_(e){var t=Or(e),r=e.read_shift(4);return[t,r,"s"]}function B_(e,t,r){return r==null&&(r=ie(12)),Ja(t,r),r.write_shift(4,t.v),r}function U_(e){var t=qa(e),r=e.read_shift(4);return[t,r,"s"]}function H_(e,t,r){return r==null&&(r=ie(8)),Za(t,r),r.write_shift(4,t.v),r}function V_(e){var t=Or(e),r=ar(e);return[t,r,"n"]}function j_(e,t,r){return r==null&&(r=ie(16)),Ja(t,r),Ga(e.v,r),r}function eu(e){var t=qa(e),r=ar(e);return[t,r,"n"]}function W_(e,t,r){return r==null&&(r=ie(12)),Za(t,r),Ga(e.v,r),r}function G_(e){var t=Or(e),r=nl(e);return[t,r,"n"]}function z_(e,t,r){return r==null&&(r=ie(12)),Ja(t,r),K0(e.v,r),r}function X_(e){var t=qa(e),r=nl(e);return[t,r,"n"]}function Y_(e,t,r){return r==null&&(r=ie(8)),Za(t,r),K0(e.v,r),r}function K_(e){var t=Or(e),r=tl(e);return[t,r,"is"]}function J_(e){var t=Or(e),r=sr(e);return[t,r,"str"]}function q_(e,t,r){return r==null&&(r=ie(12+4*e.v.length)),Ja(t,r),Yt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Z_(e){var t=qa(e),r=sr(e);return[t,r,"str"]}function Q_(e,t,r){return r==null&&(r=ie(8+4*e.v.length)),Za(t,r),Yt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ew(e,t,r){var a=e.l+t,n=Or(e);n.r=r["!row"];var s=e.read_shift(1),i=[n,s,"b"];if(r.cellFormula){e.l+=2;var o=Ii(e,a-e.l,r);i[3]=tr(o,null,n,r.supbooks,r)}else e.l=a;return i}function tw(e,t,r){var a=e.l+t,n=Or(e);n.r=r["!row"];var s=e.read_shift(1),i=[n,s,"e"];if(r.cellFormula){e.l+=2;var o=Ii(e,a-e.l,r);i[3]=tr(o,null,n,r.supbooks,r)}else e.l=a;return i}function rw(e,t,r){var a=e.l+t,n=Or(e);n.r=r["!row"];var s=ar(e),i=[n,s,"n"];if(r.cellFormula){e.l+=2;var o=Ii(e,a-e.l,r);i[3]=tr(o,null,n,r.supbooks,r)}else e.l=a;return i}function aw(e,t,r){var a=e.l+t,n=Or(e);n.r=r["!row"];var s=sr(e),i=[n,s,"str"];if(r.cellFormula){e.l+=2;var o=Ii(e,a-e.l,r);i[3]=tr(o,null,n,r.supbooks,r)}else e.l=a;return i}var nw=Qa,sw=Nn;function iw(e,t){return t==null&&(t=ie(4)),t.write_shift(4,e),t}function ow(e,t){var r=e.l+t,a=Qa(e,16),n=rl(e),s=sr(e),i=sr(e),o=sr(e);e.l=r;var l={rfx:a,relId:n,loc:s,display:o};return i&&(l.Tooltip=i),l}function lw(e,t){var r=ie(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Nn({s:St(e[0]),e:St(e[0])},r),al("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return Yt(n||"",r),Yt(e[1].Tooltip||"",r),Yt("",r),r.slice(0,r.l)}function cw(){}function fw(e,t,r){var a=e.l+t,n=J0(e,16),s=e.read_shift(1),i=[n];if(i[2]=s,r.cellFormula){var o=Oy(e,a-e.l,r);i[1]=o}else e.l=a;return i}function uw(e,t,r){var a=e.l+t,n=Qa(e,16),s=[n];if(r.cellFormula){var i=Ly(e,a-e.l,r);s[1]=i,e.l=a}else e.l=a;return s}function dw(e,t,r){r==null&&(r=ie(18));var a=Fi(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var tu=["left","right","top","bottom","header","footer"];function pw(e){var t={};return tu.forEach(function(r){t[r]=ar(e,8)}),t}function hw(e,t){return t==null&&(t=ie(48)),Va(e),tu.forEach(function(r){Ga(e[r],t)}),t}function mw(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function gw(e,t,r){r==null&&(r=ie(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function xw(e){var t=ie(24);return t.write_shift(4,4),t.write_shift(4,1),Nn(e,t),t}function vw(e,t){return t==null&&(t=ie(66)),t.write_shift(2,e.password?fl(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function yw(){}function _w(){}function ww(e,t,r,a,n,s,i){if(!e)return e;var o=t||{};a||(a={"!id":{}}),At!=null&&o.dense==null&&(o.dense=At);var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=[],h=!1,p=!1,m,u,g,v,y,x,b,C,w,_=[];o.biff=12,o["!row"]=0;var k=0,S=!1,D=[],R={},T=o.supbooks||n.supbooks||[[]];if(T.sharedf=R,T.arrayf=D,T.SheetNames=n.SheetNames||n.Sheets.map(function(Z){return Z.name}),!o.supbooks&&(o.supbooks=T,n.Names))for(var V=0;V<n.Names.length;++V)T[0][V+1]=n.Names[V];var G=[],W=[],j=!1;_s[16]={n:"BrtShortReal",f:eu};var se,q;if(ua(e,function(X,F,U){if(!p)switch(U){case 148:c=X;break;case 0:m=X,o.sheetRows&&o.sheetRows<=m.r&&(p=!0),C=Dt(v=m.r),o["!row"]=m.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=An(X.hpt)),W[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:X[2]},X[2]){case"n":u.v=X[1];break;case"s":b=ss[X[1]],u.v=b.t,u.r=b.r;break;case"b":u.v=!!X[1];break;case"e":u.v=X[1],o.cellText!==!1&&(u.w=da[u.v]);break;case"str":u.t="s",u.v=X[1];break;case"is":u.t="s",u.v=X[1].t;break}if((g=i.CellXf[X[0].iStyleRef])&&qf(u,g.numFmtId,null,o,s,i),y=X[0].c==-1?y+1:X[0].c,o.dense?(l[v]||(l[v]=[]),l[v][y]=u):l[kt(y)+C]=u,o.cellFormula){for(S=!1,k=0;k<D.length;++k){var P=D[k];m.r>=P[0].s.r&&m.r<=P[0].e.r&&y>=P[0].s.c&&y<=P[0].e.c&&(u.F=He(P[0]),S=!0)}!S&&X.length>3&&(u.f=X[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),o.cellDates&&g&&u.t=="n"&&Rn(De[g.numFmtId])){var B=Ma(u.v);B&&(u.t="d",u.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}se&&(se.type=="XLDAPR"&&(u.D=!0),se=void 0),q&&(q=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;u={t:"z",v:void 0},y=X[0].c==-1?y+1:X[0].c,o.dense?(l[v]||(l[v]=[]),l[v][y]=u):l[kt(y)+C]=u,f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),se&&(se.type=="XLDAPR"&&(u.D=!0),se=void 0),q&&(q=void 0);break;case 176:_.push(X);break;case 49:se=((o.xlmeta||{}).Cell||[])[X-1];break;case 494:var Y=a["!id"][X.relId];for(Y?(X.Target=Y.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=Y):X.relId==""&&(X.Target="#"+X.loc),v=X.rfx.s.r;v<=X.rfx.e.r;++v)for(y=X.rfx.s.c;y<=X.rfx.e.c;++y)o.dense?(l[v]||(l[v]=[]),l[v][y]||(l[v][y]={t:"z",v:void 0}),l[v][y].l=X):(x=Le({c:y,r:v}),l[x]||(l[x]={t:"z",v:void 0}),l[x].l=X);break;case 426:if(!o.cellFormula)break;D.push(X),w=o.dense?l[v][y]:l[kt(y)+C],w.f=tr(X[1],f,{r:m.r,c:y},T,o),w.F=He(X[0]);break;case 427:if(!o.cellFormula)break;R[Le(X[0].s)]=X[1],w=o.dense?l[v][y]:l[kt(y)+C],w.f=tr(X[1],f,{r:m.r,c:y},T,o);break;case 60:if(!o.cellStyles)break;for(;X.e>=X.s;)G[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},j||(j=!0,ul(X.w/256)),ba(G[X.e+1]);break;case 161:l["!autofilter"]={ref:He(X)};break;case 476:l["!margins"]=X;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),X.name&&(n.Sheets[r].CodeName=X.name),(X.above||X.left)&&(l["!outline"]={above:X.above,left:X.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),X.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:d.push(U),h=!0;break;case 38:d.pop(),h=!1;break;default:if(!F.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=He(c||f)),o.sheetRows&&l["!ref"]){var K=Ze(l["!ref"]);o.sheetRows<=+K.e.r&&(K.e.r=o.sheetRows-1,K.e.r>f.e.r&&(K.e.r=f.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>f.e.c&&(K.e.c=f.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),l["!fullref"]=l["!ref"],l["!ref"]=He(K))}return _.length>0&&(l["!merges"]=_),G.length>0&&(l["!cols"]=G),W.length>0&&(l["!rows"]=W),l}function Ew(e,t,r,a,n,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=_t(t),t.z=t.z||De[14],t.v=Vt(yt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:a};switch(l.s=Aa(n.cellXfs,t,n),t.l&&s["!links"].push([Le(l),t.l]),t.c&&s["!comments"].push([Le(l),t.c]),t.t){case"s":case"str":return n.bookSST?(o=gl(n.Strings,t.v,n.revStrings),l.t="s",l.v=o,i?de(e,18,H_(t,l)):de(e,7,B_(t,l))):(l.t="str",i?de(e,17,Q_(t,l)):de(e,6,q_(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?de(e,13,Y_(t,l)):de(e,2,z_(t,l)):i?de(e,16,W_(t,l)):de(e,5,j_(t,l)),!0;case"b":return l.t="b",i?de(e,15,N_(t,l)):de(e,4,F_(t,l)),!0;case"e":return l.t="e",i?de(e,14,$_(t,l)):de(e,3,P_(t,l)),!0}return i?de(e,12,R_(t,l)):de(e,1,T_(t,l)),!0}function bw(e,t,r,a){var n=Ze(t["!ref"]||"A1"),s,i="",o=[];de(e,145);var l=Array.isArray(t),c=n.e.r;t["!rows"]&&(c=Math.max(n.e.r,t["!rows"].length-1));for(var f=n.s.r;f<=c;++f){i=Dt(f),__(e,t,n,f);var d=!1;if(f<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){f===n.s.r&&(o[h]=kt(h)),s=o[h]+i;var p=l?(t[f]||[])[h]:t[s];if(!p){d=!1;continue}d=Ew(e,p,f,h,a,t,d)}}de(e,146)}function kw(e,t){!t||!t["!merges"]||(de(e,177,iw(t["!merges"].length)),t["!merges"].forEach(function(r){de(e,176,sw(r))}),de(e,178))}function Sw(e,t){!t||!t["!cols"]||(de(e,390),t["!cols"].forEach(function(r,a){r&&de(e,60,dw(a,r))}),de(e,391))}function Cw(e,t){!t||!t["!ref"]||(de(e,648),de(e,649,xw(Ze(t["!ref"]))),de(e,650))}function Tw(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=lt(r,-1,a[1].Target.replace(/#.*$/,""),Ge.HLINK);de(e,494,lw(a,n))}}),delete t["!links"]}function Aw(e,t,r,a){if(t["!comments"].length>0){var n=lt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ge.VML);de(e,551,al("rId"+n)),t["!legacy"]=n}}function Rw(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:He(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=gr(s);o.s.r==o.e.r&&(o.e.r=gr(t["!ref"]).e.r,s=He(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),de(e,161,Nn(Ze(s))),de(e,162)}}function Iw(e,t,r){de(e,133),de(e,137,gw(t,r)),de(e,138),de(e,134)}function Fw(e,t){t["!protect"]&&de(e,535,vw(t["!protect"]))}function Dw(e,t,r,a){var n=mr(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=Ze(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],de(n,129),(r.vbaraw||i["!outline"])&&de(n,147,S_(o,i["!outline"])),de(n,148,E_(l)),Iw(n,i,r.Workbook),Sw(n,i,e,t,r),bw(n,i,e,t,r),Fw(n,i),Rw(n,i,r,e),kw(n,i),Tw(n,i,a),i["!margins"]&&de(n,476,hw(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Cw(n,i),Aw(n,i,e,a),de(n,130),n.end()}function Nw(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var n=qe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[t,n,a]}function Ow(e,t,r,a,n,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=Nw(d);f.s.r=f.s.c=0,f.e.c=o,c=kt(o),h[0].forEach(function(p,m){i[c+Dt(m)]={t:"n",v:p,z:h[1]},l=m}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=He(f)),i}function Pw(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(Zf);return o&&xl(o[0],s,n,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function Lw(e,t){e.l+=10;var r=sr(e,t-10);return{name:r}}function $w(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],o=!1;return ua(e,function(c,f,d){switch(d){case 550:s["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d);break;case 38:i.pop();break;default:if(f.T>0)i.push(d);else if(f.T<0)i.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var vl=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Mw=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Bw=[],Uw=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function i0(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=vt(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function o0(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=vt(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function ru(e){o0(e.WBProps,vl),o0(e.CalcPr,Uw),i0(e.WBView,Mw),i0(e.Sheets,Bw),kn.date1904=vt(e.WBProps.date1904)}function Hw(e){return!e.Workbook||!e.Workbook.WBProps?"false":vt(e.Workbook.WBProps.date1904)?"true":"false"}var Vw="][*?/\\".split("");function au(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return Vw.forEach(function(a){if(e.indexOf(a)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function jw(e,t,r){e.forEach(function(a,n){au(a);for(var s=0;s<n;++s)if(a==e[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var i=t&&t[n]&&t[n].CodeName||a;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Ww(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];jw(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Hy(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Gw=/<\w+:workbook/;function zw(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},i=0;if(e.replace(or,function(l,c){var f=$e(l);switch(ea(f[0])){case"<?xml":break;case"<workbook":l.match(Gw)&&(n="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":vl.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=vt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=ut(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=qe(ut(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=ut(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),vt(f.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=qe(ut(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),Ka.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ru(r),r}function nu(e){var t=[Nt];t[t.length]=ge("workbook",null,{xmlns:Ka[0],"xmlns:r":Ht.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(vl.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=ge("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:ct(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ge("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=ge("definedName",ct(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Xw(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=So(e,t-8),r.name=sr(e),r}function Yw(e,t){return t||(t=ie(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),al(e.strRelID,t),Yt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Kw(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?sr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function Jw(e,t){t||(t=ie(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Y0(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function qw(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Zw(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=Ah(e),i=Py(e,0,r),o=rl(e);e.l=a;var l={Name:s,Ptg:i};return n<268435455&&(l.Sheet=n),o&&(l.Comment=o),l}function Qw(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],_s[16]={n:"BrtFRTArchID$",f:qw},ua(e,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=tr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!c.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),ru(r),r.Names=s,r.supbooks=i,r}function e2(e,t){de(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};de(e,156,Yw(n))}de(e,144)}function t2(e,t){t||(t=ie(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Yt("SheetJS",t),Yt(cs.version,t),Yt(cs.version,t),Yt("7262",t),t.length>t.l?t.slice(0,t.l):t}function r2(e,t){t||(t=ie(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function a2(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(de(e,135),de(e,158,r2(n)),de(e,136))}}function n2(e,t){var r=mr();return de(r,131),de(r,128,t2()),de(r,153,Jw(e.Workbook&&e.Workbook.WBProps||null)),a2(r,e,t),e2(r,e,t),de(r,132),r.end()}function s2(e,t,r){return t.slice(-4)===".bin"?Qw(e,r):zw(e,r)}function i2(e,t,r,a,n,s,i,o){return t.slice(-4)===".bin"?ww(e,a,r,n,s,i,o):Zy(e,a,r,n,s,i,o)}function o2(e,t,r,a,n,s,i,o){return t.slice(-4)===".bin"?$w(e,a,r,n,s,i,o):Pw(e,a,r,n,s,i,o)}function l2(e,t,r,a,n,s,i,o){return t.slice(-4)===".bin"?fv(e,a,r,n,s,i,o):uv(e,a,r,n,s,i,o)}function c2(e,t,r,a,n,s,i,o){return t.slice(-4)===".bin"?lv(e,a,r,n,s,i,o):cv(e,a,r,n,s,i,o)}function f2(e,t,r,a){return t.slice(-4)===".bin"?sx(e,r,a):X1(e,r,a)}function u2(e,t,r){return Mf(e,r)}function d2(e,t,r){return t.slice(-4)===".bin"?d1(e,r):c1(e,r)}function p2(e,t,r){return t.slice(-4)===".bin"?av(e,r):Yx(e,r)}function h2(e,t,r){return t.slice(-4)===".bin"?Gx(e,t,r):jx(e,t,r)}function m2(e,t,r,a){return r.slice(-4)===".bin"?zx(e,t,r,a):void 0}function g2(e,t,r){return t.slice(-4)===".bin"?Ux(e,t,r):Vx(e,t,r)}function x2(e,t,r){return(t.slice(-4)===".bin"?n2:nu)(e,r)}function v2(e,t,r,a,n){return(t.slice(-4)===".bin"?Dw:Qf)(e,r,a,n)}function y2(e,t,r){return(t.slice(-4)===".bin"?mx:Lf)(e,r)}function _2(e,t,r){return(t.slice(-4)===".bin"?m1:Af)(e,r)}function w2(e,t,r){return(t.slice(-4)===".bin"?nv:Hf)(e,r)}function E2(e){return(e.slice(-4)===".bin"?Hx:Bf)()}var su=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,iu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Br(e,t){var r=e.split(/\s+/),a=[];if(t||(a[0]=r[0]),r.length===1)return a;var n=e.match(su),s,i,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(iu),(i=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),a[o]=s[2].slice(1,s[2].length-1));return a}function b2(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(su),n,s,i,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(iu),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(s+1),r[i]=n[2].slice(1,n[2].length-1));return r}var os;function k2(e,t){var r=os[e]||qe(e);return r==="General"?ja(t):Nr(r,t)}function S2(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=vt(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=yt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[qe(t)]=n}function C2(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||da[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=us(e.v):e.w=ja(e.v):e.w=k2(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var a=os[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Rn(a)){var n=Ma(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function T2(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=B1[a.Pattern]||a.Pattern)}e[t.ID]=t}function A2(e,t,r,a,n,s,i,o,l,c){var f="General",d=a.StyleID,h={};c=c||{};var p=[],m=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&p.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=vt(e);break;case"String":a.t="s",a.r=kc(qe(e)),a.v=e.indexOf("<")>-1?qe(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(yt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=qe(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Q0[e],c.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=kc(t||e));break}if(C2(a,f,c),c.cellFormula!==!1)if(a.Formula){var u=qe(a.Formula);u.charCodeAt(0)==61&&(u=u.slice(1)),a.f=bn(u,n),delete a.Formula,a.ArrayRange=="RC"?a.F=bn("RC:RC",n):a.ArrayRange&&(a.F=bn(a.ArrayRange,n),l.push([Ze(a.F),a.F]))}else for(m=0;m<l.length;++m)n.r>=l[m][0].s.r&&n.r<=l[m][0].e.r&&n.c>=l[m][0].s.c&&n.c<=l[m][0].e.c&&(a.F=l[m][1]);c.cellStyles&&(p.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function R2(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function vo(e,t){var r=t||{};In();var a=Zn(zo(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof st!="undefined"?a=st.utils.decode(65001,bo(a)):a=ut(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=_t(r);return i.type="string",Tn.to_workbook(a,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ce){n.indexOf("<"+ce)>=0&&(s=!0)}),s)return hE(a,r);os={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c;At!=null&&r.dense==null&&(r.dense=At);var f={},d=[],h=r.dense?[]:{},p="",m={},u={},g=Br('<Data ss:Type="String">'),v=0,y=0,x=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},w={},_="",k=0,S=[],D={},R={},T=0,V=[],G=[],W={},j=[],se,q=!1,K=[],Z=[],X={},F=0,U=0,P={Sheets:[],WBProps:{date1904:!1}},B={};hs.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";o=hs.exec(a);)switch(o[3]=(Y=o[3]).toLowerCase()){case"data":if(Y=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?A2(a.slice(v,o.index),_,g,l[l.length-1][0]=="comment"?W:m,{c:y,r:x},C,j[y],u,K,r):(_="",g=Br(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(m.c=G),(!r.sheetRows||r.sheetRows>x)&&m.v!==void 0&&(r.dense?(h[x]||(h[x]=[]),h[x][y]=m):h[kt(y)+Dt(x)]=m),m.HRef&&(m.l={Target:qe(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(F=y+(parseInt(m.MergeAcross,10)|0),U=x+(parseInt(m.MergeDown,10)|0),S.push({s:{c:y,r:x},e:{c:F,r:U}})),!r.sheetStubs)m.MergeAcross?y=F+1:++y;else if(m.MergeAcross||m.MergeDown){for(var Q=y;Q<=F;++Q)for(var J=x;J<=U;++J)(Q>y||J>x)&&(r.dense?(h[J]||(h[J]=[]),h[J][Q]={t:"z"}):h[kt(Q)+Dt(J)]={t:"z"});y=F+1}else++y;else m=b2(o[0]),m.Index&&(y=+m.Index-1),y<b.s.c&&(b.s.c=y),y>b.e.c&&(b.e.c=y),o[0].slice(-2)==="/>"&&++y,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<b.s.r&&(b.s.r=x),x>b.e.r&&(b.e.r=x),o[0].slice(-2)==="/>"&&(u=Br(o[0]),u.Index&&(x=+u.Index-1)),y=0,++x):(u=Br(o[0]),u.Index&&(x=+u.Index-1),X={},(u.AutoFitHeight=="0"||u.Height)&&(X.hpx=parseInt(u.Height,10),X.hpt=ys(X.hpx),Z[x]=X),u.Hidden=="1"&&(X.hidden=!0,Z[x]=X));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(p),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(h["!ref"]=He(b),r.sheetRows&&r.sheetRows<=b.e.r&&(h["!fullref"]=h["!ref"],b.e.r=r.sheetRows-1,h["!ref"]=He(b))),S.length&&(h["!merges"]=S),j.length>0&&(h["!cols"]=j),Z.length>0&&(h["!rows"]=Z),f[p]=h}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=y=0,l.push([o[3],!1]),c=Br(o[0]),p=qe(c.Name),h=r.dense?[]:{},S=[],K=[],Z=[],B={name:p,Hidden:0},P.Sheets.push(B);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),j=[],q=!1}break;case"style":o[1]==="/"?T2(C,w,r):w=Br(o[0]);break;case"numberformat":w.nf=qe(Br(o[0]).Format||"General"),os[w.nf]&&(w.nf=os[w.nf]);for(var oe=0;oe!=392&&De[oe]!=w.nf;++oe);if(oe==392){for(oe=57;oe!=392;++oe)if(De[oe]==null){oa(w.nf,oe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(se=Br(o[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!q&&se.wpx>10){q=!0,rr=Of;for(var ae=0;ae<j.length;++ae)j[ae]&&ba(j[ae])}q&&ba(se),j[se.Index-1||j.length]=se;for(var be=0;be<+se.Span;++be)j[j.length]=_t(se);break;case"namedrange":if(o[1]==="/")break;P.Names||(P.Names=[]);var O=$e(o[0]),Se={Name:O.Name,Ref:bn(O.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Se.Sheet=P.Sheets.length-1),P.Names.push(Se);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_+=a.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;w.Interior=Br(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Qh(D,Y,a.slice(T,o.index)):T=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));R2(W),G.push(W)}else l.push([o[3],!1]),c=Br(o[0]),W={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=Br(o[0]);h["!autofilter"]={ref:bn(ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return d0(a,r);var Ne=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ne=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ne=!1}break;case"excelworkbook":switch(o[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ne=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ne=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(T,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else T=o.index+o[0].length;break;case"header":h["!margins"]||Va(h["!margins"]={},"xlml"),isNaN(+$e(o[0]).Margin)||(h["!margins"].header=+$e(o[0]).Margin);break;case"footer":h["!margins"]||Va(h["!margins"]={},"xlml"),isNaN(+$e(o[0]).Margin)||(h["!margins"].footer=+$e(o[0]).Margin);break;case"pagemargins":var pe=$e(o[0]);h["!margins"]||Va(h["!margins"]={},"xlml"),isNaN(+pe.Top)||(h["!margins"].top=+pe.Top),isNaN(+pe.Left)||(h["!margins"].left=+pe.Left),isNaN(+pe.Right)||(h["!margins"].right=+pe.Right),isNaN(+pe.Bottom)||(h["!margins"].bottom=+pe.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ne=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ne=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ne=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ne=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ne=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ne=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ne=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ne=!1}break;case"smarttags":break;default:Ne=!1;break}if(Ne||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?S2(R,Y,V,a.slice(T,o.index)):(V=o,T=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var z={};return!r.bookSheets&&!r.bookProps&&(z.Sheets=f),z.SheetNames=d,z.Workbook=P,z.SSF=_t(De),z.Props=D,z.Custprops=R,z}function Do(e,t){switch(_l(t=t||{}),t.type||"base64"){case"base64":return vo(br(e),t);case"binary":case"buffer":case"file":return vo(e,t);case"array":return vo(Ca(e),t)}}function I2(e,t){var r=[];return e.Props&&r.push(em(e.Props,t)),e.Custprops&&r.push(tm(e.Props,e.Custprops,t)),r.join("")}function F2(){return""}function D2(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var s=[];s.push(ge("NumberFormat",null,{"ss:Format":ct(De[a.numFmtId])}));var i={"ss:ID":"s"+(21+n)};r.push(ge("Style",s.join(""),i))}),ge("Styles",r.join(""))}function ou(e){return ge("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+hl(e.Ref,{r:0,c:0})})}function N2(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(ou(n)))}return ge("Names",r.join(""))}function O2(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],i=0;i<n.length;++i){var o=n[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(ou(o)))}return s.join("")}function P2(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(ge("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(ge("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(ge("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(ge("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(qt("ProtectContents","True")),e["!protect"].objects&&n.push(qt("ProtectObjects","True")),e["!protect"].scenarios&&n.push(qt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(qt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(qt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&n.push("<"+i[1]+"/>")})),n.length==0?"":ge("WorksheetOptions",n.join(""),{xmlns:_r.x})}function L2(e){return e.map(function(t){var r=rh(t.t||""),a=ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ge("Comment",a,{"ss:Author":t.a})}).join("")}function $2(e,t,r,a,n,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ct(hl(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=St(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ct(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ct(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=i.c||c[f].s.r!=i.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var d="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=da[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||De[14]);break;case"s":d="String",h=th(e.v||"");break}var p=Aa(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var m=e.v!=null?h:"",u=e.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(u+=L2(e.c)),ge("Cell",u,o)}function M2(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=An(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function B2(e,t,r,a){if(!e["!ref"])return"";var n=Ze(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,v){ba(g);var y=!!g.width,x=Fi(v,g),b={"ss:Index":v+1};y&&(b["ss:Width"]=xs(x.width)),g.hidden&&(b["ss:Hidden"]="1"),o.push(ge("Column",null,b))});for(var l=Array.isArray(e),c=n.s.r;c<=n.e.r;++c){for(var f=[M2(c,(e["!rows"]||[])[c])],d=n.s.c;d<=n.e.c;++d){var h=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>d)&&!(s[i].s.r>c)&&!(s[i].e.c<d)&&!(s[i].e.r<c)){(s[i].s.c!=d||s[i].s.r!=c)&&(h=!0);break}if(!h){var p={r:c,c:d},m=Le(p),u=l?(e[c]||[])[d]:e[m];f.push($2(u,m,e,t,r,a,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function U2(e,t,r){var a=[],n=r.SheetNames[e],s=r.Sheets[n],i=s?O2(s,t,e,r):"";return i.length>0&&a.push("<Names>"+i+"</Names>"),i=s?B2(s,t,e,r):"",i.length>0&&a.push("<Table>"+i+"</Table>"),a.push(P2(s,t,e,r)),a.join("")}function H2(e,t){t||(t={}),e.SSF||(e.SSF=_t(De)),e.SSF&&(In(),bi(e.SSF),t.revssf=Si(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Aa(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(I2(e,t)),r.push(F2(e,t)),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(ge("Worksheet",U2(a,t,e),{"ss:Name":ct(e.SheetNames[a])}));return r[2]=D2(e,t),r[3]=N2(e,t),Nt+ge("Workbook",r.join(""),{xmlns:_r.ss,"xmlns:o":_r.o,"xmlns:x":_r.x,"xmlns:ss":_r.ss,"xmlns:dt":_r.dt,"xmlns:html":_r.html})}function V2(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Nh(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=Oh(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var j2=[60,1084,2066,2165,2175];function W2(e,t,r,a,n){var s=a,i=[],o=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}i.push(o),r.l+=s;for(var l=sa(r,r.l),c=No[l],f=0;c!=null&&j2.indexOf(l)>-1;)s=sa(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,c=No[l=sa(r,r.l)];var d=Xt(i);Jt(d,0);var h=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(h),h+=i[p].length;if(d.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+a;return t.f(d,d.length,n)}function Kr(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=De[a])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||da[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=us(e.v):e.w=ja(e.v):e.w=Nr(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&a&&e.t=="n"&&Rn(De[a]||String(a))){var n=Ma(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function oi(e,t,r){return{v:e,ixfe:t,t:r}}function G2(e,t){var r={opts:{}},a={};At!=null&&t.dense==null&&(t.dense=At);var n=t.dense?[]:{},s={},i={},o=null,l=[],c="",f={},d,h="",p,m,u,g,v={},y=[],x,b,C=[],w=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(Ae){return Ae<8?Ba[Ae]:Ae<64&&w[Ae-8]||Ba[Ae]},D=function(Ae,tt,pt){var je=tt.XF.data;if(!(!je||!je.patternType||!pt||!pt.cellStyles)){tt.s={},tt.s.patternType=je.patternType;var Ye;(Ye=gs(S(je.icvFore)))&&(tt.s.fgColor={rgb:Ye}),(Ye=gs(S(je.icvBack)))&&(tt.s.bgColor={rgb:Ye})}},R=function(Ae,tt,pt){if(!(X>1)&&!(pt.sheetRows&&Ae.r>=pt.sheetRows)){if(pt.cellStyles&&tt.XF&&tt.XF.data&&D(Ae,tt,pt),delete tt.ixfe,delete tt.XF,d=Ae,h=Le(Ae),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ae.r<i.s.r&&(i.s.r=Ae.r),Ae.c<i.s.c&&(i.s.c=Ae.c),Ae.r+1>i.e.r&&(i.e.r=Ae.r+1),Ae.c+1>i.e.c&&(i.e.c=Ae.c+1),pt.cellFormula&&tt.f){for(var je=0;je<y.length;++je)if(!(y[je][0].s.c>Ae.c||y[je][0].s.r>Ae.r)&&!(y[je][0].e.c<Ae.c||y[je][0].e.r<Ae.r)){tt.F=He(y[je][0]),(y[je][0].s.c!=Ae.c||y[je][0].s.r!=Ae.r)&&delete tt.f,tt.f&&(tt.f=""+tr(y[je][1],i,Ae,K,T));break}}pt.dense?(n[Ae.r]||(n[Ae.r]=[]),n[Ae.r][Ae.c]=tt):n[h]=tt}},T={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var V,G=[],W=[],j=[],se=[],q=!1,K=[];K.SheetNames=T.snames,K.sharedf=T.sharedf,K.arrayf=T.arrayf,K.names=[],K.XTI=[];var Z=0,X=0,F=0,U=[],P=[],B;T.codepage=1200,Ur(1200);for(var Y=!1;e.l<e.length-1;){var Q=e.l,J=e.read_shift(2);if(J===0&&Z===10)break;var oe=e.l===e.length?0:e.read_shift(2),ae=No[J];if(ae&&ae.f){if(t.bookSheets&&Z===133&&J!==133)break;if(Z=J,ae.r===2||ae.r==12){var be=e.read_shift(2);if(oe-=2,!T.enc&&be!==J&&((be&255)<<8|be>>8)!==J)throw new Error("rt mismatch: "+be+"!="+J);ae.r==12&&(e.l+=10,oe-=10)}var O={};if(J===10?O=ae.f(e,oe,T):O=W2(J,ae,e,oe,T),X==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(J){case 34:r.opts.Date1904=_.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=O;break;case 66:var Se=Number(O);switch(Se){case 21010:Se=1200;break;case 32768:Se=1e4;break;case 32769:Se=1252;break}Ur(T.codepage=Se),Y=!0;break;case 317:T.rrtabid=O;break;case 25:T.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:T.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(n["!type"]="dialog"),O.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),O.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:C.push(O);break;case 430:K.push([O]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(O);break;case 24:case 536:B={Name:O.Name,Ref:tr(O.rgce,i,null,K,T)},O.itab>0&&(B.Sheet=O.itab-1),K.names.push(B),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(P[O.itab-1]={ref:He(O.rgce[0][0][1][2])});break;case 22:T.ExternCount=O;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(O),K.XTI=K.XTI.concat(O);break;case 2196:if(T.biff<8)break;B!=null&&(B.Comment=O[1]);break;case 18:n["!protect"]=O;break;case 19:O!==0&&T.WTF&&console.error("Password verifier: "+O);break;case 133:s[O.pos]=O,T.snames.push(O.name);break;case 10:{if(--X)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=He(i),t.sheetRows&&t.sheetRows<=i.e.r){var ke=i.e.r;i.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=He(i),i.e.r=ke}i.e.r++,i.e.c++}G.length>0&&(n["!merges"]=G),W.length>0&&(n["!objects"]=W),j.length>0&&(n["!cols"]=j),se.length>0&&(n["!rows"]=se),_.Sheets.push(k)}c===""?f=n:a[c]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),T.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(T.biff=5,Y=!0,Ur(T.codepage=28591)),T.biff==8&&O.BIFFVer==0&&O.dt==16&&(T.biff=2),X++)break;if(n=t.dense?[]:{},T.biff<8&&!Y&&(Y=!0,Ur(T.codepage=t.codepage||1252)),T.biff<5||O.BIFFVer==0&&O.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ne={pos:e.l-oe,name:c};s[Ne.pos]=Ne,T.snames.push(c)}else c=(s[Q]||{name:""}).name;O.dt==32&&(n["!type"]="chart"),O.dt==64&&(n["!type"]="macro"),G=[],W=[],T.arrayf=y=[],j=[],se=[],q=!1,k={Hidden:(s[Q]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[O.r]||[])[O.c]:n[Le({c:O.c,r:O.r})])&&++O.c,x={ixfe:O.ixfe,XF:C[O.ixfe]||{},v:O.val,t:"n"},F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R({c:O.c,r:O.r},x,t);break;case 5:case 517:x={ixfe:O.ixfe,XF:C[O.ixfe],v:O.val,t:O.t},F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R({c:O.c,r:O.r},x,t);break;case 638:x={ixfe:O.ixfe,XF:C[O.ixfe],v:O.rknum,t:"n"},F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R({c:O.c,r:O.r},x,t);break;case 189:for(var pe=O.c;pe<=O.C;++pe){var z=O.rkrec[pe-O.c][0];x={ixfe:z,XF:C[z],v:O.rkrec[pe-O.c][1],t:"n"},F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R({c:pe,r:O.r},x,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){o=O;break}if(x=oi(O.val,O.cell.ixfe,O.tt),x.XF=C[x.ixfe],t.cellFormula){var ce=O.formula;if(ce&&ce[0]&&ce[0][0]&&ce[0][0][0]=="PtgExp"){var ft=ce[0][0][1][0],Ot=ce[0][0][1][1],ze=Le({r:ft,c:Ot});v[ze]?x.f=""+tr(O.formula,i,O.cell,K,T):x.F=((t.dense?(n[ft]||[])[Ot]:n[ze])||{}).F}else x.f=""+tr(O.formula,i,O.cell,K,T)}F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R(O.cell,x,t),o=O}break;case 7:case 519:if(o)o.val=O,x=oi(O,o.cell.ixfe,"s"),x.XF=C[x.ixfe],t.cellFormula&&(x.f=""+tr(o.formula,i,o.cell,K,T)),F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(O);var Pt=Le(O[0].s);if(p=t.dense?(n[O[0].s.r]||[])[O[0].s.c]:n[Pt],t.cellFormula&&p){if(!o||!Pt||!p)break;p.f=""+tr(O[1],i,O[0],K,T),p.F=He(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;v[Le(o.cell)]=O[0],p=t.dense?(n[o.cell.r]||[])[o.cell.c]:n[Le(o.cell)],(p||{}).f=""+tr(O[0],i,d,K,T)}}break;case 253:x=oi(l[O.isst].t,O.ixfe,"s"),l[O.isst].h&&(x.h=l[O.isst].h),x.XF=C[x.ixfe],F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R({c:O.c,r:O.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:O.ixfe,XF:C[O.ixfe],t:"z"},F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R({c:O.c,r:O.r},x,t));break;case 190:if(t.sheetStubs)for(var vr=O.c;vr<=O.C;++vr){var jt=O.ixfe[vr-O.c];x={ixfe:jt,XF:C[jt],t:"z"},F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R({c:vr,r:O.r},x,t)}break;case 214:case 516:case 4:x=oi(O.val,O.ixfe,"s"),x.XF=C[x.ixfe],F>0&&(x.z=U[x.ixfe>>8&63]),Kr(x,t,r.opts.Date1904),R({c:O.c,r:O.r},x,t);break;case 0:case 512:X===1&&(i=O);break;case 252:l=O;break;case 1054:if(T.biff==4){U[F++]=O[1];for(var dr=0;dr<F+163&&De[dr]!=O[1];++dr);dr>=163&&oa(O[1],F+163)}else oa(O[1],O[0]);break;case 30:{U[F++]=O;for(var H=0;H<F+163&&De[H]!=O;++H);H>=163&&oa(O,F+163)}break;case 229:G=G.concat(O);break;case 93:W[O.cmo[0]]=T.lastobj=O;break;case 438:T.lastobj.TxO=O;break;case 127:T.lastobj.ImData=O;break;case 440:for(g=O[0].s.r;g<=O[0].e.r;++g)for(u=O[0].s.c;u<=O[0].e.c;++u)p=t.dense?(n[g]||[])[u]:n[Le({c:u,r:g})],p&&(p.l=O[1]);break;case 2048:for(g=O[0].s.r;g<=O[0].e.r;++g)for(u=O[0].s.c;u<=O[0].e.c;++u)p=t.dense?(n[g]||[])[u]:n[Le({c:u,r:g})],p&&p.l&&(p.l.Tooltip=O[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;p=t.dense?(n[O[0].r]||[])[O[0].c]:n[Le(O[0])];var fe=W[O[2]];p||(t.dense?(n[O[0].r]||(n[O[0].r]=[]),p=n[O[0].r][O[0].c]={t:"z"}):p=n[Le(O[0])]={t:"z"},i.e.r=Math.max(i.e.r,O[0].r),i.s.r=Math.min(i.s.r,O[0].r),i.e.c=Math.max(i.e.c,O[0].c),i.s.c=Math.min(i.s.c,O[0].c)),p.c||(p.c=[]),m={a:O[1],t:fe.TxO.t},p.c.push(m)}break;case 2173:Dx(C[O.ixfe],O.ext);break;case 125:{if(!T.cellStyles)break;for(;O.e>=O.s;)j[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},q||(q=!0,ul(O.w/256)),ba(j[O.e+1])}break;case 520:{var Oe={};O.level!=null&&(se[O.r]=Oe,Oe.level=O.level),O.hidden&&(se[O.r]=Oe,Oe.hidden=!0),O.hpt&&(se[O.r]=Oe,Oe.hpt=O.hpt,Oe.hpx=An(O.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Va(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=O;break;case 161:n["!margins"]||Va(n["!margins"]={}),n["!margins"].header=O.header,n["!margins"].footer=O.footer;break;case 574:O.RTL&&(_.Views[0].RTL=!0);break;case 146:w=O;break;case 2198:V=O;break;case 140:b=O;break;case 442:c?k.CodeName=O||k.name:_.WBProps.CodeName=O||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=oe}return r.SheetNames=Rt(s).sort(function(Je,Ae){return Number(Je)-Number(Ae)}).map(function(Je){return s[Je].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&P.forEach(function(Je,Ae){r.Sheets[r.SheetNames[Ae]]["!autofilter"]=Je}),r.Strings=l,r.SSF=_t(De),T.enc&&(r.Encryption=T.enc),V&&(r.Themes=V),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),K.names.length>0&&(_.Names=K.names),r.Workbook=_,r}var ls={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function z2(e,t,r){var a=Re.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Vc(a,Co,ls.DSI);for(var s in n)t[s]=n[s]}catch(c){if(r.WTF)throw c}var i=Re.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Vc(i,To,ls.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(sf(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function X2(e,t){var r=[],a=[],n=[],s=0,i,o=vc(Co,"n"),l=vc(To,"n");if(e.Props)for(i=Rt(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?a:n).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Rt(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?a:n).push([i[s],e.Custprops[i[s]]]);var c=[];for(s=0;s<n.length;++s)pf.indexOf(n[s][0])>-1||nf.indexOf(n[s][0])>-1||n[s][1]!=null&&c.push(n[s]);a.length&&Re.utils.cfb_add(t,"/SummaryInformation",jc(a,ls.SI,l,To)),(r.length||c.length)&&Re.utils.cfb_add(t,"/DocumentSummaryInformation",jc(r,ls.DSI,o,Co,c.length?c:null,ls.UDI))}function lu(e,t){t||(t={}),_l(t),$o(),t.codepage&&Lo(t.codepage);var r,a;if(e.FullPaths){if(Re.find(e,"/encryption"))throw new Error("File is password-protected");r=Re.find(e,"!CompObj"),a=Re.find(e,"/Workbook")||Re.find(e,"/Book")}else{switch(t.type){case"base64":e=wr(br(e));break;case"binary":e=wr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jt(e,0),a={content:e}}var n,s;if(r&&V2(r),t.bookProps&&!t.bookSheets)n={};else{var i=Xe?"buffer":"array";if(a&&a.content)n=G2(a.content,t);else if((s=Re.find(e,"PerfectOffice_MAIN"))&&s.content)n=Ha.to_workbook(s.content,(t.type=i,t));else if((s=Re.find(e,"NativeContent_MAIN"))&&s.content)n=Ha.to_workbook(s.content,(t.type=i,t));else throw(s=Re.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Re.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=iv(e))}var o={};return e.FullPaths&&z2(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}function Y2(e,t){var r=t||{},a=Re.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Re.utils.cfb_add(a,n,cu(e,r)),r.biff==8&&(e.Props||e.Custprops)&&X2(e,a),r.biff==8&&e.vbaraw&&ov(a,Re.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var _s={0:{f:v_},1:{f:C_},2:{f:G_},3:{f:O_},4:{f:I_},5:{f:V_},6:{f:J_},7:{f:M_},8:{f:aw},9:{f:rw},10:{f:ew},11:{f:tw},12:{f:A_},13:{f:X_},14:{f:L_},15:{f:D_},16:{f:eu},17:{f:Z_},18:{f:U_},19:{f:tl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Zw},40:{},42:{},43:{f:J1},44:{f:Y1},45:{f:Q1},46:{f:tx},47:{f:ex},48:{},49:{f:wh},50:{},51:{f:Px},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:kf},62:{f:K_},63:{f:Wx},64:{f:yw},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ir,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:mw},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:k_},148:{f:w_,p:16},151:{f:cw},152:{},153:{f:Kw},154:{},155:{},156:{f:Xw},157:{},158:{},159:{T:1,f:u1},160:{T:-1},161:{T:1,f:Qa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:nw},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Nx},336:{T:-1},337:{f:Mx,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:So},357:{},358:{},359:{},360:{T:1},361:{},362:{f:bf},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:fw},427:{f:uw},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:pw},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:b_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ow},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:So},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:tv},633:{T:1},634:{T:-1},635:{T:1,f:Qx},636:{T:-1},637:{f:Sh},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Lw},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_w},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},No={6:{f:go},10:{f:ya},12:{f:Bt},13:{f:Bt},14:{f:Ft},15:{f:Ft},16:{f:ar},17:{f:Ft},18:{f:Ft},19:{f:Bt},20:{f:Kc},21:{f:Kc},23:{f:bf},24:{f:qc},25:{f:Ft},26:{},27:{},28:{f:_g},29:{},34:{f:Ft},35:{f:Jc},38:{f:ar},39:{f:ar},40:{f:ar},41:{f:ar},42:{f:Ft},43:{f:Ft},47:{f:D1},49:{f:Xm},51:{f:Bt},60:{},61:{f:Vm},64:{f:Ft},65:{f:zm},66:{f:Bt},77:{},80:{},81:{},82:{},85:{f:Bt},89:{},90:{},91:{},92:{f:Fm},93:{f:bg},94:{},95:{f:Ft},96:{},97:{},99:{f:Ft},125:{f:kf},128:{f:lg},129:{f:Nm},130:{f:Bt},131:{f:Ft},132:{f:Ft},133:{f:Om},134:{},140:{f:Fg},141:{f:Bt},144:{},146:{f:Og},151:{},152:{},153:{},154:{},155:{},156:{f:Bt},157:{},158:{},160:{f:Hg},161:{f:$g},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ng},190:{f:sg},193:{f:ya},197:{},198:{},199:{},200:{},201:{},202:{f:Ft},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Bt},220:{},221:{f:Ft},222:{},224:{f:og},225:{f:Im},226:{f:ya},227:{},229:{f:wg},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Lm},253:{f:Km},255:{f:Mm},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:hf},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ft},353:{f:ya},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:pg},431:{f:Ft},432:{},433:{},434:{},437:{},438:{f:Cg},439:{f:Ft},440:{f:Tg},441:{},442:{f:Ss},443:{},444:{f:Bt},445:{},446:{},448:{f:ya},449:{f:Hm,r:2},450:{f:ya},512:{f:zc},513:{f:Ug},515:{f:ug},516:{f:qm},517:{f:Yc},519:{f:Vg},520:{f:Bm},523:{},545:{f:Zc},549:{f:Gc},566:{},574:{f:Wm},638:{f:ag},659:{},1048:{},1054:{f:Qm},1084:{},1212:{f:xg},2048:{f:Rg},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ni},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ya},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Pg,r:12},2173:{f:Fx,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ft,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:gg,r:12},2197:{},2198:{f:Sx,r:12},2199:{},2200:{},2201:{},2202:{f:vg,r:12},2203:{f:ya},2204:{},2205:{},2206:{},2207:{},2211:{f:Um},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Bt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Mg},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Ng},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:zc},1:{},2:{f:Xg},3:{f:Gg},4:{f:Wg},5:{f:Yc},7:{f:Kg},8:{},9:{f:ni},11:{},22:{f:Bt},30:{f:tg},31:{},32:{},33:{f:Zc},36:{},37:{f:Gc},50:{f:Jg},62:{},52:{},67:{},68:{f:Bt},69:{},86:{},126:{},127:{f:jg},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qg},223:{},234:{},354:{},421:{},518:{f:go},521:{f:ni},536:{f:qc},547:{f:Jc},561:{},579:{},1030:{f:go},1033:{f:ni},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function xe(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&Zo(r)&&e.push(r)}}function K2(e,t,r,a){var n=a||(r||[]).length||0;if(n<=8224)return xe(e,t,r,n);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<n;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Rs(e,t,r){return e||(e=ie(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function J2(e,t,r,a){var n=ie(9);return Rs(n,e,t),mf(r,a||"b",n),n}function q2(e,t,r){var a=ie(8+2*r.length);return Rs(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function Z2(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Vt(yt(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?xe(e,2,Yg(r,a,n)):xe(e,3,zg(r,a,n));return;case"b":case"e":xe(e,5,J2(r,a,t.v,t.t));return;case"s":case"str":xe(e,4,q2(r,a,(t.v||"").slice(0,255)));return}xe(e,1,Rs(null,r,a))}function Q2(e,t,r,a){var n=Array.isArray(t),s=Ze(t["!ref"]||"A1"),i,o="",l=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=He(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Dt(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(l[f]=kt(f)),i=l[f]+o;var d=n?(t[c]||[])[f]:t[i];d&&Z2(e,d,c,f,a)}}}function eE(e,t){var r=t||{};At!=null&&r.dense==null&&(r.dense=At);for(var a=mr(),n=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return xe(a,r.biff==4?1033:r.biff==3?521:9,ll(e,16,r)),Q2(a,e.Sheets[e.SheetNames[n]],n,r,e),xe(a,10),a.end()}function tE(e,t,r){xe(e,49,Ym({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function rE(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&xe(e,1054,eg(n,t[n],r))})}function aE(e,t){var r=ie(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),xe(e,2151,r),r=ie(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_f(Ze(t["!ref"]||"A1"),r),r.write_shift(4,4),xe(e,2152,r)}function nE(e,t){for(var r=0;r<16;++r)xe(e,224,Xc({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){xe(e,224,Xc(a,0,t))})}function sE(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];xe(e,440,Ag(a)),a[1].Tooltip&&xe(e,2048,Ig(a))}delete t["!links"]}function iE(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&xe(e,125,Lg(Fi(n,a),n))})}}function oE(e,t,r,a,n){var s=16+Aa(n.cellXfs,t,n);if(t.v==null&&!t.bf){xe(e,513,Xa(r,a,s));return}if(t.bf)xe(e,6,Ny(t,r,a,n,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?Vt(yt(t.v)):t.v;xe(e,515,dg(r,a,i,s,n));break;case"b":case"e":xe(e,517,fg(r,a,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var o=gl(n.Strings,t.v,n.revStrings);xe(e,253,Jm(r,a,o,s,n))}else xe(e,516,Zm(r,a,(t.v||"").slice(0,255),s,n));break;default:xe(e,513,Xa(r,a,s))}}function lE(e,t,r){var a=mr(),n=r.SheetNames[e],s=r.Sheets[n]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,f,d="",h=[],p=Ze(s["!ref"]||"A1"),m=c?65536:16384;if(p.e.c>255||p.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}xe(a,2057,ll(r,16,t)),xe(a,13,Fr(1)),xe(a,12,Fr(100)),xe(a,15,ur(!0)),xe(a,17,ur(!1)),xe(a,16,Ga(.001)),xe(a,95,ur(!0)),xe(a,42,ur(!1)),xe(a,43,ur(!1)),xe(a,130,Fr(1)),xe(a,128,cg([0,0])),xe(a,131,ur(!1)),xe(a,132,ur(!1)),c&&iE(a,s["!cols"]),xe(a,512,rg(p,t)),c&&(s["!links"]=[]);for(var u=p.s.r;u<=p.e.r;++u){d=Dt(u);for(var g=p.s.c;g<=p.e.c;++g){u===p.s.r&&(h[g]=kt(g)),f=h[g]+d;var v=l?(s[u]||[])[g]:s[f];v&&(oE(a,v,u,g,t),c&&v.l&&s["!links"].push([f,v.l]))}}var y=o.CodeName||o.name||n;return c&&xe(a,574,Gm((i.Views||[])[0])),c&&(s["!merges"]||[]).length&&xe(a,229,Eg(s["!merges"])),c&&sE(a,s),xe(a,442,gf(y,t)),c&&aE(a,s),xe(a,10),a.end()}function cE(e,t,r){var a=mr(),n=(e||{}).Workbook||{},s=n.Sheets||[],i=n.WBProps||{},o=r.biff==8,l=r.biff==5;if(xe(a,2057,ll(e,5,r)),r.bookType=="xla"&&xe(a,135),xe(a,225,o?Fr(1200):null),xe(a,193,fm(2)),l&&xe(a,191),l&&xe(a,192),xe(a,226),xe(a,92,Dm("SheetJS",r)),xe(a,66,Fr(o?1200:1252)),o&&xe(a,353,Fr(0)),o&&xe(a,448),xe(a,317,Bg(e.SheetNames.length)),o&&e.vbaraw&&xe(a,211),o&&e.vbaraw){var c=i.CodeName||"ThisWorkbook";xe(a,442,gf(c,r))}xe(a,156,Fr(17)),xe(a,25,ur(!1)),xe(a,18,ur(!1)),xe(a,19,Fr(0)),o&&xe(a,431,ur(!1)),o&&xe(a,444,Fr(0)),xe(a,61,jm(r)),xe(a,64,ur(!1)),xe(a,141,Fr(0)),xe(a,34,ur(Hw(e)=="true")),xe(a,14,ur(!0)),o&&xe(a,439,ur(!1)),xe(a,218,Fr(0)),tE(a,e,r),rE(a,e.SSF,r),nE(a,r),o&&xe(a,352,ur(!1));var f=a.end(),d=mr();o&&xe(d,140,Dg()),o&&r.Strings&&K2(d,252,$m(r.Strings,r)),xe(d,10);var h=d.end(),p=mr(),m=0,u=0;for(u=0;u<e.SheetNames.length;++u)m+=(o?12:11)+(o?2:1)*e.SheetNames[u].length;var g=f.length+m+h.length;for(u=0;u<e.SheetNames.length;++u){var v=s[u]||{};xe(p,133,Pm({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[u]},r)),g+=t[u].length}var y=p.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var x=[];return f.length&&x.push(f),y.length&&x.push(y),h.length&&x.push(h),Xt(x)}function fE(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=_t(De)),e&&e.SSF&&(In(),bi(e.SSF),r.revssf=Si(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,wl(r),r.cellXfs=[],Aa(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=lE(n,r,e);return a.unshift(cE(e,a,r)),Xt(a)}function cu(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=gr(a["!ref"]);n.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return fE(e,t);case 4:case 3:case 2:return eE(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function l0(e,t){var r=t||{};At!=null&&r.dense==null&&(r.dense=At);var a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,o=s&&s.index||e.length,l=Yp(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<l.length;++i){var u=l[i].trim(),g=u.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var v=u.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var x=y,b=0;x.charAt(0)=="<"&&(b=x.indexOf(">"))>-1;)x=x.slice(b+1);for(var C=0;C<m.length;++C){var w=m[C];w.s.c==f&&w.s.r<c&&c<=w.e.r&&(f=w.e.c+1,C=-1)}var _=$e(y.slice(0,y.indexOf(">")));h=_.colspan?+_.colspan:1,((d=+_.rowspan)>1||h>1)&&m.push({s:{r:c,c:f},e:{r:c+(d||1)-1,c:f+h-1}});var k=_.t||_["data-t"]||"";if(!x.length){f+=h;continue}if(x=$0(x),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!x.length){f+=h;continue}var S={t:"s",v:x};r.raw||!x.trim().length||k=="s"||(x==="TRUE"?S={t:"b",v:!0}:x==="FALSE"?S={t:"b",v:!1}:isNaN(Vr(x))?isNaN(Cn(x).getDate())||(S={t:"d",v:yt(x)},r.cellDates||(S={t:"n",v:Vt(S.v)}),S.z=r.dateNF||De[14]):S={t:"n",v:Vr(x)}),r.dense?(a[c]||(a[c]=[]),a[c][f]=S):a[Le({r:c,c:f})]=S,f+=h}}}}return a["!ref"]=He(p),m.length&&(a["!merges"]=m),a}function uE(e,t,r,a){for(var n=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<n.length;++c)if(!(n[c].s.r>r||n[c].s.c>i)&&!(n[c].e.r<r||n[c].e.c<i)){if(n[c].s.r<r||n[c].s.c<i){o=-1;break}o=n[c].e.r-n[c].s.r+1,l=n[c].e.c-n[c].s.c+1;break}if(!(o<0)){var f=Le({r,c:i}),d=a.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||Go(d.w||(ca(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),a.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(a.id||"sjs")+"-"+f,s.push(ge("td",h,p))}}var m="<tr>";return m+s.join("")+"</tr>"}var dE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',pE="</body></html>";function hE(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ta(l0(r[0],t),t);var a=Sl();return r.forEach(function(n,s){Cl(a,l0(n,t),"Sheet"+(s+1))}),a}function mE(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function fu(e,t){var r=t||{},a=r.header!=null?r.header:dE,n=r.footer!=null?r.footer:pE,s=[a],i=gr(e["!ref"]);r.dense=Array.isArray(e),s.push(mE(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(uE(e,i,o,r));return s.push("</table>"+n),s.join("")}function uu(e,t,r){var a=r||{};At!=null&&(a.dense=At);var n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var i=typeof a.origin=="string"?St(a.origin):a.origin;n=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(a.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var f=gr(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),n==-1&&(c.e.r=n=f.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),m=0,u=0,g=0,v=0,y=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&u<l;++m){var b=o[m];if(c0(b)){if(a.display)continue;p[u]={hidden:!0}}var C=b.children;for(g=v=0;g<C.length;++g){var w=C[g];if(!(a.display&&c0(w))){var _=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):$0(w.innerHTML),k=w.getAttribute("data-z")||w.getAttribute("z");for(h=0;h<d.length;++h){var S=d[h];S.s.c==v+s&&S.s.r<u+n&&u+n<=S.e.r&&(v=S.e.c+1-s,h=-1)}x=+w.getAttribute("colspan")||1,((y=+w.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:u+n,c:v+s},e:{r:u+n+(y||1)-1,c:v+s+(x||1)-1}});var D={t:"s",v:_},R=w.getAttribute("data-t")||w.getAttribute("t")||"";_!=null&&(_.length==0?D.t=R||"z":a.raw||_.trim().length==0||R=="s"||(_==="TRUE"?D={t:"b",v:!0}:_==="FALSE"?D={t:"b",v:!1}:isNaN(Vr(_))?isNaN(Cn(_).getDate())||(D={t:"d",v:yt(_)},a.cellDates||(D={t:"n",v:Vt(D.v)}),D.z=a.dateNF||De[14]):D={t:"n",v:Vr(_)})),D.z===void 0&&k!=null&&(D.z=k);var T="",V=w.getElementsByTagName("A");if(V&&V.length)for(var G=0;G<V.length&&!(V[G].hasAttribute("href")&&(T=V[G].getAttribute("href"),T.charAt(0)!="#"));++G);T&&T.charAt(0)!="#"&&(D.l={Target:T}),a.dense?(e[u+n]||(e[u+n]=[]),e[u+n][v+s]=D):e[Le({c:v+s,r:u+n})]=D,c.e.c<v+s&&(c.e.c=v+s),v+=x}}++u}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,u-1+n),e["!ref"]=He(c),u>=l&&(e["!fullref"]=He((c.e.r=o.length-m+u-1+n,c))),e}function du(e,t){var r=t||{},a=r.dense?[]:{};return uu(a,e,t)}function gE(e,t){return Ta(du(e,t),t)}function c0(e){var t="",r=xE(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function xE(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function vE(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=qe(t.replace(/<[^>]*>/g,""));return[r]}var f0={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function pu(e,t){var r=t||{};At!=null&&r.dense==null&&(r.dense=At);var a=zo(e),n=[],s,i,o={name:""},l="",c=0,f,d,h={},p=[],m=r.dense?[]:{},u,g,v={value:""},y="",x=0,b,C=[],w=-1,_=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,D={},R=[],T={},V=0,G=0,W=[],j=1,se=1,q=[],K={Names:[]},Z={},X=["",""],F=[],U={},P="",B=0,Y=!1,Q=!1,J=0;for(hs.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");u=hs.exec(a);)switch(u[3]=u[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":u[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?m["!ref"]=He(k):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=He(k)),R.length&&(m["!merges"]=R),W.length&&(m["!rows"]=W),f.name=f.\u540D\u79F0||f.name,typeof JSON!="undefined"&&JSON.stringify(f),p.push(f.name),h[f.name]=m,Q=!1):u[0].charAt(u[0].length-2)!=="/"&&(f=$e(u[0],!1),w=_=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,m=r.dense?[]:{},R=[],W=[],Q=!0);break;case"table-row-group":u[1]==="/"?--S:++S;break;case"table-row":case"\u884C":if(u[1]==="/"){w+=j,j=1;break}if(d=$e(u[0],!1),d.\u884C\u53F7?w=d.\u884C\u53F7-1:w==-1&&(w=0),j=+d["number-rows-repeated"]||1,j<10)for(J=0;J<j;++J)S>0&&(W[w+J]={level:S});_=-1;break;case"covered-table-cell":u[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(m[w]||(m[w]=[]),m[w][_]={t:"z"}):m[Le({r:w,c:_})]={t:"z"}),y="",C=[];break;case"table-cell":case"\u6570\u636E":if(u[0].charAt(u[0].length-2)==="/")++_,v=$e(u[0],!1),se=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=s0(qe(v.formula))),(v.\u6570\u636E\u7C7B\u578B||v["value-type"])=="string"&&(g.t="s",g.v=qe(v["string-value"]||""),r.dense?(m[w]||(m[w]=[]),m[w][_]=g):m[Le({r:w,c:_})]=g),_+=se-1;else if(u[1]!=="/"){++_,y="",x=0,C=[],se=1;var oe=j?w+j-1:w;if(_>k.e.c&&(k.e.c=_),_<k.s.c&&(k.s.c=_),w<k.s.r&&(k.s.r=w),oe>k.e.r&&(k.e.r=oe),v=$e(u[0],!1),F=[],U={},g={t:v.\u6570\u636E\u7C7B\u578B||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=qe(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(V=parseInt(v["number-matrix-rows-spanned"],10)||0,G=parseInt(v["number-matrix-columns-spanned"],10)||0,T={s:{r:w,c:_},e:{r:w+V-1,c:_+G-1}},g.F=He(T),q.push([T,g.F])),v.formula)g.f=s0(v.formula);else for(J=0;J<q.length;++J)w>=q[J][0].s.r&&w<=q[J][0].e.r&&_>=q[J][0].s.c&&_<=q[J][0].e.c&&(g.F=q[J][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(V=parseInt(v["number-rows-spanned"],10)||0,G=parseInt(v["number-columns-spanned"],10)||0,T={s:{r:w,c:_},e:{r:w+V-1,c:_+G-1}},R.push(T)),v["number-columns-repeated"]&&(se=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=vt(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=yt(v["date-value"]),r.cellDates||(g.t="n",g.v=Vt(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=Gp(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Ci(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.\u6570\u636E\u6570\u503C);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(y=qe(v["string-value"]),C=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(Y=!1,g.t==="s"&&(g.v=y||"",C.length&&(g.R=C),Y=x==0),Z.Target&&(g.l=Z),F.length>0&&(g.c=F,F=[]),y&&r.cellText!==!1&&(g.w=y),Y&&(g.t="z",delete g.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var ae=0;ae<j;++ae){if(se=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[w+ae]||(m[w+ae]=[]),m[w+ae][_]=ae==0?g:_t(g);--se>0;)m[w+ae][_+se]=_t(g);else for(m[Le({r:w+ae,c:_})]=g;--se>0;)m[Le({r:w+ae,c:_+se})]=_t(g);k.e.c<=_&&(k.e.c=_)}se=parseInt(v["number-columns-repeated"]||"1",10),_+=se-1,se=0,g={},y="",C=[]}Z={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(u[1]==="/"){if((s=n.pop())[0]!==u[3])throw"Bad state: "+s}else u[0].charAt(u[0].length-2)!=="/"&&n.push([u[3],!0]);break;case"annotation":if(u[1]==="/"){if((s=n.pop())[0]!==u[3])throw"Bad state: "+s;U.t=y,C.length&&(U.R=C),U.a=P,F.push(U)}else u[0].charAt(u[0].length-2)!=="/"&&n.push([u[3],!1]);P="",B=0,y="",x=0,C=[];break;case"creator":u[1]==="/"?P=a.slice(B,u.index):B=u.index+u[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(u[1]==="/"){if((s=n.pop())[0]!==u[3])throw"Bad state: "+s}else u[0].charAt(u[0].length-2)!=="/"&&n.push([u[3],!1]);y="",x=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(u[1]==="/"){if(D[o.name]=l,(s=n.pop())[0]!==u[3])throw"Bad state: "+s}else u[0].charAt(u[0].length-2)!=="/"&&(l="",o=$e(u[0],!1),n.push([u[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=$e(u[0],!1),l+=f0[u[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=$e(u[0],!1),l+=f0[u[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(u[0].slice(-2)==="/>")break;if(u[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":l+=a.slice(c,u.index);break}else c=u.index+u[0].length;break;case"named-range":i=$e(u[0],!1),X=xo(i["cell-range-address"]);var be={Name:i.name,Ref:X[0]+"!"+X[1]};Q&&(be.Sheet=p.length),K.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(u[1]==="/"&&(!v||!v["string-value"])){var O=vE(a.slice(x,u.index),b);y=(y.length>0?y+`
`:"")+O[0]}else b=$e(u[0],!1),x=u.index+u[0].length;break;case"s":break;case"database-range":if(u[1]==="/")break;try{X=xo($e(u[0])["target-range-address"]),h[X[0]]["!autofilter"]={ref:X[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(u[1]!=="/"){if(Z=$e(u[0],!1),!Z.href)break;Z.Target=qe(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(X=xo(Z.Target.slice(1)),Z.Target="#"+X[0]+"!"+X[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(u[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(r.WTF)throw new Error(u)}}var Se={Sheets:h,SheetNames:p,Workbook:K};return r.bookSheets&&delete Se.Sheets,Se}function u0(e,t){t=t||{},Ir(e,"META-INF/manifest.xml")&&Gh(Mt(e,"META-INF/manifest.xml"),t);var r=Er(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=pu(ut(r),t);return Ir(e,"meta.xml")&&(a.Props=rf(Mt(e,"meta.xml"))),a}function d0(e,t){return pu(e,t)}var yE=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ps({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Nt+t}})(),p0=(function(){var e=function(s){return ct(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,i,o){var l=[];l.push('      <table:table table:name="'+ct(i.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,d=gr(s["!ref"]||"A1"),h=s["!merges"]||[],p=0,m=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var u="",g=s["!rows"]||[];for(c=0;c<d.s.r;++c)u=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+u+`></table:table-row>
`);for(;c<=d.e.r;++c){for(u=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+u+`>
`),f=0;f<d.s.c;++f)l.push(t);for(;f<=d.e.c;++f){var v=!1,y={},x="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>f)&&!(h[p].s.r>c)&&!(h[p].e.c<f)&&!(h[p].e.r<c)){(h[p].s.c!=f||h[p].s.r!=c)&&(v=!0),y["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,y["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(v){l.push(r);continue}var b=Le({r:c,c:f}),C=m?(s[c]||[])[f]:s[b];if(C&&C.f&&(y["table:formula"]=ct(By(C.f)),C.F&&C.F.slice(0,b.length)==b)){var w=gr(C.F);y["table:number-matrix-columns-spanned"]=w.e.c-w.s.c+1,y["table:number-matrix-rows-spanned"]=w.e.r-w.s.r+1}if(!C){l.push(t);continue}switch(C.t){case"b":x=C.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=C.v?"true":"false";break;case"n":x=C.w||String(C.v||0),y["office:value-type"]="float",y["office:value"]=C.v||0;break;case"s":case"str":x=C.v==null?"":C.v,y["office:value-type"]="string";break;case"d":x=C.w||yt(C.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=yt(C.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var _=e(x);if(C.l&&C.l.Target){var k=C.l.Target;k=k.charAt(0)=="#"?"#"+Uy(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),_=ge("text:a",_,{"xlink:href":k.replace(/&/g,"&amp;")})}l.push("          "+ge("table:table-cell",ge("text:p",_,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},n=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var d=c["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;ba(d),d.ods=o;var h=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var d=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var l=[Nt],c=ps({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=ps({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(tf().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),n(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)l.push(a(i.Sheets[i.SheetNames[d]],i,d,o));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function hu(e,t){if(t.bookType=="fods")return p0(e,t);var r=Vo(),a="",n=[],s=[];return a="mimetype",We(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",We(r,a,p0(e,t)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",We(r,a,yE(e,t)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",We(r,a,Nt+tf()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",We(r,a,Yh(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",We(r,a,zh(n)),r}function Ya(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Oo(e){return typeof TextDecoder!="undefined"?new TextDecoder().decode(e):ut(Ca(e))}function _E(e){return typeof TextEncoder!="undefined"?new TextEncoder().encode(e):wr(Zr(e))}function wE(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Sa(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function h0(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function EE(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function bE(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=n&255;e[t+15]|=r>=0?0:128}function ws(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function ot(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Tt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function rt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=ws(e,r),s=n&7;n=Math.floor(n/8);var i=0,o;if(n==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=ws(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var c={data:o,type:s};t[n]==null?t[n]=[c]:t[n].push(c)}return t}function Kt(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(ot(a*8+n.type)),n.type==2&&t.push(ot(n.data.length)),t.push(n.data))})}),Sa(t)}function yl(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ar(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=ws(e,a),s=rt(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:Tt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=rt(o.data),c=Tt(l[3][0].data);i.messages.push({meta:l,data:e.slice(a[0],a[0]+c)}),a[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=Tt(s[3][0].data)>>>0>0),r.push(i)}return r}function gn(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:ot(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:ot(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(i){n.push(i.data),i.meta[3]=[{type:0,data:ot(i.data.length)}],a[2].push({data:Kt(i.meta),type:2})});var s=Kt(a);t.push(ot(s.length)),t.push(s),n.forEach(function(i){return t.push(i)})}),Sa(t)}function kE(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=ws(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Sa(n)],l==0)throw new Error("Invalid offset 0");if(l>n[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(n.push(n[0].slice(-l)),c-=l;c>=n[n.length-1].length;)n.push(n[n.length-1]),c-=n[n.length-1].length;n.push(n[0].slice(-l,-l+c))}}var f=Sa(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function Rr(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(kE(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Sa(t)}function xn(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var s=ot(a),i=s.length;t.push(s),a<=60?(i++,t.push(new Uint8Array([a-1<<2]))):a<=256?(i+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(i+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(i+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(i+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),i+=a,n[0]=0,n[1]=i&255,n[2]=i>>8&255,n[3]=i>>16&255,r+=a}return Sa(t)}function SE(e,t,r,a){var n=Ya(e),s=n.getUint32(4,!0),i=(a>1?12:8)+h0(s&(a>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=n.getUint32(i,!0),i+=4),i+=h0(s&(a>1?12288:4096))*4,s&16&&(l=n.getUint32(i,!0),i+=4),s&32&&(c=n.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function CE(e,t,r){var a=Ya(e),n=a.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);n&1&&(l=EE(e,s),s+=16),n&2&&(c=a.getFloat64(s,!0),s+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(o=a.getUint32(s,!0),s+=4),n&16&&(i=a.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return d}function yo(e,t){var r=new Uint8Array(32),a=Ya(r),n=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,bE(r,n,e.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,s,!0),r.slice(0,n)}function _o(e,t){var r=new Uint8Array(32),a=Ya(r),n=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,s,!0),r.slice(0,n)}function TE(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return SE(e,t,r,e[0]);case 5:return CE(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function er(e){var t=rt(e);return ws(t[1][0].data)}function m0(e,t){var r=rt(t.data),a=Tt(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(i){var o=rt(i.data),l=Tt(o[1][0].data)>>>0;switch(a){case 1:s[l]=Oo(o[3][0].data);break;case 8:{var c=e[er(o[9][0].data)][0],f=rt(c.data),d=e[er(f[1][0].data)][0],h=Tt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=rt(d.data);s[l]=p[3].map(function(m){return Oo(m.data)}).join("")}break}}),s}function AE(e,t){var r,a,n,s,i,o,l,c,f,d,h,p,m,u,g=rt(e),v=Tt(g[1][0].data)>>>0,y=Tt(g[2][0].data)>>>0,x=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&Tt(g[8][0].data)>0||!1,b,C;if((s=(n=g[7])==null?void 0:n[0])!=null&&s.data&&t!=0)b=(o=(i=g[7])==null?void 0:i[0])==null?void 0:o.data,C=(c=(l=g[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(f=g[4])==null?void 0:f[0])!=null&&d.data&&t!=1)b=(p=(h=g[4])==null?void 0:h[0])==null?void 0:p.data,C=(u=(m=g[3])==null?void 0:m[0])==null?void 0:u.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var w=x?4:1,_=Ya(b),k=[],S=0;S<b.length/2;++S){var D=_.getUint16(S*2,!0);D<65535&&k.push([S,D])}if(k.length!=y)throw"Expected ".concat(y," cells, found ").concat(k.length);var R=[];for(S=0;S<k.length-1;++S)R[k[S][0]]=C.subarray(k[S][1]*w,k[S+1][1]*w);return k.length>=1&&(R[k[k.length-1][0]]=C.subarray(k[k.length-1][1]*w)),{R:v,cells:R}}function RE(e,t){var r,a=rt(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?Tt(a[7][0].data)>>>0>0?1:0:-1,s=yl(a[5],function(i){return AE(i,n)});return{nrows:Tt(a[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function IE(e,t,r){var a,n=rt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Tt(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Tt(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=He(s);var i=rt(n[4][0].data),o=m0(e,e[er(i[4][0].data)][0]),l=(a=i[17])!=null&&a[0]?m0(e,e[er(i[17][0].data)][0]):[],c=rt(i[3][0].data),f=0;c[1].forEach(function(d){var h=rt(d.data),p=e[er(h[2][0].data)][0],m=Tt(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var u=RE(e,p);u.data.forEach(function(g,v){g.forEach(function(y,x){var b=Le({r:f+v,c:x}),C=TE(y,o,l);C&&(r[b]=C)})}),f+=u.nrows})}function FE(e,t){var r=rt(t.data),a={"!ref":"A1"},n=e[er(r[2][0].data)],s=Tt(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return IE(e,n[0],a),a}function DE(e,t){var r,a=rt(t.data),n={name:(r=a[1])!=null&&r[0]?Oo(a[1][0].data):"",sheets:[]},s=yl(a[2],er);return s.forEach(function(i){e[i].forEach(function(o){var l=Tt(o.meta[1][0].data);l==6e3&&n.sheets.push(FE(e,o))})}),n}function NE(e,t){var r=Sl(),a=rt(t.data),n=yl(a[1],er);if(n.forEach(function(s){e[s].forEach(function(i){var o=Tt(i.meta[1][0].data);if(o==2){var l=DE(e,i);l.sheets.forEach(function(c,f){Cl(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function wo(e){var t,r,a,n,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Rr(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=Ar(c)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((n=(a=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Tt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var f=Tt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return NE(s,o)}function OE(e,t,r){var a,n,s,i;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Tt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Ya(e[7][0].data),f=0,d=[],h=Ya(e[4][0].data),p=0,m=[],u=0;u<t.length;++u){if(t[u]==null){c.setUint16(u*2,65535,!0),h.setUint16(u*2,65535);continue}c.setUint16(u*2,f,!0),h.setUint16(u*2,p,!0);var g,v;switch(typeof t[u]){case"string":g=yo({t:"s",v:t[u]},r),v=_o({t:"s",v:t[u]},r);break;case"number":g=yo({t:"n",v:t[u]},r),v=_o({t:"n",v:t[u]},r);break;case"boolean":g=yo({t:"b",v:t[u]},r),v=_o({t:"b",v:t[u]},r);break;default:throw new Error("Unsupported value "+t[u])}d.push(g),f+=g.length,m.push(v),p+=v.length,++l}for(e[2][0].data=ot(l);u<e[7][0].data.length/2;++u)c.setUint16(u*2,65535,!0),h.setUint16(u*2,65535,!0);return e[6][0].data=Sa(d),e[3][0].data=Sa(m),l}function PE(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=gr(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(He(a)));var s=wi(r,{range:a,header:1}),i=["~Sh33tJ5~"];s.forEach(function(P){return P.forEach(function(B){typeof B=="string"&&i.push(B)})});var o={},l=[],c=Re.read(t.numbers,{type:"base64"});c.FileIndex.map(function(P,B){return[P,c.FullPaths[B]]}).forEach(function(P){var B=P[0],Y=P[1];if(B.type==2&&B.name.match(/\.iwa/)){var Q=B.content,J=Rr(Q),oe=Ar(J);oe.forEach(function(ae){l.push(ae.id),o[ae.id]={deps:[],location:Y,type:Tt(ae.messages[0].meta[1][0].data)}})}}),l.sort(function(P,B){return P-B});var f=l.filter(function(P){return P>1}).map(function(P){return[P,ot(P)]});c.FileIndex.map(function(P,B){return[P,c.FullPaths[B]]}).forEach(function(P){var B=P[0],Y=P[1];if(B.name.match(/\.iwa/)){var Q=Ar(Rr(B.content));Q.forEach(function(J){J.messages.forEach(function(oe){f.forEach(function(ae){J.messages.some(function(be){return Tt(be.meta[1][0].data)!=11006&&wE(be.data,ae[1])})&&o[ae[0]].deps.push(J.id)})})})}});function d(){for(var P=927262;P<2e6;++P)if(!o[P])return P;throw new Error("Too many messages")}for(var h=Re.find(c,o[1].location),p=Ar(Rr(h.content)),m,u=0;u<p.length;++u){var g=p[u];g.id==1&&(m=g)}var v=er(rt(m.messages[0].data)[1][0].data);for(h=Re.find(c,o[v].location),p=Ar(Rr(h.content)),u=0;u<p.length;++u)g=p[u],g.id==v&&(m=g);for(v=er(rt(m.messages[0].data)[2][0].data),h=Re.find(c,o[v].location),p=Ar(Rr(h.content)),u=0;u<p.length;++u)g=p[u],g.id==v&&(m=g);for(v=er(rt(m.messages[0].data)[2][0].data),h=Re.find(c,o[v].location),p=Ar(Rr(h.content)),u=0;u<p.length;++u)g=p[u],g.id==v&&(m=g);var y=rt(m.messages[0].data);{y[6][0].data=ot(a.e.r+1),y[7][0].data=ot(a.e.c+1);var x=er(y[46][0].data),b=Re.find(c,o[x].location),C=Ar(Rr(b.content));{for(var w=0;w<C.length&&C[w].id!=x;++w);if(C[w].id!=x)throw"Bad ColumnRowUIDMapArchive";var _=rt(C[w].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var k=0;k<=a.e.c;++k){var S=[];S[1]=S[2]=[{type:0,data:ot(k+420690)}],_[1].push({type:2,data:Kt(S)}),_[2].push({type:0,data:ot(k)}),_[3].push({type:0,data:ot(k)})}_[4]=[],_[5]=[],_[6]=[];for(var D=0;D<=a.e.r;++D)S=[],S[1]=S[2]=[{type:0,data:ot(D+726270)}],_[4].push({type:2,data:Kt(S)}),_[5].push({type:0,data:ot(D)}),_[6].push({type:0,data:ot(D)});C[w].messages[0].data=Kt(_)}b.content=xn(gn(C)),b.size=b.content.length,delete y[46];var R=rt(y[4][0].data);{R[7][0].data=ot(a.e.r+1);var T=rt(R[1][0].data),V=er(T[2][0].data);b=Re.find(c,o[V].location),C=Ar(Rr(b.content));{if(C[0].id!=V)throw"Bad HeaderStorageBucket";var G=rt(C[0].messages[0].data);for(D=0;D<s.length;++D){var W=rt(G[2][0].data);W[1][0].data=ot(D),W[4][0].data=ot(s[D].length),G[2][D]={type:G[2][0].type,data:Kt(W)}}C[0].messages[0].data=Kt(G)}b.content=xn(gn(C)),b.size=b.content.length;var j=er(R[2][0].data);b=Re.find(c,o[j].location),C=Ar(Rr(b.content));{if(C[0].id!=j)throw"Bad HeaderStorageBucket";for(G=rt(C[0].messages[0].data),k=0;k<=a.e.c;++k)W=rt(G[2][0].data),W[1][0].data=ot(k),W[4][0].data=ot(a.e.r+1),G[2][k]={type:G[2][0].type,data:Kt(W)};C[0].messages[0].data=Kt(G)}b.content=xn(gn(C)),b.size=b.content.length;var se=er(R[4][0].data);(function(){for(var P=Re.find(c,o[se].location),B=Ar(Rr(P.content)),Y,Q=0;Q<B.length;++Q){var J=B[Q];J.id==se&&(Y=J)}var oe=rt(Y.messages[0].data);{oe[3]=[];var ae=[];i.forEach(function(Se,ke){ae[1]=[{type:0,data:ot(ke)}],ae[2]=[{type:0,data:ot(1)}],ae[3]=[{type:2,data:_E(Se)}],oe[3].push({type:2,data:Kt(ae)})})}Y.messages[0].data=Kt(oe);var be=gn(B),O=xn(be);P.content=O,P.size=P.content.length})();var q=rt(R[3][0].data);{var K=q[1][0];delete q[2];var Z=rt(K.data);{var X=er(Z[2][0].data);(function(){for(var P=Re.find(c,o[X].location),B=Ar(Rr(P.content)),Y,Q=0;Q<B.length;++Q){var J=B[Q];J.id==X&&(Y=J)}var oe=rt(Y.messages[0].data);{delete oe[6],delete q[7];var ae=new Uint8Array(oe[5][0].data);oe[5]=[];for(var be=0,O=0;O<=a.e.r;++O){var Se=rt(ae);be+=OE(Se,s[O],i),Se[1][0].data=ot(O),oe[5].push({data:Kt(Se),type:2})}oe[1]=[{type:0,data:ot(a.e.c+1)}],oe[2]=[{type:0,data:ot(a.e.r+1)}],oe[3]=[{type:0,data:ot(be)}],oe[4]=[{type:0,data:ot(a.e.r+1)}]}Y.messages[0].data=Kt(oe);var ke=gn(B),Ne=xn(ke);P.content=Ne,P.size=P.content.length})()}K.data=Kt(Z)}R[3][0].data=Kt(q)}y[4][0].data=Kt(R)}m.messages[0].data=Kt(y);var F=gn(p),U=xn(F);return h.content=U,h.size=h.content.length,c}function mu(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function _l(e){mu([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function wl(e){mu([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function LE(e){return Ge.WS.indexOf(e)>-1?"sheet":Ge.CS&&e==Ge.CS?"chart":Ge.DS&&e==Ge.DS?"dialog":Ge.MS&&e==Ge.MS?"macro":e&&e.length?e:"sheet"}function $E(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,LE(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function ME(e,t,r,a,n,s,i,o,l,c,f,d){try{s[a]=ns(Er(e,r,!0),t);var h=Mt(e,t),p;switch(o){case"sheet":p=i2(h,t,n,l,s[a],c,f,d);break;case"chart":if(p=o2(h,t,n,l,s[a],c,f,d),!p||!p["!drawel"])break;var m=es(p["!drawel"].Target,t),u=ms(m),g=Xx(Er(e,m,!0),ns(Er(e,u,!0),m)),v=es(g,m),y=ms(v);p=Ow(Er(e,v,!0),v,l,ns(Er(e,y,!0),v),c,p);break;case"macro":p=l2(h,t,n,l,s[a],c,f,d);break;case"dialog":p=c2(h,t,n,l,s[a],c,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[a]=p;var x=[];s&&s[a]&&Rt(s[a]).forEach(function(b){var C="";if(s[a][b].Type==Ge.CMNT){C=es(s[a][b].Target,t);var w=p2(Mt(e,C,!0),C,l);if(!w||!w.length)return;e0(p,w,!1)}s[a][b].Type==Ge.TCMNT&&(C=es(s[a][b].Target,t),x=x.concat(Kx(Mt(e,C,!0),l)))}),x&&x.length&&e0(p,x,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function Cr(e){return e.charAt(0)=="/"?e.slice(1):e}function BE(e,t){if(In(),t=t||{},_l(t),Ir(e,"META-INF/manifest.xml")||Ir(e,"objectdata.xml"))return u0(e,t);if(Ir(e,"Index/Document.iwa")){if(typeof Uint8Array=="undefined")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof wo!="undefined"){if(e.FileIndex)return wo(e);var r=Re.utils.cfb_new();return wc(e).forEach(function(G){We(r,G,N0(e,G))}),wo(r)}throw new Error("Unsupported NUMBERS file")}if(!Ir(e,"[Content_Types].xml"))throw Ir(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ir(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=wc(e),n=jh(Er(e,"[Content_Types].xml")),s=!1,i,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",Mt(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!Mt(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(ss=[],n.sst)try{ss=d2(Mt(e,Cr(n.sst)),n.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&n.themes.length&&(l=u2(Er(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(c=f2(Mt(e,Cr(n.style)),n.style,l,t))}n.links.map(function(G){try{var W=ns(Er(e,ms(Cr(G))),G);return m2(Mt(e,Cr(G)),W,G,t)}catch{}});var f=s2(Mt(e,Cr(n.workbooks[0])),n.workbooks[0],t),d={},h="";n.coreprops.length&&(h=Mt(e,Cr(n.coreprops[0]),!0),h&&(d=rf(h)),n.extprops.length!==0&&(h=Mt(e,Cr(n.extprops[0]),!0),h&&Jh(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=Er(e,Cr(n.custprops[0]),!0),h&&(p=Zh(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(W){return W.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(m.Props=d,m.Custprops=p),t.bookSheets&&typeof i!="undefined"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var u={};t.bookDeps&&n.calcchain&&(u=h2(Mt(e,Cr(n.calcchain)),n.calcchain,t));var g=0,v={},y,x;{var b=f.Sheets;d.Worksheets=b.length,d.SheetNames=[];for(var C=0;C!=b.length;++C)d.SheetNames[C]=b[C].name}var w=s?"bin":"xml",_=n.workbooks[0].lastIndexOf("/"),k=(n.workbooks[0].slice(0,_+1)+"_rels/"+n.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Ir(e,k)||(k="xl/_rels/workbook."+w+".rels");var S=ns(Er(e,k,!0),k.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=g2(Mt(e,Cr(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=qx(Mt(e,Cr(n.people[0])),t)),S&&(S=$E(S,f.Sheets));var D=Mt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=d.Worksheets;++g){var R="sheet";if(S&&S[g]?(y="xl/"+S[g][1].replace(/[\/]?xl\//,""),Ir(e,y)||(y=S[g][1]),Ir(e,y)||(y=k.replace(/_rels\/.*$/,"")+S[g][1]),R=S[g][2]):(y="xl/worksheets/sheet"+(g+1-D)+"."+w,y=y.replace(/sheet0\./,"sheet.")),x=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(d.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==g&&(T=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==d.SheetNames[g].toLowerCase()&&(T=1);if(!T)continue e}}ME(e,y,x,d.SheetNames[g],g,v,i,R,t,f,l,c)}return m={Directory:n,Workbook:f,Props:d,Custprops:p,Deps:u,Sheets:i,SheetNames:d.SheetNames,Strings:ss,Styles:c,Themes:l,SSF:_t(De)},t&&t.bookFiles&&(e.files?(m.keys=a,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(G,W){G=G.replace(/^Root Entry[\/]/,""),m.keys.push(G),m.files[G]=e.FileIndex[W]}))),t&&t.bookVBA&&(n.vba.length>0?m.vbaraw=Mt(e,Cr(n.vba[0]),!0):n.defaults&&n.defaults.bin===sv&&(m.vbaraw=Mt(e,"xl/vbaProject.bin",!0))),m}function UE(e,t){var r=t||{},a="Workbook",n=Re.find(e,a);try{if(a="/!DataSpaces/Version",n=Re.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(g1(n.content),a="/!DataSpaces/DataSpaceMap",n=Re.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=v1(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Re.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=y1(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Re.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);w1(n.content)}catch{}if(a="/EncryptionInfo",n=Re.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=E1(n.content);if(a="/EncryptedPackage",n=Re.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile!="undefined")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76!="undefined")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function HE(e,t){return t.bookType=="ods"?hu(e,t):t.bookType=="numbers"?PE(e,t):t.bookType=="xlsb"?VE(e,t):jE(e,t)}function VE(e,t){_n=1024,e&&!e.SSF&&(e.SSF=_t(De)),e&&e.SSF&&(In(),bi(e.SSF),t.revssf=Si(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,is?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=Vf.indexOf(t.bookType)>-1,n=il();wl(t=t||{});var s=Vo(),i="",o=0;if(t.cellXfs=[],Aa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",We(s,i,af(e.Props,t)),n.coreprops.push(i),lt(t.rels,2,i,Ge.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,We(s,i,of(e.Props,t)),n.extprops.push(i),lt(t.rels,3,i,Ge.EXT_PROPS),e.Custprops!==e.Props&&Rt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",We(s,i,lf(e.Custprops,t)),n.custprops.push(i),lt(t.rels,4,i,Ge.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,We(s,i,v2(o-1,i,t,e,f)),n.sheets.push(i),lt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(d){var p=d["!comments"],m=!1,u="";p&&p.length>0&&(u="xl/comments"+o+"."+r,We(s,u,w2(p,u,t)),n.comments.push(u),lt(f,-1,"../comments"+o+"."+r,Ge.CMNT),m=!0),d["!legacy"]&&m&&We(s,"xl/drawings/vmlDrawing"+o+".vml",Uf(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&We(s,ms(i),En(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,We(s,i,_2(t.Strings,i,t)),n.strs.push(i),lt(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),i="xl/workbook."+r,We(s,i,x2(e,i,t)),n.workbooks.push(i),lt(t.rels,1,i,Ge.WB),i="xl/theme/theme1.xml",We(s,i,dl(e.Themes,t)),n.themes.push(i),lt(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),i="xl/styles."+r,We(s,i,y2(e,i,t)),n.styles.push(i),lt(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&a&&(i="xl/vbaProject.bin",We(s,i,e.vbaraw),n.vba.push(i),lt(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),i="xl/metadata."+r,We(s,i,E2(i)),n.metadata.push(i),lt(t.wbrels,-1,"metadata."+r,Ge.XLMETA),We(s,"[Content_Types].xml",ef(n,t)),We(s,"_rels/.rels",En(t.rels)),We(s,"xl/_rels/workbook."+r+".rels",En(t.wbrels)),delete t.revssf,delete t.ssf,s}function jE(e,t){_n=1024,e&&!e.SSF&&(e.SSF=_t(De)),e&&e.SSF&&(In(),bi(e.SSF),t.revssf=Si(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,is?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=Vf.indexOf(t.bookType)>-1,n=il();wl(t=t||{});var s=Vo(),i="",o=0;if(t.cellXfs=[],Aa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",We(s,i,af(e.Props,t)),n.coreprops.push(i),lt(t.rels,2,i,Ge.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,We(s,i,of(e.Props,t)),n.extprops.push(i),lt(t.rels,3,i,Ge.EXT_PROPS),e.Custprops!==e.Props&&Rt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",We(s,i,lf(e.Custprops,t)),n.custprops.push(i),lt(t.rels,4,i,Ge.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,We(s,i,Qf(o-1,t,e,d)),n.sheets.push(i),lt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(h){var m=h["!comments"],u=!1,g="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+o+"."+r,We(s,g,Jx(m,f,t)),n.threadedcomments.push(g),lt(d,-1,"../threadedComments/threadedComment"+o+"."+r,Ge.TCMNT)),g="xl/comments"+o+"."+r,We(s,g,Hf(m,t)),n.comments.push(g),lt(d,-1,"../comments"+o+"."+r,Ge.CMNT),u=!0}h["!legacy"]&&u&&We(s,"xl/drawings/vmlDrawing"+o+".vml",Uf(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&We(s,ms(i),En(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,We(s,i,Af(t.Strings,t)),n.strs.push(i),lt(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),i="xl/workbook."+r,We(s,i,nu(e,t)),n.workbooks.push(i),lt(t.rels,1,i,Ge.WB),i="xl/theme/theme1.xml",We(s,i,dl(e.Themes,t)),n.themes.push(i),lt(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),i="xl/styles."+r,We(s,i,Lf(e,t)),n.styles.push(i),lt(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&a&&(i="xl/vbaProject.bin",We(s,i,e.vbaraw),n.vba.push(i),lt(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),i="xl/metadata."+r,We(s,i,Bf()),n.metadata.push(i),lt(t.wbrels,-1,"metadata."+r,Ge.XLMETA),f.length>1&&(i="xl/persons/person.xml",We(s,i,Zx(f,t)),n.people.push(i),lt(t.wbrels,-1,"persons/person.xml",Ge.PEOPLE)),We(s,"[Content_Types].xml",ef(n,t)),We(s,"_rels/.rels",En(t.rels)),We(s,"xl/_rels/workbook."+r+".rels",En(t.wbrels)),delete t.revssf,delete t.ssf,s}function El(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=br(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function WE(e,t){return Re.find(e,"EncryptedPackage")?UE(e,t):lu(e,t)}function GE(e,t){var r,a=e,n=t||{};return n.type||(n.type=Xe&&Buffer.isBuffer(e)?"buffer":"base64"),r=O0(a,n),BE(r,n)}function gu(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Do(e.slice(r),t);default:break e}return Tn.to_workbook(e,t)}function zE(e,t){var r="",a=El(e,t);switch(t.type){case"base64":r=br(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Wa(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=ut(r)),t.type="binary",gu(r,t)}function XE(e,t){var r=e;return t.type=="base64"&&(r=br(r)),r=st.utils.decode(1200,r.slice(2),"str"),t.type="binary",gu(r,t)}function YE(e){return e.match(/[^\x00-\x7F]/)?Zr(e):e}function Eo(e,t,r,a){return a?(r.type="string",Tn.to_workbook(e,r)):Tn.to_workbook(t,r)}function _i(e,t){$o();var r=t||{};if(typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer)return _i(new Uint8Array(e),(r=_t(r),r.type="array",r));typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno!="undefined"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),kn={},r.dateNF&&(kn.dateNF=r.dateNF),r.type||(r.type=Xe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Xe?"buffer":"binary",a=Vp(e),typeof Uint8Array!="undefined"&&!Xe&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=YE(e)),r.type=="array"&&typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!="undefined"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=_t(r),r.type="array",_i(Mo(a),r)}switch((n=El(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return WE(Re.read(a,r),r);break;case 9:if(n[1]<=8)return lu(a,r);break;case 60:return Do(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return Qg(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return Cf.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?GE(a,r):Eo(e,a,r,s);case 239:return n[3]===60?Do(a,r):Eo(e,a,r,s);case 255:if(n[1]===254)return XE(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Ha.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Ha.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Fo.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return Nf.to_workbook(a,r);break;case 10:case 13:case 32:return zE(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Zg.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Fo.to_workbook(a,r):Eo(e,a,r,s)}function xu(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return bs(t.file,Re.write(e,{type:Xe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Re.write(e,t)}function KE(e,t){var r=_t(t||{}),a=HE(e,r);return JE(a,r)}function JE(e,t){var r={},a=Xe?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Re.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno!="undefined"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Ei(n))}return t.password&&typeof encrypt_agile!="undefined"?xu(encrypt_agile(n,t.password),t):t.type==="file"?bs(t.file,n):t.type=="string"?ut(n):n}function qE(e,t){var r=t||{},a=Y2(e,r);return xu(a,r)}function qr(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return fs(Zr(a));case"binary":return Zr(a);case"string":return e;case"file":return bs(t.file,a,"utf8");case"buffer":return Xe?fa(a,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(a):qr(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ZE(e,t){switch(t.type){case"base64":return fs(e);case"binary":return e;case"string":return e;case"file":return bs(t.file,e,"binary");case"buffer":return Xe?fa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function li(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?fs(r):t.type=="string"?ut(r):r;case"file":return bs(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function bl(e,t){$o(),Ww(e);var r=_t(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=bl(e,r);return r.type="array",Ei(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return qr(H2(e,r),r);case"slk":case"sylk":return qr(Sf.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return qr(fu(e.Sheets[e.SheetNames[n]],r),r);case"txt":return ZE(vu(e.Sheets[e.SheetNames[n]],r),r);case"csv":return qr(kl(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return qr(Cf.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return li(Fo.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return qr(Tn.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return qr(Nf.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return qr(Tf.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return qr(hu(e,r),r);case"wk1":return li(Ha.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return li(Ha.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),li(cu(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),qE(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return KE(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function QE(e,t,r,a,n,s,i,o){var l=Dt(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=i?e[r][p]:e[a[p]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[p]!=null&&(h[s[p]]=c);continue}var u=m.v;switch(m.t){case"z":if(u==null)break;continue;case"e":u=u==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[p]!=null){if(u==null)if(m.t=="e"&&u===null)h[s[p]]=null;else if(c!==void 0)h[s[p]]=c;else if(f&&u===null)h[s[p]]=null;else continue;else h[s[p]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?u:ca(m,u,o);u!=null&&(d=!1)}}return{row:h,isempty:d}}function wi(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?a=1:c.header==="A"?a=2:Array.isArray(c.header)?a=3:c.header==null&&(a=0),typeof f){case"string":l=Ze(f);break;case"number":l=Ze(e["!ref"]),l.s.r=f;break;default:l=f}a>0&&(n=0);var d=Dt(l.s.r),h=[],p=[],m=0,u=0,g=Array.isArray(e),v=l.s.r,y=0,x={};g&&!e[v]&&(e[v]=[]);var b=c.skipHidden&&e["!cols"]||[],C=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(b[y]||{}).hidden)switch(h[y]=kt(y),r=g?e[v][y]:e[h[y]+d],a){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ca(r,null,c),u=x[i]||0,!u)x[i]=1;else{do o=i+"_"+u++;while(x[o]);x[i]=u,x[o]=1}s[y]=o}for(v=l.s.r+n;v<=l.e.r;++v)if(!(C[v]||{}).hidden){var w=QE(e,l,v,h,a,s,g,c);(w.isempty===!1||(a===1?c.blankrows!==!1:c.blankrows))&&(p[m++]=w.row)}return p.length=m,p}var g0=/"/g;function eb(e,t,r,a,n,s,i,o){for(var l=!0,c=[],f="",d=Dt(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var p=o.dense?(e[r]||[])[h]:e[a[h]+d];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:ca(p,null,o));for(var m=0,u=0;m!==f.length;++m)if((u=f.charCodeAt(m))===n||u===s||u===34||o.forceQuotes){f='"'+f.replace(g0,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(g0,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function kl(e,t){var r=[],a=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var n=Ze(e["!ref"]),s=a.FS!==void 0?a.FS:",",i=s.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(h[m]||{}).hidden||(d[m]=kt(m));for(var u=0,g=n.s.r;g<=n.e.r;++g)(p[g]||{}).hidden||(f=eb(e,n,g,d,i,l,s,a),f!=null&&(a.strip&&(f=f.replace(c,"")),(f||a.blankrows!==!1)&&r.push((u++?o:"")+f)));return delete a.dense,r.join("")}function vu(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=kl(e,t);if(typeof st=="undefined"||t.type=="string")return r;var a=st.utils.encode(1200,r,"str");return"\xFF\xFE"+a}function tb(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Ze(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)i[o]=kt(o);for(var f=n.s.r;f<=n.e.r;++f)for(s=Dt(f),o=n.s.c;o<=n.e.c;++o)if(t=i[o]+s,r=c?(e[f]||[])[o]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}l[l.length]=t+"="+a}return l}function yu(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},i=0,o=0;if(s&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var l=typeof a.origin=="string"?St(a.origin):a.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+n}};if(s["!ref"]){var d=Ze(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+n)}else i==-1&&(i=0,f.e.r=t.length-1+n);var h=a.header||[],p=0;t.forEach(function(u,g){Rt(u).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var y=u[v],x="z",b="",C=Le({c:o+p,r:i+g+n});c=Es(s,C),y&&typeof y=="object"&&!(y instanceof Date)?s[C]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",a.cellDates||(x="n",y=Vt(y)),b=a.dateNF||De[14]):y===null&&a.nullError&&(x="e",y=0),c?(c.t=x,c.v=y,delete c.w,delete c.R,b&&(c.z=b)):s[C]=c={t:x,v:y},b&&(c.z=b))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var m=Dt(i);if(n)for(p=0;p<h.length;++p)s[kt(p+o)+m]={t:"s",v:h[p]};return s["!ref"]=He(f),s}function rb(e,t){return yu(null,e,t)}function Es(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=St(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Es(e,Le(t)):Es(e,Le({r:t,c:r||0}))}function ab(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Sl(){return{SheetNames:[],Sheets:{}}}function Cl(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=i+n)!=-1;++n);}if(au(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function nb(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=ab(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function sb(e,t){return e.z=t,e}function _u(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ib(e,t,r){return _u(e,"#"+t,r)}function ob(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function lb(e,t,r,a){for(var n=typeof t!="string"?t:Ze(t),s=typeof t=="string"?t:He(t),i=n.s.r;i<=n.e.r;++i)for(var o=n.s.c;o<=n.e.c;++o){var l=Es(e,i,o);l.t="n",l.F=s,delete l.v,i==n.s.r&&o==n.s.c&&(l.f=r,a&&(l.D=!0))}return e}var Wr={encode_col:kt,encode_row:Dt,encode_cell:Le,encode_range:He,decode_col:el,decode_row:Qo,split_cell:_h,decode_cell:St,decode_range:gr,format_cell:ca,sheet_add_aoa:X0,sheet_add_json:yu,sheet_add_dom:uu,aoa_to_sheet:Dn,json_to_sheet:rb,table_to_sheet:du,table_to_book:gE,sheet_to_csv:kl,sheet_to_txt:vu,sheet_to_json:wi,sheet_to_html:fu,sheet_to_formulae:tb,sheet_to_row_object_array:wi,sheet_get_cell:Es,book_new:Sl,book_append_sheet:Cl,book_set_sheet_visibility:nb,cell_set_number_format:sb,cell_set_hyperlink:_u,cell_set_internal_link:ib,cell_add_comment:ob,sheet_set_array_formula:lb,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var SS=cs.version;var Eu=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
        <path
            d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
        />
    </svg>
`.trim(),bu=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <rect width="7" height="7" x="3" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="14" rx="1" />
        <rect width="7" height="7" x="3" y="14" rx="1" />
    </svg>
`.trim(),ku=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="1"/>
        <circle cx="12" cy="5" r="1"/>
        <circle cx="12" cy="19" r="1"/>
    </svg>
`.trim(),Su=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M12 3v18"/>
        <rect width="18" height="18" x="3" y="3" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
    </svg>
`.trim(),Cu=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
    </svg>
`.trim(),Tu=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
        <path d="M8 7h6"/>
        <path d="M8 11h8"/>
    </svg>
`.trim(),cb={config:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3" />
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.82 2.82l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.82-2.82l.06-.06A1.65 1.65 0 0 0 3 15a1.65 1.65 0 0 0-1.51-1H1a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 3 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.82-2.82l.06.06A1.65 1.65 0 0 0 9 3.6a1.65 1.65 0 0 0 1-1.51V2a2 2 0 0 1 4 0v.09A1.65 1.65 0 0 0 15 3.6a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.82 2.82l-.06.06A1.65 1.65 0 0 0 21 9c0 .3.09.58.24.82.17.28.43.51.76.68.21.1.44.18.68.19H23a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z" />
        </svg>
    `,import:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 3v14" />
            <path d="m7 13 5 5 5-5" />
            <path d="M5 21h14" />
        </svg>
    `,headcount:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
            <circle cx="9" cy="7" r="4" />
            <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
    `,validate:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 6 9 17l-5-5" />
        </svg>
    `,review:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 12h3l2-5 4 10 2-5h5" />
        </svg>
    `,journal:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 7c-3-1-6-1-9 0v12c3-1 6-1 9 0 3-1 6-1 9 0V7c-3-1-6-1-9 0Z" />
            <path d="M12 7v12" />
        </svg>
    `,archive:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="4" rx="1" />
            <path d="M5 7v11a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7" />
            <path d="M10 12h4" />
        </svg>
    `};function Au(e){return e&&cb[e]||""}var Tl=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0" />
    </svg>
`.trim(),Al=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0v4" />
        <path d="M12 15v2" />
    </svg>
`.trim(),Di=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M5 12l4 4 10-10" />
    </svg>
`.trim(),Ru=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="4" y="3" width="16" height="18" rx="2" />
        <rect x="8" y="7" width="8" height="3" />
        <path d="M8 14h.01" />
        <path d="M12 14h.01" />
        <path d="M16 14h.01" />
        <path d="M8 17h.01" />
        <path d="M12 17h.01" />
        <path d="M16 17h.01" />
    </svg>
`.trim(),CS=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 5.5 20.5 8 16 12.5 13.5 10 18 5.5Z" />
        <path d="m12 11 6-6" />
        <path d="M3 22 12 13" />
        <path d="m3 18 4 4" />
        <path d="m11 11 3 3" />
    </svg>
`.trim(),Iu=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 1 0 7.07 7.07l1.71-1.71" />
    </svg>
`.trim(),Fu=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M7 10l5 5 5-5" />
        <path d="M12 15V3" />
    </svg>
`.trim(),Du=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M17 8l-5-5-5 5" />
        <path d="M12 3v12" />
    </svg>
`.trim(),Ni=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10" />
        <path d="m15 9-6 6" />
        <path d="m9 9 6 6" />
    </svg>
`.trim(),Oi=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 19-7-7 7-7" />
        <path d="M19 12H5" />
    </svg>
`.trim(),Nu=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" />
        <path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7" />
        <path d="M7 3v4a1 1 0 0 0 1 1h7" />
    </svg>
`.trim(),Pi=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 5 7 7-7 7" />
        <path d="M5 12h14" />
    </svg>
`.trim(),Li=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m9 12 2 2 4-4"/>
    </svg>
`.trim(),TS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" x2="12" y1="8" y2="12"/>
        <line x1="12" x2="12.01" y1="16" y2="16"/>
    </svg>
`.trim(),Ou=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/>
        <path d="M12 9v4"/>
        <path d="M12 17h.01"/>
    </svg>
`.trim(),Rl=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 16v-4"/>
        <path d="M12 8h.01"/>
    </svg>
`.trim(),AS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M21.801 10A10 10 0 1 1 17 3.335"/>
        <path d="m9 11 3 3L22 4"/>
    </svg>
`.trim(),RS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m15 9-6 6"/>
        <path d="m9 9 6 6"/>
    </svg>
`.trim(),IS=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m18 9-6-6-6 6"/>
        <path d="M12 3v14"/>
        <path d="M5 21h14"/>
    </svg>
`.trim(),FS=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m6 15 6 6 6-6"/>
        <path d="M12 21V7"/>
        <path d="M5 3h14"/>
    </svg>
`.trim(),$i=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
        <path d="M21 3v5h-5"/>
        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
        <path d="M3 21v-5h5"/>
    </svg>
`.trim(),Pu=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 6h18"/>
        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
        <line x1="10" x2="10" y1="11" y2="17"/>
        <line x1="14" x2="14" y1="11" y2="17"/>
    </svg>
`.trim(),Mi=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 6 6 18"/>
        <path d="m6 6 12 12"/>
    </svg>
`.trim(),Lu=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
        <circle cx="12" cy="12" r="3"/>
    </svg>
`.trim(),Il=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>
        <path d="M14 2v4a2 2 0 0 0 2 2h4"/>
        <path d="M10 9H8"/>
        <path d="M16 13H8"/>
        <path d="M16 17H8"/>
    </svg>
`.trim(),DS=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/>
        <path d="M2 12h20"/>
    </svg>
`.trim(),fb=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="3" width="18" height="18" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
        <path d="M9 3v18"/>
        <path d="M15 3v18"/>
    </svg>
`.trim(),NS=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
        <path d="M12 11h4"/>
        <path d="M12 16h4"/>
        <path d="M8 11h.01"/>
        <path d="M8 16h.01"/>
    </svg>
`.trim();function Is(e){return e==null?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Fs(e,t){return`
        <div class="pf-labeled-btn">
            ${e}
            <span class="pf-btn-label">${t}</span>
        </div>
    `}function On({textareaId:e,value:t,permanentId:r,isPermanent:a,hintId:n,saveButtonId:s,isSaved:i=!1,placeholder:o="Enter notes here..."}){let l=a?Al:Tl,c=s?`<button type="button" class="pf-action-toggle pf-save-btn ${i?"is-saved":""}" id="${s}" data-save-input="${e}" title="Save notes">${Nu}</button>`:"",f=r?`<button type="button" class="pf-action-toggle pf-notes-lock ${a?"is-locked":""}" id="${r}" aria-pressed="${a}" title="Lock notes (retain after archive)">${l}</button>`:"";return`
        <article class="pf-step-card pf-step-detail pf-notes-card">
            <div class="pf-notes-header">
                <div>
                    <h3 class="pf-notes-title">Notes</h3>
                    <p class="pf-notes-subtext">Leave notes your future self will appreciate. Notes clear after archiving. Click lock to retain permanently.</p>
                </div>
            </div>
            <div class="pf-notes-body">
                <textarea id="${e}" rows="6" placeholder="${Is(o)}">${Is(t||"")}</textarea>
                ${n?`<p class="pf-signoff-hint" id="${n}"></p>`:""}
            </div>
            <div class="pf-notes-action">
                ${r?Fs(f,"Lock"):""}
                ${s?Fs(c,"Save"):""}
            </div>
        </article>
    `}function Pn({reviewerInputId:e,reviewerValue:t,signoffInputId:r,signoffValue:a,isComplete:n,saveButtonId:s,isSaved:i=!1,completeButtonId:o,subtext:l="Sign-off below. Click checkmark icon. Done.",prevButtonId:c=null,nextButtonId:f=null}){let d=c||`${o}-prev`,h=f||`${o}-next`,p=`<button type="button" class="pf-action-toggle ${n?"is-active":""}" id="${o}" aria-pressed="${!!n}" title="Mark step complete">${Di}</button>`,m=`<button type="button" class="pf-action-toggle pf-nav-toggle" id="${d}" title="Previous step">${Oi}</button>`,u=`<button type="button" class="pf-action-toggle pf-nav-toggle" id="${h}" title="Next step">${Pi}</button>`;return`
        <article class="pf-step-card pf-step-detail pf-config-card">
            <div class="pf-config-head pf-notes-header">
                <div>
                    <h3>Sign-off</h3>
                    <p class="pf-config-subtext">${Is(l)}</p>
                </div>
            </div>
            <div class="pf-config-grid">
                <label class="pf-config-field">
                    <span>Reviewer Name</span>
                    <input type="text" id="${e}" value="${Is(t)}" placeholder="Full name">
                </label>
                <label class="pf-config-field">
                    <span>Sign-off Date</span>
                    <input type="date" id="${r}" value="${Is(a)}" readonly>
                </label>
            </div>
            <div class="pf-signoff-action">
                ${m?Fs(m,"Prev"):""}
                ${Fs(p,"Done")}
                ${u?Fs(u,"Next"):""}
            </div>
        </article>
    `}function Ds(e,t){e&&(e.classList.toggle("is-locked",t),e.setAttribute("aria-pressed",String(t)),e.innerHTML=t?Al:Tl)}function Ln(e,t){e&&e.classList.toggle("is-saved",t)}function Fl(e=document){let t=e.querySelectorAll(".pf-save-btn[data-save-input]"),r=[];return t.forEach(a=>{let n=a.getAttribute("data-save-input"),s=document.getElementById(n);if(!s)return;let i=()=>{Ln(a,!1)};s.addEventListener("input",i),r.push(()=>s.removeEventListener("input",i))}),()=>r.forEach(a=>a())}function $u(e,t){if(e===0)return{canComplete:!0,blockedBy:null,message:""};for(let r=0;r<e;r++)if(!t[r])return{canComplete:!1,blockedBy:r,message:`Complete Step ${r} before signing off on this step.`};return{canComplete:!0,blockedBy:null,message:""}}function Mu(e){let t=document.querySelector(".pf-workflow-toast");t&&t.remove();let r=document.createElement("div");r.className="pf-workflow-toast pf-workflow-toast--warning",r.innerHTML=`
        <span class="pf-workflow-toast-icon">\u26A0\uFE0F</span>
        <span class="pf-workflow-toast-message">${e}</span>
    `,document.body.appendChild(r),requestAnimationFrame(()=>{r.classList.add("pf-workflow-toast--visible")}),setTimeout(()=>{r.classList.remove("pf-workflow-toast--visible"),setTimeout(()=>r.remove(),300)},4e3)}var Dl={fillColor:"#000000",fontColor:"#FFFFFF",bold:!0};function tn(e){e.format.fill.color=Dl.fillColor,e.format.font.color=Dl.fontColor,e.format.font.bold=Dl.bold}var pa={currency:"$#,##0.00",currencyNegative:"$#,##0.00;[Red]($#,##0.00)",number:"#,##0.00",integer:"#,##0",percent:"0.00%",date:"yyyy-mm-dd",dateShort:"mm/dd/yyyy",text:"@"},Ra={narrow:10,standard:15,wide:20,extraWide:30,description:40};function Ns(e,t){!e||!t||t.length===0||(e["!cols"]=t.map(r=>({wch:r})))}function Bu(e,t,r){if(!(!e||!r||t<=1))for(let a=1;a<t;a++)for(let[n,s]of Object.entries(r)){let i=parseInt(n,10),o=Wr.encode_cell({r:a,c:i});e[o]&&(e[o].z=s)}}function ub(e,t,r){if(!e||!t||r<=1)return{};let a={};return t.forEach((n,s)=>{let i=String(n||"").toLowerCase().trim(),o=null;i.includes("amount")||i.includes("total")||i.includes("liability")||i.includes("pay")||i.includes("wage")||i.includes("salary")||i.includes("rate")&&!i.includes("accrual rate")||i.includes("debit")||i.includes("credit")||i.includes("change")||i.includes("fixed")||i.includes("variable")||i.includes("burden")||i.includes("gross")?o=pa.currency:i.includes("date")||i.includes("period")?o=pa.dateShort:i.includes("percent")||i.includes("rate")&&i.includes("burden")||i==="% of total"?o=pa.percent:(i.includes("count")||i.includes("headcount")||i==="id"||i.includes("employee_id"))&&(o=pa.integer),o&&(a[s]=o)}),Bu(e,r,a),a}function db(e){return!e||e.length===0?[]:e.map(t=>{let r=String(t||"").toLowerCase().trim(),a=t.length;return r.includes("description")||r.includes("note")||r.includes("name")&&r.includes("account")?Ra.description:r.includes("name")||r.includes("department")?Ra.extraWide:a>12?Ra.wide:a<8?Ra.narrow:Ra.standard})}function Uu(e,t,r,a={}){if(!e||!t||t.length===0)return;let{columnFormats:n={},columnWidths:s=null,autoFormat:i=!0,autoSize:o=!0}=a;if(t.length,i&&ub(e,t,r),n&&Object.keys(n).length>0&&Bu(e,r,n),s)Ns(e,s);else if(o){let l=db(t);Ns(e,l)}}function Hu(e,t){if(!e||!t||t.length===0)return;let r=Wr.decode_range(e["!ref"]||"A1"),a=r.e.r+1,n=r.e.c+1,s=[];for(let i=0;i<=r.e.c;i++)i===0?s.push(28):s.push(16);Ns(e,s);for(let i=0;i<=r.e.r;i++)for(let o=0;o<=r.e.c;o++){let l=Wr.encode_cell({r:i,c:o}),c=e[l];if(!c)continue;let f=c.v,d=t[i]||[],h=String(d[0]||"").toLowerCase(),p=pb(t,i,o);if(typeof f!="number")continue;if(f>4e4&&f<6e4&&(h.includes("date")||h.includes("period")||p.includes("date")||p.includes("period")||p.includes("pay period"))){c.z=pa.dateShort,c.t="n";continue}if((p.includes("%")||p.includes("percent")||h.includes("burden rate")||h.includes("% of total"))&&f>=0&&f<=2){c.z=pa.percent;continue}if((p.includes("salary")||p.includes("pay")||p.includes("total")||p.includes("burden")||p.includes("gross")||p.includes("fixed")||p.includes("variable")||h.includes("total")||h.includes("salary")||h.includes("pay")||h.includes("burden")&&!h.includes("rate"))&&Math.abs(f)>=100){c.z=pa.currency;continue}if((p.includes("headcount")||p.includes("count")||h.includes("headcount"))&&Number.isInteger(f)){c.z=pa.integer;continue}Math.abs(f)>=1e3&&(c.z=pa.currency)}}function pb(e,t,r){var a;for(let n=t-1;n>=Math.max(0,t-5);n--){let s=(a=e[n])==null?void 0:a[r];if(typeof s=="string"&&s.trim())return s.toLowerCase()}return""}var ju="https://jgciqwzwacaesqjaoadc.supabase.co/functions/v1",hb="jgciqwzwacaesqjaoadc",Wu="pf_warehouse_auth",Gu="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE",rn=Gu,Nl="BUILTIN_ANON_KEY_SYNC",Ol=new Date().toISOString();async function zu(){if(console.log("[Warehouse:Auth] Force refreshing auth..."),typeof OfficeRuntime!="undefined"&&OfficeRuntime.storage)try{let e=await OfficeRuntime.storage.getItem(Wu);if(e){rn=e,Nl="OfficeRuntime.storage",Ol=new Date().toISOString(),console.log("[Warehouse:Auth] \u2713 Loaded from OfficeRuntime.storage");return}}catch(e){console.warn("[Warehouse:Auth] OfficeRuntime.storage read failed:",e.message)}rn=Gu,Nl="BUILTIN_ANON_KEY",Ol=new Date().toISOString(),console.log("[Warehouse:Auth] \u2713 Using built-in anon key")}function Pl(){let e=!!rn,t=e?`${rn.substring(0,20)}...`:null;return{baseUrl:ju,projectRef:hb,tokenSource:Nl,headers_present:e?["Authorization","apikey","Content-Type"]:["Content-Type"],isValid:e&&rn.length>50,tokenPreview:t,lastRefreshTime:Ol,storageKeyUsed:Wu}}function Vu(){let e=Pl();return console.log("\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557"),console.log("\u2551  WAREHOUSE AUTH DEBUG DUMP                                \u2551"),console.log("\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D"),console.log("[Debug] baseUrl:",e.baseUrl),console.log("[Debug] projectRef:",e.projectRef),console.log("[Debug] tokenSource:",e.tokenSource),console.log("[Debug] headers_present:",e.headers_present),console.log("[Debug] isValid:",e.isValid),console.log("[Debug] tokenPreview:",e.tokenPreview),console.log("[Debug] lastRefreshTime:",e.lastRefreshTime),console.log("[Debug] storageKeyUsed:",e.storageKeyUsed),console.log("[Debug] OfficeRuntime available:",typeof OfficeRuntime!="undefined"),e}async function mb(e,t,r="unknown"){let a=`${ju}/${e}`,n=Pl();if(console.log(`[DW] callsite=${r} url=${a} tokenSource=${n.tokenSource} headers_present=[${n.headers_present.join(",")}]`),!n.isValid){let i=`[DW:PREFLIGHT] \u274C Authorization missing! callsite=${r} tokenSource=${n.tokenSource}`;throw console.error(i),console.error("[DW:PREFLIGHT] Call forceRefreshAuth() or debugAuthDump() to troubleshoot"),new Error(i)}let s={"Content-Type":"application/json",Authorization:`Bearer ${rn}`,apikey:rn};try{let i=await fetch(a,{method:"POST",headers:s,body:JSON.stringify(t)});if(console.log(`[DW] callsite=${r} status=${i.status}`),i.status===401){let l=await i.text();return console.error(`[DW:401] callsite=${r} response_body=${l}`),console.error(`[DW:401] tokenSource=${n.tokenSource} tokenPreview=${n.tokenPreview}`),{ok:!1,status:401,error:`Unauthorized: ${l}`}}if(!i.ok){let l=await i.text();return console.error(`[DW:ERROR] callsite=${r} status=${i.status} body=${l}`),{ok:!1,status:i.status,error:l}}let o=await i.json();return console.log(`[DW] callsite=${r} success=true`),{ok:!0,status:i.status,data:o}}catch(i){return console.error(`[DW:NETWORK] callsite=${r} error=${i.message}`),{ok:!1,status:0,error:i.message}}}async function an(e,t,r){return mb("column-mapper",{action:e,...t},r||e)}(async function(){await zu()})();typeof window!="undefined"&&(window.warehouseDebug={debugAuthDump:Vu,forceRefreshAuth:zu,getWarehouseAuthContext:Pl,testRequest:async()=>{console.log(`
=== TEST: debugAuthDump ===`),Vu(),console.log(`
=== TEST: bootstrap ===`);try{let e=await an("bootstrap",{installation_key:"pf_install_9f3c2b1a_20251212"},"test_bootstrap");console.log("Bootstrap result:",e)}catch(e){console.error("Bootstrap error:",e)}console.log(`
=== TEST: get_options ===`);try{let e=await an("get_options",{module:"payroll-recorder"},"test_get_options");console.log("Get options result:",e)}catch(e){console.error("Get options error:",e)}}},console.log("[Warehouse] Debug utilities available: window.warehouseDebug.debugAuthDump(), .forceRefreshAuth(), .testRequest()"));var lr="payroll-recorder";var Vn="Payroll Recorder";function Ie(e,t="info",r=4e3){document.querySelectorAll(".pf-toast").forEach(s=>s.remove());let a=document.createElement("div");a.className=`pf-toast pf-toast--${t}`;let n=t==="success"?Li:t==="error"?Ni:Rl;if(a.innerHTML=`
        <div class="pf-toast-content">
            <span class="pf-toast-icon" aria-hidden="true">${n}</span>
            <span class="pf-toast-message">${e.replace(/\n/g,"<br>")}</span>
        </div>
        <button class="pf-toast-close" onclick="this.parentElement.remove()">\xD7</button>
    `,!document.getElementById("pf-toast-styles")){let s=document.createElement("style");s.id="pf-toast-styles",s.textContent=`
            .pf-toast {
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--glass-bg);
                backdrop-filter: var(--glass-blur);
                -webkit-backdrop-filter: var(--glass-blur);
                color: white;
                padding: 16px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 90%;
                display: flex;
                align-items: flex-start;
                gap: 12px;
                animation: toastIn 0.3s ease;
            }
            .pf-toast--success { border-left: 4px solid #22c55e; }
            .pf-toast--error { border-left: 4px solid #ef4444; }
            .pf-toast--info { border-left: 4px solid #3b82f6; }
            .pf-toast-content { display: flex; align-items: flex-start; gap: 8px; flex: 1; }
            .pf-toast-icon .pf-icon { width: 18px; height: 18px; }
            .pf-toast-message { font-size: 14px; line-height: 1.4; }
            .pf-toast-close { background: none; border: none; color: #888; font-size: 20px; cursor: pointer; padding: 0; margin-left: 8px; }
            .pf-toast-close:hover { color: white; }
            @keyframes toastIn { from { opacity: 0; transform: translateX(-50%) translateY(-20px); } }
        `,document.head.appendChild(s)}return document.body.appendChild(a),r>0&&setTimeout(()=>a.remove(),r),a}function gb(){document.querySelectorAll(".pf-save-prompt").forEach(r=>r.remove());let e=document.createElement("div");if(e.className="pf-save-prompt",e.innerHTML=`
        <div class="pf-save-prompt-content">
            <div class="pf-save-prompt-title">Good work!</div>
            <div class="pf-save-prompt-subtitle">Ready to finalize?</div>
            <button type="button" class="pf-save-prompt-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
                Finalize
            </button>
        </div>
    `,!document.getElementById("pf-save-prompt-styles")){let r=document.createElement("style");r.id="pf-save-prompt-styles",r.textContent=`
            .pf-save-prompt {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: var(--glass-bg);
                backdrop-filter: var(--glass-blur);
                -webkit-backdrop-filter: var(--glass-blur);
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 32px 40px;
                border-radius: 20px;
                box-shadow: 
                    0 24px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 60px rgba(99, 102, 241, 0.1);
                z-index: 10002;
                text-align: center;
                animation: pf-prompt-fade-in 0.3s ease;
            }
            @keyframes pf-prompt-fade-in {
                from { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
                to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            }
            .pf-save-prompt-content {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            .pf-save-prompt-title {
                font-size: 20px;
                font-weight: 700;
                color: #fff;
            }
            .pf-save-prompt-subtitle {
                font-size: 14px;
                color: rgba(255, 255, 255, 0.6);
                margin-bottom: 12px;
            }
            .pf-save-prompt-btn {
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border: none;
                color: white;
                padding: 16px 40px;
                border-radius: 12px;
                font-size: 18px;
                font-weight: 700;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
                transition: all 0.2s ease;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4), 0 0 0 2px rgba(99, 102, 241, 0.2);
                margin-top: 8px;
            }
            .pf-save-prompt-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 12px 32px rgba(99, 102, 241, 0.5), 0 0 0 2px rgba(99, 102, 241, 0.3);
                background: linear-gradient(145deg, #7c3aed, #6366f1);
            }
            .pf-save-prompt-btn:active {
                transform: translateY(-1px);
            }
            .pf-save-prompt.closing {
                animation: pf-prompt-fade-out 0.2s ease forwards;
            }
            @keyframes pf-prompt-fade-out {
                to { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
            }
        `,document.head.appendChild(r)}document.body.appendChild(e),e.querySelector(".pf-save-prompt-btn").addEventListener("click",()=>{e.classList.add("closing"),setTimeout(()=>{e.remove(),xb()},200)})}function xb(){document.querySelectorAll(".pf-toast, .pf-success-toast").forEach(n=>n.remove());let e=[{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"/></svg>',title:"Done.",subtitle:"Efficiency unlocked."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"/><path d="m9 12 2 2 4-4"/></svg>',title:"Locked in.",subtitle:"You're good to go."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><path d="M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z"/><path d="M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z"/></svg>',title:"Stored.",subtitle:"Everything stays aligned."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>',title:"Payroll archived.",subtitle:"Flow restored."}],t=e[Math.floor(Math.random()*e.length)],r=document.createElement("div");if(r.className="pf-success-toast",r.innerHTML=`
        <div class="pf-success-toast-icon">${t.icon}</div>
        <div class="pf-success-toast-text">
            <div class="pf-success-toast-title">${t.title}</div>
            <div class="pf-success-toast-subtitle">${t.subtitle}</div>
        </div>
        <div class="pf-success-toast-progress"></div>
    `,!document.getElementById("pf-success-toast-styles")){let n=document.createElement("style");n.id="pf-success-toast-styles",n.textContent=`
            .pf-success-toast {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: var(--glass-bg);
                backdrop-filter: var(--glass-blur);
                -webkit-backdrop-filter: var(--glass-blur);
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 36px 48px 24px;
                border-radius: 24px;
                box-shadow: 
                    0 32px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 80px rgba(99, 102, 241, 0.15);
                z-index: 10002;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 16px;
                animation: pf-success-in 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                overflow: hidden;
                text-align: center;
                min-width: 220px;
            }
            @keyframes pf-success-in {
                from { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.9);
                }
                to { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
            }
            @keyframes pf-success-out {
                from { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
                to { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.95) translateY(-20px);
                }
            }
            .pf-success-toast-icon {
                width: 64px;
                height: 64px;
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border-radius: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
                animation: pf-icon-pulse 2s ease-in-out infinite;
            }
            @keyframes pf-icon-pulse {
                0%, 100% { box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4); }
                50% { box-shadow: 0 8px 32px rgba(99, 102, 241, 0.6); }
            }
            .pf-success-toast-text {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
            }
            .pf-success-toast-title {
                font-size: 22px;
                font-weight: 700;
                color: #fff;
                letter-spacing: -0.5px;
            }
            .pf-success-toast-subtitle {
                font-size: 15px;
                color: rgba(255, 255, 255, 0.6);
                font-weight: 500;
            }
            .pf-success-toast-progress {
                position: absolute;
                bottom: 0;
                left: 0;
                height: 4px;
                background: linear-gradient(90deg, #6366f1, #a855f7, #6366f1);
                background-size: 200% 100%;
                animation: pf-progress-shrink 5s linear forwards, pf-progress-shimmer 1s linear infinite;
                border-radius: 0 0 24px 24px;
            }
            @keyframes pf-progress-shrink {
                from { width: 100%; }
                to { width: 0%; }
            }
            @keyframes pf-progress-shimmer {
                from { background-position: 200% 0; }
                to { background-position: -200% 0; }
            }
            .pf-success-toast.closing {
                animation: pf-success-out 0.3s ease forwards;
            }
            .pf-success-backdrop {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.4);
                backdrop-filter: blur(4px);
                -webkit-backdrop-filter: blur(4px);
                z-index: 10001;
                animation: pf-confirm-fade-in 0.2s ease;
            }
        `,document.head.appendChild(n)}let a=document.createElement("div");a.className="pf-success-backdrop",document.body.appendChild(a),document.body.appendChild(r),setTimeout(()=>{r.classList.add("closing"),a.style.opacity="0",a.style.transition="opacity 0.3s ease",setTimeout(()=>{r.remove(),a.remove(),dk()},300)},5e3)}function Ul(e,t={}){let{title:r="Confirm Action",confirmText:a="Continue",cancelText:n="Cancel",icon:s=Il,destructive:i=!1}=t;return new Promise(o=>{document.querySelectorAll(".pf-confirm-overlay").forEach(c=>c.remove());let l=document.createElement("div");if(l.className="pf-confirm-overlay",l.innerHTML=`
            <div class="pf-confirm-dialog">
                <div class="pf-confirm-icon">${s}</div>
                <div class="pf-confirm-title">${r}</div>
                <div class="pf-confirm-message">${e.replace(/\n/g,"<br>")}</div>
                <div class="pf-confirm-buttons">
                    <button class="pf-confirm-btn pf-confirm-btn--cancel">${n}</button>
                    <button class="pf-confirm-btn pf-confirm-btn--ok ${i?"pf-confirm-btn--destructive":""}">${a}</button>
                </div>
            </div>
        `,!document.getElementById("pf-confirm-styles")){let c=document.createElement("style");c.id="pf-confirm-styles",c.textContent=`
                .pf-confirm-overlay {
                    position: fixed;
                    inset: 0;
                    background: rgba(0, 0, 0, 0.5);
                    backdrop-filter: blur(8px);
                    -webkit-backdrop-filter: blur(8px);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10001;
                    animation: pf-confirm-fade-in 0.2s ease;
                }
                @keyframes pf-confirm-fade-in {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                @keyframes pf-confirm-scale-in {
                    from { opacity: 0; transform: scale(0.95) translateY(-10px); }
                    to { opacity: 1; transform: scale(1) translateY(0); }
                }
                .pf-confirm-dialog {
                    background: var(--glass-bg);
                    backdrop-filter: var(--glass-blur);
                    -webkit-backdrop-filter: var(--glass-blur);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    color: white;
                    padding: 28px 32px;
                    border-radius: 20px;
                    max-width: 380px;
                    width: 90%;
                    box-shadow: 
                        0 24px 48px rgba(0, 0, 0, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.05) inset,
                        0 1px 0 rgba(255, 255, 255, 0.1) inset;
                    text-align: center;
                    animation: pf-confirm-scale-in 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
                }
                .pf-confirm-icon {
                    font-size: 48px;
                    margin-bottom: 16px;
                    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
                }
                .pf-confirm-title {
                    font-size: 18px;
                    font-weight: 600;
                    color: #fff;
                    margin-bottom: 12px;
                    letter-spacing: -0.3px;
                }
                .pf-confirm-message {
                    font-size: 14px;
                    line-height: 1.6;
                    color: rgba(255, 255, 255, 0.7);
                    margin-bottom: 24px;
                    text-align: left;
                }
                .pf-confirm-buttons {
                    display: flex;
                    gap: 12px;
                    justify-content: center;
                }
                .pf-confirm-btn {
                    flex: 1;
                    padding: 12px 24px;
                    border-radius: 12px;
                    border: none;
                    cursor: pointer;
                    font-size: 15px;
                    font-weight: 600;
                    letter-spacing: -0.2px;
                    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                }
                .pf-confirm-btn:active {
                    transform: scale(0.97);
                }
                .pf-confirm-btn--cancel {
                    background: rgba(255, 255, 255, 0.08);
                    color: rgba(255, 255, 255, 0.9);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                }
                .pf-confirm-btn--cancel:hover {
                    background: rgba(255, 255, 255, 0.12);
                    border-color: rgba(255, 255, 255, 0.15);
                }
                .pf-confirm-btn--ok {
                    background: linear-gradient(145deg, #6366f1, #4f46e5);
                    color: white;
                    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
                }
                .pf-confirm-btn--ok:hover {
                    background: linear-gradient(145deg, #818cf8, #6366f1);
                    box-shadow: 0 6px 16px rgba(99, 102, 241, 0.5);
                    transform: translateY(-1px);
                }
                .pf-confirm-btn--destructive {
                    background: linear-gradient(145deg, #ef4444, #dc2626);
                    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
                }
                .pf-confirm-btn--destructive:hover {
                    background: linear-gradient(145deg, #f87171, #ef4444);
                    box-shadow: 0 6px 16px rgba(239, 68, 68, 0.5);
                }
            `,document.head.appendChild(c)}document.body.appendChild(l),l.addEventListener("click",c=>{c.target===l&&(l.remove(),o(!1))}),l.querySelector(".pf-confirm-btn--cancel").onclick=()=>{l.remove(),o(!1)},l.querySelector(".pf-confirm-btn--ok").onclick=()=>{l.remove(),o(!0)}})}var mC=Fe.CONFIG||"SS_PF_Config",Ll=["SS_PF_Config"];var vb="Normalize payroll exports, enforce controls, and prep journal entries without leaving Excel. Every run follows the same guidance so you stay audit-ready.",Pr=zs.filter(e=>!e.hidden).map(({id:e,title:t})=>({id:e,title:t})),et={TYPE:0,FIELD:1,VALUE:2,PERMANENT:3,TITLE:-1},yb="Run Settings";var Xu="N";var _b="PR_JE_Debit_Total",wb="PR_JE_Credit_Total",Eb="PR_JE_Difference",aa={0:{note:"PR_Notes_Config",reviewer:"PR_Reviewer_Config",signOff:"PR_SignOff_Config"},1:{note:"PR_Notes_Import",reviewer:"PR_Reviewer_Import",signOff:"PR_SignOff_Import"},2:{note:"PR_Notes_Review",reviewer:"PR_Reviewer_Review",signOff:"PR_SignOff_Review"},3:{note:"PR_Notes_JE",reviewer:"PR_Reviewer_JE",signOff:"PR_SignOff_JE"},4:{note:"PR_Notes_Archive",reviewer:"PR_Reviewer_Archive",signOff:"PR_SignOff_Archive"}},Lr={0:"PR_Complete_Config",1:"PR_Complete_Import",2:"PR_Complete_Review",3:"PR_Complete_JE",4:"PR_Complete_Archive"},bb={0:"PR_Homepage",1:"PR_Data_Clean",2:"PR_Expense_Review",3:"PR_JE_Draft",4:"PR_Archive_Summary"},Mn="PR_Reviewer",sd="PR_Payroll_Provider",Et={statusText:"",focusedIndex:0,activeView:"home",activeStepId:null,stepStatuses:Pr.reduce((e,t)=>({...e,[t.id]:"pending"}),{})},ht={loaded:!1,values:{},permanents:{},overrides:{accountingPeriod:!1,jeId:!1}},$n=new Map,Bi=null,Yu=["PR_Payroll_Date","Payroll Date (YYYY-MM-DD)","Payroll_Date","Payroll Date","Payroll_Date_(YYYY-MM-DD)"],Hi=null,It={loading:!1,lastError:null,prDataTotal:null,cleanTotal:null,reconDifference:null,bankAmount:"",bankDifference:null,plugEnabled:!1},bt={loading:!1,lastError:null,periods:[],copilotResponse:"",completenessCheck:{currentPeriod:null,historicalPeriods:null},unclassifiedColumns:[],measureColumns:[],dimensionColumns:[],unclassifiedTotals:{},sumUnclassifiedNumeric:0,classificationDelta:null},zr={loading:!1,lastError:null,response:null,contextPack:null,lastRefresh:null,collapsed:!1},at={debitTotal:null,creditTotal:null,difference:null,cleanTotal:null,loading:!1,lastError:null,validationRun:!1,issues:[],allocationLines:[],unmappedColumns:[],unmappedTotal:0,glMappings:null,lastGenerated:null};async function kb(){if(console.log("Completeness Check - Starting..."),!mt()){console.log("Completeness Check - Excel runtime not available");return}let e=await Xi(),t=e.total;console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("COMPLETENESS CHECK: Step 1 Measure Universe"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log(`Step 1 PR_Data_Clean Total: $${t.toLocaleString(void 0,{minimumFractionDigits:2})}`),console.log(`Included measures: ${e.includedMeasureHeaders.length}`),console.log(`\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550
`),bt.measureUniverseTotal=t,bt.measureUniverseHeaders=e.includedMeasureHeaders;try{await Excel.run(async r=>{var f,d,h,p;let a=r.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN),n=r.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_SUMMARY),s=r.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_TOTALS);a.load("isNullObject"),n.load("isNullObject"),s.load("isNullObject"),await r.sync();let i={currentPeriod:null,historicalPeriods:null};if(!a.isNullObject){let m=a.getUsedRangeOrNullObject();if(m.load("values"),await r.sync(),!m.isNullObject&&m.values&&m.values.length>1){let g=(m.values[0]||[]).map(Q=>String(Q||"").trim()),v=g.map(Q=>Q.toLowerCase()),y=m.values.slice(1);console.log("Completeness Check - PR_Data_Clean headers:",g);let x=nt,b=new Set;g.forEach((Q,J)=>{let oe=Q.toLowerCase();x.loaded&&x.dimensions&&x.dimensions.has(oe)&&b.add(J)});let C=[],w={};g.forEach((Q,J)=>{if(b.has(J))return;let oe=0,ae=!1;for(let be of y){let O=Number(be[J]);!isNaN(O)&&O!==0&&(ae=!0,oe+=O)}ae&&(C.push({idx:J,header:Q,total:oe}),w[Q]=oe)});let _=C.reduce((Q,J)=>Q+J.total,0),k=[],S={};g.forEach((Q,J)=>{if(b.has(J))return;let oe=Q.toLowerCase();if(!(x.loaded&&x.measures&&x.measures[oe]))return;let be=0;for(let O of y){let Se=Number(O[J]);isNaN(Se)||(be+=Se)}k.push({idx:J,header:Q,total:be,meta:x.measures[oe]}),S[Q]=be});let D=k.reduce((Q,J)=>Q+J.total,0),R=[],T=[],V={summaryExclusion:[],includeFalse:[],sideEE:[],sideNA:[],dimension:[]},G=[];g.forEach((Q,J)=>{var pe;let oe=Q.toLowerCase();if(b.has(J)){let z=0;for(let ce of y){let ft=Number(ce[J]);isNaN(ft)||(z+=ft)}Math.abs(z)>0&&(V.dimension.push(Q),T.push({header:Q,total:z,reason:"dimension"}));return}let ae=!1,be=[],O=0;for(let z of y){let ce=Number(z[J]);isNaN(ce)||(O+=ce,ce!==0&&(ae=!0,be.length<10&&be.push(ce)))}if(!ae)return;let Se=x.loaded&&x.measures?x.measures[oe]:null,ke=Vl(Se,oe);if(!ke.include){T.push({header:Q,total:O,reason:ke.reason}),ke.reason==="summary_exclusion"?V.summaryExclusion.push(Q):ke.reason==="include=false"?V.includeFalse.push(Q):ke.reason==="side='ee'"?V.sideEE.push(Q):ke.reason==="side='na'"&&V.sideNA.push(Q);return}!Se&&!oe.includes("amount")&&be.every(ce=>Number.isInteger(ce)&&Math.abs(ce)<1e3)&&be.length>0&&G.push({header:Q,total:O,note:"Included (numeric, verify classification)"});let Ne=(pe=Se==null?void 0:Se.sign)!=null?pe:1;R.push({idx:J,sign:Ne,header:Q,meta:Se})});let W=0,j={};R.forEach(({idx:Q,sign:J,header:oe})=>{let ae=0;for(let be of y){let O=Number(be[Q])||0;ae+=O*J}j[oe]=ae,W+=ae});let se=T.reduce((Q,J)=>Q+J.total,0),q=_-W,K=Q=>`$${Q.toLocaleString(void 0,{minimumFractionDigits:2})}`,Z=(Q,J)=>Object.entries(Q).sort((oe,ae)=>Math.abs(ae[1])-Math.abs(oe[1])).slice(0,J),X=(Q,J)=>Q.slice().sort((oe,ae)=>Math.abs(ae.total)-Math.abs(oe.total)).slice(0,J);console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("DIAGNOSTIC: PR_Data_Clean Total Analysis"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log(`
1. TOTAL_NUMERIC_SHEET (all numeric columns except dimensions):`),console.log(`   Total: ${K(_)} (${C.length} columns)`),console.log("   Top 15 columns:"),Z(w,15).forEach(([Q,J],oe)=>console.log(`      ${oe+1}. ${Q}: ${K(J)}`)),console.log(`
2. TOTAL_DICTIONARY_MATCHED (headers in dictionary, no filtering):`),console.log(`   Total: ${K(D)} (${k.length} columns)`),console.log("   Top 15 columns:"),Z(S,15).forEach(([Q,J],oe)=>console.log(`      ${oe+1}. ${Q}: ${K(J)}`)),console.log(`
3. TOTAL_CURRENT_LOGIC (with include/side filtering):`),console.log(`   Total: ${K(W)} (${R.length} columns)`),console.log("   Top 15 columns:"),Z(j,15).forEach(([Q,J],oe)=>console.log(`      ${oe+1}. ${Q}: ${K(J)}`)),console.log(`
4. DELTA EXPLANATION:`),console.log(`   TOTAL_NUMERIC_SHEET - TOTAL_CURRENT_LOGIC = ${K(q)}`),console.log(`   Sum of excluded columns = ${K(se)}`);let F=Math.abs(q-se)<1;console.log(`   Reconciles: ${F?"YES":"NO (investigate)"}`),F||console.log(`   Unexplained gap: ${K(q-se)}`),console.log(`
5. TOP 10 EXCLUDED BY DOLLARS:`),X(T,10).forEach((Q,J)=>{console.log(`      ${J+1}. ${Q.header}: ${K(Q.total)} (${Q.reason})`)}),console.log(`
EXCLUSION SUMMARY BY RULE:`),console.log(`   summary_exclusion (Gross/Net Pay): ${V.summaryExclusion.length} \u2192 ${V.summaryExclusion.join(", ")||"(none)"}`),console.log(`   expense_review_include=false: ${V.includeFalse.length} \u2192 ${V.includeFalse.join(", ")||"(none)"}`),console.log(`   side='ee' (employee): ${V.sideEE.length} \u2192 ${V.sideEE.join(", ")||"(none)"}`),console.log(`   side='na' (summary): ${V.sideNA.length} \u2192 ${V.sideNA.join(", ")||"(none)"}`),console.log(`   dimension: ${V.dimension.length} \u2192 ${V.dimension.slice(0,5).join(", ")}${V.dimension.length>5?"...":""}`),G.length>0&&(console.log(`
SUSPICIOUS NUMERIC (included, verify classification):`),G.forEach((Q,J)=>{console.log(`      ${J+1}. ${Q.header}: ${K(Q.total)} - ${Q.note}`)})),console.log(`\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550
`);let U=((h=(d=(f=bt.periods)==null?void 0:f[0])==null?void 0:d.summary)==null?void 0:h.total)||0,P=t;console.log(`
\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550`),console.log("RECONCILIATION CHECK"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log(`Step 1 Universe Total:   ${K(t)}`),console.log(`Expense Review Total:    ${K(U)}`);let B=Math.abs(t-U);console.log(`Delta:                   ${K(B)}`);let Y=B<1;console.log(`Reconciled:              ${Y?"YES":"NO - INVESTIGATE"}`),console.log(`\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550
`),i.currentPeriod={match:Y,prDataClean:P,currentTotal:U}}}let o=(bt.periods||[]).slice(1,6);console.log("Completeness Check - Looking for periods:",o.map(m=>m.key||m.label));let l=new Map,c=null;if(!s.isNullObject){let m=s.getUsedRangeOrNullObject();m.load("values"),await r.sync(),!m.isNullObject&&m.values&&m.values.length>1&&(zl(m.values).forEach(g=>{var y;let v=Bl(g.key);v&&l.set(v,Number((y=g.summary)==null?void 0:y.total)||0)}),l.size>0&&(c="PR_Archive_Totals",console.log("Completeness Check - Using PR_Archive_Totals lookup keys:",Array.from(l.keys()))))}if(!c&&!n.isNullObject){let m=n.getUsedRangeOrNullObject();if(m.load("values"),await r.sync(),!m.isNullObject&&m.values&&m.values.length>1){let u=(m.values[0]||[]).map(x=>String(x||"").toLowerCase().trim()),g=u.findIndex(x=>x.includes("pay period")||x.includes("payroll date")||x==="date"||x==="period"||x.includes("period")),v=u.findIndex(x=>x.includes("amount")),y=v>=0?v:u.findIndex(x=>x==="total"||x==="all-in"||x==="allin"||x==="all-in total"||x==="total payroll"||x.includes("total"));if(console.log("Completeness Check - PR_Archive_Summary headers:",u),console.log("Completeness Check - Date column index:",g,"Total column index:",y),y>=0&&g>=0){let x=m.values.slice(1);l=new Map;for(let b of x){let C=b[g],w=Bl(C);if(w){let _=Number(b[y])||0,k=l.get(w)||0;l.set(w,k+_)}}l.size>0&&(c="PR_Archive_Summary",console.log("Completeness Check - Using PR_Archive_Summary lookup keys:",Array.from(l.keys())),console.log("Completeness Check - PR_Archive_Summary lookup values:",Array.from(l.entries())))}else console.warn("Completeness Check - Missing date or total column in PR_Archive_Summary"),console.warn("  Date column index:",g,"Total column index:",y)}}if(c&&o.length>0){let m=0,u=0,g=0,v=[];for(let C of o){let w=C.key||C.label||"",_=Bl(w),k=((p=C.summary)==null?void 0:p.total)||0;u+=k;let S=l.get(_);S!==void 0?(m+=S,g++,v.push({period:w,calculated:k,archive:S,match:Math.abs(k-S)<1})):(console.warn(`Completeness Check - Period ${w} (normalized: ${_}) not found in archive`),v.push({period:w,calculated:k,archive:null,match:!1}))}console.log("Completeness Check - Period details:",v),console.log("Completeness Check - Matched",g,"of",o.length,"periods"),console.log("Completeness Check - Archive sum:",m,"Periods sum:",u);let y=g===o.length&&o.length>0,x=Math.abs(m-u)<1,b=y&&x;i.historicalPeriods={match:b,archiveSum:m,periodsSum:u,matchedCount:g,totalPeriods:o.length,details:v,source:c}}bt.completenessCheck=i,console.log("Completeness Check - Results:",JSON.stringify(i))}),console.log("Completeness Check - Complete!")}catch(r){console.error("Payroll completeness check failed:",r)}}function Sb(){var g,v;let e=bt.completenessCheck||{},t=((g=bt.periods)==null?void 0:g.length)>0,r=y=>Ia(Math.round(y||0)),a=y=>{let x=Math.abs(y);return x<1?"\u2014":`${y>0?"+":"-"}$${Math.round(x).toLocaleString()}`},n=(y,x,b,C,w,_,k)=>{let S=(b||0)-(w||0),D,R;k?(D=`<span class="pf-complete-status pf-complete-status--pending" aria-hidden="true">${Rl}</span>`,R="pending"):_?(D=`<span class="pf-complete-status pf-complete-status--pass" aria-hidden="true">${Li}</span>`,R="pass"):(D=`<span class="pf-complete-status pf-complete-status--fail" aria-hidden="true">${Ni}</span>`,R="fail");let T=k?"":`
            <div class="pf-complete-diff ${R}">
                ${a(S)}
            </div>
        `;return`
            <div class="pf-complete-row ${R}">
                <div class="pf-complete-header">
                    ${D}
                    <span class="pf-complete-label">${we(y)}</span>
                </div>
                ${k?`
                <div class="pf-complete-values">
                    <span class="pf-complete-pending-text">Click Run/Refresh to check</span>
                </div>
                `:`
                <div class="pf-complete-values">
                    <div class="pf-complete-value-row">
                        <span class="pf-complete-source">${we(x)}:</span>
                        <span class="pf-complete-amount">${r(b)}</span>
                    </div>
                    <div class="pf-complete-value-row">
                        <span class="pf-complete-source">${we(C)}:</span>
                        <span class="pf-complete-amount">${r(w)}</span>
                    </div>
                </div>
                ${T}
                `}
            </div>
        `},s=e.currentPeriod,i=!t||s===null||s===void 0,o=n("Current Period","PR_Data_Clean Total",s==null?void 0:s.prDataClean,"Calculated Total",s==null?void 0:s.currentTotal,s==null?void 0:s.match,i),l=e.historicalPeriods,c=!t||l===null||l===void 0,f=(l==null?void 0:l.matchedCount)||0,d=(l==null?void 0:l.totalPeriods)||0,h=(l==null?void 0:l.source)==="PR_Archive_Totals"?"PR_Archive_Totals (matched)":"PR_Archive_Summary (matched)",p=d>0?`Historical Periods (${f}/${d} matched)`:"Historical Periods",m=n(p,h,l==null?void 0:l.archiveSum,"Calculated Total",l==null?void 0:l.periodsSum,l==null?void 0:l.match,c),u="";return!c&&((v=l==null?void 0:l.details)==null?void 0:v.length)>0&&(u=`
            <div class="pf-complete-details-section">
                <div class="pf-complete-details-header">Period-by-Period Match</div>
                ${l.details.map(x=>{let b=x.archive===null?Ou:x.match?Li:Ni,C=x.archive!==null?r(x.archive):"Not found";return`
                <div class="pf-complete-detail-row">
                    <span class="pf-complete-detail-date">${we(x.period)}</span>
                    <span class="pf-complete-detail-icon" aria-hidden="true">${b}</span>
                    <span class="pf-complete-detail-vals">${r(x.calculated)} vs ${C}</span>
                </div>
            `}).join("")}
            </div>
        `),`
        <article class="pf-step-card pf-step-detail pf-config-card" id="data-completeness-card">
            <div class="pf-config-head">
                <h3>Data Completeness Check</h3>
                <p class="pf-config-subtext">Verify source data matches calculated totals</p>
            </div>
            <div class="pf-complete-container">
                ${o}
                ${m}
                ${u}
            </div>
        </article>
    `}async function Cb(e=null){console.log("[AdaInsights] Generating insights..."),zr.loading=!0,zr.lastError=null,it();try{let t=await bk();if(zr.contextPack=t,!t.availability.has_pr_data_clean)throw new Error("PR_Data_Clean is required. Run Create Matrix first.");let a=e||"Analyze this payroll period and provide an executive-ready summary. Focus on key drivers, headcount changes, and any risks or anomalies.",n=Tb(t),s=await Hl({userPrompt:`${a}

--- CONTEXT DATA (use ONLY this data) ---
${n}`,contextPack:t,functionContext:"analysis"});zr.response=s,zr.lastRefresh=new Date().toISOString(),zr.loading=!1,console.log("[AdaInsights] Insights generated successfully"),it()}catch(t){console.error("[AdaInsights] Error generating insights:",t),zr.loading=!1,zr.lastError=t.message,it()}}function Tb(e){var s,i,o,l,c,f,d,h,p;let t=m=>typeof m=="number"?`$${m.toLocaleString(void 0,{minimumFractionDigits:2})}`:m,r=m=>typeof m=="number"?`${(m*100).toFixed(1)}%`:m,a="";a+=`PERIOD:
`,a+=`  Current: ${e.period.current_key||"Unknown"}
`,a+=`  Prior: ${e.period.prior_key||"Not available"}
`,a+=`  Basis: ${e.identity.basis_mode}

`,a+=`TOTALS:
`,a+=`  Expense Review Current: ${t(e.totals.expense_review_total_current)}
`,a+=`  Expense Review Prior: ${t(e.totals.expense_review_total_prior)}
`,a+=`  Period-over-Period Change: ${t(e.totals.expense_review_total_current-e.totals.expense_review_total_prior)}
`,e.totals.bank_statement_amount&&(a+=`  Bank Statement: ${t(e.totals.bank_statement_amount)}
`,a+=`  Bank Delta: ${t(e.totals.bank_delta)}
`),a+=`
`,a+=`EXPENSE BUCKETS (Current vs Prior):
`,a+=`  FIXED: ${t(e.drivers.bucket_totals_current.FIXED)} vs ${t(e.drivers.bucket_totals_prior.FIXED)} (\u0394 ${t(e.drivers.bucket_deltas.FIXED)})
`,a+=`  VARIABLE: ${t(e.drivers.bucket_totals_current.VARIABLE)} vs ${t(e.drivers.bucket_totals_prior.VARIABLE)} (\u0394 ${t(e.drivers.bucket_deltas.VARIABLE)})
`,a+=`  BURDEN: ${t(e.drivers.bucket_totals_current.BURDEN)} vs ${t(e.drivers.bucket_totals_prior.BURDEN)} (\u0394 ${t(e.drivers.bucket_deltas.BURDEN)})
`,a+=`
`,((s=e.drivers.top_measure_deltas)==null?void 0:s.length)>0&&(a+=`TOP MEASURE CHANGES (by dollar impact):
`,e.drivers.top_measure_deltas.slice(0,10).forEach((m,u)=>{a+=`  ${u+1}. ${m.pf_column_name}: ${t(m.current_amount)} vs ${t(m.prior_amount)} (\u0394 ${t(m.delta_amount)}) [${m.bucket}]
`}),a+=`
`),((i=e.drivers.department_deltas)==null?void 0:i.length)>0&&(a+=`DEPARTMENT CHANGES (by dollar impact):
`,e.drivers.department_deltas.slice(0,8).forEach((m,u)=>{a+=`  ${u+1}. ${m.department_name}: ${t(m.current_amount)} vs ${t(m.prior_amount)} (\u0394 ${t(m.delta_amount)})
`}),a+=`
`);let n=e.roster_context;if(n&&!n.error){a+=`ROSTER CHANGES:
`,a+=`  Join Key: ${n.join_key_used}
`,((o=n.roster_new_this_period)==null?void 0:o.length)>0&&(a+=`  New This Period (${n.roster_new_this_period.length}):
`,n.roster_new_this_period.slice(0,10).forEach(u=>{a+=`    - ${u.name} (${u.department}) - ${u.note}
`})),((l=n.roster_missing_this_period)==null?void 0:l.length)>0&&(a+=`  Not Seen This Period (${n.roster_missing_this_period.length}):
`,n.roster_missing_this_period.slice(0,10).forEach(u=>{a+=`    - ${u.name} (${u.department}) - ${u.note}
`})),((c=n.roster_reactivated)==null?void 0:c.length)>0&&(a+=`  Reactivations (${n.roster_reactivated.length}):
`,n.roster_reactivated.forEach(u=>{a+=`    - ${u.name} (${u.department}) - ${u.note}
`})),((f=n.roster_department_changes)==null?void 0:f.length)>0&&(a+=`  Department Changes (${n.roster_department_changes.length}):
`,n.roster_department_changes.forEach(u=>{a+=`    - ${u.name}: ${u.previous_department} to ${u.current_department}
`}));let m=Object.keys(n.headcount_delta_by_department||{});m.length>0&&(a+=`
  HEADCOUNT BY DEPARTMENT:
`,m.forEach(u=>{let g=n.headcount_by_department_current[u]||0,v=n.headcount_by_department_prior[u]||0,y=n.headcount_delta_by_department[u]||0,x=n.new_hires_by_department[u]||0,b=n.missing_by_department[u]||0;a+=`    ${u}: ${g} (prior: ${v}, \u0394 ${y>=0?"+":""}${y})`,x>0&&(a+=` [+${x} new]`),b>0&&(a+=` [-${b} missing]`),a+=`
`})),a+=`
`}else n!=null&&n.error&&(a+=`ROSTER: ${n.error}

`);return((d=e.delta_breakdown.top_excluded_by_dollars)==null?void 0:d.length)>0&&(a+=`EXCLUDED FROM TOTALS (top by dollars):
`,e.delta_breakdown.top_excluded_by_dollars.slice(0,5).forEach(m=>{a+=`  - ${m.header}: ${t(m.total)} (${m.reason})
`}),a+=`
`),e.delta_breakdown.total_unclassified>0&&(a+=`UNCLASSIFIED COLUMNS: ${t(e.delta_breakdown.total_unclassified)} total
`,((h=e.metadata.measures_missing_dictionary_metadata)==null?void 0:h.length)>0&&(a+=`  Columns: ${e.metadata.measures_missing_dictionary_metadata.slice(0,5).join(", ")}
`),a+=`
`),a+=`DATA AVAILABILITY:
`,a+=`  PR_Data_Clean: ${e.availability.has_pr_data_clean?"Yes":"No"}
`,a+=`  Archive Totals: ${e.availability.has_archive_totals?"Yes":"No"}
`,a+=`  Archive Summary: ${e.availability.has_archive_summary?"Yes":"No"}
`,a+=`  Employee Roster: ${e.availability.has_employee_roster?"Yes":"No"}
`,a+=`  Prior Period: ${e.availability.has_prior_period?"Yes":"No"}
`,((p=e.availability.error_messages)==null?void 0:p.length)>0&&(a+=`
ERRORS/WARNINGS:
`,e.availability.error_messages.forEach(m=>{a+=`  - ${m}
`})),a}async function Hl(e,t,r){let a,n,s,i;typeof e=="object"&&e!==null&&!Array.isArray(e)&&e.userPrompt!==void 0?{systemPrompt:a,userPrompt:n,contextPack:s,functionContext:i}=e:(n=e,s=t,i="analysis");let o="https://jgciqwzwacaesqjaoadc.supabase.co/functions/v1/copilot",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE",c=Te("SS_Company_ID")||null;try{console.log("[AdaInsights] Calling copilot API...",{module:"payroll-recorder",function:i||"analysis",customerId:c?"set":"not set"});let f=await fetch(o,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`,apikey:l},body:JSON.stringify({prompt:n,context:s,module:"payroll-recorder",function:i||"analysis",customerId:c,...a?{systemPrompt:a}:{}})});if(!f.ok){let h=await f.text();throw console.error("[AdaInsights] API error:",f.status,h),new Error(`API request failed: ${f.status}`)}let d=await f.json();return console.log("[AdaInsights] API response received:",d.usage||"no usage info"),d.message||d.response?d.message||d.response:(console.warn("[AdaInsights] No message in API response, using local generation"),Ku(params))}catch(f){return console.warn("[AdaInsights] API call failed, using local generation:",f),Ku(params)}}function Ku(e){var y,x,b,C,w,_;let t=zr.contextPack;if(!t)return"Unable to generate insights - no context available.";let r=k=>typeof k=="number"?`$${k.toLocaleString(void 0,{minimumFractionDigits:0})}`:k,a="",n=t.totals.expense_review_total_current||0,s=t.totals.expense_review_total_prior||0,i=n-s,o=s?(i/s*100).toFixed(1):0;a+=`## Executive Summary

`,a+=`- **Current period total: ${r(n)}** `,s>0?a+=`(${i>=0?"+":""}${r(i)} / ${o}% vs prior)
`:a+=`(no prior period for comparison)
`;let l=t.roster_context,c=((y=l==null?void 0:l.roster_new_this_period)==null?void 0:y.length)||0,f=((x=l==null?void 0:l.roster_missing_this_period)==null?void 0:x.length)||0;(c>0||f>0)&&(a+=`- Headcount changes: ${c} new employee${c!==1?"s":""}, ${f} not seen this period
`);let d=t.delta_breakdown.total_unclassified||0;d>1e3?a+=`- ${r(d)} in unclassified amounts requires review
`:a+=`- All amounts properly classified
`,a+=`
## Key Drivers

`;let h=t.drivers.bucket_deltas;Object.entries(h).sort((k,S)=>Math.abs(S[1])-Math.abs(k[1])).forEach(([k,S])=>{let D=t.drivers.bucket_totals_current[k]||0;D>0&&(a+=`- **${k}**: ${r(D)}`,Math.abs(S)>100&&(a+=` (${S>=0?"+":""}${r(S)} vs prior)`),a+=`
`)});let m=(t.drivers.top_measure_deltas||[]).filter(k=>Math.abs(k.delta_amount)>500).slice(0,5);m.length>0&&(a+=`
**Top changing measures:**
`,m.forEach(k=>{a+=`- ${k.pf_column_name}: ${r(k.delta_amount)} change
`})),a+=`
## Roster/Headcount Commentary

`,l&&!l.error?(c>0&&(a+=`**New this period (${c}):**
`,l.roster_new_this_period.slice(0,5).forEach(k=>{a+=`- ${k.name} (${k.department}) - first seen this period (likely new hire)
`}),c>5&&(a+=`- ...and ${c-5} more
`)),f>0&&(a+=`
**Not seen this period (${f}):**
`,l.roster_missing_this_period.slice(0,5).forEach(k=>{a+=`- ${k.name} (${k.department}) - not seen this period (may be no-hours)
`}),f>5&&(a+=`- ...and ${f-5} more
`)),((b=l.roster_reactivated)==null?void 0:b.length)>0&&(a+=`
**Reactivations:**
`,l.roster_reactivated.forEach(k=>{a+=`- ${k.name} - was terminated, now appearing in payroll
`})),c===0&&f===0&&!((C=l.roster_reactivated)!=null&&C.length)&&(a+=`No significant headcount changes detected
`)):a+=`Roster data unavailable - ${(l==null?void 0:l.error)||"unknown error"}
`,a+=`
## Risks & Anomalies

`;let u=!1;d>1e3&&(a+=`- **Unclassified amounts**: ${r(d)} - review column classifications
`,u=!0);let g=t.totals.bank_delta;g&&Math.abs(g)>.01&&(a+=`- **Bank reconciliation gap**: ${r(g)}
`,u=!0),Math.abs(o)>15&&(a+=`- **Large period variance**: ${o}% change vs prior period
`,u=!0),u||(a+=`No significant risks or anomalies detected
`),a+=`
## Recommended Next Actions

`;let v=1;return d>1e3&&(a+=`${v++}. Review and classify the ${((w=t.metadata.measures_missing_dictionary_metadata)==null?void 0:w.length)||0} unclassified columns
`),f>0&&(a+=`${v++}. Verify status of ${f} employees not seen this period
`),((_=l==null?void 0:l.roster_reactivated)==null?void 0:_.length)>0&&(a+=`${v++}. Review ${l.roster_reactivated.length} reactivation(s) - confirm employment status
`),Math.abs(o)>10&&s>0&&(a+=`${v++}. Investigate ${Math.abs(o).toFixed(1)}% period-over-period variance
`),v===1&&(a+=`1. Review expense summary and proceed to Journal Entry Prep
`,a+=`2. Archive current period data
`),a+=`${v}. Export journal entry for upload to accounting system
`,a}function Ab(e){switch(e){case 0:return{title:"Configuration",content:`
                    <div class="pf-info-section">
                        <h4>What This Step Does</h4>
                        <p>Sets up the key parameters for your payroll review. Complete this before importing data.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>Key Fields</h4>
                        <ul>
                            <li><strong>Payroll Date</strong> \u2014 The period-end date for this payroll run</li>
                            <li><strong>Accounting Period</strong> \u2014 Shows up in your JE description</li>
                            <li><strong>Journal Entry ID</strong> \u2014 Reference number for your accounting system</li>
                            <li><strong>Provider Link</strong> \u2014 Quick access to your payroll provider portal</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>Tip</h4>
                        <p>The accounting period and JE ID auto-generate based on your payroll date, but you can override them if needed.</p>
                    </div>
                `};case 1:return{title:"Import Payroll Data",content:`
                    <div class="pf-info-section">
                        <h4>What This Step Does</h4>
                        <p>Upload your payroll export, map columns, create the data matrix, and reconcile to your bank statement.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>Column Status Guide</h4>
                        <ul>
                            <li><strong>Saved</strong> \u2014 Previously confirmed mapping, reused automatically</li>
                            <li><strong>Auto</strong> \u2014 Matched from known patterns</li>
                            <li><strong>Review</strong> \u2014 Best guess, please verify</li>
                            <li><strong>Select</strong> \u2014 No match found, choose manually</li>
                        </ul>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.7); margin-top: 8px;">Nothing is saved until you click "Create Matrix".</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>Bank Reconciliation</h4>
                        <p>After creating the matrix, compare your system total to the bank statement amount:</p>
                        <ul>
                            <li><strong>System Total</strong> \u2014 Sum of amount columns in PR_Data_Clean</li>
                            <li><strong>Bank Amount</strong> \u2014 Enter what actually left the bank</li>
                            <li><strong>Difference</strong> \u2014 Should be $0.00 (within $0.01 tolerance)</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>Tip</h4>
                        <p>Column headers don't need to match exactly\u2014the system is flexible with naming. Just make sure each field is present.</p>
                    </div>
                `};case 2:return{title:"Expense Review",content:`
                    <div class="pf-info-section">
                        <h4>What This Step Does</h4>
                        <p>Generates an executive-ready payroll expense summary for CFO review, with period comparisons and trend analysis.</p>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>Data Sources</h4>
                        <ul>
                            <li><strong>PR_Data_Clean</strong> \u2014 Current period payroll data (cleaned and categorized)</li>
                            <li><strong>SS_Employee_Roster</strong> \u2014 Department assignments and employee details</li>
                            <li><strong>PR_Archive_Summary</strong> \u2014 Historical payroll data for trend analysis</li>
                        </ul>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>How Amounts Are Calculated</h4>
                        <table style="width:100%; font-size: 11px; margin-top: 8px; border-collapse: collapse;">
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>Fixed Salary</strong></td>
                                <td style="padding: 6px 0;">Regular wages, salaries, and base pay</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>Variable Salary</strong></td>
                                <td style="padding: 6px 0;">Commissions, bonuses, overtime, and incentive pay</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>Gross Pay</strong></td>
                                <td style="padding: 6px 0;">Fixed + Variable Salary</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>Burden</strong></td>
                                <td style="padding: 6px 0;">Employer taxes (FICA, Medicare, FUTA, SUTA), health insurance, 401(k) match, and other employer-paid benefits</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <td style="padding: 6px 0;"><strong>All-In Total</strong></td>
                                <td style="padding: 6px 0;">Gross Pay + Burden = Total cost to employer</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px 0;"><strong>Burden Rate</strong></td>
                                <td style="padding: 6px 0;">Burden \xF7 All-In Total (typically 10-18%)</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>Report Sections</h4>
                        <ul>
                            <li><strong>Executive Summary</strong> \u2014 Current vs prior period comparison (frozen at top)</li>
                            <li><strong>Department Breakdown</strong> \u2014 Cost allocation by cost center</li>
                            <li><strong>Historical Context</strong> \u2014 Where current metrics fall within historical ranges</li>
                            <li><strong>Period Trends</strong> \u2014 6-period trend chart for Total, Fixed, Variable, Burden, and Headcount</li>
                        </ul>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>Historical Context Visualization</h4>
                        <p>The spectrum bars show where your current period falls relative to your historical min/max:</p>
                        <p style="font-family: Consolas, monospace; color: #6366f1; margin: 8px 0;">Current period is shown as a marker on a low-to-high range.</p>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.7);">Left = Low, Right = High.</p>
                    </div>
                    
                    <div class="pf-info-section">
                        <h4>Review Tips</h4>
                        <ul>
                            <li>Compare <strong>Burden Rate</strong> \u2014 Should be consistent period-to-period (10-18% typical)</li>
                            <li>Watch <strong>Variable Salary</strong> spikes \u2014 May indicate commission/bonus timing</li>
                            <li>Verify <strong>Headcount changes</strong> \u2014 Should align with HR records</li>
                            <li>Flag variances <strong>> 10%</strong> from prior period for follow-up</li>
                        </ul>
                    </div>
                `};case 3:return{title:"Journal Entry",content:`
                    <div class="pf-info-section">
                        <h4>What This Step Does</h4>
                        <p>Generates a balanced journal entry from your payroll data, ready for upload to your accounting system.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>How the JE Works</h4>
                        <p>Maps payroll categories to GL accounts:</p>
                        <ul>
                            <li><strong>Expenses</strong>: Debits to departmental expense accounts</li>
                            <li><strong>Liabilities</strong>: Credits to payable accounts</li>
                            <li><strong>Cash</strong>: Credit to bank account</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>Validation Checks</h4>
                        <ul>
                            <li><strong>Debits = Credits</strong> \u2014 Entry must balance</li>
                            <li><strong>All accounts mapped</strong> \u2014 No unassigned categories</li>
                            <li><strong>Totals match</strong> \u2014 JE ties to PR_Data_Clean</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>Tip</h4>
                        <p>Review the allocation in PR_JE_Draft before exporting. Unmapped rows need GL account assignment.</p>
                    </div>
                `};case 4:return{title:"Archive & Clear",content:`
                    <div class="pf-info-section">
                        <h4>What This Step Does</h4>
                        <p>Creates a backup of your completed payroll run, then resets the workbook so you're ready for the next pay period.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>Step 1: Create Backup</h4>
                        <p>A new workbook opens containing all your payroll tabs. You'll choose where to save it on your computer or shared drive.</p>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 6px;"><em>Tip: Use a consistent naming convention like "Payroll_Archive_2024-01-15"</em></p>
                    </div>
                    <div class="pf-info-section">
                        <h4>Step 2: Update History</h4>
                        <p>The current period's totals are saved to PR_Archive_Summary. This powers the trend charts and completeness checks for future periods.</p>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 6px;"><em>Keeps 5 periods of history \u2014 oldest is removed automatically</em></p>
                    </div>
                    <div class="pf-info-section">
                        <h4>Step 3: Clear Working Data</h4>
                        <p>Data is cleared from the working sheets:</p>
                        <ul>
                            <li>PR_Data_Clean (processed payroll data)</li>
                            <li>PR_Expense_Review (summary & charts)</li>
                            <li>PR_JE_Draft (journal entry lines)</li>
                        </ul>
                        <p style="font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 6px;"><em>Headers are preserved \u2014 only data rows are cleared</em></p>
                    </div>
                    <div class="pf-info-section">
                        <h4>Step 4: Reset for Next Period</h4>
                        <ul>
                            <li>Payroll Date, Accounting Period, JE ID cleared</li>
                            <li>All sign-offs and completion flags reset</li>
                            <li>Notes cleared (unless you locked them)</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>Before You Archive</h4>
                        <ul>
                            <li>JE uploaded to your accounting system</li>
                            <li>All review steps signed off</li>
                            <li>Lock any notes you want to keep</li>
                        </ul>
                    </div>
                `};default:return{title:"Payroll Recorder",content:`
                    <div class="pf-info-section">
                        <h4>Welcome to Payroll Recorder</h4>
                        <p>This module helps you normalize payroll exports, enforce controls, and prep journal entries.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>Workflow Overview</h4>
                        <ol style="margin: 8px 0; padding-left: 20px;">
                            <li>Configure period settings</li>
                            <li>Import payroll data</li>
                            <li>Review headcount alignment</li>
                            <li>Validate against bank</li>
                            <li>Review expense summary</li>
                            <li>Generate journal entry</li>
                            <li>Archive and reset</li>
                        </ol>
                    </div>
                    <div class="pf-info-section">
                        <p>Click a step card to get started, or tap the <strong>Info</strong> button on any step for detailed guidance.</p>
                    </div>
                `}}}Kl(()=>Ib());async function Rb(){if(mt())try{await Excel.run(async e=>{let t=e.workbook.worksheets;t.load("items/name"),await e.sync();let r=t.getItemOrNullObject("SS_PF_Config");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.log("[Payroll] Creating SS_PF_Config sheet..."),r=t.add("SS_PF_Config");let a=["Category","Field","Value","Permanent"],n=r.getRange("A1:D1");n.values=[a],tn(n);let s=[["module-prefix","PR_","payroll-recorder","Y"],["module-prefix","PTO_","pto-accrual","Y"],["module-prefix","SS_","system","Y"],["Run Settings","SS_Company_Name","","Y"],["Run Settings","SS_Company_ID","","Y"]],i=r.getRange(`A2:D${1+s.length}`);i.values=s,await e.sync();let o=r.getRange(`A1:D${1+s.length}`),l=r.tables.add(o,!0);l.name="SS_PF_Config",l.style="TableStyleMedium2",o.format.autofitColumns(),await e.sync(),console.log("[Payroll] SS_PF_Config sheet and table created")}else{let a=e.workbook.tables;if(a.load("items/name"),await e.sync(),!a.items.some(s=>s.name==="SS_PF_Config")){console.log("[Payroll] SS_PF_Config sheet exists but no table - creating table...");let s=r.getUsedRangeOrNullObject();if(s.load("address,rowCount"),await e.sync(),!s.isNullObject&&s.rowCount>0){let i=r.tables.add(s,!0);i.name="SS_PF_Config",i.style="TableStyleMedium2",await e.sync(),console.log("[Payroll] SS_PF_Config table created from existing data")}else{let i=["Category","Field","Value","Permanent"],o=r.getRange("A1:D1");o.values=[i],tn(o);let l=[["module-prefix","PR_","payroll-recorder","Y"],["module-prefix","PTO_","pto-accrual","Y"],["module-prefix","SS_","system","Y"]],c=r.getRange(`A2:D${1+l.length}`);c.values=l,await e.sync();let f=r.getRange(`A1:D${1+l.length}`),d=r.tables.add(f,!0);d.name="SS_PF_Config",d.style="TableStyleMedium2",await e.sync(),console.log("[Payroll] SS_PF_Config table created with defaults")}}}})}catch(e){console.error("[Payroll] Error ensuring config sheet:",e)}}async function Ib(){try{await Rb(),await Fb(),await hd();let e=ro(lr);await to(e.sheetName,e.title,e.subtitle),io(lr,oo(lr,"home",null),{activeView:"home",activeStepId:null,focusedIndex:0}),it()}catch(e){throw console.error("[Payroll] Module initialization failed:",e),e}}async function Fb(){try{await Ys(lr),console.log(`[Payroll] Tab visibility applied for ${lr}`)}catch(e){console.warn("[Payroll] Could not apply tab visibility:",e)}}function it(){var c;let e=document.body;if(!e)return;[".pf-holiday-snow",".pf-holiday-lights"].forEach(f=>{e.querySelectorAll(f).forEach(h=>h.remove())});let r=Et.focusedIndex<=0?"disabled":"",a=Et.focusedIndex>=Pr.length-1?"disabled":"",n=Et.activeView==="config",s=Et.activeView==="step",i=!n&&!s,o=n?Pb():s?nk(Et.activeStepId):Ob();e.innerHTML=`
        <div class="pf-root">
            ${Db(r,a)}
            ${o}
            ${ik()}
        </div>
    `;let l=document.getElementById("pf-info-fab-payroll");if(i)l&&l.remove();else if((c=window.PrairieForge)!=null&&c.mountInfoFab){let f=Ab(Et.activeStepId);PrairieForge.mountInfoFab({title:f.title,content:f.content,buttonId:"pf-info-fab-payroll"})}if(Nb(),lk(),n)ck();else if(s){ed();try{fk(Et.activeStepId)}catch(f){console.warn("Payroll Recorder: failed to bind step interactions",f)}}else ed();uk(),i?ac():ao()}function Db(e,t){return`
        <div class="pf-brand-float" aria-hidden="true">
            <span class="pf-brand-wave"></span>
        </div>
        <header class="pf-banner">
            <div class="pf-nav-bar">
                <button id="nav-prev" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Previous step" ${e}>
                    ${Oi}
                    <span class="sr-only">Previous step</span>
                </button>
                <button id="nav-home" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Home">
                    ${Eu}
                    <span class="sr-only">Module Home</span>
                </button>
                <button id="nav-selector" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Selector">
                    ${bu}
                    <span class="sr-only">Module Selector</span>
                </button>
                <button id="nav-next" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Next step" ${t}>
                    ${Pi}
                    <span class="sr-only">Next step</span>
                </button>
                <div class="pf-nav-divider"></div>
                    <button id="nav-quick-toggle" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Quick Access">
                        ${ku}
                        <span class="sr-only">Quick Access Menu</span>
                    </button>
            </div>
        </header>
    `}function Nb(){let e=document.getElementById("quick-access-modal");e&&e.remove();let t=jl(),r=!!t,a=document.createElement("div");a.id="quick-access-modal",a.className="pf-quick-modal hidden",a.innerHTML=`
        <div class="pf-quick-modal-backdrop" data-close></div>
        <div class="pf-quick-modal-card">
            <div class="pf-quick-modal-header">
                <h3 class="pf-quick-modal-title">Quick Access</h3>
                <button id="quick-access-close" class="pf-quick-modal-close pf-clickable" type="button" aria-label="Close">
                    ${Mi}
                </button>
            </div>
            <div class="pf-quick-modal-items">
                ${r?`
                <a id="nav-provider-link" class="pf-quick-modal-item pf-clickable" href="${we(t)}" target="_blank" rel="noopener">
                    ${Il}
                    <span>Payroll Provider Report</span>
                </a>
                `:""}
                <button id="nav-accounting-software" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Du}
                    <span>Accounting Software</span>
                </button>
                <button id="nav-employee-roster" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Cu}
                    <span>Employee Roster</span>
                </button>
                <button id="nav-chart-of-accounts" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Tu}
                    <span>Chart of Accounts</span>
                </button>
                <button id="nav-config" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Lu}
                    <span>Configuration</span>
                </button>
            </div>
        </div>
    `,document.body.appendChild(a)}function Ob(){return`
        <section class="pf-hero" id="pf-hero">
            <h2 class="pf-hero-title">Payroll Recorder</h2>
            <p class="pf-hero-copy">${vb}</p>
            <p class="pf-hero-hint">${we(Et.statusText||"")}</p>
        </section>
        <section class="pf-step-guide">
            <div class="pf-step-grid">
                ${Pr.map((e,t)=>sk(e,t)).join("")}
            </div>
        </section>
    `}function Pb(){if(!ht.loaded)return`
            <section class="pf-step-guide">
                <article class="pf-step-card pf-step-detail">
                    <p class="pf-step-title">Loading configuration\u2026</p>
                </article>
            </section>
        `;let e=aa[0],t=ln(fn()),r=ln(Te("PR_Accounting_Period")),a=Te("PR_Journal_Entry_ID"),n=Te("SS_Accounting_Software"),s=jl(),i=Te("SS_Company_Name"),o=Te("SS_Company_ID"),l=Te(Mn)||Un(),c=e?Te(e.note):"",f=e?un(e.note):!1,d=(e?Te(e.reviewer):"")||Un(),h=e?ln(Te(e.signOff)):"",p=!!(h||Te(Lr[0]));return`
        <section class="pf-hero" id="pf-config-hero">
            <p class="pf-hero-copy">${we(Vn)} | Step 0</p>
            <h2 class="pf-hero-title">Configuration Setup</h2>
            <p class="pf-hero-copy">Make quick adjustments before every payroll run.</p>
            <p class="pf-hero-hint">${we(Et.statusText||"")}</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Period Data</h3>
                    <p class="pf-config-subtext">Fields in this section may change each period.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Your Name (Used for sign-offs)</span>
                        <input type="text" id="config-user-name" value="${we(l)}" placeholder="Full name">
                    </label>
                    <label class="pf-config-field">
                        <span>Payroll Date</span>
                        <input type="date" id="config-payroll-date" value="${we(t)}">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Period</span>
                        <input type="text" id="config-accounting-period" value="${we(r)}" placeholder="Nov 2025">
                    </label>
                    <label class="pf-config-field">
                        <span>Journal Entry ID</span>
                        <input type="text" id="config-je-id" value="${we(a)}" placeholder="PR-AUTO-YYYY-MM-DD">
                    </label>
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Static Data</h3>
                    <p class="pf-config-subtext">Fields rarely change but should be reviewed.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Company Name</span>
                        <input type="text" id="config-company-name" value="${we(i)}" placeholder="Prairie Forge LLC">
                    </label>
                    <label class="pf-config-field">
                        <span>Company ID <span class="pf-field-hint">(from Prairie Forge CRM)</span></span>
                        <input type="text" id="config-company-id" value="${we(o)}" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                    </label>
                    <label class="pf-config-field">
                        <span>Payroll Provider / Report Location</span>
                        <input type="url" id="config-payroll-provider" value="${we(s)}" placeholder="https://\u2026">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Software / Import Location</span>
                        <input type="url" id="config-accounting-link" value="${we(n)}" placeholder="https://\u2026">
                    </label>
                </div>
            </article>
            ${e?On({textareaId:"config-notes",value:c,permanentId:"config-notes-permanent",isPermanent:f,hintId:"",saveButtonId:"config-notes-save"}):""}
            ${e?Pn({reviewerInputId:"config-reviewer-name",reviewerValue:d,signoffInputId:"config-signoff-date",signoffValue:h,isComplete:p,saveButtonId:"config-signoff-save",completeButtonId:"config-signoff-toggle",prevButtonId:"config-signoff-prev",nextButtonId:"config-signoff-next"}):""}
        </section>
    `}var he={file:null,fileName:"",headers:[],rowCount:0,parsedData:null,analyzing:!1,mappings:null,mappingSource:null,error:null},xr={amountOptions:null,dimensionOptions:null,loading:!1,loaded:!1};async function Lb(){if(!(xr.loaded||xr.loading)){xr.loading=!0,console.log("[Dictionary] Fetching options from database...");try{let e=await an("get_options",{module:lr},"fetchDictionaryOptions");if(e.ok){let t=e.data;xr.amountOptions=t.amount_options||[],xr.dimensionOptions=t.dimension_options||[],xr.loaded=!0,console.log(`[Dictionary] Loaded ${xr.amountOptions.length} amounts, ${xr.dimensionOptions.length} dimensions`)}else console.warn("[Dictionary] Failed to fetch options, using fallbacks"),Ju()}catch(e){console.error("[Dictionary] Error fetching options:",e),Ju()}finally{xr.loading=!1}}}function Ju(){xr.amountOptions=["Wages_Salary_Amount","Wages_Overtime_Amount","Variable_Bonus_Amount","Variable_Commission_Amount","Wages_PTO_Amount","Wages_Hourly_Amount","Wages_Other_Amount","Federal_Taxes_Employee_Amount","State_Taxes_Employee_Amount","FICA_Taxes_Employee_Amount","FICA_Taxes_Employer_Amount","401K_Employee_Amount","401K_Employer_Amount","Health_Employee_Amount","Health_Employer_Amount","Benefits_Employee_Amount","Benefits_Employer_Amount","Taxes_PEO_Employer_Amount","Fees_PEO_Employer_Amount","Workers_Comp_Employer_Amount","Reimbursements_Amount"],xr.dimensionOptions=["Employee_Name","Employee_ID","Department","Department_Code","Department_Name","Location","Cost_Center","Job_Title","Pay_Date","Pay_Period_Start","Pay_Period_End","Check_Number","Pay_Type","Pay_Frequency"],xr.loaded=!0}var nt={measures:null,dimensions:null,loading:!1,loaded:!1};async function id(){var e,t;if(nt.loaded||nt.loading)return nt;nt.loading=!0,console.log("[ExpenseTaxonomy] Fetching taxonomy from database...");try{let r=await an("get_expense_taxonomy",{module:lr},"fetchExpenseTaxonomy");if(r.ok){let a=r.data;console.log(`[ExpenseTaxonomy] API response - measureRowCount: ${((e=a.debug)==null?void 0:e.measureRowCount)||"N/A"}, dimensionRowCount: ${((t=a.debug)==null?void 0:t.dimensionRowCount)||"N/A"}`);let n=a.measures||{};nt.measures={},Object.entries(n).forEach(([o,l])=>{let c=String(o||"").trim().toLowerCase();nt.measures[c]=l}),nt.dimensions=new Set((a.dimensions||[]).map(o=>String(o||"").trim().toLowerCase())),nt.loaded=!0,console.log(`[ExpenseTaxonomy] Loaded ${Object.keys(nt.measures).length} measures, ${nt.dimensions.size} dimensions`),["401k_employer_amount","fees_peo_employer_amount"].forEach(o=>{let l=nt.measures[o];console.log(`[ExpenseTaxonomy] Dictionary contains '${o}': ${l?"YES":"NO"}${l?` (side=${l.side}, bucket=${l.bucket}, include=${l.include})`:""}`)});let i=Object.keys(nt.measures).slice(0,10);console.log(`[ExpenseTaxonomy] Sample measure keys: ${i.join(", ")}`)}else console.warn("[ExpenseTaxonomy] Failed to fetch taxonomy, using fallbacks"),qu()}catch(r){console.error("[ExpenseTaxonomy] Error fetching taxonomy:",r),qu()}finally{nt.loading=!1}return nt}function qu(){nt.measures={wages_salary_amount:{bucket:"FIXED",include:!0,sign:1,displayOrder:10,side:"er"},regular_pay_amount:{bucket:"FIXED",include:!0,sign:1,displayOrder:10,side:"er"},pto_amount:{bucket:"FIXED",include:!0,sign:1,displayOrder:15,side:"er"},sick_pay_amount:{bucket:"FIXED",include:!0,sign:1,displayOrder:15,side:"er"},holiday_pay_amount:{bucket:"FIXED",include:!0,sign:1,displayOrder:15,side:"er"},overtime_amount:{bucket:"VARIABLE",include:!0,sign:1,displayOrder:20,side:"er"},bonus_amount:{bucket:"VARIABLE",include:!0,sign:1,displayOrder:20,side:"er"},commission_amount:{bucket:"VARIABLE",include:!0,sign:1,displayOrder:20,side:"er"},employer_taxes_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:30,side:"er"},fica_employer_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:30,side:"er"},medicare_employer_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:30,side:"er"},futa_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:30,side:"er"},suta_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:30,side:"er"},health_insurance_employer_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:35,side:"er"},"401k_match_amount":{bucket:"BURDEN",include:!0,sign:1,displayOrder:35,side:"er"},"401k_employer_amount":{bucket:"BURDEN",include:!0,sign:1,displayOrder:35,side:"er"},benefits_employer_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:35,side:"er"},fees_peo_employer_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:36,side:"er"},workers_comp_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:37,side:"er"},disability_employer_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:38,side:"er"},life_insurance_employer_amount:{bucket:"BURDEN",include:!0,sign:1,displayOrder:39,side:"er"},federal_withholding_amount:{bucket:"TAX",include:!1,sign:-1,displayOrder:40,side:"ee"},state_withholding_amount:{bucket:"TAX",include:!1,sign:-1,displayOrder:40,side:"ee"},fica_employee_amount:{bucket:"TAX",include:!1,sign:-1,displayOrder:40,side:"ee"},medicare_employee_amount:{bucket:"TAX",include:!1,sign:-1,displayOrder:40,side:"ee"},"401k_employee_amount":{bucket:"DEDUCTION",include:!1,sign:-1,displayOrder:50,side:"ee"},net_pay_amount:{bucket:"OTHER",include:!1,sign:1,displayOrder:90,side:"na"},gross_pay_amount:{bucket:"OTHER",include:!1,sign:1,displayOrder:90,side:"na"}},nt.dimensions=new Set(["employee_name","employee_id","department","department_code","department_name","location","cost_center","job_title","pay_date","payroll_date","pay_period_start","pay_period_end","check_number","pay_type","pay_frequency"]),nt.loaded=!0}var ji=new Set(["gross_pay_amount","net_pay_amount"]);function Fa(e){if(!e)return"OTHER";switch(String(e).toUpperCase().trim()){case"FIXED":case"BASE":case"SALARY":case"WAGES":return"FIXED";case"VARIABLE":case"BONUS":case"COMMISSION":return"VARIABLE";case"BURDEN":case"EMPLOYER_TAX":case"PAYROLL_TAX":return"BURDEN";case"BENEFIT":case"BENEFITS":case"EMPLOYER_BENEFIT":return"BENEFIT";case"TAX":case"TAXES":return"TAX";case"DEDUCTION":case"DEDUCTIONS":return"DEDUCTION";case"REIMBURSEMENT":case"REIMBURSEMENTS":case"EXPENSE":return"REIMBURSEMENT";default:return"OTHER"}}function Vl(e,t="",r=null){if(t&&ji.has(t))return{include:!1,reason:"summary_exclusion",bucket:null};if(r){let s=(r.expense_bucket||"").toUpperCase();return s==="EXCLUDE"?{include:!1,reason:"expense_bucket=EXCLUDE",bucket:null}:["FIXED","VARIABLE","BURDEN","BENEFITS","BENEFIT","TAX","REIMBURSEMENT","OTHER"].includes(s)?{include:!0,reason:null,bucket:s}:s?{include:!0,reason:null,bucket:s||"UNCLASSIFIED"}:{include:!1,reason:"no_expense_bucket",bucket:null}}if(!e)return{include:!0,reason:null,bucket:"UNCLASSIFIED"};if(e.include===!1)return{include:!1,reason:"include=false",bucket:null};let a=String(e.side||"").toLowerCase().trim();return a==="ee"?{include:!1,reason:"side='ee'",bucket:null}:a==="na"?{include:!1,reason:"side='na'",bucket:null}:{include:!0,reason:null,bucket:Fa(e.bucket)}}function $b(){var i,o,l;let e=document.getElementById("upload-dropzone"),t=document.getElementById("upload-file-input"),r=document.getElementById("upload-browse-btn"),a=document.getElementById("upload-clear-btn"),n=document.getElementById("ada-analyze-btn"),s=document.getElementById("mapping-apply-btn");e&&(e.addEventListener("dragover",c=>{c.preventDefault(),c.stopPropagation(),e.classList.add("pf-upload-zone--dragover")}),e.addEventListener("dragleave",c=>{c.preventDefault(),c.stopPropagation(),e.classList.remove("pf-upload-zone--dragover")}),e.addEventListener("drop",c=>{var d;c.preventDefault(),c.stopPropagation(),e.classList.remove("pf-upload-zone--dragover");let f=(d=c.dataTransfer)==null?void 0:d.files;(f==null?void 0:f.length)>0&&Zu(f[0])}),e.addEventListener("click",()=>{t==null||t.click()})),t==null||t.addEventListener("change",c=>{var d;let f=(d=c.target.files)==null?void 0:d[0];f&&Zu(f)}),r==null||r.addEventListener("click",c=>{c.stopPropagation(),t==null||t.click()}),a==null||a.addEventListener("click",()=>{Mb(),it()}),n==null||n.addEventListener("click",()=>{od()}),s==null||s.addEventListener("click",()=>{Vb()}),(i=document.getElementById("mapping-open-modal-btn"))==null||i.addEventListener("click",()=>Ps()),(o=document.getElementById("mapping-open-modal-btn-review"))==null||o.addEventListener("click",()=>Ps()),(l=document.getElementById("mapping-open-modal-btn-unmapped"))==null||l.addEventListener("click",()=>Ps()),document.querySelectorAll(".pf-mapping-select").forEach(c=>{c.addEventListener("change",f=>{var u,g;let d=parseInt(f.target.dataset.index),h=f.target.value,p=f.target.selectedOptions[0],m=((u=p==null?void 0:p.dataset)==null?void 0:u.kind)||"amount";if((g=he.mappings)!=null&&g[d]){let v=he.mappings[d];h?(v.target=h,v.kind=m,v.source="user_manual",v.confidence=1,v.manual_override=!0):(v.target=null,v.kind=null,v.source="unmapped",v.confidence=0),it()}})}),document.querySelectorAll(".pf-ambiguous-btn").forEach(c=>{c.addEventListener("click",f=>{var m;let d=parseInt(f.target.dataset.index),h=f.target.dataset.choice,p=f.target.dataset.target;if((m=he.mappings)!=null&&m[d]){let u=he.mappings[d];h==="amount"&&u.amount_option?(u.target=u.amount_option.target,u.kind="amount",u.source="amount",u.confidence=u.amount_option.confidence):h==="dimension"&&u.dimension_option?(u.target=u.dimension_option.target,u.kind="dimension",u.source="dimension",u.confidence=u.dimension_option.confidence):h==="skip"&&(u.target=null,u.kind=null,u.source="unmapped",u.confidence=0),u.amount_option=null,u.dimension_option=null,u.manual_override=!0,u.confirmed=!0,it()}})})}function Mb(){he.file=null,he.fileName="",he.headers=[],he.rowCount=0,he.parsedData=null,he.analyzing=!1,he.mappings=null,he.mappingSource=null,he.error=null}async function Zu(e){let t=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],r=[".csv",".xlsx",".xls"],a=e.name.toLowerCase().slice(e.name.lastIndexOf("."));if(!r.includes(a)&&!t.includes(e.type)){he.error="Please upload a CSV or Excel file (.csv, .xlsx, .xls)",it();return}he.error=null,he.fileName=e.name,he.file=e;try{let n=await Bb(e);if(!n||n.length<2){he.error="File appears empty or has no data rows.",it();return}let s=n[0].map(l=>String(l||"").trim()),i=[];for(let l=0;l<s.length;l++){let c=s[l],f=n.slice(1).some(d=>String(d[l]||"").trim()!=="");(c!==""||f)&&i.push(l)}let o=n.map(l=>i.map(c=>l[c]));he.headers=o[0].map(l=>String(l||"").trim()),he.rowCount=o.length-1,he.parsedData=o,he.mappings=null,he.mappingSource=null,console.log(`[Upload] Parsed ${he.headers.length} columns, ${he.rowCount} rows`),console.log("[Upload] Headers:",he.headers),it(),await od(),Ps()}catch(n){console.error("[Upload] Parse error:",n),he.error=`Failed to parse file: ${n.message}`,it()}}async function Bb(e){return new Promise((t,r)=>{let a=new FileReader;a.onload=n=>{try{let s=n.target.result,i=_i(s,{type:"array"}),o=i.SheetNames[0];if(!o){r(new Error("No sheets found in workbook"));return}let l=i.Sheets[o],c=Wr.sheet_to_json(l,{header:1,defval:"",blankrows:!1});t(c)}catch(s){r(s)}},a.onerror=()=>r(new Error("Failed to read file")),a.readAsArrayBuffer(e)})}async function od(){if(!he.headers.length){Ie("No file uploaded yet.","error");return}he.analyzing=!0,he.error=null,it();try{await Lb();let e=Te("SS_Company_ID");console.log("[Ada] Starting analysis with:",{headers:he.headers,companyId:e,module:lr});let t=he.headers.slice(0,3).join(", "),r=e?e.substring(0,8)+"...":"NOT SET";Ie(`Analyzing: ${t}... (Company: ${r})`,"info");let a=await an("analyze",{headers:he.headers,crm_company_id:e||null,module:lr},"analyzeColumns");if(!a.ok)throw new Error(`API error: ${a.status} - ${a.error}`);let n=a.data;if(console.log("[Ada] Column analysis complete:",n),!(n.mappings&&n.mappings.length>0&&Object.hasOwn(n.mappings[0],"kind"))&&n.mappings&&n.mappings.length>0){console.warn("[Ada] Received old API format - check Edge Function deployment"),Ie("Mapping returned an unexpected format. Please retry or contact support.","error"),he.analyzing=!1,it();return}he.mappings=(n.mappings||[]).map(f=>{let d=f.include_in_matrix;return d==="false"||d===!1?d=!1:d=!0,{raw_header:f.raw_header,kind:f.kind,target:f.target,source:f.source,confidence:f.confidence||0,gl_account:f.gl_account||null,gl_account_name:f.gl_account_name||null,include_in_matrix:d,expense_bucket:f.expense_bucket||null,amount_option:f.amount_option||null,dimension_option:f.dimension_option||null,confirmed:!1,manual_override:!1}}),he.mappingSource=a.source||"dictionary",he.analyzing=!1;let i=a.matched||0,o=a.unmapped||0,l=a.ambiguous||0,c=(a.fuzzy||0)+l;c>0?Ie(`Auto-mapped ${i} of ${a.total} columns. ${c} need review.`,"info"):Ie(`Auto-mapped ${i} of ${a.total} columns. ${o} unmapped.`,"success"),it()}catch(e){console.error("[Ada] Analysis failed:",e),he.analyzing=!1,he.mappings=Ub(he.headers),he.mappingSource="local_fallback",he.error="Couldn't connect to mapping service. Using basic auto-detection.",it()}}function Ub(e){let t={employee:{target:"Employee_Name",kind:"dimension"},name:{target:"Employee_Name",kind:"dimension"},"emp name":{target:"Employee_Name",kind:"dimension"},"employee name":{target:"Employee_Name",kind:"dimension"},worker:{target:"Employee_Name",kind:"dimension"},department:{target:"Department",kind:"dimension"},dept:{target:"Department",kind:"dimension"},division:{target:"Department",kind:"dimension"},"cost center":{target:"Cost_Center",kind:"dimension"},location:{target:"Location",kind:"dimension"},"pay date":{target:"Pay_Date",kind:"dimension"},"check date":{target:"Pay_Date",kind:"dimension"},regular:{target:"Wages_Salary_Amount",kind:"amount"},"regular wages":{target:"Wages_Salary_Amount",kind:"amount"},"regular pay":{target:"Wages_Salary_Amount",kind:"amount"},"base pay":{target:"Wages_Salary_Amount",kind:"amount"},salary:{target:"Wages_Salary_Amount",kind:"amount"},overtime:{target:"Wages_Overtime_Amount",kind:"amount"},ot:{target:"Wages_Overtime_Amount",kind:"amount"},"overtime pay":{target:"Wages_Overtime_Amount",kind:"amount"},"ot earns":{target:"Wages_Overtime_Amount",kind:"amount"},bonus:{target:"Variable_Bonus_Amount",kind:"amount"},"bonus earns":{target:"Variable_Bonus_Amount",kind:"amount"},commission:{target:"Variable_Commission_Amount",kind:"amount"},"commission earns":{target:"Variable_Commission_Amount",kind:"amount"},commissions:{target:"Variable_Commission_Amount",kind:"amount"},federal:{target:"Federal_Withholding_Amount",kind:"amount"},"fed tax":{target:"Federal_Withholding_Amount",kind:"amount"},"federal tax":{target:"Federal_Withholding_Amount",kind:"amount"},"federal withholding":{target:"Federal_Withholding_Amount",kind:"amount"},state:{target:"State_Withholding_Amount",kind:"amount"},"state tax":{target:"State_Withholding_Amount",kind:"amount"},"state withholding":{target:"State_Withholding_Amount",kind:"amount"},fica:{target:"FICA_Employee_Amount",kind:"amount"},"social security":{target:"FICA_Employee_Amount",kind:"amount"},ss:{target:"FICA_Employee_Amount",kind:"amount"},medicare:{target:"Medicare_Employee_Amount",kind:"amount"},"401k":{target:"401K_Employee_Amount",kind:"amount"},"401(k)":{target:"401K_Employee_Amount",kind:"amount"},retirement:{target:"401K_Employee_Amount",kind:"amount"},health:{target:"Health_Insurance_Amount",kind:"amount"},"health insurance":{target:"Health_Insurance_Amount",kind:"amount"},medical:{target:"Health_Insurance_Amount",kind:"amount"},dental:{target:"Dental_Insurance_Amount",kind:"amount"},vision:{target:"Vision_Insurance_Amount",kind:"amount"},hsa:{target:"HSA_Employee_Amount",kind:"amount"},"employee id":{target:"Employee_ID",kind:"dimension"},"emp id":{target:"Employee_ID",kind:"dimension"},job:{target:"Job_Title",kind:"dimension"},"job title":{target:"Job_Title",kind:"dimension"},title:{target:"Job_Title",kind:"dimension"},position:{target:"Job_Title",kind:"dimension"}};return e.map(r=>{let a=r.toLowerCase().trim(),n=null,s=.5;if(t[a])n=t[a],s=.9;else for(let[i,o]of Object.entries(t))if(a.includes(i)||i.includes(a)){n=o,s=.7;break}return{raw_header:r,kind:n?n.kind:null,target:n?n.target:null,source:n?"local_fallback":"unmapped",confidence:n?s:0,gl_account:null,gl_account_name:null,amount_option:null,dimension_option:null,confirmed:!1,manual_override:!1}})}async function ld(e,t){try{let r={action:"save",company_id:e,module:lr,mappings:t.map(n=>({raw_header:n.raw_header,target:n.target,kind:n.kind}))};console.log("[Mappings] Saving:",r);let a=await an("save",{crm_company_id:r.company_id,module:r.module,mappings:r.mappings},"saveMappings");a.ok?console.log("[Mappings] Saved successfully:",a.data):console.warn("[Mappings] Failed to save:",a.status,a.error)}catch(r){console.warn("[Mappings] Save error (non-blocking):",r)}}var Hb=["Employee_Name"],Qu=["Pay_Date","Pay_Period_Start","Pay_Period_End","Employee_Name","Employee_ID","Department","Department_Code","Department_Name","Location","Cost_Center","Job_Title","Check_Number","Pay_Type","Pay_Frequency"];async function Vb(){if(console.log("[CreateMatrix] Starting matrix creation..."),!he.parsedData||he.parsedData.length<2){Ie("Upload data first. No file has been uploaded.","error"),console.warn("[CreateMatrix] No parsed data available");return}if(!he.mappings||he.mappings.length===0){Ie("Confirm mappings first.","error"),console.warn("[CreateMatrix] No mappings available");return}console.log("[CreateMatrix] Mapping include_in_matrix values:",he.mappings.map(n=>({raw_header:n.raw_header,include_in_matrix:n.include_in_matrix,type:typeof n.include_in_matrix})));let e=he.mappings.filter(n=>!n.target||n.kind!=="amount"&&n.kind!=="dimension"?!1:n.include_in_matrix===!1||n.include_in_matrix==="false"?(console.log(`[CreateMatrix] Excluding ${n.raw_header}: include_in_matrix=${n.include_in_matrix} (${typeof n.include_in_matrix})`),!1):!0).map(n=>({raw_header:n.raw_header,target:n.target,kind:n.kind,sourceIndex:he.headers.indexOf(n.raw_header),gl_account:n.gl_account,gl_account_name:n.gl_account_name,expense_bucket:n.expense_bucket||null})),t=he.mappings.filter(n=>n.include_in_matrix===!1||n.include_in_matrix==="false");if(t.length>0&&console.log(`[CreateMatrix] Excluding ${t.length} columns (include_in_matrix=false):`,t.map(n=>n.raw_header)),e.length===0){Ie("Please select at least one column mapping.","error"),console.warn("[CreateMatrix] No valid mappings selected");return}let r=he.mappings.filter(n=>n.kind==="ambiguous").length;if(r>0){Ie(`Please resolve ${r} ambiguous mapping(s) before creating matrix.`,"error"),console.warn("[CreateMatrix] Unresolved ambiguous mappings:",r);return}let a=jb(e);if(a.length>0){Ie(`Mapping incomplete: missing required fields: ${a.join(", ")}`,"error"),console.warn("[CreateMatrix] Missing required fields:",a);return}Ie("Creating matrix...","info",1e4);try{let n=zb(e);console.log("[CreateMatrix] Built output data:",{headers:n[0],rowCount:n.length-1,columnCount:n[0].length}),await Xb(n),Rk();let s=Te("SS_Company_ID");s&&await ld(s,e),console.log("[CreateMatrix] Refreshing validation checks..."),await wd(),await bd(),await Td();try{await Uk()}catch(i){console.warn("[RosterRates] Advisory update failed (non-blocking):",i)}Ie(`Matrix created successfully! ${n.length-1} rows written to PR_Data_Clean.`,"success"),console.log("[CreateMatrix] Complete"),it()}catch(n){console.error("[CreateMatrix] Failed:",n),Ie(`Failed to create matrix: ${n.message}`,"error")}}function jb(e){let t=new Set(e.map(a=>a.target)),r=[];for(let a of Hb)t.has(a)||r.push(a);return r}var Wb=["total","totals","summary","subtotal","subtotals","grand total","grand totals"];function Gb(e){if(!e)return!0;let t=String(e).toLowerCase().trim();return t?Wb.some(r=>t.includes(r)):!0}function zb(e){let t=he.parsedData,r=t[0],a=e.filter(m=>m.kind==="dimension"),n=e.filter(m=>m.kind==="amount"),s=a.sort((m,u)=>{let g=Qu.indexOf(m.target),v=Qu.indexOf(u.target);return g===-1&&v===-1?m.target.localeCompare(u.target):g===-1?1:v===-1?-1:g-v}),i=n.sort((m,u)=>m.target.localeCompare(u.target)),o=[...s,...i],l=o.map(m=>m.target),c=o.map(m=>m.sourceIndex),f=e.find(m=>m.target==="Employee_Name"),d=f?f.sourceIndex:-1;console.log("[BuildCleanDataset] Ordered mappings:",o.map(m=>({target:m.target,kind:m.kind,sourceIndex:m.sourceIndex}))),console.log("[BuildCleanDataset] Employee_Name source index:",d);let h=[];h.push(l);let p=0;for(let m=1;m<t.length;m++){let u=t[m],g=d>=0?u[d]:u[0];if(Gb(g)){p++;continue}let v=c.map(y=>{if(y===-1||y===null||y===void 0)return"";let x=u[y];return x==null?"":x});h.push(v)}return console.log("[BuildCleanDataset] Output stats:",{headerCount:l.length,dataRowCount:h.length-1,skippedRows:p,dimensions:s.length,amounts:i.length}),h}async function Xb(e){if(!e||e.length===0)throw new Error("No data to write");let t=Fe.DATA_CLEAN,r=e.length,a=e[0].length;console.log(`[WriteToDataClean] Writing ${r} rows x ${a} columns to ${t}`),await Excel.run(async n=>{let s=n.workbook.worksheets.getItemOrNullObject(t);if(s.load("isNullObject"),await n.sync(),s.isNullObject)console.log(`[WriteToDataClean] Creating new sheet: ${t}`),s=n.workbook.worksheets.add(t),await n.sync();else{console.log(`[WriteToDataClean] Clearing existing sheet: ${t}`);let l=s.getUsedRangeOrNullObject();l.load("isNullObject"),await n.sync(),l.isNullObject||(l.clear(),await n.sync())}let i=s.getRangeByIndexes(0,0,r,a);i.values=e;let o=s.getRangeByIndexes(0,0,1,a);o.format.font.bold=!0,o.format.fill.color="#4C2FFF",o.format.font.color="#FFFFFF",s.freezePanes.freezeRows(1),i.format.autofitColumns(),s.activate(),await n.sync(),console.log(`[WriteToDataClean] Successfully wrote ${r} rows to ${t}`)})}function Yb(){let e=he.file||he.headers.length>0;return he.analyzing?`
            <div class="pf-upload-zone pf-upload-zone--analyzing">
                <div class="pf-upload-spinner"></div>
                <p class="pf-upload-status">Analyzing your columns\u2026</p>
            </div>
        `:e?`
            <div class="pf-upload-zone pf-upload-zone--ready">
                <div class="pf-upload-file-info">
                    <svg class="pf-upload-file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                    </svg>
                    <div class="pf-upload-file-details">
                        <span class="pf-upload-filename">${we(he.fileName)}</span>
                        <span class="pf-upload-meta">${he.headers.length} columns \u2022 ${he.rowCount.toLocaleString()} rows</span>
                    </div>
                    <button type="button" class="pf-upload-clear" id="upload-clear-btn" title="Remove file">\xD7</button>
                </div>
            </div>
        `:`
        <div class="pf-upload-zone" id="upload-dropzone">
            <input type="file" id="upload-file-input" accept=".csv,.xlsx,.xls" hidden>
            <div class="pf-upload-content">
                <svg class="pf-upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="17 8 12 3 7 8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
                <p class="pf-upload-text">Drop your payroll file here</p>
                <p class="pf-upload-hint">or <button type="button" class="pf-upload-browse" id="upload-browse-btn">browse</button> to upload</p>
                <p class="pf-upload-formats">Supports CSV, XLSX, XLS</p>
            </div>
        </div>
    `}function Kb(){if(!he.mappings||he.mappings.length===0)return"";let e=he.mappings.filter(o=>o.include_in_matrix!==!1&&o.include_in_matrix!=="false"),t=e.length,r=e.filter(o=>o.target&&o.kind!=="ambiguous").length,a=e.filter(o=>o.kind==="ambiguous"||o.source==="fuzzy"&&o.target).length,n=e.filter(o=>!o.target||o.source==="unmapped").length,s=he.mappingSource==="saved"?"Saved":(he.mappingSource==="local_fallback","Auto"),i="";return a>0||n>0?i='<span class="pf-status-badge pf-status-badge--review" role="status"><span>Review</span></span>':i='<span class="pf-status-badge pf-status-badge--ok" role="status"><span>Ready</span></span>',`
        <article class="pf-step-card pf-step-detail pf-config-card pf-mapping-status-card">
            <div class="pf-config-head">
                <h3>Column Mapping ${i}</h3>
                <p class="pf-config-subtext">${s} \u2014 ${r} of ${t} mapped</p>
            </div>
            <div class="pf-mapping-expand-bars">
                <button type="button" class="pf-expand-bar pf-expand-bar--success pf-clickable" id="mapping-open-modal-btn">
                    <svg class="pf-expand-bar-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                        <polyline points="6 9 12 15 18 9"/>
                    </svg>
                    <span class="pf-expand-bar-count">${r}</span>
                    <span class="pf-expand-bar-label">mapped</span>
                </button>
                ${a>0?`
                    <button type="button" class="pf-expand-bar pf-expand-bar--warning pf-clickable" id="mapping-open-modal-btn-review">
                        <svg class="pf-expand-bar-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                            <polyline points="6 9 12 15 18 9"/>
                        </svg>
                        <span class="pf-expand-bar-count">${a}</span>
                        <span class="pf-expand-bar-label">to review</span>
                    </button>
                `:""}
                ${n>0?`
                    <button type="button" class="pf-expand-bar pf-expand-bar--muted pf-clickable" id="mapping-open-modal-btn-unmapped">
                        <svg class="pf-expand-bar-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                            <polyline points="6 9 12 15 18 9"/>
                        </svg>
                        <span class="pf-expand-bar-count">${n}</span>
                        <span class="pf-expand-bar-label">to select</span>
                    </button>
                `:""}
            </div>
            <div class="pf-mapping-actions pf-mapping-actions--cta">
                <button type="button" class="pf-cta-button pf-clickable" id="mapping-apply-btn" title="Create the data matrix">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                        <path d="M3 9h18"/>
                        <path d="M3 15h18"/>
                        <path d="M9 3v18"/>
                        <path d="M15 3v18"/>
                    </svg>
                    <span>Create Matrix</span>
                </button>
            </div>
        </article>
    `}function Ps(){var h;let e=document.getElementById("column-mapping-modal");if(e&&e.remove(),!he.mappings||he.mappings.length===0){Ie("No mappings to edit.","info");return}let t=he.mappings.filter(p=>p.include_in_matrix!==!1&&p.include_in_matrix!=="false"),r=he.mappings.length-t.length;r>0&&console.log(`[MappingUI] Hiding ${r} columns with include_in_matrix=false`);let a=he.mappingSource==="saved"?"Using your saved mappings":"Auto-mapped columns",n=t.map((p,m)=>{let u=he.mappings.indexOf(p),g="",v="pf-mapping-row";return p.kind==="ambiguous"?(g='<span class="pf-pill pf-pill--warning">Review</span>',v+=" pf-mapping-row--ambiguous"):p.source==="unmapped"||!p.target?(g='<span class="pf-pill pf-pill--neutral">Select</span>',v+=" pf-mapping-row--unmapped"):p.source==="fuzzy"||p.confidence<.9?(g='<span class="pf-pill pf-pill--warning">Review</span>',v+=" pf-mapping-row--low-conf"):p.source==="saved"?(g='<span class="pf-pill pf-pill--success">Saved</span>',v+=" pf-mapping-row--saved"):g='<span class="pf-pill pf-pill--success">Auto</span>',`
            <div class="${v}" data-index="${u}">
                <span class="pf-mapping-raw">${we(p.raw_header)}</span>
                <span class="pf-mapping-arrow">to</span>
                ${p.kind==="ambiguous"?qb(p,u):`
                    <select class="pf-mapping-select" data-index="${u}" data-raw="${we(p.raw_header)}">
                        <option value="">Skip this column</option>
                        ${Zb(p.target,p.kind)}
                    </select>
                `}
                ${g}
            </div>
        `}).join(""),s=t.filter(p=>p.target&&p.kind!=="ambiguous").length,i=t.filter(p=>p.kind==="ambiguous"||p.source==="fuzzy"&&p.target).length,o=t.filter(p=>!p.target||p.source==="unmapped").length,l=t.length,c=he.mappings.some(p=>p.manual_override),f=document.createElement("div");f.id="column-mapping-modal",f.className="pf-mapping-modal",f.innerHTML=`
        <div class="pf-mapping-modal-backdrop" data-close></div>
        <div class="pf-mapping-modal-card">
            <div class="pf-mapping-modal-header">
                <div>
                    <h3 class="pf-mapping-modal-title">Column Mapping</h3>
                    <p class="pf-mapping-modal-subtext">${a}. Review and adjust as needed.</p>
                </div>
                <button class="pf-coverage-modal-close pf-clickable" type="button" aria-label="Close" data-close>
                    ${Mi}
                </button>
            </div>
            <div class="pf-mapping-modal-summary">
                <span class="pf-summary-item">${s} of ${l} mapped</span>
                ${i>0?`<span class="pf-summary-item pf-summary--warning">${i} to review</span>`:""}
                ${o>0?`<span class="pf-summary-item pf-summary--muted">${o} to select</span>`:""}
            </div>
            <div class="pf-mapping-modal-body">
                <div class="pf-mapping-grid">
                    ${n}
                </div>
            </div>
            <div class="pf-mapping-modal-footer">
                <button type="button" class="pf-pill-btn pf-pill-btn--primary ${c?"pf-clickable":""}" id="modal-mapping-save-btn" ${c?"":"disabled"}>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                        <polyline points="17 21 17 13 7 13 7 21"/>
                        <polyline points="7 3 7 8 15 8"/>
                    </svg>
                    <span>Save</span>
                </button>
            </div>
        </div>
    `,document.body.appendChild(f),f.querySelectorAll("[data-close]").forEach(p=>{p.addEventListener("click",()=>Os())}),(h=f.querySelector("#modal-mapping-save-btn"))==null||h.addEventListener("click",async()=>{var u,g;let p=((u=ht.values)==null?void 0:u.SS_Company_ID)||((g=ht.values)==null?void 0:g.company_id);if(!p){Ie("Company ID not found. Save mappings after configuration is complete.","info"),Os();return}let m=he.mappings.filter(v=>v.target&&v.kind);m.length>0&&(await ld(p,m),Ie(`Saved ${m.length} column mapping(s).`,"success")),Os()}),f.querySelectorAll(".pf-mapping-select").forEach(p=>{p.addEventListener("change",m=>{var x,b;let u=parseInt(m.target.dataset.index,10),g=m.target.value,v=(x=m.target.selectedOptions)==null?void 0:x[0],y=((b=v==null?void 0:v.dataset)==null?void 0:b.kind)||null;he.mappings[u]&&(he.mappings[u].target=g||null,he.mappings[u].kind=g?y:null,he.mappings[u].manual_override=!0,he.mappings[u].source=g?"manual":"unmapped",Jb())})}),f.querySelectorAll(".pf-ambiguous-btn").forEach(p=>{p.addEventListener("click",m=>{let u=parseInt(p.dataset.index,10),g=p.dataset.choice,v=p.dataset.target;he.mappings[u]&&(g==="skip"?(he.mappings[u].target=null,he.mappings[u].kind=null,he.mappings[u].source="unmapped"):g==="amount"?(he.mappings[u].target=v,he.mappings[u].kind="amount",he.mappings[u].source="manual"):g==="dimension"&&(he.mappings[u].target=v,he.mappings[u].kind="dimension",he.mappings[u].source="manual"),he.mappings[u].manual_override=!0,Os(),Ps())})});let d=p=>{p.key==="Escape"&&(Os(),document.removeEventListener("keydown",d))};document.addEventListener("keydown",d)}function Os(){let e=document.getElementById("column-mapping-modal");e&&e.remove(),it()}function Jb(){let e=document.getElementById("column-mapping-modal");if(!e)return;let t=he.mappings.filter(o=>o.target&&o.kind!=="ambiguous").length,r=he.mappings.filter(o=>o.kind==="ambiguous"||o.source==="fuzzy"&&o.target).length,a=he.mappings.filter(o=>!o.target||o.source==="unmapped").length,n=he.mappings.length,s=e.querySelector(".pf-mapping-modal-summary");s&&(s.innerHTML=`
            <span class="pf-summary-item">${t} of ${n} mapped</span>
            ${r>0?`<span class="pf-summary-item pf-summary--warning">${r} to review</span>`:""}
            ${a>0?`<span class="pf-summary-item pf-summary--muted">${a} to select</span>`:""}
        `);let i=e.querySelector("#modal-mapping-save-btn");if(i){let o=he.mappings.some(l=>l.manual_override);i.disabled=!o,o?i.classList.add("pf-clickable"):i.classList.remove("pf-clickable")}}function qb(e,t){var n,s;let r=((n=e.amount_option)==null?void 0:n.target)||"Option 1",a=((s=e.dimension_option)==null?void 0:s.target)||"Option 2";return`
        <div class="pf-ambiguous-options">
            <button type="button" class="pf-ambiguous-btn pf-ambiguous-btn--primary" 
                    data-index="${t}" data-choice="amount" data-target="${we(r)}">
                ${we(sn(r))}
            </button>
            <button type="button" class="pf-ambiguous-btn pf-ambiguous-btn--secondary" 
                    data-index="${t}" data-choice="dimension" data-target="${we(a)}">
                ${we(sn(a))}
            </button>
            <button type="button" class="pf-ambiguous-btn pf-ambiguous-btn--skip" 
                    data-index="${t}" data-choice="skip">
                Skip
            </button>
        </div>
    `}function Zb(e,t=null){let r=xr.amountOptions||[],a=xr.dimensionOptions||[],n="",s=new Set([...r,...a]);if(e&&!s.has(e)){let i=sn(e);n+=`<option value="${we(e)}" selected>${we(i)}</option>`}if(t==="amount"){n+='<optgroup label="Amounts">';for(let i of r.sort()){let o=sn(i),l=i===e?"selected":"";n+=`<option value="${we(i)}" data-kind="amount" ${l}>${we(o)}</option>`}n+="</optgroup>"}else if(t==="dimension"){n+='<optgroup label="Dimensions">';for(let i of a.sort()){let o=sn(i),l=i===e?"selected":"";n+=`<option value="${we(i)}" data-kind="dimension" ${l}>${we(o)}</option>`}n+="</optgroup>"}else{n+='<optgroup label="Amounts">';for(let i of r.sort()){let o=sn(i),l=i===e?"selected":"";n+=`<option value="${we(i)}" data-kind="amount" ${l}>${we(o)}</option>`}n+="</optgroup>",n+='<optgroup label="Dimensions">';for(let i of a.sort()){let o=sn(i),l=i===e?"selected":"";n+=`<option value="${we(i)}" data-kind="dimension" ${l}>${we(o)}</option>`}n+="</optgroup>"}return n}function sn(e){return e?e.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)/g,t=>t.charAt(0)+t.slice(1).toLowerCase()).replace(/\b\w/g,t=>t.toUpperCase()).trim():""}function Qb(e){let t=jn(1),r=t?un(t.note):!1,a=t?Te(t.note):"",n=(t?Te(t.reviewer):"")||Un(),s=t?ln(Te(t.signOff)):"",i=!!(s||Te(Lr[1])),o=he.error?`<p class="pf-upload-error">${we(he.error)}</p>`:"";return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${we(Vn)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">Upload & Validate Payroll Data</h2>
            <p class="pf-hero-copy">Upload your payroll export, create the data matrix, and verify coverage.</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Import</h3>
                    <p class="pf-config-subtext">Drop your payroll file to auto-map columns.</p>
                </div>
                ${Yb()}
                ${o}
            </article>
            ${Kb()}
            
            <div class="pf-validation-section">
                <h3 class="pf-validation-header">Validation</h3>
                <p class="pf-validation-subtext">Advisory checks \u2014 review but not required to proceed.</p>
                ${Ok()}
                ${Pk()}
            </div>
            ${t?`
                ${On({textareaId:"step-notes-1",value:a||"",permanentId:"step-notes-lock-1",isPermanent:r,saveButtonId:"step-notes-save-1"})}
                ${Pn({reviewerInputId:"step-reviewer-1",reviewerValue:n,signoffInputId:"step-signoff-1",signoffValue:s,isComplete:i,saveButtonId:"step-signoff-save-1",completeButtonId:"step-signoff-toggle-1"})}
            `:""}
        </section>
    `}function ek(){var m,u,g,v,y,x,b;let e=(m=bt.periods)==null?void 0:m[0];if(!!!e)return"";let r=C=>`$${Math.round(C||0).toLocaleString()}`,a=((u=e.summary)==null?void 0:u.fixed)||0,n=((g=e.summary)==null?void 0:g.variable)||0,s=((v=e.summary)==null?void 0:v.burden)||0,i=((y=e.summary)==null?void 0:y.total)||a+n+s,o=bt.measureUniverseTotal||0,l=((x=bt.measureUniverseHeaders)==null?void 0:x.length)||0,f=(bt.measureColumns||[]).length,d=((b=bt.unclassifiedColumns)==null?void 0:b.length)||0,h=Math.abs(o-i),p=h<1;return`
        <article class="pf-step-card pf-step-detail pf-config-card" style="border: 1px dashed rgba(234, 179, 8, 0.5); background: rgba(234, 179, 8, 0.05);">
            <div class="pf-config-head">
                <h3>Reconciliation: Step 1 vs Expense Review</h3>
                <p class="pf-config-subtext">Expense Review must match Step 1's PR_Data_Clean total</p>
            </div>
            <div style="font-family: monospace; font-size: 12px; line-height: 1.8;">
                <div><strong>Step 1 PR_Data_Clean (Measure Universe):</strong></div>
                <div style="padding-left: 16px;">
                    Total: <strong>${r(o)}</strong><br>
                    Measures: ${l} columns
                </div>
                <br>
                <div><strong>Expense Review (UI Display):</strong></div>
                <div style="padding-left: 16px;">
                    FIXED: ${r(a)}<br>
                    VARIABLE: ${r(n)}<br>
                    BURDEN: ${r(s)}<br>
                    <strong>TOTAL: ${r(i)}</strong><br>
                    Measures: ${f} columns${d>0?` (${d} unclassified)`:""}
                </div>
                <br>
                <div style="padding: 8px; border-radius: 4px; background: ${p?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)"}; color: ${p?"#22c55e":"#ef4444"}">
                    <strong>RECONCILIATION:</strong> 
                    ${p?"Step 1 and Expense Review match":`Delta: ${r(h)} (investigate)`}
                </div>
            </div>
            <div style="margin-top: 12px;">
                <button type="button" class="pf-action-toggle pf-action-toggle--subtle" id="expense-trace-btn" title="Run full diagnostic trace">
                    Run Trace
                </button>
            </div>
        </article>
    `}function tk(e){let t=jn(2),r=t?Te(t.note):"",a=(t?Te(t.reviewer):"")||Un(),n=t?ln(Te(t.signOff)):"",s=!!(n||Te(Lr[2])),i=bt.loading?'<p class="pf-step-note">Preparing executive summary\u2026</p>':bt.lastError?`<p class="pf-step-note">${we(bt.lastError)}</p>`:"",o=Zi({id:"payroll-copilot",heading:"Ada",subtext:"Ask questions about payroll data, variances, and insights",welcomeMessage:"What would you like to explore about this payroll period?",placeholder:"Ask about variances, headcount changes, or executive insights...",quickActions:[{id:"diagnostics",label:"Run Diagnostics",prompt:"Run a diagnostic check on the current payroll data. Check for completeness, accuracy issues, and any data quality concerns."},{id:"insights",label:"Generate Insights",prompt:"What are the key insights and notable findings from this payroll period that I should highlight for executive review?"},{id:"variance",label:"Analyze Variances",prompt:"Analyze the significant variances between this period and the prior period. What's driving the changes?"},{id:"headcount",label:"Headcount Impact",prompt:"What changed in headcount that could explain the expense changes?"}],contextProvider:Js({dataClean:"PR_Data_Clean",expenseReview:"PR_Expense_Review",config:"SS_PF_Config"}),onPrompt:Hl}),l=ek();return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${we(Vn)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${we(e.title)}</h2>
            <p class="pf-hero-copy">${we(e.summary||"")}</p>
            <p class="pf-hero-hint"></p>
        </section>
        <section class="pf-step-guide">
            ${i}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Perform Analysis</h3>
                    <p class="pf-config-subtext">Populate Expense Review and perform review.</p>
                </div>
                <div class="pf-signoff-action">
                    ${Ms(`<button type="button" class="pf-action-toggle" id="expense-run-btn" title="Run expense review analysis">${Ru}</button>`,"Run")}
                    ${Ms(`<button type="button" class="pf-action-toggle" id="expense-refresh-btn" title="Refresh expense data">${$i}</button>`,"Refresh")}
                </div>
            </article>
            
            ${Sb()}
            
            ${o}
            ${t?`
            ${On({textareaId:"step-notes-input",value:r,permanentId:"step-notes-permanent",isPermanent:un(t.note),saveButtonId:"step-notes-save-2"})}
            ${Pn({reviewerInputId:"step-reviewer-name",reviewerValue:a,signoffInputId:"step-signoff-2",signoffValue:n,isComplete:s,saveButtonId:"step-signoff-save-2",completeButtonId:"expense-signoff-toggle"})}
            `:""}
        </section>
    `}function rk(e){let t=jn(3),r=t?Te(t.note):"",a=t?un(t.note):!1,n=(t?Te(t.reviewer):"")||Un(),s=t?ln(Te(t.signOff)):"",i=!!(s||Te(Lr[3])),o=at.lastError?`<p class="pf-step-note" style="color: #ef4444;">${we(at.lastError)}</p>`:"",l=at.validationRun,c=at.issues||[],f=at.unmappedColumns||[],d=at.unmappedTotal||0,h=f.length>0,p=[{key:"Debits = Credits",desc:"\u2211 Debits = \u2211 Credits"},{key:"JE Matches Source Total",desc:"\u2211 JE expense = \u2211 PR_Data_Clean"},{key:"All Columns Mapped",desc:"All column+dept combos have GL mappings"}],m=b=>{let C=c.find(k=>k.check===b.key),w=!l,_;return w?_='<span class="pf-je-check-circle pf-je-circle--pending"></span>':C!=null&&C.passed?_=`<span class="pf-je-check-circle pf-je-circle--pass">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </span>`:_=`<span class="pf-je-check-circle pf-je-circle--fail">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </span>`,`
            <div class="pf-je-check-row">
                ${_}
                <span class="pf-je-check-desc-pill">${we(b.desc)}</span>
            </div>
        `},u=p.map(b=>m(b)).join(""),g=c.filter(b=>!b.passed),v="";l&&g.length>0&&(v=`
            <article class="pf-step-card pf-step-detail pf-je-issues-card">
                <div class="pf-config-head">
                    <h3>Issues Identified</h3>
                    <p class="pf-config-subtext">The following checks did not pass:</p>
                </div>
                <ul class="pf-je-issues-list">
                    ${g.map(b=>`<li><strong>${we(b.check)}:</strong> ${we(b.detail)}</li>`).join("")}
                </ul>
            </article>
        `);let y=b=>Ia(Math.round(b||0)),x=h?`
        <article class="pf-step-card pf-step-detail" style="border: 1px solid #f59e0b; background: rgba(245, 158, 11, 0.05);">
            <div class="pf-config-head">
                <h3 style="color: #f59e0b;">Unmapped GL Combinations</h3>
                <p class="pf-config-subtext">These column + department combinations need GL account mappings in <code>ada_customer_gl_mappings</code>.</p>
            </div>
            <div style="max-height: 200px; overflow-y: auto;">
                <table style="width: 100%; font-size: 12px; border-collapse: collapse;">
                    <thead>
                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <th style="text-align: left; padding: 4px 8px;">PF Column Name</th>
                            <th style="text-align: left; padding: 4px 8px;">Department</th>
                            <th style="text-align: right; padding: 4px 8px;">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${f.slice(0,15).map(b=>`
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <td style="padding: 4px 8px; font-family: monospace; font-size: 11px;">${we(b.header)}</td>
                                <td style="padding: 4px 8px; font-size: 11px;">${we(b.department||"(none)")}</td>
                                <td style="text-align: right; padding: 4px 8px;">${y(b.total)}</td>
                            </tr>
                        `).join("")}
                        ${f.length>15?`
                            <tr><td colspan="3" style="padding: 4px 8px; color: #888;">... and ${f.length-15} more</td></tr>
                        `:""}
                    </tbody>
                    <tfoot>
                        <tr style="border-top: 1px solid rgba(255,255,255,0.1); font-weight: bold;">
                            <td colspan="2" style="padding: 4px 8px;">Total Unmapped</td>
                            <td style="text-align: right; padding: 4px 8px;">${y(d)}</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </article>
    `:"";return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${we(Vn)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${we(e.title)}</h2>
            <p class="pf-hero-copy">Generate journal entry for QuickBooks import.</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Generate Journal Entry</h3>
                    <p class="pf-config-subtext">Build balanced JE from PR_Data_Clean using your GL mappings.</p>
                </div>
                <div class="pf-signoff-action">
                    ${Ms(`<button type="button" class="pf-action-toggle pf-clickable" id="je-create-btn" title="Generate JE from PR_Data_Clean + GL mappings">${Su}</button>`,"Generate")}
                    ${Ms(`<button type="button" class="pf-action-toggle pf-clickable" id="je-run-btn" title="Refresh validation checks">${$i}</button>`,"Refresh")}
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Validation Checks</h3>
                    <p class="pf-config-subtext">These checks run automatically after generating your JE.</p>
                </div>
                ${o}
                <div class="pf-je-checks-container">
                    ${u}
                </div>
            </article>
            ${v}
            ${x}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head" style="position: relative;">
                    <div>
                        <h3>Export Journal Entry</h3>
                        <p class="pf-config-subtext">Download journal entry as CSV for QuickBooks import.</p>
                    </div>
                    <button type="button" class="pf-info-icon-btn" id="je-info-btn" aria-label="Export instructions" style="position: absolute; top: 0; right: 0;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                    </button>
                </div>
                <div class="pf-signoff-action">
                    ${Ms(`<button type="button" class="pf-action-toggle pf-clickable" id="je-export-btn" title="Export journal draft as CSV">${Fu}</button>`,"Export CSV")}
                </div>
            </article>
            
            <!-- Info Modal for JE Export Instructions -->
            <div id="je-info-modal" class="pf-modal-overlay" style="display: none;">
                <div class="pf-modal-content">
                    <div class="pf-modal-header">
                        <h3>\u{1F4CB} QuickBooks Import Instructions</h3>
                        <button type="button" class="pf-modal-close" id="je-info-close">&times;</button>
                    </div>
                    <div class="pf-modal-body">
                        <ol style="margin: 0 0 16px 20px; padding: 0; line-height: 1.8;">
                            <li style="margin-bottom: 12px;">
                                <strong>Assign bank feed transaction</strong><br>
                                <span style="color: #9ca3af;">Assign the bank feed transaction to uncategorized expense (no need to separate this out like in the past)</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <strong>Export CSV file</strong><br>
                                <span style="color: #9ca3af;">Click the Export button above and save the .csv file to your desktop (or other temporary folder)</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <strong>Upload to QuickBooks</strong><br>
                                <span style="color: #9ca3af;">Click the \u2699\uFE0F icon \u2192 Import Data \u2192 Journal Entry \u2192 Upload a file to import data. Map any fields that don't automap.</span>
                            </li>
                        </ol>
                        <hr style="border: none; border-top: 1px solid rgba(255,255,255,0.15); margin: 16px 0;">
                        <div style="font-size: 13px; color: #9ca3af; line-height: 1.6;">
                            <p style="margin: 0 0 12px 0;">
                                <strong style="color: #fbbf24;">\u{1F4A1} Note:</strong> The journal entry will also be booked to uncategorized expense. If everything goes as planned, uncategorized expense should be zero after recording the bank transaction and this journal entry.
                            </p>
                            <p style="margin: 0;">
                                If there are differences, they may indicate a fee that was charged but not presented in the payroll report. This should be recorded as a separate journal entry.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            ${t?`
                ${On({textareaId:"step-notes-input",value:r||"",permanentId:"step-notes-permanent",isPermanent:a,saveButtonId:"step-notes-save-3"})}
                ${Pn({reviewerInputId:"step-reviewer-name",reviewerValue:n,signoffInputId:"step-signoff-3",signoffValue:s,isComplete:i,saveButtonId:"step-signoff-save-3",completeButtonId:"step-signoff-toggle-3"})}
            `:""}
        </section>
    `}function ak(e){let t=Pr.filter(s=>s.id!==4).map(s=>({id:s.id,title:s.title,complete:xk(s.id)})),r=t.every(s=>s.complete),a=t.filter(s=>!s.complete).length;console.log("[Archive Step] Completion check:",t.map(s=>`Step ${s.id}: ${s.complete}`).join(", ")),console.log("[Archive Step] All complete:",r,"Incomplete count:",a);let n=t.map(s=>`
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head pf-notes-header">
                    <span class="pf-action-toggle ${s.complete?"is-active":""}" aria-pressed="${s.complete}">
                        ${Di}
                    </span>
                    <div>
                        <h3>${we(s.title)}</h3>
                        <p class="pf-config-subtext">${s.complete?"Complete":"Not complete"}</p>
                    </div>
                </div>
            </article>
        `).join("");return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${we(Vn)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${we(e.title)}</h2>
            <p class="pf-hero-copy">${we(e.summary||"")}</p>
            <p class="pf-hero-hint"></p>
        </section>
        <section class="pf-step-guide">
            ${n}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Archive & Reset</h3>
                    <p class="pf-config-subtext">Create an archive of this module's sheets and clear work tabs.</p>
                </div>
                ${r?'<p class="pf-step-note" style="color: #22c55e;">All steps complete. Ready to archive!</p>':`<p class="pf-step-note pf-step-note--info">Complete all ${a} remaining step(s) before archiving. Click the checkmark on each step's sign-off section.</p>`}
                <div class="pf-pill-row pf-config-actions">
                    <button type="button" class="pf-pill-btn ${r?"pf-cta-button":""}" id="archive-run-btn" ${r?"":"disabled"} onclick="window.handleArchiveClick()" style="${r?"":"opacity: 0.5; cursor: not-allowed;"}">
                        ${r?"Archive Now":"Archive (Complete Steps First)"}
                    </button>
                </div>
            </article>
        </section>
    `}function nk(e){let t=zs.find(b=>b.id===e)||{id:e!=null?e:"-",title:"Workflow Step",summary:"",description:"",checklist:[]};if(e===1)return Qb(t);if(e===2)return tk(t);if(e===3)return rk(t);if(e===4)return ak(t);let r=!1,a=jn(e),n=a?Te(a.note):"",s=a?un(a.note):!1,i=(a?Te(a.reviewer):"")||Un(),o=a?ln(Te(a.signOff)):"",l=a&&Lr[e]?!!(o||Te(Lr[e])):!!o,c=(t.highlights||[]).map(b=>`
            <div class="pf-step-highlight">
                <span class="pf-step-highlight-label">${we(b.label)}</span>
                <span class="pf-step-highlight-detail">${we(b.detail)}</span>
            </div>
        `).join(""),f=(t.checklist||[]).map(b=>`<li>${we(b)}</li>`).join("")||"",d=r?"":t.description||"Detailed guidance will appear here.",h=[];!r&&t.ctaLabel&&h.push(`<button type="button" class="pf-pill-btn" id="step-action-btn">${we(t.ctaLabel)}</button>`),r||h.push('<button type="button" class="pf-pill-btn pf-pill-btn--ghost" id="step-back-btn">Back to Step List</button>');let p=h.length?`<div class="pf-pill-row pf-config-actions">${h.join("")}</div>`:"",m=jl(),u=r?`
            <div class="pf-link-card">
                <h3 class="pf-link-card__title">Payroll Reports</h3>
                <p class="pf-link-card__subtitle">Open your latest payroll export.</p>
                <div class="pf-link-list">
                    <a
                        class="pf-link-item"
                        id="pr-provider-link"
                        ${m?`href="${we(m)}" target="_blank" rel="noopener noreferrer"`:'aria-disabled="true"'}
                    >
                        <span class="pf-link-item__icon">${Iu}</span>
                        <span class="pf-link-item__body">
                            <span class="pf-link-item__title">Open Payroll Export</span>
                            <span class="pf-link-item__meta">${we(m||"Add a provider link in Configuration")}</span>
                        </span>
                    </a>
                </div>
            </div>
        `:"",g="",v=!r&&c?`<article class="pf-step-card pf-step-detail">${c}</article>`:"",y=!r&&f?`<article class="pf-step-card pf-step-detail">
                            <h3 class="pf-step-subtitle">Checklist</h3>
                            <ul class="pf-step-checklist">${f}</ul>
                        </article>`:"",x=!r||d||p?`
            <article class="pf-step-card pf-step-detail">
                <p class="pf-step-title">${we(d)}</p>
                ${!r&&t.statusHint?`<p class="pf-step-note">${we(t.statusHint)}</p>`:""}
                ${p}
            </article>
        `:"";return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${we(Vn)} | Step ${t.id}</p>
            <h2 class="pf-hero-title">${we(t.title)}</h2>
            <p class="pf-hero-copy">${we(t.summary||"")}</p>
            <p class="pf-hero-hint">${we(Et.statusText||"")}</p>
        </section>
        <section class="pf-step-guide">
            ${u}
            ${g}
            ${x}
            ${v}
            ${y}
            ${a?`
                ${On({textareaId:"step-notes-input",value:n,permanentId:"step-notes-permanent",isPermanent:s,saveButtonId:"step-notes-save"})}
                ${Pn({reviewerInputId:"step-reviewer-name",reviewerValue:i,signoffInputId:`step-signoff-${e}`,signoffValue:o,isComplete:l,saveButtonId:`step-signoff-save-${e}`,completeButtonId:`step-signoff-toggle-${e}`,subtext:"Ready to move on? Save and click Done when finished."})}
            `:""}
        </section>
    `}function sk(e,t){let r=Et.focusedIndex===t?"pf-step-card--active":"",a=Au(ok(e.id));return`
        <article class="pf-step-card pf-clickable ${r}" data-step-card data-step-index="${t}" data-step-id="${e.id}">
            <p class="pf-step-index">Step ${e.id}</p>
            <h3 class="pf-step-title">${a?`${a}`:""}${we(e.title)}</h3>
        </article>
    `}function ik(){return`
        <footer class="pf-brand-footer">
            <div class="pf-brand-text">
                <div class="pf-brand-label">prairie.forge</div>
                <div class="pf-brand-meta">\xA9 Prairie Forge LLC, 2025. All rights reserved. Version ${Yl}</div>
            </div>
        </footer>
    `}function ok(e){return e===0?"config":e===1?"import":e===2?"review":e===3?"journal":e===4?"archive":""}function lk(){var s,i,o,l,c,f,d,h;(s=document.getElementById("nav-home"))==null||s.addEventListener("click",()=>{var p;fd(),(p=document.getElementById("pf-hero"))==null||p.scrollIntoView({behavior:"smooth",block:"start"})}),(i=document.getElementById("nav-selector"))==null||i.addEventListener("click",()=>{window.location.href="../module-selector/index.html"}),(o=document.getElementById("nav-prev"))==null||o.addEventListener("click",()=>ra(-1)),(l=document.getElementById("nav-next"))==null||l.addEventListener("click",()=>ra(1));let e=document.getElementById("nav-quick-toggle"),t=document.getElementById("quick-access-modal"),r=document.getElementById("quick-access-close"),a=t==null?void 0:t.querySelector(".pf-quick-modal-backdrop"),n=()=>{t==null||t.classList.add("hidden"),e==null||e.classList.remove("is-active")};e==null||e.addEventListener("click",p=>{p.stopPropagation(),t==null||t.classList.toggle("hidden"),e.classList.toggle("is-active")}),r==null||r.addEventListener("click",n),a==null||a.addEventListener("click",n),(c=document.getElementById("nav-employee-roster"))==null||c.addEventListener("click",async()=>{n(),await hn("SS_Employee_Roster")}),(f=document.getElementById("nav-chart-of-accounts"))==null||f.addEventListener("click",async()=>{n(),await hn("SS_Chart_of_Accounts")}),(d=document.getElementById("nav-accounting-software"))==null||d.addEventListener("click",async()=>{n(),await cS()}),(h=document.getElementById("nav-config"))==null||h.addEventListener("click",async()=>{n(),await hn("SS_PF_Config")})}function ed(){document.querySelectorAll("[data-step-card]").forEach(e=>{let t=Number(e.getAttribute("data-step-index"));e.addEventListener("click",()=>Wi(t))})}function ck(){var o,l,c,f,d;let e=document.getElementById("config-user-name");e==null||e.addEventListener("change",h=>{let p=h.target.value.trim();Qe(Mn,p);let m=document.getElementById("config-reviewer-name");m&&!m.value&&(m.value=p)}),ic("config-payroll-date",{onChange:h=>{if(Qe("PR_Payroll_Date",h),Ml(0),!h)return;let p=vk(h);if(p){let u=document.getElementById("config-accounting-period");u&&(u.value=p),Qe("PR_Accounting_Period",p),ht.overrides.accountingPeriod=!1}let m=yk(h);if(m){let u=document.getElementById("config-je-id");u&&(u.value=m),Qe("PR_Journal_Entry_ID",m),ht.overrides.jeId=!1}}});let t=jn(0),r=document.getElementById("config-accounting-period");r==null||r.addEventListener("change",h=>{ht.overrides.accountingPeriod=!!h.target.value,Qe("PR_Accounting_Period",h.target.value||""),Ml(0)});let a=document.getElementById("config-je-id");a==null||a.addEventListener("change",h=>{ht.overrides.jeId=!!h.target.value,Qe("PR_Journal_Entry_ID",h.target.value.trim()),Ml(0)}),(o=document.getElementById("config-company-name"))==null||o.addEventListener("change",h=>{Qe("SS_Company_Name",h.target.value.trim())}),(l=document.getElementById("config-company-id"))==null||l.addEventListener("change",h=>{let p=h.target.value.trim();if(p&&!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(p)){Ie("Company ID should be a valid UUID from the CRM.","error");return}Qe("SS_Company_ID",p),p&&Ie("Company ID saved. Ada will now remember your column mappings.","success")}),(c=document.getElementById("config-payroll-provider"))==null||c.addEventListener("change",h=>{let p=h.target.value.trim();Qe(sd,p)}),(f=document.getElementById("config-accounting-link"))==null||f.addEventListener("change",h=>{Qe("SS_Accounting_Software",h.target.value.trim())});let n=document.getElementById("config-notes");if(n==null||n.addEventListener("input",h=>{t&&Qe(t.note,h.target.value,{debounceMs:400})}),t){let h=document.getElementById("config-notes-permanent");h&&(h.addEventListener("click",()=>{let m=!h.classList.contains("is-locked");Ds(h,m),md(t.note,m)}),Ds(h,un(t.note)));let p=document.getElementById("config-notes-save");p==null||p.addEventListener("click",()=>{n&&(Qe(t.note,n.value),Ln(p,!0))})}let s=document.getElementById("config-reviewer-name");s==null||s.addEventListener("change",h=>{let p=h.target.value.trim();t&&Qe(t.reviewer,p),Qe(Mn,p);let m=document.getElementById("config-signoff-date");if(p&&m&&!m.value){let u=Hn();m.value=u,t&&Qe(t.signOff,u)}}),(d=document.getElementById("config-signoff-date"))==null||d.addEventListener("change",h=>{t&&Qe(t.signOff,h.target.value||"")});let i=document.getElementById("config-signoff-save");if(i==null||i.addEventListener("click",()=>{var u;let h=((u=s==null?void 0:s.value)==null?void 0:u.trim())||"",p=document.getElementById("config-signoff-date"),m=(p==null?void 0:p.value)||"";t&&(Qe(t.reviewer,h),Qe(t.signOff,m)),Qe(Mn,h),Ln(i,!0)}),Fl(),t){let h=Te(t.signOff),p=Te(Lr[0]),m=!!(h||p==="Y"||p===!0);console.log(`[Step 0] Binding signoff toggle. signOff="${h}", complete="${p}", isComplete=${m}`),pd({buttonId:"config-signoff-toggle",inputId:"config-signoff-date",fieldName:t.signOff,completeField:Lr[0],initialActive:m,stepId:0,onComplete:Dd(0)}),cd("config-signoff-toggle-prev","config-signoff-toggle-next")}}function fk(e){var r,a,n,s,i,o,l,c,f,d,h,p,m,u,g,v,y,x,b,C,w,_,k,S,D,R,T,V,G;if(e===4&&console.log("[Archive DEBUG] bindStepInteractions called for step 4"),(r=document.getElementById("step-back-btn"))==null||r.addEventListener("click",()=>{fd()}),(a=document.getElementById("step-action-btn"))==null||a.addEventListener("click",()=>{let W=zs.find(j=>j.id===e);Ie(W!=null&&W.ctaLabel?`${W.ctaLabel} coming soon.`:"Step actions coming soon.","info")}),e===1&&((n=document.getElementById("import-open-data-btn"))==null||n.addEventListener("click",()=>hk()),(s=document.getElementById("import-clear-btn"))==null||s.addEventListener("click",()=>mk()),$b(),(i=document.getElementById("step1-bank-amount-input"))==null||i.addEventListener("blur",td),(o=document.getElementById("step1-bank-amount-input"))==null||o.addEventListener("keydown",W=>{W.key==="Enter"&&td(W)}),(l=document.getElementById("bank-recon-refresh-btn"))==null||l.addEventListener("click",async()=>{Ie("Refreshing bank reconciliation...","info",2e3);let W=window.scrollY;await wd(),it(),requestAnimationFrame(()=>window.scrollTo(0,W))}),(c=document.getElementById("coverage-refresh-btn"))==null||c.addEventListener("click",async()=>{Ie("Refreshing payroll coverage...","info",2e3);let W=window.scrollY;await bd(),it(),requestAnimationFrame(()=>window.scrollTo(0,W))}),(f=document.getElementById("roster-apply-btn"))==null||f.addEventListener("click",async()=>{await Ad()}),(d=document.getElementById("roster-refresh-btn"))==null||d.addEventListener("click",async()=>{Ie("Refreshing roster analysis...","info",2e3),await Vk()}),(h=document.getElementById("employee-coverage-bar"))==null||h.addEventListener("click",W=>{W.preventDefault(),Lk()}),(p=document.getElementById("step-signoff-toggle-1-prev"))==null||p.addEventListener("click",()=>{ra(-1)}),(m=document.getElementById("step-signoff-toggle-1-next"))==null||m.addEventListener("click",()=>{ra(1)})),e===3&&((u=document.getElementById("je-run-btn"))==null||u.addEventListener("click",()=>Od()),(g=document.getElementById("je-save-btn"))==null||g.addEventListener("click",()=>sS()),(v=document.getElementById("je-create-btn"))==null||v.addEventListener("click",async()=>{console.log("[JE] Generate button clicked"),Ie("Starting journal entry generation...","info",2e3);try{await uS()}catch(W){console.error("[JE] Button click error:",W),Ie(`Error: ${W.message||"Journal entry generation failed"}`,"error",8e3)}}),(y=document.getElementById("je-export-btn"))==null||y.addEventListener("click",()=>iS()),(x=document.getElementById("je-info-btn"))==null||x.addEventListener("click",()=>{let W=document.getElementById("je-info-modal");W&&(W.style.display="flex")}),(b=document.getElementById("je-info-close"))==null||b.addEventListener("click",()=>{let W=document.getElementById("je-info-modal");W&&(W.style.display="none")}),(C=document.getElementById("je-info-modal"))==null||C.addEventListener("click",W=>{W.target.id==="je-info-modal"&&(W.target.style.display="none")}),(w=document.getElementById("step-signoff-toggle-3-prev"))==null||w.addEventListener("click",()=>{ra(-1)}),(_=document.getElementById("step-signoff-toggle-3-next"))==null||_.addEventListener("click",()=>{ra(1)})),e===2){let W=document.querySelector(".pf-step-guide");if(W){let j="https://your-project.supabase.co/functions/v1/copilot";Ks(W,{id:"expense-review-copilot",contextProvider:Ek(),systemPrompt:`You are Prairie Forge CoPilot, an expert financial analyst assistant for payroll expense review.

CONTEXT: You're embedded in the Payroll Recorder Excel add-in, helping accountants and CFOs review payroll data before journal entry export.

YOUR CAPABILITIES:
1. Analyze payroll expense data for accuracy and completeness
2. Identify trends, anomalies, and variances requiring attention
3. Prepare executive-ready insights and talking points
4. Validate journal entries before export to accounting system

COMMUNICATION STYLE:
- Be concise and actionable
- Use bullet points and tables for clarity
- Use plain text status labels (no emoji)
- Format currency as $X,XXX (no decimals for totals)
- Format percentages as X.X%
- Always end with 2-3 concrete next steps

ANALYSIS FOCUS:
- Period-over-period changes exceeding 10%
- Department cost anomalies vs historical norms
- Headcount vs payroll expense alignment
- Burden rate outliers (normal range: 15-35%)
- Missing or incomplete GL account mappings
- Data quality issues (blanks, duplicates, mismatches)

When asked about variances, explain the business drivers, not just the numbers.
When asked about readiness, be specific about what passes and what needs attention.`})}(k=document.getElementById("expense-run-btn"))==null||k.addEventListener("click",()=>{ad()}),(S=document.getElementById("expense-refresh-btn"))==null||S.addEventListener("click",()=>{ad()}),(D=document.getElementById("expense-trace-btn"))==null||D.addEventListener("click",async()=>{Ie("Running diagnostic trace...","info",3e3);let j=await Id();console.log("[Trace] Result object:",j),Ie("Trace complete - see console for full output","success",5e3)}),Ks(document.body,{id:"payroll-copilot",contextProvider:Js({dataClean:"PR_Data_Clean",expenseReview:"PR_Expense_Review",config:"SS_PF_Config"}),onPrompt:Hl}),(R=document.getElementById("ada-insights-collapse"))==null||R.addEventListener("click",()=>{zr.collapsed=!zr.collapsed,it()}),document.querySelectorAll("[data-ada-prompt]").forEach(j=>{j.addEventListener("click",async()=>{let se=j.dataset.adaPrompt,K={main:null,changes:"Explain the biggest changes vs last period - what's driving the variance?",headcount:"What changed in headcount that could explain the expense changes?",unreconciled:"Explain any unreconciled totals or unclassified amounts",gl:"Are there any GL mapping gaps or classification issues to address?"}[se];await Cb(K)})}),(T=document.getElementById("expense-signoff-toggle-prev"))==null||T.addEventListener("click",()=>{ra(-1)}),(V=document.getElementById("expense-signoff-toggle-next"))==null||V.addEventListener("click",()=>{ra(1)})}let t=jn(e);if(console.log(`[Step ${e}] Binding interactions, fields:`,t),t){let W=e===1?"step-notes-1":"step-notes-input",j=document.getElementById(W);console.log(`[Step ${e}] Notes input found:`,!!j,`(id: ${W})`);let se=e===1?document.getElementById("step-notes-save-1"):e===2?document.getElementById("step-notes-save-2"):e===3?document.getElementById("step-notes-save-3"):document.getElementById("step-notes-save");j==null||j.addEventListener("input",J=>{Qe(t.note,J.target.value,{debounceMs:400})}),se==null||se.addEventListener("click",()=>{j&&(Qe(t.note,j.value),Ln(se,!0))});let q=e===1?"step-reviewer-1":"step-reviewer-name",K=document.getElementById(q);K==null||K.addEventListener("change",J=>{let oe=J.target.value.trim();Qe(t.reviewer,oe);let ae=e===1?document.getElementById("step-signoff-1"):e===2?document.getElementById("step-signoff-2"):e===3?document.getElementById("step-signoff-3"):document.getElementById(`step-signoff-${e}`);if(oe&&ae&&!ae.value){let be=Hn();ae.value=be,Qe(t.signOff,be)}});let Z=e===1?"step-signoff-1":e===2?"step-signoff-2":e===3?"step-signoff-3":`step-signoff-${e}`;console.log(`[Step ${e}] Signoff input ID: ${Z}, found:`,!!document.getElementById(Z)),(G=document.getElementById(Z))==null||G.addEventListener("change",J=>{Qe(t.signOff,J.target.value||"")});let X=e===1?"step-notes-lock-1":"step-notes-permanent",F=document.getElementById(X);F&&(F.addEventListener("click",()=>{let J=!F.classList.contains("is-locked");Ds(F,J),md(t.note,J)}),Ds(F,un(t.note)));let U=e===1?document.getElementById("step-signoff-save-1"):e===2?document.getElementById("step-signoff-save-2"):e===3?document.getElementById("step-signoff-save-3"):document.getElementById(`step-signoff-save-${e}`);U==null||U.addEventListener("click",()=>{var ae,be;let J=((ae=K==null?void 0:K.value)==null?void 0:ae.trim())||"",oe=((be=document.getElementById(Z))==null?void 0:be.value)||"";Qe(t.reviewer,J),Qe(t.signOff,oe),Ln(U,!0)}),Fl();let P=Lr[e],B=P?!!Te(P):!1,Y=Te(t.signOff),Q=e===1?"step-signoff-toggle-1":e===2?"expense-signoff-toggle":e===3?"step-signoff-toggle-3":`step-signoff-toggle-${e}`;console.log(`[Step ${e}] Toggle button ID: ${Q}, found:`,!!document.getElementById(Q)),pd({buttonId:Q,inputId:Z,fieldName:t.signOff,completeField:P,requireNotesCheck:null,initialActive:!!(Y||B),stepId:e,onComplete:Dd(e)}),cd(`${Q}-prev`,`${Q}-next`)}if(e===4){let W=document.getElementById("archive-run-btn");if(W){let j=W.cloneNode(!0);W.parentNode.replaceChild(j,W),j.onclick=async function(){Ie("Starting archive process...","info",2e3);try{await Nd()}catch(se){Ie("Archive Error: "+se.message,"error",8e3)}}}}}function Wi(e){if(console.log(`[NAV DEBUG] focusStep(${e}) called`),Number.isNaN(e)||e<0||e>=Pr.length){console.log("[NAV DEBUG] Invalid index, returning");return}let t=Pr[e];if(!t){console.log(`[NAV DEBUG] No step at index ${e}, returning`);return}console.log(`[NAV DEBUG] Setting state: focusedIndex=${e}, activeStepId=${t.id}, title="${t.title}"`),Hi=e;let r=t.id===0?"config":"step";ud({focusedIndex:e,activeView:r,activeStepId:t.id});let a=bb[t.id];a&&(console.log("[NAV] Step\u2192Sheet activation",{moduleKey:lr,stepIndex:e,stepId:t.id,targetSheetName:a}),hn(a).then(()=>{console.log("[NAV] Step\u2192Sheet activation success",{moduleKey:lr,stepId:t.id,targetSheetName:a})}).catch(n=>{var s;console.warn("[NAV] Step\u2192Sheet activation failed",{moduleKey:lr,stepId:t.id,targetSheetName:a,error:(s=n==null?void 0:n.message)!=null?s:String(n)})}))}function ra(e){var a,n;if(console.log(`[NAV DEBUG] moveFocus(${e}) called`),console.log(`[NAV DEBUG] Current state: focusedIndex=${Et.focusedIndex}, activeView=${Et.activeView}, activeStepId=${Et.activeStepId}`),console.log(`[NAV DEBUG] WORKFLOW_STEPS count: ${Pr.length}`),Et.activeView==="home"&&e>0){console.log("[NAV DEBUG] On home view, going to step 0"),Wi(0),window.scrollTo({top:0,behavior:"smooth"});return}let t=Et.focusedIndex+e,r=Math.max(0,Math.min(Pr.length-1,t));console.log(`[NAV DEBUG] Calculated: next=${t}, clamped=${r}`),console.log(`[NAV DEBUG] Target step: id=${(a=Pr[r])==null?void 0:a.id}, title="${(n=Pr[r])==null?void 0:n.title}"`),Wi(r),window.scrollTo({top:0,behavior:"smooth"})}function cd(e,t){var r,a;(r=document.getElementById(e))==null||r.addEventListener("click",()=>ra(-1)),(a=document.getElementById(t))==null||a.addEventListener("click",()=>ra(1))}function uk(){if(Et.activeView!=="home"||Hi===null)return;let e=document.querySelector(`[data-step-card][data-step-index="${Hi}"]`);Hi=null,e==null||e.scrollIntoView({behavior:"smooth",block:"center"})}async function fd(){let e=ro(lr);await to(e.sheetName,e.title,e.subtitle),ud({activeView:"home",activeStepId:null})}async function dk(){try{await Ys("module-selector")}catch(e){console.warn("[Payroll] Could not apply module-selector tab visibility before redirect:",e)}window.location.href="../module-selector/index.html"}function ud(e){Object.assign(Et,e);let t=oo(lr,Et.activeView,Et.activeStepId);io(lr,t,{activeView:Et.activeView,activeStepId:Et.activeStepId,focusedIndex:Et.focusedIndex}),it()}function Un(){return Te(Mn)||Te("SS_Default_Reviewer")||""}function $l(e,t){e&&(e.classList.toggle("is-active",t),e.setAttribute("aria-pressed",String(t)))}function dd(e){let t=document.getElementById("je-save-btn");t&&t.classList.toggle("is-saved",e)}function Ml(e){let t=aa[e],r=Lr[e];if(!t||!r)return;let a=Te(t.signOff),n=Te(r);if(!(!!a||n==="Y"||n===!0))return;console.log(`[Signoff] Clearing completion for step ${e} due to field change`),Qe(t.signOff,""),Qe(r,"");let i=document.querySelector(`[id$="-signoff-toggle"], [id$="-signoff-toggle-${e}"]`);i&&(i.classList.remove("is-active"),i.setAttribute("aria-pressed","false"));let o=document.querySelector('[id^="config-signoff-"], [id^="step-signoff-"]');o&&(o.value="")}function pk(){let e={};return console.log("[Signoff] Checking step completion status..."),Object.keys(aa).forEach(t=>{let r=parseInt(t,10),a=aa[r];if(!a){e[r]=!1;return}let n=Te(a.signOff),s=Lr[r],i=Te(s),o=!!n||i==="Y"||i===!0;e[r]=o,console.log(`[Signoff] Step ${r}: signOff="${n}", complete="${i}" \u2192 ${o?"COMPLETE":"pending"}`)}),console.log("[Signoff] Status summary:",e),e}function pd({buttonId:e,inputId:t,fieldName:r,completeField:a,requireNotesCheck:n,onComplete:s,initialActive:i=!1,stepId:o=null}){let l=document.getElementById(e);if(!l){console.warn(`[Signoff] Button not found: ${e}`);return}let c=t?document.getElementById(t):null,f=i||!!(c!=null&&c.value);$l(l,f),console.log(`[Signoff] Bound ${e}, initial active: ${f}, stepId: ${o}`),l.addEventListener("click",()=>{if(console.log(`[Signoff] Done button clicked: ${e}, stepId: ${o}`),o!==null&&o>0){let h=pk(),{canComplete:p,message:m}=$u(o,h),u=l.classList.contains("is-active");if(console.log(`[Signoff] canComplete: ${p}, isCurrentlyActive: ${u}`),!u&&!p){console.log(`[Signoff] BLOCKED: ${m}`),Mu(m);return}}let d=!l.classList.contains("is-active");if(console.log(`[Signoff] ${e} clicked, toggling to: ${d}`),$l(l,d),c&&(c.value=d?Hn():""),r){let h=d?Hn():"";console.log(`[Signoff] Writing ${r} = "${h}"`),Qe(r,h)}if(a){let h=d?"Y":"";console.log(`[Signoff] Writing ${a} = "${h}"`),Qe(a,h)}d&&window.scrollTo({top:0,behavior:"smooth"}),d&&typeof s=="function"&&s()}),c&&c.addEventListener("change",()=>{let d=!!c.value,h=l.classList.contains("is-active");d!==h&&(console.log(`[Signoff] Date input changed, syncing button to: ${d}`),$l(l,d),r&&Qe(r,c.value||""),a&&Qe(a,d?"Y":""))})}async function hk(){if(!mt()){Ie("Open this module inside Excel to access the data sheet.","info");return}try{await Excel.run(async e=>{let t=e.workbook.worksheets.getItem(Fe.DATA_CLEAN);t.activate(),t.getRange("A1").select(),await e.sync()})}catch(e){console.error("Unable to open PR_Data_Clean sheet",e),Ie(`Unable to open ${Fe.DATA_CLEAN}. Confirm the sheet exists in this workbook.`,"error")}}async function mk(){if(!mt()){Ie("Open this module inside Excel to clear data.","info");return}if(await Ul(`All data in PR_Data_Clean will be permanently removed.

This action cannot be undone.`,{title:"Clear Payroll Data",icon:Pu,confirmText:"Clear Data",cancelText:"Keep Data",destructive:!0}))try{await Excel.run(async t=>{let r=t.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN);if(r.load("isNullObject"),await t.sync(),!r.isNullObject){let a=r.getUsedRangeOrNullObject();a.load("isNullObject"),await t.sync(),a.isNullObject||(r.getRange("A2:Z10000").clear(Excel.ClearApplyTo.contents),await t.sync()),r.activate(),r.getRange("A1").select(),await t.sync()}}),Yk({prDataTotal:null,cleanTotal:null,reconDifference:null},{rerender:!1}),Ie("PR_Data_Clean cleared successfully.","success")}catch(t){console.error("Unable to clear PR_Data_Clean sheet",t),Ie("Unable to clear PR_Data_Clean. Please try again.","error")}}async function Na(e){var n,s;if(!Ll.length)return null;if(Bi){let i=e.workbook.tables.getItemOrNullObject(Bi);if(i.load("name"),await e.sync(),!i.isNullObject)return i;Bi=null}let t=e.workbook.tables;t.load("items/name"),await e.sync();let r=((n=t.items)==null?void 0:n.map(i=>i.name))||[];console.log("[Payroll] Looking for config table:",Ll),console.log("[Payroll] Found tables in workbook:",r);let a=(s=t.items)==null?void 0:s.find(i=>Ll.includes(i.name));return a?(console.log("[Payroll] Config table found:",a.name),Bi=a.name,e.workbook.tables.getItem(a.name)):(console.warn("[Payroll] CONFIG TABLE NOT FOUND!"),console.warn("[Payroll] Expected table named: SS_PF_Config"),console.warn("[Payroll] Available tables:",r),console.warn("[Payroll] To fix: Select your data in SS_PF_Config sheet -> Insert -> Table -> Name it 'SS_PF_Config'"),null)}async function hd(){if(!mt()){ht.loaded=!0;return}try{await Excel.run(async e=>{let t=await Na(e);if(!t){console.warn("Payroll Recorder: SS_PF_Config table is missing."),ht.loaded=!0;return}let r=t.getDataBodyRange();r.load("values"),await e.sync();let a=r.values||[],n={},s={};a.forEach(i=>{var l,c;let o=kr(i[et.FIELD]);o&&(n[o]=(l=i[et.VALUE])!=null?l:"",s[o]=(c=i[et.PERMANENT])!=null?c:"")}),ht.values=n,ht.permanents=s,ht.overrides.accountingPeriod=!!(n.PR_Accounting_Period||n.Accounting_Period),ht.overrides.jeId=!!(n.PR_Journal_Entry_ID||n.Journal_Entry_ID),ht.loaded=!0})}catch(e){console.warn("Payroll Recorder: unable to load PF_Config table.",e),ht.loaded=!0}}function Te(e){var t;return(t=ht.values[e])!=null?t:""}function gk(){let e=Object.keys(ht.values||{});return Yu.find(r=>e.includes(r))||Yu[0]}function fn(){return Te(gk())}function jl(){return(Te(sd)||Te("Payroll_Provider_Link")||"").trim()}function un(e){return gd(ht.permanents[e])}function xk(e){let t=Lr[e];return t?gd(Te(t)):!1}function md(e,t){let r=kr(e);r&&(ht.permanents[r]=t?"Y":"N",wk(r,t?"Y":"N"))}function gd(e){let t=String(e!=null?e:"").trim().toLowerCase();return t==="true"||t==="y"||t==="yes"||t==="1"}function kr(e){return String(e!=null?e:"").trim()}function Gi(e){let t=String(e!=null?e:"").trim().toLowerCase();return!!(!t||["employee","employee name","name","full name","header","column","n/a","none","blank","null","undefined"].some(s=>t===s||t===s.replace(/\s+/g,""))||["total","subtotal","summary","grand total","totals for department","department total","dept total","report total"].some(s=>t.includes(s))||["~","*","---","==="].some(s=>t.startsWith(s)))}function ln(e){if(!e)return"";let t=Vs(e);return t?`${t.year}-${String(t.month).padStart(2,"0")}-${String(t.day).padStart(2,"0")}`:""}function vk(e){let t=Vs(e);return t?t.year<1900||t.year>2100?(console.warn("deriveAccountingPeriod - Invalid year:",t.year,"from input:",e),""):`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.month-1]} ${t.year}`:""}function yk(e){let t=Vs(e);return t?t.year<1900||t.year>2100?(console.warn("deriveJeId - Invalid year:",t.year,"from input:",e),""):`PR-AUTO-${t.year}-${String(t.month).padStart(2,"0")}-${String(t.day).padStart(2,"0")}`:""}function Hn(){return ma(new Date)}function Qe(e,t,r={}){var i;let a=kr(e);ht.values[a]=t!=null?t:"";let n=(i=r.debounceMs)!=null?i:0;if(!n){let o=$n.get(a);o&&clearTimeout(o),$n.delete(a),Ls(a,t!=null?t:"");return}$n.has(a)&&clearTimeout($n.get(a));let s=setTimeout(()=>{$n.delete(a),Ls(a,t!=null?t:"")},n);$n.set(a,s)}var _k=["PR_Accounting_Period","PTO_Accounting_Period","Accounting_Period"];async function Ls(e,t){let r=kr(e);if(ht.values[r]=t!=null?t:"",console.log(`[Payroll] Writing config: ${r} = "${t}"`),!mt()){console.warn("[Payroll] Excel runtime not available - cannot write");return}let a=_k.some(n=>r===n||r.toLowerCase()===n.toLowerCase());try{await Excel.run(async n=>{var h;let s=await Na(n);if(!s){console.error("[Payroll] \u274C Cannot write - config table not found");return}let i=s.getDataBodyRange(),o=s.getHeaderRowRange();i.load("values"),o.load("values"),await n.sync();let l=o.values[0]||[],c=i.values||[],f=l.length;console.log(`[Payroll] Table has ${c.length} rows, ${f} columns`);let d=[];if(c.forEach((p,m)=>{kr(p[et.FIELD])===r&&d.push(m)}),d.length===0){ht.permanents[r]=(h=ht.permanents[r])!=null?h:Xu;let p=new Array(f).fill("");if(et.TYPE>=0&&et.TYPE<f&&(p[et.TYPE]=yb),et.FIELD>=0&&et.FIELD<f&&(p[et.FIELD]=r),et.VALUE>=0&&et.VALUE<f&&(p[et.VALUE]=t!=null?t:""),et.PERMANENT>=0&&et.PERMANENT<f&&(p[et.PERMANENT]=Xu),console.log("[Payroll] Adding NEW row:",p),s.rows.add(null,[p]),await n.sync(),a){let m=s.rows;m.load("count"),await n.sync();let u=m.count-1,v=s.rows.getItemAt(u).getRange().getCell(0,et.VALUE);v.numberFormat=[["@"]],v.values=[[t!=null?t:""]],await n.sync(),console.log(`[Payroll] Applied text format to ${r}`)}console.log(`[Payroll] New row added for ${r}`)}else{let p=d[0];console.log(`[Payroll] Updating existing row ${p} for ${r}`);let m=i.getCell(p,et.VALUE);if(a&&(m.numberFormat=[["@"]]),m.values=[[t!=null?t:""]],await n.sync(),console.log(`[Payroll] Updated ${r}`),d.length>1){console.log(`[Payroll] Found ${d.length-1} duplicate rows for ${r}, removing...`);let u=d.slice(1).reverse();for(let g of u)try{s.rows.getItemAt(g).delete()}catch(v){console.warn(`[Payroll] Could not delete duplicate row ${g}:`,v.message)}await n.sync(),console.log(`[Payroll] Removed duplicate rows for ${r}`)}}})}catch(n){console.error(`[Payroll] \u274C Write failed for ${e}:`,n)}}async function wk(e,t){let r=kr(e);if(r&&mt()){ht.permanents[r]=t;try{await Excel.run(async a=>{let n=await Na(a);if(!n){console.warn(`Payroll Recorder: unable to locate config table when toggling ${e} permanent flag.`);return}let s=n.getDataBodyRange();s.load("values"),await a.sync();let o=(s.values||[]).findIndex(l=>kr(l[et.FIELD])===r);o!==-1&&(s.getCell(o,et.PERMANENT).values=[[t]],await a.sync())})}catch(a){console.warn(`Payroll Recorder: unable to update permanent flag for ${e}`,a)}}}function Vs(e){if(!e)return null;let t=String(e).trim(),r=/^(\d{4})-(\d{2})-(\d{2})/.exec(t);if(r){let i=Number(r[1]),o=Number(r[2]),l=Number(r[3]);if(i&&o&&l)return{year:i,month:o,day:l}}let a=/^(\d{1,2})\/(\d{1,2})\/(\d{4})/.exec(t);if(a){let i=Number(a[1]),o=Number(a[2]),l=Number(a[3]);if(l&&i&&o)return{year:l,month:i,day:o}}let n=Number(e);if(Number.isFinite(n)&&n>4e4&&n<6e4){let o=Math.floor(n-25569)*86400*1e3,l=new Date(o);if(!isNaN(l.getTime())){let c=`${l.getUTCFullYear()}-${String(l.getUTCMonth()+1).padStart(2,"0")}-${String(l.getUTCDate()).padStart(2,"0")}`;return console.log("DEBUG parseDateInput - Converted Excel serial",n,"to",c),{year:l.getUTCFullYear(),month:l.getUTCMonth()+1,day:l.getUTCDate()}}}let s=new Date(t);return isNaN(s.getTime())?(console.warn("DEBUG parseDateInput - Could not parse date value:",e),null):{year:s.getFullYear(),month:s.getMonth()+1,day:s.getDate()}}function ma(e){if(e._isUTC){let n=e.getUTCFullYear(),s=String(e.getUTCMonth()+1).padStart(2,"0"),i=String(e.getUTCDate()).padStart(2,"0");return`${n}-${s}-${i}`}let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`}function nn(e){if(!e)return"";if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/)){let[t,r,a]=e.split("-");return`${r}/${a}/${t}`}if(e instanceof Date&&!isNaN(e.getTime())){let t=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),a=e.getFullYear();return`${t}/${r}/${a}`}if(typeof e=="number"&&Number.isFinite(e)){let t=Math.round((e-25569)*86400*1e3),r=new Date(t);if(Number.isFinite(r.getTime())){let a=String(r.getUTCMonth()+1).padStart(2,"0"),n=String(r.getUTCDate()).padStart(2,"0"),s=r.getUTCFullYear();return`${a}/${n}/${s}`}}return String(e).trim()}function Bl(e){if(!e)return null;if(typeof e=="string"){let r=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r)return`${r[1]}-${r[2]}-${r[3]}`}let t=Vs(e);return t?`${t.year}-${String(t.month).padStart(2,"0")}-${String(t.day).padStart(2,"0")}`:null}function Ek(){return async()=>{if(!mt())return null;try{return await Excel.run(async e=>{var i,o,l;let t={timestamp:new Date().toISOString(),period:null,summary:{},departments:[],recentPeriods:[],dataQuality:{}},r=await Na(e);if(r){let c=r.getDataBodyRange();c.load("values"),await e.sync();let f=c.values||[];for(let d of f){let h=String(d[et.FIELD]||"").trim(),p=d[et.VALUE];h.toLowerCase().includes("accounting")&&h.toLowerCase().includes("period")&&(t.period=String(p||"").trim())}}let a=e.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN);if(a.load("isNullObject"),await e.sync(),!a.isNullObject){let c=a.getUsedRangeOrNullObject();if(c.load("values"),await e.sync(),!c.isNullObject&&((i=c.values)==null?void 0:i.length)>1){let f=c.values[0].map(y=>Da(y)),d=c.values.slice(1),h=f.findIndex(y=>y.includes("amount")),p=Hs(f),m=f.findIndex(y=>y.includes("employee")),u=0,g=new Set,v=new Map;for(let y of d){let x=Number(y[h])||0;if(u+=x,m>=0){let b=String(y[m]||"").trim();b&&g.add(b)}if(p>=0){let b=String(y[p]||"").trim();b&&v.set(b,(v.get(b)||0)+x)}}t.summary={total:u,employeeCount:g.size,avgPerEmployee:g.size?u/g.size:0,rowCount:d.length},t.departments=Array.from(v.entries()).map(([y,x])=>({name:y,total:x,percentOfTotal:u?x/u:0})).sort((y,x)=>x.total-y.total),t.dataQuality.dataCleanReady=!0,t.dataQuality.rowCount=d.length}}let n=e.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_SUMMARY);if(n.load("isNullObject"),await e.sync(),!n.isNullObject){let c=n.getUsedRangeOrNullObject();if(c.load("values"),await e.sync(),!c.isNullObject&&((o=c.values)==null?void 0:o.length)>1){let f=c.values[0].map(p=>Da(p)),d=f.findIndex(p=>p.includes("period")),h=f.findIndex(p=>p.includes("total"));t.recentPeriods=c.values.slice(1,6).map(p=>({period:p[d]||"",total:Number(p[h])||0})),t.dataQuality.archiveAvailable=!0,t.dataQuality.periodsAvailable=t.recentPeriods.length}}let s=e.workbook.worksheets.getItemOrNullObject(Fe.JE_DRAFT);if(s.load("isNullObject"),await e.sync(),!s.isNullObject){let c=s.getUsedRangeOrNullObject();if(c.load("values"),await e.sync(),!c.isNullObject&&((l=c.values)==null?void 0:l.length)>1){let f=c.values[0].map(u=>Da(u)),d=f.findIndex(u=>u.includes("debit")),h=f.findIndex(u=>u.includes("credit")),p=0,m=0;for(let u of c.values.slice(1))p+=Number(u[d])||0,m+=Number(u[h])||0;t.journalEntry={totalDebit:p,totalCredit:m,difference:Math.abs(p-m),isBalanced:Math.abs(p-m)<.01,lineCount:c.values.length-1},t.dataQuality.jeDraftReady=!0}}return console.log("CoPilot context gathered:",t),t})}catch(e){return console.warn("CoPilot context provider error:",e),null}}}async function bk(){var t,r,a,n,s;console.log("[AdaInsights] Building context pack...");let e={identity:{module:"payroll-recorder",timestamp:new Date().toISOString(),basis_mode:"CASH_OUTFLOW"},period:{current_key:null,prior_key:null,periods_available:0},totals:{expense_review_total_current:0,expense_review_total_prior:0,pr_data_clean_total_numeric:0,calculated_total_current_logic:0,bank_statement_amount:null,bank_delta:null},delta_breakdown:{total_unclassified:0,total_excluded_by_side_ee:0,total_excluded_by_side_na:0,total_excluded_by_include_false:0,total_excluded_by_summary:0,top_unclassified_by_dollars:[],top_excluded_by_dollars:[]},drivers:{bucket_totals_current:{FIXED:0,VARIABLE:0,BURDEN:0},bucket_totals_prior:{FIXED:0,VARIABLE:0,BURDEN:0},bucket_deltas:{FIXED:0,VARIABLE:0,BURDEN:0},top_measure_deltas:[],department_deltas:[]},metadata:{measures_in_sheet_count:0,measures_with_dictionary_metadata_count:0,measures_missing_dictionary_metadata:[],measures_with_blank_side:[],new_measures_this_period:[]},roster_context:null,availability:{has_pr_data_clean:!1,has_archive_totals:!1,has_archive_summary:!1,has_employee_roster:!1,has_prior_period:!1,error_messages:[]}};if(!mt())return e.availability.error_messages.push("Excel runtime is unavailable."),e;try{if(await Excel.run(async i=>{var h,p,m,u;let o=i.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN),l=i.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_SUMMARY),c=i.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_TOTALS);o.load("isNullObject"),l.load("isNullObject"),c.load("isNullObject"),await i.sync();let f=!1,d=!1;if(o.isNullObject)e.availability.error_messages.push("Run Create Matrix to generate PR_Data_Clean first.");else{e.availability.has_pr_data_clean=!0;let g=o.getUsedRangeOrNullObject();if(g.load("values"),await i.sync(),!g.isNullObject&&g.values&&g.values.length>1){let v=g.values[0].map(q=>String(q||"").trim()),y=v.map(q=>q.toLowerCase()),x=g.values.slice(1),b=y.findIndex(q=>q==="pay_date"||q==="payroll_date"||q.includes("pay_period"));if(b>=0&&x.length>0){let q=x[0][b];e.period.current_key=$s(q)}let C=nt,w=new Set;v.forEach((q,K)=>{let Z=q.toLowerCase();C.loaded&&C.dimensions&&C.dimensions.has(Z)&&w.add(K)});let _=0,k=0,S=0,D=[],R=[],T=[],V=[],G=[],W=[],j=[];v.forEach((q,K)=>{var P;if(w.has(K))return;let Z=q.toLowerCase(),X=0,F=!1;for(let B of x){let Y=Number(B[K]);!isNaN(Y)&&Y!==0&&(F=!0,X+=Y)}if(!F)return;_+=X,k++;let U=C.loaded&&C.measures?C.measures[Z]:null;if(U){S++;let B=String(U.side||"").toLowerCase().trim();if(B||j.push({header:q,total:X}),ji.has(Z))G.push({header:q,total:X,reason:"summary_exclusion"});else if(B==="ee")R.push({header:q,total:X});else if(B==="na")T.push({header:q,total:X});else if(U.include===!1)V.push({header:q,total:X});else{let Y=(U.bucket||"OTHER").toUpperCase();D.push({pf_column_name:q,bucket:Y,side:U.side||null,current_amount:X*((P=U.sign)!=null?P:1),prior_amount:0,delta_amount:0})}}else ji.has(Z)?G.push({header:q,total:X,reason:"summary_exclusion"}):W.push({header:q,total:X})}),e.totals.pr_data_clean_total_numeric=_,e.metadata.measures_in_sheet_count=k,e.metadata.measures_with_dictionary_metadata_count=S,e.metadata.measures_missing_dictionary_metadata=W.slice(0,15).map(q=>q.header),e.metadata.measures_with_blank_side=j.slice(0,10).map(q=>q.header),e.delta_breakdown.total_excluded_by_side_ee=R.reduce((q,K)=>q+K.total,0),e.delta_breakdown.total_excluded_by_side_na=T.reduce((q,K)=>q+K.total,0),e.delta_breakdown.total_excluded_by_include_false=V.reduce((q,K)=>q+K.total,0),e.delta_breakdown.total_excluded_by_summary=G.reduce((q,K)=>q+K.total,0),e.delta_breakdown.total_unclassified=W.reduce((q,K)=>q+K.total,0);let se=[...R.map(q=>({...q,reason:"side='ee'"})),...T.map(q=>({...q,reason:"side='na'"})),...V.map(q=>({...q,reason:"include=false"})),...G].sort((q,K)=>Math.abs(K.total)-Math.abs(q.total));e.delta_breakdown.top_excluded_by_dollars=se.slice(0,10),e.delta_breakdown.top_unclassified_by_dollars=W.sort((q,K)=>Math.abs(K.total)-Math.abs(q.total)).slice(0,10),e.drivers.top_measure_deltas=D}}if(!c.isNullObject){e.availability.has_archive_totals=!0;let g=c.getUsedRangeOrNullObject();if(g.load("values"),await i.sync(),f=!g.isNullObject&&g.values&&g.values.length>1,f){let v=zl(g.values);if(v.length>0){e.period.periods_available=v.length;let y=e.period.current_key,x=v.find(b=>b.key!==y);x&&(e.period.prior_key=x.key,e.availability.has_prior_period=!0,d=!0,e.totals.expense_review_total_prior=((h=x.summary)==null?void 0:h.total)||0,e.drivers.bucket_totals_prior={FIXED:((p=x.summary)==null?void 0:p.fixed)||0,VARIABLE:((m=x.summary)==null?void 0:m.variable)||0,BURDEN:((u=x.summary)==null?void 0:u.burden)||0})}}}if(l.isNullObject)f||e.availability.error_messages.push("Archive data not available. Run archive for at least 1 period to enable comparisons.");else{e.availability.has_archive_summary=!0;let g=l.getUsedRangeOrNullObject();if(g.load("values"),await i.sync(),!g.isNullObject&&g.values&&g.values.length>1){let v=g.values[0].map(C=>String(C||"").trim()),y=v.map(C=>C.toLowerCase()),x=g.values.slice(1),b=y.findIndex(C=>C==="pay_date"||C==="payroll_date"||C.includes("pay_period"));if(b>=0){let C=new Map,w=nt;x.forEach(R=>{let T=$s(R[b]);if(!T)return;C.has(T)||C.set(T,{fixed:0,variable:0,burden:0,total:0,measureTotals:new Map});let V=C.get(T);v.forEach((G,W)=>{var U;let j=G.toLowerCase(),se=w.loaded&&w.measures?w.measures[j]:null;if(!se)return;let K=(Number(R[W])||0)*((U=se.sign)!=null?U:1);if(!Vl(se,j).include)return;V.total+=K;let X=(se.bucket||"OTHER").toUpperCase();X==="FIXED"?V.fixed+=K:X==="VARIABLE"?V.variable+=K:V.burden+=K;let F=V.measureTotals.get(G)||0;V.measureTotals.set(G,F+K)})});let _=Array.from(C.entries()).sort((R,T)=>T[0].localeCompare(R[0]));e.period.periods_available||(e.period.periods_available=_.length);let k=e.period.current_key,S=e.period.prior_key;if(!S){let R=_.find(([T])=>T!==k);R&&(S=R[0],e.period.prior_key=S,e.availability.has_prior_period=!0)}let D=S?C.get(S):null;D&&(d||(e.availability.has_prior_period=!0,e.totals.expense_review_total_prior=D.total,e.drivers.bucket_totals_prior={FIXED:D.fixed,VARIABLE:D.variable,BURDEN:D.burden}),e.drivers.top_measure_deltas.forEach(R=>{let T=D.measureTotals.get(R.pf_column_name)||0;R.prior_amount=T,R.delta_amount=R.current_amount-T}))}}}}),bt.periods&&bt.periods.length>0){let i=bt.periods[0];e.totals.expense_review_total_current=((t=i.summary)==null?void 0:t.total)||0,e.totals.calculated_total_current_logic=((r=i.summary)==null?void 0:r.total)||0,e.drivers.bucket_totals_current={FIXED:((a=i.summary)==null?void 0:a.fixed)||0,VARIABLE:((n=i.summary)==null?void 0:n.variable)||0,BURDEN:((s=i.summary)==null?void 0:s.burden)||0},e.drivers.bucket_deltas={FIXED:e.drivers.bucket_totals_current.FIXED-e.drivers.bucket_totals_prior.FIXED,VARIABLE:e.drivers.bucket_totals_current.VARIABLE-e.drivers.bucket_totals_prior.VARIABLE,BURDEN:e.drivers.bucket_totals_current.BURDEN-e.drivers.bucket_totals_prior.BURDEN},i.departments&&(e.drivers.department_deltas=i.departments.filter(o=>!o.isTotal).map(o=>({department_name:o.name,current_amount:o.allIn||0,prior_amount:(o.allIn||0)-(o.delta||0),delta_amount:o.delta||0})).sort((o,l)=>Math.abs(l.delta_amount)-Math.abs(o.delta_amount)).slice(0,10))}return e.drivers.top_measure_deltas=e.drivers.top_measure_deltas.sort((i,o)=>Math.abs(o.delta_amount)-Math.abs(i.delta_amount)).slice(0,15),Me.bankAmount&&(e.totals.bank_statement_amount=Number(Me.bankAmount)||null,e.totals.bank_delta=Me.difference),e.roster_context=await kk(e.period.current_key,e.period.prior_key),e.roster_context&&(e.availability.has_employee_roster=!e.roster_context.error,e.roster_context.error&&e.availability.error_messages.push(e.roster_context.error)),console.log("[AdaInsights] Context pack built:",e),e}catch(i){return console.error("[AdaInsights] Error building context pack:",i),e.availability.error_messages.push(`Error: ${i.message}`),e}}function $s(e){if(!e)return null;if(typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e))return e.slice(0,10);if(typeof e=="number")return new Date((e-25569)*864e5).toISOString().slice(0,10);try{let t=new Date(e);if(!isNaN(t.getTime()))return t.toISOString().slice(0,10)}catch{}return String(e).trim()}async function kk(e,t){console.log("[AdaInsights] Building roster context...",{currentPeriodKey:e,priorPeriodKey:t});let r={error:null,join_key_used:null,roster_new_this_period:[],roster_missing_this_period:[],roster_reactivated:[],roster_department_changes:[],headcount_by_department_current:{},headcount_by_department_prior:{},headcount_delta_by_department:{},new_hires_by_department:{},missing_by_department:{}};function a(n){return n?String(n).toLowerCase().trim().replace(/\s+/g," ").replace(/[.,'"]/g,"").replace(/\s+(jr|sr|ii|iii|iv)$/i," $1"):""}if(!mt())return r.error="Excel runtime unavailable",r;try{return await Excel.run(async n=>{let s=n.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster"),i=n.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN);if(s.load("isNullObject"),i.load("isNullObject"),await n.sync(),s.isNullObject){r.error="Employee roster not found. Create/update roster from payroll to enable headcount explanations.";return}if(i.isNullObject){r.error="PR_Data_Clean not found. Run Create Matrix first.";return}let o=s.getUsedRangeOrNullObject();o.load("values");let l=i.getUsedRangeOrNullObject();if(l.load("values"),await n.sync(),o.isNullObject||!o.values||o.values.length<2){r.error="Employee roster is empty";return}let c=o.values[0].map(w=>String(w||"").toLowerCase().trim()),f=o.values.slice(1),d={employee_id:c.findIndex(w=>w==="employee_id"||w==="emp_id"),employee_name:c.findIndex(w=>w==="employee_name"||w==="employee"),department:c.findIndex(w=>w==="department_name"||w==="department"),status:c.findIndex(w=>w==="employment_status"||w==="status"),first_seen:c.findIndex(w=>w==="first_seen_pay_date"),last_seen:c.findIndex(w=>w==="last_seen_pay_date"),termination_date:c.findIndex(w=>w==="termination_effective_date"),is_manual:c.findIndex(w=>w==="is_manually_managed")},h=[],p=[],m={employee_id:-1,employee_name:-1,department:-1};!l.isNullObject&&l.values&&l.values.length>1&&(h=l.values[0].map(w=>String(w||"").toLowerCase().trim()),p=l.values.slice(1),m={employee_id:h.findIndex(w=>w==="employee_id"||w==="emp_id"),employee_name:h.findIndex(w=>w==="employee_name"||w==="employee"),department:h.findIndex(w=>w==="department_name"||w==="department")});let u=d.employee_id>=0,g=m.employee_id>=0,v=!1,y=!1;u&&(v=f.some(w=>{let _=String(w[d.employee_id]||"").trim();return _.length>0&&!_.includes(" ")})),g&&(y=p.some(w=>{let _=String(w[m.employee_id]||"").trim();return _.length>0&&!_.includes(" ")}));let x=u&&g&&v&&y,b=x?"Employee_ID":"Employee_Name";r.join_key_used=b,console.log("[RosterContext] Join key determination:"),console.log(`  - Roster has Employee_ID column: ${u}, with values: ${v}`),console.log(`  - Payroll has Employee_ID column: ${g}, with values: ${y}`),console.log(`  - Using join key: ${b}`);let C=new Map;if(f.forEach(w=>{let _;x?_=String(w[d.employee_id]||"").toLowerCase().trim():_=a(w[d.employee_name]),_&&C.set(_,{employee_id:d.employee_id>=0?String(w[d.employee_id]||"").trim():null,employee_name:d.employee_name>=0?String(w[d.employee_name]||"").trim():null,department:d.department>=0?String(w[d.department]||"").trim():null,status:d.status>=0?String(w[d.status]||"").trim():"Unknown",first_seen:d.first_seen>=0?$s(w[d.first_seen]):null,last_seen:d.last_seen>=0?$s(w[d.last_seen]):null,termination_date:d.termination_date>=0?$s(w[d.termination_date]):null,is_manual:d.is_manual>=0&&String(w[d.is_manual]||"").toLowerCase()==="true"})}),console.log(`[RosterContext] Built rosterMap with ${C.size} entries using ${b}`),p.length>0){let w=new Map;p.forEach(k=>{let S;x?S=String(k[m.employee_id]||"").toLowerCase().trim():S=a(k[m.employee_name]),S&&(w.has(S)||w.set(S,{name:m.employee_name>=0?String(k[m.employee_name]||"").trim():S,department:m.department>=0?String(k[m.department]||"").trim():"Unknown"}))}),console.log(`[RosterContext] Built currentPayrollSet with ${w.size} entries using ${b}`),w.forEach(k=>{let S=k.department||"Unknown";r.headcount_by_department_current[S]=(r.headcount_by_department_current[S]||0)+1}),w.forEach((k,S)=>{var R;let D=C.get(S);D?((R=D.status)==null?void 0:R.toLowerCase())==="terminated"?r.roster_reactivated.push({key:S,name:D.employee_name||k.name,department:k.department,termination_date:D.termination_date,is_manually_managed:D.is_manual,note:"reactivation detected (was terminated)"}):D.first_seen===e?(r.roster_new_this_period.push({key:S,name:D.employee_name||k.name,department:k.department,note:"first seen this period (new hire)"}),r.new_hires_by_department[k.department]=(r.new_hires_by_department[k.department]||0)+1):D.department&&k.department&&D.department.toLowerCase()!==k.department.toLowerCase()&&r.roster_department_changes.push({key:S,name:D.employee_name||k.name,previous_department:D.department,current_department:k.department,note:"department changed"}):(r.roster_new_this_period.push({key:S,name:k.name,department:k.department,note:"first seen this period (likely new hire)"}),r.new_hires_by_department[k.department]=(r.new_hires_by_department[k.department]||0)+1)}),C.forEach((k,S)=>{var D;if(!w.has(S)){let R=(D=k.status)==null?void 0:D.toLowerCase();if(R==="active"||R==="unknown"){r.roster_missing_this_period.push({key:S,name:k.employee_name,department:k.department,last_seen_date:k.last_seen,note:"not seen this period (may be no-hours or termination)"});let T=k.department||"Unknown";r.missing_by_department[T]=(r.missing_by_department[T]||0)+1}}}),t&&C.forEach(k=>{let S=k.first_seen,D=k.last_seen;if(S&&S<=t&&(!D||D>=t)){let T=k.department||"Unknown";r.headcount_by_department_prior[T]=(r.headcount_by_department_prior[T]||0)+1}}),new Set([...Object.keys(r.headcount_by_department_current),...Object.keys(r.headcount_by_department_prior)]).forEach(k=>{let S=r.headcount_by_department_current[k]||0,D=r.headcount_by_department_prior[k]||0;r.headcount_delta_by_department[k]=S-D})}r.roster_new_this_period=r.roster_new_this_period.slice(0,20),r.roster_missing_this_period=r.roster_missing_this_period.slice(0,20),r.roster_reactivated=r.roster_reactivated.slice(0,10),r.roster_department_changes=r.roster_department_changes.slice(0,10)}),console.log("[AdaInsights] Roster context built:",r),r}catch(n){return console.error("[AdaInsights] Error building roster context:",n),r.error=`Error: ${n.message}`,r}}function we(e){return String(e!=null?e:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Ms(e,t){return`
        <div class="pf-labeled-button">
            ${e}
            <span class="pf-button-label">${we(t)}</span>
        </div>
    `}function mt(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}function jn(e){return aa[e]||null}function Xr(e){return e==null||Number.isNaN(e)?"---":typeof e!="number"?e:e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function Ia(e){var a;if(e==null||e==="")return"---";let t=Number(e),r=(a=window.PrairieForge)==null?void 0:a.formatNumber;return Number.isFinite(t)?r?r(t):t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(e)}function xd(e){let t=js(e);return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):""}function Sk(e=[]){return e.map(t=>(t||[]).map(r=>{if(r==null)return"";let a=String(r);return/[",\n]/.test(a)?`"${a.replace(/"/g,'""')}"`:a}).join(",")).join(`
`)}function Ck(e,t){let r=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=e,document.body.appendChild(n),n.click(),n.remove(),setTimeout(()=>URL.revokeObjectURL(a),1e3)}function js(e){if(typeof e=="number")return e;if(e==null)return NaN;let t=String(e).replace(/[^0-9.-]/g,""),r=Number.parseFloat(t);return Number.isFinite(r)?r:NaN}var vd="PR_Bank_Amount",Tk=.01,Me={systemTotal:null,bankAmount:null,difference:null,isReconciled:!1,loading:!1,lastError:null,amountColumns:[]},yd=new Set(["gross_pay_amount","net_pay_amount","total_deductions_amount","total_earnings_amount"]),Ak=["employee","department","location","date","period","name","id","code","title","check","pay_type","frequency"],Vi=null;async function Xi(){if(console.log("[MeasureUniverse] Getting PR_Data_Clean measure universe..."),Vi)return console.log("[MeasureUniverse] Returning cached universe"),Vi;let e={sheetName:"PR_Data_Clean",usedRangeAddress:null,allHeaders:[],dimensionHeaders:[],includedMeasureHeaders:[],excludedHeaders:[],perColumnSums:{},total:0,error:null};if(!mt())return e.error="Excel runtime unavailable",e;try{await Excel.run(async r=>{let a=r.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN);if(a.load("isNullObject"),await r.sync(),a.isNullObject){e.error="Create Matrix first - PR_Data_Clean not found";return}let n=a.getUsedRangeOrNullObject();if(n.load(["address","values","rowCount","columnCount"]),await r.sync(),n.isNullObject||n.rowCount<2){e.error="PR_Data_Clean is empty";return}e.usedRangeAddress=n.address;let s=n.values,i=s[0].map(o=>String(o||"").trim());e.allHeaders=[...i],i.forEach((o,l)=>{let c=o.toLowerCase();if(Ak.some(p=>c.includes(p))){e.dimensionHeaders.push(o),e.excludedHeaders.push({header:o,reason:"dimension"});return}if(!c.includes("amount")){e.excludedHeaders.push({header:o,reason:"no_amount_keyword"});return}if(yd.has(c)){e.excludedHeaders.push({header:o,reason:"summary_exclusion"});return}let h=0;for(let p=1;p<s.length;p++){let m=s[p][l],u=Number(m);Number.isFinite(u)&&(h+=u)}e.includedMeasureHeaders.push(o),e.perColumnSums[o]=h,e.total+=h})}),console.log("[MeasureUniverse] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log(`[MeasureUniverse] Total: $${e.total.toLocaleString(void 0,{minimumFractionDigits:2})}`),console.log(`[MeasureUniverse] Included measures: ${e.includedMeasureHeaders.length}`),console.log(`[MeasureUniverse] Dimensions: ${e.dimensionHeaders.length}`),console.log(`[MeasureUniverse] Excluded: ${e.excludedHeaders.length}`);let t=Object.entries(e.perColumnSums).sort((r,a)=>Math.abs(a[1])-Math.abs(r[1]));console.log("[MeasureUniverse] Top 10 included by dollars:"),t.slice(0,10).forEach(([r,a],n)=>{console.log(`   ${n+1}. ${r}: $${a.toLocaleString()}`)}),console.log("[MeasureUniverse] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),Vi=e}catch(t){console.error("[MeasureUniverse] Error:",t),e.error=t.message}return e}function Rk(){console.log("[MeasureUniverse] Cache invalidated"),Vi=null}async function Ik(){let e=await Xi();return e.error?{total:null,error:e.error,columns:[]}:{total:e.total,error:null,columns:e.includedMeasureHeaders}}async function Fk(){try{let e=Te(vd),t=js(e);Number.isFinite(t)&&(Me.bankAmount=t,It.bankAmount=t,console.log("[BankRecon] Loaded bank amount from config:",t))}catch(e){console.warn("[BankRecon] Error loading bank amount from config:",e)}}function Dk(e){let t=js(e);Number.isFinite(t)&&(Qe(vd,t),console.log("[BankRecon] Saved bank amount to config:",t))}function _d(e={}){Object.assign(Me,e);let t=Number(Me.systemTotal),r=Number(Me.bankAmount);Number.isFinite(t)&&Number.isFinite(r)?(Me.difference=r-t,Me.isReconciled=Math.abs(Me.difference)<=Tk):(Me.difference=null,Me.isReconciled=!1),It.cleanTotal=Me.systemTotal,It.bankAmount=Me.bankAmount,It.bankDifference=Me.difference,console.log("[BankRecon] State updated:",{systemTotal:Me.systemTotal,bankAmount:Me.bankAmount,difference:Me.difference,isReconciled:Me.isReconciled})}async function wd(){Me.loading=!0,Me.lastError=null;try{Me.bankAmount===null&&await Fk();let e=await Ik();return _d({systemTotal:e.total,amountColumns:e.columns,lastError:e.error,loading:!1}),e}catch(e){return Me.loading=!1,Me.lastError=e.message,console.error("[BankRecon] Refresh failed:",e),{total:null,error:e.message,columns:[]}}}function td(e){let t=e!=null&&e.target&&e.target instanceof HTMLInputElement?e.target:document.getElementById("step1-bank-amount-input"),r=js(t==null?void 0:t.value),a=xd(r);t&&(t.value=a),_d({bankAmount:r}),Dk(r),Nk()}function Nk(){let e=document.getElementById("step1-system-total-value"),t=document.getElementById("step1-bank-diff-value"),r=document.getElementById("step1-bank-diff-hint"),a=document.getElementById("step1-recon-status");e&&(e.value=Xr(Me.systemTotal)),t&&(t.value=Me.difference!=null?Xr(Me.difference):"---"),r&&(Me.difference===null?r.textContent="":Me.isReconciled?(r.textContent="Reconciled",r.className="pf-metric-hint pf-metric-hint--success"):(r.textContent=`Difference of ${Xr(Math.abs(Me.difference))} exceeds tolerance.`,r.className="pf-metric-hint pf-metric-hint--warning")),a&&(Me.lastError?a.innerHTML=`<p class="pf-step-note">${we(Me.lastError)}</p>`:a.innerHTML="")}function Ok(){let e=Me.systemTotal!==null,t=e?Xr(Me.systemTotal):"---",r=xd(Me.bankAmount),a=Me.difference!=null?Xr(Me.difference):"---",n="",s="pf-metric-hint",i="",o="";Me.loading?(i='<span class="pf-status-badge pf-status-badge--pending" role="status"><span>Loading</span></span>',n="Calculating system total...",o="Bank reconciliation loading"):!e&&!Me.lastError?(i='<span class="pf-status-badge pf-status-badge--unavailable" role="status"><span>Pending</span></span>',n="Click 'Create Matrix' above to generate PR_Data_Clean, then the system total will appear here.",s="pf-metric-hint pf-metric-hint--info",o="Bank reconciliation pending - waiting for PR_Data_Clean"):Me.lastError?(i='<span class="pf-status-badge pf-status-badge--unavailable" role="status"><span>Unavailable</span></span>',n=Me.lastError,s="pf-metric-hint pf-metric-hint--error",o="Bank reconciliation unavailable: "+Me.lastError):Me.difference!==null?Me.isReconciled?(i='<span class="pf-status-badge pf-status-badge--ok" role="status"><span>Reconciled</span></span>',n="System total matches bank statement within tolerance.",s="pf-metric-hint pf-metric-hint--success",o="Bank reconciliation passed"):(i='<span class="pf-status-badge pf-status-badge--review" role="status"><span>Review</span></span>',n=`Difference of ${Xr(Math.abs(Me.difference))} exceeds tolerance.`,s="pf-metric-hint pf-metric-hint--warning",o="Bank reconciliation needs review - difference exceeds tolerance"):e&&!Me.bankAmount&&(i='<span class="pf-status-badge pf-status-badge--pending" role="status"><span>Pending</span></span>',n="Enter your bank statement amount to compare.",s="pf-metric-hint pf-metric-hint--info",o="Bank reconciliation pending - enter bank amount");let l=e?`
        <button type="button" class="pf-action-toggle pf-action-toggle--subtle pf-clickable" id="bank-recon-refresh-btn" title="Refresh system total" style="margin-left: auto;">
            ${$i}
        </button>
    `:"";return`
        <article class="pf-step-card pf-step-detail pf-config-card" id="bank-recon-card" aria-label="${o}">
            <div class="pf-config-head" style="display: flex; align-items: center;">
                <div>
                    <h3>Bank Reconciliation ${i}</h3>
                    <p class="pf-config-subtext">Compare payroll total to the amount pulled from the bank.</p>
                </div>
                ${l}
            </div>
            <div id="step1-recon-status"></div>
            <div class="pf-config-grid pf-metric-grid">
                <label class="pf-config-field">
                    <span>System Total (PR_Data_Clean)</span>
                    <input id="step1-system-total-value" type="text" class="pf-readonly-input pf-metric-value" value="${t}" readonly aria-label="System total from PR_Data_Clean">
                </label>
                <label class="pf-config-field">
                    <span>Bank Statement Amount</span>
                    <input
                        type="text"
                        inputmode="decimal"
                        id="step1-bank-amount-input"
                        class="pf-metric-input"
                        value="${we(r)}"
                        placeholder="0.00"
                        aria-label="Enter bank statement amount"
                        ${e?"":"disabled"}
                    >
                </label>
                <label class="pf-config-field">
                    <span>Difference</span>
                    <input id="step1-bank-diff-value" type="text" class="pf-readonly-input pf-metric-value" value="${a}" readonly aria-label="Difference between system and bank totals">
                </label>
            </div>
            <p class="${s}" id="step1-bank-diff-hint">${we(n)}</p>
        </article>
    `}var wt={loading:!1,lastError:null,hasData:!1,joinKeyUsed:null,employee:{rosterCount:0,payrollCount:0,missingFromPayroll:[],extraInPayroll:[],status:"pending"},department:{rosterDepts:[],payrollDepts:[],missingFromPayroll:[],extraInPayroll:[],status:"pending"}};function ha(e){return e==null?"":String(e).trim().toLowerCase().replace(/\s+/g," ").replace(/[.,'"]/g,"").replace(/\s+(jr|sr|ii|iii|iv)$/i," $1")}function zi(e,t){if(t<0||!e||e.length===0)return!1;let r=Math.max(1,Math.floor(e.length*.1)),a=0;for(let n of e){let s=String(n[t]||"").trim();if(s.length>0&&!s.includes(" ")&&(a++,a>=r))return!0}return!1}function Ed(e,t=null){let r=e.findIndex(o=>o.includes("employee")&&o.includes("id")&&!o.includes("name")),a=e.findIndex(o=>o.includes("emp")&&o.includes("id")||o==="empid"||o==="emp_id"),n=r>=0?r:a;if(n>=0){if(!t||zi(t,n))return{index:n,type:"Employee_ID"};console.log(`[JoinKey] Employee_ID column found at index ${n} but has no values - falling back to Employee_Name`)}let s=e.findIndex(o=>o.includes("employee")&&(o.includes("name")||!o.includes("id")));if(s>=0)return{index:s,type:"Employee_Name"};let i=e.findIndex(o=>o.includes("employee"));return i>=0?{index:i,type:"Employee_Name"}:{index:-1,type:null}}async function bd(){if(!mt()){wt.lastError="Excel runtime unavailable.",wt.hasData=!1,wt.employee.status="unavailable",wt.department.status="unavailable";return}wt.loading=!0,wt.lastError=null,wt.employee.status="pending",wt.department.status="pending";try{let e=await Excel.run(async t=>{let r=t.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(r.load("isNullObject"),await t.sync(),r.isNullObject)return{error:"Connect or create an employee roster (SS_Employee_Roster) to enable coverage checks.",status:"unavailable"};let a=t.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN);if(a.load("isNullObject"),await t.sync(),a.isNullObject)return{error:"Run 'Create Matrix' to generate PR_Data_Clean first.",status:"unavailable"};let n=r.getRangeByIndexes(0,0,1,20),s=a.getRangeByIndexes(0,0,1,50);n.load("values"),s.load("values"),await t.sync();let i=(n.values[0]||[]).map(Z=>Da(String(Z||""))),o=(s.values[0]||[]).map(Z=>Da(String(Z||""))),l=i.findIndex(Z=>Z.includes("employee")&&Z.includes("id")&&!Z.includes("name")),c=o.findIndex(Z=>Z.includes("employee")&&Z.includes("id")&&!Z.includes("name")),f=i.findIndex(Z=>Z.includes("employee")&&(Z.includes("name")||!Z.includes("id"))),d=o.findIndex(Z=>Z.includes("employee")&&(Z.includes("name")||!Z.includes("id")));if(f<0||d<0){let Z=[];return f<0&&Z.push("roster"),d<0&&Z.push("PR_Data_Clean"),{error:`Employee identifier column not found in ${Z.join(" and ")}. Check your column mappings.`,status:"unavailable"}}let h=Hs(i),p=Hs(o),m=i.findIndex(Z=>Z==="employment_status"||Z==="status"),u=r.getUsedRangeOrNullObject(),g=a.getUsedRangeOrNullObject();if(u.load(["values","rowCount"]),g.load(["values","rowCount"]),await t.sync(),u.isNullObject||u.rowCount<2)return{error:"Employee roster is empty.",status:"unavailable"};if(g.isNullObject||g.rowCount<2)return{error:"PR_Data_Clean is empty. Run 'Create Matrix' first.",status:"unavailable"};let v=u.values||[],y=g.values||[],x=v.slice(1),b=y.slice(1),C=l>=0&&zi(x,l),w=c>=0&&zi(b,c),_=C&&w,k=_?"Employee_ID":"Employee_Name",S=_?l:f,D=_?c:d;console.log("[PayrollCoverage] Join key determination:"),console.log(`  - Roster has Employee_ID column: ${l>=0}, with values: ${C}`),console.log(`  - Payroll has Employee_ID column: ${c>=0}, with values: ${w}`),console.log(`  - Using join key: ${k}`);let R=new Map,T=new Map,V=0;for(let Z=1;Z<v.length;Z++){let X=v[Z],F=X[S],U=ha(F);if(!(!U||Gi(U))){if(m>=0){let P=String(X[m]||"").toLowerCase().trim();if(P==="terminated"||P==="inactive"||P==="term"){V++;continue}}if(!R.has(U)){let P=h>=0?ha(X[h]):"";R.set(U,{name:cn(F)||U,department:P})}}}for(let Z=1;Z<y.length;Z++){let X=y[Z],F=X[D],U=ha(F);if(!(!U||Gi(U))&&!T.has(U)){let P=p>=0?ha(X[p]):"";T.set(U,{name:cn(F)||U,department:P})}}if(R.size===0)return{error:`No employees found in roster using ${k}.`,status:"unavailable"};if(T.size===0)return{error:`No employees found in PR_Data_Clean using ${k}. Check column mapping.`,status:"unavailable"};let G=[],W=[];R.forEach((Z,X)=>{T.has(X)||G.push({name:Z.name,department:Z.department||"\u2014"})}),T.forEach((Z,X)=>{R.has(X)||W.push({name:Z.name,department:Z.department||"\u2014"})});let j=new Set,se=new Set;R.forEach(Z=>{Z.department&&j.add(Z.department)}),T.forEach(Z=>{Z.department&&se.add(Z.department)});let q=[...j].filter(Z=>!se.has(Z)),K=[...se].filter(Z=>!j.has(Z));return{hasData:!0,joinKeyUsed:k,employee:{rosterCount:R.size,terminatedCount:V,payrollCount:T.size,missingFromPayroll:G,extraInPayroll:W,status:G.length>0||W.length>0?"review":"ok"},department:{rosterDepts:[...j],payrollDepts:[...se],missingFromPayroll:q,extraInPayroll:K,status:q.length>0||K.length>0?"review":"ok"}}});e.error?(wt.lastError=e.error,wt.hasData=!1,wt.joinKeyUsed=null,wt.employee.status=e.status||"unavailable",wt.department.status=e.status||"unavailable"):(wt.hasData=!0,wt.joinKeyUsed=e.joinKeyUsed,wt.employee=e.employee,wt.department=e.department,wt.lastError=null,console.log("[PayrollCoverage] Analysis complete:",{joinKey:e.joinKeyUsed,rosterEmployees:e.employee.rosterCount,payrollEmployees:e.employee.payrollCount,missingFromPayroll:e.employee.missingFromPayroll.length,extraInPayroll:e.employee.extraInPayroll.length,deptMismatches:e.department.missingFromPayroll.length+e.department.extraInPayroll.length}))}catch(e){console.error("[PayrollCoverage] Error:",e),wt.lastError=`Coverage check failed: ${e.message}`,wt.hasData=!1,wt.joinKeyUsed=null,wt.employee.status="unavailable",wt.department.status="unavailable"}finally{wt.loading=!1}}function Pk(){let e=Ve,t="",r="",a="";if(e.loading)t="Checking...",r="pf-expand-bar--muted",a='<span class="pf-status-badge pf-status-badge--pending" role="status"><span>Loading</span></span>';else if(e.lastError)t="Unavailable",r="pf-expand-bar--muted",a='<span class="pf-status-badge pf-status-badge--unavailable" role="status"><span>Unavailable</span></span>';else if(!e.hasData)t="Run Create Matrix",r="pf-expand-bar--muted",a='<span class="pf-status-badge pf-status-badge--pending" role="status"><span>Pending</span></span>';else{let n=(e.newHires||[]).length,s=(e.missingEmployees||[]).length,i=(e.reactivations||[]).length;if(n+s+i===0)t="Roster in sync",r="pf-expand-bar--success",a='<span class="pf-status-badge pf-status-badge--ok" role="status"><span>OK</span></span>';else{let l=[];n>0&&l.push(`+${n} new`),s>0&&l.push(`\u2212${s} termed`),i>0&&l.push(`${i} reactivated`),t=l.join(", "),r="pf-expand-bar--warning",a='<span class="pf-status-badge pf-status-badge--review" role="status"><span>Review</span></span>'}}return`
        <article class="pf-step-card pf-step-detail pf-config-card" id="employee-coverage-card">
            <div class="pf-config-head">
                <h3>Employee Roster ${a}</h3>
                <p class="pf-config-subtext">Compare payroll employees to local roster. Click to review changes.</p>
            </div>
            <button type="button" class="pf-expand-bar ${r} pf-clickable" id="employee-coverage-bar">
                <svg class="pf-expand-bar-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <polyline points="6 9 12 15 18 9"/>
                </svg>
                <span class="pf-expand-bar-label">Reconciliation</span>
                <span class="pf-expand-bar-count">${t}</span>
            </button>
        </article>
    `}function Lk(){let e=Ve,t=document.getElementById("coverage-detail-modal");t&&t.remove();let r="";e.loading?r='<p class="pf-subsection-hint">Analyzing coverage...</p>':e.lastError?r=`<p class="pf-subsection-hint pf-subsection-hint--warn">${we(e.lastError)}</p>`:e.hasData?r=$k():r=`<p class="pf-subsection-hint">Run 'Create Matrix' first to compare payroll vs roster.</p>`;let a=document.createElement("div");a.id="coverage-detail-modal",a.className="pf-coverage-modal",a.innerHTML=`
        <div class="pf-coverage-modal-backdrop" data-close></div>
        <div class="pf-coverage-modal-card">
            <div class="pf-coverage-modal-header">
                <h3 class="pf-coverage-modal-title">Employee Roster Reconciliation</h3>
                <button class="pf-coverage-modal-close pf-clickable" type="button" aria-label="Close" data-close>
                    ${Mi}
                </button>
            </div>
            <div class="pf-coverage-modal-body">
                ${r}
            </div>
            <div class="pf-modal-footer">
                ${e.hasData&&((e.newHires||[]).length>0||(e.missingEmployees||[]).length>0||(e.reactivations||[]).length>0)?'<button type="button" class="pf-pill-btn pf-pill-btn--primary" id="modal-roster-apply-btn">Push Selected to Roster</button>':'<button type="button" class="pf-pill-btn" data-close>Close</button>'}
            </div>
        </div>
    `,document.body.appendChild(a),a.querySelectorAll("[data-close]").forEach(i=>{i.addEventListener("click",()=>a.remove())}),a.querySelectorAll(".pf-recon-checkbox").forEach(i=>{i.addEventListener("change",()=>{let o=i.dataset.action,l=i.dataset.key;if(!(!o||!l)){if(i.checked){if(o==="reactivate"){let c=(Ve.reactivations||[]).find(f=>String(f.key||f.name)===String(l));c!=null&&c.isManuallyManaged?Ve.overrides.set(l,{action:"reactivate"}):Ve.overrides.delete(l)}else Ve.overrides.delete(l);return}o==="new"?Ve.overrides.set(l,{action:"ignore"}):o==="terminate"?Ve.overrides.set(l,{action:"keep_active"}):o==="reactivate"&&Ve.overrides.set(l,{action:"keep_terminated"})}})});let n=a.querySelector("#modal-roster-apply-btn");n&&n.addEventListener("click",async()=>{await Ad(),a.remove()});let s=i=>{i.key==="Escape"&&(a.remove(),document.removeEventListener("keydown",s))};document.addEventListener("keydown",s)}function $k(){let e=Ve,t=e.newHires||[],r=e.missingEmployees||[],a=e.reactivations||[],n=e.stillActive||0,s=n+t.length+a.length,i=n+r.length,o=t.length+a.length-r.length,l='<div class="pf-roster-reconciliation">';l+=`
        <div class="pf-recon-row pf-recon-row--header">
            <span class="pf-recon-label">Employees per Payroll Report</span>
            <span class="pf-recon-value">${s}</span>
        </div>
    `,t.length>0||r.length>0||a.length>0?(l+='<div class="pf-recon-changes">',t.forEach((d,h)=>{let p=d.key||d.name;l+=`
                <div class="pf-recon-row pf-recon-row--add">
                    <label class="pf-recon-checkbox-label">
                        <input type="checkbox" class="pf-recon-checkbox" data-action="new" data-key="${we(p)}" checked>
                        <span class="pf-recon-name">New: ${we(d.name||p)}</span>
                    </label>
                    <span class="pf-recon-value pf-recon-value--add">+1</span>
                </div>
            `}),a.forEach(d=>{let h=d.key||d.name;l+=`
                <div class="pf-recon-row pf-recon-row--add">
                    <label class="pf-recon-checkbox-label">
                        <input type="checkbox" class="pf-recon-checkbox" data-action="reactivate" data-key="${we(h)}" checked>
                        <span class="pf-recon-name">Reactivate: ${we(d.name||h)}</span>
                    </label>
                    <span class="pf-recon-value pf-recon-value--add">+1</span>
                </div>
            `}),r.forEach(d=>{let h=d.key||d.name;l+=`
                <div class="pf-recon-row pf-recon-row--subtract">
                    <label class="pf-recon-checkbox-label">
                        <input type="checkbox" class="pf-recon-checkbox" data-action="terminate" data-key="${we(h)}" checked>
                        <span class="pf-recon-name">Termed: ${we(d.name||h)}</span>
                    </label>
                    <span class="pf-recon-value pf-recon-value--subtract">\u22121</span>
                </div>
            `}),l+="</div>"):l+=`
            <div class="pf-recon-row pf-recon-row--ok">
                <span class="pf-recon-label">No changes needed</span>
                <span class="pf-recon-value">\u2014</span>
            </div>
        `;let c=n+t.length+a.length;l+=`
        <div class="pf-recon-row pf-recon-row--footer">
            <span class="pf-recon-label">Total per Roster (after updates)</span>
            <span class="pf-recon-value">${c}</span>
        </div>
    `;let f=e.joinKeyUsed==="Employee_ID"?"Employee ID":"Employee Name";return l+=`
        <p class="pf-recon-hint">
            Matching by: <strong>${f}</strong>
        </p>
    `,l+="</div>",l}var Bs=80,on=["Employee_ID","Employee_Name","Department_Name","Employment_Status","First_Seen_Pay_Date","Last_Seen_Pay_Date","Termination_Effective_Date","Last_Terminated_Date","Hourly_Rate","Hourly_Rate_Prismhr","Rate_Source","Rate_Updated_Date","Is_Manually_Managed","Notes"],Mk={Employment_Status:"Unknown",Is_Manually_Managed:"FALSE",First_Seen_Pay_Date:"",Last_Seen_Pay_Date:"",Termination_Effective_Date:"",Last_Terminated_Date:"",Hourly_Rate:"",Hourly_Rate_Prismhr:"",Rate_Source:"",Rate_Updated_Date:"",Notes:""},Ve={loading:!1,lastError:null,hasData:!1,periodKey:null,joinKeyUsed:null,newHires:[],missingEmployees:[],reactivations:[],stillActive:0,status:"pending",applyPending:!1,overrides:new Map};async function Bk(){if(mt())try{await Excel.run(async e=>{let t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(t.load("isNullObject"),await e.sync(),t.isNullObject)return;let r=t.getUsedRangeOrNullObject();if(r.load("values, rowCount, columnCount"),await e.sync(),r.isNullObject||!r.values||r.values.length<2)return;let a=r.values[0].map(l=>String(l||"").toLowerCase().trim()),n=a.findIndex(l=>l==="employee_id"),s=a.findIndex(l=>l==="employee_name");if(n<0||s<0)return;let i=0,o=r.values;for(let l=1;l<o.length;l++){let c=String(o[l][n]||"").trim(),f=String(o[l][s]||"").trim();!c&&f&&(o[l][n]=f,i++)}i>0&&(r.values=o,await e.sync(),console.log(`[RosterBackfill] Populated ${i} empty Employee_ID cells with Employee_Name`))})}catch(e){console.warn("[RosterBackfill] Error:",e.message)}}async function kd(){if(!mt())return{ok:!1,error:"Excel runtime unavailable"};try{return await Excel.run(async e=>{var i;let t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(t.load("isNullObject"),await e.sync(),t.isNullObject){console.log("[RosterSchema] Creating SS_Employee_Roster sheet"),t=e.workbook.worksheets.add("SS_Employee_Roster");let o=t.getRangeByIndexes(0,0,1,on.length);return o.values=[on],o.format.font.bold=!0,await e.sync(),{ok:!0,created:!0,addedColumns:on}}let r=t.getUsedRangeOrNullObject();r.load("values, columnCount"),await e.sync();let a=[];!r.isNullObject&&r.values&&r.values.length>0&&(a=r.values[0].map(o=>String(o||"").trim()));let n=new Set(a.map(o=>o.toLowerCase())),s=on.filter(o=>!n.has(o.toLowerCase()));if(s.length>0){console.log("[RosterSchema] Adding missing columns:",s);let o=a.length,l=t.getRangeByIndexes(0,o,1,s.length);l.values=[s],l.format.font.bold=!0;let c=r.isNullObject?0:(((i=r.values)==null?void 0:i.length)||1)-1;if(c>0){let f=s.map(p=>Mk[p]||""),d=Array(c).fill(f),h=t.getRangeByIndexes(1,o,c,s.length);h.values=d}return await e.sync(),{ok:!0,created:!1,addedColumns:s}}return{ok:!0,created:!1,addedColumns:[]}})}catch(e){return console.error("[RosterSchema] Error:",e),{ok:!1,error:e.message}}await Bk()}async function Sd(e,t){if(!e)return console.warn("[CustomerMappings] No companyId provided"),[];let r="https://jgciqwzwacaesqjaoadc.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE";try{let n=await fetch(`${r}/rest/v1/ada_customer_column_mappings?company_id=eq.${encodeURIComponent(e)}&module=eq.${encodeURIComponent(t)}&select=raw_header,pf_column_name,expense_bucket,include_in_matrix`,{headers:{apikey:a,Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!n.ok)return console.warn("[CustomerMappings] Failed to fetch:",n.status,n.statusText),[];let s=await n.json();return console.log(`[CustomerMappings] Loaded ${s.length} mappings for company=${e}, module=${t}`),s}catch(n){return console.warn("[CustomerMappings] Error fetching mappings:",n.message),[]}}async function Cd(){if(!mt())return{ok:!1,error:"Excel runtime unavailable",rates:new Map};let e=Te("SS_Company_ID"),r=await Sd(e,"payroll-recorder");console.log(`[RateCalc] Loaded ${r.length} customer mappings`);try{return await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject("PR_Data_Clean");if(n.load("isNullObject"),await a.sync(),n.isNullObject)return console.log("[RateCalc] PR_Data_Clean not found"),{ok:!1,error:"PR_Data_Clean not found",rates:new Map};let s=n.getUsedRangeOrNullObject();if(s.load("values"),await a.sync(),s.isNullObject||!s.values||s.values.length<2)return console.log("[RateCalc] PR_Data_Clean is empty"),{ok:!1,error:"PR_Data_Clean is empty",rates:new Map};let i=s.values[0].map(p=>String(p||"").toLowerCase().trim()),o=s.values.slice(1),l=Ed(i);if(!l||l.index<0)return console.log("[RateCalc] No employee identifier column found"),{ok:!1,error:"No employee identifier column",rates:new Map};let c=nt.loaded?nt:null;console.log(`[RateCalc] Taxonomy has ${Object.keys((c==null?void 0:c.measures)||{}).length} measures loaded`),console.log(`[RateCalc] PR_Data_Clean headers: ${i.slice(0,10).join(", ")}...`);let f=[],d=[];if(console.log("[RateCalc] Customer mappings pf_column_names:",r.map(p=>({pf:p.pf_column_name,bucket:p.expense_bucket}))),console.log("[RateCalc] PR_Data_Clean headers to match:",i),i.forEach((p,m)=>{var y,x;let u=p.toLowerCase().trim(),g=r.find(b=>{var C,w;return((C=b.pf_column_name)==null?void 0:C.toLowerCase())===u||((w=b.raw_header)==null?void 0:w.toLowerCase())===u});if(!g){(u.includes("amount")||u.includes("wages")||u.includes("salary"))&&console.log(`[RateCalc] No mapping found for "${p}"`);return}let v=(g.expense_bucket||"").toUpperCase();if(v==="FIXED"){let b=(y=c==null?void 0:c.measures)==null?void 0:y[u],C=(x=b==null?void 0:b.sign)!=null?x:1;f.push({colIdx:m,sign:C}),d.push(p),console.log(`[RateCalc]   ${p}: bucket=FIXED, sign=${C}`)}else v&&console.log(`[RateCalc]   ${p}: bucket=${v} (not FIXED, skipping)`)}),console.log(`[RateCalc] Found ${f.length} FIXED columns: ${d.join(", ")||"(none)"}`),f.length===0)return console.warn("[RateCalc] No FIXED bucket columns found in customer mappings"),console.log("[RateCalc] Customer mappings expense_buckets:",[...new Set(r.map(p=>p.expense_bucket).filter(Boolean))]),{ok:!0,rates:new Map,warning:"No FIXED bucket columns in customer mappings"};let h=new Map;for(let p of o){let m=p[l.index],u=ha(m);if(!u||Gi(u))continue;let g=0;for(let{colIdx:v,sign:y}of f){let x=Number(p[v])||0;g+=x*y}if(h.has(u)){let v=h.get(u);v.fixedTotal+=g}else h.set(u,{fixedTotal:g})}for(let[p,m]of h)m.fixedTotal>0?m.hourlyRate=m.fixedTotal/Bs:m.hourlyRate=0;return console.log(`[RateCalc] Computed hourly rates for ${h.size} employees (Fixed / ${Bs} hrs)`),{ok:!0,rates:h}})}catch(a){return console.error("[RateCalc] Error:",a),{ok:!1,error:a.message,rates:new Map}}}async function Uk(){if(!mt())return;await id();let e=await kd();if(!e.ok){console.warn("[RosterRates] Cannot update rates - roster schema unavailable:",e.error);return}let t=await Cd();if(!t.ok||!t.rates||t.rates.size===0){console.warn("[RosterRates] No rates computed:",t.error||"no rows");return}let r=await Wl(),a=r.ok?r.joinKeyUsed:"Employee_ID",n=Us(fn())||Hn();await Excel.run(async s=>{let i=s.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(i.load("isNullObject"),await s.sync(),i.isNullObject){console.warn("[RosterRates] SS_Employee_Roster not found");return}let o=i.getUsedRangeOrNullObject();if(o.load("values,rowCount,columnCount"),await s.sync(),o.isNullObject||!o.values||o.values.length<2){console.warn("[RosterRates] SS_Employee_Roster is empty");return}let c=o.values[0].map(y=>String(y||"").trim()).map(y=>y.toLowerCase()),f={};on.forEach(y=>{f[y]=c.indexOf(y.toLowerCase())});let d=a==="Employee_ID"&&f.Employee_ID>=0?f.Employee_ID:f.Employee_Name;if(d<0){console.warn("[RosterRates] No join key column found on roster for",a);return}if(f.Hourly_Rate<0||f.Rate_Source<0||f.Rate_Updated_Date<0){console.warn("[RosterRates] Missing rate columns on roster (should not happen after ensureRosterSchema)");return}let h=o.values.slice(1),p=new Map;h.forEach((y,x)=>{let b=ha(y[d]);b&&p.set(b,{rowIndex:x+1,row:y})});let m=0,u=0,g=[],v=[];for(let[y,x]of t.rates.entries()){let b=p.get(y);if(!b){g.push(y);continue}if(m++,f.Is_Manually_Managed>=0?String(b.row[f.Is_Manually_Managed]||"").toUpperCase()==="TRUE":!1)continue;let w=Number(x==null?void 0:x.hourlyRate);if(!Number.isFinite(w)||w<=0){v.push(y);continue}let _=Number(b.row[f.Hourly_Rate])||0;(_===0||Math.abs(w-_)/_>.01)&&(i.getRangeByIndexes(b.rowIndex,f.Hourly_Rate,1,1).values=[[Math.round(w*100)/100]],i.getRangeByIndexes(b.rowIndex,f.Rate_Source,1,1).values=[[`Payroll (Fixed / ${Bs}hrs)`]],i.getRangeByIndexes(b.rowIndex,f.Rate_Updated_Date,1,1).values=[[n]],u++)}await s.sync(),console.log("[RosterRates] Update complete",{computedRates:t.rates.size,matched:m,updated:u,skippedNotFound:g.length,skippedInvalid:v.length,payrollDateISO:n}),g.length&&console.warn("[RosterRates] Employees not found in roster (skipped):",g.slice(0,25)),v.length&&console.warn("[RosterRates] Employees with invalid/unknown rate (skipped):",v.slice(0,25))})}async function Wl(){if(!mt())return{ok:!1,error:"Excel runtime unavailable"};try{return await Excel.run(async e=>{let t=e.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN);if(t.load("isNullObject"),await e.sync(),t.isNullObject)return{ok:!1,error:"PR_Data_Clean not found. Run Create Matrix first."};let r=t.getUsedRangeOrNullObject();if(r.load("values"),await e.sync(),r.isNullObject||!r.values||r.values.length<2)return{ok:!1,error:"PR_Data_Clean is empty."};let a=r.values[0].map(f=>Da(String(f||""))),n=r.values.slice(1),s=Ed(a,n);if(s.index<0)return{ok:!1,error:"No employee identifier column found in PR_Data_Clean."};console.log(`[RosterUpdate] Using join key: ${s.type} (column index ${s.index})`);let i=Hs(a),o=a.findIndex(f=>f==="payroll_date"||f==="pay_date"||f.includes("payroll")&&f.includes("date")||f.includes("pay")&&f.includes("date")),l=fn();if(!l&&o>=0&&n[0]){let f=n[0][o];l=Us(f)}l||(l=new Date().toISOString().split("T")[0]);let c=new Map;for(let f of n){let d=f[s.index],h=ha(d);!h||Gi(h)||c.has(h)||c.set(h,{name:cn(d)||h,department:i>=0?cn(f[i]):""})}return console.log(`[RosterUpdate] Extracted ${c.size} employees from PR_Data_Clean, period: ${l}`),{ok:!0,employees:c,periodKey:l,joinKeyUsed:s.type}})}catch(e){return console.error("[RosterUpdate] Extract error:",e),{ok:!1,error:e.message}}}async function Hk(){if(!mt())return{ok:!1,error:"Excel runtime unavailable"};try{return await Excel.run(async e=>{let t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(t.load("isNullObject"),await e.sync(),t.isNullObject)return{ok:!0,employees:new Map,headers:[],headerIndexes:{},isEmpty:!0};let r=t.getUsedRangeOrNullObject();if(r.load("values"),await e.sync(),r.isNullObject||!r.values||r.values.length<1)return{ok:!0,employees:new Map,headers:[],headerIndexes:{},isEmpty:!0};let a=r.values[0].map(f=>String(f||"").trim()),n=a.map(f=>f.toLowerCase()),s={};on.forEach(f=>{let d=n.indexOf(f.toLowerCase());s[f]=d});let i=r.values.slice(1),o=s.Employee_Name,l="Employee_Name";if(s.Employee_ID>=0&&(zi(i,s.Employee_ID)?(o=s.Employee_ID,l="Employee_ID"):console.log("[RosterUpdate] Roster has Employee_ID column but no values - using Employee_Name")),o<0)return{ok:!1,error:"No employee identifier column in roster."};console.log(`[RosterUpdate] Reading roster with join key: ${l} (column index ${o})`);let c=new Map;for(let f=0;f<i.length;f++){let d=i[f],h=d[o],p=ha(h);p&&c.set(p,{rowIndex:f+1,employeeId:s.Employee_ID>=0?d[s.Employee_ID]:"",employeeName:s.Employee_Name>=0?d[s.Employee_Name]:"",department:s.Department_Name>=0?d[s.Department_Name]:"",status:s.Employment_Status>=0?d[s.Employment_Status]:"Unknown",firstSeen:s.First_Seen_Pay_Date>=0?d[s.First_Seen_Pay_Date]:"",lastSeen:s.Last_Seen_Pay_Date>=0?d[s.Last_Seen_Pay_Date]:"",terminationDate:s.Termination_Effective_Date>=0?d[s.Termination_Effective_Date]:"",lastTerminatedDate:s.Last_Terminated_Date>=0?d[s.Last_Terminated_Date]:"",isManuallyManaged:s.Is_Manually_Managed>=0?String(d[s.Is_Manually_Managed]).toUpperCase()==="TRUE":!1,notes:s.Notes>=0?d[s.Notes]:"",rawRow:d})}return{ok:!0,employees:c,headers:a,headerIndexes:s,joinKeyType:l,isEmpty:c.size===0}})}catch(e){return console.error("[RosterUpdate] Read roster error:",e),{ok:!1,error:e.message}}}async function Td(){Ve.loading=!0,Ve.lastError=null;try{let e=await kd();if(!e.ok){Ve.lastError=e.error,Ve.status="unavailable";return}let t=await Wl();if(!t.ok){Ve.lastError=t.error,Ve.status="unavailable";return}let r=await Hk();if(!r.ok){Ve.lastError=r.error,Ve.status="unavailable";return}let a=t.employees,n=r.employees,s=t.periodKey,i=[],o=[],l=[],c=0;a.forEach((f,d)=>{if(!n.has(d))i.push({key:d,name:f.name,department:f.department});else{let h=n.get(d);String(h.status||"").toLowerCase()==="terminated"?l.push({key:d,name:h.employeeName||h.employeeId||d,department:f.department||h.department,terminationDate:h.terminationDate,isManuallyManaged:h.isManuallyManaged}):c++}}),n.forEach((f,d)=>{let h=String(f.status||"").toLowerCase();(h==="active"||h==="unknown"||h==="")&&!a.has(d)&&o.push({key:d,name:f.employeeName||f.employeeId||d,department:f.department,lastSeenDate:f.lastSeen,isManuallyManaged:f.isManuallyManaged})}),Ve.periodKey=s,Ve.joinKeyUsed=t.joinKeyUsed,Ve.newHires=i,Ve.missingEmployees=o,Ve.reactivations=l,Ve.stillActive=c,Ve.hasData=!0,i.length===0&&o.length===0&&l.length===0?Ve.status="ok":Ve.status="review",console.log(`[RosterUpdate] Deltas computed: ${i.length} new, ${o.length} missing, ${c} still active`)}catch(e){console.error("[RosterUpdate] Compute deltas error:",e),Ve.lastError=e.message,Ve.status="unavailable"}finally{Ve.loading=!1}}async function Ad(){if(!mt()){Ie("Excel runtime unavailable","error");return}Ve.applyPending=!0,Ie("Applying roster updates...","info",2e3);try{await Excel.run(async e=>{let t=e.workbook.worksheets.getItem("SS_Employee_Roster"),r=t.getUsedRangeOrNullObject();r.load("values, rowCount, columnCount"),await e.sync();let a=r.values[0].map(G=>String(G||"").trim()),n=a.map(G=>G.toLowerCase()),s={};on.forEach(G=>{s[G]=n.indexOf(G.toLowerCase())});let i=Ve.periodKey,o=r.values.slice(1),l=Ve.joinKeyUsed||"Employee_Name",c;l==="Employee_ID"&&s.Employee_ID>=0?c=s.Employee_ID:c=s.Employee_Name,console.log(`[RosterUpdate] Using join key: ${l} (roster column index: ${c})`);let f=new Map;o.forEach((G,W)=>{let j=ha(G[c]);j&&f.set(j,{rowIndex:W,row:G})}),console.log(`[RosterUpdate] Built rosterMap with ${f.size} entries using ${l}`);let d=[],h=[],p=0,m=0,u=0,g=0,v=await Cd(),y=v.ok?v.rates:new Map;console.log(`[RosterUpdate] Rate calculation: ${v.ok?y.size+" employees":v.error}`);let x=await Wl();x.ok&&x.employees.forEach((G,W)=>{let j=f.get(W);if(j){let se=s.Is_Manually_Managed>=0&&String(j.row[s.Is_Manually_Managed]||"").toUpperCase()==="TRUE";if(s.Last_Seen_Pay_Date>=0&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Last_Seen_Pay_Date,value:nn(i)}),!se&&s.Employment_Status>=0&&String(j.row[s.Employment_Status]||"").toLowerCase()!=="active"&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Employment_Status,value:"Active"}),!se&&s.Department_Name>=0&&G.department&&(String(j.row[s.Department_Name]||"").trim()||d.push({rowIndex:j.rowIndex+1,colIndex:s.Department_Name,value:G.department})),!se&&s.Hourly_Rate>=0){let q=y.get(W);if(q&&q.hourlyRate>0){let K=Number(j.row[s.Hourly_Rate])||0;(K===0||Math.abs(q.hourlyRate-K)/K>.01)&&(d.push({rowIndex:j.rowIndex+1,colIndex:s.Hourly_Rate,value:Math.round(q.hourlyRate*100)/100}),s.Rate_Source>=0&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Rate_Source,value:`Payroll (Fixed $${q.fixedTotal.toFixed(0)} / ${Bs}hrs)`}),s.Rate_Updated_Date>=0&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Rate_Updated_Date,value:i}),g++)}}p++}});let{newHires:b,overrides:C}=Ve;for(let G of b){let W=C.get(G.key);if((W==null?void 0:W.action)==="ignore")continue;let j=Array(a.length).fill("");s.Employee_ID>=0&&(l==="Employee_ID"?j[s.Employee_ID]=G.key:G.employeeId&&(j[s.Employee_ID]=G.employeeId)),s.Employee_Name>=0&&(j[s.Employee_Name]=G.name),s.Department_Name>=0&&(j[s.Department_Name]=G.department),s.Employment_Status>=0&&(j[s.Employment_Status]="Active"),s.First_Seen_Pay_Date>=0&&(j[s.First_Seen_Pay_Date]=nn(i)),s.Last_Seen_Pay_Date>=0&&(j[s.Last_Seen_Pay_Date]=nn(i)),s.Is_Manually_Managed>=0&&(j[s.Is_Manually_Managed]="FALSE");let se=y.get(G.key);se&&se.hourlyRate>0&&(s.Hourly_Rate>=0&&(j[s.Hourly_Rate]=Math.round(se.hourlyRate*100)/100),s.Rate_Source>=0&&(j[s.Rate_Source]=`Payroll (Fixed $${se.fixedTotal.toFixed(0)} / ${Bs}hrs)`),s.Rate_Updated_Date>=0&&(j[s.Rate_Updated_Date]=nn(i)),g++),h.push(j),m++}let{reactivations:w}=Ve,_=0;for(let G of w){let W=C.get(G.key);if(G.isManuallyManaged&&(W==null?void 0:W.action)!=="reactivate"||(W==null?void 0:W.action)==="keep_terminated")continue;let j=f.get(G.key);if(j){if(s.Last_Terminated_Date>=0&&G.terminationDate&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Last_Terminated_Date,value:nn(G.terminationDate)}),s.Termination_Effective_Date>=0&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Termination_Effective_Date,value:""}),s.Employment_Status>=0&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Employment_Status,value:"Active"}),s.Last_Seen_Pay_Date>=0&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Last_Seen_Pay_Date,value:nn(i)}),s.Notes>=0){let se=j.row[s.Notes]||"",q=`Reactivated ${i} (prev term: ${G.terminationDate||"unknown"})`;d.push({rowIndex:j.rowIndex+1,colIndex:s.Notes,value:se?`${se}; ${q}`:q})}_++}}let{missingEmployees:k}=Ve;for(let G of k){if(G.isManuallyManaged)continue;let W=C.get(G.key);if((W==null?void 0:W.action)==="keep_active"){let se=f.get(G.key);se&&s.Is_Manually_Managed>=0&&(d.push({rowIndex:se.rowIndex+1,colIndex:s.Is_Manually_Managed,value:"TRUE"}),d.push({rowIndex:se.rowIndex+1,colIndex:s.Notes,value:`Kept active by user override (${i})`}));continue}let j=f.get(G.key);j&&(s.Employment_Status>=0&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Employment_Status,value:"Terminated"}),s.Termination_Effective_Date>=0&&d.push({rowIndex:j.rowIndex+1,colIndex:s.Termination_Effective_Date,value:nn(i)}),u++)}let S=new Map;d.forEach(G=>{S.has(G.rowIndex)||S.set(G.rowIndex,[]),S.get(G.rowIndex).push(G)});for(let[G,W]of S)for(let j of W){let se=t.getRangeByIndexes(G,j.colIndex,1,1);se.values=[[j.value]]}if(h.length>0){let G=r.rowCount,W=t.getRangeByIndexes(G,0,h.length,a.length);W.values=h}let D="yyyy-mm-dd",R=[s.First_Seen_Pay_Date,s.Last_Seen_Pay_Date,s.Termination_Effective_Date,s.Last_Terminated_Date,s.Rate_Updated_Date].filter(G=>G>=0);for(let G of R){let W=r.rowCount-1;if(W>0){let j=t.getRangeByIndexes(1,G,W,1);j.numberFormat=[[D]]}}await e.sync(),console.log(`[RosterUpdate] Applied: ${m} added, ${_} reactivated, ${u} terminated, ${p} updated, ${g} rates updated`),Ve.newHires=[],Ve.missingEmployees=[],Ve.reactivations=[],Ve.overrides.clear(),Ve.status="ok";let T=[];m>0&&T.push(`${m} added`),_>0&&T.push(`${_} reactivated`),u>0&&T.push(`${u} terminated`),g>0&&T.push(`${g} rates updated`);let V=T.length>0?`Roster updated: ${T.join(", ")}`:"Roster is up to date";Ie(V,"success",4e3)})}catch(e){console.error("[RosterUpdate] Apply error:",e),Ie("Failed to update roster: "+e.message,"error",6e3)}finally{Ve.applyPending=!1,it()}}async function Vk(){let e=window.scrollY;await Td(),it(),requestAnimationFrame(()=>window.scrollTo(0,e))}function Us(e){if(e instanceof Date)return ma(e);if(typeof e=="number"&&!Number.isNaN(e)){let a=Rd(e);return a?ma(a):""}let t=String(e!=null?e:"").trim();if(!t)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;let r=new Date(t);if(!Number.isNaN(r.getTime())){let a=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");return`${a}-${n}-${s}`}return t}function Rd(e){if(!Number.isFinite(e))return null;let t=Math.floor(e-25569);if(!Number.isFinite(t))return null;let r=t*86400*1e3,a=new Date(r);return a._isUTC=!0,a}function Gl(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,a,n]=e.split("-").map(Number);return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a-1]} ${n}, ${r}`}let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function jk(e){if(e==null||e==="")return 0;let t=Number(e);return Number.isFinite(t)?t:0}async function Id(){console.log(`
`),console.log("\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557"),console.log("\u2551  EXPENSE REVIEW MEASURE PIPELINE TRACE                                   \u2551"),console.log("\u2551  Deep diagnostic for PR_Data_Clean \u2192 Expense Review data flow           \u2551"),console.log(`\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D
`);let e={phase0:{sheetName:null,usedRange:null,rowCount:0,colCount:0,headers:[],sampleData:[]},phase1:{allHeaders:[],numericCandidateHeaders:[],dimensionHeaders:[],measureHeadersAfterDimRemoval:[],matchedDictionaryHeaders:[],unmatchedHeaders:[],dictionaryMetadata:{}},phase2:{perColumnDecisions:[],includedColumns:[],excludedColumns:[],excludeReasonCounts:{}},totals:{TOTAL_NUMERIC_SHEET:0,TOTAL_AFTER_METADATA_JOIN:0,TOTAL_AFTER_INCLUSION_RULES:0,TOTAL_BURDEN_ONLY:0,delta:0,excludedSum:0}};if(!mt())return console.error("[Trace] Excel runtime not available"),e;try{return await Excel.run(async t=>{var vr,jt,dr;console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501"),console.log("PHASE 0: Sheet/Range Confirmation"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");let r=t.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN);if(r.load("name, isNullObject"),await t.sync(),r.isNullObject){console.error("[Trace] \u274C PR_Data_Clean sheet NOT FOUND!");return}e.phase0.sheetName=r.name,console.log(`[Trace] \u2713 Sheet found: ${r.name}`);let a=r.getUsedRangeOrNullObject();if(a.load("address, rowCount, columnCount, values"),await t.sync(),a.isNullObject){console.error("[Trace] \u274C Used range is null - sheet is empty!");return}e.phase0.usedRange=a.address,e.phase0.rowCount=a.rowCount,e.phase0.colCount=a.columnCount,console.log(`[Trace] \u2713 usedRange: ${a.address}`),console.log(`[Trace] \u2713 rowCount: ${a.rowCount}, colCount: ${a.columnCount}`);let n=a.values,i=(n[0]||[]).map(H=>String(H||"").trim()),o=i.map(H=>H.toLowerCase());e.phase0.headers=i.slice(0,30),console.log("[Trace] Headers (first 30):"),i.slice(0,30).forEach((H,fe)=>console.log(`   ${fe}: "${H}"`));let l=n.slice(1);console.log(`[Trace] Data rows: ${l.length}`);let c=[];for(let H=0;H<i.length&&c.length<5;H++){let fe=!1,Oe=[];for(let Je=0;Je<Math.min(5,l.length);Je++){let Ae=l[Je][H];(typeof Ae=="number"||!isNaN(Number(Ae))&&Ae!=="")&&(fe=!0,Oe.push(Ae))}fe&&c.push({header:i[H],samples:Oe})}e.phase0.sampleData=c,console.log("[Trace] Sample numeric columns:",c),console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("PHASE 1A: Raw Header Inventory"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501"),e.phase1.allHeaders=[...i],console.log(`[Trace] Total headers: ${i.length}`);let f=[],d={},h={};i.forEach((H,fe)=>{let Oe=0,Je=0,Ae=!1;for(let pt=0;pt<Math.min(200,l.length);pt++){let je=l[pt][fe],Ye=Number(je);isNaN(Ye)||(Ye!==0&&(Ae=!0,Je++),Oe+=Ye)}let tt=0;for(let pt of l){let je=Number(pt[fe]);isNaN(je)||(tt+=je)}d[H]=tt,h[H]=Je,Ae&&f.push({header:H,sum:tt,nonZeroCount:Je})}),e.phase1.numericCandidateHeaders=f.map(H=>H.header),console.log(`[Trace] Numeric candidate headers: ${f.length} of ${i.length}`),f.forEach(H=>console.log(`   ${H.header}: $${H.sum.toLocaleString()} (${H.nonZeroCount} non-zero)`)),console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("PHASE 1B: Dimension Detection"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");let p=nt;console.log(`[Trace] Taxonomy loaded: ${p.loaded}`),console.log(`[Trace] Dimensions in cache: ${((vr=p.dimensions)==null?void 0:vr.size)||0}`),console.log(`[Trace] Measures in cache: ${Object.keys(p.measures||{}).length}`),p.dimensions&&console.log(`[Trace] Dimension keywords: ${[...p.dimensions].slice(0,20).join(", ")}`);let m=[],u={},g=[];i.forEach((H,fe)=>{let Oe=H.toLowerCase(),Je=!1,Ae=null;p.loaded&&p.dimensions&&p.dimensions.has(Oe)&&(Je=!0,Ae="matched ada_payroll_dimensions"),Je?(m.push(H),u[H]=Ae):g.push(H)}),e.phase1.dimensionHeaders=m,e.phase1.measureHeadersAfterDimRemoval=g,console.log(`[Trace] Dimension headers detected: ${m.length}`),m.forEach(H=>console.log(`   ${H} \u2192 ${u[H]}`)),console.log(`[Trace] Measure candidates after dimension removal: ${g.length}`),console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("PHASE 1C: Dictionary Enrichment Join"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");let v=[],y=[],x={};g.forEach(H=>{let fe=H.toLowerCase().trim(),Oe=p.loaded&&p.measures?p.measures[fe]:null;Oe?(v.push(H),x[H]={pf_column_name:H,data_type:Oe.data_type||"number",term_type:Oe.term_type||null,side:Oe.side||null,bucket:Oe.bucket||null,include:Oe.include,sign:Oe.sign}):y.push(H)}),e.phase1.matchedDictionaryHeaders=v,e.phase1.unmatchedHeaders=y,e.phase1.dictionaryMetadata=x,console.log(`[Trace] Matched dictionary headers: ${v.length}`),v.forEach(H=>{let fe=x[H];console.log(`   ${H}: side=${fe.side}, bucket=${fe.bucket}, include=${fe.include}, sign=${fe.sign}`)}),console.log(`[Trace] Unmatched headers (NOT in dictionary): ${y.length}`),y.forEach(H=>console.log(`   ${H}`)),console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("PHASE 1D: Inclusion Filter Decisions"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");let b=[],C=[],w=[],_={};i.forEach((H,fe)=>{let Oe=H.toLowerCase(),Je=d[H]||0,Ae=h[H]||0,tt=f.some(ga=>ga.header===H),pt=m.includes(H),je=x[H]||null,Ye="EXCLUDE",Wt="unknown";if(pt)Wt="dimension";else if(!tt)Wt="non_numeric";else if(ji.has(Oe))Wt="summary_exclusion";else if(je){let ga=Vl(je,Oe);ga.include?(Ye="INCLUDE",Wt=null):Wt=ga.reason||"unknown_meta_rule"}else Oe.includes("amount")?(Ye="INCLUDE",Wt=null):Oe.includes("rate")||Oe.includes("percent")||Oe.includes("pct")?Wt="rate_or_percent_column":(Ye="INCLUDE",Wt=null);let Yr={header:H,colIdx:fe,isNumeric:tt,isDimension:pt,matchedDictionary:!!je,side:(je==null?void 0:je.side)||null,bucket:(je==null?void 0:je.bucket)||null,includeFlag:je==null?void 0:je.include,includeDecision:Ye,excludeReason:Wt,sum:Je,absSum:Math.abs(Je),nonZeroCount:Ae};b.push(Yr),Ye==="INCLUDE"?C.push(Yr):(w.push(Yr),_[Wt]=(_[Wt]||0)+1)}),e.phase2.perColumnDecisions=b,e.phase2.includedColumns=C,e.phase2.excludedColumns=w,e.phase2.excludeReasonCounts=_;let k=[...C].sort((H,fe)=>fe.absSum-H.absSum).slice(0,15),S=[...w].sort((H,fe)=>fe.absSum-H.absSum).slice(0,15);console.log(`
[Trace] INCLUDED columns: ${C.length}`),console.log("[Trace] Top 15 INCLUDED by dollars:"),k.forEach((H,fe)=>{console.log(`   ${fe+1}. ${H.header}: $${H.sum.toLocaleString()} (dict=${H.matchedDictionary}, side=${H.side}, bucket=${H.bucket})`)}),console.log(`
[Trace] EXCLUDED columns: ${w.length}`),console.log("[Trace] Exclusion reason breakdown:"),Object.entries(_).sort((H,fe)=>fe[1]-H[1]).forEach(([H,fe])=>{console.log(`   ${H}: ${fe} columns`)}),console.log(`
[Trace] Top 15 EXCLUDED by dollars:`),S.forEach((H,fe)=>{console.log(`   ${fe+1}. ${H.header}: $${H.sum.toLocaleString()} (reason=${H.excludeReason}, side=${H.side})`)}),console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("PHASE 2: Reconciling Totals"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");let D=f.filter(H=>!m.includes(H.header)).reduce((H,fe)=>H+fe.sum,0),R=f.filter(H=>v.includes(H.header)).reduce((H,fe)=>H+fe.sum,0),T=C.reduce((H,fe)=>H+fe.sum,0),V=C.filter(H=>{var fe;return((fe=H.bucket)==null?void 0:fe.toUpperCase())==="BURDEN"}).reduce((H,fe)=>H+fe.sum,0),G=D-T,W=w.reduce((H,fe)=>H+fe.sum,0);e.totals={TOTAL_NUMERIC_SHEET:D,TOTAL_AFTER_METADATA_JOIN:R,TOTAL_AFTER_INCLUSION_RULES:T,TOTAL_BURDEN_ONLY:V,delta:G,excludedSum:W};let j=H=>`$${H.toLocaleString(void 0,{minimumFractionDigits:2})}`;console.log(`
[Trace] RECONCILING TOTALS:`),console.log(`   1. TOTAL_NUMERIC_SHEET (all numeric, excl dimensions): ${j(D)}`),console.log(`   2. TOTAL_AFTER_METADATA_JOIN (matched dictionary):     ${j(R)}`),console.log(`   3. TOTAL_AFTER_INCLUSION_RULES (final included):       ${j(T)}`),console.log(`   4. TOTAL_BURDEN_ONLY (bucket=BURDEN):                   ${j(V)}`),console.log(`
[Trace] DELTA ANALYSIS:`),console.log(`   Delta (NUMERIC_SHEET - INCLUSION_RULES): ${j(G)}`),console.log(`   Sum of excluded columns:                 ${j(W)}`),console.log(`   Reconciles: ${Math.abs(G-W)<1?"\u2705 YES":"\u274C NO (gap: "+j(G-W)+")"}`),console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("PHASE 3: Hypothesis Tests"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");let se=i.filter(H=>H.toLowerCase().includes("rate")),q=i.filter(H=>H.toLowerCase().includes("amount"));console.log(`
[Hypothesis A] Rate vs Amount columns:`),console.log(`   *Rate* columns: ${se.length} \u2192 ${se.slice(0,10).join(", ")}`),console.log(`   *Amount* columns: ${q.length} \u2192 ${q.slice(0,10).join(", ")}`);let K=se.reduce((H,fe)=>H+(d[fe]||0),0),Z=q.reduce((H,fe)=>H+(d[fe]||0),0);console.log(`   Rate columns sum: ${j(K)}`),console.log(`   Amount columns sum: ${j(Z)}`);let X=C.filter(H=>H.header.toLowerCase().includes("rate")),F=C.filter(H=>H.header.toLowerCase().includes("amount"));console.log(`   Rate columns INCLUDED: ${X.length}`),console.log(`   Amount columns INCLUDED: ${F.length}`);let U=m.filter(H=>H.toLowerCase().includes("amount")||H.toLowerCase().includes("pay")||H.toLowerCase().includes("wage")||H.toLowerCase().includes("salary"));console.log(`
[Hypothesis B] Dimension over-detection:`),console.log(`   Suspect dimensions (should be measures): ${U.length}`),U.forEach(H=>console.log(`   \u26A0\uFE0F ${H} flagged as dimension but looks like a measure`));let P=g.length>0?(v.length/g.length*100).toFixed(1):0;console.log(`
[Hypothesis C] Dictionary join success rate: ${P}%`),console.log(`   ${v.length} matched, ${y.length} unmatched`),y.length>0&&(console.log("   Sample unmatched (check normalization):"),y.slice(0,10).forEach(H=>{let fe=H.toLowerCase().trim();console.log(`     "${H}" \u2192 normalized: "${fe}"`)}));let B=w.filter(H=>!H.matchedDictionary&&H.isNumeric&&!H.isDimension),Y=w.filter(H=>{var fe;return(fe=H.excludeReason)==null?void 0:fe.includes("side")});console.log(`
[Hypothesis D] Inclusion filter analysis:`),console.log(`   Excluded by missing metadata: ${B.length} columns, ${j(B.reduce((H,fe)=>H+fe.sum,0))}`),console.log(`   Excluded by side (ee/na): ${Y.length} columns, ${j(Y.reduce((H,fe)=>H+fe.sum,0))}`),console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("PHASE 4: Export Debug Report"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");try{let H=t.workbook.worksheets.getItemOrNullObject("PF_Debug_ExpenseReview");H.load("isNullObject"),await t.sync(),H.isNullObject||(H.delete(),await t.sync()),H=t.workbook.worksheets.add("PF_Debug_ExpenseReview"),H.visibility=Excel.SheetVisibility.hidden;let fe=["header","isNumericCandidate","isDimension","matchedDictionary","side","bucket","includeFlag","includeDecision","excludeReason","sum","absSum","nonZeroCount"],Oe=b.sort((Ye,Wt)=>Wt.absSum-Ye.absSum).map(Ye=>[Ye.header,Ye.isNumeric?"TRUE":"FALSE",Ye.isDimension?"TRUE":"FALSE",Ye.matchedDictionary?"TRUE":"FALSE",Ye.side||"",Ye.bucket||"",Ye.includeFlag===void 0?"":String(Ye.includeFlag),Ye.includeDecision,Ye.excludeReason||"",Ye.sum,Ye.absSum,Ye.nonZeroCount]),Je=[fe,...Oe],Ae=H.getRange(`A1:L${Je.length}`);Ae.values=Je;let tt=H.getRange("A1:L1");tn(tt);let pt=Je.length+3,je=H.getRange(`A${pt}:C${pt+10}`);je.values=[["SUMMARY","",""],["","",""],["TOTAL_NUMERIC_SHEET",D,""],["TOTAL_AFTER_METADATA_JOIN",R,""],["TOTAL_AFTER_INCLUSION_RULES",T,""],["TOTAL_BURDEN_ONLY",V,""],["","",""],["DELTA (excluded)",G,""],["SUM OF EXCLUDED COLUMNS",W,""],["RECONCILES?",Math.abs(G-W)<1?"YES":"NO",""]],await t.sync(),console.log("[Trace] \u2713 Debug sheet created: PF_Debug_ExpenseReview (hidden)"),console.log("[Trace] \u2713 To view: Right-click sheet tabs \u2192 Unhide \u2192 PF_Debug_ExpenseReview")}catch(H){console.warn("[Trace] Could not create debug sheet:",H)}console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("WAGES SPOTLIGHT: Focused verification of wage/salary columns"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");let Q=["wages","salary","regular_pay","pay_amount","hourly","base_pay"],J=i.filter(H=>{let fe=H.toLowerCase();return Q.some(Oe=>fe.includes(Oe))});console.log(`
[WagesCheck] ALL headers (${i.length} total):`),i.forEach((H,fe)=>console.log(`   [${fe}] ${H}`));let oe=i.some(H=>H.toLowerCase()==="wages_salary_amount"),ae=i.some(H=>H.toLowerCase()==="regular_pay_amount"),be=((jt=b.find(H=>H.header.toLowerCase()==="wages_salary_amount"))==null?void 0:jt.sum)||0,O=((dr=b.find(H=>H.header.toLowerCase()==="regular_pay_amount"))==null?void 0:dr.sum)||0;if(console.log(`
[WagesCheck] hasWagesSalary=${oe}, sumWagesSalary=${j(be)}`),console.log(`[WagesCheck] hasRegularPay=${ae}, sumRegularPay=${j(O)}`),!oe){let H=i.filter(fe=>fe.toLowerCase().includes("wage")||fe.toLowerCase().includes("salary")).slice(0,5);console.log(`[WagesCheck] "Wages_Salary_Amount" NOT FOUND. Closest matches: ${H.join(", ")||"(none)"}`)}if(!ae){let H=i.filter(fe=>fe.toLowerCase().includes("regular")||fe.toLowerCase().includes("pay")).slice(0,5);console.log(`[WagesCheck] "Regular_Pay_Amount" NOT FOUND. Closest matches: ${H.join(", ")||"(none)"}`)}console.log(`
[WagesSpotlight] All wage-like columns (${J.length} found):`),J.forEach(H=>{let fe=b.find(Oe=>Oe.header===H);fe&&(console.log(`   ${H}: sum=${j(fe.sum)}, isNumeric=${fe.isNumeric}, isDim=${fe.isDimension}, dictMatch=${fe.matchedDictionary}, side=${fe.side}, bucket=${fe.bucket}, include=${fe.includeDecision}, reason=${fe.excludeReason||"(none)"}`),fe.sum>1e4&&fe.includeDecision!=="INCLUDE"&&console.error(`   \u26A0\uFE0F [WagesSpotlight][ALERT] High-dollar wage column EXCLUDED: ${H} reason=${fe.excludeReason} meta={side:${fe.side}, bucket:${fe.bucket}, include:${fe.includeFlag}}`))});let Se=C.filter(H=>Fa(H.bucket)==="FIXED"),ke=C.filter(H=>Fa(H.bucket)==="VARIABLE"),Ne=C.filter(H=>Fa(H.bucket)==="BURDEN"),pe=C.filter(H=>Fa(H.bucket)==="BENEFIT"),z=C.filter(H=>Fa(H.bucket)==="OTHER");console.log(`
[BucketBreakdown] Columns by bucket (INCLUDED only):`),console.log(`   FIXED (${Se.length}): ${j(Se.reduce((H,fe)=>H+fe.sum,0))} \u2192 ${Se.map(H=>H.header).join(", ")||"(none)"}`),console.log(`   VARIABLE (${ke.length}): ${j(ke.reduce((H,fe)=>H+fe.sum,0))} \u2192 ${ke.map(H=>H.header).join(", ")||"(none)"}`),console.log(`   BURDEN (${Ne.length}): ${j(Ne.reduce((H,fe)=>H+fe.sum,0))} \u2192 ${Ne.map(H=>H.header).join(", ")||"(none)"}`),console.log(`   BENEFITS (${pe.length}): ${j(pe.reduce((H,fe)=>H+fe.sum,0))} \u2192 ${pe.map(H=>H.header).join(", ")||"(none)"}`),console.log(`   OTHER/NULL (${z.length}): ${j(z.reduce((H,fe)=>H+fe.sum,0))} \u2192 ${z.map(H=>H.header+":"+H.bucket).join(", ")||"(none)"}`),e.bucketBreakdown={FIXED:{count:Se.length,sum:Se.reduce((H,fe)=>H+fe.sum,0),columns:Se.map(H=>H.header)},VARIABLE:{count:ke.length,sum:ke.reduce((H,fe)=>H+fe.sum,0),columns:ke.map(H=>H.header)},BURDEN:{count:Ne.length,sum:Ne.reduce((H,fe)=>H+fe.sum,0),columns:Ne.map(H=>H.header)},BENEFITS:{count:pe.length,sum:pe.reduce((H,fe)=>H+fe.sum,0),columns:pe.map(H=>H.header)},OTHER:{count:z.length,sum:z.reduce((H,fe)=>H+fe.sum,0),columns:z.map(H=>H.header)}},console.log(`
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501`),console.log("TASK 3: UI Pipeline Verification (parseExpenseRows output)"),console.log("\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501");let ce=Fd(n),ft=0,Ot=0,ze=0;ce.forEach(H=>{ft+=H.fixed||0,Ot+=H.variable||0,ze+=H.burden||0});let Pt=ft+Ot+ze;if(console.log(`[UIVerify] parseExpenseRows produced ${ce.length} rows`),console.log("[UIVerify] UI will show:"),console.log(`   FIXED: ${j(ft)}`),console.log(`   VARIABLE: ${j(Ot)}`),console.log(`   BURDEN: ${j(ze)}`),console.log(`   TOTAL: ${j(Pt)}`),console.log(`
[UIVerify] COMPARISON:`),console.log(`   Trace TOTAL_AFTER_INCLUSION_RULES: ${j(T)}`),console.log(`   UI TOTAL (fixed+variable+burden):  ${j(Pt)}`),console.log(`   MATCH: ${Math.abs(T-Pt)<1?"\u2705 YES":"\u274C NO - DISCREPANCY FOUND!"}`),Math.abs(T-Pt)>=1){let H=T-Pt;console.error(`
[UIVerify] \u26A0\uFE0F DISCREPANCY: ${j(H)}`),console.error("[UIVerify] This means the trace computation and parseExpenseRows use DIFFERENT logic!"),console.log(`
[UIVerify] Investigating parseExpenseRows classification...`)}e.uiTotals={fixed:ft,variable:Ot,burden:ze,total:Pt},e.discrepancy=T-Pt,console.log(`
\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557`),console.log("\u2551  TRACE COMPLETE                                                          \u2551"),console.log(`\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D
`)}),e}catch(t){return console.error("[Trace] Error during trace:",t),e}}typeof window!="undefined"&&(window.traceExpenseReviewMeasurePipeline=Id);function Fd(e,t=null){if(!e||e.length<2)return[];console.log("[parseExpenseRows] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("[parseExpenseRows] Using UNIFIED measure universe from Step 1");let a=(e[0]||[]).map(R=>String(R||"").trim());t||(console.warn("[parseExpenseRows] No measure universe provided - using fallback"),t={includedMeasureHeaders:a.filter(R=>R.toLowerCase().includes("amount")&&!yd.has(R.toLowerCase())),perColumnSums:{},total:0});let n={};a.forEach((R,T)=>{n[R]=T});let s=bt.customerMappings||[],i={},o=[];t.includedMeasureHeaders.forEach(R=>{var G,W,j,se;let T=R.toLowerCase(),V=s.find(q=>{var K,Z;return((K=q.pf_column_name)==null?void 0:K.toLowerCase())===T||((Z=q.raw_header)==null?void 0:Z.toLowerCase())===T});if(V!=null&&V.expense_bucket){let q=V.expense_bucket.toUpperCase(),K=(G=nt==null?void 0:nt.measures)==null?void 0:G[T];i[R]={bucket:q,sign:(W=K==null?void 0:K.sign)!=null?W:1,label:(K==null?void 0:K.label)||R,source:"customer_mapping"}}else{let q=(j=nt==null?void 0:nt.measures)==null?void 0:j[T];q?i[R]={bucket:Fa(q.bucket),sign:(se=q.sign)!=null?se:1,label:q.label||R,source:"dictionary"}:(i[R]={bucket:"UNCLASSIFIED",sign:1,label:R,source:"none"},o.push(R))}});let l={},c={customer_mapping:0,dictionary:0,none:0};Object.values(i).forEach(R=>{l[R.bucket]=(l[R.bucket]||0)+1,c[R.source]=(c[R.source]||0)+1}),console.log("[parseExpenseRows] Bucket distribution:",l),console.log("[parseExpenseRows] Classification sources:",c),o.length>0&&console.warn("[parseExpenseRows] UNCLASSIFIED columns (included in totals):",o),bt.unclassifiedColumns=o,bt.measureColumns=t.includedMeasureHeaders.map(R=>{var T,V;return{header:R,bucket:(T=i[R])==null?void 0:T.bucket,source:(V=i[R])==null?void 0:V.source,include:!0}}),bt.measureUniverse=t;let f=a.findIndex(R=>{let T=R.toLowerCase();return T==="employee_name"||T==="employee_id"||T.includes("employee")&&!T.includes("amount")}),d=Hs(a),h=a.findIndex(R=>{let T=R.toLowerCase();return T==="pay_date"||T==="payroll_date"||T.includes("payroll")&&T.includes("date")}),p=fn(),m=p?Us(p):"",u=h>=0;console.log("[parseExpenseRows] Column indexes:",{employee:f,department:d,payDate:h,hasPayDateColumn:u}),u?console.log("[parseExpenseRows] Using Pay_Date from row data (archive mode)"):(console.log("[parseExpenseRows] Using config Pay_Date (current period mode):",{raw:p,rawType:typeof p,normalized:m}),m||console.error("[parseExpenseRows] No Pay_Date configured in SS_PF_Config!"));let g=t.includedMeasureHeaders.map(R=>({header:R,index:n[R],metadata:i[R]})).filter(R=>R.index!==void 0);console.log(`[parseExpenseRows] Processing ${g.length} measure columns from universe`);let v=[],y=m||new Date().toISOString().split("T")[0],x=0,b=[];for(let R=1;R<e.length;R++){let T=e[R],V;if(u){let Z=T[h];b.length<5&&b.push({row:R,raw:Z,type:typeof Z});let X=Bn(Z);if(V=X?ma(X):Us(Z),!V){x++,x<=3&&console.warn(`[parseExpenseRows] Row ${R} has invalid Pay_Date, skipping:`,Z,typeof Z);continue}}else V=y;let G=f>=0?cn(T[f]):"",W=d>=0&&cn(T[d])||"Unassigned",j={FIXED:0,VARIABLE:0,BURDEN:0,BENEFITS:0,BENEFIT:0,TAX:0,DEDUCTION:0,REIMBURSEMENT:0,OTHER:0,UNCLASSIFIED:0};g.forEach(Z=>{var P,B,Y;let X=jk(T[Z.index]),F=(B=(P=Z.metadata)==null?void 0:P.sign)!=null?B:1,U=((Y=Z.metadata)==null?void 0:Y.bucket)||"UNCLASSIFIED";j[U]=(j[U]||0)+X*F});let se=(j.FIXED||0)+(j.REIMBURSEMENT||0),q=j.VARIABLE||0,K=(j.BURDEN||0)+(j.BENEFITS||0)+(j.BENEFIT||0)+(j.TAX||0)+(j.OTHER||0)+(j.UNCLASSIFIED||0);se===0&&q===0&&K===0||v.push({period:V,employee:G,department:W||"Unassigned",fixed:se,variable:q,burden:K,bucketTotals:j})}let C=0,w=0,_=0;v.forEach(R=>{C+=R.fixed,w+=R.variable,_+=R.burden});let k=C+w+_,S=[...new Set(v.map(R=>R.period))];console.log("[parseExpenseRows] \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500"),console.log(`[parseExpenseRows] Processed ${v.length} rows from ${e.length-1} input rows`),u?(console.log(`[parseExpenseRows] ARCHIVE MODE - Skipped ${x} rows with invalid Pay_Date`),console.log("[parseExpenseRows] Sample Pay_Date values:",b),console.log(`[parseExpenseRows] Distinct periods found: ${S.length}`,S)):console.log(`[parseExpenseRows] CURRENT MODE - All rows assigned period: ${y}`),console.log(`[parseExpenseRows] FIXED:    $${C.toLocaleString(void 0,{minimumFractionDigits:2})}`),console.log(`[parseExpenseRows] VARIABLE: $${w.toLocaleString(void 0,{minimumFractionDigits:2})}`),console.log(`[parseExpenseRows] BURDEN:   $${_.toLocaleString(void 0,{minimumFractionDigits:2})}`),console.log(`[parseExpenseRows] TOTAL:    $${k.toLocaleString(void 0,{minimumFractionDigits:2})}`),console.log(`[parseExpenseRows] Universe: $${t.total.toLocaleString(void 0,{minimumFractionDigits:2})}`);let D=Math.abs(k-t.total);return D>1?console.error(`[parseExpenseRows] \u26A0\uFE0F RECONCILIATION FAILED! Delta: $${D.toFixed(2)}`):console.log(`[parseExpenseRows] \u2705 RECONCILED with Step 1 universe (delta: $${D.toFixed(2)})`),console.log("[parseExpenseRows] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),v}function Wk(e){let t=new Map;e.forEach(a=>{let n=a.period;if(!n)return;t.has(n)||t.set(n,{key:n,label:Gl(n),employees:new Set,departments:new Map,summary:{fixed:0,variable:0,burden:0}});let s=t.get(n);s.employees.add(a.employee||`EMP-${s.employees.size+1}`);let i=a.department||"Unassigned";s.departments.has(i)||s.departments.set(i,{name:i,fixed:0,variable:0,burden:0,employees:new Set});let o=s.departments.get(i);o.fixed+=a.fixed,o.variable+=a.variable,o.burden+=a.burden,o.employees.add(a.employee||`EMP-${o.employees.size+1}`),s.summary.fixed+=a.fixed,s.summary.variable+=a.variable,s.summary.burden+=a.burden});let r=[];return t.forEach(a=>{let n=a.summary.fixed+a.summary.variable+a.summary.burden,s=Array.from(a.departments.values()).map(l=>{let c=l.fixed+l.variable,f=c+l.burden;return{name:l.name,fixed:l.fixed,variable:l.variable,gross:c,burden:l.burden,allIn:f,percent:n?f/n:0,headcount:l.employees.size,delta:0}});s.sort((l,c)=>c.allIn-l.allIn);let i={employeeCount:a.employees.size,fixed:a.summary.fixed,variable:a.summary.variable,burden:a.summary.burden,total:n,burdenRate:n?a.summary.burden/n:0,delta:0},o={name:"Totals",fixed:a.summary.fixed,variable:a.summary.variable,gross:a.summary.fixed+a.summary.variable,burden:a.summary.burden,allIn:n,percent:n?1:0,headcount:a.employees.size,delta:0,isTotal:!0};r.push({key:a.key,label:a.label,summary:i,departments:s,totalsRow:o})}),r.sort((a,n)=>a.key<n.key?1:-1)}function Gk(e){let t=new Map;if(!e||e.length<2)return t;let r=e[0],a=r.map(x=>String(x||"").toLowerCase().trim()),n=a.findIndex(x=>x.includes("department")&&!x.includes("id")&&!x.includes("#")&&!x.includes("code")&&!x.includes("number")),s=a.findIndex(x=>x==="payroll_date"||x==="pay_date"||x.includes("payroll")&&x.includes("date")||x.includes("pay period")||x==="date"),i=a.findIndex(x=>x==="row_type"||x==="rowtype"),o=a.findIndex(x=>x.includes("employee")&&!x.includes("amount")),l=x=>String(x||"").toLowerCase().replace(/[^a-z0-9]/g,""),c=x=>{for(let b of x){let C=l(b),w=r.findIndex(_=>l(_)===C);if(w>=0)return w}return-1},f=c(["Fixed Salary","Fixed","Base Salary"]),d=c(["Variable Salary","Variable","Variable Pay"]),h=c(["Gross Pay","Gross","Gross Wages"]),p=c(["Burden","Payroll Burden","Employer Burden"]),m=c(["All-In Total","All In Total","Total","All-In"]),u=c(["% of Total","Percent of Total","Percentage"]),g=c(["Headcount","Head Count","Employee Count"]);if(f<0&&d<0&&p<0&&m<0)return console.log("[Archive] No department summary columns found - using calculated values"),t;console.log("[Archive] Found department summary columns - extracting TOTAL rows",{fixedSalaryIdx:f,variableSalaryIdx:d,grossPayIdx:h,burdenIdx:p,allInTotalIdx:m,percentOfTotalIdx:u,headcountIdx:g});let v=e.slice(1),y=x=>String(x||"").trim().toLowerCase();return v.forEach(x=>{let b=s>=0?x[s]:"",C=Bn(b),w=C?ma(C):String(b||"").trim(),_=!1,k="",S="";if(i>=0){k=String(x[i]||"").trim();let D=y(k);_=D==="total"||D==="grand_total"||D==="grand total"}if(!_&&o>=0){S=String(x[o]||"").trim();let D=y(S);_=D==="total"||D==="total total"}if(w&&_&&!t.has(w)){let D=f>=0&&Number(x[f])||0,R=d>=0&&Number(x[d])||0,T=p>=0&&Number(x[p])||0,V=m>=0&&Number(x[m])||0,G=g>=0&&Number(x[g])||0;(V>0||D>0||R>0||T>0)&&(t.set(w,{fixed:D,variable:R,burden:T,total:V,headcount:G}),console.log(`[ArchiveTotals] Using TOTAL row for ${w}:`,{periodKey:w,rowType:k||"(using fallback)",employeeCell:S||x[o],deptCell:n>=0?x[n]:"(no dept col)",headcount:G,fixed:`$${D.toLocaleString()}`,variable:`$${R.toLocaleString()}`,burden:`$${T.toLocaleString()}`,allInTotal:`$${V.toLocaleString()}`}))}}),t}function zl(e){if(!e||e.length<2)return[];let t=e[0]||[],r=t.map(x=>String(x||"").toLowerCase().trim()),a=r.findIndex(x=>x==="payroll_date"||x==="pay_date"||x.includes("payroll")&&x.includes("date")||x.includes("pay period")||x==="date"),n=r.findIndex(x=>x==="row_type"||x==="rowtype"),s=r.findIndex(x=>x.includes("department")&&!x.includes("id")&&!x.includes("#")&&!x.includes("code")&&!x.includes("number")),i=x=>String(x||"").toLowerCase().replace(/[^a-z0-9]/g,""),o=x=>{for(let b of x){let C=i(b),w=t.findIndex(_=>i(_)===C);if(w>=0)return w}return-1},l=o(["Fixed Salary","Fixed","Base Salary"]),c=o(["Variable Salary","Variable","Variable Pay"]),f=o(["Gross Pay","Gross","Gross Wages"]),d=o(["Burden","Payroll Burden","Employer Burden"]),h=o(["All-In Total","All In Total","Total","All-In"]),p=o(["% of Total","Percent of Total","Percentage"]),m=o(["Headcount","Head Count","Employee Count"]),u=x=>String(x||"").trim().toLowerCase(),g=new Map;return e.slice(1).forEach(x=>{let b=a>=0?x[a]:"",C=Bn(b),w=C?ma(C):String(b||"").trim();if(!w)return;g.has(w)||g.set(w,{totals:null,departments:[]});let _=g.get(w),k=s>=0?String(x[s]||"").trim():"",S=n>=0?u(x[n]):"",D=l>=0&&Number(x[l])||0,R=c>=0&&Number(x[c])||0,T=f>=0?Number(x[f])||0:D+R,V=d>=0&&Number(x[d])||0,G=h>=0&&Number(x[h])||0,W=m>=0&&Number(x[m])||0,j=p>=0&&Number(x[p])||0;if(S==="total"||u(k)==="total"){_.totals={fixed:D,variable:R,burden:V,total:G,headcount:W};return}k&&_.departments.push({name:k,fixed:D,variable:R,gross:T,burden:V,allIn:G,percent:j,headcount:W,delta:0,isTotal:!1})}),Array.from(g.keys()).sort((x,b)=>x<b?1:-1).map(x=>{let b=g.get(x),C=((b==null?void 0:b.departments)||[]).slice().sort((S,D)=>(D.allIn||0)-(S.allIn||0)),w=(b==null?void 0:b.totals)||C.reduce((S,D)=>(S.fixed+=D.fixed||0,S.variable+=D.variable||0,S.burden+=D.burden||0,S.total+=D.allIn||0,S),{fixed:0,variable:0,burden:0,total:0,headcount:0}),_=w.total||0,k=C.map(S=>S.percent&&S.percent>0?S:{...S,percent:_?(S.allIn||0)/_:0});return{key:x,label:Gl(x),summary:{fixed:w.fixed,variable:w.variable,burden:w.burden,total:w.total,employeeCount:w.headcount||0,burdenRate:w.total?w.burden/w.total:0,delta:0},departments:k,totalsRow:{name:"TOTAL",fixed:w.fixed,variable:w.variable,gross:w.fixed+w.variable,burden:w.burden,allIn:w.total,percent:w.total?1:0,headcount:w.headcount||0,delta:0,isTotal:!0}}})}function rd(e,t,r=null,a=null){var d,h;console.log("[buildExpenseReviewPeriods] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("[buildExpenseReviewPeriods] INPUT DATA:"),console.log("  - cleanValues rows:",(e==null?void 0:e.length)||0),console.log("  - archiveValues rows:",(t==null?void 0:t.length)||0),console.log("  - archiveTotalsValues rows:",(a==null?void 0:a.length)||0),console.log("  - measureUniverse provided:",!!r),t&&t.length>0&&(console.log("  - Archive headers:",(d=t[0])==null?void 0:d.slice(0,5),"..."),console.log("  - Archive sample row 1:",(h=t[1])==null?void 0:h.slice(0,5),"...")),console.log("[buildExpenseReviewPeriods] Parsing current period data...");let n=Wk(Fd(e,r)),s=[];if(a&&a.length>1)console.log("[buildExpenseReviewPeriods] Building archive periods from PR_Archive_Totals..."),s=zl(a);else{console.log("[buildExpenseReviewPeriods] Building archive periods from PR_Archive_Summary totals...");let p=Gk(t);p.size>0?s=Array.from(p.entries()).map(([m,u])=>(console.log(`[Archive] Period ${m}: $${u.total.toLocaleString()}`),{key:m,label:Gl(m),summary:{fixed:u.fixed,variable:u.variable,burden:u.burden,total:u.total,employeeCount:u.headcount||0,burdenRate:u.total?u.burden/u.total:0,delta:0},departments:[],totalsRow:{name:"TOTAL",fixed:u.fixed,variable:u.variable,gross:u.fixed+u.variable,burden:u.burden,allIn:u.total,percent:1,headcount:u.headcount||0,delta:0,isTotal:!0}})):console.warn("[Archive] No stored totals found - archive periods will be empty")}console.log("[buildExpenseReviewPeriods] PARSED PERIODS:"),console.log("  - currentPeriods:",n.map(p=>{var m,u;return{key:p.key,employees:(m=p.summary)==null?void 0:m.employeeCount,total:(u=p.summary)==null?void 0:u.total}})),console.log("  - archivePeriods:",s.map(p=>{var m,u;return{key:p.key,employees:(m=p.summary)==null?void 0:m.employeeCount,total:(u=p.summary)==null?void 0:u.total}}));let i=new Map(s.map(p=>[p.key,p])),o=[];n.length&&(o.push(n[0]),i.delete(n[0].key)),s.forEach(p=>{o.length>=6||o.some(m=>m.key===p.key)||o.push(p)}),console.log("[buildExpenseReviewPeriods] Combined before filter:",o.map(p=>{var m,u;return{key:p.key,employees:(m=p.summary)==null?void 0:m.employeeCount,total:(u=p.summary)==null?void 0:u.total}}));let l=3,c=1e3,f=o.filter(p=>{var v,y,x,b,C;if(!p||!p.key)return console.log("buildExpenseReviewPeriods - EXCLUDED (no key):",p),!1;let m=((v=p.summary)==null?void 0:v.total)||(((y=p.summary)==null?void 0:y.fixed)||0)+(((x=p.summary)==null?void 0:x.variable)||0)+(((b=p.summary)==null?void 0:b.burden)||0),u=((C=p.summary)==null?void 0:C.employeeCount)||0;if(o.indexOf(p)===0)return console.log(`buildExpenseReviewPeriods - INCLUDED (current): ${p.key} - ${u} employees, $${m}`),!0;let g=u>=l&&m>=c;return console.log(`  ${g?"\u2713 INCLUDED":"\u2717 EXCLUDED"}: ${p.key} - ${u} employees, $${m.toLocaleString()} (needs >=${l} emp, >=$${c})`),g}).sort((p,m)=>p.key<m.key?1:-1).slice(0,6);return console.log("[buildExpenseReviewPeriods] FINAL periods:",f.map(p=>p.key)),console.log("[buildExpenseReviewPeriods] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),f.forEach((p,m)=>{let u=f[m+1],g=u?p.summary.total-u.summary.total:0;p.summary.delta=g;let v=new Map(((u==null?void 0:u.departments)||[]).map(y=>[y.name,y]));p.departments.forEach(y=>{let x=v.get(y.name);y.delta=x?y.allIn-x.allIn:0}),p.totalsRow.delta=g}),f}async function ad(){if(!mt()){Ui({loading:!1,lastError:"Excel runtime is unavailable."});return}Ui({loading:!0,lastError:null});let e=Te("SS_Company_ID"),r=await Sd(e,"payroll-recorder"),a={FIXED:r.filter(s=>s.expense_bucket==="FIXED").length,VARIABLE:r.filter(s=>s.expense_bucket==="VARIABLE").length,BURDEN:r.filter(s=>s.expense_bucket==="BURDEN").length,BENEFITS:r.filter(s=>s.expense_bucket==="BENEFITS").length,EXCLUDE:r.filter(s=>s.expense_bucket==="EXCLUDE").length};console.log(`[ExpenseReview] Loaded ${r.length} customer mappings`),console.log(`[ExpenseReview] Buckets: FIXED=${a.FIXED}, VARIABLE=${a.VARIABLE}, BURDEN=${a.BURDEN}, BENEFITS=${a.BENEFITS}, EXCLUDE=${a.EXCLUDE}`),bt.customerMappings=r;try{await id()}catch(s){console.warn("[ExpenseReview] Failed to load taxonomy, using fallbacks:",s)}console.log("[ExpenseReview] Getting measure universe from Step 1...");let n=await Xi();n.error?console.warn("[ExpenseReview] Measure universe error:",n.error):console.log(`[ExpenseReview] Measure universe: ${n.includedMeasureHeaders.length} measures, total=$${n.total.toLocaleString()}`);try{let s=await Excel.run(async i=>{let o=i.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN),l=i.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_SUMMARY),c=i.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_TOTALS),f=i.workbook.worksheets.getItemOrNullObject(Fe.EXPENSE_REVIEW);if(o.load("isNullObject, name"),l.load("isNullObject, name"),c.load("isNullObject, name"),f.load("isNullObject, name"),await i.sync(),console.log("Expense Review - Sheet check:",{cleanSheet:o.isNullObject?"MISSING":o.name,archiveSheet:l.isNullObject?"MISSING":l.name,archiveTotalsSheet:c.isNullObject?"MISSING":c.name,reviewSheet:f.isNullObject?"MISSING":f.name}),f.isNullObject){console.log("Creating PR_Expense_Review sheet...");let u=i.workbook.worksheets.add(Fe.EXPENSE_REVIEW);await i.sync();let g=i.workbook.worksheets.getItem(Fe.EXPENSE_REVIEW),v=[],y=[],x=[];if(!o.isNullObject){let C=o.getUsedRangeOrNullObject();C.load("values"),await i.sync(),v=C.isNullObject?[]:C.values||[]}if(!l.isNullObject){let C=l.getUsedRangeOrNullObject();C.load("values"),await i.sync(),y=C.isNullObject?[]:C.values||[]}if(!c.isNullObject){let C=c.getUsedRangeOrNullObject();C.load("values"),await i.sync(),x=C.isNullObject?[]:C.values||[]}let b=rd(v,y,n,x);return await nd(i,g,b),b}let d=[],h=[],p=[];if(o.isNullObject)console.warn("Expense Review - PR_Data_Clean sheet not found, using empty data");else{let u=o.getUsedRangeOrNullObject();u.load("values"),await i.sync(),d=u.isNullObject?[]:u.values||[],console.log("Expense Review - PR_Data_Clean rows:",d.length)}if(l.isNullObject)console.warn("Expense Review - PR_Archive_Summary sheet not found, using empty data");else{let u=l.getUsedRangeOrNullObject();u.load("values"),await i.sync(),h=u.isNullObject?[]:u.values||[],console.log("Expense Review - PR_Archive_Summary rows:",h.length)}if(c.isNullObject)console.warn("Expense Review - PR_Archive_Totals sheet not found, using fallback archive data");else{let u=c.getUsedRangeOrNullObject();u.load("values"),await i.sync(),p=u.isNullObject?[]:u.values||[],console.log("Expense Review - PR_Archive_Totals rows:",p.length)}let m=rd(d,h,n,p);return console.log("Expense Review - Periods built:",m.length),await nd(i,f,m),m});Ui({loading:!1,periods:s,lastError:null}),await kb(),it()}catch(s){console.error("Expense Review: unable to build executive summary",s),console.error("Error details:",s.message,s.stack),Ui({loading:!1,lastError:`Unable to build the Expense Review: ${s.message||"Unknown error"}`,periods:[]})}}async function nd(e,t,r){if(!t){console.error("writeExpenseReviewSheet: sheet is null/undefined");return}console.log("writeExpenseReviewSheet: Building executive dashboard with",r.length,"periods");try{let ue=t.getUsedRangeOrNullObject();ue.load("address");let Ee=t.charts;Ee.load("items"),await e.sync(),ue.isNullObject||(ue.clear(),await e.sync());for(let Ke=Ee.items.length-1;Ke>=0;Ke--)Ee.items[Ke].delete();await e.sync()}catch(ue){console.warn("Could not clear sheet:",ue)}let a=r[0]||{},n=r.length>2?r[2]:r[1]||{},s=a.summary||{},i=n.summary||{},o=fn(),l=o?Us(o):"",c=Te("PR_Accounting_Period")||l||"",f=Number(s.total)||0,d=Number(i.total)||0,h=f-d,p=d?h/d:0,m=Number(s.employeeCount)||0,u=Number(i.employeeCount)||0,g=m-u,v=m?f/m:0,y=u?d/u:0,x=v-y,b=zk(r),C=Xk(a,r),w=a.label||a.key||"Current Period",_=new Date().toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),k=ue=>ue>0?"\u25B2":ue<0?"\u25BC":"\u2014",S=r.map(ue=>{var Ee;return((Ee=ue.summary)==null?void 0:Ee.total)||0}).filter(ue=>ue>0),D=r.map(ue=>{let Ee=ue.summary||{},Ke=Ee.employeeCount||0;return Ke>0?(Ee.total||0)/Ke:0}).filter(ue=>ue>0),R=r.slice(0,-1).map((ue,Ee)=>{var Zt,gt,dt;let Ke=((Zt=ue.summary)==null?void 0:Zt.total)||0,Ut=((dt=(gt=r[Ee+1])==null?void 0:gt.summary)==null?void 0:dt.total)||0;return Ut>0?(Ke-Ut)/Ut:0}),T=(ue,Ee=null)=>{let Ke=Ee!==null?[...ue,Ee]:ue;if(!Ke.length)return{min:0,max:0,avg:0};let Ut=Math.min(...Ke),Zt=Math.max(...Ke),gt=ue.length?ue:Ke,dt=gt.reduce(($r,Sr)=>$r+Sr,0)/gt.length;return{min:Ut,max:Zt,avg:dt}},V=T(S,f),G=T(D,v),W=T(R),j=(ue,Ee,Ke,Ut=20)=>{if(Ke<=Ee)return"\u2591".repeat(Ut);let Zt=Ke-Ee,gt=Math.max(0,Math.min(1,(ue-Ee)/Zt)),dt=Math.round(gt*(Ut-1)),$r="";for(let Sr=0;Sr<Ut;Sr++)Sr===dt?$r+="\u25CF":$r+="\u2591";return $r},se=Number(s.fixed)||0,q=Number(s.variable)||0,K=Number(s.burden)||0,Z=se+q,X=f?K/f:0,F=Number(i.fixed)||0,U=Number(i.variable)||0,P=Number(i.burden)||0,B=d?P/d:0,Y=a.departments||[],Q=Y.filter(ue=>{let Ee=(ue.name||"").toLowerCase();return Ee.includes("sales")||Ee.includes("marketing")}),J=Y.filter(ue=>{let Ee=(ue.name||"").toLowerCase();return!Ee.includes("sales")&&!Ee.includes("marketing")}),oe=Q.reduce((ue,Ee)=>ue+(Ee.variable||0),0),ae=Q.reduce((ue,Ee)=>ue+(Ee.headcount||0),0),be=J.reduce((ue,Ee)=>ue+(Ee.variable||0),0),O=J.reduce((ue,Ee)=>ue+(Ee.headcount||0),0),Se=ae?oe/ae:0,ke=O?be/O:0,Ne=m?se/m:0,pe=[],z=0,ce={};ce.headerStart=z;let ft=c||w;if(/^\d{4}-\d{2}-\d{2}$/.test(ft)){let[ue,Ee,Ke]=ft.split("-").map(Number);ue&&Ee&&Ke&&(ft=`${["January","February","March","April","May","June","July","August","September","October","November","December"][Ee-1]} ${Ke}, ${ue}`)}pe.push(["PAYROLL EXPENSE REVIEW"]),z++,pe.push([`Period: ${ft}`]),z++,pe.push([`Generated: ${_}`]),z++,pe.push([""]),z++,ce.headerEnd=z-1,ce.execSummaryStart=z,pe.push(["EXECUTIVE SUMMARY"]),z++,ce.execSummaryHeader=z-1,pe.push([""]),z++,pe.push(["","Pay Date","Headcount","Fixed Salary","Variable Salary","Burden","Total Payroll","Burden Rate"]),z++,ce.execSummaryColHeaders=z-1,pe.push(["Current Pay Period",a.label||a.key||"",m,se,q,K,f,X]),z++,ce.execSummaryCurrentRow=z-1,pe.push(["Same Period Prior Month",n.label||n.key||"",u,F,U,P,d,B]),z++,ce.execSummaryPriorRow=z-1,pe.push([""]),z++,pe.push([""]),z++,ce.execSummaryEnd=z-1,ce.deptBreakdownStart=z,pe.push(["CURRENT PERIOD BREAKDOWN (DEPARTMENT)"]),z++,ce.deptBreakdownHeader=z-1,pe.push([""]),z++,pe.push(["Payroll Date",a.label||a.key||""]),z++,pe.push([""]),z++,pe.push(["Department","Fixed Salary","Variable Salary","Gross Pay","Burden","All-In Total","% of Total","Headcount"]),z++,ce.deptColHeaders=z-1;let Ot=[...Y].sort((ue,Ee)=>(Ee.allIn||0)-(ue.allIn||0));if(ce.deptDataStart=z,Ot.forEach(ue=>{pe.push([ue.name||"",ue.fixed||0,ue.variable||0,ue.gross||0,ue.burden||0,ue.allIn||0,ue.percent||0,ue.headcount||0]),z++}),ce.deptDataEnd=z-1,a.totalsRow){let ue=a.totalsRow;pe.push(["TOTAL",ue.fixed||0,ue.variable||0,ue.gross||0,ue.burden||0,ue.allIn||0,1,ue.headcount||0]),z++,ce.deptTotalsRow=z-1}pe.push([""]),z++,pe.push([""]),z++,ce.deptBreakdownEnd=z-1,ce.historicalStart=z,pe.push(["HISTORICAL CONTEXT"]),z++,ce.historicalHeader=z-1,pe.push([`Visual comparison of current period vs. historical range (${r.length} periods). The dot (\u25CF) shows where you currently stand.`]),z++,pe.push([""]),z++;let ze=ue=>`$${Math.round(ue/1e3)}K`,Pt=ue=>`${(ue*100).toFixed(1)}%`;pe.push(["","Metric","Low","Range","High","","Current","Average"]),z++,ce.historicalColHeaders=z-1;let vr=r.map(ue=>{var Ee;return((Ee=ue.summary)==null?void 0:Ee.fixed)||0}).filter(ue=>ue>0),jt=r.map(ue=>{var Ee;return((Ee=ue.summary)==null?void 0:Ee.variable)||0}),dr=r.map(ue=>{let Ee=ue.summary||{};return Ee.total?(Ee.burden||0)/Ee.total:0}),H=r.map(ue=>{let Ee=ue.summary||{},Ke=Ee.employeeCount||0;return Ke>0?(Ee.fixed||0)/Ke:0}).filter(ue=>ue>0),fe=T(vr,se),Oe=T(jt,q),Je=T(dr,X),Ae=T(H,Ne);ce.spectrumRows=[];let tt=j(f,V.min,V.max,25);pe.push(["","Total Payroll",ze(V.min),tt,ze(V.max),"",ze(f),ze(V.avg)]),z++,ce.spectrumRows.push(z-1);let pt=j(se,fe.min,fe.max,25);pe.push(["","Total Fixed Payroll",ze(fe.min),pt,ze(fe.max),"",ze(se),ze(fe.avg)]),z++,ce.spectrumRows.push(z-1);let je=j(q,Oe.min,Oe.max,25);pe.push(["","Total Variable Payroll",ze(Oe.min),je,ze(Oe.max),"",ze(q),ze(Oe.avg)]),z++,ce.spectrumRows.push(z-1),pe.push([""]),z++;let Ye=j(Ne,Ae.min,Ae.max,25);pe.push(["","Avg Fixed Payroll / Employee",ze(Ae.min),Ye,ze(Ae.max),"",ze(Ne),ze(Ae.avg)]),z++,ce.spectrumRows.push(z-1);let Wt=r.map(ue=>{let Ke=(ue.departments||[]).filter(gt=>{let dt=(gt.name||"").toLowerCase();return dt.includes("sales")||dt.includes("marketing")}),Ut=Ke.reduce((gt,dt)=>gt+(dt.variable||0),0),Zt=Ke.reduce((gt,dt)=>gt+(dt.headcount||0),0);return Zt>0?Ut/Zt:0}),Yr=T(Wt,Se),ga=r.map(ue=>{let Ke=(ue.departments||[]).filter(gt=>{let dt=(gt.name||"").toLowerCase();return!dt.includes("sales")&&!dt.includes("marketing")}),Ut=Ke.reduce((gt,dt)=>gt+(dt.variable||0),0),Zt=Ke.reduce((gt,dt)=>gt+(dt.headcount||0),0);return Zt>0?Ut/Zt:0}),Oa=T(ga,ke);if(ae>0){let ue=j(Se,Yr.min,Yr.max,25);pe.push(["","Avg Variable / Sales & Marketing",ze(Yr.min),ue,ze(Yr.max),"",ze(Se),`${ae} emp`]),z++,ce.spectrumRows.push(z-1)}if(O>0){let ue=j(ke,Oa.min,Oa.max,25);pe.push(["","Avg Variable / Other Depts",ze(Oa.min),ue,ze(Oa.max),"",ze(ke),`${O} emp`]),z++,ce.spectrumRows.push(z-1)}pe.push([""]),z++;let Ws=j(X,Je.min,Je.max,25);pe.push(["","Burden Rate (%)",Pt(Je.min),Ws,Pt(Je.max),"",Pt(X),Pt(Je.avg)]),z++,ce.spectrumRows.push(z-1),pe.push([""]),z++,pe.push([""]),z++,ce.historicalEnd=z-1,ce.trendsStart=z,pe.push(["PERIOD TRENDS"]),z++,ce.trendsHeader=z-1,pe.push([""]),z++,pe.push(["Pay Period","Total Payroll","Fixed Payroll","Variable Payroll","Burden","Headcount"]),z++,ce.trendColHeaders=z-1;let Wn=r.slice(0,6).reverse();ce.trendDataStart=z,Wn.forEach(ue=>{let Ee=ue.summary||{};pe.push([ue.label||ue.key||"",Ee.total||0,Ee.fixed||0,Ee.variable||0,Ee.burden||0,Ee.employeeCount||0]),z++}),ce.trendDataEnd=z-1,pe.push([""]),z++,ce.trendsEnd=z-1,ce.chartStart=z;for(let ue=0;ue<15;ue++)pe.push([""]),z++;ce.payrollChartEnd=z-1,ce.headcountChartStart=z;for(let ue=0;ue<12;ue++)pe.push([""]),z++;ce.headcountChartEnd=z-1,console.log("writeExpenseReviewSheet: Writing",pe.length,"rows");let Gs=pe.map(ue=>{let Ee=Array.isArray(ue)?ue:[""];for(;Ee.length<10;)Ee.push("");return Ee.slice(0,10)});try{let ue=t.getRangeByIndexes(0,0,Gs.length,10);ue.values=Gs,await e.sync()}catch(ue){throw console.error("writeExpenseReviewSheet: Write failed",ue),ue}try{t.getRange("A:A").format.columnWidth=200,t.getRange("B:B").format.columnWidth=130,t.getRange("C:C").format.columnWidth=100,t.getRange("D:D").format.columnWidth=200,t.getRange("E:E").format.columnWidth=100,t.getRange("F:F").format.columnWidth=100,t.getRange("G:G").format.columnWidth=100,t.getRange("H:H").format.columnWidth=100,t.getRange("I:I").format.columnWidth=80,t.getRange("J:J").format.columnWidth=80,await e.sync();let ue=t.getRange("A1");ue.format.font.bold=!0,ue.format.font.size=22,ue.format.font.color="#1e293b",t.getRange("A2").format.font.size=11,t.getRange("A2").format.font.color="#64748b",t.getRange("A3").format.font.size=10,t.getRange("A3").format.font.color="#94a3b8",await e.sync();let Ee=t.getRange(`A${ce.execSummaryHeader+1}`);Ee.format.font.bold=!0,Ee.format.font.size=14,Ee.format.font.color="#1e293b";let Ke=t.getRange(`A${ce.execSummaryColHeaders+1}:H${ce.execSummaryColHeaders+1}`);Ke.format.font.bold=!0,Ke.format.font.size=10,Ke.format.fill.color="#1e293b",Ke.format.font.color="#ffffff";let Ut=t.getRange(`A${ce.execSummaryCurrentRow+1}:H${ce.execSummaryCurrentRow+1}`);Ut.format.fill.color="#dcfce7",Ut.format.font.bold=!0;let Zt=t.getRange(`A${ce.execSummaryPriorRow+1}:H${ce.execSummaryPriorRow+1}`);Zt.format.fill.color="#f1f5f9";for(let Be of[ce.execSummaryCurrentRow+1,ce.execSummaryPriorRow+1])t.getRange(`C${Be}`).numberFormat=[["#,##0"]],t.getRange(`D${Be}`).numberFormat=[["$#,##0"]],t.getRange(`E${Be}`).numberFormat=[["$#,##0"]],t.getRange(`F${Be}`).numberFormat=[["$#,##0"]],t.getRange(`G${Be}`).numberFormat=[["$#,##0"]],t.getRange(`H${Be}`).numberFormat=[["0.00%"]];await e.sync();let gt=t.getRange(`A${ce.deptBreakdownHeader+1}`);gt.format.font.bold=!0,gt.format.font.size=14,gt.format.font.color="#1e293b";let dt=t.getRange(`A${ce.deptColHeaders+1}:H${ce.deptColHeaders+1}`);dt.format.font.bold=!0,dt.format.font.size=10,dt.format.fill.color="#1e293b",dt.format.font.color="#ffffff";for(let Be=ce.deptDataStart;Be<=ce.deptDataEnd;Be++){let Pe=Be+1;t.getRange(`B${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`C${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`D${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`E${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`F${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`G${Pe}`).numberFormat=[["0.00%"]],t.getRange(`H${Pe}`).numberFormat=[["#,##0"]],(Be-ce.deptDataStart)%2===1&&(t.getRange(`A${Pe}:H${Pe}`).format.fill.color="#f8fafc")}if(ce.deptTotalsRow){let Be=t.getRange(`A${ce.deptTotalsRow+1}:H${ce.deptTotalsRow+1}`);Be.format.font.bold=!0,Be.format.fill.color="#1e293b",Be.format.font.color="#ffffff";let Pe=ce.deptTotalsRow+1;t.getRange(`B${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`C${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`D${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`E${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`F${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`G${Pe}`).numberFormat=[["0%"]],t.getRange(`H${Pe}`).numberFormat=[["#,##0"]]}await e.sync();let $r=t.getRange(`A${ce.historicalHeader+1}`);$r.format.font.bold=!0,$r.format.font.size=14,$r.format.font.color="#1e293b",t.getRange(`A${ce.historicalHeader+2}`).format.font.size=10,t.getRange(`A${ce.historicalHeader+2}`).format.font.color="#64748b",t.getRange(`A${ce.historicalHeader+2}`).format.font.italic=!0;let Sr=t.getRange(`A${ce.historicalColHeaders+1}:H${ce.historicalColHeaders+1}`);Sr.format.font.bold=!0,Sr.format.font.size=10,Sr.format.fill.color="#e2e8f0",Sr.format.font.color="#334155",t.getRange(`C${ce.historicalColHeaders+1}`).format.horizontalAlignment="Center",t.getRange(`E${ce.historicalColHeaders+1}`).format.horizontalAlignment="Center",t.getRange(`G${ce.historicalColHeaders+1}`).format.horizontalAlignment="Center",t.getRange(`H${ce.historicalColHeaders+1}`).format.horizontalAlignment="Center",ce.spectrumRows.forEach(Be=>{t.getRange(`D${Be+1}`).format.font.name="Consolas",t.getRange(`D${Be+1}`).format.font.size=14,t.getRange(`D${Be+1}`).format.font.color="#6366f1",t.getRange(`D${Be+1}`).format.horizontalAlignment="Center",t.getRange(`B${Be+1}`).format.font.color="#334155",t.getRange(`C${Be+1}`).format.font.color="#94a3b8",t.getRange(`C${Be+1}`).format.horizontalAlignment="Center",t.getRange(`E${Be+1}`).format.font.color="#94a3b8",t.getRange(`E${Be+1}`).format.horizontalAlignment="Center",t.getRange(`G${Be+1}`).format.font.bold=!0,t.getRange(`G${Be+1}`).format.font.color="#1e293b",t.getRange(`G${Be+1}`).format.horizontalAlignment="Center",t.getRange(`H${Be+1}`).format.font.color="#94a3b8",t.getRange(`H${Be+1}`).format.horizontalAlignment="Center"}),await e.sync();let Gn=t.getRange(`A${ce.trendsHeader+1}`);Gn.format.font.bold=!0,Gn.format.font.size=14,Gn.format.font.color="#1e293b";let xa=t.getRange(`A${ce.trendColHeaders+1}:F${ce.trendColHeaders+1}`);xa.format.font.bold=!0,xa.format.font.size=10,xa.format.fill.color="#1e293b",xa.format.font.color="#ffffff";for(let Be=ce.trendDataStart;Be<=ce.trendDataEnd;Be++){let Pe=Be+1;t.getRange(`B${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`C${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`D${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`E${Pe}`).numberFormat=[["$#,##0"]],t.getRange(`F${Pe}`).numberFormat=[["#,##0"]],(Be-ce.trendDataStart)%2===1&&(t.getRange(`A${Pe}:F${Pe}`).format.fill.color="#f8fafc")}if(await e.sync(),Wn.length>=2){try{let Be=t.getRange(`A${ce.trendColHeaders+1}:E${ce.trendDataEnd+1}`),Pe=t.charts.add(Excel.ChartType.lineMarkers,Be,Excel.ChartSeriesBy.columns);Pe.setPosition(`A${ce.chartStart+1}`,`J${ce.payrollChartEnd+1}`),Pe.title.text="Payroll Expense Trends",Pe.title.format.font.size=14,Pe.title.format.font.bold=!0,Pe.legend.position=Excel.ChartLegendPosition.bottom,Pe.format.fill.setSolidColor("#ffffff"),Pe.format.border.lineStyle=Excel.ChartLineStyle.continuous,Pe.format.border.color="#e2e8f0";let Pa=Pe.axes.getItem(Excel.ChartAxisType.category);Pa.categoryType=Excel.ChartAxisCategoryType.textAxis,Pa.setCategoryNames(t.getRange(`A${ce.trendDataStart+1}:A${ce.trendDataEnd+1}`)),await e.sync();let E=Pe.series;E.load("count"),await e.sync();let N=["#3b82f6","#22c55e","#f97316","#8b5cf6"];for(let A=0;A<Math.min(E.count,N.length);A++){let I=E.getItemAt(A);I.format.line.color=N[A],I.format.line.weight=2,I.markerStyle=Excel.ChartMarkerStyle.circle,I.markerSize=6,I.markerBackgroundColor=N[A]}await e.sync(),console.log("writeExpenseReviewSheet: Payroll chart created successfully")}catch(Be){console.warn("writeExpenseReviewSheet: Payroll chart creation failed (non-critical)",Be)}try{let Be=t.getRange(`A${ce.trendColHeaders+1}:F${ce.trendDataEnd+1}`),Pe=t.charts.add(Excel.ChartType.lineMarkers,Be,Excel.ChartSeriesBy.columns);Pe.setPosition(`A${ce.headcountChartStart+1}`,`J${ce.headcountChartEnd+1}`),Pe.title.text="Headcount Trend",Pe.title.format.font.size=12,Pe.title.format.font.bold=!0,Pe.legend.visible=!1,Pe.format.fill.setSolidColor("#ffffff"),Pe.format.border.lineStyle=Excel.ChartLineStyle.continuous,Pe.format.border.color="#e2e8f0";let Pa=Pe.axes.getItem(Excel.ChartAxisType.category);Pa.categoryType=Excel.ChartAxisCategoryType.textAxis,Pa.setCategoryNames(t.getRange(`A${ce.trendDataStart+1}:A${ce.trendDataEnd+1}`)),await e.sync();let E=Pe.series;E.load("count, items/name"),await e.sync();for(let N=E.count-2;N>=0;N--)E.getItemAt(N).delete();if(await e.sync(),E.load("count"),await e.sync(),E.count>0){let N=E.getItemAt(0);N.format.line.color="#64748b",N.format.line.weight=2.5,N.markerStyle=Excel.ChartMarkerStyle.circle,N.markerSize=8,N.markerBackgroundColor="#64748b"}await e.sync(),console.log("writeExpenseReviewSheet: Headcount chart created successfully")}catch(Be){console.warn("writeExpenseReviewSheet: Headcount chart creation failed (non-critical)",Be)}}t.freezePanes.freezeRows(ce.execSummaryEnd+1),t.pageLayout.orientation=Excel.PageOrientation.landscape,t.getRange("A1").select(),await e.sync(),console.log("writeExpenseReviewSheet: Formatting applied successfully")}catch(ue){console.warn("writeExpenseReviewSheet: Formatting error (non-critical)",ue)}}function zk(e){var a;return!e||!e.length?!1:(((a=e[0].summary)==null?void 0:a.categories)||[]).some(n=>{let s=(n.name||"").toLowerCase();return s.includes("commission")||s.includes("bonus")||s.includes("variable")})}function Xk(e,t){var i;if(!e||t.length<2)return!1;let r=t.map(o=>{var l;return((l=o.summary)==null?void 0:l.total)||0}).filter(o=>o>0);if(r.length<2)return!1;let a=r.reduce((o,l)=>o+l,0)/r.length,n=((i=e.summary)==null?void 0:i.total)||0;return(a>0?n/a:1)<.9}function Yk(e={},{rerender:t=!0}={}){Object.assign(It,e);let r=Number(It.prDataTotal),a=Number(It.cleanTotal);It.reconDifference=Number.isFinite(r)&&Number.isFinite(a)?r-a:null;let n=js(It.bankAmount);It.bankDifference=Number.isFinite(a)&&!Number.isNaN(n)?a-n:null,It.plugEnabled=It.bankDifference!=null&&Math.abs(It.bankDifference)>=.5,t?it():Kk()}function Kk(){if(Et.activeStepId!==3)return;let e=(a,n)=>{let s=document.getElementById(a);s&&(s.value=n)};e("pr-data-total-value",Xr(It.prDataTotal)),e("clean-total-value",Xr(It.cleanTotal)),e("recon-diff-value",Xr(It.reconDifference)),e("bank-clean-total-value",Xr(It.cleanTotal)),e("bank-diff-value",It.bankDifference!=null?Xr(It.bankDifference):"---");let t=document.getElementById("bank-diff-hint");t&&(t.textContent=It.bankDifference==null?"":Math.abs(It.bankDifference)<.5?"Difference within acceptable tolerance.":"Difference exceeds tolerance and should be resolved.");let r=document.getElementById("bank-plug-btn");r&&(r.disabled=!It.plugEnabled)}function Ui(e={},{rerender:t=!0}={}){Object.assign(bt,e),t&&it()}function Da(e){return cn(e).toLowerCase()}function cn(e){return e==null?"":String(e).trim()}function Hs(e=[]){let t=e.map((i,o)=>({idx:o,value:Da(i)})),r=t.find(({value:i})=>i.includes("department")&&i.includes("description"));if(r)return console.log("DEBUG pickDepartmentIndex - Using 'Department Description' at index:",r.idx),r.idx;let a=t.find(({value:i})=>i.includes("department")&&i.includes("name"));if(a)return console.log("DEBUG pickDepartmentIndex - Using 'Department Name' at index:",a.idx),a.idx;let n=t.find(({value:i})=>i.includes("department")&&!i.includes("id")&&!i.includes("#")&&!i.includes("code")&&!i.includes("number"));if(n)return console.log("DEBUG pickDepartmentIndex - Using non-ID department at index:",n.idx),n.idx;let s=t.find(({value:i})=>i.includes("department"));return s&&console.log("DEBUG pickDepartmentIndex - Using fallback department at index:",s.idx),s?s.idx:-1}function Dd(e){return e===4?null:()=>Jk(e)}function Jk(e){let t=Pr.findIndex(a=>a.id===e);if(t===-1)return;let r=t+1;r<Pr.length&&(Wi(r),qk())}function qk(){let e=[document.querySelector(".pf-root"),document.querySelector(".pf-step-guide"),document.body];for(let t of e)t&&t.scrollTo({top:0,behavior:"smooth"});window.scrollTo({top:0,behavior:"smooth"})}window.handleArchiveClick=async function(){console.log("[Archive] handleArchiveClick triggered!"),Ie("Starting archive process...","info",2e3);try{await Nd()}catch(e){console.error("[Archive] handleArchiveClick error:",e),Ie("Archive failed: "+e.message,"error",8e3)}};async function Nd(){if(console.log("[Archive] handleArchiveRun called"),!mt()){Ie("Excel runtime is unavailable.","error");return}if(!await Ul(`This will:

\u2022 Download an Excel archive file
\u2022 Update PR_Archive_Summary
\u2022 Clear working data from all sheets
\u2022 Reset non-permanent notes & config

Make sure you've completed all review steps.`,{title:"Archive Payroll Run",icon:"\u{1F4E6}",confirmText:"Archive Now",cancelText:"Not Yet"})){console.log("[Archive] User cancelled"),Ie("Archive cancelled","info",2e3);return}console.log("[Archive] User confirmed, starting archive process...");try{if(console.log("[Archive] Step 1: Creating archive workbook..."),!await Zk()){console.log("[Archive] Archive cancelled or failed");return}console.log("[Archive] Step 1 complete: Archive workbook created/user confirmed backup"),console.log("[Archive] Step 2: Updating PR_Archive_Summary..."),await tS(),console.log("[Archive] Step 2 complete: Archive summary updated"),console.log("[Archive] Step 3: Clearing working data..."),await rS(),console.log("[Archive] Step 3 complete: Working data cleared"),console.log("[Archive] Step 4: Clearing non-permanent notes..."),await aS(),console.log("[Archive] Step 4 complete: Notes cleared"),console.log("[Archive] Step 5: Resetting config values..."),await nS(),console.log("[Archive] Step 5 complete: Config reset"),console.log("[Archive] Archive workflow complete!"),await hd(),it(),gb()}catch(t){console.error("[Archive] Error during archive:",t),Ie("Archive Error: "+t.message,"error",1e4)}}async function Zk(){try{let e=fn()||new Date().toISOString().split("T")[0],t=`Payroll_Archive_${e}.xlsx`;return console.log("[Archive] Creating Excel archive file..."),await Excel.run(async r=>{let n=r.workbook.worksheets;n.load("items/name"),await r.sync();let s=[Fe.JE_DRAFT,Fe.DATA_CLEAN,Fe.EXPENSE_REVIEW],i=Wr.book_new(),o=0,l=[];l.push(["Payroll Archive Summary"]),l.push(["Archived At",new Date().toISOString()]),l.push(["Payroll Date",e]),l.push(["Accounting Period",Te("PR_Accounting_Period")||""]),l.push(["Journal Entry ID",Te("PR_Journal_Entry_ID")||""]),l.push([]);let c=aa[0],f=aa[1],d=aa[2],h=aa[3],p=Te(Mn)||"";l.push(["Reviewer",p]),l.push(["Config Sign-off",c&&Te(c.signOff)||""]),l.push(["Config Notes",c&&Te(c.note)||""]),l.push([]),l.push(["Import Sign-off",f&&Te(f.signOff)||""]),l.push(["Import Notes",f&&Te(f.note)||""]),l.push([]),l.push(["Expense Review Sign-off",d&&Te(d.signOff)||""]),l.push(["Expense Review Notes",d&&Te(d.note)||""]),l.push([]),l.push(["JE Sign-off",h&&Te(h.signOff)||""]),l.push(["JE Notes",h&&Te(h.note)||""]),l.push([]),l.push(["Generated By","Payroll Recorder"]),l.push(["Archive File",t]);let m=Wr.aoa_to_sheet(l);Ns(m,[Ra.extraWide,Ra.description]),Wr.book_append_sheet(i,m,"Archive_Summary"),o++;for(let u of s){let g=n.items.find(y=>y.name===u);if(!g){console.log(`[Archive] Sheet not found: ${u}`);continue}let v=g.getUsedRangeOrNullObject();if(v.load("values"),await r.sync(),!v.isNullObject&&v.values&&v.values.length>0){let y=Wr.aoa_to_sheet(v.values);if(v.values.length>0)if(u===Fe.EXPENSE_REVIEW)Hu(y,v.values),console.log(`[Archive] Applied Expense Review formatting to ${u}`);else{let x=v.values[0],b=v.values.length;Uu(y,x,b,{autoFormat:!0,autoSize:!0})}Wr.book_append_sheet(i,y,u),o++,console.log(`[Archive] Added sheet: ${u} (${v.values.length} rows)`)}}if(o===0)return Ie("No data to archive. Please complete the payroll workflow first.","error"),!1;try{console.log(`[Archive] Writing ${o} sheets to Excel...`);let u=bl(i,{bookType:"xlsx",type:"array"});console.log(`[Archive] Excel buffer created: ${u.byteLength} bytes`);let g=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return console.log(`[Archive] Blob created: ${g.size} bytes`),Qk(g,t),console.log(`[Archive] Downloaded: ${t} with ${o} sheets`),Ie(`\u{1F4E5} Archive downloaded: ${t} (${o} sheets)`,"success",5e3),!0}catch(u){throw console.error("[Archive] Download error:",u),new Error(`Failed to write Excel file: ${u.message}`)}})}catch(e){return console.error("[Archive] Error creating archive:",e),Ie("Archive Export Error: "+e.message,"error",8e3),await Ul(`Archive download failed.

Do you want to continue with clearing the data?

Make sure you have saved a backup first!`)}}function Qk(e,t){try{if(!e||e.size===0)throw new Error("Blob is empty");let r=URL.createObjectURL(e);console.log(`[Download] URL created: ${r}`);let a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),console.log("[Download] Link appended to DOM"),a.click(),console.log("[Download] Click triggered"),document.body.removeChild(a),console.log("[Download] Link removed from DOM"),setTimeout(()=>{URL.revokeObjectURL(r),console.log("[Download] URL revoked")},100)}catch(r){throw console.error("[Download] Error:",r),r}}function Bn(e){if(!e)return null;if(e instanceof Date)return isNaN(e.getTime())?null:e;if(typeof e=="number"&&e>1e3&&e<1e5)return Rd(e);let t=String(e).trim();if(!t)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(t)){let[a,n,s]=t.split("-").map(Number);return new Date(a,n-1,s)}if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(t)){let[a,n,s]=t.split("/").map(Number);return new Date(s,a-1,n)}let r=new Date(t);return isNaN(r.getTime())?null:r}function eS(e,t){let r=nt.loaded?nt:null,a=e.map(f=>String(f||"").toLowerCase().trim()),n=0,s=0,i=0,o=new Set,l=a.findIndex(f=>f.includes("employee")&&f.includes("name"));e.forEach((f,d)=>{var y,x,b;let h=String(f||"").toLowerCase().trim();if((y=r==null?void 0:r.dimensions)!=null&&y.has(h))return;let p=(x=r==null?void 0:r.measures)==null?void 0:x[h];if(!p)return;let m=p.side||"er";if(m==="ee"||m==="na")return;let u=Fa(p.bucket),g=(b=p.sign)!=null?b:1,v=0;t.forEach(C=>{let w=Number(C[d])||0;v+=w*g}),u==="FIXED"?n+=v:u==="VARIABLE"?s+=v:(u==="BURDEN"||u==="BENEFIT")&&(i+=v)}),l>=0&&t.forEach(f=>{let d=String(f[l]||"").trim();d&&o.add(d)});let c=n+s+i;return console.log(`[Archive] Bucket totals calculated: FIXED=${n.toLocaleString()}, VARIABLE=${s.toLocaleString()}, BURDEN=${i.toLocaleString()}, TOTAL=${c.toLocaleString()}, HEADCOUNT=${o.size}`),{fixed:n,variable:s,burden:i,total:c,headcount:o.size}}async function tS(){await Excel.run(async e=>{let t=e.workbook.worksheets.getItemOrNullObject(Fe.DATA_CLEAN),r=e.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_SUMMARY),a=e.workbook.worksheets.getItemOrNullObject(Fe.ARCHIVE_TOTALS),n=e.workbook.worksheets.getItemOrNullObject(Fe.EXPENSE_REVIEW);if(t.load("isNullObject, name"),r.load("isNullObject, name"),a.load("isNullObject, name"),n.load("isNullObject, name"),await e.sync(),t.isNullObject){console.warn("[Archive] PR_Data_Clean not found - skipping");return}if(r.isNullObject){console.log("[Archive] PR_Archive_Summary not found - CREATING it..."),r=e.workbook.worksheets.add(Fe.ARCHIVE_SUMMARY);let _=r.getRange("1:1");tn(_),await e.sync(),console.log("[Archive] PR_Archive_Summary sheet created successfully")}if(a.isNullObject){console.log("[Archive] PR_Archive_Totals not found - CREATING it..."),a=e.workbook.worksheets.add(Fe.ARCHIVE_TOTALS);let _=a.getRange("1:1");tn(_),await e.sync(),console.log("[Archive] PR_Archive_Totals sheet created successfully")}let s=t.getUsedRangeOrNullObject();if(s.load("values"),await e.sync(),s.isNullObject||!s.values||s.values.length<2){console.warn("[Archive] PR_Data_Clean is empty - skipping archive summary update");return}let i=s.values[0],o=s.values.slice(1);console.log(`[Archive] PR_Data_Clean has ${o.length} rows to archive`);let l=fn(),c=Bn(l),f=c?ma(c):String(l||"").trim();console.log(`[Archive] Current period date (raw): ${l}, normalized: ${f}`);let d=[],h=null;if(!n.isNullObject){console.log("[Archive] Reading department table headers from PR_Expense_Review");let _=null;try{if(_=e.workbook.names.getItemOrNullObject("PR_Dept_Breakdown"),_.load("name, value"),await e.sync(),!_.isNullObject){console.log("[Archive] Using named range: PR_Dept_Breakdown");let k=_.value,S=n.getRange(k);S.load("values"),await e.sync(),h=S.values}}catch{console.warn("[Archive] Named range PR_Dept_Breakdown not found, falling back to scan")}if(!h){console.log("[Archive] Scanning PR_Expense_Review for department table");let k=n.getUsedRangeOrNullObject();if(k.load("values"),await e.sync(),!k.isNullObject&&k.values&&k.values.length>0){let S=k.values,D=0;for(let T=0;T<S.length;T++){let V=String(S[T][0]||"").toUpperCase();if(V.includes("CURRENT PERIOD BREAKDOWN")&&V.includes("DEPARTMENT")){D=T+1,console.log(`[Archive] Found department section marker at row ${T}, starting search at row ${D}`);break}}let R=-1;for(let T=D;T<S.length;T++){let G=S[T].map(Z=>String(Z||"").toLowerCase()).join("|"),W=G.includes("department"),j=G.includes("gross")&&G.includes("pay"),se=G.includes("burden"),q=G.includes("all")&&G.includes("in"),K=[j,se,q].filter(Boolean).length;if(W&&K>=2){R=T,console.log(`[Archive] Found department header row at ${T} (matched ${K} metrics)`);break}}if(R>=0){let V=[S[R]];for(let G=R+1;G<S.length;G++){let W=String(S[G][0]||"").trim();if(!W||(V.push(S[G]),W==="TOTAL"))break}h=V,console.log(`[Archive] Extracted department table: ${V.length} rows (1 header + ${V.length-1} data)`)}else console.warn("[Archive] \u26A0 Could not find department table header in PR_Expense_Review")}}if(h&&h.length>0){let k=h[0].map(D=>String(D||"").trim()),S=k.findIndex(D=>D.toLowerCase().replace(/[^a-z]/g,"")==="department");d=k.filter((D,R)=>R!==S&&D!==""),console.log(`[Archive] Extracted ${d.length} dept metric headers: ${d.join(", ")}`)}}let p=r.getUsedRangeOrNullObject();p.load("values,rowCount,columnCount"),await e.sync();let m=[];if(!p.isNullObject&&p.values&&p.values.length>0){m=p.values[0];let _=m.map(D=>String(D||"").toLowerCase().trim());_.some(D=>D==="row_type"||D==="rowtype")||(console.log("[Archive] Adding Row_Type column to existing archive headers"),m=[m[0],"Row_Type",...m.slice(1)]);let S=d.filter(D=>{let R=D.toLowerCase().replace(/[^a-z0-9]/g,"");return!_.some(T=>T.replace(/[^a-z0-9]/g,"")===R)});S.length>0&&(console.log(`[Archive] Expanding archive headers with ${S.length} new metrics: ${S.join(", ")}`),m=[...m,...S])}else console.log("[Archive] Initializing archive headers from PR_Data_Clean + dynamic dept metrics"),m=["Pay_Date","Row_Type",...i,...d];let g=m.map(_=>String(_||"").toLowerCase().trim()).findIndex(_=>_==="pay_date"||_==="payroll_date"||_.includes("pay_period")),v=new Map;!p.isNullObject&&p.values&&p.values.length>1&&p.values.slice(1).forEach(k=>{let S=g>=0?k[g]:"",D=Bn(S),R=D?ma(D):String(S||"").trim();R&&(v.has(R)||v.set(R,[]),v.get(R).push(k))}),console.log(`[Archive] Found ${v.size} existing periods in archive`),f&&v.has(f)&&(console.log(`[Archive] Removing existing data for period: ${f} (idempotent replace)`),v.delete(f));let y=o.map(_=>m.map((k,S)=>{let D=String(k||"").trim(),R=D.toLowerCase();if(R==="pay_date"||R==="payroll_date"||R.includes("pay_period"))return f;if(R==="row_type"||R==="rowtype")return"Employee";let T=i.findIndex(V=>String(V||"").trim()===D);return T>=0&&T<_.length?_[T]:""}));console.log(`[Archive] Period ${f}: ${y.length} employee rows (department rows omitted from PR_Archive_Summary)`),v.set(f||`period_${Date.now()}`,y);let x=5,b=Array.from(v.keys()).sort((_,k)=>{let S=new Date(_),D=new Date(k);return!isNaN(S)&&!isNaN(D)?D-S:k.localeCompare(_)});if(console.log(`[Archive] Total periods in archive: ${b.length}`),console.log(`[Archive] Periods (newest to oldest): ${b.join(", ")}`),b.length>x){let _=b.slice(x);console.log(`[Archive] \u26A0 Dropping ${_.length} oldest period(s): ${_.join(", ")}`),_.forEach(k=>{var D;let S=((D=v.get(k))==null?void 0:D.length)||0;console.log(`[Archive]   - Removing period ${k} (${S} rows)`),v.delete(k)})}else console.log(`[Archive] \u2713 Retaining all ${b.length} periods (under limit of ${x})`);let C=Array.from(v.keys()).sort((_,k)=>{let S=new Date(_),D=new Date(k);return!isNaN(S)&&!isNaN(D)?D-S:k.localeCompare(_)}),w=[];C.forEach(_=>{let k=v.get(_);w.push(...k)});try{let _=["Pay_Date","Row_Type","Department","Fixed Salary","Variable Salary","Gross Pay","Burden","All-In Total","% of Total","Headcount"],k=U=>String(U||"").toLowerCase().replace(/[^a-z0-9]/g,""),S=(U,P)=>{let B=U.map(k);for(let Y of P){let Q=k(Y),J=B.findIndex(oe=>oe===Q);if(J>=0)return J}return-1},D=[];if(h&&h.length>1){let U=(h[0]||[]).map(Se=>String(Se||"").trim()),P=S(U,["Department"]),B=S(U,["Fixed Salary","Fixed","Base Salary"]),Y=S(U,["Variable Salary","Variable","Variable Pay"]),Q=S(U,["Gross Pay","Gross","Gross Wages"]),J=S(U,["Burden","Payroll Burden","Employer Burden"]),oe=S(U,["All-In Total","All In Total","All-In","Total"]),ae=S(U,["% of Total","Percent of Total","Percentage"]),be=S(U,["Headcount","Head Count","Employee Count"]),O=0;for(let Se=1;Se<h.length;Se++){let ke=h[Se]||[],Ne=P>=0?String(ke[P]||"").trim():"";if(!Ne)break;let pe=B>=0&&Number(ke[B])||0,z=Y>=0&&Number(ke[Y])||0,ce=Q>=0?Number(ke[Q])||0:pe+z,ft=J>=0&&Number(ke[J])||0,Ot=oe>=0?Number(ke[oe])||0:ce+ft,ze=ae>=0&&Number(ke[ae])||0,Pt=be>=0&&Number(ke[be])||0;if(Ne==="TOTAL"&&(O=Ot),D.push([f,Ne==="TOTAL"?"TOTAL":"DEPT_TOTAL",Ne,pe,z,ce,ft,Ot,ze,Pt]),Ne==="TOTAL")break}O>0&&(D=D.map(Se=>{if(String(Se[1]||"").trim().toUpperCase()==="TOTAL"||(Number(Se[8])||0)>0)return Se;let pe=Number(Se[7])||0;return[...Se.slice(0,8),pe/O,...Se.slice(9)]}))}if(D.length===0){let U=eS(i,o);D=[[f,"TOTAL","TOTAL",U.fixed||0,U.variable||0,(U.fixed||0)+(U.variable||0),U.burden||0,U.total||0,U.total?1:0,U.headcount||0]]}let R=a.getUsedRangeOrNullObject();R.load("values,rowCount,columnCount,isNullObject"),await e.sync();let T=!R.isNullObject&&R.values?R.values:[],G=(T.length>0?T[0]:[]).map(k),j=_.map(k).map(U=>G.findIndex(P=>P===U)),se=U=>_.map((P,B)=>{let Y=j[B];return Y<0?B<=2?"":0:U[Y]}),q=new Map;T.length>1&&T.slice(1).forEach(P=>{let B=se(P),Y=B[0],Q=Bn(Y),J=Q?ma(Q):String(Y||"").trim();J&&(q.has(J)||q.set(J,[]),q.get(J).push(B))}),f&&q.has(f)&&(console.log(`[Archive] Removing existing totals for period: ${f} (idempotent replace)`),q.delete(f)),q.set(f||`period_${Date.now()}`,D);let K=Array.from(q.keys()).sort((U,P)=>{let B=new Date(U),Y=new Date(P);return!isNaN(B)&&!isNaN(Y)?Y-B:P.localeCompare(U)});if(K.length>x){let U=K.slice(x);console.log(`[Archive] \u26A0 Dropping ${U.length} oldest totals period(s): ${U.join(", ")}`),U.forEach(P=>q.delete(P))}let Z=Array.from(q.keys()).sort((U,P)=>{let B=new Date(U),Y=new Date(P);return!isNaN(B)&&!isNaN(Y)?Y-B:P.localeCompare(U)}),X=[];Z.forEach(U=>{X.push(...q.get(U)||[])}),R.isNullObject||R.clear(Excel.ClearApplyTo.contents);let F=a.getRangeByIndexes(0,0,1,_.length);if(F.values=[_],X.length>0){let U=a.getRangeByIndexes(1,0,X.length,_.length);U.values=X}if(await e.sync(),F.format.font.bold=!0,F.format.font.size=11,F.format.fill.color="#1e293b",F.format.font.color="#ffffff",F.format.horizontalAlignment="Center",F.format.verticalAlignment="Center",a.freezePanes.freezeRows(1),X.length>0){let U=X.length;a.getRangeByIndexes(1,0,U,1).numberFormat=[["mm/dd/yyyy"]],a.getRangeByIndexes(1,3,U,1).numberFormat=[["$#,##0"]],a.getRangeByIndexes(1,4,U,1).numberFormat=[["$#,##0"]],a.getRangeByIndexes(1,5,U,1).numberFormat=[["$#,##0"]],a.getRangeByIndexes(1,6,U,1).numberFormat=[["$#,##0"]],a.getRangeByIndexes(1,7,U,1).numberFormat=[["$#,##0"]],a.getRangeByIndexes(1,8,U,1).numberFormat=[["0.00%"]],a.getRangeByIndexes(1,9,U,1).numberFormat=[["#,##0"]];for(let P=0;P<X.length;P++){let B=X[P]||[],Y=String(B[1]||"").trim().toUpperCase(),Q=String(B[2]||"").trim().toUpperCase();if(Y==="TOTAL"||Q==="TOTAL"){let J=a.getRangeByIndexes(P+1,0,1,_.length);J.format.fill.color="#e2e8f0",J.format.font.bold=!0,J.format.borders.getItem("EdgeTop").style="Continuous",J.format.borders.getItem("EdgeTop").weight="Medium"}}}a.getUsedRange().format.autofitColumns(),await e.sync(),console.log(`[Archive] \u2705 Archive totals updated: ${X.length} rows across ${Z.length} periods`)}catch(_){console.warn("[Archive] \u26A0 Failed to update PR_Archive_Totals:",_)}if(w.length>0){let _=r.getRangeByIndexes(0,0,1,m.length);_.values=[m];let k=r.getRangeByIndexes(1,0,w.length,m.length);k.values=w,await e.sync(),_.format.font.bold=!0,_.format.font.size=11,_.format.fill.color="#1e293b",_.format.font.color="#ffffff",_.format.horizontalAlignment="Center",_.format.verticalAlignment="Center",r.freezePanes.freezeRows(1);let S=0,D=m.findIndex(q=>{let K=String(q||"").toLowerCase();return K.includes("employee")&&!K.includes("amount")}),R=m.indexOf("Fixed Salary"),T=m.indexOf("Variable Salary"),V=m.indexOf("Gross Pay"),G=m.indexOf("Burden"),W=m.indexOf("All-In Total"),j=m.indexOf("% of Total"),se=m.indexOf("Headcount");for(let q=1;q<=w.length;q++){let K=w[q-1],Z=D>=0?String(K[D]||"").trim():"",X=Z.endsWith(" Total");if(S>=0){let F=r.getRangeByIndexes(q,S,1,1);F.numberFormat=[["mm/dd/yyyy"]]}if(R>=0){let F=r.getRangeByIndexes(q,R,1,1);F.numberFormat=[["$#,##0"]]}if(T>=0){let F=r.getRangeByIndexes(q,T,1,1);F.numberFormat=[["$#,##0"]]}if(V>=0){let F=r.getRangeByIndexes(q,V,1,1);F.numberFormat=[["$#,##0"]]}if(G>=0){let F=r.getRangeByIndexes(q,G,1,1);F.numberFormat=[["$#,##0"]]}if(W>=0){let F=r.getRangeByIndexes(q,W,1,1);F.numberFormat=[["$#,##0"]]}if(j>=0){let F=r.getRangeByIndexes(q,j,1,1);F.numberFormat=[["0.00%"]]}if(se>=0){let F=r.getRangeByIndexes(q,se,1,1);F.numberFormat=[["#,##0"]]}if(X){let F=r.getRangeByIndexes(q,0,1,m.length);F.format.fill.color="#f1f5f9",F.format.font.bold=!0,(Z==="TOTAL"||Z==="TOTAL Total")&&(F.format.fill.color="#e2e8f0",F.format.font.color="#1e293b",F.format.borders.getItem("EdgeTop").style="Continuous",F.format.borders.getItem("EdgeTop").weight="Medium")}}r.getUsedRange().format.autofitColumns(),S>=0&&(r.getRange(`${String.fromCharCode(65+S)}:${String.fromCharCode(65+S)}`).format.columnWidth=85),D>=0&&(r.getRange(`${String.fromCharCode(65+D)}:${String.fromCharCode(65+D)}`).format.columnWidth=200),await e.sync(),console.log(`[Archive] \u2705 Archive summary updated and formatted: ${w.length} rows across ${b.length} periods`)}else console.log("[Archive] No data to write to archive");await e.sync()})}async function rS(){let e=[Fe.DATA_CLEAN,Fe.EXPENSE_REVIEW,Fe.JE_DRAFT];await Excel.run(async t=>{for(let r of e){let a=t.workbook.worksheets.getItemOrNullObject(r);if(a.load("isNullObject"),await t.sync(),a.isNullObject){console.log(`[Archive] Sheet not found: ${r}`);continue}let n=a.getUsedRangeOrNullObject();if(n.load("rowCount,columnCount,address"),await t.sync(),n.isNullObject||n.rowCount<=1){console.log(`[Archive] Sheet empty or headers only: ${r}`);continue}if(a.getRange(`A2:${String.fromCharCode(64+n.columnCount)}${n.rowCount}`).clear(Excel.ClearApplyTo.contents),r===Fe.EXPENSE_REVIEW){let i=a.charts;i.load("items"),await t.sync();for(let o=i.items.length-1;o>=0;o--)i.items[o].delete()}await t.sync(),console.log(`[Archive] Cleared data from: ${r}`)}})}async function aS(){await Excel.run(async e=>{let t=await Na(e);if(!t){console.warn("[Archive] Config table not found");return}let r=t.getDataBodyRange();r.load("values,rowCount"),await e.sync();let a=r.values||[],n=0,s=Object.values(aa).map(i=>i.note);for(let i=0;i<a.length;i++){let o=String(a[i][et.FIELD]||"").trim(),l=String(a[i][et.PERMANENT]||"").toUpperCase();s.includes(o)&&l!=="Y"&&(r.getCell(i,et.VALUE).values=[[""]],n++)}await e.sync(),console.log(`[Archive] Cleared ${n} non-permanent notes`)})}async function nS(){await Excel.run(async e=>{let t=await Na(e);if(!t){console.warn("[Archive] Config table not found");return}let r=t.getDataBodyRange();r.load("values,rowCount"),await e.sync();let a=r.values||[],n=0,s=[],i=[];for(let o=0;o<a.length;o++){let l=String(a[o][et.FIELD]||"").trim(),c=a[o][et.VALUE];String(a[o][et.PERMANENT]||"").toUpperCase().trim()!=="Y"?c!==""&&c!==null&&c!==void 0&&(r.getCell(o,et.VALUE).values=[[""]],n++,s.push(l)):i.push(l)}await e.sync(),console.log(`[Archive] Reset ${n} non-permanent config values:`,s),console.log(`[Archive] Preserved ${i.length} permanent fields:`,i),s.forEach(o=>{let l=kr(o);Object.keys(ht.values).forEach(c=>{kr(c)===l&&(ht.values[c]="")})})})}async function Od(){if(!mt()){Ie("Excel runtime is unavailable.","error");return}at.loading=!0,at.lastError=null,at.validationRun=!1,dd(!1),it();try{let e=await Excel.run(async t=>{var C;let r=t.workbook.worksheets.getItemOrNullObject(Fe.JE_DRAFT);if(r.load("isNullObject"),await t.sync(),r.isNullObject)throw new Error(`${Fe.JE_DRAFT} sheet not found. Click "Generate" first to create the journal entry.`);let a=r.getUsedRangeOrNullObject();a.load("values"),await t.sync();let n=a.isNullObject?[]:a.values||[];if(!n.length)throw new Error(`${Fe.JE_DRAFT} is empty. Click "Generate" to create the journal entry.`);let s=(n[0]||[]).map(w=>Da(w));console.log("[JE-Validation] Headers:",s);let i=s.findIndex(w=>w.includes("debit")),o=s.findIndex(w=>w.includes("credit")),l=s.findIndex(w=>w.includes("account")&&w.includes("name"));if(console.log("[JE-Validation] Column indexes: debit=",i,"credit=",o,"acctName=",l),i===-1||o===-1)throw new Error("Debit/Credit columns not found in JE Draft.");let c=0,f=0,d=0;n.slice(1).forEach((w,_)=>{let k=Number(w[i])||0,S=Number(w[o])||0,D=l!==-1?String(w[l]||"").trim().toLowerCase():"";c+=k,f+=S;let R=D.includes("uncategorized")||D.includes("clearing");D&&!R&&(d+=k-S),_<3&&console.log(`[JE-Validation] Row ${_}: debit=${k}, credit=${S}, acct="${D}", isOffset=${R}`)}),console.log("[JE-Validation] Totals: debit=",c,"credit=",f,"jeExpense=",d);let h=await Xi(),p=Number.isFinite(Number(h.total))?h.total:0,m={includedColumns:Array.isArray(h.includedMeasureHeaders)?h.includedMeasureHeaders:[],excludedColumns:Array.isArray(h.excludedHeaders)?h.excludedHeaders:[]},u=c-f,g=[],v=Te("PR_Payroll_Date");String(v||"").trim()?g.push({check:"Payroll Date Configured",passed:!0,detail:""}):g.push({check:"Payroll Date Configured",passed:!1,detail:"Payroll date missing in SS_Config (PR_Payroll_Date)."}),Math.abs(u)>=.01?g.push({check:"Debits = Credits",passed:!1,detail:u>0?`Debits exceed credits by ${Ia(Math.abs(u))}`:`Credits exceed debits by ${Ia(Math.abs(u))}`}):g.push({check:"Debits = Credits",passed:!0,detail:""});let y=Math.abs(d-p);y>=.01?g.push({check:"JE Matches Source Total",passed:!1,detail:`PR_Data_Clean total ${Ia(p)} vs JE expense total ${Ia(d)} (\u0394 ${Ia(y)})`}):g.push({check:"JE Matches Source Total",passed:!0,detail:""});let x=((C=at.unmappedColumns)==null?void 0:C.length)||0,b=at.unmappedTotal||0;return x>0?g.push({check:"All Columns Mapped",passed:!1,detail:`${x} column+dept combinations (${Ia(Math.abs(b))}) need GL mappings`}):g.push({check:"All Columns Mapped",passed:!0,detail:""}),{debitTotal:c,creditTotal:f,difference:u,cleanTotal:p,cleanTotalsInfo:m,issues:g,validationRun:!0}});Object.assign(at,e,{lastError:null})}catch(e){console.warn("JE summary:",e),at.lastError=(e==null?void 0:e.message)||"Unable to calculate journal totals.",at.debitTotal=null,at.creditTotal=null,at.difference=null,at.cleanTotal=null,at.validationRun=!1,at.issues=[]}finally{at.loading=!1,it()}}async function sS(){try{let e=Number.isFinite(Number(at.debitTotal))?at.debitTotal:"",t=Number.isFinite(Number(at.creditTotal))?at.creditTotal:"",r=Number.isFinite(Number(at.difference))?at.difference:"";await Promise.all([Ls(_b,String(e)),Ls(wb,String(t)),Ls(Eb,String(r))]),dd(!0)}catch(e){console.error("JE save:",e)}}async function iS(){if(!mt()){Ie("Excel runtime is unavailable.","error");return}try{let{rows:e}=await Excel.run(async o=>{let c=o.workbook.worksheets.getItem(Fe.JE_DRAFT).getUsedRangeOrNullObject();c.load("values"),await o.sync();let f=c.isNullObject?[]:c.values||[];if(!f.length)throw new Error(`${Fe.JE_DRAFT} is empty.`);return{rows:f}}),t=(e[0]||[]).map(o=>String(o||"").trim().toLowerCase()),r=t.findIndex(o=>o.includes("debit")),a=t.findIndex(o=>o.includes("credit")),n=t.findIndex(o=>o.includes("journaldate")||o.includes("txndate")||o==="date"),s=e.map((o,l)=>{if(l===0)return o;let c=[...o||[]],f=h=>{if(h===null||h==="")return"";let p=Number(h);return Number.isFinite(p)?p.toFixed(2):""},d=h=>{if(h===null||h==="")return"";if(typeof h=="string"&&/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(h.trim()))return h.trim();if(typeof h=="number"&&Number.isFinite(h)){let p=Math.round((h-25569)*86400*1e3),m=new Date(p);if(Number.isFinite(m.getTime())){let u=String(m.getMonth()+1).padStart(2,"0"),g=String(m.getDate()).padStart(2,"0"),v=m.getFullYear();if(v>=1900&&v<=2100)return`${u}/${g}/${v}`}}if(h instanceof Date&&Number.isFinite(h.getTime())){let p=String(h.getMonth()+1).padStart(2,"0"),m=String(h.getDate()).padStart(2,"0"),u=h.getFullYear();return`${p}/${m}/${u}`}return String(h)};return r>=0&&(c[r]=f(c[r])),a>=0&&(c[a]=f(c[a])),n>=0&&(c[n]=d(c[n])),c}),i=Sk(s);Ck(`pr-je-draft-${Hn()}.csv`,i)}catch(e){console.warn("JE export:",e),Ie("Unable to export the JE draft. Confirm the sheet has data.","error")}}async function oS(e){if(!mt())return Te(e);try{let{value:t}=await Excel.run(async r=>{var o;let a=await Na(r);if(!a)return{value:""};let n=a.getDataBodyRange();n.load("values"),await r.sync();let s=n.values||[],i=kr(e);for(let l of s)if(kr(l[et.FIELD])===i)return{value:(o=l[et.VALUE])!=null?o:""};return{value:""}});return t}catch(t){return console.warn("readConfigValueFromWorkbook:",t),Te(e)}}function lS(e){if(e==null)return{value:"",valid:!1};if(e==="")return{value:"",valid:!1};if(typeof e=="number"&&Number.isFinite(e)){let o=Math.round((e-25569)*86400*1e3),l=new Date(o);if(!Number.isFinite(l.getTime()))return{value:"",valid:!1};let c=String(l.getUTCMonth()+1).padStart(2,"0"),f=String(l.getUTCDate()).padStart(2,"0"),d=l.getUTCFullYear();return d<1900||d>2100?{value:"",valid:!1}:{value:`${c}/${f}/${d}`,valid:!0}}if(e instanceof Date){let o=e;if(!Number.isFinite(o.getTime()))return{value:"",valid:!1};let l=String(o.getUTCMonth()+1).padStart(2,"0"),c=String(o.getUTCDate()).padStart(2,"0"),f=o.getUTCFullYear();return f<1900||f>2100?{value:"",valid:!1}:{value:`${l}/${c}/${f}`,valid:!0}}let t=String(e).trim();if(!t)return{value:"",valid:!1};let r=Vs(t);if(r&&r.year>=1900&&r.year<=2100){let o=String(r.month).padStart(2,"0"),l=String(r.day).padStart(2,"0");return{value:`${o}/${l}/${r.year}`,valid:!0}}let a=new Date(t);if(!Number.isFinite(a.getTime()))return{value:"",valid:!1};let n=a.getUTCFullYear();if(n<1900||n>2100)return{value:"",valid:!1};let s=String(a.getUTCMonth()+1).padStart(2,"0"),i=String(a.getUTCDate()).padStart(2,"0");return{value:`${s}/${i}/${n}`,valid:!0}}async function cS(){let e=Te("SS_Accounting_Software");if(!e&&mt())try{await Excel.run(async t=>{let r=await Na(t);if(!r)return;let a=r.getDataBodyRange();a.load("values"),await t.sync();let n=a.values||[];for(let s of n){let i=String(s[et.FIELD]||"").trim();if(i==="SS_Accounting_Software"||kr(i)===kr("SS_Accounting_Software")){e=String(s[et.VALUE]||"").trim();break}}})}catch(t){console.warn("Error reading accounting software URL:",t)}if(!e){Ie("No accounting software URL configured. Add SS_Accounting_Software to SS_PF_Config.","info",5e3);return}!e.startsWith("http://")&&!e.startsWith("https://")&&(e="https://"+e),window.open(e,"_blank"),Ie("Opening accounting software...","success",2e3)}function Gr(e){return String(e||"").trim().toLowerCase().replace(/\u00A0/g," ").replace(/\s+/g," ").replace(/&/g,"and")}async function fS(e){let t="https://jgciqwzwacaesqjaoadc.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE",a=`${t}/rest/v1/ada_customer_gl_mappings?company_id=eq.${encodeURIComponent(e)}&module=eq.payroll-recorder&select=pf_column_name,gl_account,gl_account_name,department`;console.log("[JE-V2] Fetching GL mappings:",a);let n=await fetch(a,{headers:{apikey:r,Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!n.ok){let o=await n.text();throw new Error(`GL mappings fetch failed: ${n.status} - ${o}`)}let s=await n.json();console.log(`[JE-V2] Fetched ${s.length} GL mapping rows`);let i=new Map;for(let o of s){let l=Gr(o.pf_column_name),c=Gr(o.department||""),f=`${l}|${c}`;i.has(f)||i.set(f,{gl_account:o.gl_account,gl_account_name:o.gl_account_name||""})}return console.log(`[JE-V2] Built ${i.size} unique GL lookup keys`),i}async function uS(){if(console.log("[JE-V2] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("[JE-V2] Starting Journal Entry Generation (QuickBooks Format)"),console.log("[JE-V2] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),typeof Excel=="undefined"){console.error("[JE-V2] Excel runtime not available"),Ie("Excel runtime not available.","error");return}console.log("[JE-V2] Excel runtime available, proceeding..."),Ie("Generating Journal Entry...","info",1e4);try{let e=Te("SS_Company_ID"),t=Te("PR_Journal_Entry_ID")||"",r=await oS("PR_Payroll_Date");if(console.log(`[JE-V2] company_id: "${e}"`),console.log(`[JE-V2] JournalNo (PR_Journal_Entry_ID): "${t}"`),console.log(`[JE-V2] JournalDate (PR_Payroll_Date): "${r}"`),!e)throw new Error("SS_Company_ID not set in SS_PF_Config. Add a row with Field='SS_Company_ID' and your company UUID.");if(!t)throw new Error("PR_Journal_Entry_ID not set. Please enter a Journal Entry ID in the Configuration step.");let a=lS(r),n=a.valid?a.value:"",s=await fS(e);if(console.log(`[JE-V2] GL mappings loaded: ${s.size}`),s.size===0)throw new Error(`No GL mappings found for company_id="${e}" and module="payroll-recorder". Populate ada_customer_gl_mappings first.`);let i=[],o=new Map;if(await Excel.run(async d=>{try{let w=d.workbook.worksheets.getItemOrNullObject("SS_Chart_of_Accounts");if(w.load("isNullObject"),await d.sync(),!w.isNullObject){let _=w.getUsedRangeOrNullObject();if(_.load("isNullObject"),await d.sync(),!_.isNullObject&&(_.load("values"),await d.sync(),_.values&&_.values.length>1)){let k=_.values[0],S=_.values.slice(1);console.log(`[JE-V2] COA Headers found: ${JSON.stringify(k)}`);let D=k.findIndex(T=>{let V=Gr(T);return V==="account_number"||V==="accountnumber"||V==="account number"||V==="account"||V==="acct"||V==="acctnum"||V==="acct_num"||V==="number"||V==="gl_account"||V.includes("account")&&V.includes("num")}),R=k.findIndex(T=>{let V=Gr(T);return V==="account_name"||V==="accountname"||V==="account name"||V==="name"||V==="acct_name"||V==="acctname"||V==="description"||V==="account_description"||V.includes("account")&&V.includes("name")});if(console.log(`[JE-V2] Account Number column index: ${D}`),console.log(`[JE-V2] Account Name column index: ${R}`),D>=0&&R>=0){for(let T of S){let V=String(T[D]||"").trim(),G=String(T[R]||"").trim();V&&o.set(V,G)}console.log(`[JE-V2] Chart of Accounts lookup built: ${o.size} accounts`),console.log("[JE-V2] Sample COA entries:",Array.from(o.entries()).slice(0,5))}else console.warn(`[JE-V2] Could not find COA columns: acctNumIdx=${D}, acctNameIdx=${R}`)}}}catch(w){console.warn("[JE-V2] Error reading SS_Chart_of_Accounts (non-fatal):",w.message)}let h=d.workbook.worksheets.getItemOrNullObject("PR_Data_Clean");if(h.load("isNullObject"),await d.sync(),h.isNullObject)throw new Error("PR_Data_Clean sheet not found. Run Create Matrix first.");let p=h.getUsedRangeOrNullObject();if(p.load("values"),await d.sync(),p.isNullObject)throw new Error("PR_Data_Clean is empty.");let m=p.values||[];if(m.length<2)throw new Error("PR_Data_Clean has no data rows.");let u=m[0],g=m.slice(1);console.log(`[JE-V2] PR_Data_Clean: ${u.length} columns, ${g.length} rows`);let v=u.findIndex(w=>Gr(w)==="department_name"||Gr(w)==="department"),y=new Set(["pay_date","pay_period_start","pay_period_end","employee_name","employee_id","department","department_code","department_name","location","cost_center","job_title","check_number","pay_type","pay_frequency"]),x=[];for(let w=0;w<u.length;w++){let _=Gr(u[w]);if(y.has(_))continue;g.some(S=>{let D=S[w];return D!==null&&D!==""&&!isNaN(Number(D))})&&x.push({index:w,header:u[w]})}console.log(`[JE-V2] Numeric columns found: ${x.length}`);let b=new Map;for(let w of g){let _=v>=0?String(w[v]||""):"";for(let k of x){let S=w[k.index],D=Number(S);if(isNaN(D)||D===0)continue;let R=Gr(k.header),T=Gr(_),V=`${R}|${T}`,G=b.get(V)||{pf_column_name:k.header,department:_,amount:0};G.amount+=D,b.set(V,G)}}console.log(`[JE-V2] Aggregated lines: ${b.size}`);let C=[];for(let[w,_]of b){if(Math.abs(_.amount)<.01)continue;let k=Gr(_.pf_column_name),S=Gr(_.department),D=`${k}|${S}`,R=s.get(D);if(R||(D=`${k}|`,R=s.get(D)),!R)throw console.error("[JE] MISSING GL MAPPING:",{pf_column_name:_.pf_column_name,department:_.department,hint:"Check ada_customer_gl_mappings has this pf_column_name"}),new Error(`Missing GL mapping for: pf_column_name="${_.pf_column_name}", department="${_.department}". Verify this pf_column_name exists in ada_payroll_column_dictionary.`);let T=o.get(R.gl_account)||R.gl_account_name||"";C.push({pf_column_name:_.pf_column_name,department:_.department,amount:_.amount,gl_account:R.gl_account,gl_account_name:T})}console.log(`[JE-V2] JE lines with GL accounts: ${C.length}`),i=C}),i.length===0)throw new Error("No JE lines generated. Check PR_Data_Clean has numeric data.");let l=0,c=0;for(let d of i)d.amount>0?l+=d.amount:c+=Math.abs(d.amount);let f=l-c;console.log("[JE-V2] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("[JE-V2] QUICKBOOKS JE SUMMARY"),console.log(`[JE-V2]   JournalNo: ${t}`),console.log(`[JE-V2]   JournalDate: ${n}`),console.log(`[JE-V2]   Total Debits: ${l.toFixed(2)}`),console.log(`[JE-V2]   Total Credits: ${c.toFixed(2)}`),console.log(`[JE-V2]   Offset to Uncategorized Expense: ${f.toFixed(2)}`),console.log("[JE-V2] \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),await Excel.run(async d=>{let h=d.workbook.worksheets.getItemOrNullObject("PR_JE_Draft");if(h.load("isNullObject"),await d.sync(),h.isNullObject)h=d.workbook.worksheets.add("PR_JE_Draft"),console.log("[JE-V2] Created PR_JE_Draft sheet");else{h.visibility=Excel.SheetVisibility.visible;let x=h.getUsedRangeOrNullObject();x.load("isNullObject"),await d.sync(),x.isNullObject||x.clear(),console.log("[JE-V2] Cleared existing PR_JE_Draft")}let p=["JournalNo","JournalDate","Account Name","Debits","Credits","Description"],m=[p];for(let x of i){let b=x.amount>0,C=Math.abs(x.amount),w=`${x.department}${x.department?" - ":""}${x.pf_column_name}`,_=String(x.gl_account).trim(),k=o.get(_),S;k?(S=`${_} ${k}`,console.log(`[JE-V2] GL "${_}" \u2192 "${S}"`)):x.gl_account_name?(S=`${_} ${x.gl_account_name}`,console.log(`[JE-V2] GL "${_}" not in COA, using fallback: "${S}"`)):(S=_,console.log(`[JE-V2] GL "${_}" - no name found, using number only`)),m.push([t,n,S,b?C:"",b?"":C,w])}Math.abs(f)>=.01&&m.push([t,n,"Uncategorized Expense",f<0?Math.abs(f):"",f>0?f:"","Payroll Offset"]);let u=h.getRangeByIndexes(0,0,m.length,p.length);u.values=m;let g=h.getRangeByIndexes(0,0,1,p.length);tn(g);let v="0.00",y=m.length-1;y>0&&(h.getRangeByIndexes(1,3,y,1).numberFormat=[[v]],h.getRangeByIndexes(1,4,y,1).numberFormat=[[v]]),h.getUsedRange().format.autofitColumns(),h.freezePanes.freezeRows(1),h.activate(),await d.sync(),console.log(`[JE-V2] Wrote ${m.length-1} rows to PR_JE_Draft (QuickBooks format)`)}),at.debitTotal=l+(f<0?Math.abs(f):0),at.creditTotal=c+(f>0?f:0),at.difference=at.debitTotal-at.creditTotal,at.lastGenerated=new Date().toISOString(),await Od(),it(),Ie(`Journal Entry created! ${i.length+1} lines (including offset), balanced`,"success",5e3)}catch(e){console.error("[JE-V2] ERROR:",e),Ie(`JE Error: ${e.message}`,"error",1e4)}}})();
/*! Bundled license information:

xlsx/xlsx.mjs:
  (*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com *)

xlsx/xlsx.mjs:
  (*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com *)
*/
//# sourceMappingURL=app.bundle.js.map
