<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ACF ForgeSuite - Payroll Recorder</title>

    <!-- Office.js Library -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="../Common/styles.css?v=20260113k" />
    <link rel="stylesheet" href="styles.css?v=20260113f" />
</head>

<body>
    <!-- Shared utilities (PrairieForge object with mountInfoFab, renderMismatchTiles, etc.) -->
    <script type="text/javascript" src="../Common/common.js?v=20251202j"></script>
    
    <!-- Seasonal effects (Christmas lights, snow, etc.) -->
    <script type="text/javascript" src="../Common/seasonal.js?v=20251216c"></script>
    
    <div id="loading" class="pf-loading" style="display: none;">
        <p>Loading ACF ForgeSuite‚Ä¶</p>
    </div>

    <!-- JE Info Modal -->
    <div id="je-info-modal" class="pf-modal-overlay" style="display: none;">
        <div class="pf-modal-content">
            <button type="button" class="pf-modal-close" id="je-info-close" aria-label="Close">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="pf-modal-header">
                <div style="font-size: 18px; font-weight: 600; color: #a5b4fc;">üìã Quick Reminder</div>
            </div>
            <div class="pf-modal-body">
                <ol style="margin: 0 0 0 20px; padding: 0; list-style-type: decimal;">
                    <li style="margin-bottom: 16px; padding-left: 4px;">
                        <strong>Assign bank feed</strong><br>
                        <span style="color: #d1d5db;">Assign the bank feed transaction to uncategorized expense (no need to separate this out like in the past)</span>
                    </li>
                    <li style="margin-bottom: 16px; padding-left: 4px;">
                        <strong>Export CSV</strong><br>
                        <span style="color: #d1d5db;">Export this .csv file and save to your desktop (or other temporary folder)</span>
                    </li>
                    <li style="margin-bottom: 16px; padding-left: 4px;">
                        <strong>Upload to QuickBooks</strong><br>
                        <span style="color: #d1d5db;">Click the <span style="font-size: 15px;">‚öôÔ∏è</span> icon ‚Üí Import Data ‚Üí Journal Entry ‚Üí Upload a file to import data. Map any fields that don't automap.</span>
                    </li>
                </ol>
                <hr style="border: none; border-top: 1px solid rgba(255,255,255,0.15); margin: 20px 0;">
                <div style="font-size: 13px; color: #9ca3af; line-height: 1.6;">
                    <p style="margin: 0 0 12px 0;">
                        <strong style="color: #fbbf24;">üí° Note:</strong> The journal entry will also be booked to uncategorized expense. If everything goes as planned, uncategorized expense should be zero after recording the bank transaction and this journal entry.
                    </p>
                    <p style="margin: 0;">
                        If there are differences, they may indicate a fee that was charged but not presented in the payroll report. This should be a separate journal entry.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main application script -->
    <script src="app.js?v=20251202j"></script>
    <script>
        // Close modal handlers
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('je-info-modal');
            const closeBtn = document.getElementById('je-info-close');
            
            // Close on X button
            closeBtn?.addEventListener('click', () => {
                if (modal) modal.style.display = 'none';
            });
            
            // Close on backdrop click
            modal?.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Close on Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modal?.style.display === 'flex') {
                    modal.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
