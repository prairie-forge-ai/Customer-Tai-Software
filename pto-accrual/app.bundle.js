/* Prairie Forge PTO Accrual */
(()=>{var Uu=Object.defineProperty;var ac=(e,r)=>()=>(e&&(r=e(e=0)),r);var ju=(e,r)=>{for(var t in r)Uu(e,t,{get:r[t],enumerable:!0})};var ai,ss=ac(()=>{ai={COMPANY_NAME:"Prairie Forge LLC",PRODUCT_NAME:"Prairie Forge Tools",SUPPORT_URL:"https://prairieforge.ai/support",ADA_IMAGE_URL:"https://assets.prairieforge.ai/storage/v1/object/public/Other%20Public%20Material/Prairie%20Forge/Ada%20Image.png"}});var oc={};ju(oc,{DEFAULT_OPTIONS:()=>cs,bindCopilotCard:()=>fs,createExcelContextProvider:()=>ni,renderCopilotCard:()=>ls});function ls(e={}){var a;let r={...cs,...e},t=((a=r.quickActions)==null?void 0:a.map(n=>`<button type="button" class="pf-ada-chip" data-action="${n.id}" data-prompt="${rd(n.prompt)}">${n.label}</button>`).join(""))||"";return`
        <article class="pf-ada" data-copilot="${r.id}">
            <header class="pf-ada-header">
                <div class="pf-ada-identity">
                    <img class="pf-ada-avatar" src="${td}" alt="Ada" onerror="this.style.display='none'" />
                    <div class="pf-ada-name">
                        <span class="pf-ada-title"><span class="pf-ada-title--ask">ask</span><span class="pf-ada-title--ada">ADA</span></span>
                        <span class="pf-ada-role">${r.subtext}</span>
                    </div>
                </div>
                <div class="pf-ada-header-right">
                    <span class="pf-ada-beta-tag">BETA</span>
                    <div class="pf-ada-status" id="${r.id}-status-badge" title="Ready">
                        <span class="pf-ada-status-dot" id="${r.id}-status-dot"></span>
                    </div>
                </div>
            </header>
            
            <div class="pf-ada-body">
                <div class="pf-ada-conversation" id="${r.id}-messages">
                    <div class="pf-ada-bubble pf-ada-bubble--ai">
                        <p>${r.welcomeMessage}</p>
                    </div>
                </div>
                
                <div class="pf-ada-composer">
                    <input 
                        type="text" 
                        class="pf-ada-input" 
                        id="${r.id}-prompt" 
                        placeholder="${r.placeholder}" 
                        autocomplete="off"
                    >
                    <button type="button" class="pf-ada-send" id="${r.id}-ask" title="Send">
                        ${ed}
                    </button>
                </div>
                
                ${t?`<div class="pf-ada-chips">${t}</div>`:""}
                
                <footer class="pf-ada-footer">
                    ${Qu}
                    <span>Powered by <span class="pf-ada-model">GPT-4 Turbo</span></span>
                </footer>
            </div>
        </article>
    `}function rd(e){return String(e||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function fs(e,r={}){let t={...cs,...r},a=e.querySelector(`[data-copilot="${t.id}"]`);if(!a)return;let n=a.querySelector(`#${t.id}-messages`),i=a.querySelector(`#${t.id}-prompt`),s=a.querySelector(`#${t.id}-ask`),o=a.querySelector(`#${t.id}-status-dot`),c=a.querySelector(`#${t.id}-status-badge`),l=!1,f=(g,v="ready")=>{o&&(o.classList.remove("pf-ada-status-dot--busy","pf-ada-status-dot--offline"),v==="busy"&&o.classList.add("pf-ada-status-dot--busy"),v==="offline"&&o.classList.add("pf-ada-status-dot--offline")),c&&(c.title=g)},d=(g,v="assistant")=>{if(!n)return;let y=v==="user"?"pf-ada-bubble--user":v==="system"?"pf-ada-bubble--system":"pf-ada-bubble--ai",x=document.createElement("div");x.className=`pf-ada-bubble ${y}`,x.innerHTML=`<p>${m(g)}</p>`,n.appendChild(x),n.scrollTop=n.scrollHeight,os.push({role:v,content:g,timestamp:new Date().toISOString()})},u=()=>{if(!n)return;let g=document.createElement("div");g.className="pf-ada-bubble pf-ada-bubble--ai pf-ada-bubble--loading",g.id=`${t.id}-loading`,g.innerHTML=`
            <div class="pf-ada-typing">
                <span></span><span></span><span></span>
            </div>
        `,n.appendChild(g),n.scrollTop=n.scrollHeight},h=()=>{let g=document.getElementById(`${t.id}-loading`);g&&g.remove()},m=g=>String(g).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n\n/g,"</p><p>").replace(/\n- /g,"<br>\u2022 ").replace(/\n/g,"<br>"),p=async g=>{let v=g||(i==null?void 0:i.value.trim());if(!(!v||l)){l=!0,i&&(i.value=""),s&&(s.disabled=!0),d(v,"user"),u(),f("Analyzing...","busy");try{let y=null;if(typeof t.contextProvider=="function")try{y=await t.contextProvider()}catch(F){console.warn("CoPilot: Context provider failed",F)}let x;typeof t.onPrompt=="function"?x=await t.onPrompt(v,y,os):typeof t.apiEndpoint=="string"?x=await ad(t.apiEndpoint,v,y,t.systemPrompt):x=nd(v,y),h(),d(x,"assistant"),f("Ready to assist","ready")}catch(y){console.error("CoPilot error:",y),h(),d(`I encountered an issue: ${y.message}. Please try again.`,"system"),f("Error occurred","offline")}l=!1,s&&(s.disabled=!1),i==null||i.focus()}};s==null||s.addEventListener("click",()=>p()),i==null||i.addEventListener("keydown",g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),p())}),a.querySelectorAll(".pf-ada-chip").forEach(g=>{g.addEventListener("click",()=>{let v=g.dataset.prompt;v&&p(v)})})}async function ad(e,r,t,a){let n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:r,context:t,systemPrompt:a,history:os.slice(-10)})});if(!n.ok)throw new Error(`API request failed: ${n.status}`);let i=await n.json();return i.message||i.response||"No response received."}function nd(e,r){var a,n,i;let t=e.toLowerCase();return t.includes("diagnostic")||t.includes("check")?`Great question! Let me run through the diagnostics for you.

**\u2713 What Looks Good:**
\u2022 All required fields are populated
\u2022 Current period matches your config date
\u2022 All expense categories are mapped to GL accounts

**\u26A0\uFE0F Items Worth Reviewing:**
\u2022 2 departments show >15% variance from prior period
\u2022 Burden rate (14.6%) is slightly below your historical average (16.2%)

**My Recommendations:**
1. Take a closer look at the Sales & Marketing variance (-44.4%)
2. Verify headcount changes align with HR records
3. Once satisfied, you're clear to proceed to Journal Entry Prep!

Let me know if you'd like me to dig deeper into any of these.`:t.includes("insight")||t.includes("notable")||t.includes("finding")?`Here's what stands out this period \u2014 perfect for your executive summary.

**\u{1F4CA} The Headlines:**
\u2022 Total Payroll: ${(a=r==null?void 0:r.summary)!=null&&a.total?`$${(r.summary.total/1e3).toFixed(0)}K`:"$254K"}
\u2022 Headcount: ${((n=r==null?void 0:r.summary)==null?void 0:n.employeeCount)||38} employees
\u2022 Avg Cost/Employee: ${(i=r==null?void 0:r.summary)!=null&&i.avgPerEmployee?`$${r.summary.avgPerEmployee.toFixed(0)}`:"$6,674"}

**\u{1F4A1} Key Findings:**
1. **Payroll decreased 14.2%** \u2014 primarily driven by headcount reduction in Sales
2. **R&D remains your largest cost center** at 39% of total payroll
3. **Burden rate normalized** to 14.6% (was 18.2% prior period)

**\u26A0\uFE0F Items to Flag:**
\u2022 Sales & Marketing down $52K \u2014 worth confirming this was intentional
\u2022 2 fewer employees than prior period

**Suggested Talking Points:**
\u2022 "Payroll efficiency improved with 14% reduction while maintaining core operations"
\u2022 "R&D investment remains strong \u2014 aligned with product roadmap"

Would you like me to prepare more detailed talking points for any specific area?`:t.includes("variance")||t.includes("change")||t.includes("difference")?`**Variance Analysis: Current vs Prior Period**

\u{1F4C8} **Significant Changes**:

| Department | Change | % Change | Driver |
|------------|--------|----------|--------|
| Sales & Marketing | -$52,298 | -44.4% | \u{1F534} Headcount |
| Research & Dev | +$8,514 | +9.4% | Merit increases |
| General & Admin | +$1,610 | +3.9% | Normal variance |

\u{1F50D} **Root Cause Analysis**:

**Sales & Marketing (-44.4%)**:
\u2022 3 positions eliminated per restructuring plan
\u2022 Commission payouts lower due to Q4 timing
\u2022 \u26A0\uFE0F Verify: Is this aligned with sales targets?

**R&D (+9.4%)**:
\u2022 Annual merit increases effective this period
\u2022 1 new senior engineer hire
\u2022 \u2713 Expected per hiring plan

**Recommendation**: Document Sales variance in review notes. This is material and will be questioned.`:t.includes("journal")||t.includes("je")||t.includes("entry")?`Good news \u2014 your journal entry looks ready to go! Here's the full check:

**\u2713 Balance Check: PASSED**
\u2022 Total Debits: $253,625
\u2022 Total Credits: $253,625
\u2022 Difference: $0.00 \u2014 perfectly balanced!

**\u2713 Mapping Validation: Complete**
\u2022 9 unique GL accounts used
\u2022 All department codes are valid

**\u2713 Reference Data:**
\u2022 JE ID: PR-AUTO-2025-11-27
\u2022 Transaction Date: 2025-11-27
\u2022 Period: November 2025

**You're clear to export!** \u2705

**Next Steps:**
1. Click "Export" to download the CSV
2. Import into your accounting system
3. Post and reconcile

Let me know if you need me to double-check anything before you export!`:`Great question! I'm Ada, and I'm here to help with your payroll analysis.

Here's what I can help you with:

\u2022 **\u{1F50D} Diagnostics** \u2014 Check data quality and completeness
\u2022 **\u{1F4A1} Insights** \u2014 Key findings for executive review  
\u2022 **\u{1F4CA} Variance Analysis** \u2014 Period-over-period changes
\u2022 **\u{1F4CB} JE Readiness** \u2014 Validate journal entries before export

Try clicking one of the quick action buttons above, or just ask me something specific like:
\u2022 "What's driving the variance this period?"
\u2022 "Is my data ready for the CFO?"
\u2022 "Summarize the department breakdown"

I'm reading your actual spreadsheet data, so I can give you specific answers!`}function ni(e={}){return async()=>{if(typeof Excel=="undefined")return null;try{return await Excel.run(async r=>{var i;let t={},a=r.workbook.worksheets.getItemOrNullObject(e.dataClean||"PR_Data_Clean");if(a.load("isNullObject"),await r.sync(),!a.isNullObject){let s=a.getUsedRangeOrNullObject();s.load("values, rowCount"),await r.sync(),!s.isNullObject&&((i=s.values)==null?void 0:i.length)>1&&(t.rowCount=s.rowCount-1,t.dataAvailable=!0)}let n=r.workbook.worksheets.getItemOrNullObject(e.config||"SS_PF_Config");return n.load("isNullObject"),await r.sync(),n.isNullObject||(t.configAvailable=!0),{timestamp:new Date().toISOString(),summary:t}})}catch(r){return console.warn("CoPilot: Failed to read Excel context",r),null}}}var Qu,ed,td,cs,os,us=ac(()=>{ss();Qu='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.8956zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z"/></svg>',ed='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>',td=ai.ADA_IMAGE_URL,cs={id:"pf-copilot",heading:"Ada",subtext:"Your smart assistant to help you analyze and troubleshoot.",welcomeMessage:"What would you like to explore?",placeholder:"Where should I focus this pay period?",quickActions:[{id:"diagnostics",label:"Diagnostics",prompt:"Run a diagnostic check on the current payroll data. Check for completeness, accuracy issues, and any data quality concerns."},{id:"insights",label:"Insights",prompt:"What are the key insights and notable findings from this payroll period that I should highlight for executive review?"},{id:"variance",label:"Variances",prompt:"Analyze the significant variances between this period and the prior period. What's driving the changes?"},{id:"journal",label:"JE Check",prompt:"Is the journal entry ready for export? Check that debits equal credits and flag any mapping issues."}],systemPrompt:`You are Prairie Forge CoPilot, an expert financial analyst assistant embedded in an Excel add-in. 

Your role is to help accountants and CFOs:
1. Analyze payroll expense data for accuracy and completeness
2. Identify trends, anomalies, and areas requiring attention
3. Prepare executive-ready insights and talking points
4. Validate journal entries before export

Communication style:
- Be concise but thorough
- Use bullet points for clarity
- Highlight actionable items with \u26A0\uFE0F or \u2713
- Format currency as $X,XXX and percentages as X.X%
- Always suggest 2-3 concrete next steps

When analyzing data, look for:
- Period-over-period changes > 10%
- Department cost anomalies
- Headcount vs payroll mismatches
- Burden rate outliers
- Missing or incomplete mappings`},os=[]});function xt(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}var ns="SS_PF_Config";async function nc(e,r=[ns]){var n;let t=e.workbook.tables;t.load("items/name"),await e.sync();let a=(n=t.items)==null?void 0:n.find(i=>r.includes(i.name));return a?e.workbook.tables.getItem(a.name):(console.warn("Config table not found. Looking for:",r),null)}function ic(e){let r=e.map(t=>String(t||"").trim().toLowerCase());return{field:r.findIndex(t=>t==="field"||t==="field name"||t==="setting"),value:r.findIndex(t=>t==="value"||t==="setting value"),type:r.findIndex(t=>t==="type"||t==="category"),title:r.findIndex(t=>t==="title"||t==="display name"),permanent:r.findIndex(t=>t==="permanent"||t==="persist")}}async function ti(e=[ns]){if(!xt())return{};try{return await Excel.run(async r=>{let t=await nc(r,e);if(!t)return{};let a=t.getDataBodyRange(),n=t.getHeaderRowRange();a.load("values"),n.load("values"),await r.sync();let i=n.values[0]||[],s=ic(i);if(s.field===-1||s.value===-1)return console.warn("Config table missing FIELD or VALUE columns. Headers:",i),{};let o={};return(a.values||[]).forEach(l=>{var d;let f=String(l[s.field]||"").trim();f&&(o[f]=(d=l[s.value])!=null?d:"")}),console.log("Configuration loaded:",Object.keys(o).length,"fields"),o})}catch(r){return console.error("Failed to load configuration:",r),{}}}var Hu=new Set(["SS_Installation_Key","SS_Company_ID","SS_Company_Name","SS_Accounting_Software","PTO_Payroll_Provider","PR_Payroll_Provider"]);async function fn(e,r,t=[ns]){if(!xt())return!1;try{return await Excel.run(async a=>{let n=await nc(a,t);if(!n){console.warn("Config table not found for write");return}let i=n.getDataBodyRange(),s=n.getHeaderRowRange();i.load("values"),s.load("values"),await a.sync();let o=s.values[0]||[],c=ic(o);if(c.field===-1||c.value===-1){console.error("Config table missing FIELD or VALUE columns");return}let f=(i.values||[]).findIndex(u=>String(u[c.field]||"").trim()===e),d=Hu.has(e);if(f>=0)i.getCell(f,c.value).values=[[r]],d&&c.permanent>=0&&(i.getCell(f,c.permanent).values=[["Y"]]);else{let u=new Array(o.length).fill("");c.type>=0&&(u[c.type]=d?"Shared":"Run Settings"),u[c.field]=e,u[c.value]=r,c.permanent>=0&&(u[c.permanent]=d?"Y":"N"),c.title>=0&&(u[c.title]=""),n.rows.add(null,[u]),console.log("Added new config row:",e,"=",r,d?"(permanent)":"")}await a.sync(),console.log("Saved config:",e,"=",r)}),!0}catch(a){return console.error("Failed to save config:",e,a),!1}}var Vu="SS_PF_Config",Wu="module-prefix",Gu="system",is="module-selector",zu="SS_Homepage",Xu=["SS_Employee_Roster","SS_Chart_of_Accounts","SS_PF_Config"],Pa={PR_:"payroll-recorder",PTO_:"pto-accrual",CC_:"credit-card-expense",COM_:"commission-calc",SS_:"system"};async function sc(){if(!xt())return{...Pa};try{return await Excel.run(async e=>{var f,d;let r=e.workbook.worksheets.getItemOrNullObject(Vu);if(await e.sync(),r.isNullObject)return console.log("[Tab Visibility] Config sheet not found, using defaults"),{...Pa};let t=r.getUsedRangeOrNullObject();if(t.load("values"),await e.sync(),t.isNullObject||!((f=t.values)!=null&&f.length))return{...Pa};let a=t.values,n=Ku(a[0]),i=n.get("category"),s=n.get("field"),o=n.get("value");if(i===void 0||s===void 0||o===void 0)return console.warn("[Tab Visibility] Missing required columns, using defaults"),{...Pa};let c={},l=!1;for(let u=1;u<a.length;u++){let h=a[u];if(Yr(h[i])===Wu){let p=String((d=h[s])!=null?d:"").trim().toUpperCase(),g=Yr(h[o]);p&&g&&(c[p]=g,l=!0)}}return l?(console.log("[Tab Visibility] Loaded prefix config:",c),c):(console.log("[Tab Visibility] No module-prefix rows found, using defaults"),{...Pa})})}catch(e){return console.warn("[Tab Visibility] Error reading prefix config:",e),{...Pa}}}async function ri(e){var t;if(!xt())return;let r=Yr(e);console.log(`[Tab Visibility] Applying visibility for module: ${r}`);try{let a=await sc(),n=Object.keys(a).map(o=>String(o!=null?o:"").trim().toUpperCase()).filter(Boolean).sort((o,c)=>c.length-o.length),i=Ju(a),s=r===Yr(is)?null:(t=i[r])!=null?t:null;if(r!==Yr(is)&&!s){console.warn(`[Tab Visibility] No active prefix found for moduleKey="${r}". Skipping visibility changes.`);return}await Excel.run(async o=>{let c=o.workbook.worksheets;c.load("items/name,visibility"),await o.sync();let l=[],f=[],d=[],u=[];c.items.forEach(p=>{let g=p.name,v=g.toUpperCase(),y=!1,x=!1,F=Xu.some(I=>v===I.toUpperCase());if(r===Yr(is))v===zu.toUpperCase()?y=!0:x=!0;else{let I=Zu(v,n);I&&(I===s?y=!0:x=!0),F&&(y=!1,x=!0)}y?(l.push(p),console.log(`[Tab Visibility] SHOW: ${g}`),d.push(g)):x?(f.push(p),console.log(`[Tab Visibility] HIDE: ${g}`),u.push(g)):console.log(`[Tab Visibility] SKIP: ${g} (no prefix match)`)});for(let p of l)p.visibility=Excel.SheetVisibility.visible;if(await o.sync(),c.items.filter(p=>p.visibility===Excel.SheetVisibility.visible).filter(p=>!f.includes(p)).length>=1){for(let p of f)try{p.visibility=Excel.SheetVisibility.hidden}catch(g){console.warn(`[Tab Visibility] Could not hide "${p.name}":`,g.message)}await o.sync()}else console.warn("[Tab Visibility] Skipping hide - would leave no visible sheets");console.log(`[Tab Visibility] Done! Showed ${l.length}, hid ${f.length} tabs`),console.log("[Tab Visibility] Summary:",{moduleKey:r,activePrefix:s,shownSheets:d,hiddenSheets:u})})}catch(a){console.warn("[Tab Visibility] Error applying visibility:",a)}}async function Yu(){if(!xt()){console.log("Excel not available");return}try{await Excel.run(async e=>{let r=e.workbook.worksheets;r.load("items/name,visibility"),await e.sync();let t=0;r.items.forEach(a=>{a.visibility!==Excel.SheetVisibility.visible&&(a.visibility=Excel.SheetVisibility.visible,console.log(`[ShowAll] Made visible: ${a.name}`),t++)}),await e.sync(),console.log(`[ShowAll] Done! Made ${t} sheets visible. Total: ${r.items.length}`)})}catch(e){console.error("[Tab Visibility] Unable to show all sheets:",e)}}async function qu(){if(!xt()){console.log("Excel not available");return}try{let e=await sc(),r=[];for(let[t,a]of Object.entries(e))a===Gu&&r.push(t);await Excel.run(async t=>{let a=t.workbook.worksheets;a.load("items/name,visibility"),await t.sync(),a.items.forEach(n=>{let i=n.name.toUpperCase();r.some(s=>i.startsWith(s))&&(n.visibility=Excel.SheetVisibility.visible,console.log(`[Unhide] Made visible: ${n.name}`))}),await t.sync(),console.log("[Unhide] System sheets are now visible!")})}catch(e){console.error("[Tab Visibility] Unable to unhide system sheets:",e)}}function Ku(e=[]){let r=new Map;return e.forEach((t,a)=>{let n=Yr(t);n&&r.set(n,a)}),r}function Yr(e){return String(e!=null?e:"").trim().toLowerCase().replace(/[\s_]+/g,"-")}function Ju(e){let r={};for(let[t,a]of Object.entries(e!=null?e:{})){let n=String(t!=null?t:"").trim().toUpperCase(),i=Yr(a);!n||!i||r[i]||(r[i]=n)}return r}function Zu(e,r){for(let t of r)if(e.startsWith(t))return t;return null}async function Ra(e){if(!xt())return!1;try{return await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject(e);return await r.sync(),t.isNullObject?(console.warn(`[Tab Visibility] Sheet "${e}" not found`),!1):(t.visibility=Excel.SheetVisibility.visible,t.activate(),await r.sync(),console.log(`[Tab Visibility] Showed and activated: ${e}`),!0)}),!0}catch(r){return console.error(`[Tab Visibility] Error showing sheet "${e}":`,r),!1}}typeof window!="undefined"&&(window.PrairieForge=window.PrairieForge||{},window.PrairieForge.showAllSheets=Yu,window.PrairieForge.unhideSystemSheets=qu,window.PrairieForge.applyModuleTabVisibility=ri,window.PrairieForge.showAndActivateSheet=Ra);ss();var dc=ai.ADA_IMAGE_URL,id="https://jgciqwzwacaesqjaoadc.supabase.co",cc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE";async function lc(e,r,t){let a=`${id}/functions/v1/copilot`;try{console.log("[Ada Popup] Calling copilot API...");let n=await fetch(a,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:`Bearer ${cc}`,apikey:cc},body:JSON.stringify({prompt:e,context:r,module:"general",function:"analysis",history:(t==null?void 0:t.slice(-10))||[]})});if(!n.ok){let s=await n.text();throw console.error("[Ada Popup] API error:",n.status,s),new Error(`API request failed: ${n.status}`)}let i=await n.json();return console.log("[Ada Popup] API response received"),i.message||i.response?i.message||i.response:"I received your question but couldn't generate a response. Please try again."}catch(n){return console.error("[Ada Popup] API call failed:",n),`I'm having trouble connecting right now. Error: ${n.message}. Please try again in a moment.`}}async function ii(e,r,t){if(typeof Excel=="undefined"){console.warn("Excel runtime not available for homepage sheet");return}try{await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject(e);n.load("isNullObject, name, visibility"),await a.sync();let i;n.isNullObject?(i=a.workbook.worksheets.add(e),await a.sync(),await fc(a,i,r,t)):(i=n,i.visibility!==Excel.SheetVisibility.visible&&(i.visibility=Excel.SheetVisibility.visible,await a.sync()),await fc(a,i,r,t)),i.activate(),i.getRange("A1").select(),await a.sync()})}catch(a){console.error(`Error activating homepage sheet ${e}:`,a)}}async function fc(e,r,t,a){try{let l=r.getUsedRangeOrNullObject();l.load("isNullObject"),await e.sync(),l.isNullObject||(l.clear(),await e.sync())}catch{}r.showGridlines=!1,r.getRange("A:A").format.columnWidth=400,r.getRange("B:B").format.columnWidth=50,r.getRange("1:1").format.rowHeight=60,r.getRange("2:2").format.rowHeight=30;let n=[[t,""],[a,""],["",""],["",""]],i=r.getRangeByIndexes(0,0,4,2);i.values=n;let s=r.getRange("A1:Z100");s.format.fill.color="#0f0f0f";let o=r.getRange("A1");o.format.font.bold=!0,o.format.font.size=36,o.format.font.color="#ffffff",o.format.font.name="Segoe UI Light",o.format.verticalAlignment="Center";let c=r.getRange("A2");c.format.font.size=14,c.format.font.color="#a0a0a0",c.format.font.name="Segoe UI",c.format.verticalAlignment="Top",r.freezePanes.freezeRows(0),r.freezePanes.freezeColumns(0),await e.sync()}var uc={"module-selector":{sheetName:"SS_Homepage",title:"ForgeSuite",subtitle:"Select a module from the side panel to get started."},"payroll-recorder":{sheetName:"PR_Homepage",title:"Payroll Recorder",subtitle:"Normalize payroll exports, enforce controls, and prep journal entries without leaving Excel."},"pto-accrual":{sheetName:"PTO_Homepage",title:"PTO Accrual",subtitle:"Calculate employee PTO liabilities, compare period-over-period changes, and prepare accrual journal entries."}};function si(e){return uc[e]||uc["module-selector"]}function hc(){hs();let e=document.createElement("button");return e.className="pf-ada-fab",e.id="pf-ada-fab",e.setAttribute("aria-label","Ask Ada"),e.setAttribute("title","Ask Ada"),e.innerHTML=`
        <span class="pf-ada-fab__ring"></span>
        <img 
            class="pf-ada-fab__image" 
            src="${dc}" 
            alt="Ada - Your AI Assistant"
            onerror="this.style.display='none'"
        />
    `,document.body.appendChild(e),e.addEventListener("click",od),e}function hs(){let e=document.getElementById("pf-ada-fab");e&&e.remove();let r=document.getElementById("pf-ada-modal-overlay");r&&r.remove()}function sd(){let e,r,t,a=async()=>{try{let i=await Promise.resolve().then(()=>(us(),oc));e=i.renderCopilotCard,r=i.bindCopilotCard,t=i.createExcelContextProvider}catch(i){console.warn("Could not load copilot functions:",i)}};return{subtext:"Your AI-powered assistant",copilotHtml:"",bindFunction:async()=>{if(await a(),e&&r){let i=document.getElementById("ada-modal-copilot");i&&(i.innerHTML=e({id:"ada-modal-copilot",heading:"Ada",subtext:"Ask questions about your data",welcomeMessage:"Hi! I'm Ada, your AI assistant. How can I help you today?",placeholder:"Ask about your data, analysis, or insights...",quickActions:[{id:"help",label:"What can you do?",prompt:"What kinds of questions can you help me with? What data do you have access to?"},{id:"overview",label:"Data Overview",prompt:"Give me an overview of the data available in this workbook."},{id:"tips",label:"Best Practices",prompt:"What are some best practices for using this tool effectively?"}],contextProvider:t?t({config:"SS_PF_Config"}):null,onPrompt:lc}),setTimeout(()=>{r(i,{id:"ada-modal-copilot",contextProvider:t?t({config:"SS_PF_Config"}):null,onPrompt:lc})},200))}}}}function od(){let e=document.getElementById("pf-ada-modal-overlay");e&&e.remove();let r=sd(),t=document.createElement("div");t.className="pf-ada-modal-overlay",t.id="pf-ada-modal-overlay",t.innerHTML=`
        <div class="pf-ada-modal pf-ada-modal--chat">
            <div class="pf-ada-modal__header">
                <button class="pf-ada-modal__close" id="ada-modal-close" aria-label="Close">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <img class="pf-ada-modal__avatar" src="${dc}" alt="Ada" />
                <h2 class="pf-ada-modal__title">Ask Ada <span class="pf-ada-beta-tag">BETA</span></h2>
                <p class="pf-ada-modal__subtitle">${r.subtext}</p>
            </div>
            <div class="pf-ada-modal__body">
                <div class="pf-ada-copilot-container" id="ada-modal-copilot">
                    <div class="pf-ada-loading">
                        <div class="pf-ada-typing"><span></span><span></span><span></span></div>
                        <p>Loading Ada...</p>
                    </div>
                </div>
            </div>
        </div>
    `,document.body.appendChild(t),requestAnimationFrame(()=>{t.classList.add("is-visible")});let a=document.getElementById("ada-modal-close");a==null||a.addEventListener("click",ds),t.addEventListener("click",i=>{i.target===t&&ds()});let n=i=>{i.key==="Escape"&&(ds(),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n),r.bindFunction&&r.bindFunction()}function ds(){let e=document.getElementById("pf-ada-modal-overlay");e&&(e.classList.remove("is-visible"),setTimeout(()=>{e.remove()},300))}us();var cd=["January","February","March","April","May","June","July","August","September","October","November","December"],mc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ld=["Su","Mo","Tu","We","Th","Fr","Sa"],Ut=null,pr=null;function gc(e,r={}){let t=document.getElementById(e);if(!t)return;let{onChange:a=null,minDate:n=null,maxDate:i=null,readonly:s=!1}=r,o=t.closest(".pf-datepicker-wrapper");o||(o=document.createElement("div"),o.className="pf-datepicker-wrapper",t.parentNode.insertBefore(o,t),o.appendChild(t)),t.type="text",t.placeholder="Select date...",t.classList.add("pf-datepicker-input"),t.readOnly=!0;let c=t.value?pc(t.value):null;c&&(t.value=ms(c),t.dataset.value=un(c));let l=o.querySelector(".pf-datepicker-icon");l||(l=document.createElement("span"),l.className="pf-datepicker-icon",l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>',o.appendChild(l));let f={inputId:e,input:t,selectedDate:c,viewDate:c?new Date(c):new Date,onChange:a,minDate:n,maxDate:i};function d(){s||(pr=f,fd())}return t.addEventListener("click",d),l.addEventListener("click",d),{getValue:()=>f.selectedDate?un(f.selectedDate):"",setValue:u=>{let h=pc(u);f.selectedDate=h,f.viewDate=h?new Date(h):new Date,h?(t.value=ms(h),t.dataset.value=un(h)):(t.value="",t.dataset.value="")},open:d,close:oi}}function fd(){pr&&(Ut||(Ut=document.createElement("div"),Ut.className="pf-datepicker-modal",Ut.id="pf-datepicker-modal",document.body.appendChild(Ut)),vc(),requestAnimationFrame(()=>{Ut.classList.add("is-open")}),document.addEventListener("keydown",xc))}function oi(){Ut&&Ut.classList.remove("is-open"),document.removeEventListener("keydown",xc),pr=null}function xc(e){e.key==="Escape"&&oi()}function vc(){if(!Ut||!pr)return;let{viewDate:e,selectedDate:r,minDate:t,maxDate:a}=pr,n=e.getFullYear(),i=e.getMonth();Ut.innerHTML=`
        <div class="pf-datepicker-backdrop"></div>
        <div class="pf-datepicker-container">
            <div class="pf-datepicker-header">
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="prev-year" title="Previous Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="11 17 6 12 11 7"/><polyline points="18 17 13 12 18 7"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="prev-month" title="Previous Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                    </button>
                </div>
                <span class="pf-datepicker-title">${cd[i]} ${n}</span>
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="next-month" title="Next Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="next-year" title="Next Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="13 17 18 12 13 7"/><polyline points="6 17 11 12 6 7"/></svg>
                    </button>
                </div>
            </div>
            <div class="pf-datepicker-weekdays">
                ${ld.map(s=>`<span>${s}</span>`).join("")}
            </div>
            <div class="pf-datepicker-days">
                ${hd(n,i,r,t,a)}
            </div>
            <div class="pf-datepicker-footer">
                <button type="button" class="pf-datepicker-btn pf-datepicker-today" data-action="today">Today</button>
                <button type="button" class="pf-datepicker-btn pf-datepicker-clear" data-action="clear">Clear</button>
            </div>
        </div>
    `,ud()}function ud(){var e;Ut&&((e=Ut.querySelector(".pf-datepicker-backdrop"))==null||e.addEventListener("click",oi),Ut.querySelectorAll(".pf-datepicker-nav").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=r.dataset.action;dd(a)})}),Ut.querySelectorAll(".pf-datepicker-day:not(.disabled)").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=parseInt(r.dataset.day),n=parseInt(r.dataset.month),i=parseInt(r.dataset.year);ps(new Date(i,n,a))})}),Ut.querySelectorAll(".pf-datepicker-btn").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=r.dataset.action;a==="today"?ps(new Date):a==="clear"&&ps(null)})}))}function dd(e){if(!pr)return;let r=pr.viewDate;switch(e){case"prev-year":r.setFullYear(r.getFullYear()-1);break;case"prev-month":r.setMonth(r.getMonth()-1);break;case"next-month":r.setMonth(r.getMonth()+1);break;case"next-year":r.setFullYear(r.getFullYear()+1);break}vc()}function ps(e){if(!pr)return;let{input:r,onChange:t}=pr;pr.selectedDate=e,e?(r.value=ms(e),r.dataset.value=un(e),pr.viewDate=new Date(e)):(r.value="",r.dataset.value=""),t&&t(e?un(e):""),r.dispatchEvent(new Event("change",{bubbles:!0})),oi()}function hd(e,r,t,a,n){let i=new Date(e,r,1).getDay(),s=new Date(e,r+1,0).getDate(),o=new Date(e,r,0).getDate(),c=new Date;c.setHours(0,0,0,0),t&&(t=new Date(t),t.setHours(0,0,0,0));let l="";for(let h=i-1;h>=0;h--){let m=o-h,p=r===0?11:r-1,g=r===0?e-1:e;l+=`<button type="button" class="pf-datepicker-day other-month" data-day="${m}" data-month="${p}" data-year="${g}">${m}</button>`}for(let h=1;h<=s;h++){let m=new Date(e,r,h);m.setHours(0,0,0,0);let p=m.getTime()===c.getTime(),g=t&&m.getTime()===t.getTime(),v="pf-datepicker-day";p&&(v+=" today"),g&&(v+=" selected");let y=!1;a&&m<a&&(y=!0),n&&m>n&&(y=!0),y&&(v+=" disabled"),l+=`<button type="button" class="${v}" data-day="${h}" data-month="${r}" data-year="${e}" ${y?"disabled":""}>${h}</button>`}let f=42,d=i+s,u=f-d;for(let h=1;h<=u;h++){let m=r===11?0:r+1,p=r===11?e+1:e;l+=`<button type="button" class="pf-datepicker-day other-month" data-day="${h}" data-month="${m}" data-year="${p}">${h}</button>`}return l}function pc(e){if(!e)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[a,n,i]=e.split("-").map(Number);return new Date(a,n-1,i)}let r=e.match(/^(\w+)\s+(\d+),\s+(\d{4})$/);if(r){let a=mc.findIndex(n=>n.toLowerCase()===r[1].toLowerCase().substring(0,3));if(a>=0)return new Date(parseInt(r[3]),a,parseInt(r[2]))}if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e)){let[a,n,i]=e.split("/").map(Number);return new Date(i,a-1,n)}let t=new Date(e);return isNaN(t.getTime())?null:t}function ms(e){return e?`${mc[e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`:""}function un(e){if(!e)return"";let r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`}var bn={};bn.version="0.18.5";var Tr=1200,Wa=1252,pd=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Hs={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Vs=function(e){pd.indexOf(e)!=-1&&(Wa=Hs[0]=e)};function md(){Vs(1252)}var gr=function(e){Tr=e,Vs(e)};function Ws(){gr(1200),md()}function Fs(e){for(var r=[],t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function gd(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Cl(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var pn=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?gd(e.slice(2)):r==254&&t==255?Cl(e.slice(2)):r==65279?e.slice(1):e},ci=function(r){return String.fromCharCode(r)},yc=function(r){return String.fromCharCode(r)},Ue;var at=null,dn=!0,Kr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tn(e){for(var r="",t=0,a=0,n=0,i=0,s=0,o=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),i=t>>2,a=e.charCodeAt(l++),s=(t&3)<<4|a>>4,n=e.charCodeAt(l++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),r+=Kr.charAt(i)+Kr.charAt(s)+Kr.charAt(o)+Kr.charAt(c);return r}function Qt(e){var r="",t=0,a=0,n=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=Kr.indexOf(e.charAt(l++)),s=Kr.indexOf(e.charAt(l++)),t=i<<2|s>>4,r+=String.fromCharCode(t),o=Kr.indexOf(e.charAt(l++)),a=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(a)),c=Kr.indexOf(e.charAt(l++)),n=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(n));return r}var Ae=(function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node})(),Ur=(function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Zr(e){return Ae?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function wc(e){return Ae?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var Jt=function(r){return Ae?Ur(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Pi(e){if(typeof ArrayBuffer=="undefined")return Jt(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),a=0;a!=e.length;++a)t[a]=e.charCodeAt(a)&255;return r}function ra(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function xd(e){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(e)}function Gs(e){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Gs(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Et=Ae?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Ur(r)}))}:function(e){if(typeof Uint8Array!="undefined"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var a=new Uint8Array(t),n=0;for(r=0,t=0;r<e.length;t+=n,++r)if(n=e[r].length,e[r]instanceof Uint8Array)a.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";a.set(new Uint8Array(e[r]),t)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function vd(e){for(var r=[],t=0,a=e.length+250,n=Zr(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)n[t++]=s;else if(s<2048)n[t++]=192|s>>6&31,n[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;n[t++]=240|s>>8&7,n[t++]=128|s>>2&63,n[t++]=128|o>>6&15|(s&3)<<4,n[t++]=128|o&63}else n[t++]=224|s>>12&15,n[t++]=128|s>>6&63,n[t++]=128|s&63;t>a&&(r.push(n.slice(0,t)),t=0,n=Zr(65535),a=65530)}return r.push(n.slice(0,t)),Et(r)}var Nt=/\u0000/g,mn=/[\u0001-\u0006]/g;function Ua(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function xr(e,r){var t=""+e;return t.length>=r?t:tt("0",r-t.length)+t}function zs(e,r){var t=""+e;return t.length>=r?t:tt(" ",r-t.length)+t}function yi(e,r){var t=""+e;return t.length>=r?t:t+tt(" ",r-t.length)}function yd(e,r){var t=""+Math.round(e);return t.length>=r?t:tt("0",r-t.length)+t}function wd(e,r){var t=""+e;return t.length>=r?t:tt("0",r-t.length)+t}var _c=Math.pow(2,32);function Da(e,r){if(e>_c||e<-_c)return yd(e,r);var t=Math.round(e);return wd(t,r)}function wi(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var kc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gs=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _d(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Ec={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kd={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _i(e,r,t){for(var a=e<0?-1:1,n=e*a,i=0,s=1,o=0,c=1,l=0,f=0,d=Math.floor(n);l<r&&(d=Math.floor(n),o=d*s+i,f=d*l+c,!(n-d<5e-8));)n=1/(n-d),i=s,s=o,c=l,l=f;if(f>r&&(l>r?(f=c,o=i):(f=l,o=s)),!t)return[0,a*o,f];var u=Math.floor(a*o/f);return[u,a*o-u*f,f]}function da(e,r,t){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,s=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)s=t?[1317,10,29]:[1900,2,29],i=3;else if(a===0)s=t?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),t&&(i=Ad(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var Al=new Date(1899,11,31,0,0,0),Ed=Al.getTime(),Sd=new Date(1900,2,1,0,0,0);function Ol(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=Sd&&(t+=1440*60*1e3),(t-(Ed+(e.getTimezoneOffset()-Al.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Xs(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function bd(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Td(e){var r=e<0?12:11,t=Xs(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Cd(e){var r=Xs(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Cn(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Td(e):r===10?t=e.toFixed(10).substr(0,12):t=Cd(e),Xs(bd(t.toUpperCase()))}function xa(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Cn(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return lr(14,Ol(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Ad(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Od(e,r,t,a){var n="",i=0,s=0,o=t.y,c,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,l=r.length;break;case 3:return gs[t.m-1][1];case 5:return gs[t.m-1][0];default:return gs[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,l=r.length;break;case 3:return kc[t.q][0];default:return kc[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?xr(t.S,r.length):(a>=2?s=a===3?1e3:100:s=a===1?10:1,i=Math.round(s*(t.S+t.u)),i>=60*s&&(i=0),r==="s"?i===0?"0":""+i/s:(n=xr(i,2+a),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?xr(c,l):"";return f}function Jr(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,a=e.substr(0,t);t!=e.length;t+=r)a+=(a.length>0?",":"")+e.substr(t,r);return a}var Fl=/%/g;function Fd(e,r,t){var a=r.replace(Fl,""),n=r.length-a.length;return Lr(e,a,t*Math.pow(10,2*n))+tt("%",n)}function Id(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Lr(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Il(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Il(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Pl=/# (\?+)( ?)\/( ?)(\d+)/;function Pd(e,r,t){var a=parseInt(e[4],10),n=Math.round(r*a),i=Math.floor(n/a),s=n-i*a,o=a;return t+(i===0?"":""+i)+" "+(s===0?tt(" ",e[1].length+1+e[4].length):zs(s,e[1].length)+e[2]+"/"+e[3]+xr(o,e[4].length))}function Rd(e,r,t){return t+(r===0?"":""+r)+tt(" ",e[1].length+2+e[4].length)}var Rl=/^#*0*\.([0#]+)/,Dl=/\).*[0#]/,Nl=/\(###\) ###\\?-####/;function jt(e){for(var r="",t,a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Sc(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function bc(e,r){var t=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(t*a)).length?0:Math.round(t*a)}function Dd(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Nd(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ar(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Dl)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ar("n",a,t):"("+ar("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Id(e,r,t);if(r.indexOf("%")!==-1)return Fd(e,r,t);if(r.indexOf("E")!==-1)return Il(r,t);if(r.charCodeAt(0)===36)return"$"+ar(e,r.substr(r.charAt(1)==" "?2:1),t);var n,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+Da(c,r.length);if(r.match(/^[#?]+$/))return n=Da(t,0),n==="0"&&(n=""),n.length>r.length?n:jt(r.substr(0,r.length-n.length))+n;if(i=r.match(Pl))return Pd(i,c,l);if(r.match(/^#+0+$/))return l+Da(c,r.length-r.indexOf("0"));if(i=r.match(Rl))return n=Sc(t,i[1].length).replace(/^([^\.]+)$/,"$1."+jt(i[1])).replace(/\.$/,"."+jt(i[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+tt("0",jt(i[1]).length-p.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+Sc(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+Jr(Da(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ar(e,r,-t):Jr(""+(Math.floor(t)+Dd(t,i[1].length)))+"."+xr(bc(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return ar(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ua(ar(e,r.replace(/[\\-]/g,""),t)),s=0,Ua(Ua(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<n.length?n.charAt(s++):m==="0"?"0":""}));if(r.match(Nl))return n=ar(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=_i(c,Math.pow(10,s)-1,!1),n=""+l,f=Lr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=yi(o[2],s),f.length<i[4].length&&(f=jt(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=_i(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zs(o[1],s)+i[2]+"/"+i[3]+yi(o[2],s):tt(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=Da(t,0),r.length<=n.length?n:jt(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var d=r.indexOf(".")-s,u=r.length-n.length-d;return jt(r.substr(0,d)+n+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return s=bc(t,i[1].length),t<0?"-"+ar(e,r,-t):Jr(Nd(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?xr(0,3-m.length):"")+m})+"."+xr(s,i[1].length);switch(r){case"###,##0.00":return ar(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Jr(Da(c,0));return h!=="0"?l+h:"";case"###,###.00":return ar(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ar(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function Ld(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Lr(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Bd(e,r,t){var a=r.replace(Fl,""),n=r.length-a.length;return Lr(e,a,t*Math.pow(10,2*n))+tt("%",n)}function Ll(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ll(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Er(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Dl)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Er("n",a,t):"("+Er("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Ld(e,r,t);if(r.indexOf("%")!==-1)return Bd(e,r,t);if(r.indexOf("E")!==-1)return Ll(r,t);if(r.charCodeAt(0)===36)return"$"+Er(e,r.substr(r.charAt(1)==" "?2:1),t);var n,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+xr(c,r.length);if(r.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>r.length?n:jt(r.substr(0,r.length-n.length))+n;if(i=r.match(Pl))return Rd(i,c,l);if(r.match(/^#+0+$/))return l+xr(c,r.length-r.indexOf("0"));if(i=r.match(Rl))return n=(""+t).replace(/^([^\.]+)$/,"$1."+jt(i[1])).replace(/\.$/,"."+jt(i[1])),n=n.replace(/\.(\d*)$/,function(m,p){return"."+p+tt("0",jt(i[1]).length-p.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+Jr(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Er(e,r,-t):Jr(""+t)+"."+tt("0",i[1].length);if(i=r.match(/^#,#*,#0/))return Er(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ua(Er(e,r.replace(/[\\-]/g,""),t)),s=0,Ua(Ua(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<n.length?n.charAt(s++):m==="0"?"0":""}));if(r.match(Nl))return n=Er(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=_i(c,Math.pow(10,s)-1,!1),n=""+l,f=Lr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=yi(o[2],s),f.length<i[4].length&&(f=jt(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=_i(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zs(o[1],s)+i[2]+"/"+i[3]+yi(o[2],s):tt(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=""+t,r.length<=n.length?n:jt(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var d=r.indexOf(".")-s,u=r.length-n.length-d;return jt(r.substr(0,d)+n+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Er(e,r,-t):Jr(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?xr(0,3-m.length):"")+m})+"."+xr(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Jr(""+c);return h!=="0"?l+h:"";default:if(r.match(/\.[0#?]*$/))return Er(e,r.slice(0,r.lastIndexOf(".")),t)+jt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Lr(e,r,t){return(t|0)===t?Er(e,r,t):ar(e,r,t)}function Md(e){for(var r=[],t=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n),n=a+1}if(r[r.length]=e.substr(n),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Bl=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ya(e){for(var r=0,t="",a="";r<e.length;)switch(t=e.charAt(r)){case"G":wi(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(a=t;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match(Bl))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function $d(e,r,t,a){for(var n=[],i="",s=0,o="",c="t",l,f,d,u="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!wi(e,s))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(d=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(d);n[n.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),m=h==="("||h===")"?h:"t";n[n.length]={t:m,v:h},++s;break;case"_":n[n.length]={t:"t",v:" "},s+=2;break;case"@":n[n.length]={t:"T",v:r},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(l==null&&(l=da(r,t,e.charAt(s+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=da(r,t),l==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"\u4E0A":var p={t:o,v:o};if(l==null&&(l=da(r,t)),e.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",u="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",s+=5,u="h"):e.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(p.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),p.t="T",s+=5,u="h"):(p.t="t",++s),l==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Bl)){if(l==null&&(l=da(r,t),l==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ya(e)||(n[n.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++s;break;case"$":n[n.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++s;break}var g=0,v=0,y;for(s=n.length-1,c="t";s>=0;--s)switch(n[s].t){case"h":case"H":n[s].t=u,c="h",g<1&&(g=1);break;case"s":(y=n[s].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[s].t;break;case"m":c==="s"&&(n[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[s].v.match(/[Hh]/)&&(g=1),g<2&&n[s].v.match(/[Mm]/)&&(g=2),g<3&&n[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var x="",F;for(s=0;s<n.length;++s)switch(n[s].t){case"t":case"T":case" ":case"D":break;case"X":n[s].v="",n[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[s].v=Od(n[s].t.charCodeAt(0),n[s].v,l,v),n[s].t="t";break;case"n":case"?":for(F=s+1;n[F]!=null&&((o=n[F].t)==="?"||o==="D"||(o===" "||o==="t")&&n[F+1]!=null&&(n[F+1].t==="?"||n[F+1].t==="t"&&n[F+1].v==="/")||n[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[F].v==="/"||n[F].v===" "&&n[F+1]!=null&&n[F+1].t=="?"));)n[s].v+=n[F].v,n[F]={v:"",t:";"},++F;x+=n[s].v,s=F-1;break;case"G":n[s].t="t",n[s].v=xa(r,t);break}var I="",A,k;if(x.length>0){x.charCodeAt(0)==40?(A=r<0&&x.charCodeAt(0)===45?-r:r,k=Lr("n",x,A)):(A=r<0&&a>1?-r:r,k=Lr("n",x,A),A<0&&n[0]&&n[0].t=="t"&&(k=k.substr(1),n[0].v="-"+n[0].v)),F=k.length-1;var N=n.length;for(s=0;s<n.length;++s)if(n[s]!=null&&n[s].t!="t"&&n[s].v.indexOf(".")>-1){N=s;break}var D=n.length;if(N===n.length&&k.indexOf("E")===-1){for(s=n.length-1;s>=0;--s)n[s]==null||"n?".indexOf(n[s].t)===-1||(F>=n[s].v.length-1?(F-=n[s].v.length,n[s].v=k.substr(F+1,n[s].v.length)):F<0?n[s].v="":(n[s].v=k.substr(0,F+1),F=-1),n[s].t="t",D=s);F>=0&&D<n.length&&(n[D].v=k.substr(0,F+1)+n[D].v)}else if(N!==n.length&&k.indexOf("E")===-1){for(F=k.indexOf(".")-1,s=N;s>=0;--s)if(!(n[s]==null||"n?".indexOf(n[s].t)===-1)){for(f=n[s].v.indexOf(".")>-1&&s===N?n[s].v.indexOf(".")-1:n[s].v.length-1,I=n[s].v.substr(f+1);f>=0;--f)F>=0&&(n[s].v.charAt(f)==="0"||n[s].v.charAt(f)==="#")&&(I=k.charAt(F--)+I);n[s].v=I,n[s].t="t",D=s}for(F>=0&&D<n.length&&(n[D].v=k.substr(0,F+1)+n[D].v),F=k.indexOf(".")+1,s=N;s<n.length;++s)if(!(n[s]==null||"n?(".indexOf(n[s].t)===-1&&s!==N)){for(f=n[s].v.indexOf(".")>-1&&s===N?n[s].v.indexOf(".")+1:0,I=n[s].v.substr(0,f);f<n[s].v.length;++f)F<k.length&&(I+=k.charAt(F++));n[s].v=I,n[s].t="t",D=s}}}for(s=0;s<n.length;++s)n[s]!=null&&"n?".indexOf(n[s].t)>-1&&(A=a>1&&r<0&&s>0&&n[s-1].v==="-"?-r:r,n[s].v=Lr(n[s].t,n[s].v,A),n[s].t="t");var M="";for(s=0;s!==n.length;++s)n[s]!=null&&(M+=n[s].v);return M}var Tc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Cc(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Ud(e,r){var t=Md(e),a=t.length,n=t[a-1].indexOf("@");if(a<4&&n>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(Tc),o=t[1].match(Tc);return Cc(r,s)?[a,t[0]]:Cc(r,o)?[a,t[1]]:[a,t[s!=null&&o!=null?2:1]]}return[a,i]}function lr(e,r,t){t==null&&(t={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?a=t.dateNF:a=e;break;case"number":e==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:ge)[e],a==null&&(a=t.table&&t.table[Ec[e]]||ge[Ec[e]]),a==null&&(a=kd[e]||"General");break}if(wi(a,0))return xa(r,t);r instanceof Date&&(r=Ol(r,t.date1904));var n=Ud(a,r);if(wi(n[1]))return xa(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return $d(n[1],r,t,n[0])}function Br(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(ge[t]==null){r<0&&(r=t);continue}if(ge[t]==e){r=t;break}}r<0&&(r=391)}return ge[r]=e,r}function Ri(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Br(e[r],r)}function qa(){ge=_d()}var jd={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ml=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Hd(e){var r=typeof e=="number"?ge[e]:e;return r=r.replace(Ml,"(\\d+)"),new RegExp("^"+r+"$")}function Vd(e,r,t){var a=-1,n=-1,i=-1,s=-1,o=-1,c=-1;(r.match(Ml)||[]).forEach(function(d,u){var h=parseInt(t[u+1],10);switch(d.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?o=h:n=h;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?l:a==-1&&n==-1&&i==-1?f:l+"T"+f}var Wd=(function(){var e={};e.version="1.2.0";function r(){for(var k=0,N=new Array(256),D=0;D!=256;++D)k=D,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,N[D]=k;return typeof Int32Array!="undefined"?new Int32Array(N):N}var t=r();function a(k){var N=0,D=0,M=0,W=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)W[M]=k[M];for(M=0;M!=256;++M)for(D=k[M],N=256+M;N<4096;N+=256)D=W[N]=D>>>8^k[D&255];var L=[];for(M=1;M!=16;++M)L[M-1]=typeof Int32Array!="undefined"?W.subarray(M*256,M*256+256):W.slice(M*256,M*256+256);return L}var n=a(t),i=n[0],s=n[1],o=n[2],c=n[3],l=n[4],f=n[5],d=n[6],u=n[7],h=n[8],m=n[9],p=n[10],g=n[11],v=n[12],y=n[13],x=n[14];function F(k,N){for(var D=N^-1,M=0,W=k.length;M<W;)D=D>>>8^t[(D^k.charCodeAt(M++))&255];return~D}function I(k,N){for(var D=N^-1,M=k.length-15,W=0;W<M;)D=x[k[W++]^D&255]^y[k[W++]^D>>8&255]^v[k[W++]^D>>16&255]^g[k[W++]^D>>>24]^p[k[W++]]^m[k[W++]]^h[k[W++]]^u[k[W++]]^d[k[W++]]^f[k[W++]]^l[k[W++]]^c[k[W++]]^o[k[W++]]^s[k[W++]]^i[k[W++]]^t[k[W++]];for(M+=15;W<M;)D=D>>>8^t[(D^k[W++])&255];return~D}function A(k,N){for(var D=N^-1,M=0,W=k.length,L=0,ee=0;M<W;)L=k.charCodeAt(M++),L<128?D=D>>>8^t[(D^L)&255]:L<2048?(D=D>>>8^t[(D^(192|L>>6&31))&255],D=D>>>8^t[(D^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,ee=k.charCodeAt(M++)&1023,D=D>>>8^t[(D^(240|L>>8&7))&255],D=D>>>8^t[(D^(128|L>>2&63))&255],D=D>>>8^t[(D^(128|ee>>6&15|(L&3)<<4))&255],D=D>>>8^t[(D^(128|ee&63))&255]):(D=D>>>8^t[(D^(224|L>>12&15))&255],D=D>>>8^t[(D^(128|L>>6&63))&255],D=D>>>8^t[(D^(128|L&63))&255]);return~D}return e.table=t,e.bstr=F,e.buf=I,e.str=A,e})(),me=(function(){var r={};r.version="1.2.1";function t(w,S){for(var _=w.split("/"),E=S.split("/"),b=0,T=0,U=Math.min(_.length,E.length);b<U;++b){if(T=_[b].length-E[b].length)return T;if(_[b]!=E[b])return _[b]<E[b]?-1:1}return _.length-E.length}function a(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:a(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(0,S+1)}function n(w){if(w.charAt(w.length-1)=="/")return n(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(S+1)}function i(w,S){typeof S=="string"&&(S=new Date(S));var _=S.getHours();_=_<<6|S.getMinutes(),_=_<<5|S.getSeconds()>>>1,w.write_shift(2,_);var E=S.getFullYear()-1980;E=E<<4|S.getMonth()+1,E=E<<5|S.getDate(),w.write_shift(2,E)}function s(w){var S=w.read_shift(2)&65535,_=w.read_shift(2)&65535,E=new Date,b=_&31;_>>>=5;var T=_&15;_>>>=4,E.setMilliseconds(0),E.setFullYear(_+1980),E.setMonth(T-1),E.setDate(b);var U=S&31;S>>>=5;var Y=S&63;return S>>>=6,E.setHours(S),E.setMinutes(Y),E.setSeconds(U<<1),E}function o(w){Tt(w,0);for(var S={},_=0;w.l<=w.length-4;){var E=w.read_shift(2),b=w.read_shift(2),T=w.l+b,U={};switch(E){case 21589:_=w.read_shift(1),_&1&&(U.mtime=w.read_shift(4)),b>5&&(_&2&&(U.atime=w.read_shift(4)),_&4&&(U.ctime=w.read_shift(4))),U.mtime&&(U.mt=new Date(U.mtime*1e3));break}w.l=T,S[E]=U}return S}var c;function l(){return c||(c={})}function f(w,S){if(w[0]==80&&w[1]==75)return rc(w,S);if((w[0]|32)==109&&(w[1]|32)==105)return Du(w,S);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var _=3,E=512,b=0,T=0,U=0,Y=0,H=0,j=[],V=w.slice(0,512);Tt(V,0);var Q=d(V);switch(_=Q[0],_){case 3:E=512;break;case 4:E=4096;break;case 0:if(Q[1]==0)return rc(w,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+_)}E!==512&&(V=w.slice(0,E),Tt(V,28));var ce=w.slice(0,E);u(V,_);var pe=V.read_shift(4,"i");if(_===3&&pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pe);V.l+=4,U=V.read_shift(4,"i"),V.l+=4,V.chk("00100000","Mini Stream Cutoff Size: "),Y=V.read_shift(4,"i"),b=V.read_shift(4,"i"),H=V.read_shift(4,"i"),T=V.read_shift(4,"i");for(var le=-1,ue=0;ue<109&&(le=V.read_shift(4,"i"),!(le<0));++ue)j[ue]=le;var _e=h(w,E);g(H,T,_e,E,j);var Ye=y(_e,U,j,E);Ye[U].name="!Directory",b>0&&Y!==ee&&(Ye[Y].name="!MiniFAT"),Ye[j[0]].name="!FAT",Ye.fat_addrs=j,Ye.ssz=E;var Wt={},dt=[],qt=[],cn=[];x(U,Ye,_e,dt,b,Wt,qt,Y),m(qt,cn,dt),dt.shift();var ln={FileIndex:qt,FullPaths:cn};return S&&S.raw&&(ln.raw={header:ce,sectors:_e}),ln}function d(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(de,"Header Signature: "),w.l+=16;var S=w.read_shift(2,"u");return[w.read_shift(2,"u"),S]}function u(w,S){var _=9;switch(w.l+=2,_=w.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+_);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+_);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+_)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function h(w,S){for(var _=Math.ceil(w.length/S)-1,E=[],b=1;b<_;++b)E[b-1]=w.slice(b*S,(b+1)*S);return E[_-1]=w.slice(_*S),E}function m(w,S,_){for(var E=0,b=0,T=0,U=0,Y=0,H=_.length,j=[],V=[];E<H;++E)j[E]=V[E]=E,S[E]=_[E];for(;Y<V.length;++Y)E=V[Y],b=w[E].L,T=w[E].R,U=w[E].C,j[E]===E&&(b!==-1&&j[b]!==b&&(j[E]=j[b]),T!==-1&&j[T]!==T&&(j[E]=j[T])),U!==-1&&(j[U]=E),b!==-1&&E!=j[E]&&(j[b]=j[E],V.lastIndexOf(b)<Y&&V.push(b)),T!==-1&&E!=j[E]&&(j[T]=j[E],V.lastIndexOf(T)<Y&&V.push(T));for(E=1;E<H;++E)j[E]===E&&(T!==-1&&j[T]!==T?j[E]=j[T]:b!==-1&&j[b]!==b&&(j[E]=j[b]));for(E=1;E<H;++E)if(w[E].type!==0){if(Y=E,Y!=j[Y])do Y=j[Y],S[E]=S[Y]+"/"+S[E];while(Y!==0&&j[Y]!==-1&&Y!=j[Y]);j[E]=-1}for(S[0]+="/",E=1;E<H;++E)w[E].type!==2&&(S[E]+="/")}function p(w,S,_){for(var E=w.start,b=w.size,T=[],U=E;_&&b>0&&U>=0;)T.push(S.slice(U*L,U*L+L)),b-=L,U=ua(_,U*4);return T.length===0?X(0):Et(T).slice(0,w.size)}function g(w,S,_,E,b){var T=ee;if(w===ee){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var U=_[w],Y=(E>>>2)-1;if(!U)return;for(var H=0;H<Y&&(T=ua(U,H*4))!==ee;++H)b.push(T);g(ua(U,E-4),S-1,_,E,b)}}function v(w,S,_,E,b){var T=[],U=[];b||(b=[]);var Y=E-1,H=0,j=0;for(H=S;H>=0;){b[H]=!0,T[T.length]=H,U.push(w[H]);var V=_[Math.floor(H*4/E)];if(j=H*4&Y,E<4+j)throw new Error("FAT boundary crossed: "+H+" 4 "+E);if(!w[V])break;H=ua(w[V],j)}return{nodes:T,data:$c([U])}}function y(w,S,_,E){var b=w.length,T=[],U=[],Y=[],H=[],j=E-1,V=0,Q=0,ce=0,pe=0;for(V=0;V<b;++V)if(Y=[],ce=V+S,ce>=b&&(ce-=b),!U[ce]){H=[];var le=[];for(Q=ce;Q>=0;){le[Q]=!0,U[Q]=!0,Y[Y.length]=Q,H.push(w[Q]);var ue=_[Math.floor(Q*4/E)];if(pe=Q*4&j,E<4+pe)throw new Error("FAT boundary crossed: "+Q+" 4 "+E);if(!w[ue]||(Q=ua(w[ue],pe),le[Q]))break}T[ce]={nodes:Y,data:$c([H])}}return T}function x(w,S,_,E,b,T,U,Y){for(var H=0,j=E.length?2:0,V=S[w].data,Q=0,ce=0,pe;Q<V.length;Q+=128){var le=V.slice(Q,Q+128);Tt(le,64),ce=le.read_shift(2),pe=Bi(le,0,ce-j),E.push(pe);var ue={name:pe,type:le.read_shift(1),color:le.read_shift(1),L:le.read_shift(4,"i"),R:le.read_shift(4,"i"),C:le.read_shift(4,"i"),clsid:le.read_shift(16),state:le.read_shift(4,"i"),start:0,size:0},_e=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);_e!==0&&(ue.ct=F(le,le.l-8));var Ye=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);Ye!==0&&(ue.mt=F(le,le.l-8)),ue.start=le.read_shift(4,"i"),ue.size=le.read_shift(4,"i"),ue.size<0&&ue.start<0&&(ue.size=ue.type=0,ue.start=ee,ue.name=""),ue.type===5?(H=ue.start,b>0&&H!==ee&&(S[H].name="!StreamData")):ue.size>=4096?(ue.storage="fat",S[ue.start]===void 0&&(S[ue.start]=v(_,ue.start,S.fat_addrs,S.ssz)),S[ue.start].name=ue.name,ue.content=S[ue.start].data.slice(0,ue.size)):(ue.storage="minifat",ue.size<0?ue.size=0:H!==ee&&ue.start!==ee&&S[H]&&(ue.content=p(ue,S[H].data,(S[Y]||{}).data))),ue.content&&Tt(ue.content,0),T[pe]=ue,U.push(ue)}}function F(w,S){return new Date((kt(w,S+4)/1e7*Math.pow(2,32)+kt(w,S)/1e7-11644473600)*1e3)}function I(w,S){return l(),f(c.readFileSync(w),S)}function A(w,S){var _=S&&S.type;switch(_||Ae&&Buffer.isBuffer(w)&&(_="buffer"),_||"base64"){case"file":return I(w,S);case"base64":return f(Jt(Qt(w)),S);case"binary":return f(Jt(w),S)}return f(w,S)}function k(w,S){var _=S||{},E=_.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=E+"/",w.FileIndex[0]={name:E,type:5}),_.CLSID&&(w.FileIndex[0].clsid=_.CLSID),N(w)}function N(w){var S="Sh33tJ5";if(!me.find(w,"/"+S)){var _=X(4);_[0]=55,_[1]=_[3]=50,_[2]=54,w.FileIndex.push({name:S,type:2,content:_,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+S),D(w)}}function D(w,S){k(w);for(var _=!1,E=!1,b=w.FullPaths.length-1;b>=0;--b){var T=w.FileIndex[b];switch(T.type){case 0:E?_=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(T.R*T.L*T.C)&&(_=!0),T.R>-1&&T.L>-1&&T.R==T.L&&(_=!0);break;default:_=!0;break}}if(!(!_&&!S)){var U=new Date(1987,1,19),Y=0,H=Object.create?Object.create(null):{},j=[];for(b=0;b<w.FullPaths.length;++b)H[w.FullPaths[b]]=!0,w.FileIndex[b].type!==0&&j.push([w.FullPaths[b],w.FileIndex[b]]);for(b=0;b<j.length;++b){var V=a(j[b][0]);E=H[V],E||(j.push([V,{name:n(V).replace("/",""),type:1,clsid:te,ct:U,mt:U,content:null}]),H[V]=!0)}for(j.sort(function(pe,le){return t(pe[0],le[0])}),w.FullPaths=[],w.FileIndex=[],b=0;b<j.length;++b)w.FullPaths[b]=j[b][0],w.FileIndex[b]=j[b][1];for(b=0;b<j.length;++b){var Q=w.FileIndex[b],ce=w.FullPaths[b];if(Q.name=n(ce).replace("/",""),Q.L=Q.R=Q.C=-(Q.color=1),Q.size=Q.content?Q.content.length:0,Q.start=0,Q.clsid=Q.clsid||te,b===0)Q.C=j.length>1?1:-1,Q.size=0,Q.type=5;else if(ce.slice(-1)=="/"){for(Y=b+1;Y<j.length&&a(w.FullPaths[Y])!=ce;++Y);for(Q.C=Y>=j.length?-1:Y,Y=b+1;Y<j.length&&a(w.FullPaths[Y])!=a(ce);++Y);Q.R=Y>=j.length?-1:Y,Q.type=1}else a(w.FullPaths[b+1]||"")==a(ce)&&(Q.R=b+1),Q.type=2}}}function M(w,S){var _=S||{};if(_.fileType=="mad")return Nu(w,_);switch(D(w),_.fileType){case"zip":return Au(w,_)}var E=(function(pe){for(var le=0,ue=0,_e=0;_e<pe.FileIndex.length;++_e){var Ye=pe.FileIndex[_e];if(Ye.content){var Wt=Ye.content.length;Wt>0&&(Wt<4096?le+=Wt+63>>6:ue+=Wt+511>>9)}}for(var dt=pe.FullPaths.length+3>>2,qt=le+7>>3,cn=le+127>>7,ln=qt+ue+dt+cn,fa=ln+127>>7,as=fa<=109?0:Math.ceil((fa-109)/127);ln+fa+as+127>>7>fa;)as=++fa<=109?0:Math.ceil((fa-109)/127);var Dr=[1,as,fa,cn,dt,ue,le,0];return pe.FileIndex[0].size=le<<6,Dr[7]=(pe.FileIndex[0].start=Dr[0]+Dr[1]+Dr[2]+Dr[3]+Dr[4]+Dr[5])+(Dr[6]+7>>3),Dr})(w),b=X(E[7]<<9),T=0,U=0;{for(T=0;T<8;++T)b.write_shift(1,J[T]);for(T=0;T<8;++T)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),T=0;T<3;++T)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,E[2]),b.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:ee),b.write_shift(4,E[3]),b.write_shift(-4,E[1]?E[0]-1:ee),b.write_shift(4,E[1]),T=0;T<109;++T)b.write_shift(-4,T<E[2]?E[1]+T:-1)}if(E[1])for(U=0;U<E[1];++U){for(;T<236+U*127;++T)b.write_shift(-4,T<E[2]?E[1]+T:-1);b.write_shift(-4,U===E[1]-1?ee:U+1)}var Y=function(pe){for(U+=pe;T<U-1;++T)b.write_shift(-4,T+1);pe&&(++T,b.write_shift(-4,ee))};for(U=T=0,U+=E[1];T<U;++T)b.write_shift(-4,ie.DIFSECT);for(U+=E[2];T<U;++T)b.write_shift(-4,ie.FATSECT);Y(E[3]),Y(E[4]);for(var H=0,j=0,V=w.FileIndex[0];H<w.FileIndex.length;++H)V=w.FileIndex[H],V.content&&(j=V.content.length,!(j<4096)&&(V.start=U,Y(j+511>>9)));for(Y(E[6]+7>>3);b.l&511;)b.write_shift(-4,ie.ENDOFCHAIN);for(U=T=0,H=0;H<w.FileIndex.length;++H)V=w.FileIndex[H],V.content&&(j=V.content.length,!(!j||j>=4096)&&(V.start=U,Y(j+63>>6)));for(;b.l&511;)b.write_shift(-4,ie.ENDOFCHAIN);for(T=0;T<E[4]<<2;++T){var Q=w.FullPaths[T];if(!Q||Q.length===0){for(H=0;H<17;++H)b.write_shift(4,0);for(H=0;H<3;++H)b.write_shift(4,-1);for(H=0;H<12;++H)b.write_shift(4,0);continue}V=w.FileIndex[T],T===0&&(V.start=V.size?V.start-1:ee);var ce=T===0&&_.root||V.name;if(j=2*(ce.length+1),b.write_shift(64,ce,"utf16le"),b.write_shift(2,j),b.write_shift(1,V.type),b.write_shift(1,V.color),b.write_shift(-4,V.L),b.write_shift(-4,V.R),b.write_shift(-4,V.C),V.clsid)b.write_shift(16,V.clsid,"hex");else for(H=0;H<4;++H)b.write_shift(4,0);b.write_shift(4,V.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,V.start),b.write_shift(4,V.size),b.write_shift(4,0)}for(T=1;T<w.FileIndex.length;++T)if(V=w.FileIndex[T],V.size>=4096)if(b.l=V.start+1<<9,Ae&&Buffer.isBuffer(V.content))V.content.copy(b,b.l,0,V.size),b.l+=V.size+511&-512;else{for(H=0;H<V.size;++H)b.write_shift(1,V.content[H]);for(;H&511;++H)b.write_shift(1,0)}for(T=1;T<w.FileIndex.length;++T)if(V=w.FileIndex[T],V.size>0&&V.size<4096)if(Ae&&Buffer.isBuffer(V.content))V.content.copy(b,b.l,0,V.size),b.l+=V.size+63&-64;else{for(H=0;H<V.size;++H)b.write_shift(1,V.content[H]);for(;H&63;++H)b.write_shift(1,0)}if(Ae)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function W(w,S){var _=w.FullPaths.map(function(H){return H.toUpperCase()}),E=_.map(function(H){var j=H.split("/");return j[j.length-(H.slice(-1)=="/"?2:1)]}),b=!1;S.charCodeAt(0)===47?(b=!0,S=_[0].slice(0,-1)+S):b=S.indexOf("/")!==-1;var T=S.toUpperCase(),U=b===!0?_.indexOf(T):E.indexOf(T);if(U!==-1)return w.FileIndex[U];var Y=!T.match(mn);for(T=T.replace(Nt,""),Y&&(T=T.replace(mn,"!")),U=0;U<_.length;++U)if((Y?_[U].replace(mn,"!"):_[U]).replace(Nt,"")==T||(Y?E[U].replace(mn,"!"):E[U]).replace(Nt,"")==T)return w.FileIndex[U];return null}var L=64,ee=-2,de="d0cf11e0a1b11ae1",J=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ye(w,S,_){l();var E=M(w,_);c.writeFileSync(S,E)}function re(w){for(var S=new Array(w.length),_=0;_<w.length;++_)S[_]=String.fromCharCode(w[_]);return S.join("")}function Z(w,S){var _=M(w,S);switch(S&&S.type||"buffer"){case"file":return l(),c.writeFileSync(S.filename,_),_;case"binary":return typeof _=="string"?_:re(_);case"base64":return Tn(typeof _=="string"?_:re(_));case"buffer":if(Ae)return Buffer.isBuffer(_)?_:Ur(_);case"array":return typeof _=="string"?Jt(_):_}return _}var G;function C(w){try{var S=w.InflateRaw,_=new S;if(_._processChunk(new Uint8Array([3,0]),_._finishFlushFlag),_.bytesRead)G=w;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function B(w,S){if(!G)return ec(w,S);var _=G.InflateRaw,E=new _,b=E._processChunk(w.slice(w.l),E._finishFlushFlag);return w.l+=E.bytesRead,b}function R(w){return G?G.deflateRawSync(w):Oe(w)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(w){var S=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(S>>16|S>>8|S)&255}for(var ne=typeof Uint8Array!="undefined",q=ne?new Uint8Array(256):[],ke=0;ke<256;++ke)q[ke]=ae(ke);function O(w,S){var _=q[w&255];return S<=8?_>>>8-S:(_=_<<8|q[w>>8&255],S<=16?_>>>16-S:(_=_<<8|q[w>>16&255],_>>>24-S))}function je(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=6?0:w[E+1]<<8))>>>_&3}function Fe(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=5?0:w[E+1]<<8))>>>_&7}function He(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=4?0:w[E+1]<<8))>>>_&15}function Ie(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=3?0:w[E+1]<<8))>>>_&31}function he(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=1?0:w[E+1]<<8))>>>_&127}function st(w,S,_){var E=S&7,b=S>>>3,T=(1<<_)-1,U=w[b]>>>E;return _<8-E||(U|=w[b+1]<<8-E,_<16-E)||(U|=w[b+2]<<16-E,_<24-E)||(U|=w[b+3]<<24-E),U&T}function er(w,S,_){var E=S&7,b=S>>>3;return E<=5?w[b]|=(_&7)<<E:(w[b]|=_<<E&255,w[b+1]=(_&7)>>8-E),S+3}function wr(w,S,_){var E=S&7,b=S>>>3;return _=(_&1)<<E,w[b]|=_,S+1}function Pr(w,S,_){var E=S&7,b=S>>>3;return _<<=E,w[b]|=_&255,_>>>=8,w[b+1]=_,S+8}function sn(w,S,_){var E=S&7,b=S>>>3;return _<<=E,w[b]|=_&255,_>>>=8,w[b+1]=_&255,w[b+2]=_>>>8,S+16}function zr(w,S){var _=w.length,E=2*_>S?2*_:S+5,b=0;if(_>=S)return w;if(Ae){var T=wc(E);if(w.copy)w.copy(T);else for(;b<w.length;++b)T[b]=w[b];return T}else if(ne){var U=new Uint8Array(E);if(U.set)U.set(w);else for(;b<_;++b)U[b]=w[b];return U}return w.length=E,w}function Yt(w){for(var S=new Array(w),_=0;_<w;++_)S[_]=0;return S}function Rr(w,S,_){var E=1,b=0,T=0,U=0,Y=0,H=w.length,j=ne?new Uint16Array(32):Yt(32);for(T=0;T<32;++T)j[T]=0;for(T=H;T<_;++T)w[T]=0;H=w.length;var V=ne?new Uint16Array(H):Yt(H);for(T=0;T<H;++T)j[b=w[T]]++,E<b&&(E=b),V[T]=0;for(j[0]=0,T=1;T<=E;++T)j[T+16]=Y=Y+j[T-1]<<1;for(T=0;T<H;++T)Y=w[T],Y!=0&&(V[T]=j[Y+16]++);var Q=0;for(T=0;T<H;++T)if(Q=w[T],Q!=0)for(Y=O(V[T],E)>>E-Q,U=(1<<E+4-Q)-1;U>=0;--U)S[Y|U<<Q]=Q&15|T<<4;return E}var Xr=ne?new Uint16Array(512):Yt(512),on=ne?new Uint16Array(32):Yt(32);if(!ne){for(var $t=0;$t<512;++$t)Xr[$t]=0;for($t=0;$t<32;++$t)on[$t]=0}(function(){for(var w=[],S=0;S<32;S++)w.push(5);Rr(w,on,32);var _=[];for(S=0;S<=143;S++)_.push(8);for(;S<=255;S++)_.push(9);for(;S<=279;S++)_.push(7);for(;S<=287;S++)_.push(8);Rr(_,Xr,288)})();var _r=(function(){for(var S=ne?new Uint8Array(32768):[],_=0,E=0;_<fe.length-1;++_)for(;E<fe[_+1];++E)S[E]=_;for(;E<32768;++E)S[E]=29;var b=ne?new Uint8Array(259):[];for(_=0,E=0;_<z.length-1;++_)for(;E<z[_+1];++E)b[E]=_;function T(Y,H){for(var j=0;j<Y.length;){var V=Math.min(65535,Y.length-j),Q=j+V==Y.length;for(H.write_shift(1,+Q),H.write_shift(2,V),H.write_shift(2,~V&65535);V-- >0;)H[H.l++]=Y[j++]}return H.l}function U(Y,H){for(var j=0,V=0,Q=ne?new Uint16Array(32768):[];V<Y.length;){var ce=Math.min(65535,Y.length-V);if(ce<10){for(j=er(H,j,+(V+ce==Y.length)),j&7&&(j+=8-(j&7)),H.l=j/8|0,H.write_shift(2,ce),H.write_shift(2,~ce&65535);ce-- >0;)H[H.l++]=Y[V++];j=H.l*8;continue}j=er(H,j,+(V+ce==Y.length)+2);for(var pe=0;ce-- >0;){var le=Y[V];pe=(pe<<5^le)&32767;var ue=-1,_e=0;if((ue=Q[pe])&&(ue|=V&-32768,ue>V&&(ue-=32768),ue<V))for(;Y[ue+_e]==Y[V+_e]&&_e<250;)++_e;if(_e>2){le=b[_e],le<=22?j=Pr(H,j,q[le+1]>>1)-1:(Pr(H,j,3),j+=5,Pr(H,j,q[le-23]>>5),j+=3);var Ye=le<8?0:le-4>>2;Ye>0&&(sn(H,j,_e-z[le]),j+=Ye),le=S[V-ue],j=Pr(H,j,q[le]>>3),j-=3;var Wt=le<4?0:le-2>>1;Wt>0&&(sn(H,j,V-ue-fe[le]),j+=Wt);for(var dt=0;dt<_e;++dt)Q[pe]=V&32767,pe=(pe<<5^Y[V])&32767,++V;ce-=_e-1}else le<=143?le=le+48:j=wr(H,j,1),j=Pr(H,j,q[le]),Q[pe]=V&32767,++V}j=Pr(H,j,0)-1}return H.l=(j+7)/8|0,H.l}return function(H,j){return H.length<8?T(H,j):U(H,j)}})();function Oe(w){var S=X(50+Math.floor(w.length*1.1)),_=_r(w,S);return S.slice(0,_)}var ot=ne?new Uint16Array(32768):Yt(32768),tr=ne?new Uint16Array(32768):Yt(32768),gt=ne?new Uint16Array(128):Yt(128),la=1,Qo=1;function bu(w,S){var _=Ie(w,S)+257;S+=5;var E=Ie(w,S)+1;S+=5;var b=He(w,S)+4;S+=4;for(var T=0,U=ne?new Uint8Array(19):Yt(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=1,j=ne?new Uint8Array(8):Yt(8),V=ne?new Uint8Array(8):Yt(8),Q=U.length,ce=0;ce<b;++ce)U[P[ce]]=T=Fe(w,S),H<T&&(H=T),j[T]++,S+=3;var pe=0;for(j[0]=0,ce=1;ce<=H;++ce)V[ce]=pe=pe+j[ce-1]<<1;for(ce=0;ce<Q;++ce)(pe=U[ce])!=0&&(Y[ce]=V[pe]++);var le=0;for(ce=0;ce<Q;++ce)if(le=U[ce],le!=0){pe=q[Y[ce]]>>8-le;for(var ue=(1<<7-le)-1;ue>=0;--ue)gt[pe|ue<<le]=le&7|ce<<3}var _e=[];for(H=1;_e.length<_+E;)switch(pe=gt[he(w,S)],S+=pe&7,pe>>>=3){case 16:for(T=3+je(w,S),S+=2,pe=_e[_e.length-1];T-- >0;)_e.push(pe);break;case 17:for(T=3+Fe(w,S),S+=3;T-- >0;)_e.push(0);break;case 18:for(T=11+he(w,S),S+=7;T-- >0;)_e.push(0);break;default:_e.push(pe),H<pe&&(H=pe);break}var Ye=_e.slice(0,_),Wt=_e.slice(_);for(ce=_;ce<286;++ce)Ye[ce]=0;for(ce=E;ce<30;++ce)Wt[ce]=0;return la=Rr(Ye,ot,286),Qo=Rr(Wt,tr,30),S}function Tu(w,S){if(w[0]==3&&!(w[1]&3))return[Zr(S),2];for(var _=0,E=0,b=wc(S||1<<18),T=0,U=b.length>>>0,Y=0,H=0;(E&1)==0;){if(E=Fe(w,_),_+=3,E>>>1)E>>1==1?(Y=9,H=5):(_=bu(w,_),Y=la,H=Qo);else{_&7&&(_+=8-(_&7));var j=w[_>>>3]|w[(_>>>3)+1]<<8;if(_+=32,j>0)for(!S&&U<T+j&&(b=zr(b,T+j),U=b.length);j-- >0;)b[T++]=w[_>>>3],_+=8;continue}for(;;){!S&&U<T+32767&&(b=zr(b,T+32767),U=b.length);var V=st(w,_,Y),Q=E>>>1==1?Xr[V]:ot[V];if(_+=Q&15,Q>>>=4,(Q>>>8&255)===0)b[T++]=Q;else{if(Q==256)break;Q-=257;var ce=Q<8?0:Q-4>>2;ce>5&&(ce=0);var pe=T+z[Q];ce>0&&(pe+=st(w,_,ce),_+=ce),V=st(w,_,H),Q=E>>>1==1?on[V]:tr[V],_+=Q&15,Q>>>=4;var le=Q<4?0:Q-2>>1,ue=fe[Q];for(le>0&&(ue+=st(w,_,le),_+=le),!S&&U<pe&&(b=zr(b,pe+100),U=b.length);T<pe;)b[T]=b[T-ue],++T}}}return S?[b,_+7>>>3]:[b.slice(0,T),_+7>>>3]}function ec(w,S){var _=w.slice(w.l||0),E=Tu(_,S);return w.l+=E[1],E[0]}function tc(w,S){if(w)typeof console!="undefined"&&console.error(S);else throw new Error(S)}function rc(w,S){var _=w;Tt(_,0);var E=[],b=[],T={FileIndex:E,FullPaths:b};k(T,{root:S.root});for(var U=_.length-4;(_[U]!=80||_[U+1]!=75||_[U+2]!=5||_[U+3]!=6)&&U>=0;)--U;_.l=U+4,_.l+=4;var Y=_.read_shift(2);_.l+=6;var H=_.read_shift(4);for(_.l=H,U=0;U<Y;++U){_.l+=20;var j=_.read_shift(4),V=_.read_shift(4),Q=_.read_shift(2),ce=_.read_shift(2),pe=_.read_shift(2);_.l+=8;var le=_.read_shift(4),ue=o(_.slice(_.l+Q,_.l+Q+ce));_.l+=Q+ce+pe;var _e=_.l;_.l=le+4,Cu(_,j,V,T,ue),_.l=_e}return T}function Cu(w,S,_,E,b){w.l+=2;var T=w.read_shift(2),U=w.read_shift(2),Y=s(w);if(T&8257)throw new Error("Unsupported ZIP encryption");for(var H=w.read_shift(4),j=w.read_shift(4),V=w.read_shift(4),Q=w.read_shift(2),ce=w.read_shift(2),pe="",le=0;le<Q;++le)pe+=String.fromCharCode(w[w.l++]);if(ce){var ue=o(w.slice(w.l,w.l+ce));(ue[21589]||{}).mt&&(Y=ue[21589].mt),((b||{})[21589]||{}).mt&&(Y=b[21589].mt)}w.l+=ce;var _e=w.slice(w.l,w.l+j);switch(U){case 8:_e=B(w,V);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+U)}var Ye=!1;T&8&&(H=w.read_shift(4),H==134695760&&(H=w.read_shift(4),Ye=!0),j=w.read_shift(4),V=w.read_shift(4)),j!=S&&tc(Ye,"Bad compressed size: "+S+" != "+j),V!=_&&tc(Ye,"Bad uncompressed size: "+_+" != "+V),rs(E,pe,_e,{unsafe:!0,mt:Y})}function Au(w,S){var _=S||{},E=[],b=[],T=X(1),U=_.compression?8:0,Y=0,H=!1;H&&(Y|=8);var j=0,V=0,Q=0,ce=0,pe=w.FullPaths[0],le=pe,ue=w.FileIndex[0],_e=[],Ye=0;for(j=1;j<w.FullPaths.length;++j)if(le=w.FullPaths[j].slice(pe.length),ue=w.FileIndex[j],!(!ue.size||!ue.content||le=="Sh33tJ5")){var Wt=Q,dt=X(le.length);for(V=0;V<le.length;++V)dt.write_shift(1,le.charCodeAt(V)&127);dt=dt.slice(0,dt.l),_e[ce]=Wd.buf(ue.content,0);var qt=ue.content;U==8&&(qt=R(qt)),T=X(30),T.write_shift(4,67324752),T.write_shift(2,20),T.write_shift(2,Y),T.write_shift(2,U),ue.mt?i(T,ue.mt):T.write_shift(4,0),T.write_shift(-4,Y&8?0:_e[ce]),T.write_shift(4,Y&8?0:qt.length),T.write_shift(4,Y&8?0:ue.content.length),T.write_shift(2,dt.length),T.write_shift(2,0),Q+=T.length,E.push(T),Q+=dt.length,E.push(dt),Q+=qt.length,E.push(qt),Y&8&&(T=X(12),T.write_shift(-4,_e[ce]),T.write_shift(4,qt.length),T.write_shift(4,ue.content.length),Q+=T.l,E.push(T)),T=X(46),T.write_shift(4,33639248),T.write_shift(2,0),T.write_shift(2,20),T.write_shift(2,Y),T.write_shift(2,U),T.write_shift(4,0),T.write_shift(-4,_e[ce]),T.write_shift(4,qt.length),T.write_shift(4,ue.content.length),T.write_shift(2,dt.length),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(4,0),T.write_shift(4,Wt),Ye+=T.l,b.push(T),Ye+=dt.length,b.push(dt),++ce}return T=X(22),T.write_shift(4,101010256),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,ce),T.write_shift(2,ce),T.write_shift(4,Ye),T.write_shift(4,Q),T.write_shift(2,0),Et([Et(E),Et(b),T])}var ei={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ou(w,S){if(w.ctype)return w.ctype;var _=w.name||"",E=_.match(/\.([^\.]+)$/);return E&&ei[E[1]]||S&&(E=(_=S).match(/[\.\\]([^\.\\])+$/),E&&ei[E[1]])?ei[E[1]]:"application/octet-stream"}function Fu(w){for(var S=Tn(w),_=[],E=0;E<S.length;E+=76)_.push(S.slice(E,E+76));return _.join(`\r
`)+`\r
`}function Iu(w){var S=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(j){var V=j.charCodeAt(0).toString(16).toUpperCase();return"="+(V.length==1?"0"+V:V)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var _=[],E=S.split(`\r
`),b=0;b<E.length;++b){var T=E[b];if(T.length==0){_.push("");continue}for(var U=0;U<T.length;){var Y=76,H=T.slice(U,U+Y);H.charAt(Y-1)=="="?Y--:H.charAt(Y-2)=="="?Y-=2:H.charAt(Y-3)=="="&&(Y-=3),H=T.slice(U,U+Y),U+=Y,U<T.length&&(H+="="),_.push(H)}}return _.join(`\r
`)}function Pu(w){for(var S=[],_=0;_<w.length;++_){for(var E=w[_];_<=w.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+w[++_];S.push(E)}for(var b=0;b<S.length;++b)S[b]=S[b].replace(/[=][0-9A-Fa-f]{2}/g,function(T){return String.fromCharCode(parseInt(T.slice(1),16))});return Jt(S.join(`\r
`))}function Ru(w,S,_){for(var E="",b="",T="",U,Y=0;Y<10;++Y){var H=S[Y];if(!H||H.match(/^\s*$/))break;var j=H.match(/^(.*?):\s*([^\s].*)$/);if(j)switch(j[1].toLowerCase()){case"content-location":E=j[2].trim();break;case"content-type":T=j[2].trim();break;case"content-transfer-encoding":b=j[2].trim();break}}switch(++Y,b.toLowerCase()){case"base64":U=Jt(Qt(S.slice(Y).join("")));break;case"quoted-printable":U=Pu(S.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var V=rs(w,E.slice(_.length),U,{unsafe:!0});T&&(V.ctype=T)}function Du(w,S){if(re(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var _=S&&S.root||"",E=(Ae&&Buffer.isBuffer(w)?w.toString("binary"):re(w)).split(`\r
`),b=0,T="";for(b=0;b<E.length;++b)if(T=E[b],!!/^Content-Location:/i.test(T)&&(T=T.slice(T.indexOf("file")),_||(_=T.slice(0,T.lastIndexOf("/")+1)),T.slice(0,_.length)!=_))for(;_.length>0&&(_=_.slice(0,_.length-1),_=_.slice(0,_.lastIndexOf("/")+1),T.slice(0,_.length)!=_););var U=(E[1]||"").match(/boundary="(.*?)"/);if(!U)throw new Error("MAD cannot find boundary");var Y="--"+(U[1]||""),H=[],j=[],V={FileIndex:H,FullPaths:j};k(V);var Q,ce=0;for(b=0;b<E.length;++b){var pe=E[b];pe!==Y&&pe!==Y+"--"||(ce++&&Ru(V,E.slice(Q,b),_),Q=b)}return V}function Nu(w,S){var _=S||{},E=_.boundary||"SheetJS";E="------="+E;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],T=w.FullPaths[0],U=T,Y=w.FileIndex[0],H=1;H<w.FullPaths.length;++H)if(U=w.FullPaths[H].slice(T.length),Y=w.FileIndex[H],!(!Y.size||!Y.content||U=="Sh33tJ5")){U=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var j=Y.content,V=Ae&&Buffer.isBuffer(j)?j.toString("binary"):re(j),Q=0,ce=Math.min(1024,V.length),pe=0,le=0;le<=ce;++le)(pe=V.charCodeAt(le))>=32&&pe<128&&++Q;var ue=Q>=ce*4/5;b.push(E),b.push("Content-Location: "+(_.root||"file:///C:/SheetJS/")+U),b.push("Content-Transfer-Encoding: "+(ue?"quoted-printable":"base64")),b.push("Content-Type: "+Ou(Y,U)),b.push(""),b.push(ue?Iu(V):Fu(V))}return b.push(E+`--\r
`),b.join(`\r
`)}function Lu(w){var S={};return k(S,w),S}function rs(w,S,_,E){var b=E&&E.unsafe;b||k(w);var T=!b&&me.find(w,S);if(!T){var U=w.FullPaths[0];S.slice(0,U.length)==U?U=S:(U.slice(-1)!="/"&&(U+="/"),U=(U+S).replace("//","/")),T={name:n(S),type:2},w.FileIndex.push(T),w.FullPaths.push(U),b||me.utils.cfb_gc(w)}return T.content=_,T.size=_?_.length:0,E&&(E.CLSID&&(T.clsid=E.CLSID),E.mt&&(T.mt=E.mt),E.ct&&(T.ct=E.ct)),T}function Bu(w,S){k(w);var _=me.find(w,S);if(_){for(var E=0;E<w.FileIndex.length;++E)if(w.FileIndex[E]==_)return w.FileIndex.splice(E,1),w.FullPaths.splice(E,1),!0}return!1}function Mu(w,S,_){k(w);var E=me.find(w,S);if(E){for(var b=0;b<w.FileIndex.length;++b)if(w.FileIndex[b]==E)return w.FileIndex[b].name=n(_),w.FullPaths[b]=_,!0}return!1}function $u(w){D(w,!0)}return r.find=W,r.read=A,r.parse=f,r.write=Z,r.writeFile=ye,r.utils={cfb_new:Lu,cfb_add:rs,cfb_del:Bu,cfb_mov:Mu,cfb_gc:$u,ReadShift:xn,CheckField:r0,prep_blob:Tt,bconcat:Et,use_zlib:C,_deflateRaw:Oe,_inflateRaw:ec,consts:ie},r})(),Ma;function Gd(e){return typeof e=="string"?Pi(e):Array.isArray(e)?xd(e):e}function $n(e,r,t){if(typeof Ma!="undefined"&&Ma.writeFileSync)return t?Ma.writeFileSync(e,r,t):Ma.writeFileSync(e,r);if(typeof Deno!="undefined"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Pi(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var a=t=="utf8"?br(r):r;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(a,e);if(typeof Blob!="undefined"){var n=new Blob([Gd(a)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs!="undefined")return saveAs(n,e);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=ra(r)),o.write(r),o.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function zd(e){if(typeof Ma!="undefined")return Ma.readFileSync(e);if(typeof Deno!="undefined")return Deno.readFileSync(e);if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function nt(e){for(var r=Object.keys(e),t=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&t.push(r[a]);return t}function Ac(e,r){for(var t=[],a=nt(e),n=0;n!==a.length;++n)t[e[a[n]][r]]==null&&(t[e[a[n]][r]]=a[n]);return t}function Di(e){for(var r=[],t=nt(e),a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}function Ni(e){for(var r=[],t=nt(e),a=0;a!==t.length;++a)r[e[t[a]]]=parseInt(t[a],10);return r}function Xd(e){for(var r=[],t=nt(e),a=0;a!==t.length;++a)r[e[t[a]]]==null&&(r[e[t[a]]]=[]),r[e[t[a]]].push(t[a]);return r}var ki=new Date(1899,11,30,0,0,0);function yt(e,r){var t=e.getTime();r&&(t-=1462*24*60*60*1e3);var a=ki.getTime()+(e.getTimezoneOffset()-ki.getTimezoneOffset())*6e4;return(t-a)/(1440*60*1e3)}var $l=new Date,Yd=ki.getTime()+($l.getTimezoneOffset()-ki.getTimezoneOffset())*6e4,Oc=$l.getTimezoneOffset();function Li(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Yd),r.getTimezoneOffset()!==Oc&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Oc)*6e4),r}function qd(e){var r=0,t=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(t=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(a)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}r+=t*parseInt(n[i],10)}return r}var Fc=new Date("2017-02-19T19:06:09.000Z"),Ul=isNaN(Fc.getFullYear())?new Date("2/19/17"):Fc,Kd=Ul.getFullYear()==2017;function Ke(e,r){var t=new Date(e);if(Kd)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Ul.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return e.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function va(e,r){if(Ae&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return br(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return br(Cl(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder!="undefined")try{if(r){if(e[0]==255&&e[1]==254)return br(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return br(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return t[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Je(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Je(e[t]));return r}function tt(e,r){for(var t="";t.length<r;)t+=e;return t}function vr(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return t=-t,i}),!isNaN(r=Number(a)))?r/t:r}var Jd=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ga(e){var r=new Date(e),t=new Date(NaN),a=r.getYear(),n=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Jd.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return a<0||a>8099?t:(n>0||i>1)&&a!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Zd=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,a,n){if(e||typeof a=="string")return t.split(a);for(var i=t.split(a),s=[i[0]],o=1;o<i.length;++o)s.push(n),s.push(i[o]);return s}})();function jl(e){return e?e.content&&e.type?va(e.content,!0):e.data?pn(e.data):e.asNodeBuffer&&Ae?pn(e.asNodeBuffer().toString("binary")):e.asBinary?pn(e.asBinary()):e._data&&e._data.getContent?pn(va(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Hl(e){if(!e)return null;if(e.data)return Fs(e.data);if(e.asNodeBuffer&&Ae)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Fs(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Qd(e){return e&&e.name.slice(-4)===".bin"?Hl(e):jl(e)}function sr(e,r){for(var t=e.FullPaths||nt(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<t.length;++i){var s=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==s||n==s)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function Ys(e,r){var t=sr(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function pt(e,r,t){if(!t)return Qd(Ys(e,r));if(!r)return null;try{return pt(e,r)}catch{return null}}function Zt(e,r,t){if(!t)return jl(Ys(e,r));if(!r)return null;try{return Zt(e,r)}catch{return null}}function Vl(e,r,t){if(!t)return Hl(Ys(e,r));if(!r)return null;try{return Vl(e,r)}catch{return null}}function Ic(e){for(var r=e.FullPaths||nt(e.files),t=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&t.push(r[a].replace(/^Root Entry[\/]/,""));return t.sort()}function be(e,r,t){if(e.FullPaths){if(typeof t=="string"){var a;return Ae?a=Ur(t):a=vd(t),me.utils.cfb_add(e,r,a)}me.utils.cfb_add(e,r,t)}else e.file(r,t)}function qs(){return me.utils.cfb_new()}function Wl(e,r){switch(r.type){case"base64":return me.read(e,{type:"base64"});case"binary":return me.read(e,{type:"binary"});case"buffer":case"array":return me.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function gn(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var ft=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eh=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Pc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,th=/<[^>]*>/g,Mt=ft.match(Pc)?Pc:th,rh=/<\w*:/,ah=/<(\/?)\w+:/;function ve(e,r,t){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(r||(a[0]=e.slice(0,n)),n===e.length)return a;var s=e.match(eh),o=0,c="",l=0,f="",d="",u=1;if(s)for(l=0;l!=s.length;++l){for(d=s[l],i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(f=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(u=(n=d.charCodeAt(i+1))==34||n==39?1:0,c=d.slice(i+1+u,d.length-u),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=c,t||(a[f.toLowerCase()]=c);else{var h=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(a[h]&&f.slice(o-3,o)=="ext")continue;a[h]=c,t||(a[h.toLowerCase()]=c)}}return a}function Cr(e){return e.replace(ah,"<$1")}var Gl={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ks=Di(Gl),Le=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return Gl[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=n.indexOf("]]>");return t(n.slice(0,i))+n.slice(i+9,s)+t(n.slice(s+3))}})(),Js=/[&<>'"]/g,nh=/[\u0000-\u0008\u000b-\u001f]/g;function Ge(e){var r=e+"";return r.replace(Js,function(t){return Ks[t]}).replace(nh,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Rc(e){return Ge(e).replace(/ /g,"_x0020_")}var zl=/[\u0000-\u001f]/g;function Zs(e){var r=e+"";return r.replace(Js,function(t){return Ks[t]}).replace(/\n/g,"<br/>").replace(zl,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function ih(e){var r=e+"";return r.replace(Js,function(t){return Ks[t]}).replace(zl,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Dc=(function(){var e=/&#(\d+);/g;function r(t,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}})();function sh(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function qe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xs(e){for(var r="",t=0,a=0,n=0,i=0,s=0,o=0;t<e.length;){if(a=e.charCodeAt(t++),a<128){r+=String.fromCharCode(a);continue}if(n=e.charCodeAt(t++),a>191&&a<224){s=(a&31)<<6,s|=n&63,r+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}s=e.charCodeAt(t++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function Nc(e){var r=Zr(2*e.length),t,a,n=1,i=0,s=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(t=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,t=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(r[i++]=s&255,r[i++]=s>>>8,s=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")}function Lc(e){return Ur(e,"binary").toString("utf8")}var li="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",ze=Ae&&(Lc(li)==xs(li)&&Lc||Nc(li)==xs(li)&&Nc)||xs,br=Ae?function(e){return Ur(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,a=0,n=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(t++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},An=(function(){var e={};return function(t,a){var n=t+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}})(),Xl=(function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),oh=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),ch=/<\/?(?:vt:)?variant>/g,lh=/<(?:vt:)([^>]*)>([\s\S]*)</;function Bc(e,r){var t=ve(e),a=e.match(oh(t.baseType))||[],n=[];if(a.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return n}return a.forEach(function(i){var s=i.replace(ch,"").match(lh);s&&n.push({v:ze(s[2]),t:s[1]})}),n}var Yl=/(^\s|\s$|\n)/;function Ct(e,r){return"<"+e+(r.match(Yl)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function On(e){return nt(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function se(e,r,t){return"<"+e+(t!=null?On(t):"")+(r!=null?(r.match(Yl)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Is(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function fh(e,r){switch(typeof e){case"string":var t=se("vt:lpwstr",Ge(e));return r&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return se((e|0)==e?"vt:i4":"vt:r8",Ge(String(e)));case"boolean":return se("vt:bool",e?"true":"false")}if(e instanceof Date)return se("vt:filetime",Is(e));throw new Error("Unable to serialize "+e)}function Qs(e){if(Ae&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return ze(ra(Gs(e)));throw new Error("Bad input format: expected Buffer or string")}var Fn=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,vt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ea=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function uh(e,r){for(var t=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),n=e[r+6]&15,i=5;i>=0;--i)n=n*256+e[r+i];return a==2047?n==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),t*Math.pow(2,a-52)*n)}function dh(e,r,t){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,i=0,s=a?-r:r;isFinite(s)?s==0?n=i=0:(n=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[t+o]=i&255;e[t+6]=(n&15)<<4|i&15,e[t+7]=n>>4|a}var Mc=function(e){for(var r=[],t=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=t)r.push.apply(r,e[0][a].slice(n,n+t));return r},$c=Ae?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Ur(r)})):Mc(e)}:Mc,Uc=function(e,r,t){for(var a=[],n=r;n<t;n+=2)a.push(String.fromCharCode(Nr(e,n)));return a.join("").replace(Nt,"")},Bi=Ae?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Nt,""):Uc(e,r,t)}:Uc,jc=function(e,r,t){for(var a=[],n=r;n<r+t;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},ql=Ae?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):jc(e,r,t)}:jc,Hc=function(e,r,t){for(var a=[],n=r;n<t;n++)a.push(String.fromCharCode(Ba(e,n)));return a.join("")},Ka=Ae?function(r,t,a){return Buffer.isBuffer(r)?r.toString("utf8",t,a):Hc(r,t,a)}:Hc,Kl=function(e,r){var t=kt(e,r);return t>0?Ka(e,r+4,r+4+t-1):""},eo=Kl,Jl=function(e,r){var t=kt(e,r);return t>0?Ka(e,r+4,r+4+t-1):""},to=Jl,Zl=function(e,r){var t=2*kt(e,r);return t>0?Ka(e,r+4,r+4+t-1):""},ro=Zl,Ql=function(r,t){var a=kt(r,t);return a>0?Bi(r,t+4,t+4+a):""},ao=Ql,e0=function(e,r){var t=kt(e,r);return t>0?Ka(e,r+4,r+4+t):""},no=e0,t0=function(e,r){return uh(e,r)},Ei=t0,io=function(r){return Array.isArray(r)||typeof Uint8Array!="undefined"&&r instanceof Uint8Array};Ae&&(eo=function(r,t){if(!Buffer.isBuffer(r))return Kl(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},to=function(r,t){if(!Buffer.isBuffer(r))return Jl(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},ro=function(r,t){if(!Buffer.isBuffer(r))return Zl(r,t);var a=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a-1)},ao=function(r,t){if(!Buffer.isBuffer(r))return Ql(r,t);var a=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a)},no=function(r,t){if(!Buffer.isBuffer(r))return e0(r,t);var a=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+a)},Ei=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):t0(r,t)},io=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array!="undefined"&&r instanceof Uint8Array});function hh(){Bi=function(e,r,t){return Ue.utils.decode(1200,e.slice(r,t)).replace(Nt,"")},Ka=function(e,r,t){return Ue.utils.decode(65001,e.slice(r,t))},eo=function(e,r){var t=kt(e,r);return t>0?Ue.utils.decode(Wa,e.slice(r+4,r+4+t-1)):""},to=function(e,r){var t=kt(e,r);return t>0?Ue.utils.decode(Tr,e.slice(r+4,r+4+t-1)):""},ro=function(e,r){var t=2*kt(e,r);return t>0?Ue.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},ao=function(e,r){var t=kt(e,r);return t>0?Ue.utils.decode(1200,e.slice(r+4,r+4+t)):""},no=function(e,r){var t=kt(e,r);return t>0?Ue.utils.decode(65001,e.slice(r+4,r+4+t)):""}}typeof Ue!="undefined"&&hh();var Ba=function(e,r){return e[r]},Nr=function(e,r){return e[r+1]*256+e[r]},ph=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},kt=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},ua=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},mh=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function xn(e,r){var t="",a,n,i=[],s,o,c,l;switch(r){case"dbcs":if(l=this.l,Ae&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(Nr(this,l)),l+=2;e*=2;break;case"utf8":t=Ka(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Bi(this,this.l,this.l+e);break;case"wstr":if(typeof Ue!="undefined")t=Ue.utils.decode(Tr,this.slice(this.l,this.l+2*e));else return xn.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=eo(this,this.l),e=4+kt(this,this.l);break;case"lpstr-cp":t=to(this,this.l),e=4+kt(this,this.l);break;case"lpwstr":t=ro(this,this.l),e=4+2*kt(this,this.l);break;case"lpp4":e=4+kt(this,this.l),t=ao(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kt(this,this.l),t=no(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=Ba(this,this.l+e++))!==0;)i.push(ci(s));t=i.join("");break;case"_wstr":for(e=0,t="";(s=Nr(this,this.l+e))!==0;)i.push(ci(s)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=Ba(this,l),this.l=l+1,o=xn.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ci(Nr(this,l))),l+=2}t=i.join(""),e*=2;break;case"cpstr":if(typeof Ue!="undefined"){t=Ue.utils.decode(Tr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=Ba(this,l),this.l=l+1,o=xn.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ci(Ba(this,l))),l+=1}t=i.join("");break;default:switch(e){case 1:return a=Ba(this,this.l),this.l++,a;case 2:return a=(r==="i"?ph:Nr)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(e>0?ua:mh)(this,this.l),this.l+=4,a):(n=kt(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return e==8?n=Ei(this,this.l):n=Ei([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:t=ql(this,this.l,e);break}}return this.l+=e,t}var gh=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},xh=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},vh=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function yh(e,r,t){var a=0,n=0;if(t==="dbcs"){for(n=0;n!=r.length;++n)vh(this,r.charCodeAt(n),this.l+2*n);a=2*r.length}else if(t==="sbcs"){if(typeof Ue!="undefined"&&Wa==874)for(n=0;n!=r.length;++n){var i=Ue.utils.encode(Wa,r.charAt(n));this[this.l+n]=i[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;a=r.length}else if(t==="hex"){for(;n<e;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(r.length,e);++n){var o=r.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,gh(this,r,this.l);break;case 8:if(a=8,t==="f"){dh(this,r,this.l);break}case 16:break;case-4:a=4,xh(this,r,this.l);break}return this.l+=a,this}function r0(e,r){var t=ql(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Tt(e,r){e.l=r,e.read_shift=xn,e.chk=r0,e.write_shift=yh}function Bt(e,r){e.l+=r}function X(e){var r=Zr(e);return Tt(r,0),r}function jr(e,r,t){if(e){var a,n,i;Tt(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=Ln[o]||Ln[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var f=l.f&&l.f(e,i,t);if(e.l=c,r(f,l,o))return}}}function zt(){var e=[],r=Ae?256:2048,t=function(l){var f=X(l);return Tt(f,0),f},a=t(r),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(l){return a&&l<a.length-a.l?a:(n(),a=t(Math.max(l+1,r)))},s=function(){return n(),Et(e)},o=function(l){n(),a=l,a.l==null&&(a.l=a.length),i(r)};return{next:i,push:o,end:s,_bufs:e}}function K(e,r,t,a){var n=+r,i;if(!isNaN(n)){a||(a=Ln[n].p||(t||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var s=e.next(i);n<=127?s.write_shift(1,n):(s.write_shift(1,(n&127)+128),s.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)s.write_shift(1,(a&127)+128),a>>=7;else{s.write_shift(1,a);break}a>0&&io(t)&&e.push(t)}}function vn(e,r,t){var a=Je(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Vc(e,r,t){var a=Je(e);return a.s=vn(a.s,r.s,t),a.e=vn(a.e,r.s,t),a}function yn(e,r){if(e.cRel&&e.c<0)for(e=Je(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Je(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=xe(e);return!e.cRel&&e.cRel!=null&&(t=kh(t)),!e.rRel&&e.rRel!=null&&(t=wh(t)),t}function vs(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qe(e.s.c)+":"+(e.e.cRel?"":"$")+Qe(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+lt(e.s.r)+":"+(e.e.rRel?"":"$")+lt(e.e.r):yn(e.s,r.biff)+":"+yn(e.e,r.biff)}function so(e){return parseInt(_h(e),10)-1}function lt(e){return""+(e+1)}function wh(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _h(e){return e.replace(/\$(\d+)$/,"$1")}function oo(e){for(var r=Eh(e),t=0,a=0;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function Qe(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function kh(e){return e.replace(/^([A-Z])/,"$$$1")}function Eh(e){return e.replace(/^\$([A-Z])/,"$1")}function Sh(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function et(e){for(var r=0,t=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:r-1}}function xe(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Xt(e){var r=e.indexOf(":");return r==-1?{s:et(e),e:et(e)}:{s:et(e.slice(0,r)),e:et(e.slice(r+1))}}function Ee(e,r){return typeof r=="undefined"||typeof r=="number"?Ee(e.s,e.e):(typeof e!="string"&&(e=xe(e)),typeof r!="string"&&(r=xe(r)),e==r?e:e+":"+r)}function Be(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,n=0,i=e.length;for(t=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.s.c=--t,t=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;if(r.s.r=--t,a===i||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,t=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.e.c=--t,t=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;return r.e.r=--t,r}function Wc(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=lr(e.z,t?yt(r):r)}catch{}try{return e.w=lr((e.XF||{}).numFmtId||(t?14:0),t?yt(r):r)}catch{return""+r}}function $r(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Hr[e.v]||e.v:r==null?Wc(e,e.v):Wc(e,r))}function aa(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function a0(e,r,t){var a=t||{},n=e?Array.isArray(e):a.dense;at!=null&&n==null&&(n=at);var i=e||(n?[]:{}),s=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?et(a.origin):a.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Be(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),s==-1&&(l.e.r=s=f.e.r+1)}for(var d=0;d!=r.length;++d)if(r[d]){if(!Array.isArray(r[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=r[d].length;++u)if(typeof r[d][u]!="undefined"){var h={v:r[d][u]},m=s+d,p=o+u;if(l.s.r>m&&(l.s.r=m),l.s.c>p&&(l.s.c=p),l.e.r<m&&(l.e.r=m),l.e.c<p&&(l.e.c=p),r[d][u]&&typeof r[d][u]=="object"&&!Array.isArray(r[d][u])&&!(r[d][u]instanceof Date))h=r[d][u];else if(Array.isArray(h.v)&&(h.f=r[d][u][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||ge[14],a.cellDates?(h.t="d",h.w=lr(h.z,yt(h.v))):(h.t="n",h.v=yt(h.v),h.w=lr(h.z,h.v))):h.t="s";if(n)i[m]||(i[m]=[]),i[m][p]&&i[m][p].z&&(h.z=i[m][p].z),i[m][p]=h;else{var g=xe({c:p,r:m});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return l.s.c<1e7&&(i["!ref"]=Ee(l)),i}function Ja(e,r){return a0(null,e,r)}function bh(e){return e.read_shift(4,"i")}function yr(e,r){return r||(r=X(4)),r.write_shift(4,e),r}function Lt(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function St(e,r){var t=!1;return r==null&&(t=!0,r=X(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Th(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ch(e,r){return r||(r=X(4)),r.write_shift(2,e.ich||0),r.write_shift(2,e.ifnt||0),r}function co(e,r){var t=e.l,a=e.read_shift(1),n=Lt(e),i=[],s={t:n,h:n};if((a&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(Th(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}function Ah(e,r){var t=!1;return r==null&&(t=!0,r=X(15+4*e.t.length)),r.write_shift(1,0),St(e.t,r),t?r.slice(0,r.l):r}var Oh=co;function Fh(e,r){var t=!1;return r==null&&(t=!0,r=X(23+4*e.t.length)),r.write_shift(1,1),St(e.t,r),r.write_shift(4,1),Ch({ich:0,ifnt:0},r),t?r.slice(0,r.l):r}function fr(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Sa(e,r){return r==null&&(r=X(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function ba(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Ta(e,r){return r==null&&(r=X(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Ih=Lt,n0=St;function lo(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Si(e,r){var t=!1;return r==null&&(t=!0,r=X(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Ph=Lt,Ps=lo,fo=Si;function uo(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,a=r[0]&2;e.l+=4;var n=a===0?Ei([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):ua(r,0)>>2;return t?n/100:n}function i0(e,r){r==null&&(r=X(4));var t=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(a=1,t=1),a)r.write_shift(-4,((t?n:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function s0(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function Rh(e,r){return r||(r=X(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Ca=s0,Za=Rh;function Dt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ya(e,r){return(r||X(8)).write_shift(8,e,"f")}function Dh(e){var r={},t=e.read_shift(1),a=t>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var l=ha[n];l&&(r.rgb=Pn(l));break;case 2:r.rgb=Pn([s,o,c]);break;case 3:r.theme=n;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function bi(e,r){if(r||(r=X(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),r.write_shift(1,parseInt(a.slice(0,2),16)),r.write_shift(1,parseInt(a.slice(2,4),16)),r.write_shift(1,parseInt(a.slice(4,6),16)),r.write_shift(1,255)}return r}function Nh(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Lh(e,r){r||(r=X(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function o0(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Bh(e){return o0(e,1)}function Mh(e){return o0(e,2)}var ho=2,Gt=3,fi=11,Gc=12,Ti=19;var ui=64,$h=65,Uh=71;var jh=4108,Hh=4126,_t=80,c0=81,Vh=[_t,c0],Rs={1:{n:"CodePage",t:ho},2:{n:"Category",t:_t},3:{n:"PresentationFormat",t:_t},4:{n:"ByteCount",t:Gt},5:{n:"LineCount",t:Gt},6:{n:"ParagraphCount",t:Gt},7:{n:"SlideCount",t:Gt},8:{n:"NoteCount",t:Gt},9:{n:"HiddenCount",t:Gt},10:{n:"MultimediaClipCount",t:Gt},11:{n:"ScaleCrop",t:fi},12:{n:"HeadingPairs",t:jh},13:{n:"TitlesOfParts",t:Hh},14:{n:"Manager",t:_t},15:{n:"Company",t:_t},16:{n:"LinksUpToDate",t:fi},17:{n:"CharacterCount",t:Gt},19:{n:"SharedDoc",t:fi},22:{n:"HyperlinksChanged",t:fi},23:{n:"AppVersion",t:Gt,p:"version"},24:{n:"DigSig",t:$h},26:{n:"ContentType",t:_t},27:{n:"ContentStatus",t:_t},28:{n:"Language",t:_t},29:{n:"Version",t:_t},255:{},2147483648:{n:"Locale",t:Ti},2147483651:{n:"Behavior",t:Ti},1919054434:{}},Ds={1:{n:"CodePage",t:ho},2:{n:"Title",t:_t},3:{n:"Subject",t:_t},4:{n:"Author",t:_t},5:{n:"Keywords",t:_t},6:{n:"Comments",t:_t},7:{n:"Template",t:_t},8:{n:"LastAuthor",t:_t},9:{n:"RevNumber",t:_t},10:{n:"EditTime",t:ui},11:{n:"LastPrinted",t:ui},12:{n:"CreatedDate",t:ui},13:{n:"ModifiedDate",t:ui},14:{n:"PageCount",t:Gt},15:{n:"WordCount",t:Gt},16:{n:"CharCount",t:Gt},17:{n:"Thumbnail",t:Uh},18:{n:"Application",t:_t},19:{n:"DocSecurity",t:Gt},255:{},2147483648:{n:"Locale",t:Ti},2147483651:{n:"Behavior",t:Ti},1919054434:{}},zc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Wh=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Gh(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var zh=Gh([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ha=Je(zh),Hr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},l0={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ns={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},di={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function po(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Xh(e){var r=po();if(!e||!e.match)return r;var t={};if((e.match(Mt)||[]).forEach(function(a){var n=ve(a);switch(n[0].replace(rh,"<")){case"<?xml":break;case"<Types":r.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":r[Ns[n.ContentType]]!==void 0&&r[Ns[n.ContentType]].push(n.PartName);break}}),r.xmlns!==vt.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function f0(e,r){var t=Xd(Ns),a=[],n;a[a.length]=ft,a[a.length]=se("Types",null,{xmlns:vt.CT,"xmlns:xsd":vt.xsd,"xmlns:xsi":vt.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return se("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=se("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:di[c][r.bookType]||di[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(l){a[a.length]=se("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:di[c][r.bookType]||di[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(l){a[a.length]=se("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Te={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function In(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function wn(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(Mt)||[]).forEach(function(n){var i=ve(n);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:gn(i.Target,r);t[o]=s,a[i.Id]=s}}),t["!id"]=a,t}function ja(e){var r=[ft,se("Relationships",null,{xmlns:vt.RELS})];return nt(e["!id"]).forEach(function(t){r[r.length]=se("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function We(e,r,t,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,n.Id="rId"+r,n.Type=a,n.Target=t,i?n.TargetMode=i:[Te.HLINK,Te.XPATH,Te.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,r}var Yh="application/vnd.oasis.opendocument.spreadsheet";function qh(e,r){for(var t=Qs(e),a,n;a=Fn.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if(n=ve(a[0],!1),n.path=="/"&&n.type!==Yh)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}function Kh(e){var r=[ft];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Xc(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Jh(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Zh(e){var r=[ft];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Xc(e[t][0],e[t][1])),r.push(Jh("",e[t][0]));return r.push(Xc("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function u0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+bn.version+"</meta:generator></office:meta></office:document-meta>"}var cr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Qh=(function(){for(var e=new Array(cr.length),r=0;r<cr.length;++r){var t=cr[r],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function d0(e){var r={};e=ze(e);for(var t=0;t<cr.length;++t){var a=cr[t],n=e.match(Qh[t]);n!=null&&n.length>0&&(r[a[1]]=Le(n[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=Ke(r[a[1]]))}return r}function ys(e,r,t,a,n){n[e]!=null||r==null||r===""||(n[e]=r,r=Ge(r),a[a.length]=t?se(e,r,t):Ct(e,r))}function h0(e,r){var t=r||{},a=[ft,se("cp:coreProperties",null,{"xmlns:cp":vt.CORE_PROPS,"xmlns:dc":vt.dc,"xmlns:dcterms":vt.dcterms,"xmlns:dcmitype":vt.dcmitype,"xmlns:xsi":vt.xsi})],n={};if(!e&&!t.Props)return a.join("");e&&(e.CreatedDate!=null&&ys("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Is(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&ys("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Is(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=cr.length;++i){var s=cr[i],o=t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ys(s[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var pa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],p0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function m0(e,r,t,a){var n=[];if(typeof e=="string")n=Bc(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(f){return{v:f}}));var s=typeof r=="string"?Bc(r,a).map(function(f){return f.v}):r,o=0,c=0;if(s.length>0)for(var l=0;l!==n.length;l+=2){switch(c=+n[l+1].v,n[l].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=c,t.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(o,o+c);break}o+=c}}function ep(e,r,t){var a={};return r||(r={}),e=ze(e),pa.forEach(function(n){var i=(e.match(An(n[0]))||[])[1];switch(n[2]){case"string":i&&(r[n[1]]=Le(i));break;case"bool":r[n[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));s&&s.length>0&&(a[n[1]]=s[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&m0(a.HeadingPairs,a.TitlesOfParts,r,t),r}function g0(e){var r=[],t=se;return e||(e={}),e.Application="SheetJS",r[r.length]=ft,r[r.length]=se("Properties",null,{xmlns:vt.EXT_PROPS,"xmlns:vt":vt.vt}),pa.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Ge(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(r[r.length]=t(a[0],n))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Ge(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var tp=/<[^>]+>[^<]*/g;function rp(e,r){var t={},a="",n=e.match(tp);if(n)for(var i=0;i!=n.length;++i){var s=n[i],o=ve(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Le(o.name);break;case"</property>":a=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[a]=Le(f);break;case"bool":t[a]=qe(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(f);break;case"filetime":case"date":t[a]=Ke(f);break;case"cy":case"error":t[a]=Le(f);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console!="undefined"&&console.warn("Unexpected",s,l,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return t}function x0(e){var r=[ft,se("Properties",null,{xmlns:vt.CUST_PROPS,"xmlns:vt":vt.vt})];if(!e)return r.join("");var t=1;return nt(e).forEach(function(n){++t,r[r.length]=se("property",fh(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Ge(n)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ls={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ws;function ap(e,r,t){ws||(ws=Di(Ls)),r=ws[r]||r,e[r]=t}function np(e,r){var t=[];return nt(Ls).map(function(a){for(var n=0;n<cr.length;++n)if(cr[n][1]==a)return cr[n];for(n=0;n<pa.length;++n)if(pa[n][1]==a)return pa[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=r&&r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(Ct(Ls[a[1]]||a[1],n))}}),se("DocumentProperties",t.join(""),{xmlns:Kt.o})}function ip(e,r){var t=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&nt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<cr.length;++s)if(i==cr[s][1])return;for(s=0;s<pa.length;++s)if(i==pa[s][1])return;for(s=0;s<t.length;++s)if(i==t[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(se(Rc(i),o,{"dt:dt":c}))}}),r&&nt(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=r[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),n.push(se(Rc(i),s,{"dt:dt":o}))}}),"<"+a+' xmlns="'+Kt.o+'">'+n.join("")+"</"+a+">"}function mo(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function sp(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,a=t%Math.pow(2,32),n=(t-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var s=X(8);return s.write_shift(4,a),s.write_shift(4,n),s}function v0(e,r,t){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return n}function y0(e,r,t){var a=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(a.length+1&3)&3),a}function w0(e,r,t){return r===31?y0(e):v0(e,r,t)}function Bs(e,r,t){return w0(e,r,t===!1?0:4)}function op(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return w0(e,r,0)}function cp(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a){var n=e.l;t[a]=e.read_shift(0,"lpwstr").replace(Nt,""),e.l-n&2&&(e.l+=2)}return t}function lp(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a)t[a]=e.read_shift(0,"lpstr-cp").replace(Nt,"");return t}function fp(e){var r=e.l,t=Ci(e,c0);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=Ci(e,Gt);return[t,a]}function up(e){for(var r=e.read_shift(4),t=[],a=0;a<r/2;++a)t.push(fp(e));return t}function Yc(e,r){for(var t=e.read_shift(4),a={},n=0;n!=t;++n){var i=e.read_shift(4),s=e.read_shift(4);a[i]=e.read_shift(s,r===1200?"utf16le":"utf8").replace(Nt,"").replace(mn,"!"),r===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function _0(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function dp(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Ci(e,r,t){var a=e.read_shift(2),n,i=t||{};if(e.l+=2,r!==Gc&&a!==r&&Vh.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===Gc?a:r){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return v0(e,a,4).replace(Nt,"");case 31:return y0(e);case 64:return mo(e);case 65:return _0(e);case 71:return dp(e);case 80:return Bs(e,a,!i.raw).replace(Nt,"");case 81:return op(e,a).replace(Nt,"");case 4108:return up(e);case 4126:case 4127:return a==4127?cp(e):lp(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function qc(e,r){var t=X(4),a=X(4);switch(t.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,r);break;case 5:a=X(8),a.write_shift(8,r,"f");break;case 11:a.write_shift(4,r?1:0);break;case 64:a=sp(r);break;case 31:case 80:for(a=X(4+2*(r.length+1)+(r.length%2?0:2)),a.write_shift(4,r.length+1),a.write_shift(0,r,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Et([t,a])}function Kc(e,r){var t=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],s=0,o=0,c=-1,l={};for(s=0;s!=n;++s){var f=e.read_shift(4),d=e.read_shift(4);i[s]=[f,d+t]}i.sort(function(y,x){return y[1]-x[1]});var u={};for(s=0;s!=n;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&r)switch(r[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!r||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(r){var m=r[i[s][0]];if(u[m.n]=Ci(e,m.t,{raw:!0}),m.p==="version"&&(u[m.n]=String(u[m.n]>>16)+"."+("0000"+String(u[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(u[m.n]){case 0:u[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:gr(o=u[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+u[m.n])}}else if(i[s][0]===1){if(o=u.CodePage=Ci(e,ho),gr(o),c!==-1){var p=e.l;e.l=i[c][1],l=Yc(e,o),e.l=p}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}l=Yc(e,o)}else{var g=l[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=_0(e);break;case 30:e.l+=4,v=Bs(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Bs(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=ct(e,4);break;case 64:e.l+=4,v=Ke(mo(e));break;default:throw new Error("unparsed value: "+e[e.l])}u[g]=v}}return e.l=t+a,u}var k0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function hp(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Jc(e,r,t){var a=X(8),n=[],i=[],s=8,o=0,c=X(8),l=X(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),i.push(c),n.push(l),s+=8+c.length,!r){l=X(8),l.write_shift(4,0),n.unshift(l);var f=[X(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=X(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=Et(f),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(r&&!r[e[o][0]])&&!(k0.indexOf(e[o][0])>-1||p0.indexOf(e[o][0])>-1)&&e[o][1]!=null){var u=e[o][1],h=0;if(r){h=+r[e[o][0]];var m=t[h];if(m.p=="version"&&typeof u=="string"){var p=u.split(".");u=(+p[0]<<16)+(+p[1]||0)}c=qc(m.t,u)}else{var g=hp(u);g==-1&&(g=31,u=String(u)),c=qc(g,u)}i.push(c),l=X(8),l.write_shift(4,r?h:2+o),n.push(l),s+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,v),v+=i[o].length;return a.write_shift(4,s),a.write_shift(4,i.length),Et([a].concat(n).concat(i))}function Zc(e,r,t){var a=e.content;if(!a)return{};Tt(a,0);var n,i,s,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),f=a.read_shift(16);if(f!==me.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(s=a.read_shift(16),c=a.read_shift(4));var d=Kc(a,r),u={SystemIdentifier:l};for(var h in d)u[h]=d[h];if(u.FMTID=i,n===1)return u;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var m;try{m=Kc(a,null)}catch{}for(h in m)u[h]=m[h];return u.FMTID=[i,s],u}function Qc(e,r,t,a,n,i){var s=X(n?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,me.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,n?2:1),s.write_shift(16,r,"hex"),s.write_shift(4,n?68:48);var c=Jc(e,t,a);if(o.push(c),n){var l=Jc(n,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(l)}return Et(o)}function qr(e,r){return e.read_shift(r),null}function pp(e,r){r||(r=X(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function mp(e,r,t){for(var a=[],n=e.l+r;e.l<n;)a.push(t(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function ct(e,r){return e.read_shift(r)===1}function Ht(e,r){return r||(r=X(2)),r.write_shift(2,+!!e),r}function mt(e){return e.read_shift(2,"u")}function or(e,r){return r||(r=X(2)),r.write_shift(2,e),r}function E0(e,r){return mp(e,r,mt)}function gp(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function S0(e,r,t){return t||(t=X(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function Un(e,r,t){var a=e.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont",i=Tr;if(t&&t.biff>=8&&(Tr=1200),!t||t.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return Tr=i,o}function xp(e){var r=Tr;Tr=1200;var t=e.read_shift(2),a=e.read_shift(1),n=a&4,i=a&8,s=1+(a&1),o=0,c,l={};i&&(o=e.read_shift(2)),n&&(c=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*o),n&&(e.l+=c),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Tr=r,l}function vp(e){var r=e.t||"",t=1,a=X(3+(t>1?2:0));a.write_shift(2,r.length),a.write_shift(1,(t>1?8:0)|1),t>1&&a.write_shift(2,t);var n=X(2*r.length);n.write_shift(2*r.length,r,"utf16le");var i=[a,n];return Et(i)}function wa(e,r,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function jn(e,r,t){var a=e.read_shift(t&&t.biff==2?1:2);return a===0?(e.l++,""):wa(e,a,t)}function Aa(e,r,t){if(t.biff>5)return jn(e,r,t);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function b0(e,r,t){return t||(t=X(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function yp(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function wp(e){var r=e.read_shift(4),t=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=t);var n=e.read_shift((a?r-24:r)>>1,"utf16le").replace(Nt,"");return a&&(e.l+=24),n}function _p(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return t+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Nt,"");return t+s}function kp(e,r){var t=e.read_shift(16);switch(r-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return wp(e,r);case"0303000000000000c000000000000046":return _p(e,r);default:throw new Error("Unsupported Moniker "+t)}}function hi(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Nt,""):"";return t}function el(e,r){r||(r=X(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function Ep(e,r){var t=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,s,o,c,l="",f,d;n&16&&(i=hi(e,t-e.l)),n&128&&(s=hi(e,t-e.l)),(n&257)===257&&(o=hi(e,t-e.l)),(n&257)===1&&(c=kp(e,t-e.l)),n&8&&(l=hi(e,t-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(d=mo(e)),e.l=t;var u=s||o||c||"";u&&l&&(u+="#"+l),u||(u="#"+l),n&2&&u.charAt(0)=="/"&&u.charAt(1)!="/"&&(u="file://"+u);var h={Target:u};return f&&(h.guid=f),d&&(h.time=d),i&&(h.Tooltip=i),h}function Sp(e){var r=X(512),t=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(t=0;t<s.length;++t)r.write_shift(4,s[t]);if(i==28)a=a.slice(1),el(a,r);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<s.length;++t)r.write_shift(1,parseInt(s[t],16));var o=n>-1?a.slice(0,n):a;for(r.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)r.write_shift(2,o.charCodeAt(t));r.write_shift(2,0),i&8&&el(n>-1?a.slice(n+1):"",r)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<s.length;++t)r.write_shift(1,parseInt(s[t],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,a.length-3*c+1),t=0;t<a.length-3*c;++t)r.write_shift(1,a.charCodeAt(t+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function T0(e){var r=e.read_shift(1),t=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[r,t,a,n]}function C0(e,r){var t=T0(e,r);return t[3]=0,t}function Ar(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return{r,c:t,ixfe:a}}function _a(e,r,t,a){return a||(a=X(6)),a.write_shift(2,e),a.write_shift(2,r),a.write_shift(2,t||0),a}function bp(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Tp(e,r,t){return r===0?"":Aa(e,r,t)}function Cp(e,r,t){var a=t.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),s=e.read_shift(a,"i");return[n,i,s]}function A0(e){var r=e.read_shift(2),t=uo(e);return[r,t]}function Ap(e,r,t){e.l+=4,r-=4;var a=e.l+r,n=Un(e,r,t),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function Mi(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r},e:{c:n,r:t}}}function O0(e,r){return r||(r=X(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function F0(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r},e:{c:n,r:t}}}var Op=F0;function I0(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[t,r,a]}function Fp(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Ip(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Ft(e){e.l+=2,e.l+=e.read_shift(2)}var Pp={0:Ft,4:Ft,5:Ft,6:Ft,7:Ip,8:Ft,9:Ft,10:Ft,11:Ft,12:Ft,13:Fp,14:Ft,15:Ft,16:Ft,17:Ft,18:Ft,19:Ft,20:Ft,21:I0};function Rp(e,r){for(var t=e.l+r,a=[];e.l<t;){var n=e.read_shift(2);e.l-=2;try{a.push(Pp[n](e,t-e.l))}catch{return e.l=t,a}}return e.l!=t&&(e.l=t),a}function pi(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function go(e,r,t){var a=1536,n=16;switch(t.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=X(n);return i.write_shift(2,a),i.write_shift(2,r),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Dp(e,r){return r===0||e.read_shift(2),1200}function Np(e,r,t){if(t.enc)return e.l+=r,"";var a=e.l,n=Aa(e,0,t);return e.read_shift(r+a-e.l),n}function Lp(e,r){var t=!r||r.biff==8,a=X(t?112:54);for(a.write_shift(r.biff==8?2:1,7),t&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(t?0:536870912));a.l<a.length;)a.write_shift(1,t?0:32);return a}function Bp(e,r,t){var a=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Mp(e,r,t){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Un(e,0,t);return s.length===0&&(s="Sheet1"),{pos:a,hs:n,dt:i,name:s}}function $p(e,r){var t=!r||r.biff>=8?2:1,a=X(8+t*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),r.biff>=8&&a.write_shift(1,1),a.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function Up(e,r){for(var t=e.l+r,a=e.read_shift(4),n=e.read_shift(4),i=[],s=0;s!=n&&e.l<t;++s)i.push(xp(e));return i.Count=a,i.Unique=n,i}function jp(e,r){var t=X(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=vp(e[n],r);var i=Et([t].concat(a));return i.parts=[t.length].concat(a.map(function(s){return s.length})),i}function Hp(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function Vp(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=t/20),r}function Wp(e){var r=bp(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function Gp(e){return e.read_shift(2),e.read_shift(4)}function tl(e,r,t){var a=0;t&&t.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);t&&t.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function zp(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[a,n],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:l}}function Xp(){var e=X(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Yp(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function qp(e){var r=X(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function Kp(){}function Jp(e,r,t){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Un(e,0,t),a}function Zp(e,r){var t=e.name||"Arial",a=r&&r.biff==5,n=a?15+t.length:16+2*t.length,i=X(n);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le"),i}function Qp(e){var r=Ar(e);return r.isst=e.read_shift(4),r}function e1(e,r,t,a){var n=X(10);return _a(e,r,a,n),n.write_shift(4,t),n}function t1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=e.l+r,n=Ar(e,6);t.biff==2&&e.l++;var i=jn(e,a-e.l,t);return n.val=i,n}function r1(e,r,t,a,n){var i=!n||n.biff==8,s=X(8+ +i+(1+i)*t.length);return _a(e,r,a,s),s.write_shift(2,t.length),i&&s.write_shift(1,1),s.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),s}function a1(e,r,t){var a=e.read_shift(2),n=Aa(e,0,t);return[a,n]}function n1(e,r,t,a){var n=t&&t.biff==5;a||(a=X(n?3+r.length:5+2*r.length)),a.write_shift(2,e),a.write_shift(n?1:2,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var i1=Aa;function rl(e,r,t){var a=e.l+r,n=t.biff==8||!t.biff?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:o},e:{r:s,c}}}function s1(e,r){var t=r.biff==8||!r.biff?4:2,a=X(2*t+6);return a.write_shift(t,e.s.r),a.write_shift(t,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function o1(e){var r=e.read_shift(2),t=e.read_shift(2),a=A0(e);return{r,c:t,ixfe:a[0],rknum:a[1]}}function c1(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<t;)i.push(A0(e));if(e.l!==t)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:s,rkrec:i}}function l1(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<t;)i.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:s,ixfe:i}}function f1(e,r,t,a){var n={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=Wh[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=s&15,n.dgRight=s>>4&15,n.dgTop=s>>8&15,n.dgBottom=s>>12&15,n.icvLeft=s>>16&127,n.icvRight=s>>23&127,n.grbitDiag=s>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function u1(e,r,t){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=f1(e,r,a.fStyle,t),a}function al(e,r,t,a){var n=t&&t.biff==5;a||(a=X(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,r<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function d1(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function h1(e){var r=X(8);return r.write_shift(4,0),r.write_shift(2,e[0]?e[0]+1:0),r.write_shift(2,e[1]?e[1]+1:0),r}function nl(e,r,t){var a=Ar(e,6);(t.biff==2||r==9)&&++e.l;var n=gp(e,2);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function p1(e,r,t,a,n,i){var s=X(8);return _a(e,r,a,s),S0(t,i,s),s}function m1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=Ar(e,6),n=Dt(e,8);return a.val=n,a}function g1(e,r,t,a){var n=X(14);return _a(e,r,a,n),ya(t,n),n}var il=Tp;function x1(e,r,t){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=wa(e,i),o=[];a>e.l;)o.push(jn(e));return[i,n,s,o]}function sl(e,r,t){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return t.sbcch===14849&&(n=Ap(e,r-2,t)),i.body=n||e.read_shift(r-2),typeof n=="string"&&(i.Name=n),i}var v1=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ol(e,r,t){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=wa(e,s,t);n&32&&(l=v1[l.charCodeAt(0)]);var f=a-e.l;t&&t.biff==2&&--f;var d=a==e.l||o===0||!(f>0)?[]:Rv(e,f,t,o);return{chKey:i,Name:l,itab:c,rgce:d}}function P0(e,r,t){if(t.biff<8)return y1(e,r,t);for(var a=[],n=e.l+r,i=e.read_shift(t.biff>8?4:2);i--!==0;)a.push(Cp(e,t.biff>8?12:6,t));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function y1(e,r,t){e[e.l+1]==3&&e[e.l]++;var a=Un(e,r,t);return a.charCodeAt(0)==3?a.slice(1):a}function w1(e,r,t){if(t.biff<8){e.l+=r;return}var a=e.read_shift(2),n=e.read_shift(2),i=wa(e,a,t),s=wa(e,n,t);return[i,s]}function _1(e,r,t){var a=F0(e,6);e.l++;var n=e.read_shift(1);return r-=8,[Dv(e,r,t),n,a]}function cl(e,r,t){var a=Op(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,Iv(e,r,t,a)]}function k1(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,a=e.read_shift(4);return[r,t,a]}function E1(e,r,t){if(!(t.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Aa(e,0,t);return t.biff<8&&e.read_shift(1),[{r:a,c:n},o,s,i]}}function S1(e,r,t){return E1(e,r,t)}function b1(e,r){for(var t=[],a=e.read_shift(2);a--;)t.push(Mi(e,r));return t}function T1(e){var r=X(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)O0(e[t],r);return r}function C1(e,r,t){if(t&&t.biff<8)return O1(e,r,t);var a=I0(e,22),n=Rp(e,r-22,a[1]);return{cmo:a,ft:n}}var A1={8:function(e,r){var t=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=t,{fmt:a}}};function O1(e,r,t){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var s=[];return s.push((A1[a]||Bt)(e,r,t)),{cmo:[n,a,i],ft:s}}function F1(e,r,t){var a=e.l,n="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=yp(e,6,t);var o=e.read_shift(2);e.read_shift(2),mt(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],d=wa(e,e.lens[l+1]-e.lens[l]-1);if(n+=d,n.length>=(f?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+r,{t:n}}catch{return e.l=a+r,{t:n}}}function I1(e,r){var t=Mi(e,8);e.l+=16;var a=Ep(e,r-24);return[t,a]}function P1(e){var r=X(24),t=et(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)r.write_shift(1,parseInt(a[n],16));return Et([r,Sp(e[1])])}function R1(e,r){e.read_shift(2);var t=Mi(e,8),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(Nt,""),[t,a]}function D1(e){var r=e[1].Tooltip,t=X(10+2*(r.length+1));t.write_shift(2,2048);var a=et(e[0]);t.write_shift(2,a.r),t.write_shift(2,a.r),t.write_shift(2,a.c),t.write_shift(2,a.c);for(var n=0;n<r.length;++n)t.write_shift(2,r.charCodeAt(n));return t.write_shift(2,0),t}function N1(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=zc[t]||t,t=e.read_shift(2),r[1]=zc[t]||t,r}function L1(e){return e||(e=X(4)),e.write_shift(2,1),e.write_shift(2,1),e}function B1(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(C0(e,8));return t}function M1(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(C0(e,8));return t}function $1(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function R0(e,r,t){if(!t.cellStyles)return Bt(e,r);var a=t&&t.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:i,w:s,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function U1(e,r){var t=X(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var a=0;return e.hidden&&(a|=1),t.write_shift(1,a),a=e.level||0,t.write_shift(1,a),t.write_shift(2,0),t}function j1(e,r){var t={};return r<32||(e.l+=16,t.header=Dt(e,8),t.footer=Dt(e,8),e.l+=2),t}function H1(e,r,t){var a={area:!1};if(t.biff!=5)return e.l+=r,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function V1(e){for(var r=X(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var W1=Ar,G1=E0,z1=jn;function X1(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function Y1(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var a=Ar(e,6);++e.l;var n=Aa(e,r-7,t);return a.t="str",a.val=n,a}function q1(e){var r=Ar(e,6);++e.l;var t=Dt(e,8);return r.t="n",r.val=t,r}function K1(e,r,t){var a=X(15);return Gn(a,e,r),a.write_shift(8,t,"f"),a}function J1(e){var r=Ar(e,6);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function Z1(e,r,t){var a=X(9);return Gn(a,e,r),a.write_shift(2,t),a}function Q1(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function em(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function tm(e,r,t){var a=e.l+r,n=Ar(e,6),i=e.read_shift(2),s=wa(e,i,t);return e.l=a,n.t="str",n.val=s,n}var rm=[2,3,48,49,131,139,140,245],Ms=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Di({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],f=Zr(1);switch(c.type){case"base64":f=Jt(Qt(o));break;case"binary":f=Jt(o);break;case"buffer":case"array":f=o;break}Tt(f,0);var d=f.read_shift(1),u=!!(d&136),h=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,u=!0;break;case 49:h=!0,u=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,g=521;d==2&&(p=f.read_shift(2)),f.l+=3,d!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(g=f.read_shift(2));var v=f.read_shift(2),y=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var x=[],F={},I=Math.min(f.length,d==2?521:g-10-(h?264:0)),A=m?32:11;f.l<I&&f[f.l]!=13;)switch(F={},F.name=Ue.utils.decode(y,f.slice(f.l,f.l+A)).replace(/[\u0000\r\n].*$/g,""),f.l+=A,F.type=String.fromCharCode(f.read_shift(1)),d!=2&&!m&&(F.offset=f.read_shift(4)),F.len=f.read_shift(1),d==2&&(F.offset=f.read_shift(2)),F.dec=f.read_shift(1),F.name.length&&x.push(F),d!=2&&(f.l+=m?13:14),F.type){case"B":(!h||F.len!=8)&&c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var k=0,N=0;for(l[0]=[],N=0;N!=x.length;++N)l[0][N]=x[N].name;for(;p-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,l[++k]=[],N=0,N=0;N!=x.length;++N){var D=f.slice(f.l,f.l+x[N].len);f.l+=x[N].len,Tt(D,0);var M=Ue.utils.decode(y,D);switch(x[N].type){case"C":M.trim().length&&(l[k][N]=M.replace(/\s+$/,""));break;case"D":M.length===8?l[k][N]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):l[k][N]=M;break;case"F":l[k][N]=parseFloat(M.trim());break;case"+":case"I":l[k][N]=m?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":l[k][N]=!0;break;case"N":case"F":l[k][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));l[k][N]="##MEMO##"+(m?parseInt(M.trim(),10):D.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(l[k][N]=+M||0);break;case"@":l[k][N]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":l[k][N]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":l[k][N]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[k][N]=-D.read_shift(-8,"f");break;case"B":if(h&&x[N].len==8){l[k][N]=D.read_shift(8,"f");break}case"G":case"P":D.l+=x[N].len;break;case"0":if(x[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[N].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=x,l}function a(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Ja(t(o,l),l);return f["!cols"]=l.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete l.DBF,f}function n(o,c){try{return aa(a(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var l=c||{};if(+l.codepage>=0&&gr(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=zt(),d=Ii(o,{header:1,raw:!0,cellDates:!0}),u=d[0],h=d.slice(1),m=o["!cols"]||[],p=0,g=0,v=0,y=1;for(p=0;p<u.length;++p){if(((m[p]||{}).DBF||{}).name){u[p]=m[p].DBF.name,++v;continue}if(u[p]!=null){if(++v,typeof u[p]=="number"&&(u[p]=u[p].toString(10)),typeof u[p]!="string")throw new Error("DBF Invalid column name "+u[p]+" |"+typeof u[p]+"|");if(u.indexOf(u[p])!==p){for(g=0;g<1024;++g)if(u.indexOf(u[p]+"_"+g)==-1){u[p]+="_"+g;break}}}}var x=Be(o["!ref"]),F=[],I=[],A=[];for(p=0;p<=x.e.c-x.s.c;++p){var k="",N="",D=0,M=[];for(g=0;g<h.length;++g)h[g][p]!=null&&M.push(h[g][p]);if(M.length==0||u[p]==null){F[p]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=M[g]instanceof Date?"D":"C";break;default:N="C"}D=Math.max(D,String(M[g]).length),k=k&&k!=N?"C":N}D>250&&(D=250),N=((m[p]||{}).DBF||{}).type,N=="C"&&m[p].DBF.len>D&&(D=m[p].DBF.len),k=="B"&&N=="N"&&(k="N",A[p]=m[p].DBF.dec,D=m[p].DBF.len),I[p]=k=="C"||N=="N"?D:i[k]||0,y+=I[p],F[p]=k}var W=f.next(32);for(W.write_shift(4,318902576),W.write_shift(4,h.length),W.write_shift(2,296+32*v),W.write_shift(2,y),p=0;p<4;++p)W.write_shift(4,0);for(W.write_shift(4,0|(+r[Wa]||3)<<8),p=0,g=0;p<u.length;++p)if(u[p]!=null){var L=f.next(32),ee=(u[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,ee,"sbcs"),L.write_shift(1,F[p]=="?"?"C":F[p],"sbcs"),L.write_shift(4,g),L.write_shift(1,I[p]||i[F[p]]||0),L.write_shift(1,A[p]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),g+=I[p]||i[F[p]]||0}var de=f.next(264);for(de.write_shift(4,13),p=0;p<65;++p)de.write_shift(4,0);for(p=0;p<h.length;++p){var J=f.next(y);for(J.write_shift(1,0),g=0;g<u.length;++g)if(u[g]!=null)switch(F[g]){case"L":J.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":J.write_shift(8,h[p][g]||0,"f");break;case"N":var te="0";for(typeof h[p][g]=="number"&&(te=h[p][g].toFixed(A[g]||0)),v=0;v<I[g]-te.length;++v)J.write_shift(1,32);J.write_shift(1,te,"sbcs");break;case"D":h[p][g]?(J.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(h[p][g]!=null?h[p][g]:"").slice(0,I[g]);for(J.write_shift(1,ie,"sbcs"),v=0;v<I[g]-ie.length;++v)J.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:s}})(),D0=(function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+nt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(u,h){var m=e[h];return typeof m=="number"?yc(m):m},a=function(u,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?u:yc(p)};e["|"]=254;function n(u,h){switch(h.type){case"base64":return i(Qt(u),h);case"binary":return i(u,h);case"buffer":return i(Ae&&Buffer.isBuffer(u)?u.toString("binary"):ra(u),h);case"array":return i(va(u),h)}throw new Error("Unrecognized type "+h.type)}function i(u,h){var m=u.split(/[\n\r]+/),p=-1,g=-1,v=0,y=0,x=[],F=[],I=null,A={},k=[],N=[],D=[],M=0,W;for(+h.codepage>=0&&gr(+h.codepage);v!==m.length;++v){M=0;var L=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,t),ee=L.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),de=ee[0],J;if(L.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&F.push(L.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,ie=!1,ye=!1,re=!1,Z=-1,G=-1;for(y=1;y<ee.length;++y)switch(ee[y].charAt(0)){case"A":break;case"X":g=parseInt(ee[y].slice(1))-1,ie=!0;break;case"Y":for(p=parseInt(ee[y].slice(1))-1,ie||(g=0),W=x.length;W<=p;++W)x[W]=[];break;case"K":J=ee[y].slice(1),J.charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(vr(J))?isNaN(Ga(J).getDate())||(J=Ke(J)):(J=vr(J),I!==null&&Ya(I)&&(J=Li(J))),typeof Ue!="undefined"&&typeof J=="string"&&(h||{}).type!="string"&&(h||{}).codepage&&(J=Ue.utils.decode(h.codepage,J)),te=!0;break;case"E":re=!0;var C=Ha(ee[y].slice(1),{r:p,c:g});x[p][g]=[x[p][g],C];break;case"S":ye=!0,x[p][g]=[x[p][g],"S5S"];break;case"G":break;case"R":Z=parseInt(ee[y].slice(1))-1;break;case"C":G=parseInt(ee[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}if(te&&(x[p][g]&&x[p][g].length==2?x[p][g][0]=J:x[p][g]=J,I=null),ye){if(re)throw new Error("SYLK shared formula cannot have own formula");var B=Z>-1&&x[Z][G];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");x[p][g][1]=Z0(B[1],{r:p-Z,c:g-G})}break;case"F":var R=0;for(y=1;y<ee.length;++y)switch(ee[y].charAt(0)){case"X":g=parseInt(ee[y].slice(1))-1,++R;break;case"Y":for(p=parseInt(ee[y].slice(1))-1,W=x.length;W<=p;++W)x[W]=[];break;case"M":M=parseInt(ee[y].slice(1))/20;break;case"F":break;case"G":break;case"P":I=F[parseInt(ee[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=ee[y].slice(1).split(" "),W=parseInt(D[0],10);W<=parseInt(D[1],10);++W)M=parseInt(D[2],10),N[W-1]=M===0?{hidden:!0}:{wch:M},Qr(N[W-1]);break;case"C":g=parseInt(ee[y].slice(1))-1,N[g]||(N[g]={});break;case"R":p=parseInt(ee[y].slice(1))-1,k[p]||(k[p]={}),M>0?(k[p].hpt=M,k[p].hpx=Xa(M)):M===0&&(k[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}R<1&&(I=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}}return k.length>0&&(A["!rows"]=k),N.length>0&&(A["!cols"]=N),h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),[x,A]}function s(u,h){var m=n(u,h),p=m[0],g=m[1],v=Ja(p,h);return nt(g).forEach(function(y){v[y]=g[y]}),v}function o(u,h){return aa(s(u,h),h)}function c(u,h,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(u.t){case"n":g+=u.v||0,u.f&&!u.F&&(g+=";E"+ko(u.f,{r:m,c:p}));break;case"b":g+=u.v?"TRUE":"FALSE";break;case"e":g+=u.w||u.v;break;case"d":g+='"'+(u.w||u.v)+'"';break;case"s":g+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function l(u,h){h.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Rn(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Dn(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&u.push(g)})}function f(u,h){h.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*Nn(m.hpx)+";"),g.length>2&&u.push(g+"R"+(p+1))})}function d(u,h){var m=["ID;PWXL;N;E"],p=[],g=Be(u["!ref"]),v,y=Array.isArray(u),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),u["!cols"]&&l(m,u["!cols"]),u["!rows"]&&f(m,u["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var F=g.s.r;F<=g.e.r;++F)for(var I=g.s.c;I<=g.e.c;++I){var A=xe({r:F,c:I});v=y?(u[F]||[])[I]:u[A],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,u,F,I,h))}return m.join(x)+x+p.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:d}})(),N0=(function(){function e(i,s){switch(s.type){case"base64":return r(Qt(i),s);case"binary":return r(i,s);case"buffer":return r(Ae&&Buffer.isBuffer(i)?i.toString("binary"):ra(i),s);case"array":return r(va(i),s)}throw new Error("Unrecognized type "+s.type)}function r(i,s){for(var o=i.split(`
`),c=-1,l=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],l=0;continue}if(!(c<0)){var u=o[f].trim().split(","),h=u[0],m=u[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+h){case-1:if(p==="BOT"){d[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[c][l]=!0:p==="FALSE"?d[c][l]=!1:isNaN(vr(m))?isNaN(Ga(m).getDate())?d[c][l]=m:d[c][l]=Ke(m):d[c][l]=vr(m),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),dn&&p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function t(i,s){return Ja(e(i,s),s)}function a(i,s){return aa(t(i,s),s)}var n=(function(){var i=function(c,l,f,d,u){c.push(l),c.push(f+","+d),c.push('"'+u.replace(/"/g,'""')+'"')},s=function(c,l,f,d){c.push(l+","+f),c.push(l==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var l=[],f=Be(c["!ref"]),d,u=Array.isArray(c);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,f.e.r-f.s.r+1,""),i(l,"TUPLES",0,f.e.c-f.s.c+1,""),i(l,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){s(l,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var p=xe({r:h,c:m});if(d=u?(c[h]||[])[m]:c[p],!d){s(l,1,0,"");continue}switch(d.t){case"n":var g=dn?d.w:d.v;!g&&d.v!=null&&(g=d.v),g==null?dn&&d.f&&!d.F?s(l,1,0,"="+d.f):s(l,1,0,""):s(l,0,g,"V");break;case"b":s(l,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(l,1,0,!dn||isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=lr(d.z||ge[14],yt(Ke(d.v)))),dn?s(l,0,d.w,"V"):s(l,1,0,d.w);break;default:s(l,1,0,"")}}}s(l,-1,0,"EOD");var v=`\r
`,y=l.join(v);return y}})();return{to_workbook:a,to_sheet:t,from_sheet:n}})(),L0=(function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,u){for(var h=d.split(`
`),m=-1,p=-1,g=0,v=[];g!==h.length;++g){var y=h[g].trim().split(":");if(y[0]==="cell"){var x=et(y[1]);if(v.length<=x.r)for(m=v.length;m<=x.r;++m)v[m]||(v[m]=[]);switch(m=x.r,p=x.c,y[2]){case"t":v[m][p]=e(y[3]);break;case"v":v[m][p]=+y[3];break;case"vtf":var F=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][p]=!!+y[4];break;default:v[m][p]=+y[4];break}y[2]=="vtf"&&(v[m][p]=[v[m][p],F])}}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function a(d,u){return Ja(t(d,u),u)}function n(d,u){return aa(a(d,u),u)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(d){if(!d||!d["!ref"])return"";for(var u=[],h=[],m,p="",g=Xt(d["!ref"]),v=Array.isArray(d),y=g.s.r;y<=g.e.r;++y)for(var x=g.s.c;x<=g.e.c;++x)if(p=xe({r:y,c:x}),m=v?(d[y]||[])[x]:d[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(r(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=r(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=r(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var F=yt(Ke(m.v));h[2]="vtc",h[3]="nd",h[4]=""+F,h[5]=m.w||lr(m.z||ge[14],F);break;case"e":continue}u.push(h.join(":"))}return u.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function f(d){return[i,s,o,s,l(d),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}})(),za=(function(){function e(f,d,u,h,m){m.raw?d[u][h]=f:f===""||(f==="TRUE"?d[u][h]=!0:f==="FALSE"?d[u][h]=!1:isNaN(vr(f))?isNaN(Ga(f).getDate())?d[u][h]=f:d[u][h]=Ke(f):d[u][h]=vr(f))}function r(f,d){var u=d||{},h=[];if(!f||f.length===0)return h;for(var m=f.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,v=0,y=0;y<=p;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,g=Math.max(g,v);for(y=0;y<=p;++y){h[y]=[];var x=0;for(e(m[y].slice(0,g).trim(),h,y,x,u),x=1;x<=(m[y].length-g)/10+1;++x)e(m[y].slice(g+(x-1)*10,g+x*10).trim(),h,y,x,u)}return u.sheetRows&&(h=h.slice(0,u.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var d={},u=!1,h=0,m=0;h<f.length;++h)(m=f.charCodeAt(h))==34?u=!u:!u&&m in t&&(d[m]=(d[m]||0)+1);m=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h]);if(!m.length){d=a;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h])}return m.sort(function(p,g){return p[0]-g[0]||a[p[1]]-a[g[1]]}),t[m.pop()[1]]||44}function i(f,d){var u=d||{},h="";at!=null&&u.dense==null&&(u.dense=at);var m=u.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=n(f.slice(0,1024)):u&&u.FS?h=u.FS:h=n(f.slice(0,1024));var g=0,v=0,y=0,x=0,F=0,I=h.charCodeAt(0),A=!1,k=0,N=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var D=u.dateNF!=null?Hd(u.dateNF):null;function M(){var W=f.slice(x,F),L={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)L.t="z";else if(u.raw)L.t="s",L.v=W;else if(W.trim().length===0)L.t="s",L.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(L.t="s",L.v=W.slice(2,-1).replace(/""/g,'"')):xx(W)?(L.t="n",L.f=W.slice(1)):(L.t="s",L.v=W);else if(W=="TRUE")L.t="b",L.v=!0;else if(W=="FALSE")L.t="b",L.v=!1;else if(!isNaN(y=vr(W)))L.t="n",u.cellText!==!1&&(L.w=W),L.v=y;else if(!isNaN(Ga(W).getDate())||D&&W.match(D)){L.z=u.dateNF||ge[14];var ee=0;D&&W.match(D)&&(W=Vd(W,u.dateNF,W.match(D)||[]),ee=1),u.cellDates?(L.t="d",L.v=Ke(W,ee)):(L.t="n",L.v=yt(Ke(W,ee))),u.cellText!==!1&&(L.w=lr(L.z,L.v instanceof Date?yt(L.v):L.v)),u.cellNF||delete L.z}else L.t="s",L.v=W;if(L.t=="z"||(u.dense?(m[g]||(m[g]=[]),m[g][v]=L):m[xe({c:v,r:g})]=L),x=F+1,N=f.charCodeAt(x),p.e.c<v&&(p.e.c=v),p.e.r<g&&(p.e.r=g),k==I)++v;else if(v=0,++g,u.sheetRows&&u.sheetRows<=g)return!0}e:for(;F<f.length;++F)switch(k=f.charCodeAt(F)){case 34:N===34&&(A=!A);break;case I:case 10:case 13:if(!A&&M())break e;break;default:break}return F-x>0&&M(),m["!ref"]=Ee(p),m}function s(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,d):Ja(r(f,d),d)}function o(f,d){var u="",h=d.type=="string"?[0,0,0,0]:Fo(f,d);switch(d.type){case"base64":u=Qt(f);break;case"binary":u=f;break;case"buffer":d.codepage==65001?u=f.toString("utf8"):d.codepage&&typeof Ue!="undefined"?u=Ue.utils.decode(d.codepage,f):u=Ae&&Buffer.isBuffer(f)?f.toString("binary"):ra(f);break;case"array":u=va(f);break;case"string":u=f;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?u=ze(u.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?u=ze(u):d.type=="binary"&&typeof Ue!="undefined"&&d.codepage&&(u=Ue.utils.decode(d.codepage,Ue.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?L0.to_sheet(d.type=="string"?u:ze(u),d):s(u,d)}function c(f,d){return aa(o(f,d),d)}function l(f){for(var d=[],u=Be(f["!ref"]),h,m=Array.isArray(f),p=u.s.r;p<=u.e.r;++p){for(var g=[],v=u.s.c;v<=u.e.c;++v){var y=xe({r:p,c:v});if(h=m?(f[p]||[])[v]:f[y],!h||h.v==null){g.push("          ");continue}for(var x=(h.w||($r(h),h.w)||"").slice(0,10);x.length<10;)x+=" ";g.push(x+(v===0?" ":""))}d.push(g.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}})();function am(e,r){var t=r||{},a=!!t.WTF;t.WTF=!0;try{var n=D0.to_workbook(e,t);return t.WTF=a,n}catch(i){if(t.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return za.to_workbook(e,r)}}var ma=(function(){function e(C,B,R){if(C){Tt(C,C.l||0);for(var P=R.Enum||Z;C.l<C.length;){var z=C.read_shift(2),fe=P[z]||P[65535],ae=C.read_shift(2),ne=C.l+ae,q=fe.f&&fe.f(C,ae,R);if(C.l=ne,B(q,fe,z))return}}}function r(C,B){switch(B.type){case"base64":return t(Jt(Qt(C)),B);case"binary":return t(Jt(C),B);case"buffer":case"array":return t(C,B)}throw"Unsupported type "+B.type}function t(C,B){if(!C)return C;var R=B||{};at!=null&&R.dense==null&&(R.dense=at);var P=R.dense?[]:{},z="Sheet1",fe="",ae=0,ne={},q=[],ke=[],O={s:{r:0,c:0},e:{r:0,c:0}},je=R.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)R.Enum=Z,e(C,function(he,st,er){switch(er){case 0:R.vers=he,he>=4096&&(R.qpro=!0);break;case 6:O=he;break;case 204:he&&(fe=he);break;case 222:fe=he;break;case 15:case 51:R.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:er==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=R.dateNF||ge[14],R.cellDates&&(he[1].t="d",he[1].v=Li(he[1].v))),R.qpro&&he[3]>ae&&(P["!ref"]=Ee(O),ne[z]=P,q.push(z),P=R.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},ae=he[3],z=fe||"Sheet"+(ae+1),fe="");var wr=R.dense?(P[he[0].r]||[])[he[0].c]:P[xe(he[0])];if(wr){wr.t=he[1].t,wr.v=he[1].v,he[1].z!=null&&(wr.z=he[1].z),he[1].f!=null&&(wr.f=he[1].f);break}R.dense?(P[he[0].r]||(P[he[0].r]=[]),P[he[0].r][he[0].c]=he[1]):P[xe(he[0])]=he[1];break;default:}},R);else if(C[2]==26||C[2]==14)R.Enum=G,C[2]==14&&(R.qpro=!0,C.l=0),e(C,function(he,st,er){switch(er){case 204:z=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>ae&&(P["!ref"]=Ee(O),ne[z]=P,q.push(z),P=R.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},ae=he[3],z="Sheet"+(ae+1)),je>0&&he[0].r>=je)break;R.dense?(P[he[0].r]||(P[he[0].r]=[]),P[he[0].r][he[0].c]=he[1]):P[xe(he[0])]=he[1],O.e.c<he[0].c&&(O.e.c=he[0].c),O.e.r<he[0].r&&(O.e.r=he[0].r);break;case 27:he[14e3]&&(ke[he[14e3][0]]=he[14e3][1]);break;case 1537:ke[he[0]]=he[1],he[0]==ae&&(z=he[1]);break;default:break}},R);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(P["!ref"]=Ee(O),ne[fe||z]=P,q.push(fe||z),!ke.length)return{SheetNames:q,Sheets:ne};for(var Fe={},He=[],Ie=0;Ie<ke.length;++Ie)ne[q[Ie]]?(He.push(ke[Ie]||q[Ie]),Fe[ke[Ie]]=ne[ke[Ie]]||ne[q[Ie]]):(He.push(ke[Ie]),Fe[ke[Ie]]={"!ref":"A1"});return{SheetNames:He,Sheets:Fe}}function a(C,B){var R=B||{};if(+R.codepage>=0&&gr(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var P=zt(),z=Be(C["!ref"]),fe=Array.isArray(C),ae=[];oe(P,0,i(1030)),oe(P,6,c(z));for(var ne=Math.min(z.e.r,8191),q=z.s.r;q<=ne;++q)for(var ke=lt(q),O=z.s.c;O<=z.e.c;++O){q===z.s.r&&(ae[O]=Qe(O));var je=ae[O]+ke,Fe=fe?(C[q]||[])[O]:C[je];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?oe(P,13,h(q,O,Fe.v)):oe(P,14,p(q,O,Fe.v));else{var He=$r(Fe);oe(P,15,d(q,O,He.slice(0,239)))}}return oe(P,1),P.end()}function n(C,B){var R=B||{};if(+R.codepage>=0&&gr(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var P=zt();oe(P,0,s(C));for(var z=0,fe=0;z<C.SheetNames.length;++z)(C.Sheets[C.SheetNames[z]]||{})["!ref"]&&oe(P,27,re(C.SheetNames[z],fe++));var ae=0;for(z=0;z<C.SheetNames.length;++z){var ne=C.Sheets[C.SheetNames[z]];if(!(!ne||!ne["!ref"])){for(var q=Be(ne["!ref"]),ke=Array.isArray(ne),O=[],je=Math.min(q.e.r,8191),Fe=q.s.r;Fe<=je;++Fe)for(var He=lt(Fe),Ie=q.s.c;Ie<=q.e.c;++Ie){Fe===q.s.r&&(O[Ie]=Qe(Ie));var he=O[Ie]+He,st=ke?(ne[Fe]||[])[Ie]:ne[he];if(!(!st||st.t=="z"))if(st.t=="n")oe(P,23,M(Fe,Ie,ae,st.v));else{var er=$r(st);oe(P,22,k(Fe,Ie,ae,er.slice(0,239)))}}++ae}}return oe(P,1),P.end()}function i(C){var B=X(2);return B.write_shift(2,C),B}function s(C){var B=X(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var R=0,P=0,z=0,fe=0;fe<C.SheetNames.length;++fe){var ae=C.SheetNames[fe],ne=C.Sheets[ae];if(!(!ne||!ne["!ref"])){++z;var q=Xt(ne["!ref"]);R<q.e.r&&(R=q.e.r),P<q.e.c&&(P=q.e.c)}}return R>8191&&(R=8191),B.write_shift(2,R),B.write_shift(1,z),B.write_shift(1,P),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function o(C,B,R){var P={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&R.qpro?(P.s.c=C.read_shift(1),C.l++,P.s.r=C.read_shift(2),P.e.c=C.read_shift(1),C.l++,P.e.r=C.read_shift(2),P):(P.s.c=C.read_shift(2),P.s.r=C.read_shift(2),B==12&&R.qpro&&(C.l+=2),P.e.c=C.read_shift(2),P.e.r=C.read_shift(2),B==12&&R.qpro&&(C.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function c(C){var B=X(8);return B.write_shift(2,C.s.c),B.write_shift(2,C.s.r),B.write_shift(2,C.e.c),B.write_shift(2,C.e.r),B}function l(C,B,R){var P=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(P[0].c=C.read_shift(1),P[3]=C.read_shift(1),P[0].r=C.read_shift(2),C.l+=2):(P[2]=C.read_shift(1),P[0].c=C.read_shift(2),P[0].r=C.read_shift(2)),P}function f(C,B,R){var P=C.l+B,z=l(C,B,R);if(z[1].t="s",R.vers==20768){C.l++;var fe=C.read_shift(1);return z[1].v=C.read_shift(fe,"utf8"),z}return R.qpro&&C.l++,z[1].v=C.read_shift(P-C.l,"cstr"),z}function d(C,B,R){var P=X(7+R.length);P.write_shift(1,255),P.write_shift(2,B),P.write_shift(2,C),P.write_shift(1,39);for(var z=0;z<P.length;++z){var fe=R.charCodeAt(z);P.write_shift(1,fe>=128?95:fe)}return P.write_shift(1,0),P}function u(C,B,R){var P=l(C,B,R);return P[1].v=C.read_shift(2,"i"),P}function h(C,B,R){var P=X(7);return P.write_shift(1,255),P.write_shift(2,B),P.write_shift(2,C),P.write_shift(2,R,"i"),P}function m(C,B,R){var P=l(C,B,R);return P[1].v=C.read_shift(8,"f"),P}function p(C,B,R){var P=X(13);return P.write_shift(1,255),P.write_shift(2,B),P.write_shift(2,C),P.write_shift(8,R,"f"),P}function g(C,B,R){var P=C.l+B,z=l(C,B,R);if(z[1].v=C.read_shift(8,"f"),R.qpro)C.l=P;else{var fe=C.read_shift(2);F(C.slice(C.l,C.l+fe),z),C.l+=fe}return z}function v(C,B,R){var P=B&32768;return B&=-32769,B=(P?C:0)+(B>=8192?B-16384:B),(P?"":"$")+(R?Qe(B):lt(B))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(C,B){Tt(C,0);for(var R=[],P=0,z="",fe="",ae="",ne="";C.l<C.length;){var q=C[C.l++];switch(q){case 0:R.push(C.read_shift(8,"f"));break;case 1:fe=v(B[0].c,C.read_shift(2),!0),z=v(B[0].r,C.read_shift(2),!1),R.push(fe+z);break;case 2:{var ke=v(B[0].c,C.read_shift(2),!0),O=v(B[0].r,C.read_shift(2),!1);fe=v(B[0].c,C.read_shift(2),!0),z=v(B[0].r,C.read_shift(2),!1),R.push(ke+O+":"+fe+z)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(C.read_shift(2));break;case 6:{for(var je="";q=C[C.l++];)je+=String.fromCharCode(q);R.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:ne=R.pop(),ae=R.pop(),R.push(["AND","OR"][q-20]+"("+ae+","+ne+")");break;default:if(q<32&&x[q])ne=R.pop(),ae=R.pop(),R.push(ae+x[q]+ne);else if(y[q]){if(P=y[q][1],P==69&&(P=C[C.l++]),P>R.length){console.error("WK1 bad formula parse 0x"+q.toString(16)+":|"+R.join("|")+"|");return}var Fe=R.slice(-P);R.length-=P,R.push(y[q][0]+"("+Fe.join(",")+")")}else return q<=7?console.error("WK1 invalid opcode "+q.toString(16)):q<=24?console.error("WK1 unsupported op "+q.toString(16)):q<=30?console.error("WK1 invalid opcode "+q.toString(16)):q<=115?console.error("WK1 unsupported function opcode "+q.toString(16)):console.error("WK1 unrecognized opcode "+q.toString(16))}}R.length==1?B[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function I(C){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=C.read_shift(2),B[3]=C[C.l++],B[0].c=C[C.l++],B}function A(C,B){var R=I(C,B);return R[1].t="s",R[1].v=C.read_shift(B-4,"cstr"),R}function k(C,B,R,P){var z=X(6+P.length);z.write_shift(2,C),z.write_shift(1,R),z.write_shift(1,B),z.write_shift(1,39);for(var fe=0;fe<P.length;++fe){var ae=P.charCodeAt(fe);z.write_shift(1,ae>=128?95:ae)}return z.write_shift(1,0),z}function N(C,B){var R=I(C,B);R[1].v=C.read_shift(2);var P=R[1].v>>1;if(R[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return R[1].v=P,R}function D(C,B){var R=I(C,B),P=C.read_shift(4),z=C.read_shift(4),fe=C.read_shift(2);if(fe==65535)return P===0&&z===3221225472?(R[1].t="e",R[1].v=15):P===0&&z===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var ae=fe&32768;return fe=(fe&32767)-16446,R[1].v=(1-ae*2)*(z*Math.pow(2,fe+32)+P*Math.pow(2,fe)),R}function M(C,B,R,P){var z=X(14);if(z.write_shift(2,C),z.write_shift(1,R),z.write_shift(1,B),P==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var fe=0,ae=0,ne=0,q=0;return P<0&&(fe=1,P=-P),ae=Math.log2(P)|0,P/=Math.pow(2,ae-31),q=P>>>0,(q&2147483648)==0&&(P/=2,++ae,q=P>>>0),P-=q,q|=2147483648,q>>>=0,P*=Math.pow(2,32),ne=P>>>0,z.write_shift(4,ne),z.write_shift(4,q),ae+=16383+(fe?32768:0),z.write_shift(2,ae),z}function W(C,B){var R=D(C,14);return C.l+=B-14,R}function L(C,B){var R=I(C,B),P=C.read_shift(4);return R[1].v=P>>6,R}function ee(C,B){var R=I(C,B),P=C.read_shift(8,"f");return R[1].v=P,R}function de(C,B){var R=ee(C,14);return C.l+=B-10,R}function J(C,B){return C[C.l+B-1]==0?C.read_shift(B,"cstr"):""}function te(C,B){var R=C[C.l++];R>B-1&&(R=B-1);for(var P="";P.length<R;)P+=String.fromCharCode(C[C.l++]);return P}function ie(C,B,R){if(!(!R.qpro||B<21)){var P=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var z=C.read_shift(B-21,"cstr");return[P,z]}}function ye(C,B){for(var R={},P=C.l+B;C.l<P;){var z=C.read_shift(2);if(z==14e3){for(R[z]=[0,""],R[z][0]=C.read_shift(2);C[C.l];)R[z][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return R}function re(C,B){var R=X(5+C.length);R.write_shift(2,14e3),R.write_shift(2,B);for(var P=0;P<C.length;++P){var z=C.charCodeAt(P);R[R.l++]=z>127?95:z}return R[R.l++]=0,R}var Z={0:{n:"BOF",f:mt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:J},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ye},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:J},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}})();function nm(e){var r={},t=e.match(Mt),a=0,n=!1;if(t)for(;a!=t.length;++a){var i=ve(t[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;r.cp=Hs[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return r}var im=(function(){var e=An("t"),r=An("rPr");function t(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Le(s[1])},c=i.match(r);return c&&(o.s=nm(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(s){return s.replace(a,"").split(n).map(t).filter(function(o){return o.v})}})(),sm=(function(){var r=/(\r\n|\n)/g;function t(n,i,s){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),s.push("</b>")),n.i&&(i.push("<i>"),s.push("</i>")),n.strike&&(i.push("<s>"),s.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&t(n.s,i[0],i[2]),i[0].join("")+i[1].replace(r,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),om=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cm=/<(?:\w+:)?r>/,lm=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function xo(e,r){var t=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Le(ze(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ze(e),t&&(a.h=Zs(a.t))):e.match(cm)&&(a.r=ze(e),a.t=Le(ze((e.replace(lm,"").match(om)||[]).join("").replace(Mt,""))),t&&(a.h=sm(im(a.r)))),a):{t:""}}var fm=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,um=/<(?:\w+:)?(?:si|sstItem)>/g,dm=/<\/(?:\w+:)?(?:si|sstItem)>/;function hm(e,r){var t=[],a="";if(!e)return t;var n=e.match(fm);if(n){a=n[2].replace(um,"").split(dm);for(var i=0;i!=a.length;++i){var s=xo(a[i].trim(),r);s!=null&&(t[t.length]=s)}n=ve(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}var pm=/^\s|\s$|[\t\n\r]/;function B0(e,r){if(!r.bookSST)return"";var t=[ft];t[t.length]=se("sst",null,{xmlns:Ea[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(pm)&&(i+=' xml:space="preserve"'),i+=">"+Ge(n.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function mm(e){return[e.read_shift(4),e.read_shift(4)]}function gm(e,r){var t=[],a=!1;return jr(e,function(i,s,o){switch(o){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T,!a||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function xm(e,r){return r||(r=X(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var vm=Ah;function ym(e){var r=zt();K(r,159,xm(e));for(var t=0;t<e.length;++t)K(r,19,vm(e[t]));return K(r,160),r.end()}function M0(e){if(typeof Ue!="undefined")return Ue.utils.encode(Wa,e);for(var r=[],t=e.split(""),a=0;a<t.length;++a)r[a]=t[a].charCodeAt(0);return r}function Mr(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function wm(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Mr(e,4),r.U=Mr(e,4),r.W=Mr(e,4),r}function _m(e){for(var r=e.read_shift(4),t=e.l+r-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function km(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(_m(e));return r}function Em(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function Sm(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Mr(e,4),r.U=Mr(e,4),r.W=Mr(e,4),r}function bm(e){var r=Sm(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function $0(e,r){var t=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,a}function U0(e,r){var t={},a=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function Tm(e){var r=Mr(e);switch(r.Minor){case 2:return[r.Minor,Cm(e,r)];case 3:return[r.Minor,Am(e,r)];case 4:return[r.Minor,Om(e,r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Cm(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),a=$0(e,t),n=U0(e,e.length-e.l);return{t:"Std",h:a,v:n}}function Am(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Om(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),a={};return t.replace(Mt,function(i){var s=ve(i);switch(Cr(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){a[o]=s[o]});break;case"<dataIntegrity":a.encryptedHmacKey=s.encryptedHmacKey,a.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(s);break;default:throw s[0]}}),a}function Fm(e,r){var t={},a=t.EncryptionVersionInfo=Mr(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e.read_shift(4),r-=4;var n=e.read_shift(4);return r-=4,t.EncryptionHeader=$0(e,n),r-=n,t.EncryptionVerifier=U0(e,r),t}function Im(e){var r={},t=r.EncryptionVersionInfo=Mr(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function vo(e){var r=0,t,a=M0(e),n=a.length+1,i,s,o,c,l;for(t=Zr(n),t[0]=a.length,i=1;i!=n;++i)t[i]=a[i-1];for(i=n-1;i>=0;--i)s=t[i],o=(r&16384)===0?0:1,c=r<<1&32767,l=o|c,r=l^s;return r^52811}var j0=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(s){return(s/2|s*128)&255},n=function(s,o){return a(s^o)},i=function(s){for(var o=r[s.length-1],c=104,l=s.length-1;l>=0;--l)for(var f=s[l],d=0;d!=7;++d)f&64&&(o^=t[c]),f*=2,--c;return o};return function(s){for(var o=M0(s),c=i(o),l=o.length,f=Zr(16),d=0;d!=16;++d)f[d]=0;var u,h,m;for((l&1)===1&&(u=c>>8,f[l]=n(e[0],u),--l,u=c&255,h=o[o.length-1],f[l]=n(h,u));l>0;)--l,u=c>>8,f[l]=n(o[l],u),--l,u=c&255,f[l]=n(o[l],u);for(l=15,m=15-o.length;m>0;)u=c>>8,f[l]=n(e[m],u),--l,--m,u=c&255,f[l]=n(o[l],u),--l,--m;return f}})(),Pm=function(e,r,t,a,n){n||(n=r),a||(a=j0(e));var i,s;for(i=0;i!=r.length;++i)s=r[i],s^=a[t],s=(s>>5|s<<3)&255,n[i]=s,++t;return[n,t,a]},Rm=function(e){var r=0,t=j0(e);return function(a){var n=Pm("",a,r,t);return r=n[1],n[0]}};function Dm(e,r,t,a){var n={key:mt(e),verificationBytes:mt(e)};return t.password&&(n.verifier=vo(t.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Rm(t.password)),n}function Nm(e,r,t){var a=t||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Im(e,r):a.Data=Fm(e,r),a}function Lm(e,r,t){var a={Type:t.biff>=8?e.read_shift(2):0};return a.Type?Nm(e,r-2,a):Dm(e,t.biff>=8?r:r-2,t,a),a}var H0=(function(){function e(n,i){switch(i.type){case"base64":return r(Qt(n),i);case"binary":return r(n,i);case"buffer":return r(Ae&&Buffer.isBuffer(n)?n.toString("binary"):ra(n),i);case"array":return r(va(n),i)}throw new Error("Unrecognized type "+i.type)}function r(n,i){var s=i||{},o=s.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var u=/\\\w+\b/g,h=0,m,p=-1;m=u.exec(f);){switch(m[0]){case"\\cell":var g=f.slice(h,u.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[d][p]=v:o[xe({r:d,c:p})]=v}break}h=u.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=Ee(l),o}function t(n,i){return aa(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],s=Be(n["!ref"]),o,c=Array.isArray(n),l=s.s.r;l<=s.e.r;++l){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var d=xe({r:l,c:f});o=c?(n[l]||[])[f]:n[d],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||($r(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:a}})();function Bm(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Pn(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Mm(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255,n=Math.max(r,t,a),i=Math.min(r,t,a),s=n-i;if(s===0)return[0,0,r];var o=0,c=0,l=n+i;switch(c=s/(l>1?2-l:l),n){case r:o=((t-a)/s+6)%6;break;case t:o=(a-r)/s+2;break;case a:o=(r-t)/s+4;break}return[o/6,c,l/2]}function $m(e){var r=e[0],t=e[1],a=e[2],n=t*2*(a<.5?a:1-a),i=a-n/2,s=[i,i,i],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=n*o,s[0]+=n,s[1]+=c;break;case 1:c=n*(2-o),s[0]+=c,s[1]+=n;break;case 2:c=n*(o-2),s[1]+=n,s[2]+=c;break;case 3:c=n*(4-o),s[1]+=c,s[2]+=n;break;case 4:c=n*(o-4),s[2]+=n,s[0]+=c;break;case 5:c=n*(6-o),s[2]+=c,s[0]+=n;break}for(var l=0;l!=3;++l)s[l]=Math.round(s[l]*255);return s}function Ai(e,r){if(r===0)return e;var t=Mm(Bm(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Pn($m(t))}var V0=6,Um=15,jm=1,Rt=V0;function Rn(e){return Math.floor((e+Math.round(128/Rt)/256)*Rt)}function Dn(e){return Math.floor((e-5)/Rt*100+.5)/100}function Oi(e){return Math.round((e*Rt+5)/Rt*256)/256}function _s(e){return Oi(Dn(Rn(e)))}function yo(e){var r=Math.abs(e-_s(e)),t=Rt;if(r>.005)for(Rt=jm;Rt<Um;++Rt)Math.abs(e-_s(e))<=r&&(r=Math.abs(e-_s(e)),t=Rt);Rt=t}function Qr(e){e.width?(e.wpx=Rn(e.width),e.wch=Dn(e.wpx),e.MDW=Rt):e.wpx?(e.wch=Dn(e.wpx),e.width=Oi(e.wch),e.MDW=Rt):typeof e.wch=="number"&&(e.width=Oi(e.wch),e.wpx=Rn(e.width),e.MDW=Rt),e.customWidth&&delete e.customWidth}var Hm=96,W0=Hm;function Nn(e){return e*96/W0}function Xa(e){return e*W0/96}var Vm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Wm(e,r,t,a){r.Borders=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ve(s);switch(Cr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=qe(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=qe(o.diagonalDown)),r.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Gm(e,r,t,a){r.Fills=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ve(s);switch(Cr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function zm(e,r,t,a){r.Fonts=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ve(s);switch(Cr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=ze(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?qe(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?qe(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?qe(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?qe(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?qe(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?qe(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?qe(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Hs[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=qe(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=ha[n.color.index];n.color.index==81&&(c=ha[1]),c||(c=ha[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=Ai(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Xm(e,r,t){r.NumberFmt=[];for(var a=nt(ge),n=0;n<a.length;++n)r.NumberFmt[a[n]]=ge[a[n]];var i=e[0].match(Mt);if(i)for(n=0;n<i.length;++n){var s=ve(i[n]);switch(Cr(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Le(ze(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}Br(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function Ym(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var a=t[0];a<=t[1];++a)e[a]!=null&&(r[r.length]=se("numFmt",null,{numFmtId:a,formatCode:Ge(e[a])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=se("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var mi=["numFmtId","fillId","fontId","borderId","xfId"],gi=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qm(e,r,t){r.CellXf=[];var a,n=!1;(e[0].match(Mt)||[]).forEach(function(i){var s=ve(i),o=0;switch(Cr(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=s,delete a[0],o=0;o<mi.length;++o)a[mi[o]]&&(a[mi[o]]=parseInt(a[mi[o]],10));for(o=0;o<gi.length;++o)a[gi[o]]&&(a[gi[o]]=qe(a[gi[o]]));if(r.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[o]){a.numFmtId=o;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=qe(s.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function Km(e){var r=[];return r[r.length]=se("cellXfs",null),e.forEach(function(t){r[r.length]=se("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=se("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Jm=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(r))&&Xm(d,f,l),(d=o.match(n))&&zm(d,f,c,l),(d=o.match(a))&&Gm(d,f,c,l),(d=o.match(i))&&Wm(d,f,c,l),(d=o.match(t))&&qm(d,f,l),f}})();function G0(e,r){var t=[ft,se("styleSheet",null,{xmlns:Ea[0],"xmlns:vt":vt.vt})],a;return e.SSF&&(a=Ym(e.SSF))!=null&&(t[t.length]=a),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Km(r.cellXfs))&&(t[t.length]=a),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Zm(e,r){var t=e.read_shift(2),a=Lt(e,r-2);return[t,a]}function Qm(e,r,t){t||(t=X(6+4*r.length)),t.write_shift(2,e),St(r,t);var a=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),a}function eg(e,r,t){var a={};a.sz=e.read_shift(2)/20;var n=Nh(e,2,t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(a.underline=s);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=Dh(e,8),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Lt(e,r-21),a}function tg(e,r){r||(r=X(153)),r.write_shift(2,e.sz*20),Lh(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),bi(e.color,r);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),r.write_shift(1,a),St(e.name,r),r.length>r.l?r.slice(0,r.l):r}var rg=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ks,ag=Bt;function ll(e,r){r||(r=X(84)),ks||(ks=Di(rg));var t=ks[e.patternType];t==null&&(t=40),r.write_shift(4,t);var a=0;if(t!=40)for(bi({auto:1},r),bi({auto:1},r);a<12;++a)r.write_shift(4,0);else{for(;a<4;++a)r.write_shift(4,0);for(;a<12;++a)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function ng(e,r){var t=e.l+r,a=e.read_shift(2),n=e.read_shift(2);return e.l=t,{ixfe:a,numFmtId:n}}function z0(e,r,t){t||(t=X(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var a=0;return t.write_shift(1,a),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function hn(e,r){return r||(r=X(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var ig=Bt;function sg(e,r){return r||(r=X(51)),r.write_shift(1,0),hn(null,r),hn(null,r),hn(null,r),hn(null,r),hn(null,r),r.length>r.l?r.slice(0,r.l):r}function og(e,r){return r||(r=X(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,+e.builtinId),r.write_shift(1,0),Si(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function cg(e,r,t){var a=X(2052);return a.write_shift(4,e),Si(r,a),Si(t,a),a.length>a.l?a.slice(0,a.l):a}function lg(e,r,t){var a={};a.NumberFmt=[];for(var n in ge)a.NumberFmt[n]=ge[n];a.CellXf=[],a.Fonts=[];var i=[],s=!1;return jr(e,function(c,l,f){switch(f){case 44:a.NumberFmt[c[0]]=c[1],Br(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Ai(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(l.T>0)i.push(f);else if(l.T<0)i.pop();else if(!s||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}function fg(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&++t}),t!=0&&(K(e,615,yr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&K(e,44,Qm(n,r[n]))}),K(e,616))}}function ug(e){var r=1;r!=0&&(K(e,611,yr(r)),K(e,43,tg({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),K(e,612))}function dg(e){var r=2;r!=0&&(K(e,603,yr(r)),K(e,45,ll({patternType:"none"})),K(e,45,ll({patternType:"gray125"})),K(e,604))}function hg(e){var r=1;r!=0&&(K(e,613,yr(r)),K(e,46,sg({})),K(e,614))}function pg(e){var r=1;K(e,626,yr(r)),K(e,47,z0({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),K(e,627)}function mg(e,r){K(e,617,yr(r.length)),r.forEach(function(t){K(e,47,z0(t,0))}),K(e,618)}function gg(e){var r=1;K(e,619,yr(r)),K(e,48,og({xfId:0,builtinId:0,name:"Normal"})),K(e,620)}function xg(e){var r=0;K(e,505,yr(r)),K(e,506)}function vg(e){var r=0;K(e,508,cg(r,"TableStyleMedium9","PivotStyleMedium4")),K(e,509)}function yg(e,r){var t=zt();return K(t,278),fg(t,e.SSF),ug(t,e),dg(t,e),hg(t,e),pg(t,e),mg(t,r.cellXfs),gg(t,e),xg(t,e),vg(t,e),K(t,279),t.end()}var wg=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function _g(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(Mt)||[]).forEach(function(n){var i=ve(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(r.themeElements.clrScheme[wg.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function kg(){}function Eg(){}var Sg=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,bg=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Tg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Cg(e,r,t){r.themeElements={};var a;[["clrScheme",Sg,_g],["fontScheme",bg,kg],["fmtScheme",Tg,Eg]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,t)})}var Ag=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function X0(e,r){(!e||e.length===0)&&(e=wo());var t,a={};if(!(t=e.match(Ag)))throw new Error("themeElements not found in theme");return Cg(t[0],a,r),a.raw=e,a}function wo(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[ft];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Og(e,r,t){var a=e.l+r,n=e.read_shift(4);if(n!==124226){if(!t.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var s;try{s=Wl(i,{type:"array"})}catch{return}var o=Zt(s,"theme/theme/theme1.xml",!0);if(o)return X0(o,t)}}function Fg(e){return e.read_shift(4)}function Ig(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Pg(e,4);break;case 2:r.xclrValue=T0(e,4);break;case 3:r.xclrValue=Fg(e,4);break;case 4:e.l+=4;break}return e.l+=8,r}function Pg(e,r){return Bt(e,r)}function Rg(e,r){return Bt(e,r)}function Dg(e){var r=e.read_shift(2),t=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Ig(e,t);break;case 6:a[1]=Rg(e,t);break;case 14:case 15:a[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return a}function Ng(e,r){var t=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(Dg(e,t-e.l));return{ixfe:a,ext:i}}function Lg(e,r){r.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function Bg(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Lt(e,r-8)}}function Mg(e){var r=X(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),St(e.name,r),r.slice(0,r.l)}function $g(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Ug(e){var r=X(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function jg(e,r){var t=X(8+2*r.length);return t.write_shift(4,e),St(r,t),t.slice(0,t.l)}function Hg(e){return e.l+=4,e.read_shift(4)!=0}function Vg(e,r){var t=X(8);return t.write_shift(4,e),t.write_shift(4,r?1:0),t}function Wg(e,r,t){var a={Types:[],Cell:[],Value:[]},n=t||{},i=[],s=!1,o=2;return jr(e,function(c,l,f){switch(f){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?a.Cell.push({type:a.Types[d[0]-1].name,index:d[1]}):o==0&&a.Value.push({type:a.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!l.T){if(!s||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function Gg(){var e=zt();return K(e,332),K(e,334,yr(1)),K(e,335,Mg({name:"XLDAPR",version:12e4,flags:3496657072})),K(e,336),K(e,339,jg(1,"XLDAPR")),K(e,52),K(e,35,yr(514)),K(e,4096,yr(0)),K(e,4097,or(1)),K(e,36),K(e,53),K(e,340),K(e,337,Vg(1,!0)),K(e,51,Ug([[1,0]])),K(e,338),K(e,333),e.end()}function zg(e,r,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,s;return e.replace(Mt,function(o){var c=ve(o);switch(Cr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==c.name&&(s=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function Y0(){var e=[ft];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Xg(e){var r=[];if(!e)return r;var t=1;return(e.match(Mt)||[]).forEach(function(a){var n=ve(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,r.push(n);break}}),r}function Yg(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=xe(t);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function qg(e,r,t){var a=[],n=!1;return jr(e,function(s,o,c){switch(c){case 63:a.push(s);break;default:if(!o.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),a}function Kg(e,r,t,a){if(!e)return e;var n=a||{},i=!1,s=!1;jr(e,function(c,l,f){if(!s)switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},n)}function Jg(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var $a=1024;function q0(e,r){for(var t=[21600,21600],a=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),n=[se("xml",null,{"xmlns:v":Kt.v,"xmlns:o":Kt.o,"xmlns:x":Kt.x,"xmlns:mv":Kt.mv}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:a})];$a<e*1e3;)$a+=1e3;return r.forEach(function(i){var s=et(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=se("v:fill",c,o),f={on:"t",obscured:"t"};++$a,n=n.concat(["<v:shape"+On({id:"_x0000_s"+$a,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,se("v:shadow",null,f),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ct("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Ct("x:AutoFill","False"),Ct("x:Row",String(s.r)),Ct("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function fl(e,r,t,a){var n=Array.isArray(e),i;r.forEach(function(s){var o=et(s.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[s.ref]=i;var c=Be(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ee(c);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:t};s.h&&(f.h=s.h);for(var d=i.c.length-1;d>=0;--d){if(!t&&i.c[d].T)return;t&&!i.c[d].T&&i.c.splice(d,1)}if(t&&a){for(d=0;d<a.length;++d)if(f.a==a[d].id){f.a=a[d].name||f.a;break}}i.c.push(f)})}function Zg(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=ve(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=et(c.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var d=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),u=!!d&&!!d[1]&&xo(d[1])||{r:"",t:"",h:""};l.r=u.r,u.r=="<t></t>"&&(u.t=u.h=""),l.t=(u.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=u.h),a.push(l)}}}}),a}function K0(e){var r=[ft,se("comments",null,{xmlns:Ea[0]})],t=[];return r.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=Ge(n.a);t.indexOf(i)==-1&&(t.push(i),r.push("<author>"+i+"</author>")),n.T&&n.ID&&t.indexOf("tc="+n.ID)==-1&&(t.push("tc="+n.ID),r.push("<author>tc="+n.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=t.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=t.indexOf(Ge(c.a))),i.push(c.t||"")}),r.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)r.push(Ct("t",Ge(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;r.push(Ct("t",Ge(s)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Qg(e,r){var t=[],a=!1,n={},i=0;return e.replace(Mt,function(o,c){var l=ve(o);switch(Cr(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function ex(e,r,t){var a=[ft,se("ThreadedComments",null,{xmlns:vt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&r.indexOf(s.a)==-1&&r.push(s.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(s.a)).slice(-12)+"}"),a.push(se("threadedComment",Ct("text",s.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function tx(e,r){var t=[],a=!1;return e.replace(Mt,function(i){var s=ve(i);switch(Cr(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),t}function rx(e){var r=[ft,se("personList",null,{xmlns:vt.TCMNT,"xmlns:x":Ea[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,a){r.push(se("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function ax(e){var r={};r.iauthor=e.read_shift(4);var t=Ca(e,16);return r.rfx=t.s,r.ref=xe(t.s),e.l+=16,r}function nx(e,r){return r==null&&(r=X(36)),r.write_shift(4,e[1].iauthor),Za(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var ix=Lt;function sx(e){return St(e.slice(0,54))}function ox(e,r){var t=[],a=[],n={},i=!1;return jr(e,function(o,c,l){switch(l){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}function cx(e){var r=zt(),t=[];return K(r,628),K(r,630),e.forEach(function(a){a[1].forEach(function(n){t.indexOf(n.a)>-1||(t.push(n.a.slice(0,54)),K(r,632,sx(n.a)))})}),K(r,631),K(r,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=t.indexOf(n.a);var i={s:et(a[0]),e:et(a[0])};K(r,635,nx([i,n])),n.t&&n.t.length>0&&K(r,637,Fh(n)),K(r,636),delete n.iauthor})}),K(r,634),K(r,629),r.end()}var lx="application/vnd.ms-office.vbaProject";function fx(e){var r=me.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,a){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");me.utils.cfb_add(r,n,e.FileIndex[a].content)}}),me.write(r)}function ux(e,r){r.FullPaths.forEach(function(t,a){if(a!=0){var n=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&me.utils.cfb_add(e,n,r.FileIndex[a].content)}})}var J0=["xlsb","xlsm","xlam","biff8","xla"];function dx(){return{"!type":"dialog"}}function hx(){return{"!type":"dialog"}}function px(){return{"!type":"macro"}}function mx(){return{"!type":"macro"}}var Ha=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(a,n,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=r.c:--f,c?l+=r.r:--l,n+(o?"":"$")+Qe(f)+(c?"":"$")+lt(l)}return function(n,i){return r=i,n.replace(e,t)}})(),_o=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ko=(function(){return function(r,t){return r.replace(_o,function(a,n,i,s,o,c){var l=oo(s)-(i?0:t.c),f=so(c)-(o?0:t.r),d=f==0?"":o?f+1:"["+f+"]",u=l==0?"":i?l+1:"["+l+"]";return n+"R"+d+"C"+u})}})();function Z0(e,r){return e.replace(_o,function(t,a,n,i,s,o){return a+(n=="$"?n+i:Qe(oo(i)+r.c))+(s=="$"?s+o:lt(so(o)+r.r))})}function gx(e,r,t){var a=Xt(r),n=a.s,i=et(t),s={r:i.r-n.r,c:i.c-n.c};return Z0(e,s)}function xx(e){return e.length!=1}function ul(e){return e.replace(/_xlfn\./g,"")}function ht(e){e.l+=1}function ea(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function Q0(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return ef(e,r,t);t.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),s=ea(e,2),o=ea(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function ef(e){var r=ea(e,2),t=ea(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function vx(e,r,t){if(t.biff<8)return ef(e,r,t);var a=e.read_shift(t.biff==12?4:2),n=e.read_shift(t.biff==12?4:2),i=ea(e,2),s=ea(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}function tf(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return yx(e,r,t);var a=e.read_shift(t&&t.biff==12?4:2),n=ea(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function yx(e){var r=ea(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function wx(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function _x(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return kx(e,r,t);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:s,rRel:o}}function kx(e){var r=e.read_shift(2),t=e.read_shift(1),a=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),n==1&&t>=128&&(t=t-256),{r,c:t,cRel:n,rRel:a}}function Ex(e,r,t){var a=(e[e.l++]&96)>>5,n=Q0(e,t.biff>=2&&t.biff<=5?6:8,t);return[a,n]}function Sx(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=Q0(e,i,t);return[a,n,s]}function bx(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function Tx(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function Cx(e,r,t){var a=(e[e.l++]&96)>>5,n=vx(e,r-1,t);return[a,n]}function Ax(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[a]}function dl(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Ox(e,r,t){e.l+=2;for(var a=e.read_shift(t&&t.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(t&&t.biff==2?1:2));return n}function Fx(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Ix(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Px(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Rx(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[a]}function rf(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Dx(e){return e.read_shift(2),rf(e,2)}function Nx(e){return e.read_shift(2),rf(e,2)}function Lx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=tf(e,0,t);return[a,n]}function Bx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=_x(e,0,t);return[a,n]}function Mx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=tf(e,0,t);return[a,n,i]}function $x(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(t&&t.biff<=3?1:2);return[Hv[n],sf[n],a]}function Ux(e,r,t){var a=e[e.l++],n=e.read_shift(1),i=t&&t.biff<=3?[a==88?-1:0,e.read_shift(1)]:jx(e);return[n,(i[0]===0?sf:jv)[i[1]]]}function jx(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hx(e,r,t){e.l+=t&&t.biff==2?3:4}function Vx(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function Wx(e){return e.l++,Hr[e.read_shift(1)]}function Gx(e){return e.l++,e.read_shift(2)}function zx(e){return e.l++,e.read_shift(1)!==0}function Xx(e){return e.l++,Dt(e,8)}function Yx(e,r,t){return e.l++,Un(e,r-1,t)}function qx(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=ct(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Hr[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Dt(e,8);break;case 2:t[1]=Aa(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Kx(e,r,t){for(var a=e.read_shift(t.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((t.biff==12?Ca:Mi)(e,8));return n}function Jx(e,r,t){var a=0,n=0;t.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--n==0&&(n=256));for(var i=0,s=[];i!=a&&(s[i]=[]);++i)for(var o=0;o!=n;++o)s[i][o]=qx(e,t.biff);return s}function Zx(e,r,t){var a=e.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,i=e.read_shift(n);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function Qx(e,r,t){if(t.biff==5)return ev(e,r,t);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function ev(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,t,a]}function tv(e,r,t){var a=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function rv(e,r,t){var a=e.read_shift(1)>>>5&3,n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function av(e,r,t){var a=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[a]}function nv(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var iv=Bt,sv=Bt,ov=Bt;function Hn(e,r,t){return e.l+=2,[wx(e,4,t)]}function Eo(e){return e.l+=6,[]}var cv=Hn,lv=Eo,fv=Eo,uv=Hn;function af(e){return e.l+=2,[mt(e),e.read_shift(2)&1]}var dv=Hn,hv=af,pv=Eo,mv=Hn,gv=Hn,xv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vv(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),s=xv[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:a,c:n,C:i}}function yv(e){return e.l+=2,[e.read_shift(4)]}function wv(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function _v(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function kv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Ev(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Sv(e){return e.l+=4,[0,0]}var hl={1:{n:"PtgExp",f:Vx},2:{n:"PtgTbl",f:ov},3:{n:"PtgAdd",f:ht},4:{n:"PtgSub",f:ht},5:{n:"PtgMul",f:ht},6:{n:"PtgDiv",f:ht},7:{n:"PtgPower",f:ht},8:{n:"PtgConcat",f:ht},9:{n:"PtgLt",f:ht},10:{n:"PtgLe",f:ht},11:{n:"PtgEq",f:ht},12:{n:"PtgGe",f:ht},13:{n:"PtgGt",f:ht},14:{n:"PtgNe",f:ht},15:{n:"PtgIsect",f:ht},16:{n:"PtgUnion",f:ht},17:{n:"PtgRange",f:ht},18:{n:"PtgUplus",f:ht},19:{n:"PtgUminus",f:ht},20:{n:"PtgPercent",f:ht},21:{n:"PtgParen",f:ht},22:{n:"PtgMissArg",f:ht},23:{n:"PtgStr",f:Yx},26:{n:"PtgSheet",f:wv},27:{n:"PtgEndSheet",f:_v},28:{n:"PtgErr",f:Wx},29:{n:"PtgBool",f:zx},30:{n:"PtgInt",f:Gx},31:{n:"PtgNum",f:Xx},32:{n:"PtgArray",f:Ax},33:{n:"PtgFunc",f:$x},34:{n:"PtgFuncVar",f:Ux},35:{n:"PtgName",f:Zx},36:{n:"PtgRef",f:Lx},37:{n:"PtgArea",f:Ex},38:{n:"PtgMemArea",f:tv},39:{n:"PtgMemErr",f:iv},40:{n:"PtgMemNoMem",f:sv},41:{n:"PtgMemFunc",f:rv},42:{n:"PtgRefErr",f:av},43:{n:"PtgAreaErr",f:bx},44:{n:"PtgRefN",f:Bx},45:{n:"PtgAreaN",f:Cx},46:{n:"PtgMemAreaN",f:kv},47:{n:"PtgMemNoMemN",f:Ev},57:{n:"PtgNameX",f:Qx},58:{n:"PtgRef3d",f:Mx},59:{n:"PtgArea3d",f:Sx},60:{n:"PtgRefErr3d",f:nv},61:{n:"PtgAreaErr3d",f:Tx},255:{}},bv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Tv={1:{n:"PtgElfLel",f:af},2:{n:"PtgElfRw",f:mv},3:{n:"PtgElfCol",f:cv},6:{n:"PtgElfRwV",f:gv},7:{n:"PtgElfColV",f:uv},10:{n:"PtgElfRadical",f:dv},11:{n:"PtgElfRadicalS",f:pv},13:{n:"PtgElfColS",f:lv},15:{n:"PtgElfColSV",f:fv},16:{n:"PtgElfRadicalLel",f:hv},25:{n:"PtgList",f:vv},29:{n:"PtgSxName",f:yv},255:{}},Cv={0:{n:"PtgAttrNoop",f:Sv},1:{n:"PtgAttrSemi",f:Rx},2:{n:"PtgAttrIf",f:Ix},4:{n:"PtgAttrChoose",f:Ox},8:{n:"PtgAttrGoto",f:Fx},16:{n:"PtgAttrSum",f:Hx},32:{n:"PtgAttrBaxcel",f:dl},33:{n:"PtgAttrBaxcel",f:dl},64:{n:"PtgAttrSpace",f:Dx},65:{n:"PtgAttrSpaceSemi",f:Nx},128:{n:"PtgAttrIfError",f:Px},255:{}};function Vn(e,r,t,a){if(a.biff<8)return Bt(e,r);for(var n=e.l+r,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=Jx(e,0,a),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=Kx(e,t[s][1],a),i.push(t[s][2]);break;case"PtgExp":a&&a.biff==12&&(t[s][1][1]=e.read_shift(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0];default:break}return r=n-e.l,r!==0&&i.push(Bt(e,r)),i}function Wn(e,r,t){for(var a=e.l+r,n,i,s=[];a!=e.l;)r=a-e.l,i=e[e.l],n=hl[i]||hl[bv[i]],(i===24||i===25)&&(n=(i===24?Tv:Cv)[e[e.l+1]]),!n||!n.f?Bt(e,r):s.push([n.n,n.f(e,r,t)]);return s}function Av(e){for(var r=[],t=0;t<e.length;++t){for(var a=e[t],n=[],i=0;i<a.length;++i){var s=a[i];if(s)switch(s[0]){case 2:n.push('"'+s[1].replace(/"/g,'""')+'"');break;default:n.push(s[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var Ov={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fv(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function nf(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(t.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function pl(e,r,t){var a=nf(e,r,t);return a=="#REF"?a:Fv(a,t)}function Pt(e,r,t,a,n){var i=n&&n.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,f,d=0,u=0,h,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,y=e[0].length;v<y;++v){var x=e[0][v];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=tt(" ",e[0][p][1][1]);break;case 1:g=tt("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+g,p=-1}o.push(l+Ov[x[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=vn(x[1][1],s,n),o.push(yn(f,i));break;case"PtgRefN":f=t?vn(x[1][1],t,n):x[1][1],o.push(yn(f,i));break;case"PtgRef3d":d=x[1][1],f=vn(x[1][2],s,n),m=pl(a,d,n);var F=m;o.push(m+"!"+yn(f,i));break;case"PtgFunc":case"PtgFuncVar":var I=x[1][0],A=x[1][1];I||(I=0),I&=127;var k=I==0?[]:o.slice(-I);o.length-=I,A==="User"&&(A=k.shift()),o.push(A+"("+k.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":h=Vc(x[1][1],t?{s:t}:s,n),o.push(vs(h,n));break;case"PtgArea":h=Vc(x[1][1],s,n),o.push(vs(h,n));break;case"PtgArea3d":d=x[1][1],h=x[1][2],m=pl(a,d,n),o.push(m+"!"+vs(h,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=x[1][2];var N=(a.names||[])[u-1]||(a[0]||[])[u],D=N?N.Name:"SH33TJSNAME"+String(u);D&&D.slice(0,6)=="_xlfn."&&!n.xlfn&&(D=D.slice(6)),o.push(D);break;case"PtgNameX":var M=x[1][1];u=x[1][2];var W;if(n.biff<=5)M<0&&(M=-M),a[M]&&(W=a[M][u]);else{var L="";if(((a[M]||[])[0]||[])[0]==14849||(((a[M]||[])[0]||[])[0]==1025?a[M][u]&&a[M][u].itab>0&&(L=a.SheetNames[a[M][u].itab-1]+"!"):L=a.SheetNames[u-1]+"!"),a[M]&&a[M][u])L+=a[M][u].Name;else if(a[0]&&a[0][u])L+=a[0][u].Name;else{var ee=(nf(a,M,n)||"").split(";;");ee[u-1]?L=ee[u-1]:L+="SH33TJSERRX"}o.push(L);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var de="(",J=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:de=tt(" ",e[0][p][1][1])+de;break;case 3:de=tt("\r",e[0][p][1][1])+de;break;case 4:J=tt(" ",e[0][p][1][1])+J;break;case 5:J=tt("\r",e[0][p][1][1])+J;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(de+o.pop()+J);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var te={c:t.c,r:t.r};if(a.sharedf[xe(f)]){var ie=a.sharedf[xe(f)];o.push(Pt(ie,s,te,a,n))}else{var ye=!1;for(c=0;c!=a.arrayf.length;++c)if(l=a.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(Pt(l[1],s,te,a,n)),ye=!0;break}ye||o.push(x[1])}break;case"PtgArray":o.push("{"+Av(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&re.indexOf(e[0][v][0])==-1){x=e[0][p];var Z=!0;switch(x[1][0]){case 4:Z=!1;case 0:g=tt(" ",x[1][1]);break;case 5:Z=!1;case 1:g=tt("\r",x[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((Z?g:"")+o.pop()+(Z?"":g)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Iv(e,r,t){var a=e.l+r,n=t.biff==2?1:2,i,s=e.read_shift(n);if(s==65535)return[[],Bt(e,r-2)];var o=Wn(e,s,t);return r!==s+n&&(i=Vn(e,r-s-n,o,t)),e.l=a,[o,i]}function Pv(e,r,t){var a=e.l+r,n=t.biff==2?1:2,i,s=e.read_shift(n);if(s==65535)return[[],Bt(e,r-2)];var o=Wn(e,s,t);return r!==s+n&&(i=Vn(e,r-s-n,o,t)),e.l=a,[o,i]}function Rv(e,r,t,a){var n=e.l+r,i=Wn(e,a,t),s;return n!==e.l&&(s=Vn(e,n-e.l,i,t)),[i,s]}function Dv(e,r,t){var a=e.l+r,n,i=e.read_shift(2),s=Wn(e,i,t);return i==65535?[[],Bt(e,r-2)]:(r!==i+2&&(n=Vn(e,a-i-2,s,t)),[s,n])}function Nv(e){var r;if(Nr(e,e.l+6)!==65535)return[Dt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Lv(e){if(e==null){var r=X(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return ya(e);return ya(0)}function Es(e,r,t){var a=e.l+r,n=Ar(e,6);t.biff==2&&++e.l;var i=Nv(e,8),s=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=Pv(e,a-e.l,t);return{cell:n,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function Bv(e,r,t,a,n){var i=_a(r,t,n),s=Lv(e.v),o=X(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=X(e.bf.length),f=0;f<e.bf.length;++f)l[f]=e.bf[f];var d=Et([i,s,o,l]);return d}function $i(e,r,t){var a=e.read_shift(4),n=Wn(e,a,t),i=e.read_shift(4),s=i>0?Vn(e,i,n,t):null;return[n,s]}var Mv=$i,Ui=$i,$v=$i,Uv=$i,jv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},sf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hv={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ml(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Vv(e){var r="of:="+e.replace(_o,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Ss(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function Wv(e){return e.replace(/\./,"!")}var _n={},Va={},kn=typeof Map!="undefined";function So(e,r,t){var a=0,n=e.length;if(t){if(kn?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var i=kn?t.get(r):t[r];a<i.length;++a)if(e[i[a]].t===r)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===r)return e.Count++,a;return e[n]={t:r},e.Count++,e.Unique++,t&&(kn?(t.has(r)||t.set(r,[]),t.get(r).push(n)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(n))),n}function ji(e,r){var t={min:e+1,max:e+1},a=-1;return r.MDW&&(Rt=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?a=Dn(r.wpx):r.wch!=null&&(a=r.wch),a>-1?(t.width=Oi(a),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function ga(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function na(e,r,t){var a=t.revssf[r.z!=null?r.z:"General"],n=60,i=e.length;if(a==null&&t.ssf){for(;n<392;++n)if(t.ssf[n]==null){Br(r.z,n),t.ssf[n]=r.z,t.revssf[r.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function of(e,r,t,a,n,i){try{a.cellNF&&(e.z=ge[r])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ke(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ge[r]==null&&Br(jd[r]||"General",r),e.t==="e")e.w=e.w||Hr[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Cn(e.v);else if(e.t==="d"){var s=yt(e.v);(s|0)===s?e.w=s.toString(10):e.w=Cn(s)}else{if(e.v===void 0)return"";e.w=xa(e.v,Va)}else e.t==="d"?e.w=lr(r,yt(e.v),Va):e.w=lr(r,e.v,Va)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&t!=null)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ai(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ai(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function Gv(e,r,t){if(e&&e["!ref"]){var a=Be(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function zv(e,r){var t=Be(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Ee(t))}var Xv=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Yv=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,qv=/<(?:\w:)?hyperlink [^>]*>/mg,Kv=/"(\w*:\w*)"/,Jv=/<(?:\w:)?col\b[^>]*[\/]?>/g,Zv=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Qv=/<(?:\w:)?pageMargins[^>]*\/>/g,cf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,e2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,t2=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function r2(e,r,t,a,n,i,s){if(!e)return e;a||(a={"!id":{}}),at!=null&&r.dense==null&&(r.dense=at);var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",d=e.match(Yv);d?(l=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):l=f=e;var u=l.match(cf);u?bo(u[0],o,n,t):(u=l.match(e2))&&n2(u[0],u[1]||"",o,n,t,s,i);var h=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=l.slice(h,h+50).match(Kv);m&&zv(o,m[1])}var p=l.match(t2);p&&p[1]&&x2(p[1],n);var g=[];if(r.cellStyles){var v=l.match(Jv);v&&d2(g,v)}d&&w2(d[1],o,r,c,i,s);var y=f.match(Zv);y&&(o["!autofilter"]=p2(y[0]));var x=[],F=f.match(Xv);if(F)for(h=0;h!=F.length;++h)x[h]=Be(F[h].slice(F[h].indexOf('"')+1));var I=f.match(qv);I&&l2(o,I,a);var A=f.match(Qv);if(A&&(o["!margins"]=f2(ve(A[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ee(c)),r.sheetRows>0&&o["!ref"]){var k=Be(o["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ee(k))}return g.length>0&&(o["!cols"]=g),x.length>0&&(o["!merges"]=x),o}function a2(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Ee(e[t])+'"/>';return r+"</mergeCells>"}function bo(e,r,t,a){var n=ve(e);t.Sheets[a]||(t.Sheets[a]={}),n.codeName&&(t.Sheets[a].CodeName=Le(ze(n.codeName)))}function n2(e,r,t,a,n){bo(e.slice(0,e.indexOf(">")),t,a,n)}function i2(e,r,t,a,n){var i=!1,s={},o=null;if(a.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[t];try{r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}i=!0,s.codeName=br(Ge(c))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+se("outlinePr",null,l)}!i&&!o||(n[n.length]=se("sheetPr",o,s))}var s2=["objects","scenarios","selectLockedCells","selectUnlockedCells"],o2=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function c2(e){var r={sheet:1};return s2.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),o2.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=vo(e.password).toString(16).toUpperCase()),se("sheetProtection",null,r)}function l2(e,r,t){for(var a=Array.isArray(e),n=0;n!=r.length;++n){var i=ve(ze(r[n]),!0);if(!i.ref)return;var s=((t||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Le(i.location))):(i.Target="#"+Le(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Be(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=xe({c:l,r:c});a?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function f2(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function u2(e){return ga(e),se("pageMargins",null,e)}function d2(e,r){for(var t=!1,a=0;a!=r.length;++a){var n=ve(r[a],!0);n.hidden&&(n.hidden=qe(n.hidden));var i=parseInt(n.min,10)-1,s=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,yo(n.width)),Qr(n);i<=s;)e[i++]=Je(n)}}function h2(e,r){for(var t=["<cols>"],a,n=0;n!=r.length;++n)(a=r[n])&&(t[t.length]=se("col",null,ji(n,a)));return t[t.length]="</cols>",t.join("")}function p2(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function m2(e,r,t,a){var n=typeof e.ref=="string"?e.ref:Ee(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,s=Xt(n);s.s.r==s.e.r&&(s.e.r=Xt(r["!ref"]).e.r,n=Ee(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+t.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+n}),se("autoFilter",null,{ref:n})}var g2=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function x2(e,r){r.Views||(r.Views=[{}]),(e.match(g2)||[]).forEach(function(t,a){var n=ve(t);r.Views[a]||(r.Views[a]={}),+n.zoomScale&&(r.Views[a].zoom=+n.zoomScale),qe(n.rightToLeft)&&(r.Views[a].RTL=!0)})}function v2(e,r,t,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,n),{})}function y2(e,r,t,a){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Hr[e.v];break;case"d":a&&a.cellDates?n=Ke(e.v,-1).toISOString():(e=Je(e),e.t="n",n=""+(e.v=yt(Ke(e.v)))),typeof e.z=="undefined"&&(e.z=ge[14]);break;default:n=e.v;break}var o=Ct("v",Ge(n)),c={r},l=na(a.cellXfs,e,a);switch(l!==0&&(c.s=l),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=Ct("v",""+So(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;o=se("f",Ge(e.f),f)+(e.v!=null?o:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(c.cm=1),se("c",o,c)}var w2=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=An("v"),s=An("f");return function(c,l,f,d,u,h){for(var m=0,p="",g=[],v=[],y=0,x=0,F=0,I="",A,k,N=0,D=0,M,W,L=0,ee=0,de=Array.isArray(h.CellXf),J,te=[],ie=[],ye=Array.isArray(l),re=[],Z={},G=!1,C=!!f.sheetStubs,B=c.split(r),R=0,P=B.length;R!=P;++R){p=B[R].trim();var z=p.length;if(z!==0){var fe=0;e:for(m=0;m<z;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(k=ve(p.slice(fe,m),!0),N=k.r!=null?parseInt(k.r,10):N+1,D=-1,f.sheetRows&&f.sheetRows<N)continue;Z={},G=!1,k.ht&&(G=!0,Z.hpt=parseFloat(k.ht),Z.hpx=Xa(Z.hpt)),k.hidden=="1"&&(G=!0,Z.hidden=!0),k.outlineLevel!=null&&(G=!0,Z.level=+k.outlineLevel),G&&(re[N-1]=Z)}break;case"<":fe=m;break}if(fe>=m)break;if(k=ve(p.slice(fe,m),!0),N=k.r!=null?parseInt(k.r,10):N+1,D=-1,!(f.sheetRows&&f.sheetRows<N)){d.s.r>N-1&&(d.s.r=N-1),d.e.r<N-1&&(d.e.r=N-1),f&&f.cellStyles&&(Z={},G=!1,k.ht&&(G=!0,Z.hpt=parseFloat(k.ht),Z.hpx=Xa(Z.hpt)),k.hidden=="1"&&(G=!0,Z.hidden=!0),k.outlineLevel!=null&&(G=!0,Z.level=+k.outlineLevel),G&&(re[N-1]=Z)),g=p.slice(m).split(e);for(var ae=0;ae!=g.length&&g[ae].trim().charAt(0)=="<";++ae);for(g=g.slice(ae),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(v=p.match(t),y=m,x=0,F=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,I=v[1],x=0;x!=I.length&&!((F=I.charCodeAt(x)-64)<1||F>26);++x)y=26*y+F;--y,D=y}else++D;for(x=0;x!=p.length&&p.charCodeAt(x)!==62;++x);if(++x,k=ve(p.slice(0,x),!0),k.r||(k.r=xe({r:N-1,c:D})),I=p.slice(x),A={t:""},(v=I.match(i))!=null&&v[1]!==""&&(A.v=Le(v[1])),f.cellFormula){if((v=I.match(s))!=null&&v[1]!==""){if(A.f=Le(ze(v[1])).replace(/\r\n/g,`
`),f.xlfn||(A.f=ul(A.f)),v[0].indexOf('t="array"')>-1)A.F=(I.match(n)||[])[1],A.F.indexOf(":")>-1&&te.push([Be(A.F),A.F]);else if(v[0].indexOf('t="shared"')>-1){W=ve(v[0]);var ne=Le(ze(v[1]));f.xlfn||(ne=ul(ne)),ie[parseInt(W.si,10)]=[W,ne,k.r]}}else(v=I.match(/<f[^>]*\/>/))&&(W=ve(v[0]),ie[W.si]&&(A.f=gx(ie[W.si][1],ie[W.si][2],k.r)));var q=et(k.r);for(x=0;x<te.length;++x)q.r>=te[x][0].s.r&&q.r<=te[x][0].e.r&&q.c>=te[x][0].s.c&&q.c<=te[x][0].e.c&&(A.F=te[x][1])}if(k.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(C)A.t="z";else continue;else A.t=k.t||"n";switch(d.s.c>D&&(d.s.c=D),d.e.c<D&&(d.e.c=D),A.t){case"n":if(A.v==""||A.v==null){if(!C)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v=="undefined"){if(!C)continue;A.t="z"}else M=_n[parseInt(A.v,10)],A.v=M.t,A.r=M.r,f.cellHTML&&(A.h=M.h);break;case"str":A.t="s",A.v=A.v!=null?ze(A.v):"",f.cellHTML&&(A.h=Zs(A.v));break;case"inlineStr":v=I.match(a),A.t="s",v!=null&&(M=xo(v[1]))?(A.v=M.t,f.cellHTML&&(A.h=M.h)):A.v="";break;case"b":A.v=qe(A.v);break;case"d":f.cellDates?A.v=Ke(A.v,1):(A.v=yt(Ke(A.v,1)),A.t="n");break;case"e":(!f||f.cellText!==!1)&&(A.w=A.v),A.v=l0[A.v];break}if(L=ee=0,J=null,de&&k.s!==void 0&&(J=h.CellXf[k.s],J!=null&&(J.numFmtId!=null&&(L=J.numFmtId),f.cellStyles&&J.fillId!=null&&(ee=J.fillId))),of(A,L,ee,f,u,h),f.cellDates&&de&&A.t=="n"&&Ya(ge[L])&&(A.t="d",A.v=Li(A.v)),k.cm&&f.xlmeta){var ke=(f.xlmeta.Cell||[])[+k.cm-1];ke&&ke.type=="XLDAPR"&&(A.D=!0)}if(ye){var O=et(k.r);l[O.r]||(l[O.r]=[]),l[O.r][O.c]=A}else l[k.r]=A}}}}re.length>0&&(l["!rows"]=re)}})();function _2(e,r,t,a){var n=[],i=[],s=Be(e["!ref"]),o="",c,l="",f=[],d=0,u=0,h=e["!rows"],m=Array.isArray(e),p={r:l},g,v=-1;for(u=s.s.c;u<=s.e.c;++u)f[u]=Qe(u);for(d=s.s.r;d<=s.e.r;++d){for(i=[],l=lt(d),u=s.s.c;u<=s.e.c;++u){c=f[u]+l;var y=m?(e[d]||[])[u]:e[c];y!==void 0&&(o=y2(y,c,e,r,t,a))!=null&&i.push(o)}(i.length>0||h&&h[d])&&(p={r:l},h&&h[d]&&(g=h[d],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=Nn(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),n[n.length]=se("row",i.join(""),p))}if(h)for(;d<h.length;++d)h&&h[d]&&(p={r:d+1},g=h[d],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=Nn(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level),n[n.length]=se("row","",p));return n.join("")}function lf(e,r,t,a){var n=[ft,se("worksheet",null,{xmlns:Ea[0],"xmlns:r":vt.r})],i=t.SheetNames[e],s=0,o="",c=t.Sheets[i];c==null&&(c={});var l=c["!ref"]||"A1",f=Be(l);if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),l=Ee(f)}a||(a={}),c["!comments"]=[];var d=[];i2(c,t,e,r,n),n[n.length]=se("dimension",null,{ref:l}),n[n.length]=v2(c,r,e,t),r.sheetFormat&&(n[n.length]=se("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=h2(c,c["!cols"])),n[s=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=_2(c,r,e,t,a),o.length>0&&(n[n.length]=o)),n.length>s+1&&(n[n.length]="</sheetData>",n[s]=n[s].replace("/>",">")),c["!protect"]&&(n[n.length]=c2(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=m2(c["!autofilter"],c,t,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=a2(c["!merges"]));var u=-1,h,m=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=We(a,-1,Ge(p[1].Target).replace(/#.*$/,""),Te.HLINK),h["r:id"]="rId"+m),(u=p[1].Target.indexOf("#"))>-1&&(h.location=Ge(p[1].Target.slice(u+1))),p[1].Tooltip&&(h.tooltip=Ge(p[1].Tooltip)),n[n.length]=se("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=u2(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(n[n.length]=Ct("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:l}))),d.length>0&&(m=We(a,-1,"../drawings/drawing"+(e+1)+".xml",Te.DRAW),n[n.length]=se("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=d),c["!comments"].length>0&&(m=We(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Te.VML),n[n.length]=se("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function k2(e,r){var t={},a=e.l+r;t.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=n/20),t}function E2(e,r,t){var a=X(145),n=(t["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=Nn(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var s=0;n.level&&(s|=n.level),n.hidden&&(s|=16),(n.hpx||n.hpt)&&(s|=32),a.write_shift(1,s),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var l={r:e,c:0},f=0;f<16;++f)if(!(r.s.c>f+1<<10||r.e.c<f<<10)){for(var d=-1,u=-1,h=f<<10;h<f+1<<10;++h){l.c=h;var m=Array.isArray(t)?(t[l.r]||[])[l.c]:t[xe(l)];m&&(d<0&&(d=h),u=h)}d<0||(++o,a.write_shift(4,d),a.write_shift(4,u))}var p=a.l;return a.l=c,a.write_shift(4,o),a.l=p,a.length>a.l?a.slice(0,a.l):a}function S2(e,r,t,a){var n=E2(a,t,r);(n.length>17||(r["!rows"]||[])[a])&&K(e,0,n)}var b2=Ca,T2=Za;function C2(){}function A2(e,r){var t={},a=e[e.l];return++e.l,t.above=!(a&64),t.left=!(a&128),e.l+=18,t.name=Ih(e,r-19),t}function O2(e,r,t){t==null&&(t=X(84+4*e.length));var a=192;r&&(r.above&&(a&=-65),r.left&&(a&=-129)),t.write_shift(1,a);for(var n=1;n<3;++n)t.write_shift(1,0);return bi({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),n0(e,t),t.slice(0,t.l)}function F2(e){var r=fr(e);return[r]}function I2(e,r,t){return t==null&&(t=X(8)),Sa(r,t)}function P2(e){var r=ba(e);return[r]}function R2(e,r,t){return t==null&&(t=X(4)),Ta(r,t)}function D2(e){var r=fr(e),t=e.read_shift(1);return[r,t,"b"]}function N2(e,r,t){return t==null&&(t=X(9)),Sa(r,t),t.write_shift(1,e.v?1:0),t}function L2(e){var r=ba(e),t=e.read_shift(1);return[r,t,"b"]}function B2(e,r,t){return t==null&&(t=X(5)),Ta(r,t),t.write_shift(1,e.v?1:0),t}function M2(e){var r=fr(e),t=e.read_shift(1);return[r,t,"e"]}function $2(e,r,t){return t==null&&(t=X(9)),Sa(r,t),t.write_shift(1,e.v),t}function U2(e){var r=ba(e),t=e.read_shift(1);return[r,t,"e"]}function j2(e,r,t){return t==null&&(t=X(8)),Ta(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function H2(e){var r=fr(e),t=e.read_shift(4);return[r,t,"s"]}function V2(e,r,t){return t==null&&(t=X(12)),Sa(r,t),t.write_shift(4,r.v),t}function W2(e){var r=ba(e),t=e.read_shift(4);return[r,t,"s"]}function G2(e,r,t){return t==null&&(t=X(8)),Ta(r,t),t.write_shift(4,r.v),t}function z2(e){var r=fr(e),t=Dt(e);return[r,t,"n"]}function X2(e,r,t){return t==null&&(t=X(16)),Sa(r,t),ya(e.v,t),t}function ff(e){var r=ba(e),t=Dt(e);return[r,t,"n"]}function Y2(e,r,t){return t==null&&(t=X(12)),Ta(r,t),ya(e.v,t),t}function q2(e){var r=fr(e),t=uo(e);return[r,t,"n"]}function K2(e,r,t){return t==null&&(t=X(12)),Sa(r,t),i0(e.v,t),t}function J2(e){var r=ba(e),t=uo(e);return[r,t,"n"]}function Z2(e,r,t){return t==null&&(t=X(8)),Ta(r,t),i0(e.v,t),t}function Q2(e){var r=fr(e),t=co(e);return[r,t,"is"]}function ey(e){var r=fr(e),t=Lt(e);return[r,t,"str"]}function ty(e,r,t){return t==null&&(t=X(12+4*e.v.length)),Sa(r,t),St(e.v,t),t.length>t.l?t.slice(0,t.l):t}function ry(e){var r=ba(e),t=Lt(e);return[r,t,"str"]}function ay(e,r,t){return t==null&&(t=X(8+4*e.v.length)),Ta(r,t),St(e.v,t),t.length>t.l?t.slice(0,t.l):t}function ny(e,r,t){var a=e.l+r,n=fr(e);n.r=t["!row"];var i=e.read_shift(1),s=[n,i,"b"];if(t.cellFormula){e.l+=2;var o=Ui(e,a-e.l,t);s[3]=Pt(o,null,n,t.supbooks,t)}else e.l=a;return s}function iy(e,r,t){var a=e.l+r,n=fr(e);n.r=t["!row"];var i=e.read_shift(1),s=[n,i,"e"];if(t.cellFormula){e.l+=2;var o=Ui(e,a-e.l,t);s[3]=Pt(o,null,n,t.supbooks,t)}else e.l=a;return s}function sy(e,r,t){var a=e.l+r,n=fr(e);n.r=t["!row"];var i=Dt(e),s=[n,i,"n"];if(t.cellFormula){e.l+=2;var o=Ui(e,a-e.l,t);s[3]=Pt(o,null,n,t.supbooks,t)}else e.l=a;return s}function oy(e,r,t){var a=e.l+r,n=fr(e);n.r=t["!row"];var i=Lt(e),s=[n,i,"str"];if(t.cellFormula){e.l+=2;var o=Ui(e,a-e.l,t);s[3]=Pt(o,null,n,t.supbooks,t)}else e.l=a;return s}var cy=Ca,ly=Za;function fy(e,r){return r==null&&(r=X(4)),r.write_shift(4,e),r}function uy(e,r){var t=e.l+r,a=Ca(e,16),n=lo(e),i=Lt(e),s=Lt(e),o=Lt(e);e.l=t;var c={rfx:a,relId:n,loc:i,display:o};return s&&(c.Tooltip=s),c}function dy(e,r){var t=X(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Za({s:et(e[0]),e:et(e[0])},t),fo("rId"+r,t);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return St(n||"",t),St(e[1].Tooltip||"",t),St("",t),t.slice(0,t.l)}function hy(){}function py(e,r,t){var a=e.l+r,n=s0(e,16),i=e.read_shift(1),s=[n];if(s[2]=i,t.cellFormula){var o=Mv(e,a-e.l,t);s[1]=o}else e.l=a;return s}function my(e,r,t){var a=e.l+r,n=Ca(e,16),i=[n];if(t.cellFormula){var s=Uv(e,a-e.l,t);i[1]=s,e.l=a}else e.l=a;return i}function gy(e,r,t){t==null&&(t=X(18));var a=ji(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(a.width||10)*256),t.write_shift(4,0);var n=0;return r.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),r.level&&(n|=r.level<<8),t.write_shift(2,n),t}var uf=["left","right","top","bottom","header","footer"];function xy(e){var r={};return uf.forEach(function(t){r[t]=Dt(e,8)}),r}function vy(e,r){return r==null&&(r=X(48)),ga(e),uf.forEach(function(t){ya(e[t],r)}),r}function yy(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function wy(e,r,t){t==null&&(t=X(30));var a=924;return(((r||{}).Views||[])[0]||{}).RTL&&(a|=32),t.write_shift(2,a),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function _y(e){var r=X(24);return r.write_shift(4,4),r.write_shift(4,1),Za(e,r),r}function ky(e,r){return r==null&&(r=X(66)),r.write_shift(2,e.password?vo(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function Ey(){}function Sy(){}function by(e,r,t,a,n,i,s){if(!e)return e;var o=r||{};a||(a={"!id":{}}),at!=null&&o.dense==null&&(o.dense=at);var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=[],u=!1,h=!1,m,p,g,v,y,x,F,I,A,k=[];o.biff=12,o["!row"]=0;var N=0,D=!1,M=[],W={},L=o.supbooks||n.supbooks||[[]];if(L.sharedf=W,L.arrayf=M,L.SheetNames=n.SheetNames||n.Sheets.map(function(Z){return Z.name}),!o.supbooks&&(o.supbooks=L,n.Names))for(var ee=0;ee<n.Names.length;++ee)L[0][ee+1]=n.Names[ee];var de=[],J=[],te=!1;Ln[16]={n:"BrtShortReal",f:ff};var ie,ye;if(jr(e,function(G,C,B){if(!h)switch(B){case 148:l=G;break;case 0:m=G,o.sheetRows&&o.sheetRows<=m.r&&(h=!0),I=lt(v=m.r),o["!row"]=m.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=Xa(G.hpt)),J[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:G[2]},G[2]){case"n":p.v=G[1];break;case"s":F=_n[G[1]],p.v=F.t,p.r=F.r;break;case"b":p.v=!!G[1];break;case"e":p.v=G[1],o.cellText!==!1&&(p.w=Hr[p.v]);break;case"str":p.t="s",p.v=G[1];break;case"is":p.t="s",p.v=G[1].t;break}if((g=s.CellXf[G[0].iStyleRef])&&of(p,g.numFmtId,null,o,i,s),y=G[0].c==-1?y+1:G[0].c,o.dense?(c[v]||(c[v]=[]),c[v][y]=p):c[Qe(y)+I]=p,o.cellFormula){for(D=!1,N=0;N<M.length;++N){var R=M[N];m.r>=R[0].s.r&&m.r<=R[0].e.r&&y>=R[0].s.c&&y<=R[0].e.c&&(p.F=Ee(R[0]),D=!0)}!D&&G.length>3&&(p.f=G[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),o.cellDates&&g&&p.t=="n"&&Ya(ge[g.numFmtId])){var P=da(p.v);P&&(p.t="d",p.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}ie&&(ie.type=="XLDAPR"&&(p.D=!0),ie=void 0),ye&&(ye=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;p={t:"z",v:void 0},y=G[0].c==-1?y+1:G[0].c,o.dense?(c[v]||(c[v]=[]),c[v][y]=p):c[Qe(y)+I]=p,f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),ie&&(ie.type=="XLDAPR"&&(p.D=!0),ie=void 0),ye&&(ye=void 0);break;case 176:k.push(G);break;case 49:ie=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var z=a["!id"][G.relId];for(z?(G.Target=z.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=z):G.relId==""&&(G.Target="#"+G.loc),v=G.rfx.s.r;v<=G.rfx.e.r;++v)for(y=G.rfx.s.c;y<=G.rfx.e.c;++y)o.dense?(c[v]||(c[v]=[]),c[v][y]||(c[v][y]={t:"z",v:void 0}),c[v][y].l=G):(x=xe({c:y,r:v}),c[x]||(c[x]={t:"z",v:void 0}),c[x].l=G);break;case 426:if(!o.cellFormula)break;M.push(G),A=o.dense?c[v][y]:c[Qe(y)+I],A.f=Pt(G[1],f,{r:m.r,c:y},L,o),A.F=Ee(G[0]);break;case 427:if(!o.cellFormula)break;W[xe(G[0].s)]=G[1],A=o.dense?c[v][y]:c[Qe(y)+I],A.f=Pt(G[1],f,{r:m.r,c:y},L,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)de[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},te||(te=!0,yo(G.w/256)),Qr(de[G.e+1]);break;case 161:c["!autofilter"]={ref:Ee(G)};break;case 476:c["!margins"]=G;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),G.name&&(n.Sheets[t].CodeName=G.name),(G.above||G.left)&&(c["!outline"]={above:G.above,left:G.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),G.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:d.push(B),u=!0;break;case 38:d.pop(),u=!1;break;default:if(!C.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ee(l||f)),o.sheetRows&&c["!ref"]){var re=Be(c["!ref"]);o.sheetRows<=+re.e.r&&(re.e.r=o.sheetRows-1,re.e.r>f.e.r&&(re.e.r=f.e.r),re.e.r<re.s.r&&(re.s.r=re.e.r),re.e.c>f.e.c&&(re.e.c=f.e.c),re.e.c<re.s.c&&(re.s.c=re.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ee(re))}return k.length>0&&(c["!merges"]=k),de.length>0&&(c["!cols"]=de),J.length>0&&(c["!rows"]=J),c}function Ty(e,r,t,a,n,i,s){if(r.v===void 0)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":r=Je(r),r.z=r.z||ge[14],r.v=yt(Ke(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v;break}var c={r:t,c:a};switch(c.s=na(n.cellXfs,r,n),r.l&&i["!links"].push([xe(c),r.l]),r.c&&i["!comments"].push([xe(c),r.c]),r.t){case"s":case"str":return n.bookSST?(o=So(n.Strings,r.v,n.revStrings),c.t="s",c.v=o,s?K(e,18,G2(r,c)):K(e,7,V2(r,c))):(c.t="str",s?K(e,17,ay(r,c)):K(e,6,ty(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?s?K(e,13,Z2(r,c)):K(e,2,K2(r,c)):s?K(e,16,Y2(r,c)):K(e,5,X2(r,c)),!0;case"b":return c.t="b",s?K(e,15,B2(r,c)):K(e,4,N2(r,c)),!0;case"e":return c.t="e",s?K(e,14,j2(r,c)):K(e,3,$2(r,c)),!0}return s?K(e,12,R2(r,c)):K(e,1,I2(r,c)),!0}function Cy(e,r,t,a){var n=Be(r["!ref"]||"A1"),i,s="",o=[];K(e,145);var c=Array.isArray(r),l=n.e.r;r["!rows"]&&(l=Math.max(n.e.r,r["!rows"].length-1));for(var f=n.s.r;f<=l;++f){s=lt(f),S2(e,r,n,f);var d=!1;if(f<=n.e.r)for(var u=n.s.c;u<=n.e.c;++u){f===n.s.r&&(o[u]=Qe(u)),i=o[u]+s;var h=c?(r[f]||[])[u]:r[i];if(!h){d=!1;continue}d=Ty(e,h,f,u,a,r,d)}}K(e,146)}function Ay(e,r){!r||!r["!merges"]||(K(e,177,fy(r["!merges"].length)),r["!merges"].forEach(function(t){K(e,176,ly(t))}),K(e,178))}function Oy(e,r){!r||!r["!cols"]||(K(e,390),r["!cols"].forEach(function(t,a){t&&K(e,60,gy(a,t))}),K(e,391))}function Fy(e,r){!r||!r["!ref"]||(K(e,648),K(e,649,_y(Be(r["!ref"]))),K(e,650))}function Iy(e,r,t){r["!links"].forEach(function(a){if(a[1].Target){var n=We(t,-1,a[1].Target.replace(/#.*$/,""),Te.HLINK);K(e,494,dy(a,n))}}),delete r["!links"]}function Py(e,r,t,a){if(r["!comments"].length>0){var n=We(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Te.VML);K(e,551,fo("rId"+n)),r["!legacy"]=n}}function Ry(e,r,t,a){if(r["!autofilter"]){var n=r["!autofilter"],i=typeof n.ref=="string"?n.ref:Ee(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,o=Xt(i);o.s.r==o.e.r&&(o.e.r=Xt(r["!ref"]).e.r,i=Ee(o));for(var c=0;c<s.length;++c){var l=s[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+t.SheetNames[a]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+i}),K(e,161,Za(Be(i))),K(e,162)}}function Dy(e,r,t){K(e,133),K(e,137,wy(r,t)),K(e,138),K(e,134)}function Ny(e,r){r["!protect"]&&K(e,535,ky(r["!protect"]))}function Ly(e,r,t,a){var n=zt(),i=t.SheetNames[e],s=t.Sheets[i]||{},o=i;try{t&&t.Workbook&&(o=t.Workbook.Sheets[e].CodeName||o)}catch{}var c=Be(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],K(n,129),(t.vbaraw||s["!outline"])&&K(n,147,O2(o,s["!outline"])),K(n,148,T2(c)),Dy(n,s,t.Workbook),Oy(n,s,e,r,t),Cy(n,s,e,r,t),Ny(n,s),Ry(n,s,t,e),Ay(n,s),Iy(n,s,a),s["!margins"]&&K(n,476,vy(s["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&Fy(n,s),Py(n,s,e,a),K(n,130),n.end()}function By(e){var r=[],t=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=t?+s[2]:s[2])});var n=Le((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[r,n,a]}function My(e,r,t,a,n,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var u=By(d);f.s.r=f.s.c=0,f.e.c=o,l=Qe(o),u[0].forEach(function(h,m){s[l+lt(m)]={t:"n",v:h,z:u[1]},c=m}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(s["!ref"]=Ee(f)),s}function $y(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(cf);return o&&bo(o[0],i,n,t),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Uy(e,r){e.l+=10;var t=Lt(e,r-10);return{name:t}}function jy(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return jr(e,function(l,f,d){switch(d){case 550:i["!rel"]=l;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),l.name&&(n.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d);break;case 38:s.pop();break;default:if(f.T>0)s.push(d);else if(f.T<0)s.pop();else if(!o||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}},r),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var To=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Hy=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Vy=[],Wy=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function gl(e,r){for(var t=0;t!=e.length;++t)for(var a=e[t],n=0;n!=r.length;++n){var i=r[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=qe(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function xl(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=qe(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function df(e){xl(e.WBProps,To),xl(e.CalcPr,Wy),gl(e.WBView,Hy),gl(e.Sheets,Vy),Va.date1904=qe(e.WBProps.date1904)}function Gy(e){return!e.Workbook||!e.Workbook.WBProps?"false":qe(e.Workbook.WBProps.date1904)?"true":"false"}var zy="][*?/\\".split("");function hf(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return zy.forEach(function(a){if(e.indexOf(a)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}function Xy(e,r,t){e.forEach(function(a,n){hf(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(t){var s=r&&r[n]&&r[n].CodeName||a;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Yy(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];Xy(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Gv(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var qy=/<\w+:workbook/;function Ky(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},s=0;if(e.replace(Mt,function(c,l){var f=ve(c);switch(Cr(f[0])){case"<?xml":break;case"<workbook":c.match(qy)&&(n="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":To.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":t.WBProps[d[0]]=qe(f[d[0]]);break;case"int":t.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:t.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(t.WBProps.CodeName=ze(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Le(ze(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=ze(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),qe(f.hidden||"0")&&(i.Hidden=!0),s=l+c.length;break;case"</definedName>":i.Ref=Le(ze(e.slice(s,l))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Ea.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return df(t),t}function pf(e){var r=[ft];r[r.length]=se("workbook",null,{xmlns:Ea[0],"xmlns:r":vt.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(To.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),r[r.length]=se("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ge(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}r[r.length]=se("sheet",null,s)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(r[r.length]=se("definedName",Ge(o.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function Jy(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Ps(e,r-8),t.name=Lt(e),t}function Zy(e,r){return r||(r=X(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),fo(e.strRelID,r),St(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function Qy(e,r){var t={},a=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var n=r>8?Lt(e):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function ew(e,r){r||(r=X(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),n0(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function tw(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function rw(e,r,t){var a=e.l+r;e.l+=4,e.l+=1;var n=e.read_shift(4),i=Ph(e),s=$v(e,0,t),o=lo(e);e.l=a;var c={Name:i,Ptg:s};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function aw(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Ln[16]={n:"BrtFRTArchID$",f:tw},jr(e,function(c,l,f){switch(f){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=Pt(c.Ptg,null,null,s,r),delete r.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,c]):s[0]=[f,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},r),df(t),t.Names=i,t.supbooks=s,t}function nw(e,r){K(e,143);for(var t=0;t!=r.SheetNames.length;++t){var a=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,n={Hidden:a,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};K(e,156,Zy(n))}K(e,144)}function iw(e,r){r||(r=X(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return St("SheetJS",r),St(bn.version,r),St(bn.version,r),St("7262",r),r.length>r.l?r.slice(0,r.l):r}function sw(e,r){r||(r=X(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function ow(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,a=0,n=-1,i=-1;a<t.length;++a)!t[a]||!t[a].Hidden&&n==-1?n=a:t[a].Hidden==1&&i==-1&&(i=a);i>n||(K(e,135),K(e,158,sw(n)),K(e,136))}}function cw(e,r){var t=zt();return K(t,131),K(t,128,iw()),K(t,153,ew(e.Workbook&&e.Workbook.WBProps||null)),ow(t,e,r),nw(t,e,r),K(t,132),t.end()}function lw(e,r,t){return r.slice(-4)===".bin"?aw(e,t):Ky(e,t)}function fw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?by(e,a,t,n,i,s,o):r2(e,a,t,n,i,s,o)}function uw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?jy(e,a,t,n,i,s,o):$y(e,a,t,n,i,s,o)}function dw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?px(e,a,t,n,i,s,o):mx(e,a,t,n,i,s,o)}function hw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?dx(e,a,t,n,i,s,o):hx(e,a,t,n,i,s,o)}function pw(e,r,t,a){return r.slice(-4)===".bin"?lg(e,t,a):Jm(e,t,a)}function mw(e,r,t){return X0(e,t)}function gw(e,r,t){return r.slice(-4)===".bin"?gm(e,t):hm(e,t)}function xw(e,r,t){return r.slice(-4)===".bin"?ox(e,t):Zg(e,t)}function vw(e,r,t){return r.slice(-4)===".bin"?qg(e,r,t):Xg(e,r,t)}function yw(e,r,t,a){return t.slice(-4)===".bin"?Kg(e,r,t,a):void 0}function ww(e,r,t){return r.slice(-4)===".bin"?Wg(e,r,t):zg(e,r,t)}function _w(e,r,t){return(r.slice(-4)===".bin"?cw:pf)(e,t)}function kw(e,r,t,a,n){return(r.slice(-4)===".bin"?Ly:lf)(e,t,a,n)}function Ew(e,r,t){return(r.slice(-4)===".bin"?yg:G0)(e,t)}function Sw(e,r,t){return(r.slice(-4)===".bin"?ym:B0)(e,t)}function bw(e,r,t){return(r.slice(-4)===".bin"?cx:K0)(e,t)}function Tw(e){return(e.slice(-4)===".bin"?Gg:Y0)()}var mf=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gf=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mr(e,r){var t=e.split(/\s+/),a=[];if(r||(a[0]=t[0]),t.length===1)return a;var n=e.match(mf),i,s,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(gf),(s=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),a[o]=i[2].slice(1,i[2].length-1));return a}function Cw(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var a=e.match(mf),n,i,s,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(gf),(i=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?s="xmlns"+n[1].slice(6):s=n[1].slice(i+1),t[s]=n[2].slice(1,n[2].length-1));return t}var En;function Aw(e,r){var t=En[e]||Le(e);return t==="General"?xa(r):lr(t,r)}function Ow(e,r,t,a){var n=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=qe(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Ke(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Le(r)]=n}function Fw(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Hr[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Cn(e.v):e.w=xa(e.v):e.w=Aw(r||"General",e.v)}catch(i){if(t.WTF)throw i}try{var a=En[r]||r||"General";if(t.cellNF&&(e.z=a),t.cellDates&&e.t=="n"&&Ya(a)){var n=da(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(t.WTF)throw i}}}function Iw(e,r,t){if(t.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=Vm[a.Pattern]||a.Pattern)}e[r.ID]=r}function Pw(e,r,t,a,n,i,s,o,c,l){var f="General",d=a.StyleID,u={};l=l||{};var h=[],m=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&s&&(d=s.StyleID);i[d]!==void 0&&(i[d].nf&&(f=i[d].nf),i[d].Interior&&h.push(i[d].Interior),!!i[d].Parent);)d=i[d].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=qe(e);break;case"String":a.t="s",a.r=Dc(Le(e)),a.v=e.indexOf("<")>-1?Le(r||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Ke(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Le(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=l0[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=Dc(r||e));break}if(Fw(a,f,l),l.cellFormula!==!1)if(a.Formula){var p=Le(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=Ha(p,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Ha("RC:RC",n):a.ArrayRange&&(a.F=Ha(a.ArrayRange,n),c.push([Be(a.F),a.F]))}else for(m=0;m<c.length;++m)n.r>=c[m][0].s.r&&n.r<=c[m][0].e.r&&n.c>=c[m][0].s.c&&n.c<=c[m][0].e.c&&(a.F=c[m][1]);l.cellStyles&&(h.forEach(function(g){!u.patternType&&g.patternType&&(u.patternType=g.patternType)}),a.s=u),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function Rw(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function bs(e,r){var t=r||{};qa();var a=pn(Qs(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof Ue!="undefined"?a=Ue.utils.decode(65001,Fs(a)):a=ze(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var s=Je(t);return s.type="string",za.to_workbook(a,s)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(st){n.indexOf("<"+st)>=0&&(i=!0)}),i)return v_(a,t);En={"General Number":"General","General Date":ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ge[15],"Short Date":ge[14],"Long Time":ge[19],"Medium Time":ge[18],"Short Time":ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ge[2],Standard:ge[4],Percent:ge[10],Scientific:ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l;at!=null&&t.dense==null&&(t.dense=at);var f={},d=[],u=t.dense?[]:{},h="",m={},p={},g=mr('<Data ss:Type="String">'),v=0,y=0,x=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},A={},k="",N=0,D=[],M={},W={},L=0,ee=[],de=[],J={},te=[],ie,ye=!1,re=[],Z=[],G={},C=0,B=0,R={Sheets:[],WBProps:{date1904:!1}},P={};Fn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";o=Fn.exec(a);)switch(o[3]=(z=o[3]).toLowerCase()){case"data":if(z=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Pw(a.slice(v,o.index),k,g,c[c.length-1][0]=="comment"?J:m,{c:y,r:x},I,te[y],p,re,t):(k="",g=mr(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(de.length>0&&(m.c=de),(!t.sheetRows||t.sheetRows>x)&&m.v!==void 0&&(t.dense?(u[x]||(u[x]=[]),u[x][y]=m):u[Qe(y)+lt(x)]=m),m.HRef&&(m.l={Target:Le(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(C=y+(parseInt(m.MergeAcross,10)|0),B=x+(parseInt(m.MergeDown,10)|0),D.push({s:{c:y,r:x},e:{c:C,r:B}})),!t.sheetStubs)m.MergeAcross?y=C+1:++y;else if(m.MergeAcross||m.MergeDown){for(var fe=y;fe<=C;++fe)for(var ae=x;ae<=B;++ae)(fe>y||ae>x)&&(t.dense?(u[ae]||(u[ae]=[]),u[ae][fe]={t:"z"}):u[Qe(fe)+lt(ae)]={t:"z"});y=C+1}else++y;else m=Cw(o[0]),m.Index&&(y=+m.Index-1),y<F.s.c&&(F.s.c=y),y>F.e.c&&(F.e.c=y),o[0].slice(-2)==="/>"&&++y,de=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<F.s.r&&(F.s.r=x),x>F.e.r&&(F.e.r=x),o[0].slice(-2)==="/>"&&(p=mr(o[0]),p.Index&&(x=+p.Index-1)),y=0,++x):(p=mr(o[0]),p.Index&&(x=+p.Index-1),G={},(p.AutoFitHeight=="0"||p.Height)&&(G.hpx=parseInt(p.Height,10),G.hpt=Nn(G.hpx),Z[x]=G),p.Hidden=="1"&&(G.hidden=!0,Z[x]=G));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));d.push(h),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(u["!ref"]=Ee(F),t.sheetRows&&t.sheetRows<=F.e.r&&(u["!fullref"]=u["!ref"],F.e.r=t.sheetRows-1,u["!ref"]=Ee(F))),D.length&&(u["!merges"]=D),te.length>0&&(u["!cols"]=te),Z.length>0&&(u["!rows"]=Z),f[h]=u}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=y=0,c.push([o[3],!1]),l=mr(o[0]),h=Le(l.Name),u=t.dense?[]:{},D=[],re=[],Z=[],P={name:h,Hidden:0},R.Sheets.push(P);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),te=[],ye=!1}break;case"style":o[1]==="/"?Iw(I,A,t):A=mr(o[0]);break;case"numberformat":A.nf=Le(mr(o[0]).Format||"General"),En[A.nf]&&(A.nf=En[A.nf]);for(var ne=0;ne!=392&&ge[ne]!=A.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if(ge[ne]==null){Br(A.nf,ne);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=mr(o[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!ye&&ie.wpx>10){ye=!0,Rt=V0;for(var q=0;q<te.length;++q)te[q]&&Qr(te[q])}ye&&Qr(ie),te[ie.Index-1||te.length]=ie;for(var ke=0;ke<+ie.Span;++ke)te[te.length]=Je(ie);break;case"namedrange":if(o[1]==="/")break;R.Names||(R.Names=[]);var O=ve(o[0]),je={Name:O.Name,Ref:Ha(O.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(je.Sheet=R.Sheets.length-1),R.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=a.slice(N,o.index):N=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;A.Interior=mr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ap(M,z,a.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));Rw(J),de.push(J)}else c.push([o[3],!1]),l=mr(o[0]),J={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Fe=mr(o[0]);u["!autofilter"]={ref:Ha(Fe.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return kl(a,t);var He=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(o[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(L,o.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else L=o.index+o[0].length;break;case"header":u["!margins"]||ga(u["!margins"]={},"xlml"),isNaN(+ve(o[0]).Margin)||(u["!margins"].header=+ve(o[0]).Margin);break;case"footer":u["!margins"]||ga(u["!margins"]={},"xlml"),isNaN(+ve(o[0]).Margin)||(u["!margins"].footer=+ve(o[0]).Margin);break;case"pagemargins":var Ie=ve(o[0]);u["!margins"]||ga(u["!margins"]={},"xlml"),isNaN(+Ie.Top)||(u["!margins"].top=+Ie.Top),isNaN(+Ie.Left)||(u["!margins"].left=+Ie.Left),isNaN(+Ie.Right)||(u["!margins"].right=+Ie.Right),isNaN(+Ie.Bottom)||(u["!margins"].bottom=+Ie.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Ow(W,z,ee,a.slice(L,o.index)):(ee=o,L=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var he={};return!t.bookSheets&&!t.bookProps&&(he.Sheets=f),he.SheetNames=d,he.Workbook=R,he.SSF=Je(ge),he.Props=M,he.Custprops=W,he}function $s(e,r){switch(Ao(r=r||{}),r.type||"base64"){case"base64":return bs(Qt(e),r);case"binary":case"buffer":case"file":return bs(e,r);case"array":return bs(ra(e),r)}}function Dw(e,r){var t=[];return e.Props&&t.push(np(e.Props,r)),e.Custprops&&t.push(ip(e.Props,e.Custprops,r)),t.join("")}function Nw(){return""}function Lw(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(a,n){var i=[];i.push(se("NumberFormat",null,{"ss:Format":Ge(ge[a.numFmtId])}));var s={"ss:ID":"s"+(21+n)};t.push(se("Style",i.join(""),s))}),se("Styles",t.join(""))}function xf(e){return se("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ko(e.Ref,{r:0,c:0})})}function Bw(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],a=0;a<r.length;++a){var n=r[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||t.push(xf(n)))}return se("Names",t.join(""))}function Mw(e,r,t,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],s=0;s<n.length;++s){var o=n[s];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||i.push(xf(o)))}return i.join("")}function $w(e,r,t,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(se("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(se("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(se("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t])if(a.Workbook.Sheets[t].Hidden)n.push(se("Visible",a.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==t&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Ct("ProtectContents","True")),e["!protect"].objects&&n.push(Ct("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Ct("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Ct("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Ct("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&n.push("<"+s[1]+"/>")})),n.length==0?"":se("WorksheetOptions",n.join(""),{xmlns:Kt.x})}function Uw(e){return e.map(function(r){var t=sh(r.t||""),a=se("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return se("Comment",a,{"ss:Author":r.a})}).join("")}function jw(e,r,t,a,n,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ge(ko(e.f,s))),e.F&&e.F.slice(0,r.length)==r){var c=et(e.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ge(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ge(e.l.Tooltip))),t["!merges"])for(var l=t["!merges"],f=0;f!=l.length;++f)l[f].s.c!=s.c||l[f].s.r!=s.r||(l[f].e.c>l[f].s.c&&(o["ss:MergeAcross"]=l[f].e.c-l[f].s.c),l[f].e.r>l[f].s.r&&(o["ss:MergeDown"]=l[f].e.r-l[f].s.r));var d="",u="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":d="Number",u=String(e.v);break;case"b":d="Boolean",u=e.v?"1":"0";break;case"e":d="Error",u=Hr[e.v];break;case"d":d="DateTime",u=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ge[14]);break;case"s":d="String",u=ih(e.v||"");break}var h=na(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var m=e.v!=null?u:"",p=e.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=Uw(e.c)),se("Cell",p,o)}function Hw(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Xa(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Vw(e,r,t,a){if(!e["!ref"])return"";var n=Be(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,v){Qr(g);var y=!!g.width,x=ji(v,g),F={"ss:Index":v+1};y&&(F["ss:Width"]=Rn(x.width)),g.hidden&&(F["ss:Hidden"]="1"),o.push(se("Column",null,F))});for(var c=Array.isArray(e),l=n.s.r;l<=n.e.r;++l){for(var f=[Hw(l,(e["!rows"]||[])[l])],d=n.s.c;d<=n.e.c;++d){var u=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>d)&&!(i[s].s.r>l)&&!(i[s].e.c<d)&&!(i[s].e.r<l)){(i[s].s.c!=d||i[s].s.r!=l)&&(u=!0);break}if(!u){var h={r:l,c:d},m=xe(h),p=c?(e[l]||[])[d]:e[m];f.push(jw(p,m,e,r,t,a,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function Ww(e,r,t){var a=[],n=t.SheetNames[e],i=t.Sheets[n],s=i?Mw(i,r,e,t):"";return s.length>0&&a.push("<Names>"+s+"</Names>"),s=i?Vw(i,r,e,t):"",s.length>0&&a.push("<Table>"+s+"</Table>"),a.push($w(i,r,e,t)),a.join("")}function Gw(e,r){r||(r={}),e.SSF||(e.SSF=Je(ge)),e.SSF&&(qa(),Ri(e.SSF),r.revssf=Ni(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],na(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Dw(e,r)),t.push(Nw(e,r)),t.push(""),t.push("");for(var a=0;a<e.SheetNames.length;++a)t.push(se("Worksheet",Ww(a,r,e),{"ss:Name":Ge(e.SheetNames[a])}));return t[2]=Lw(e,r),t[3]=Bw(e,r),ft+se("Workbook",t.join(""),{xmlns:Kt.ss,"xmlns:o":Kt.o,"xmlns:x":Kt.x,"xmlns:ss":Kt.ss,"xmlns:dt":Kt.dt,"xmlns:html":Kt.html})}function zw(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Bh(t),t.length-t.l<=4)return r;var a=t.read_shift(4);if(a==0||a>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(a=t.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=Mh(t),a=t.read_shift(4),a==0||a>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var Xw=[60,1084,2066,2165,2175];function Yw(e,r,t,a,n){var i=a,s=[],o=t.slice(t.l,t.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}s.push(o),t.l+=i;for(var c=Nr(t,t.l),l=Us[c],f=0;l!=null&&Xw.indexOf(c)>-1;)i=Nr(t,t.l+2),f=t.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=t.slice(f,t.l+4+i),s.push(o),t.l+=4+i,l=Us[c=Nr(t,t.l)];var d=Et(s);Tt(d,0);var u=0;d.lens=[];for(var h=0;h<s.length;++h)d.lens.push(u),u+=s[h].length;if(d.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+a;return r.f(d,d.length,n)}function kr(e,r,t){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=ge[a])}catch(i){if(r.WTF)throw i}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Hr[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Cn(e.v):e.w=xa(e.v):e.w=lr(a,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&a&&e.t=="n"&&Ya(ge[a]||String(a))){var n=da(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function xi(e,r,t){return{v:e,ixfe:r,t}}function qw(e,r){var t={opts:{}},a={};at!=null&&r.dense==null&&(r.dense=at);var n=r.dense?[]:{},i={},s={},o=null,c=[],l="",f={},d,u="",h,m,p,g,v={},y=[],x,F,I=[],A=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},D=function(Oe){return Oe<8?ha[Oe]:Oe<64&&A[Oe-8]||ha[Oe]},M=function(Oe,ot,tr){var gt=ot.XF.data;if(!(!gt||!gt.patternType||!tr||!tr.cellStyles)){ot.s={},ot.s.patternType=gt.patternType;var la;(la=Pn(D(gt.icvFore)))&&(ot.s.fgColor={rgb:la}),(la=Pn(D(gt.icvBack)))&&(ot.s.bgColor={rgb:la})}},W=function(Oe,ot,tr){if(!(G>1)&&!(tr.sheetRows&&Oe.r>=tr.sheetRows)){if(tr.cellStyles&&ot.XF&&ot.XF.data&&M(Oe,ot,tr),delete ot.ixfe,delete ot.XF,d=Oe,u=xe(Oe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Oe.r<s.s.r&&(s.s.r=Oe.r),Oe.c<s.s.c&&(s.s.c=Oe.c),Oe.r+1>s.e.r&&(s.e.r=Oe.r+1),Oe.c+1>s.e.c&&(s.e.c=Oe.c+1),tr.cellFormula&&ot.f){for(var gt=0;gt<y.length;++gt)if(!(y[gt][0].s.c>Oe.c||y[gt][0].s.r>Oe.r)&&!(y[gt][0].e.c<Oe.c||y[gt][0].e.r<Oe.r)){ot.F=Ee(y[gt][0]),(y[gt][0].s.c!=Oe.c||y[gt][0].s.r!=Oe.r)&&delete ot.f,ot.f&&(ot.f=""+Pt(y[gt][1],s,Oe,re,L));break}}tr.dense?(n[Oe.r]||(n[Oe.r]=[]),n[Oe.r][Oe.c]=ot):n[u]=ot}},L={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(L.password=r.password);var ee,de=[],J=[],te=[],ie=[],ye=!1,re=[];re.SheetNames=L.snames,re.sharedf=L.sharedf,re.arrayf=L.arrayf,re.names=[],re.XTI=[];var Z=0,G=0,C=0,B=[],R=[],P;L.codepage=1200,gr(1200);for(var z=!1;e.l<e.length-1;){var fe=e.l,ae=e.read_shift(2);if(ae===0&&Z===10)break;var ne=e.l===e.length?0:e.read_shift(2),q=Us[ae];if(q&&q.f){if(r.bookSheets&&Z===133&&ae!==133)break;if(Z=ae,q.r===2||q.r==12){var ke=e.read_shift(2);if(ne-=2,!L.enc&&ke!==ae&&((ke&255)<<8|ke>>8)!==ae)throw new Error("rt mismatch: "+ke+"!="+ae);q.r==12&&(e.l+=10,ne-=10)}var O={};if(ae===10?O=q.f(e,ne,L):O=Yw(ae,q,e,ne,L),G==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(ae){case 34:t.opts.Date1904=k.WBProps.date1904=O;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=O,!r.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=O;break;case 66:var je=Number(O);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}gr(L.codepage=je),z=!0;break;case 317:L.rrtabid=O;break;case 25:L.winlocked=O;break;case 439:t.opts.RefreshAll=O;break;case 12:t.opts.CalcCount=O;break;case 16:t.opts.CalcDelta=O;break;case 17:t.opts.CalcIter=O;break;case 13:t.opts.CalcMode=O;break;case 14:t.opts.CalcPrecision=O;break;case 95:t.opts.CalcSaveRecalc=O;break;case 15:L.CalcRefMode=O;break;case 2211:t.opts.FullCalc=O;break;case 129:O.fDialog&&(n["!type"]="dialog"),O.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),O.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:I.push(O);break;case 430:re.push([O]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(O);break;case 24:case 536:P={Name:O.Name,Ref:Pt(O.rgce,s,null,re,L)},O.itab>0&&(P.Sheet=O.itab-1),re.names.push(P),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(R[O.itab-1]={ref:Ee(O.rgce[0][0][1][2])});break;case 22:L.ExternCount=O;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(O),re.XTI=re.XTI.concat(O);break;case 2196:if(L.biff<8)break;P!=null&&(P.Comment=O[1]);break;case 18:n["!protect"]=O;break;case 19:O!==0&&L.WTF&&console.error("Password verifier: "+O);break;case 133:i[O.pos]=O,L.snames.push(O.name);break;case 10:{if(--G)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,n["!ref"]=Ee(s),r.sheetRows&&r.sheetRows<=s.e.r){var Fe=s.e.r;s.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Ee(s),s.e.r=Fe}s.e.r++,s.e.c++}de.length>0&&(n["!merges"]=de),J.length>0&&(n["!objects"]=J),te.length>0&&(n["!cols"]=te),ie.length>0&&(n["!rows"]=ie),k.Sheets.push(N)}l===""?f=n:a[l]=n,n=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),L.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(L.biff=5,z=!0,gr(L.codepage=28591)),L.biff==8&&O.BIFFVer==0&&O.dt==16&&(L.biff=2),G++)break;if(n=r.dense?[]:{},L.biff<8&&!z&&(z=!0,gr(L.codepage=r.codepage||1252)),L.biff<5||O.BIFFVer==0&&O.dt==4096){l===""&&(l="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var He={pos:e.l-ne,name:l};i[He.pos]=He,L.snames.push(l)}else l=(i[fe]||{name:""}).name;O.dt==32&&(n["!type"]="chart"),O.dt==64&&(n["!type"]="macro"),de=[],J=[],L.arrayf=y=[],te=[],ie=[],ye=!1,N={Hidden:(i[fe]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(r.dense?(n[O.r]||[])[O.c]:n[xe({c:O.c,r:O.r})])&&++O.c,x={ixfe:O.ixfe,XF:I[O.ixfe]||{},v:O.val,t:"n"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W({c:O.c,r:O.r},x,r);break;case 5:case 517:x={ixfe:O.ixfe,XF:I[O.ixfe],v:O.val,t:O.t},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W({c:O.c,r:O.r},x,r);break;case 638:x={ixfe:O.ixfe,XF:I[O.ixfe],v:O.rknum,t:"n"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W({c:O.c,r:O.r},x,r);break;case 189:for(var Ie=O.c;Ie<=O.C;++Ie){var he=O.rkrec[Ie-O.c][0];x={ixfe:he,XF:I[he],v:O.rkrec[Ie-O.c][1],t:"n"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W({c:Ie,r:O.r},x,r)}break;case 6:case 518:case 1030:{if(O.val=="String"){o=O;break}if(x=xi(O.val,O.cell.ixfe,O.tt),x.XF=I[x.ixfe],r.cellFormula){var st=O.formula;if(st&&st[0]&&st[0][0]&&st[0][0][0]=="PtgExp"){var er=st[0][0][1][0],wr=st[0][0][1][1],Pr=xe({r:er,c:wr});v[Pr]?x.f=""+Pt(O.formula,s,O.cell,re,L):x.F=((r.dense?(n[er]||[])[wr]:n[Pr])||{}).F}else x.f=""+Pt(O.formula,s,O.cell,re,L)}C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W(O.cell,x,r),o=O}break;case 7:case 519:if(o)o.val=O,x=xi(O,o.cell.ixfe,"s"),x.XF=I[x.ixfe],r.cellFormula&&(x.f=""+Pt(o.formula,s,o.cell,re,L)),C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W(o.cell,x,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(O);var sn=xe(O[0].s);if(h=r.dense?(n[O[0].s.r]||[])[O[0].s.c]:n[sn],r.cellFormula&&h){if(!o||!sn||!h)break;h.f=""+Pt(O[1],s,O[0],re,L),h.F=Ee(O[0])}}break;case 1212:{if(!r.cellFormula)break;if(u){if(!o)break;v[xe(o.cell)]=O[0],h=r.dense?(n[o.cell.r]||[])[o.cell.c]:n[xe(o.cell)],(h||{}).f=""+Pt(O[0],s,d,re,L)}}break;case 253:x=xi(c[O.isst].t,O.ixfe,"s"),c[O.isst].h&&(x.h=c[O.isst].h),x.XF=I[x.ixfe],C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W({c:O.c,r:O.r},x,r);break;case 513:r.sheetStubs&&(x={ixfe:O.ixfe,XF:I[O.ixfe],t:"z"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W({c:O.c,r:O.r},x,r));break;case 190:if(r.sheetStubs)for(var zr=O.c;zr<=O.C;++zr){var Yt=O.ixfe[zr-O.c];x={ixfe:Yt,XF:I[Yt],t:"z"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W({c:zr,r:O.r},x,r)}break;case 214:case 516:case 4:x=xi(O.val,O.ixfe,"s"),x.XF=I[x.ixfe],C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),W({c:O.c,r:O.r},x,r);break;case 0:case 512:G===1&&(s=O);break;case 252:c=O;break;case 1054:if(L.biff==4){B[C++]=O[1];for(var Rr=0;Rr<C+163&&ge[Rr]!=O[1];++Rr);Rr>=163&&Br(O[1],C+163)}else Br(O[1],O[0]);break;case 30:{B[C++]=O;for(var Xr=0;Xr<C+163&&ge[Xr]!=O;++Xr);Xr>=163&&Br(O,C+163)}break;case 229:de=de.concat(O);break;case 93:J[O.cmo[0]]=L.lastobj=O;break;case 438:L.lastobj.TxO=O;break;case 127:L.lastobj.ImData=O;break;case 440:for(g=O[0].s.r;g<=O[0].e.r;++g)for(p=O[0].s.c;p<=O[0].e.c;++p)h=r.dense?(n[g]||[])[p]:n[xe({c:p,r:g})],h&&(h.l=O[1]);break;case 2048:for(g=O[0].s.r;g<=O[0].e.r;++g)for(p=O[0].s.c;p<=O[0].e.c;++p)h=r.dense?(n[g]||[])[p]:n[xe({c:p,r:g})],h&&h.l&&(h.l.Tooltip=O[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;h=r.dense?(n[O[0].r]||[])[O[0].c]:n[xe(O[0])];var on=J[O[2]];h||(r.dense?(n[O[0].r]||(n[O[0].r]=[]),h=n[O[0].r][O[0].c]={t:"z"}):h=n[xe(O[0])]={t:"z"},s.e.r=Math.max(s.e.r,O[0].r),s.s.r=Math.min(s.s.r,O[0].r),s.e.c=Math.max(s.e.c,O[0].c),s.s.c=Math.min(s.s.c,O[0].c)),h.c||(h.c=[]),m={a:O[1],t:on.TxO.t},h.c.push(m)}break;case 2173:Lg(I[O.ixfe],O.ext);break;case 125:{if(!L.cellStyles)break;for(;O.e>=O.s;)te[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},ye||(ye=!0,yo(O.w/256)),Qr(te[O.e+1])}break;case 520:{var $t={};O.level!=null&&(ie[O.r]=$t,$t.level=O.level),O.hidden&&(ie[O.r]=$t,$t.hidden=!0),O.hpt&&(ie[O.r]=$t,$t.hpt=O.hpt,$t.hpx=Xa(O.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||ga(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=O;break;case 161:n["!margins"]||ga(n["!margins"]={}),n["!margins"].header=O.header,n["!margins"].footer=O.footer;break;case 574:O.RTL&&(k.Views[0].RTL=!0);break;case 146:A=O;break;case 2198:ee=O;break;case 140:F=O;break;case 442:l?N.CodeName=O||N.name:k.WBProps.CodeName=O||"ThisWorkbook";break}}else q||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=ne}return t.SheetNames=nt(i).sort(function(_r,Oe){return Number(_r)-Number(Oe)}).map(function(_r){return i[_r].name}),r.bookSheets||(t.Sheets=a),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&R.forEach(function(_r,Oe){t.Sheets[t.SheetNames[Oe]]["!autofilter"]=_r}),t.Strings=c,t.SSF=Je(ge),L.enc&&(t.Encryption=L.enc),ee&&(t.Themes=ee),t.Metadata={},F!==void 0&&(t.Metadata.Country=F),re.names.length>0&&(k.Names=re.names),t.Workbook=k,t}var Sn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Kw(e,r,t){var a=me.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Zc(a,Rs,Sn.DSI);for(var i in n)r[i]=n[i]}catch(l){if(t.WTF)throw l}var s=me.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=Zc(s,Ds,Sn.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(m0(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function Jw(e,r){var t=[],a=[],n=[],i=0,s,o=Ac(Rs,"n"),c=Ac(Ds,"n");if(e.Props)for(s=nt(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(c,s[i])?a:n).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=nt(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(c,s[i])?a:n).push([s[i],e.Custprops[s[i]]]);var l=[];for(i=0;i<n.length;++i)k0.indexOf(n[i][0])>-1||p0.indexOf(n[i][0])>-1||n[i][1]!=null&&l.push(n[i]);a.length&&me.utils.cfb_add(r,"/SummaryInformation",Qc(a,Sn.SI,c,Ds)),(t.length||l.length)&&me.utils.cfb_add(r,"/DocumentSummaryInformation",Qc(t,Sn.DSI,o,Rs,l.length?l:null,Sn.UDI))}function vf(e,r){r||(r={}),Ao(r),Ws(),r.codepage&&Vs(r.codepage);var t,a;if(e.FullPaths){if(me.find(e,"/encryption"))throw new Error("File is password-protected");t=me.find(e,"!CompObj"),a=me.find(e,"/Workbook")||me.find(e,"/Book")}else{switch(r.type){case"base64":e=Jt(Qt(e));break;case"binary":e=Jt(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Tt(e,0),a={content:e}}var n,i;if(t&&zw(t),r.bookProps&&!r.bookSheets)n={};else{var s=Ae?"buffer":"array";if(a&&a.content)n=qw(a.content,r);else if((i=me.find(e,"PerfectOffice_MAIN"))&&i.content)n=ma.to_workbook(i.content,(r.type=s,r));else if((i=me.find(e,"NativeContent_MAIN"))&&i.content)n=ma.to_workbook(i.content,(r.type=s,r));else throw(i=me.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&me.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=fx(e))}var o={};return e.FullPaths&&Kw(e,o,r),n.Props=n.Custprops=o,r.bookFiles&&(n.cfb=e),n}function Zw(e,r){var t=r||{},a=me.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return me.utils.cfb_add(a,n,yf(e,t)),t.biff==8&&(e.Props||e.Custprops)&&Jw(e,a),t.biff==8&&e.vbaraw&&ux(a,me.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Ln={0:{f:k2},1:{f:F2},2:{f:q2},3:{f:M2},4:{f:D2},5:{f:z2},6:{f:ey},7:{f:H2},8:{f:oy},9:{f:sy},10:{f:ny},11:{f:iy},12:{f:P2},13:{f:J2},14:{f:U2},15:{f:L2},16:{f:ff},17:{f:ry},18:{f:W2},19:{f:co},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:rw},40:{},42:{},43:{f:eg},44:{f:Zm},45:{f:ag},46:{f:ig},47:{f:ng},48:{},49:{f:bh},50:{},51:{f:$g},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R0},62:{f:Q2},63:{f:Yg},64:{f:Ey},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Bt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yy},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:A2},148:{f:b2,p:16},151:{f:hy},152:{},153:{f:Qy},154:{},155:{},156:{f:Jy},157:{},158:{},159:{T:1,f:mm},160:{T:-1},161:{T:1,f:Ca},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cy},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Bg},336:{T:-1},337:{f:Hg,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ps},357:{},358:{},359:{},360:{T:1},361:{},362:{f:P0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:py},427:{f:my},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xy},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:C2},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uy},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ps},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ix},633:{T:1},634:{T:-1},635:{T:1,f:ax},636:{T:-1},637:{f:Oh},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Uy},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Sy},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Us={6:{f:Es},10:{f:qr},12:{f:mt},13:{f:mt},14:{f:ct},15:{f:ct},16:{f:Dt},17:{f:ct},18:{f:ct},19:{f:mt},20:{f:il},21:{f:il},23:{f:P0},24:{f:ol},25:{f:ct},26:{},27:{},28:{f:S1},29:{},34:{f:ct},35:{f:sl},38:{f:Dt},39:{f:Dt},40:{f:Dt},41:{f:Dt},42:{f:ct},43:{f:ct},47:{f:Lm},49:{f:Jp},51:{f:mt},60:{},61:{f:zp},64:{f:ct},65:{f:Kp},66:{f:mt},77:{},80:{},81:{},82:{},85:{f:mt},89:{},90:{},91:{},92:{f:Np},93:{f:C1},94:{},95:{f:ct},96:{},97:{},99:{f:ct},125:{f:R0},128:{f:d1},129:{f:Bp},130:{f:mt},131:{f:ct},132:{f:ct},133:{f:Mp},134:{},140:{f:N1},141:{f:mt},144:{},146:{f:M1},151:{},152:{},153:{},154:{},155:{},156:{f:mt},157:{},158:{},160:{f:G1},161:{f:j1},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:c1},190:{f:l1},193:{f:qr},197:{},198:{},199:{},200:{},201:{},202:{f:ct},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mt},220:{},221:{f:ct},222:{},224:{f:u1},225:{f:Dp},226:{f:qr},227:{},229:{f:b1},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Up},253:{f:Qp},255:{f:Hp},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:E0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ct},353:{f:qr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:x1},431:{f:ct},432:{},433:{},434:{},437:{},438:{f:F1},439:{f:ct},440:{f:I1},441:{},442:{f:jn},443:{},444:{f:mt},445:{},446:{},448:{f:qr},449:{f:Gp,r:2},450:{f:qr},512:{f:rl},513:{f:W1},515:{f:m1},516:{f:t1},517:{f:nl},519:{f:z1},520:{f:Vp},523:{},545:{f:cl},549:{f:tl},566:{},574:{f:Yp},638:{f:o1},659:{},1048:{},1054:{f:a1},1084:{},1212:{f:_1},2048:{f:R1},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:pi},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:qr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:$1,r:12},2173:{f:Ng,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ct,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:w1,r:12},2197:{},2198:{f:Og,r:12},2199:{},2200:{},2201:{},2202:{f:k1,r:12},2203:{f:qr},2204:{},2205:{},2206:{},2207:{},2211:{f:Wp},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:H1},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:B1},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:rl},1:{},2:{f:J1},3:{f:q1},4:{f:Y1},5:{f:nl},7:{f:Q1},8:{},9:{f:pi},11:{},22:{f:mt},30:{f:i1},31:{},32:{},33:{f:cl},36:{},37:{f:tl},50:{f:em},62:{},52:{},67:{},68:{f:mt},69:{},86:{},126:{},127:{f:X1},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:tm},223:{},234:{},354:{},421:{},518:{f:Es},521:{f:pi},536:{f:ol},547:{f:sl},561:{},579:{},1030:{f:Es},1033:{f:pi},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function oe(e,r,t,a){var n=r;if(!isNaN(n)){var i=a||(t||[]).length||0,s=e.next(4);s.write_shift(2,n),s.write_shift(2,i),i>0&&io(t)&&e.push(t)}}function Qw(e,r,t,a){var n=a||(t||[]).length||0;if(n<=8224)return oe(e,r,t,n);var i=r;if(!isNaN(i)){for(var s=t.parts||[],o=0,c=0,l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,l),e.push(t.slice(c,c+l)),c+=l;c<n;){for(f=e.next(4),f.write_shift(2,60),l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;f.write_shift(2,l),e.push(t.slice(c,c+l)),c+=l}}}function Gn(e,r,t){return e||(e=X(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function e_(e,r,t,a){var n=X(9);return Gn(n,e,r),S0(t,a||"b",n),n}function t_(e,r,t){var a=X(8+2*t.length);return Gn(a,e,r),a.write_shift(1,t.length),a.write_shift(t.length,t,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function r_(e,r,t,a){if(r.v!=null)switch(r.t){case"d":case"n":var n=r.t=="d"?yt(Ke(r.v)):r.v;n==(n|0)&&n>=0&&n<65536?oe(e,2,Z1(t,a,n)):oe(e,3,K1(t,a,n));return;case"b":case"e":oe(e,5,e_(t,a,r.v,r.t));return;case"s":case"str":oe(e,4,t_(t,a,(r.v||"").slice(0,255)));return}oe(e,1,Gn(null,t,a))}function a_(e,r,t,a){var n=Array.isArray(r),i=Be(r["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Ee(i)}for(var l=i.s.r;l<=i.e.r;++l){o=lt(l);for(var f=i.s.c;f<=i.e.c;++f){l===i.s.r&&(c[f]=Qe(f)),s=c[f]+o;var d=n?(r[l]||[])[f]:r[s];d&&r_(e,d,l,f,a)}}}function n_(e,r){var t=r||{};at!=null&&t.dense==null&&(t.dense=at);for(var a=zt(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(n=i);if(n==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return oe(a,t.biff==4?1033:t.biff==3?521:9,go(e,16,t)),a_(a,e.Sheets[e.SheetNames[n]],n,t,e),oe(a,10),a.end()}function i_(e,r,t){oe(e,49,Zp({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function s_(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&oe(e,1054,n1(n,r[n],t))})}function o_(e,r){var t=X(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),oe(e,2151,t),t=X(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),O0(Be(r["!ref"]||"A1"),t),t.write_shift(4,4),oe(e,2152,t)}function c_(e,r){for(var t=0;t<16;++t)oe(e,224,al({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(a){oe(e,224,al(a,0,r))})}function l_(e,r){for(var t=0;t<r["!links"].length;++t){var a=r["!links"][t];oe(e,440,P1(a)),a[1].Tooltip&&oe(e,2048,D1(a))}delete r["!links"]}function f_(e,r){if(r){var t=0;r.forEach(function(a,n){++t<=256&&a&&oe(e,125,U1(ji(n,a),n))})}}function u_(e,r,t,a,n){var i=16+na(n.cellXfs,r,n);if(r.v==null&&!r.bf){oe(e,513,_a(t,a,i));return}if(r.bf)oe(e,6,Bv(r,t,a,n,i));else switch(r.t){case"d":case"n":var s=r.t=="d"?yt(Ke(r.v)):r.v;oe(e,515,g1(t,a,s,i,n));break;case"b":case"e":oe(e,517,p1(t,a,r.v,i,n,r.t));break;case"s":case"str":if(n.bookSST){var o=So(n.Strings,r.v,n.revStrings);oe(e,253,e1(t,a,o,i,n))}else oe(e,516,r1(t,a,(r.v||"").slice(0,255),i,n));break;default:oe(e,513,_a(t,a,i))}}function d_(e,r,t){var a=zt(),n=t.SheetNames[e],i=t.Sheets[n]||{},s=(t||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),l=r.biff==8,f,d="",u=[],h=Be(i["!ref"]||"A1"),m=l?65536:16384;if(h.e.c>255||h.e.r>=m){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}oe(a,2057,go(t,16,r)),oe(a,13,or(1)),oe(a,12,or(100)),oe(a,15,Ht(!0)),oe(a,17,Ht(!1)),oe(a,16,ya(.001)),oe(a,95,Ht(!0)),oe(a,42,Ht(!1)),oe(a,43,Ht(!1)),oe(a,130,or(1)),oe(a,128,h1([0,0])),oe(a,131,Ht(!1)),oe(a,132,Ht(!1)),l&&f_(a,i["!cols"]),oe(a,512,s1(h,r)),l&&(i["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){d=lt(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(u[g]=Qe(g)),f=u[g]+d;var v=c?(i[p]||[])[g]:i[f];v&&(u_(a,v,p,g,r),l&&v.l&&i["!links"].push([f,v.l]))}}var y=o.CodeName||o.name||n;return l&&oe(a,574,qp((s.Views||[])[0])),l&&(i["!merges"]||[]).length&&oe(a,229,T1(i["!merges"])),l&&l_(a,i),oe(a,442,b0(y,r)),l&&o_(a,i),oe(a,10),a.end()}function h_(e,r,t){var a=zt(),n=(e||{}).Workbook||{},i=n.Sheets||[],s=n.WBProps||{},o=t.biff==8,c=t.biff==5;if(oe(a,2057,go(e,5,t)),t.bookType=="xla"&&oe(a,135),oe(a,225,o?or(1200):null),oe(a,193,pp(2)),c&&oe(a,191),c&&oe(a,192),oe(a,226),oe(a,92,Lp("SheetJS",t)),oe(a,66,or(o?1200:1252)),o&&oe(a,353,or(0)),o&&oe(a,448),oe(a,317,V1(e.SheetNames.length)),o&&e.vbaraw&&oe(a,211),o&&e.vbaraw){var l=s.CodeName||"ThisWorkbook";oe(a,442,b0(l,t))}oe(a,156,or(17)),oe(a,25,Ht(!1)),oe(a,18,Ht(!1)),oe(a,19,or(0)),o&&oe(a,431,Ht(!1)),o&&oe(a,444,or(0)),oe(a,61,Xp(t)),oe(a,64,Ht(!1)),oe(a,141,or(0)),oe(a,34,Ht(Gy(e)=="true")),oe(a,14,Ht(!0)),o&&oe(a,439,Ht(!1)),oe(a,218,or(0)),i_(a,e,t),s_(a,e.SSF,t),c_(a,t),o&&oe(a,352,Ht(!1));var f=a.end(),d=zt();o&&oe(d,140,L1()),o&&t.Strings&&Qw(d,252,jp(t.Strings,t)),oe(d,10);var u=d.end(),h=zt(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=f.length+m+u.length;for(p=0;p<e.SheetNames.length;++p){var v=i[p]||{};oe(h,133,$p({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},t)),g+=r[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var x=[];return f.length&&x.push(f),y.length&&x.push(y),u.length&&x.push(u),Et(x)}function p_(e,r){var t=r||{},a=[];e&&!e.SSF&&(e.SSF=Je(ge)),e&&e.SSF&&(qa(),Ri(e.SSF),t.revssf=Ni(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Oo(t),t.cellXfs=[],na(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=d_(n,t,e);return a.unshift(h_(e,a,t)),Et(a)}function yf(e,r){for(var t=0;t<=e.SheetNames.length;++t){var a=e.Sheets[e.SheetNames[t]];if(!(!a||!a["!ref"])){var n=Xt(a["!ref"]);n.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return p_(e,r);case 4:case 3:case 2:return n_(e,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function vl(e,r){var t=r||{};at!=null&&t.dense==null&&(t.dense=at);var a=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=n.index,o=i&&i.index||e.length,c=Zd(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,d=0,u=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<c.length;++s){var p=c[s].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var v=p.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var x=y,F=0;x.charAt(0)=="<"&&(F=x.indexOf(">"))>-1;)x=x.slice(F+1);for(var I=0;I<m.length;++I){var A=m[I];A.s.c==f&&A.s.r<l&&l<=A.e.r&&(f=A.e.c+1,I=-1)}var k=ve(y.slice(0,y.indexOf(">")));u=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||u>1)&&m.push({s:{r:l,c:f},e:{r:l+(d||1)-1,c:f+u-1}});var N=k.t||k["data-t"]||"";if(!x.length){f+=u;continue}if(x=Xl(x),h.s.r>l&&(h.s.r=l),h.e.r<l&&(h.e.r=l),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!x.length){f+=u;continue}var D={t:"s",v:x};t.raw||!x.trim().length||N=="s"||(x==="TRUE"?D={t:"b",v:!0}:x==="FALSE"?D={t:"b",v:!1}:isNaN(vr(x))?isNaN(Ga(x).getDate())||(D={t:"d",v:Ke(x)},t.cellDates||(D={t:"n",v:yt(D.v)}),D.z=t.dateNF||ge[14]):D={t:"n",v:vr(x)}),t.dense?(a[l]||(a[l]=[]),a[l][f]=D):a[xe({r:l,c:f})]=D,f+=u}}}}return a["!ref"]=Ee(h),m.length&&(a["!merges"]=m),a}function m_(e,r,t,a){for(var n=e["!merges"]||[],i=[],s=r.s.c;s<=r.e.c;++s){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>t||n[l].s.c>s)&&!(n[l].e.r<t||n[l].e.c<s)){if(n[l].s.r<t||n[l].s.c<s){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var f=xe({r:t,c:s}),d=a.dense?(e[t]||[])[s]:e[f],u=d&&d.v!=null&&(d.h||Zs(d.w||($r(d),d.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),a.editable?u='<span contenteditable="true">'+u+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+d.l.Target+'">'+u+"</a>")),h.id=(a.id||"sjs")+"-"+f,i.push(se("td",u,h))}}var m="<tr>";return m+i.join("")+"</tr>"}var g_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',x_="</body></html>";function v_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return aa(vl(t[0],r),r);var a=Ro();return t.forEach(function(n,i){Do(a,vl(n,r),"Sheet"+(i+1))}),a}function y_(e,r,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function wf(e,r){var t=r||{},a=t.header!=null?t.header:g_,n=t.footer!=null?t.footer:x_,i=[a],s=Xt(e["!ref"]);t.dense=Array.isArray(e),i.push(y_(e,s,t));for(var o=s.s.r;o<=s.e.r;++o)i.push(m_(e,s,o,t));return i.push("</table>"+n),i.join("")}function _f(e,r,t){var a=t||{};at!=null&&(a.dense=at);var n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var s=typeof a.origin=="string"?et(a.origin):a.origin;n=s.r,i=s.c}var o=r.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var f=Xt(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),n==-1&&(l.e.r=n=f.e.r+1)}var d=[],u=0,h=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,v=0,y=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<c;++m){var F=o[m];if(yl(F)){if(a.display)continue;h[p]={hidden:!0}}var I=F.children;for(g=v=0;g<I.length;++g){var A=I[g];if(!(a.display&&yl(A))){var k=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):Xl(A.innerHTML),N=A.getAttribute("data-z")||A.getAttribute("z");for(u=0;u<d.length;++u){var D=d[u];D.s.c==v+i&&D.s.r<p+n&&p+n<=D.e.r&&(v=D.e.c+1-i,u=-1)}x=+A.getAttribute("colspan")||1,((y=+A.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:p+n,c:v+i},e:{r:p+n+(y||1)-1,c:v+i+(x||1)-1}});var M={t:"s",v:k},W=A.getAttribute("data-t")||A.getAttribute("t")||"";k!=null&&(k.length==0?M.t=W||"z":a.raw||k.trim().length==0||W=="s"||(k==="TRUE"?M={t:"b",v:!0}:k==="FALSE"?M={t:"b",v:!1}:isNaN(vr(k))?isNaN(Ga(k).getDate())||(M={t:"d",v:Ke(k)},a.cellDates||(M={t:"n",v:yt(M.v)}),M.z=a.dateNF||ge[14]):M={t:"n",v:vr(k)})),M.z===void 0&&N!=null&&(M.z=N);var L="",ee=A.getElementsByTagName("A");if(ee&&ee.length)for(var de=0;de<ee.length&&!(ee[de].hasAttribute("href")&&(L=ee[de].getAttribute("href"),L.charAt(0)!="#"));++de);L&&L.charAt(0)!="#"&&(M.l={Target:L}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][v+i]=M):e[xe({c:v+i,r:p+n})]=M,l.e.c<v+i&&(l.e.c=v+i),v+=x}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),l.e.r=Math.max(l.e.r,p-1+n),e["!ref"]=Ee(l),p>=c&&(e["!fullref"]=Ee((l.e.r=o.length-m+p-1+n,l))),e}function kf(e,r){var t=r||{},a=t.dense?[]:{};return _f(a,e,r)}function w_(e,r){return aa(kf(e,r),r)}function yl(e){var r="",t=__(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function __(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function k_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Le(r.replace(/<[^>]*>/g,""));return[t]}var wl={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ef(e,r){var t=r||{};at!=null&&t.dense==null&&(t.dense=at);var a=Qs(e),n=[],i,s,o={name:""},c="",l=0,f,d,u={},h=[],m=t.dense?[]:{},p,g,v={value:""},y="",x=0,F,I=[],A=-1,k=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,M={},W=[],L={},ee=0,de=0,J=[],te=1,ie=1,ye=[],re={Names:[]},Z={},G=["",""],C=[],B={},R="",P=0,z=!1,fe=!1,ae=0;for(Fn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Fn.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":p[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?m["!ref"]=Ee(N):m["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=t.sheetRows-1,m["!ref"]=Ee(N)),W.length&&(m["!merges"]=W),J.length&&(m["!rows"]=J),f.name=f.\u540D\u79F0||f.name,typeof JSON!="undefined"&&JSON.stringify(f),h.push(f.name),u[f.name]=m,fe=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=ve(p[0],!1),A=k=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,m=t.dense?[]:{},W=[],J=[],fe=!0);break;case"table-row-group":p[1]==="/"?--D:++D;break;case"table-row":case"\u884C":if(p[1]==="/"){A+=te,te=1;break}if(d=ve(p[0],!1),d.\u884C\u53F7?A=d.\u884C\u53F7-1:A==-1&&(A=0),te=+d["number-rows-repeated"]||1,te<10)for(ae=0;ae<te;++ae)D>0&&(J[A+ae]={level:D});k=-1;break;case"covered-table-cell":p[1]!=="/"&&++k,t.sheetStubs&&(t.dense?(m[A]||(m[A]=[]),m[A][k]={t:"z"}):m[xe({r:A,c:k})]={t:"z"}),y="",I=[];break;case"table-cell":case"\u6570\u636E":if(p[0].charAt(p[0].length-2)==="/")++k,v=ve(p[0],!1),ie=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(g.f=ml(Le(v.formula))),(v.\u6570\u636E\u7C7B\u578B||v["value-type"])=="string"&&(g.t="s",g.v=Le(v["string-value"]||""),t.dense?(m[A]||(m[A]=[]),m[A][k]=g):m[xe({r:A,c:k})]=g),k+=ie-1;else if(p[1]!=="/"){++k,y="",x=0,I=[],ie=1;var ne=te?A+te-1:A;if(k>N.e.c&&(N.e.c=k),k<N.s.c&&(N.s.c=k),A<N.s.r&&(N.s.r=A),ne>N.e.r&&(N.e.r=ne),v=ve(p[0],!1),C=[],B={},g={t:v.\u6570\u636E\u7C7B\u578B||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=Le(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(ee=parseInt(v["number-matrix-rows-spanned"],10)||0,de=parseInt(v["number-matrix-columns-spanned"],10)||0,L={s:{r:A,c:k},e:{r:A+ee-1,c:k+de-1}},g.F=Ee(L),ye.push([L,g.F])),v.formula)g.f=ml(v.formula);else for(ae=0;ae<ye.length;++ae)A>=ye[ae][0].s.r&&A<=ye[ae][0].e.r&&k>=ye[ae][0].s.c&&k<=ye[ae][0].e.c&&(g.F=ye[ae][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(ee=parseInt(v["number-rows-spanned"],10)||0,de=parseInt(v["number-columns-spanned"],10)||0,L={s:{r:A,c:k},e:{r:A+ee-1,c:k+de-1}},W.push(L)),v["number-columns-repeated"]&&(ie=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=qe(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=Ke(v["date-value"]),t.cellDates||(g.t="n",g.v=yt(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=qd(v["time-value"])/86400,t.cellDates&&(g.t="d",g.v=Li(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.\u6570\u636E\u6570\u503C);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(y=Le(v["string-value"]),I=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(z=!1,g.t==="s"&&(g.v=y||"",I.length&&(g.R=I),z=x==0),Z.Target&&(g.l=Z),C.length>0&&(g.c=C,C=[]),y&&t.cellText!==!1&&(g.w=y),z&&(g.t="z",delete g.v),(!z||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=A))for(var q=0;q<te;++q){if(ie=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(m[A+q]||(m[A+q]=[]),m[A+q][k]=q==0?g:Je(g);--ie>0;)m[A+q][k+ie]=Je(g);else for(m[xe({r:A+q,c:k})]=g;--ie>0;)m[xe({r:A+q,c:k+ie})]=Je(g);N.e.c<=k&&(N.e.c=k)}ie=parseInt(v["number-columns-repeated"]||"1",10),k+=ie-1,ie=0,g={},y="",I=[]}Z={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i;B.t=y,I.length&&(B.R=I),B.a=R,C.push(B)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);R="",P=0,y="",x=0,I=[];break;case"creator":p[1]==="/"?R=a.slice(P,p.index):P=p.index+p[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);y="",x=0,I=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(M[o.name]=c,(i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=ve(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":s=ve(p[0],!1),c+=wl[p[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":s=ve(p[0],!1),c+=wl[p[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":s=ve(p[0],!1),G=Ss(s["cell-range-address"]);var ke={Name:s.name,Ref:G[0]+"!"+G[1]};fe&&(ke.Sheet=h.length),re.Names.push(ke);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var O=k_(a.slice(x,p.index),F);y=(y.length>0?y+`
`:"")+O[0]}else F=ve(p[0],!1),x=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{G=Ss(ve(p[0])["target-range-address"]),u[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Z=ve(p[0],!1),!Z.href)break;Z.Target=Le(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(G=Ss(Z.Target.slice(1)),Z.Target="#"+G[0]+"!"+G[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(t.WTF)throw new Error(p)}}var je={Sheets:u,SheetNames:h,Workbook:re};return t.bookSheets&&delete je.Sheets,je}function _l(e,r){r=r||{},sr(e,"META-INF/manifest.xml")&&qh(pt(e,"META-INF/manifest.xml"),r);var t=Zt(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var a=Ef(ze(t),r);return sr(e,"meta.xml")&&(a.Props=d0(pt(e,"meta.xml"))),a}function kl(e,r){return Ef(e,r)}var E_=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+On({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ft+r}})(),El=(function(){var e=function(i){return Ge(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,a=function(i,s,o){var c=[];c.push('      <table:table table:name="'+Ge(s.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,f=0,d=Xt(i["!ref"]||"A1"),u=i["!merges"]||[],h=0,m=Array.isArray(i);if(i["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(l=0;l<d.s.r;++l)p=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=d.e.r;++l){for(p=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+p+`>
`),f=0;f<d.s.c;++f)c.push(r);for(;f<=d.e.c;++f){var v=!1,y={},x="";for(h=0;h!=u.length;++h)if(!(u[h].s.c>f)&&!(u[h].s.r>l)&&!(u[h].e.c<f)&&!(u[h].e.r<l)){(u[h].s.c!=f||u[h].s.r!=l)&&(v=!0),y["table:number-columns-spanned"]=u[h].e.c-u[h].s.c+1,y["table:number-rows-spanned"]=u[h].e.r-u[h].s.r+1;break}if(v){c.push(t);continue}var F=xe({r:l,c:f}),I=m?(i[l]||[])[f]:i[F];if(I&&I.f&&(y["table:formula"]=Ge(Vv(I.f)),I.F&&I.F.slice(0,F.length)==F)){var A=Xt(I.F);y["table:number-matrix-columns-spanned"]=A.e.c-A.s.c+1,y["table:number-matrix-rows-spanned"]=A.e.r-A.s.r+1}if(!I){c.push(r);continue}switch(I.t){case"b":x=I.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=I.v?"true":"false";break;case"n":x=I.w||String(I.v||0),y["office:value-type"]="float",y["office:value"]=I.v||0;break;case"s":case"str":x=I.v==null?"":I.v,y["office:value-type"]="string";break;case"d":x=I.w||Ke(I.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Ke(I.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(r);continue}var k=e(x);if(I.l&&I.l.Target){var N=I.l.Target;N=N.charAt(0)=="#"?"#"+Wv(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),k=se("text:a",k,{"xlink:href":N.replace(/&/g,"&amp;")})}c.push("          "+se("table:table-cell",se("text:p",k,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var f=0;f<l["!cols"].length;++f)if(l["!cols"][f]){var d=l["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Qr(d),d.ods=o;var u=l["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var f=0;f<l["!rows"].length;++f)if(l["!rows"][f]){l["!rows"][f].ods=c;var d=l["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[ft],l=On({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=On({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+f+`>
`),c.push(u0().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),n(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=s.SheetNames.length;++d)c.push(a(s.Sheets[s.SheetNames[d]],s,d,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function Sf(e,r){if(r.bookType=="fods")return El(e,r);var t=qs(),a="",n=[],i=[];return a="mimetype",be(t,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",be(t,a,El(e,r)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",be(t,a,E_(e,r)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",be(t,a,ft+u0()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",be(t,a,Zh(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",be(t,a,Kh(n)),t}function ka(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function js(e){return typeof TextDecoder!="undefined"?new TextDecoder().decode(e):ze(ra(e))}function S_(e){return typeof TextEncoder!="undefined"?new TextEncoder().encode(e):Jt(br(e))}function b_(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var a=0;a<r.length;++a)if(e[t+a]!=r[a])continue e;return!0}return!1}function ta(e){var r=e.reduce(function(n,i){return n+i.length},0),t=new Uint8Array(r),a=0;return e.forEach(function(n){t.set(n,a),a+=n.length}),t}function Sl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function T_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,n=r+13;n>=r;--n)a=a*256+e[n];return(e[r+15]&128?-a:a)*Math.pow(10,t-6176)}function C_(e,r,t){var a=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,n=t/Math.pow(10,a-6176);e[r+15]|=a>>7,e[r+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[r+i]=n&255;e[r+15]|=t>=0?0:128}function Bn(e,r){var t=r?r[0]:0,a=e[t]&127;e:if(e[t++]>=128&&(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),a}function Ve(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function rt(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Me(e){for(var r=[],t=[0];t[0]<e.length;){var a=t[0],n=Bn(e,t),i=n&7;n=Math.floor(n/8);var s=0,o;if(n==0)break;switch(i){case 0:{for(var c=t[0];e[t[0]++]>=128;);o=e.slice(c,t[0])}break;case 5:s=4,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=Bn(e,t),o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var l={data:o,type:i};r[n]==null?r[n]=[l]:r[n].push(l)}return r}function bt(e){var r=[];return e.forEach(function(t,a){t.forEach(function(n){n.data&&(r.push(Ve(a*8+n.type)),n.type==2&&r.push(Ve(n.data.length)),r.push(n.data))})}),ta(r)}function Co(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function nr(e){for(var r,t=[],a=[0];a[0]<e.length;){var n=Bn(e,a),i=Me(e.slice(a[0],a[0]+n));a[0]+=n;var s={id:rt(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Me(o.data),l=rt(c[3][0].data);s.messages.push({meta:c,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(r=i[3])!=null&&r[0]&&(s.merge=rt(i[3][0].data)>>>0>0),t.push(s)}return t}function Na(e){var r=[];return e.forEach(function(t){var a=[];a[1]=[{data:Ve(t.id),type:0}],a[2]=[],t.merge!=null&&(a[3]=[{data:Ve(+!!t.merge),type:0}]);var n=[];t.messages.forEach(function(s){n.push(s.data),s.meta[3]=[{type:0,data:Ve(s.data.length)}],a[2].push({data:bt(s.meta),type:2})});var i=bt(a);r.push(Ve(i.length)),r.push(i),n.forEach(function(s){return r.push(s)})}),ta(r)}function A_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],a=Bn(r,t),n=[];t[0]<r.length;){var i=r[t[0]]&3;if(i==0){var s=r[t[0]++]>>2;if(s<60)++s;else{var o=s-59;s=r[t[0]],o>1&&(s|=r[t[0]+1]<<8),o>2&&(s|=r[t[0]+2]<<16),o>3&&(s|=r[t[0]+3]<<24),s>>>=0,s++,t[0]+=o}n.push(r.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var c=0,l=0;if(i==1?(l=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,i==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),n=[ta(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var f=ta(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function ir(e){for(var r=[],t=0;t<e.length;){var a=e[t++],n=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(A_(a,e.slice(t,t+n))),t+=n}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ta(r)}function La(e){for(var r=[],t=0;t<e.length;){var a=Math.min(e.length-t,268435455),n=new Uint8Array(4);r.push(n);var i=Ve(a),s=i.length;r.push(i),a<=60?(s++,r.push(new Uint8Array([a-1<<2]))):a<=256?(s+=2,r.push(new Uint8Array([240,a-1&255]))):a<=65536?(s+=3,r.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(s+=4,r.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(s+=5,r.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),r.push(e.slice(t,t+a)),s+=a,n[0]=0,n[1]=s&255,n[2]=s>>8&255,n[3]=s>>16&255,t+=a}return ta(r)}function O_(e,r,t,a){var n=ka(e),i=n.getUint32(4,!0),s=(a>1?12:8)+Sl(i&(a>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);i&512&&(o=n.getUint32(s,!0),s+=4),s+=Sl(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(s,!0),s+=4),i&32&&(l=n.getFloat64(s,!0),s+=8),i&64&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:r[c]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:l>0};break;case 7:d={t:"n",v:l/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:t[o]};else if(c>-1)d={t:"s",v:r[c]};else if(!isNaN(l))d={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function F_(e,r,t){var a=ka(e),n=a.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);n&1&&(c=T_(e,i),i+=16),n&2&&(l=a.getFloat64(i,!0),i+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(s=a.getUint32(i,!0),i+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:r[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:l>0};break;case 7:d={t:"n",v:l/86400};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1)d={t:"s",v:t[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return d}function Ts(e,r){var t=new Uint8Array(32),a=ka(t),n=12,i=0;switch(t[0]=5,e.t){case"n":t[1]=2,C_(t,n,e.v),i|=1,n+=16;break;case"b":t[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,a.setUint32(n,r.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),t.slice(0,n)}function Cs(e,r){var t=new Uint8Array(32),a=ka(t),n=12,i=0;switch(t[0]=3,e.t){case"n":t[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":t[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,a.setUint32(n,r.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),t.slice(0,n)}function I_(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return O_(e,r,t,e[0]);case 5:return F_(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function It(e){var r=Me(e);return Bn(r[1][0].data)}function bl(e,r){var t=Me(r.data),a=rt(t[1][0].data),n=t[3],i=[];return(n||[]).forEach(function(s){var o=Me(s.data),c=rt(o[1][0].data)>>>0;switch(a){case 1:i[c]=js(o[3][0].data);break;case 8:{var l=e[It(o[9][0].data)][0],f=Me(l.data),d=e[It(f[1][0].data)][0],u=rt(d.meta[1][0].data);if(u!=2001)throw new Error("2000 unexpected reference to ".concat(u));var h=Me(d.data);i[c]=h[3].map(function(m){return js(m.data)}).join("")}break}}),i}function P_(e,r){var t,a,n,i,s,o,c,l,f,d,u,h,m,p,g=Me(e),v=rt(g[1][0].data)>>>0,y=rt(g[2][0].data)>>>0,x=((a=(t=g[8])==null?void 0:t[0])==null?void 0:a.data)&&rt(g[8][0].data)>0||!1,F,I;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&r!=0)F=(o=(s=g[7])==null?void 0:s[0])==null?void 0:o.data,I=(l=(c=g[6])==null?void 0:c[0])==null?void 0:l.data;else if((d=(f=g[4])==null?void 0:f[0])!=null&&d.data&&r!=1)F=(h=(u=g[4])==null?void 0:u[0])==null?void 0:h.data,I=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var A=x?4:1,k=ka(F),N=[],D=0;D<F.length/2;++D){var M=k.getUint16(D*2,!0);M<65535&&N.push([D,M])}if(N.length!=y)throw"Expected ".concat(y," cells, found ").concat(N.length);var W=[];for(D=0;D<N.length-1;++D)W[N[D][0]]=I.subarray(N[D][1]*A,N[D+1][1]*A);return N.length>=1&&(W[N[N.length-1][0]]=I.subarray(N[N.length-1][1]*A)),{R:v,cells:W}}function R_(e,r){var t,a=Me(r.data),n=(t=a==null?void 0:a[7])!=null&&t[0]?rt(a[7][0].data)>>>0>0?1:0:-1,i=Co(a[5],function(s){return P_(s,n)});return{nrows:rt(a[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,l){if(s[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));s[o.R][l]=c}),s},[])}}function D_(e,r,t){var a,n=Me(r.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(rt(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(rt(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=Ee(i);var s=Me(n[4][0].data),o=bl(e,e[It(s[4][0].data)][0]),c=(a=s[17])!=null&&a[0]?bl(e,e[It(s[17][0].data)][0]):[],l=Me(s[3][0].data),f=0;l[1].forEach(function(d){var u=Me(d.data),h=e[It(u[2][0].data)][0],m=rt(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=R_(e,h);p.data.forEach(function(g,v){g.forEach(function(y,x){var F=xe({r:f+v,c:x}),I=I_(y,o,c);I&&(t[F]=I)})}),f+=p.nrows})}function N_(e,r){var t=Me(r.data),a={"!ref":"A1"},n=e[It(t[2][0].data)],i=rt(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return D_(e,n[0],a),a}function L_(e,r){var t,a=Me(r.data),n={name:(t=a[1])!=null&&t[0]?js(a[1][0].data):"",sheets:[]},i=Co(a[2],It);return i.forEach(function(s){e[s].forEach(function(o){var c=rt(o.meta[1][0].data);c==6e3&&n.sheets.push(N_(e,o))})}),n}function B_(e,r){var t=Ro(),a=Me(r.data),n=Co(a[1],It);if(n.forEach(function(i){e[i].forEach(function(s){var o=rt(s.meta[1][0].data);if(o==2){var c=L_(e,s);c.sheets.forEach(function(l,f){Do(t,l,f==0?c.name:c.name+"_"+f,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function As(e){var r,t,a,n,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=ir(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var f;try{f=nr(l)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){i[d.id]=d.messages,s.push(d.id)})}}),!s.length)throw new Error("File has no messages");var o=((n=(a=(t=(r=i==null?void 0:i[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&rt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(l){var f=rt(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return B_(i,o)}function M_(e,r,t){var a,n,i,s;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&rt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=ka(e[7][0].data),f=0,d=[],u=ka(e[4][0].data),h=0,m=[],p=0;p<r.length;++p){if(r[p]==null){l.setUint16(p*2,65535,!0),u.setUint16(p*2,65535);continue}l.setUint16(p*2,f,!0),u.setUint16(p*2,h,!0);var g,v;switch(typeof r[p]){case"string":g=Ts({t:"s",v:r[p]},t),v=Cs({t:"s",v:r[p]},t);break;case"number":g=Ts({t:"n",v:r[p]},t),v=Cs({t:"n",v:r[p]},t);break;case"boolean":g=Ts({t:"b",v:r[p]},t),v=Cs({t:"b",v:r[p]},t);break;default:throw new Error("Unsupported value "+r[p])}d.push(g),f+=g.length,m.push(v),h+=v.length,++c}for(e[2][0].data=Ve(c);p<e[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),u.setUint16(p*2,65535,!0);return e[6][0].data=ta(d),e[3][0].data=ta(m),c}function $_(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Xt(t["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Ee(a)));var i=Ii(t,{range:a,header:1}),s=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(P){typeof P=="string"&&s.push(P)})});var o={},c=[],l=me.read(r.numbers,{type:"base64"});l.FileIndex.map(function(R,P){return[R,l.FullPaths[P]]}).forEach(function(R){var P=R[0],z=R[1];if(P.type==2&&P.name.match(/\.iwa/)){var fe=P.content,ae=ir(fe),ne=nr(ae);ne.forEach(function(q){c.push(q.id),o[q.id]={deps:[],location:z,type:rt(q.messages[0].meta[1][0].data)}})}}),c.sort(function(R,P){return R-P});var f=c.filter(function(R){return R>1}).map(function(R){return[R,Ve(R)]});l.FileIndex.map(function(R,P){return[R,l.FullPaths[P]]}).forEach(function(R){var P=R[0],z=R[1];if(P.name.match(/\.iwa/)){var fe=nr(ir(P.content));fe.forEach(function(ae){ae.messages.forEach(function(ne){f.forEach(function(q){ae.messages.some(function(ke){return rt(ke.meta[1][0].data)!=11006&&b_(ke.data,q[1])})&&o[q[0]].deps.push(ae.id)})})})}});function d(){for(var R=927262;R<2e6;++R)if(!o[R])return R;throw new Error("Too many messages")}for(var u=me.find(l,o[1].location),h=nr(ir(u.content)),m,p=0;p<h.length;++p){var g=h[p];g.id==1&&(m=g)}var v=It(Me(m.messages[0].data)[1][0].data);for(u=me.find(l,o[v].location),h=nr(ir(u.content)),p=0;p<h.length;++p)g=h[p],g.id==v&&(m=g);for(v=It(Me(m.messages[0].data)[2][0].data),u=me.find(l,o[v].location),h=nr(ir(u.content)),p=0;p<h.length;++p)g=h[p],g.id==v&&(m=g);for(v=It(Me(m.messages[0].data)[2][0].data),u=me.find(l,o[v].location),h=nr(ir(u.content)),p=0;p<h.length;++p)g=h[p],g.id==v&&(m=g);var y=Me(m.messages[0].data);{y[6][0].data=Ve(a.e.r+1),y[7][0].data=Ve(a.e.c+1);var x=It(y[46][0].data),F=me.find(l,o[x].location),I=nr(ir(F.content));{for(var A=0;A<I.length&&I[A].id!=x;++A);if(I[A].id!=x)throw"Bad ColumnRowUIDMapArchive";var k=Me(I[A].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var N=0;N<=a.e.c;++N){var D=[];D[1]=D[2]=[{type:0,data:Ve(N+420690)}],k[1].push({type:2,data:bt(D)}),k[2].push({type:0,data:Ve(N)}),k[3].push({type:0,data:Ve(N)})}k[4]=[],k[5]=[],k[6]=[];for(var M=0;M<=a.e.r;++M)D=[],D[1]=D[2]=[{type:0,data:Ve(M+726270)}],k[4].push({type:2,data:bt(D)}),k[5].push({type:0,data:Ve(M)}),k[6].push({type:0,data:Ve(M)});I[A].messages[0].data=bt(k)}F.content=La(Na(I)),F.size=F.content.length,delete y[46];var W=Me(y[4][0].data);{W[7][0].data=Ve(a.e.r+1);var L=Me(W[1][0].data),ee=It(L[2][0].data);F=me.find(l,o[ee].location),I=nr(ir(F.content));{if(I[0].id!=ee)throw"Bad HeaderStorageBucket";var de=Me(I[0].messages[0].data);for(M=0;M<i.length;++M){var J=Me(de[2][0].data);J[1][0].data=Ve(M),J[4][0].data=Ve(i[M].length),de[2][M]={type:de[2][0].type,data:bt(J)}}I[0].messages[0].data=bt(de)}F.content=La(Na(I)),F.size=F.content.length;var te=It(W[2][0].data);F=me.find(l,o[te].location),I=nr(ir(F.content));{if(I[0].id!=te)throw"Bad HeaderStorageBucket";for(de=Me(I[0].messages[0].data),N=0;N<=a.e.c;++N)J=Me(de[2][0].data),J[1][0].data=Ve(N),J[4][0].data=Ve(a.e.r+1),de[2][N]={type:de[2][0].type,data:bt(J)};I[0].messages[0].data=bt(de)}F.content=La(Na(I)),F.size=F.content.length;var ie=It(W[4][0].data);(function(){for(var R=me.find(l,o[ie].location),P=nr(ir(R.content)),z,fe=0;fe<P.length;++fe){var ae=P[fe];ae.id==ie&&(z=ae)}var ne=Me(z.messages[0].data);{ne[3]=[];var q=[];s.forEach(function(je,Fe){q[1]=[{type:0,data:Ve(Fe)}],q[2]=[{type:0,data:Ve(1)}],q[3]=[{type:2,data:S_(je)}],ne[3].push({type:2,data:bt(q)})})}z.messages[0].data=bt(ne);var ke=Na(P),O=La(ke);R.content=O,R.size=R.content.length})();var ye=Me(W[3][0].data);{var re=ye[1][0];delete ye[2];var Z=Me(re.data);{var G=It(Z[2][0].data);(function(){for(var R=me.find(l,o[G].location),P=nr(ir(R.content)),z,fe=0;fe<P.length;++fe){var ae=P[fe];ae.id==G&&(z=ae)}var ne=Me(z.messages[0].data);{delete ne[6],delete ye[7];var q=new Uint8Array(ne[5][0].data);ne[5]=[];for(var ke=0,O=0;O<=a.e.r;++O){var je=Me(q);ke+=M_(je,i[O],s),je[1][0].data=Ve(O),ne[5].push({data:bt(je),type:2})}ne[1]=[{type:0,data:Ve(a.e.c+1)}],ne[2]=[{type:0,data:Ve(a.e.r+1)}],ne[3]=[{type:0,data:Ve(ke)}],ne[4]=[{type:0,data:Ve(a.e.r+1)}]}z.messages[0].data=bt(ne);var Fe=Na(P),He=La(Fe);R.content=He,R.size=R.content.length})()}re.data=bt(Z)}W[3][0].data=bt(ye)}y[4][0].data=bt(W)}m.messages[0].data=bt(y);var C=Na(h),B=La(C);return u.content=B,u.size=u.content.length,l}function bf(e){return function(t){for(var a=0;a!=e.length;++a){var n=e[a];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function Ao(e){bf([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Oo(e){bf([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function U_(e){return Te.WS.indexOf(e)>-1?"sheet":Te.CS&&e==Te.CS?"chart":Te.DS&&e==Te.DS?"dialog":Te.MS&&e==Te.MS?"macro":e&&e.length?e:"sheet"}function j_(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,U_(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function H_(e,r,t,a,n,i,s,o,c,l,f,d){try{i[a]=wn(Zt(e,t,!0),r);var u=pt(e,r),h;switch(o){case"sheet":h=fw(u,r,n,c,i[a],l,f,d);break;case"chart":if(h=uw(u,r,n,c,i[a],l,f,d),!h||!h["!drawel"])break;var m=gn(h["!drawel"].Target,r),p=In(m),g=Jg(Zt(e,m,!0),wn(Zt(e,p,!0),m)),v=gn(g,m),y=In(v);h=My(Zt(e,v,!0),v,c,wn(Zt(e,y,!0),v),l,h);break;case"macro":h=dw(u,r,n,c,i[a],l,f,d);break;case"dialog":h=hw(u,r,n,c,i[a],l,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}s[a]=h;var x=[];i&&i[a]&&nt(i[a]).forEach(function(F){var I="";if(i[a][F].Type==Te.CMNT){I=gn(i[a][F].Target,r);var A=xw(pt(e,I,!0),I,c);if(!A||!A.length)return;fl(h,A,!1)}i[a][F].Type==Te.TCMNT&&(I=gn(i[a][F].Target,r),x=x.concat(Qg(pt(e,I,!0),c)))}),x&&x.length&&fl(h,x,!0,c.people||[])}catch(F){if(c.WTF)throw F}}function rr(e){return e.charAt(0)=="/"?e.slice(1):e}function V_(e,r){if(qa(),r=r||{},Ao(r),sr(e,"META-INF/manifest.xml")||sr(e,"objectdata.xml"))return _l(e,r);if(sr(e,"Index/Document.iwa")){if(typeof Uint8Array=="undefined")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof As!="undefined"){if(e.FileIndex)return As(e);var t=me.utils.cfb_new();return Ic(e).forEach(function(de){be(t,de,Vl(e,de))}),As(t)}throw new Error("Unsupported NUMBERS file")}if(!sr(e,"[Content_Types].xml"))throw sr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):sr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Ic(e),n=Xh(Zt(e,"[Content_Types].xml")),i=!1,s,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",pt(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!pt(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},l={};if(!r.bookSheets&&!r.bookProps){if(_n=[],n.sst)try{_n=gw(pt(e,rr(n.sst)),n.sst,r)}catch(de){if(r.WTF)throw de}r.cellStyles&&n.themes.length&&(c=mw(Zt(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],r)),n.style&&(l=pw(pt(e,rr(n.style)),n.style,c,r))}n.links.map(function(de){try{var J=wn(Zt(e,In(rr(de))),de);return yw(pt(e,rr(de)),J,de,r)}catch{}});var f=lw(pt(e,rr(n.workbooks[0])),n.workbooks[0],r),d={},u="";n.coreprops.length&&(u=pt(e,rr(n.coreprops[0]),!0),u&&(d=d0(u)),n.extprops.length!==0&&(u=pt(e,rr(n.extprops[0]),!0),u&&ep(u,d,r)));var h={};(!r.bookSheets||r.bookProps)&&n.custprops.length!==0&&(u=Zt(e,rr(n.custprops[0]),!0),u&&(h=rp(u,r)));var m={};if((r.bookSheets||r.bookProps)&&(f.Sheets?s=f.Sheets.map(function(J){return J.name}):d.Worksheets&&d.SheetNames.length>0&&(s=d.SheetNames),r.bookProps&&(m.Props=d,m.Custprops=h),r.bookSheets&&typeof s!="undefined"&&(m.SheetNames=s),r.bookSheets?m.SheetNames:r.bookProps))return m;s={};var p={};r.bookDeps&&n.calcchain&&(p=vw(pt(e,rr(n.calcchain)),n.calcchain,r));var g=0,v={},y,x;{var F=f.Sheets;d.Worksheets=F.length,d.SheetNames=[];for(var I=0;I!=F.length;++I)d.SheetNames[I]=F[I].name}var A=i?"bin":"xml",k=n.workbooks[0].lastIndexOf("/"),N=(n.workbooks[0].slice(0,k+1)+"_rels/"+n.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");sr(e,N)||(N="xl/_rels/workbook."+A+".rels");var D=wn(Zt(e,N,!0),N.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(r.xlmeta=ww(pt(e,rr(n.metadata[0])),n.metadata[0],r)),(n.people||[]).length>=1&&(r.people=tx(pt(e,rr(n.people[0])),r)),D&&(D=j_(D,f.Sheets));var M=pt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=d.Worksheets;++g){var W="sheet";if(D&&D[g]?(y="xl/"+D[g][1].replace(/[\/]?xl\//,""),sr(e,y)||(y=D[g][1]),sr(e,y)||(y=N.replace(/_rels\/.*$/,"")+D[g][1]),W=D[g][2]):(y="xl/worksheets/sheet"+(g+1-M)+"."+A,y=y.replace(/sheet0\./,"sheet.")),x=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(d.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var L=!1,ee=0;ee!=r.sheets.length;++ee)typeof r.sheets[ee]=="number"&&r.sheets[ee]==g&&(L=1),typeof r.sheets[ee]=="string"&&r.sheets[ee].toLowerCase()==d.SheetNames[g].toLowerCase()&&(L=1);if(!L)continue e}}H_(e,y,x,d.SheetNames[g],g,v,s,W,r,f,c,l)}return m={Directory:n,Workbook:f,Props:d,Custprops:h,Deps:p,Sheets:s,SheetNames:d.SheetNames,Strings:_n,Styles:l,Themes:c,SSF:Je(ge)},r&&r.bookFiles&&(e.files?(m.keys=a,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(de,J){de=de.replace(/^Root Entry[\/]/,""),m.keys.push(de),m.files[de]=e.FileIndex[J]}))),r&&r.bookVBA&&(n.vba.length>0?m.vbaraw=pt(e,rr(n.vba[0]),!0):n.defaults&&n.defaults.bin===lx&&(m.vbaraw=pt(e,"xl/vbaProject.bin",!0))),m}function W_(e,r){var t=r||{},a="Workbook",n=me.find(e,a);try{if(a="/!DataSpaces/Version",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(wm(n.content),a="/!DataSpaces/DataSpaceMap",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=km(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=Em(n.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);bm(n.content)}catch{}if(a="/EncryptionInfo",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=Tm(n.content);if(a="/EncryptedPackage",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile!="undefined")return decrypt_agile(o[1],n.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76!="undefined")return decrypt_std76(o[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function G_(e,r){return r.bookType=="ods"?Sf(e,r):r.bookType=="numbers"?$_(e,r):r.bookType=="xlsb"?z_(e,r):X_(e,r)}function z_(e,r){$a=1024,e&&!e.SSF&&(e.SSF=Je(ge)),e&&e.SSF&&(qa(),Ri(e.SSF),r.revssf=Ni(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kn?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",a=J0.indexOf(r.bookType)>-1,n=po();Oo(r=r||{});var i=qs(),s="",o=0;if(r.cellXfs=[],na(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",be(i,s,h0(e.Props,r)),n.coreprops.push(s),We(r.rels,2,s,Te.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,be(i,s,g0(e.Props,r)),n.extprops.push(s),We(r.rels,3,s,Te.EXT_PROPS),e.Custprops!==e.Props&&nt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",be(i,s,x0(e.Custprops,r)),n.custprops.push(s),We(r.rels,4,s,Te.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],u=(d||{})["!type"]||"sheet";switch(u){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,be(i,s,kw(o-1,s,r,e,f)),n.sheets.push(s),We(r.wbrels,-1,"worksheets/sheet"+o+"."+t,Te.WS[0])}if(d){var h=d["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+o+"."+t,be(i,p,bw(h,p,r)),n.comments.push(p),We(f,-1,"../comments"+o+"."+t,Te.CMNT),m=!0),d["!legacy"]&&m&&be(i,"xl/drawings/vmlDrawing"+o+".vml",q0(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&be(i,In(s),ja(f))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+t,be(i,s,Sw(r.Strings,s,r)),n.strs.push(s),We(r.wbrels,-1,"sharedStrings."+t,Te.SST)),s="xl/workbook."+t,be(i,s,_w(e,s,r)),n.workbooks.push(s),We(r.rels,1,s,Te.WB),s="xl/theme/theme1.xml",be(i,s,wo(e.Themes,r)),n.themes.push(s),We(r.wbrels,-1,"theme/theme1.xml",Te.THEME),s="xl/styles."+t,be(i,s,Ew(e,s,r)),n.styles.push(s),We(r.wbrels,-1,"styles."+t,Te.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",be(i,s,e.vbaraw),n.vba.push(s),We(r.wbrels,-1,"vbaProject.bin",Te.VBA)),s="xl/metadata."+t,be(i,s,Tw(s)),n.metadata.push(s),We(r.wbrels,-1,"metadata."+t,Te.XLMETA),be(i,"[Content_Types].xml",f0(n,r)),be(i,"_rels/.rels",ja(r.rels)),be(i,"xl/_rels/workbook."+t+".rels",ja(r.wbrels)),delete r.revssf,delete r.ssf,i}function X_(e,r){$a=1024,e&&!e.SSF&&(e.SSF=Je(ge)),e&&e.SSF&&(qa(),Ri(e.SSF),r.revssf=Ni(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kn?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",a=J0.indexOf(r.bookType)>-1,n=po();Oo(r=r||{});var i=qs(),s="",o=0;if(r.cellXfs=[],na(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",be(i,s,h0(e.Props,r)),n.coreprops.push(s),We(r.rels,2,s,Te.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,be(i,s,g0(e.Props,r)),n.extprops.push(s),We(r.rels,3,s,Te.EXT_PROPS),e.Custprops!==e.Props&&nt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",be(i,s,x0(e.Custprops,r)),n.custprops.push(s),We(r.rels,4,s,Te.CUST_PROPS));var f=["SheetJ5"];for(r.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},u=e.Sheets[e.SheetNames[o-1]],h=(u||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,be(i,s,lf(o-1,r,e,d)),n.sheets.push(s),We(r.wbrels,-1,"worksheets/sheet"+o+"."+t,Te.WS[0])}if(u){var m=u["!comments"],p=!1,g="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+o+"."+t,be(i,g,ex(m,f,r)),n.threadedcomments.push(g),We(d,-1,"../threadedComments/threadedComment"+o+"."+t,Te.TCMNT)),g="xl/comments"+o+"."+t,be(i,g,K0(m,r)),n.comments.push(g),We(d,-1,"../comments"+o+"."+t,Te.CMNT),p=!0}u["!legacy"]&&p&&be(i,"xl/drawings/vmlDrawing"+o+".vml",q0(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&be(i,In(s),ja(d))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+t,be(i,s,B0(r.Strings,r)),n.strs.push(s),We(r.wbrels,-1,"sharedStrings."+t,Te.SST)),s="xl/workbook."+t,be(i,s,pf(e,r)),n.workbooks.push(s),We(r.rels,1,s,Te.WB),s="xl/theme/theme1.xml",be(i,s,wo(e.Themes,r)),n.themes.push(s),We(r.wbrels,-1,"theme/theme1.xml",Te.THEME),s="xl/styles."+t,be(i,s,G0(e,r)),n.styles.push(s),We(r.wbrels,-1,"styles."+t,Te.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",be(i,s,e.vbaraw),n.vba.push(s),We(r.wbrels,-1,"vbaProject.bin",Te.VBA)),s="xl/metadata."+t,be(i,s,Y0()),n.metadata.push(s),We(r.wbrels,-1,"metadata."+t,Te.XLMETA),f.length>1&&(s="xl/persons/person.xml",be(i,s,rx(f,r)),n.people.push(s),We(r.wbrels,-1,"persons/person.xml",Te.PEOPLE)),be(i,"[Content_Types].xml",f0(n,r)),be(i,"_rels/.rels",ja(r.rels)),be(i,"xl/_rels/workbook."+t+".rels",ja(r.wbrels)),delete r.revssf,delete r.ssf,i}function Fo(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Qt(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Y_(e,r){return me.find(e,"EncryptedPackage")?W_(e,r):vf(e,r)}function q_(e,r){var t,a=e,n=r||{};return n.type||(n.type=Ae&&Buffer.isBuffer(e)?"buffer":"base64"),t=Wl(a,n),V_(t,n)}function Tf(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return $s(e.slice(t),r);default:break e}return za.to_workbook(e,r)}function K_(e,r){var t="",a=Fo(e,r);switch(r.type){case"base64":t=Qt(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=va(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(t=ze(t)),r.type="binary",Tf(t,r)}function J_(e,r){var t=e;return r.type=="base64"&&(t=Qt(t)),t=Ue.utils.decode(1200,t.slice(2),"str"),r.type="binary",Tf(t,r)}function Z_(e){return e.match(/[^\x00-\x7F]/)?br(e):e}function Os(e,r,t,a){return a?(t.type="string",za.to_workbook(e,t)):za.to_workbook(r,t)}function Fi(e,r){Ws();var t=r||{};if(typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer)return Fi(new Uint8Array(e),(t=Je(t),t.type="array",t));typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno!="undefined"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Va={},t.dateNF&&(Va.dateNF=t.dateNF),t.type||(t.type=Ae&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Ae?"buffer":"binary",a=zd(e),typeof Uint8Array!="undefined"&&!Ae&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,a=Z_(e)),t.type=="array"&&typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!="undefined"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return t=Je(t),t.type="array",Fi(Gs(a),t)}switch((n=Fo(a,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return Y_(me.read(a,t),t);break;case 9:if(n[1]<=8)return vf(a,t);break;case 60:return $s(a,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return am(a,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return N0.to_workbook(a,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?q_(a,t):Os(e,a,t,i);case 239:return n[3]===60?$s(a,t):Os(e,a,t,i);case 255:if(n[1]===254)return J_(a,t);if(n[1]===0&&n[2]===2&&n[3]===0)return ma.to_workbook(a,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return ma.to_workbook(a,t);break;case 3:case 131:case 139:case 140:return Ms.to_workbook(a,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return H0.to_workbook(a,t);break;case 10:case 13:case 32:return K_(a,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return rm.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Ms.to_workbook(a,t):Os(e,a,t,i)}function Cf(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return $n(r.file,me.write(e,{type:Ae?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return me.write(e,r)}function Q_(e,r){var t=Je(r||{}),a=G_(e,t);return ek(a,t)}function ek(e,r){var t={},a=Ae?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=a;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=a;break;default:throw new Error("Unrecognized type "+r.type)}var n=e.FullPaths?me.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno!="undefined"&&typeof n=="string"){if(r.type=="binary"||r.type=="base64")return n;n=new Uint8Array(Pi(n))}return r.password&&typeof encrypt_agile!="undefined"?Cf(encrypt_agile(n,r.password),r):r.type==="file"?$n(r.file,n):r.type=="string"?ze(n):n}function tk(e,r){var t=r||{},a=Zw(e,t);return Cf(a,t)}function Sr(e,r,t){t||(t="");var a=t+e;switch(r.type){case"base64":return Tn(br(a));case"binary":return br(a);case"string":return e;case"file":return $n(r.file,a,"utf8");case"buffer":return Ae?Ur(a,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(a):Sr(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function rk(e,r){switch(r.type){case"base64":return Tn(e);case"binary":return e;case"string":return e;case"file":return $n(r.file,e,"binary");case"buffer":return Ae?Ur(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function vi(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",a=0;a<e.length;++a)t+=String.fromCharCode(e[a]);return r.type=="base64"?Tn(t):r.type=="string"?ze(t):t;case"file":return $n(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Io(e,r){Ws(),Yy(e);var t=Je(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var a=Io(e,t);return t.type="array",Pi(a)}var n=0;if(t.sheet&&(typeof t.sheet=="number"?n=t.sheet:n=e.SheetNames.indexOf(t.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Sr(Gw(e,t),t);case"slk":case"sylk":return Sr(D0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"htm":case"html":return Sr(wf(e.Sheets[e.SheetNames[n]],t),t);case"txt":return rk(Af(e.Sheets[e.SheetNames[n]],t),t);case"csv":return Sr(Po(e.Sheets[e.SheetNames[n]],t),t,"\uFEFF");case"dif":return Sr(N0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"dbf":return vi(Ms.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"prn":return Sr(za.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"rtf":return Sr(H0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"eth":return Sr(L0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"fods":return Sr(Sf(e,t),t);case"wk1":return vi(ma.sheet_to_wk1(e.Sheets[e.SheetNames[n]],t),t);case"wk3":return vi(ma.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),vi(yf(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),tk(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Q_(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function ak(e,r,t,a,n,i,s,o){var c=lt(t),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,u=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:t,enumerable:!1})}catch{u.__rowNum__=t}else u.__rowNum__=t;if(!s||e[t])for(var h=r.s.c;h<=r.e.c;++h){var m=s?e[t][h]:e[a[h]+c];if(m===void 0||m.t===void 0){if(l===void 0)continue;i[h]!=null&&(u[i[h]]=l);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[h]!=null){if(p==null)if(m.t=="e"&&p===null)u[i[h]]=null;else if(l!==void 0)u[i[h]]=l;else if(f&&p===null)u[i[h]]=null;else continue;else u[i[h]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:$r(m,p,o);p!=null&&(d=!1)}}return{row:u,isempty:d}}function Ii(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},a=0,n=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof f){case"string":c=Be(f);break;case"number":c=Be(e["!ref"]),c.s.r=f;break;default:c=f}a>0&&(n=0);var d=lt(c.s.r),u=[],h=[],m=0,p=0,g=Array.isArray(e),v=c.s.r,y=0,x={};g&&!e[v]&&(e[v]=[]);var F=l.skipHidden&&e["!cols"]||[],I=l.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(F[y]||{}).hidden)switch(u[y]=Qe(y),t=g?e[v][y]:e[u[y]+d],a){case 1:i[y]=y-c.s.c;break;case 2:i[y]=u[y];break;case 3:i[y]=l.header[y-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=$r(t,null,l),p=x[s]||0,!p)x[s]=1;else{do o=s+"_"+p++;while(x[o]);x[s]=p,x[o]=1}i[y]=o}for(v=c.s.r+n;v<=c.e.r;++v)if(!(I[v]||{}).hidden){var A=ak(e,c,v,u,a,i,g,l);(A.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(h[m++]=A.row)}return h.length=m,h}var Tl=/"/g;function nk(e,r,t,a,n,i,s,o){for(var c=!0,l=[],f="",d=lt(t),u=r.s.c;u<=r.e.c;++u)if(a[u]){var h=o.dense?(e[t]||[])[u]:e[a[u]+d];if(h==null)f="";else if(h.v!=null){c=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:$r(h,null,o));for(var m=0,p=0;m!==f.length;++m)if((p=f.charCodeAt(m))===n||p===i||p===34||o.forceQuotes){f='"'+f.replace(Tl,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(c=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(Tl,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(s)}function Po(e,r){var t=[],a=r==null?{}:r;if(e==null||e["!ref"]==null)return"";var n=Be(e["!ref"]),i=a.FS!==void 0?a.FS:",",s=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),f="",d=[];a.dense=Array.isArray(e);for(var u=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(u[m]||{}).hidden||(d[m]=Qe(m));for(var p=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||(f=nk(e,n,g,d,s,c,i,a),f!=null&&(a.strip&&(f=f.replace(l,"")),(f||a.blankrows!==!1)&&t.push((p++?o:"")+f)));return delete a.dense,t.join("")}function Af(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Po(e,r);if(typeof Ue=="undefined"||r.type=="string")return t;var a=Ue.utils.encode(1200,t,"str");return"\xFF\xFE"+a}function ik(e){var r="",t,a="";if(e==null||e["!ref"]==null)return[];var n=Be(e["!ref"]),i="",s=[],o,c=[],l=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)s[o]=Qe(o);for(var f=n.s.r;f<=n.e.r;++f)for(i=lt(f),o=n.s.c;o<=n.e.c;++o)if(r=s[o]+i,t=l?(e[f]||[])[o]:e[r],a="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;a=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}c[c.length]=r+"="+a}return c}function Of(e,r,t){var a=t||{},n=+!a.skipHeader,i=e||{},s=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?et(a.origin):a.origin;s=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:s+r.length-1+n}};if(i["!ref"]){var d=Be(i["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(s=d.e.r+1,f.e.r=s+r.length-1+n)}else s==-1&&(s=0,f.e.r=r.length-1+n);var u=a.header||[],h=0;r.forEach(function(p,g){nt(p).forEach(function(v){(h=u.indexOf(v))==-1&&(u[h=u.length]=v);var y=p[v],x="z",F="",I=xe({c:o+h,r:s+g+n});l=Mn(i,I),y&&typeof y=="object"&&!(y instanceof Date)?i[I]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",a.cellDates||(x="n",y=yt(y)),F=a.dateNF||ge[14]):y===null&&a.nullError&&(x="e",y=0),l?(l.t=x,l.v=y,delete l.w,delete l.R,F&&(l.z=F)):i[I]=l={t:x,v:y},F&&(l.z=F))})}),f.e.c=Math.max(f.e.c,o+u.length-1);var m=lt(s);if(n)for(h=0;h<u.length;++h)i[Qe(h+o)+m]={t:"s",v:u[h]};return i["!ref"]=Ee(f),i}function sk(e,r){return Of(null,e,r)}function Mn(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var a=et(r);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Mn(e,xe(r)):Mn(e,xe({r,c:t||0}))}function ok(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Ro(){return{SheetNames:[],Sheets:{}}}function Do(e,r,t,a){var n=1;if(!t)for(;n<=65535&&e.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var s=i&&i[1]||t;for(++n;n<=65535&&e.SheetNames.indexOf(t=s+n)!=-1;++n);}if(hf(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function ck(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=ok(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[a].Hidden=t}function lk(e,r){return e.z=r,e}function Ff(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function fk(e,r,t){return Ff(e,"#"+r,t)}function uk(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function dk(e,r,t,a){for(var n=typeof r!="string"?r:Be(r),i=typeof r=="string"?r:Ee(r),s=n.s.r;s<=n.e.r;++s)for(var o=n.s.c;o<=n.e.c;++o){var c=Mn(e,s,o);c.t="n",c.F=i,delete c.v,s==n.s.r&&o==n.s.c&&(c.f=t,a&&(c.D=!0))}return e}var Vr={encode_col:Qe,encode_row:lt,encode_cell:xe,encode_range:Ee,decode_col:oo,decode_row:so,split_cell:Sh,decode_cell:et,decode_range:Xt,format_cell:$r,sheet_add_aoa:a0,sheet_add_json:Of,sheet_add_dom:_f,aoa_to_sheet:Ja,json_to_sheet:sk,table_to_sheet:kf,table_to_book:w_,sheet_to_csv:Po,sheet_to_txt:Af,sheet_to_json:Ii,sheet_to_html:wf,sheet_to_formulae:ik,sheet_to_row_object_array:Ii,sheet_get_cell:Mn,book_new:Ro,book_append_sheet:Do,book_set_sheet_visibility:ck,cell_set_number_format:lk,cell_set_hyperlink:Ff,cell_set_internal_link:fk,cell_add_comment:uk,sheet_set_array_formula:dk,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var lS=bn.version;var Pf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
        <path
            d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
        />
    </svg>
`.trim(),Rf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <rect width="7" height="7" x="3" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="14" rx="1" />
        <rect width="7" height="7" x="3" y="14" rx="1" />
    </svg>
`.trim(),Df=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="1"/>
        <circle cx="12" cy="5" r="1"/>
        <circle cx="12" cy="19" r="1"/>
    </svg>
`.trim(),No=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M12 3v18"/>
        <rect width="18" height="18" x="3" y="3" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
    </svg>
`.trim(),Nf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
    </svg>
`.trim(),Lf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
        <path d="M8 7h6"/>
        <path d="M8 11h8"/>
    </svg>
`.trim(),hk={config:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3" />
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.82 2.82l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.82-2.82l.06-.06A1.65 1.65 0 0 0 3 15a1.65 1.65 0 0 0-1.51-1H1a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 3 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.82-2.82l.06.06A1.65 1.65 0 0 0 9 3.6a1.65 1.65 0 0 0 1-1.51V2a2 2 0 0 1 4 0v.09A1.65 1.65 0 0 0 15 3.6a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.82 2.82l-.06.06A1.65 1.65 0 0 0 21 9c0 .3.09.58.24.82.17.28.43.51.76.68.21.1.44.18.68.19H23a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z" />
        </svg>
    `,import:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 3v14" />
            <path d="m7 13 5 5 5-5" />
            <path d="M5 21h14" />
        </svg>
    `,headcount:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
            <circle cx="9" cy="7" r="4" />
            <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
    `,validate:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 6 9 17l-5-5" />
        </svg>
    `,review:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 12h3l2-5 4 10 2-5h5" />
        </svg>
    `,journal:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 7c-3-1-6-1-9 0v12c3-1 6-1 9 0 3-1 6-1 9 0V7c-3-1-6-1-9 0Z" />
            <path d="M12 7v12" />
        </svg>
    `,archive:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="4" rx="1" />
            <path d="M5 7v11a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7" />
            <path d="M10 12h4" />
        </svg>
    `};function Bf(e){return e&&hk[e]||""}var Lo=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0" />
    </svg>
`.trim(),Bo=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0v4" />
        <path d="M12 15v2" />
    </svg>
`.trim(),Hi=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M5 12l4 4 10-10" />
    </svg>
`.trim(),Mf=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="4" y="3" width="16" height="18" rx="2" />
        <rect x="8" y="7" width="8" height="3" />
        <path d="M8 14h.01" />
        <path d="M12 14h.01" />
        <path d="M16 14h.01" />
        <path d="M8 17h.01" />
        <path d="M12 17h.01" />
        <path d="M16 17h.01" />
    </svg>
`.trim(),fS=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 5.5 20.5 8 16 12.5 13.5 10 18 5.5Z" />
        <path d="m12 11 6-6" />
        <path d="M3 22 12 13" />
        <path d="m3 18 4 4" />
        <path d="m11 11 3 3" />
    </svg>
`.trim(),pk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 1 0 7.07 7.07l1.71-1.71" />
    </svg>
`.trim(),$f=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M7 10l5 5 5-5" />
        <path d="M12 15V3" />
    </svg>
`.trim(),Mo=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M17 8l-5-5-5 5" />
        <path d="M12 3v12" />
    </svg>
`.trim(),mk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10" />
        <path d="m15 9-6 6" />
        <path d="m9 9 6 6" />
    </svg>
`.trim(),Vi=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 19-7-7 7-7" />
        <path d="M19 12H5" />
    </svg>
`.trim(),Uf=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" />
        <path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7" />
        <path d="M7 3v4a1 1 0 0 0 1 1h7" />
    </svg>
`.trim(),Wi=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 5 7 7-7 7" />
        <path d="M5 12h14" />
    </svg>
`.trim(),uS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m9 12 2 2 4-4"/>
    </svg>
`.trim(),dS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" x2="12" y1="8" y2="12"/>
        <line x1="12" x2="12.01" y1="16" y2="16"/>
    </svg>
`.trim(),hS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/>
        <path d="M12 9v4"/>
        <path d="M12 17h.01"/>
    </svg>
`.trim(),pS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 16v-4"/>
        <path d="M12 8h.01"/>
    </svg>
`.trim(),mS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M21.801 10A10 10 0 1 1 17 3.335"/>
        <path d="m9 11 3 3L22 4"/>
    </svg>
`.trim(),gS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m15 9-6 6"/>
        <path d="m9 9 6 6"/>
    </svg>
`.trim(),xS=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m18 9-6-6-6 6"/>
        <path d="M12 3v14"/>
        <path d="M5 21h14"/>
    </svg>
`.trim(),vS=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m6 15 6 6 6-6"/>
        <path d="M12 21V7"/>
        <path d="M5 3h14"/>
    </svg>
`.trim(),Gi=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
        <path d="M21 3v5h-5"/>
        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
        <path d="M3 21v-5h5"/>
    </svg>
`.trim(),gk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 6h18"/>
        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
        <line x1="10" x2="10" y1="11" y2="17"/>
        <line x1="14" x2="14" y1="11" y2="17"/>
    </svg>
`.trim(),$o=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 6 6 18"/>
        <path d="m6 6 12 12"/>
    </svg>
`.trim(),jf=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
        <circle cx="12" cy="12" r="3"/>
    </svg>
`.trim(),Hf=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>
        <path d="M14 2v4a2 2 0 0 0 2 2h4"/>
        <path d="M10 9H8"/>
        <path d="M16 13H8"/>
        <path d="M16 17H8"/>
    </svg>
`.trim(),yS=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/>
        <path d="M2 12h20"/>
    </svg>
`.trim(),wS=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="3" width="18" height="18" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
        <path d="M9 3v18"/>
        <path d="M15 3v18"/>
    </svg>
`.trim(),_S=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
        <path d="M12 11h4"/>
        <path d="M12 16h4"/>
        <path d="M8 11h.01"/>
        <path d="M8 16h.01"/>
    </svg>
`.trim();function zn(e){return e==null?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function ur(e,r){return`
        <div class="pf-labeled-btn">
            ${e}
            <span class="pf-btn-label">${r}</span>
        </div>
    `}function Qa({textareaId:e,value:r,permanentId:t,isPermanent:a,hintId:n,saveButtonId:i,isSaved:s=!1,placeholder:o="Enter notes here..."}){let c=a?Bo:Lo,l=i?`<button type="button" class="pf-action-toggle pf-save-btn ${s?"is-saved":""}" id="${i}" data-save-input="${e}" title="Save notes">${Uf}</button>`:"",f=t?`<button type="button" class="pf-action-toggle pf-notes-lock ${a?"is-locked":""}" id="${t}" aria-pressed="${a}" title="Lock notes (retain after archive)">${c}</button>`:"";return`
        <article class="pf-step-card pf-step-detail pf-notes-card">
            <div class="pf-notes-header">
                <div>
                    <h3 class="pf-notes-title">Notes</h3>
                    <p class="pf-notes-subtext">Leave notes your future self will appreciate. Notes clear after archiving. Click lock to retain permanently.</p>
                </div>
            </div>
            <div class="pf-notes-body">
                <textarea id="${e}" rows="6" placeholder="${zn(o)}">${zn(r||"")}</textarea>
                ${n?`<p class="pf-signoff-hint" id="${n}"></p>`:""}
            </div>
            <div class="pf-notes-action">
                ${t?ur(f,"Lock"):""}
                ${i?ur(l,"Save"):""}
            </div>
        </article>
    `}function en({reviewerInputId:e,reviewerValue:r,signoffInputId:t,signoffValue:a,isComplete:n,saveButtonId:i,isSaved:s=!1,completeButtonId:o,subtext:c="Sign-off below. Click checkmark icon. Done.",prevButtonId:l=null,nextButtonId:f=null}){let d=l||`${o}-prev`,u=f||`${o}-next`,h=`<button type="button" class="pf-action-toggle ${n?"is-active":""}" id="${o}" aria-pressed="${!!n}" title="Mark step complete">${Hi}</button>`,m=`<button type="button" class="pf-action-toggle pf-nav-toggle" id="${d}" title="Previous step">${Vi}</button>`,p=`<button type="button" class="pf-action-toggle pf-nav-toggle" id="${u}" title="Next step">${Wi}</button>`;return`
        <article class="pf-step-card pf-step-detail pf-config-card">
            <div class="pf-config-head pf-notes-header">
                <div>
                    <h3>Sign-off</h3>
                    <p class="pf-config-subtext">${zn(c)}</p>
                </div>
            </div>
            <div class="pf-config-grid">
                <label class="pf-config-field">
                    <span>Reviewer Name</span>
                    <input type="text" id="${e}" value="${zn(r)}" placeholder="Full name">
                </label>
                <label class="pf-config-field">
                    <span>Sign-off Date</span>
                    <input type="date" id="${t}" value="${zn(a)}" readonly>
                </label>
            </div>
            <div class="pf-signoff-action">
                ${m?ur(m,"Prev"):""}
                ${ur(h,"Done")}
                ${p?ur(p,"Next"):""}
            </div>
        </article>
    `}function Uo(e,r){e&&(e.classList.toggle("is-locked",r),e.setAttribute("aria-pressed",String(r)),e.innerHTML=r?Bo:Lo)}function Wr(e,r){e&&e.classList.toggle("is-saved",r)}function jo(e=document){let r=e.querySelectorAll(".pf-save-btn[data-save-input]"),t=[];return r.forEach(a=>{let n=a.getAttribute("data-save-input"),i=document.getElementById(n);if(!i)return;let s=()=>{Wr(a,!1)};i.addEventListener("input",s),t.push(()=>i.removeEventListener("input",s))}),()=>t.forEach(a=>a())}function Vf(e,r){if(e===0)return{canComplete:!0,blockedBy:null,message:""};for(let t=0;t<e;t++)if(!r[t])return{canComplete:!1,blockedBy:t,message:`Complete Step ${t} before signing off on this step.`};return{canComplete:!0,blockedBy:null,message:""}}function Wf(e){let r=document.querySelector(".pf-workflow-toast");r&&r.remove();let t=document.createElement("div");t.className="pf-workflow-toast pf-workflow-toast--warning",t.innerHTML=`
        <span class="pf-workflow-toast-icon">\u26A0\uFE0F</span>
        <span class="pf-workflow-toast-message">${e}</span>
    `,document.body.appendChild(t),requestAnimationFrame(()=>{t.classList.add("pf-workflow-toast--visible")}),setTimeout(()=>{t.classList.remove("pf-workflow-toast--visible"),setTimeout(()=>t.remove(),300)},4e3)}var Ho={fillColor:"#000000",fontColor:"#FFFFFF",bold:!0};function Xn(e){e.format.fill.color=Ho.fillColor,e.format.font.color=Ho.fontColor,e.format.font.bold=Ho.bold}var zi={currency:"$#,##0.00",currencyNegative:"$#,##0.00;[Red]($#,##0.00)",number:"#,##0.00",integer:"#,##0",percent:"0.00%",date:"yyyy-mm-dd",dateShort:"mm/dd/yyyy",text:"@"},ia={narrow:10,standard:15,wide:20,extraWide:30,description:40};function Xi(e,r){!e||!r||r.length===0||(e["!cols"]=r.map(t=>({wch:t})))}function Gf(e,r,t){if(!(!e||!t||r<=1))for(let a=1;a<r;a++)for(let[n,i]of Object.entries(t)){let s=parseInt(n,10),o=Vr.encode_cell({r:a,c:s});e[o]&&(e[o].z=i)}}function xk(e,r,t){if(!e||!r||t<=1)return{};let a={};return r.forEach((n,i)=>{let s=String(n||"").toLowerCase().trim(),o=null;s.includes("amount")||s.includes("total")||s.includes("liability")||s.includes("pay")||s.includes("wage")||s.includes("salary")||s.includes("rate")&&!s.includes("accrual rate")||s.includes("debit")||s.includes("credit")||s.includes("change")||s.includes("fixed")||s.includes("variable")||s.includes("burden")||s.includes("gross")?o=zi.currency:s.includes("date")||s.includes("period")?o=zi.dateShort:s.includes("percent")||s.includes("rate")&&s.includes("burden")||s==="% of total"?o=zi.percent:(s.includes("count")||s.includes("headcount")||s==="id"||s.includes("employee_id"))&&(o=zi.integer),o&&(a[i]=o)}),Gf(e,t,a),a}function vk(e){return!e||e.length===0?[]:e.map(r=>{let t=String(r||"").toLowerCase().trim(),a=r.length;return t.includes("description")||t.includes("note")||t.includes("name")&&t.includes("account")?ia.description:t.includes("name")||t.includes("department")?ia.extraWide:a>12?ia.wide:a<8?ia.narrow:ia.standard})}function zf(e,r,t,a={}){if(!e||!r||r.length===0)return;let{columnFormats:n={},columnWidths:i=null,autoFormat:s=!0,autoSize:o=!0}=a;if(r.length,s&&xk(e,r,t),n&&Object.keys(n).length>0&&Gf(e,t,n),i)Xi(e,i);else if(o){let c=vk(r);Xi(e,c)}}var yk="3ca1595",oa="pto-accrual";var an="PTO Accrual",Ko="https://jgciqwzwacaesqjaoadc.supabase.co",rn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE";function Ne(e,r="info",t=4e3){document.querySelectorAll(".pf-toast").forEach(n=>n.remove());let a=document.createElement("div");if(a.className=`pf-toast pf-toast--${r}`,a.innerHTML=`
        <div class="pf-toast-content">
            <span class="pf-toast-icon">${r==="success"?"\u2705":r==="error"?"\u274C":"\u2139\uFE0F"}</span>
            <span class="pf-toast-message">${e.replace(/\n/g,"<br>")}</span>
        </div>
        <button class="pf-toast-close" onclick="this.parentElement.remove()">\xD7</button>
    `,!document.getElementById("pf-toast-styles")){let n=document.createElement("style");n.id="pf-toast-styles",n.textContent=`
            .pf-toast {
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #1a1a2e;
                color: white;
                padding: 16px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 90%;
                display: flex;
                align-items: flex-start;
                gap: 12px;
                animation: toastIn 0.3s ease;
            }
            .pf-toast--success { border-left: 4px solid #22c55e; }
            .pf-toast--error { border-left: 4px solid #ef4444; }
            .pf-toast--info { border-left: 4px solid #3b82f6; }
            .pf-toast-content { display: flex; align-items: flex-start; gap: 8px; flex: 1; }
            .pf-toast-icon { font-size: 18px; }
            .pf-toast-message { font-size: 14px; line-height: 1.4; }
            .pf-toast-close { background: none; border: none; color: #888; font-size: 20px; cursor: pointer; padding: 0; margin-left: 8px; }
            .pf-toast-close:hover { color: white; }
            @keyframes toastIn { from { opacity: 0; transform: translateX(-50%) translateY(-20px); } }
        `,document.head.appendChild(n)}return document.body.appendChild(a),t>0&&setTimeout(()=>a.remove(),t),a}var wk="Calculate your PTO liability, compare against last period, and generate a balanced journal entry\u2014all without leaving Excel.",_k="../module-selector/index.html",kk="pf-loader-overlay",ca=["SS_PF_Config"],we={payrollProvider:"PTO_Payroll_Provider",payrollDate:"PTO_Analysis_Date",accountingPeriod:"PTO_Accounting_Period",journalEntryId:"PTO_Journal_Entry_ID",companyName:"SS_Company_Name",accountingSoftware:"SS_Accounting_Software",reviewerName:"PTO_Reviewer",validationDataBalance:"PTO_Validation_Data_Balance",validationCleanBalance:"PTO_Validation_Clean_Balance",validationDifference:"PTO_Validation_Difference",headcountRosterCount:"PTO_Headcount_Roster_Count",headcountPayrollCount:"PTO_Headcount_Payroll_Count",headcountDifference:"PTO_Headcount_Difference",journalDebitTotal:"PTO_JE_Debit_Total",journalCreditTotal:"PTO_JE_Credit_Total",journalDifference:"PTO_JE_Difference"},Fa="User opted to skip the headcount review this period.",Qi={0:{note:"PTO_Notes_Config",reviewer:"PTO_Reviewer_Config",signOff:"PTO_SignOff_Config"},1:{note:"PTO_Notes_Upload",reviewer:"PTO_Reviewer_Upload",signOff:"PTO_SignOff_Upload"},2:{note:"PTO_Notes_Review",reviewer:"PTO_Reviewer_Review",signOff:"PTO_SignOff_Review"},3:{note:"PTO_Notes_JE",reviewer:"PTO_Reviewer_JE",signOff:"PTO_SignOff_JE"},4:{note:"PTO_Notes_Archive",reviewer:"PTO_Reviewer_Archive",signOff:"PTO_SignOff_Archive"}},lu={0:"PTO_Complete_Config",1:"PTO_Complete_Upload",2:"PTO_Complete_Review",3:"PTO_Complete_JE",4:"PTO_Complete_Archive"};var hr=[{id:0,title:"Configuration",summary:"Auto-loaded from system. Review period-specific settings before each run.",description:"Configuration is loaded from your installation. Only period-specific fields (analysis date, accounting period) need review each run.",actionLabel:"Review Configuration",icon:"\u{1F9ED}",secondaryAction:{sheet:"SS_PF_Config",label:"Open Config Sheet"}},{id:1,title:"Upload & Validate PTO Data",summary:"Import PTO report, normalize headers, and run validation checks.",description:"Upload your Obsidian PTO report, auto-map headers using ada_payroll_dimensions, create PTO_Data_Clean, and review advisory validation checks.",actionLabel:"Upload PTO Report",icon:"\u{1F4E5}",secondaryAction:{sheet:"PTO_Data_Clean",label:"Open Clean Data"}},{id:2,title:"PTO Accrual Review",summary:"Review accrued, used, and balance metrics with executive-ready summary.",description:"Analyze PTO data grouped by employee and plan. Review totals, trends, and variances using PTO_Data_Clean as the source of truth.",actionLabel:"Generate Review",icon:"\u{1F4CA}",secondaryAction:{sheet:"PTO_Review",label:"Open Review Sheet"}},{id:3,title:"Journal Entry Prep",summary:"Generate accounting-ready journal entry output.",description:"Create journal entry draft using PTO_Data_Clean and GL mappings. Produces output ready for QuickBooks or your accounting system.",actionLabel:"Generate JE Draft",icon:"\u{1F9FE}",secondaryAction:{sheet:"PTO_JE_Draft",label:"Open JE Draft"}},{id:4,title:"Archive & Clear",summary:"Archive the period and reset for next run.",description:"Save a snapshot of this period's work, then clear working tabs to prepare for the next PTO analysis cycle.",actionLabel:"Archive Period",icon:"\u{1F5C2}\uFE0F",secondaryAction:{sheet:"PTO_Archive_Summary",label:"Open Archive"}}],Ek={0:"PTO_Homepage",1:"PTO_Data_Clean",2:"PTO_Review",3:"PTO_JE_Draft",4:"PTO_Archive_Summary"};function Xo(e){if(typeof e=="number")return e;if(!e)return 0;let r=String(e).replace(/[$,]/g,"").trim(),t=parseFloat(r);return isNaN(t)?0:t}var Sk=hr.reduce((e,r)=>(e[r.id]="pending",e),{}),it={activeView:"home",activeStepId:null,focusedIndex:0,stepStatuses:Sk},Ce={loaded:!1,steps:{},permanents:{},completes:{},values:{},overrides:{accountingPeriod:!1,journalId:!1}},qn=null,Vo=null,Yi=null,tn=new Map,De={skipAnalysis:!1,loading:!1,hasAnalyzed:!1,lastError:null,rosterCount:0,ptoCount:0,missingFromPto:[],extraInPto:[],roster:{rosterCount:null,payrollCount:null,difference:null,mismatches:[]}},Ze={debitTotal:null,creditTotal:null,difference:null,lineAmountSum:null,analysisChangeTotal:null,jeChangeTotal:null,loading:!1,lastError:null,validationRun:!1,issues:[]},ut={hasRun:!1,loading:!1,acknowledged:!1,balanceIssues:[],zeroBalances:[],accrualOutliers:[],totalIssues:0,totalEmployees:0,expandedSections:new Set},Ia={cleanDataReady:!1,employeeCount:0,lastRun:null,loading:!1,lastError:null,missingPayRates:[],missingDepartments:[],ignoredMissingPayRates:new Set,completenessCheck:{accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null}},Xe={loaded:!1,loading:!1,lastRun:null,totalCurrentLiability:0,totalPriorLiability:0,netChange:0,employeeCount:0,reconciliation:{reportLiabilityTotal:0,calcLiabilityTotal:0,negativeBalanceTotal:0,negativeBalanceCount:0,positiveBalanceCount:0,zeroBalanceCount:0,missingRateCount:0},coverage:{rosterCount:0,ptoReportCount:0,inBothCount:0,inPtoOnlyCount:0,inPtoOnlyNames:[],inPtoOnlyLiability:0,inRosterOnlyCount:0,inRosterOnlyNames:[]},reviewData:[],flagThresholds:{largeMove:500}},Re={loaded:!1,loading:!1,error:null,crm_company_id:null,ss_company_name:null,pto_payroll_provider:null,ss_accounting_software:null,isValid:!1,validationErrors:[]};async function bk(){console.log("[PTO] Loading installation configuration from SS_PF_Config..."),Re.loading=!0,Re.error=null,Re.validationErrors=[];try{if(!xt())throw new Error("Excel runtime not available.");let e=await ti(["SS_PF_Config"]);console.log("[PTO] Config values loaded:",e),Re.crm_company_id=(e==null?void 0:e.SS_Company_ID)||null,Re.ss_company_name=(e==null?void 0:e.SS_Company_Name)||null,Re.pto_payroll_provider=(e==null?void 0:e.PTO_Payroll_Provider)||null,Re.ss_accounting_software=(e==null?void 0:e.SS_Accounting_Software)||null,Tk(),Re.loaded=!0,Re.loading=!1,console.log("[PTO] Installation config loaded successfully:",{crm_company_id:Re.crm_company_id,company_name:Re.ss_company_name,provider:Re.pto_payroll_provider,isValid:Re.isValid})}catch(e){console.error("[PTO] Failed to load installation:",e),Re.error=e.message,Re.loading=!1,Re.loaded=!0,Re.isValid=!1,Re.validationErrors.push(e.message)}}function Tk(){Re.validationErrors=[],Re.crm_company_id||Re.validationErrors.push("Company ID is not configured. Please open Module Selector to sync your configuration."),Re.isValid=Re.validationErrors.length===0,Re.isValid||console.error("[PTO] Installation validation failed:",Re.validationErrors)}async function Ck(){if(xt())try{await Excel.run(async e=>{let r=e.workbook.worksheets;r.load("items/name"),await e.sync();let t=r.getItemOrNullObject("SS_PF_Config");if(t.load("isNullObject"),await e.sync(),t.isNullObject){console.log("[PTO] Creating SS_PF_Config sheet..."),t=r.add("SS_PF_Config");let a=["Category","Field","Value","Permanent"],n=t.getRange("A1:D1");n.values=[a],Xn(n);let i=[["module-prefix","PR_","payroll-recorder","Y"],["module-prefix","PTO_","pto-accrual","Y"],["module-prefix","SS_","system","Y"],["Run Settings","SS_Company_Name","","Y"],["Run Settings","SS_Company_ID","","Y"]],s=t.getRange(`A2:D${1+i.length}`);s.values=i,await e.sync();let o=t.getRange(`A1:D${1+i.length}`),c=t.tables.add(o,!0);c.name="SS_PF_Config",c.style="TableStyleMedium2",o.format.autofitColumns(),await e.sync(),console.log("[PTO] SS_PF_Config sheet and table created")}else{let a=e.workbook.tables;if(a.load("items/name"),await e.sync(),!a.items.some(i=>i.name==="SS_PF_Config")){console.log("[PTO] SS_PF_Config sheet exists but no table - creating table...");let i=t.getUsedRangeOrNullObject();if(i.load("address,rowCount"),await e.sync(),!i.isNullObject&&i.rowCount>0){let s=t.tables.add(i,!0);s.name="SS_PF_Config",s.style="TableStyleMedium2",await e.sync(),console.log("[PTO] SS_PF_Config table created from existing data")}else{let s=["Category","Field","Value","Permanent"],o=t.getRange("A1:D1");o.values=[s],o.format.font.bold=!0;let c=[["module-prefix","PR_","payroll-recorder","Y"],["module-prefix","PTO_","pto-accrual","Y"],["module-prefix","SS_","system","Y"],["Run Settings","SS_Company_Name","","Y"],["Run Settings","SS_Company_ID","","Y"]],l=t.getRange(`A2:D${1+c.length}`);l.values=c,await e.sync();let f=t.getRange(`A1:D${1+c.length}`),d=t.tables.add(f,!0);d.name="SS_PF_Config",d.style="TableStyleMedium2",f.format.autofitColumns(),await e.sync(),console.log("[PTO] SS_PF_Config table created with default data")}}}})}catch(e){console.error("[PTO] Error ensuring config sheet:",e)}}async function Ak(){var e;try{qn=document.getElementById("app"),Vo=document.getElementById("loading"),await Ck(),await bk(),Re.isValid||(console.warn("[PTO] Installation config incomplete:",Re.validationErrors),console.warn("[PTO] Continuing anyway - some features may be limited")),await Fk(),await fu(),(e=window.PrairieForge)!=null&&e.loadSharedConfig&&await window.PrairieForge.loadSharedConfig();let r=si(oa);await ii(r.sheetName,r.title,r.subtitle),await Ok(),Vo&&Vo.remove(),qn&&(qn.hidden=!1),wt()}catch(r){throw console.error("[PTO] Module initialization failed:",r),r}}async function Ok(){console.log("[PTO] Worksheet change listener disabled (one-way sync mode)")}async function Fk(){try{await ri(oa),console.log(`[PTO] Tab visibility applied for ${oa}`)}catch(e){console.warn("[PTO] Could not apply tab visibility:",e)}}async function fu(){var e;if(!xt()){Ce.loaded=!0;return}try{let r=await ti(ca),t={};(e=window.PrairieForge)!=null&&e.loadSharedConfig&&(await window.PrairieForge.loadSharedConfig(),window.PrairieForge._sharedConfigCache&&window.PrairieForge._sharedConfigCache.forEach((i,s)=>{t[s]=i}));let a={...r},n={SS_Default_Reviewer:we.reviewerName,Default_Reviewer:we.reviewerName,PTO_Reviewer:we.reviewerName,SS_Company_Name:we.companyName,Company_Name:we.companyName,SS_Payroll_Provider:we.payrollProvider,Payroll_Provider_Link:we.payrollProvider,SS_Accounting_Software:we.accountingSoftware,Accounting_Software_Link:we.accountingSoftware};Object.entries(n).forEach(([i,s])=>{t[i]&&!a[s]&&(a[s]=t[i])}),Object.entries(t).forEach(([i,s])=>{i.startsWith("PTO_")&&s&&(a[i]=s)}),Ce.permanents=await Ik(),Ce.values=a||{},Ce.overrides.accountingPeriod=!!(a!=null&&a[we.accountingPeriod]),Ce.overrides.journalId=!!(a!=null&&a[we.journalEntryId]),Object.entries(Qi).forEach(([i,s])=>{var o,c,l;Ce.steps[i]={notes:(o=a[s.note])!=null?o:"",reviewer:(c=a[s.reviewer])!=null?c:"",signOffDate:(l=a[s.signOff])!=null?l:""}}),Ce.completes=Object.entries(lu).reduce((i,[s,o])=>{var c;return i[s]=(c=a[o])!=null?c:"",i},{}),Ce.loaded=!0}catch(r){console.warn("PTO: unable to load configuration fields",r),Ce.loaded=!0}}async function Ik(){let e={};if(!xt())return e;let r=new Map;Object.entries(Qi).forEach(([t,a])=>{a.note&&r.set(a.note.trim(),Number(t))});try{await Excel.run(async t=>{let a=t.workbook.tables.getItemOrNullObject(ca[0]);if(await t.sync(),a.isNullObject)return;let n=a.getDataBodyRange(),i=a.getHeaderRowRange();n.load("values"),i.load("values"),await t.sync();let o=(i.values[0]||[]).map(l=>String(l||"").trim().toLowerCase()),c={field:o.findIndex(l=>l==="field"||l==="field name"||l==="setting"),permanent:o.findIndex(l=>l==="permanent"||l==="persist")};c.field===-1||c.permanent===-1||(n.values||[]).forEach(l=>{let f=String(l[c.field]||"").trim(),d=r.get(f);if(d==null)return;let u=VE(l[c.permanent]);e[d]=u})})}catch(t){console.warn("PTO: unable to load permanent flags",t)}return e}function Pk(){let e=document.getElementById("quick-access-modal");e&&e.remove();let r=document.createElement("div");r.id="quick-access-modal",r.className="pf-quick-modal hidden",r.style.cssText="position:fixed!important;top:0;left:0;right:0;bottom:0;z-index:2147483647;",r.innerHTML=`
        <div class="pf-quick-modal-backdrop" data-close></div>
        <div class="pf-quick-modal-card">
            <div class="pf-quick-modal-header">
                <h3 class="pf-quick-modal-title">Quick Access</h3>
                <button id="quick-access-close" class="pf-quick-modal-close pf-clickable" type="button" aria-label="Close">
                    ${$o}
                </button>
            </div>
            <div class="pf-quick-modal-items">
                ${Re.pto_payroll_provider?`
                <a id="nav-provider-link" class="pf-quick-modal-item pf-clickable" href="${Se(Re.pto_payroll_provider)}" target="_blank" rel="noopener">
                    ${Hf}
                    <span>PTO Provider Report</span>
                </a>
                `:""}
                <button id="nav-accounting-software" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Mo}
                    <span>Accounting Software</span>
                </button>
                <button id="nav-employee-roster" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Nf}
                    <span>Employee Roster</span>
                </button>
                <button id="nav-chart-of-accounts" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Lf}
                    <span>Chart of Accounts</span>
                </button>
                <button id="nav-config" class="pf-quick-modal-item pf-clickable" type="button">
                    ${jf}
                    <span>Configuration</span>
                </button>
            </div>
        </div>
    `,document.body.appendChild(r)}function wt(){var o;if(!qn)return;let e=it.focusedIndex<=0?"disabled":"",r=it.focusedIndex>=hr.length-1?"disabled":"",t=it.activeView==="step"&&it.activeStepId!=null,n=it.activeView==="config"?uu():t?Gk(it.activeStepId):`${Dk()}${Nk()}`;qn.innerHTML=`
        <div class="pf-root">
            <div class="pf-brand-float" aria-hidden="true">
                <span class="pf-brand-wave"></span>
            </div>
            <header class="pf-banner">
                <div class="pf-nav-bar">
                    <button id="nav-prev" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Previous step" ${e}>
                        ${Vi}
                        <span class="sr-only">Previous step</span>
                    </button>
                    <button id="nav-home" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Home">
                        ${Pf}
                        <span class="sr-only">Module Home</span>
                    </button>
                    <button id="nav-selector" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Selector">
                        ${Rf}
                        <span class="sr-only">Module Selector</span>
                    </button>
                    <button id="nav-next" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Next step" ${r}>
                        ${Wi}
                        <span class="sr-only">Next step</span>
                    </button>
                    <div class="pf-nav-divider"></div>
                    <button id="nav-quick-toggle" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Quick Access">
                        ${Df}
                        <span class="sr-only">Quick Access Menu</span>
                    </button>
                </div>
            </header>
            ${n}
            <footer class="pf-brand-footer">
                <div class="pf-brand-text">
                    <div class="pf-brand-label">prairie.forge</div>
                    <div class="pf-brand-meta"> Prairie Forge LLC, 2025. All rights reserved. Version ${yk}</div>
                </div>
            </footer>
        </div>
    `;let i=it.activeView==="home"||it.activeView!=="step"&&it.activeView!=="config",s=document.getElementById("pf-info-fab-pto");if(i)s&&s.remove();else if((o=window.PrairieForge)!=null&&o.mountInfoFab){let c=Rk(it.activeStepId);PrairieForge.mountInfoFab({title:c.title,content:c.content,buttonId:"pf-info-fab-pto"})}Pk(),zk(),Kk(),i?hc():hs()}function Rk(e){switch(e){case 0:return{title:"Configuration",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Configuration is auto-loaded from your installation. Review period-specific settings before each PTO run.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Auto-Loaded (Read-Only)</h4>
                        <ul>
                            <li><strong>Company Name</strong> \u2014 From your installation</li>
                            <li><strong>Company ID</strong> \u2014 Used for GL mapping lookups</li>
                            <li><strong>Company ID</strong> \u2014 Required for GL mappings</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4DD} Period-Specific (Editable)</h4>
                        <ul>
                            <li><strong>Analysis Date</strong> \u2014 The period-end date (e.g., 11/30/2024)</li>
                            <li><strong>Accounting Period</strong> \u2014 Shows up in your JE description</li>
                            <li><strong>Journal Entry ID</strong> \u2014 Reference number for your accounting system</li>
                        </ul>
                    </div>
                `};case 1:return{title:"Upload & Validate PTO Data",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Upload your Obsidian PTO export, auto-normalize headers, create PTO_Data_Clean, and run advisory validation checks.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4E5} Upload Process</h4>
                        <ol>
                            <li>Download your PTO report from Obsidian</li>
                            <li>Click Upload and select the file</li>
                            <li>Headers are auto-normalized using ada_payroll_dimensions</li>
                            <li>PTO_Data_Clean is created with standardized columns</li>
                        </ol>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u2705 Validation Checks (Advisory)</h4>
                        <ul>
                            <li><strong>Employee Coverage</strong> \u2014 Compare against SS_Employee_Roster</li>
                            <li><strong>Data Quality</strong> \u2014 Negative balances, outliers, date consistency</li>
                        </ul>
                        <p class="pf-info-note">Validation is advisory and does not block the workflow.</p>
                    </div>
                `};case 2:return{title:"PTO Accrual Review",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Review PTO accrual metrics with an executive-ready summary. Uses PTO_Data_Clean as the single source of truth.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CA} Key Measures</h4>
                        <ul>
                            <li><strong>Accrual Rate</strong> \u2014 Hours accrued per pay period</li>
                            <li><strong>Carry Over</strong> \u2014 Hours carried from prior year</li>
                            <li><strong>YTD Accrued / Used</strong> \u2014 Year-to-date totals</li>
                            <li><strong>Pay Period Accrued / Used</strong> \u2014 Current period activity</li>
                            <li><strong>Balance</strong> \u2014 Current available hours</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4C8} Analysis View</h4>
                        <p>Data is grouped by Employee Name and Plan Description for detailed review.</p>
                    </div>
                `};case 3:return{title:"Journal Entry Prep",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Generates accounting-ready journal entry output from your PTO analysis.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4DD} JE Generation</h4>
                        <ul>
                            <li>Uses PTO_Data_Clean as the data source</li>
                            <li>GL accounts resolved via ada_customer_gl_mappings</li>
                            <li>Output ready for QuickBooks or your accounting system</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u2705 Validation</h4>
                        <ul>
                            <li><strong>Debits = Credits</strong> \u2014 Entry must balance</li>
                            <li><strong>All rows mapped</strong> \u2014 Every line has a GL account</li>
                        </ul>
                    </div>
                `};case 4:return{title:"Archive & Clear",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Archive this period's results and reset working tabs for the next PTO cycle.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4E6} What Gets Archived</h4>
                        <ul>
                            <li><strong>PTO_Archive_Summary</strong> \u2014 Rolling summary of last 5 periods</li>
                            <li><strong>Excel Workbook</strong> \u2014 Full snapshot saved externally</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F9F9} What Gets Cleared</h4>
                        <ul>
                            <li>PTO_Data_Clean</li>
                            <li>PTO_Review</li>
                            <li>PTO_JE_Draft</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u26A0\uFE0F Important</h4>
                        <p>Ensure you've exported any needed files before clearing. The external workbook is your permanent backup.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Tip</h4>
                        <p>Make sure your JE has been uploaded to your accounting system before archiving.</p>
                    </div>
                `};default:return{title:"PTO Accrual",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F44B} Welcome to PTO Accrual</h4>
                        <p>This module helps you calculate PTO liabilities and generate journal entries each period.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Workflow Overview</h4>
                        <ol style="margin: 8px 0; padding-left: 20px;">
                            <li>Review period configuration (auto-loaded)</li>
                            <li>Upload & validate PTO data</li>
                            <li>Review PTO accrual metrics</li>
                            <li>Generate journal entry</li>
                            <li>Archive & clear for next period</li>
                        </ol>
                    </div>
                    <div class="pf-info-section">
                        <p>Click a step card to get started, or tap the <strong>\u24D8</strong> button on any step for detailed guidance.</p>
                    </div>
                `}}}function Dk(){return`
        <section class="pf-hero" id="pf-hero">
            <h2 class="pf-hero-title">PTO Accrual</h2>
            <p class="pf-hero-copy">${wk}</p>
        </section>
    `}function Nk(){return`
        <section class="pf-step-guide">
            <div class="pf-step-grid">
                ${hr.map((e,r)=>Lk(e,r)).join("")}
            </div>
        </section>
    `}function Lk(e,r){let t=it.stepStatuses[e.id]||"pending",a=it.activeView==="step"&&it.focusedIndex===r?"pf-step-card--active":"",n=Bf($E(e.id));return`
        <article class="pf-step-card pf-clickable ${a}" data-step-card data-step-index="${r}" data-step-id="${e.id}">
            <p class="pf-step-index">Step ${e.id}</p>
            <h3 class="pf-step-title">${n?`${n}`:""}${e.title}</h3>
        </article>
    `}function Bk(e){let r=hr.filter(i=>i.id!==4).map(i=>({id:i.id,title:i.title,complete:Jk(i.id)})),t=r.every(i=>i.complete),a=r.filter(i=>!i.complete).length;console.log("[Archive Step] Completion check:",r.map(i=>`Step ${i.id}: ${i.complete}`).join(", ")),console.log("[Archive Step] All complete:",t,"Incomplete count:",a);let n=r.map(i=>`
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head pf-notes-header">
                    <span class="pf-action-toggle ${i.complete?"is-active":""}" aria-pressed="${i.complete}">
                        ${Hi}
                    </span>
                    <div>
                        <h3>${Se(i.title)}</h3>
                        <p class="pf-config-subtext">${i.complete?"Complete":"Not complete"}</p>
                    </div>
                </div>
            </article>
        `).join("");return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(an)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${Se(e.title)}</h2>
            <p class="pf-hero-copy">${Se(e.summary||"")}</p>
            <p class="pf-hero-hint"></p>
        </section>
        <section class="pf-step-guide">
            ${n}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Archive & Reset</h3>
                    <p class="pf-config-subtext">Create an archive of this module's sheets and clear work tabs.</p>
                </div>
                ${t?'<p class="pf-step-note" style="color: #22c55e;">All steps complete. Ready to archive!</p>':`<p class="pf-step-note pf-step-note--info">Complete all ${a} remaining step(s) before archiving. Click the checkmark on each step's sign-off section.</p>`}
                <div class="pf-pill-row pf-config-actions">
                    <button type="button" class="pf-pill-btn ${t?"pf-cta-button":""}" id="archive-run-btn" ${t?"":"disabled"} style="${t?"":"opacity: 0.5; cursor: not-allowed;"}">
                        ${t?"Archive Now":"Archive (Complete Steps First)"}
                    </button>
                </div>
            </article>
        </section>
    `}function uu(){if(!Ce.loaded)return`
            <section class="pf-step-guide">
                <article class="pf-step-card pf-step-detail">
                    <p class="pf-step-title">Loading configuration\u2026</p>
                </article>
            </section>
        `;let e=au(At(we.payrollDate)),r=au(At(we.accountingPeriod)),t=At(we.journalEntryId),a=At(we.reviewerName),n=Re.ss_company_name||At(we.companyName)||"",i=Re.crm_company_id||"",s=Re.pto_payroll_provider||"",o=Re.ss_accounting_software||At(we.accountingSoftware)||"",c=Gr(0),l=!!Ce.permanents[0],f=!!(Su(Ce.completes[0])||c.signOffDate),d=Qn(c==null?void 0:c.reviewer),u=(c==null?void 0:c.signOffDate)||"";return`
        <section class="pf-hero" id="pf-config-hero">
            <p class="pf-hero-copy">${Se(an)} | Step 0</p>
            <h2 class="pf-hero-title">Configuration Setup</h2>
            <p class="pf-hero-copy">Make quick adjustments before every PTO run.</p>
        </section>
        <section class="pf-step-guide">
            <!-- Period Data (User editable) - FIRST, matches payroll-recorder -->
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Period Data</h3>
                    <p class="pf-config-subtext">Fields in this section may change each period.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Your Name (Used for sign-offs)</span>
                        <input type="text" id="config-user-name" value="${Se(a)}" placeholder="Full name">
                    </label>
                    <label class="pf-config-field">
                        <span>PTO Analysis Date</span>
                        <input type="date" id="config-payroll-date" value="${Se(e)}">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Period</span>
                        <input type="text" id="config-accounting-period" value="${Se(r)}" placeholder="Nov 2025">
                    </label>
                    <label class="pf-config-field">
                        <span>Journal Entry ID</span>
                        <input type="text" id="config-journal-id" value="${Se(t)}" placeholder="PTO-AUTO-YYYY-MM-DD">
                    </label>
                </div>
            </article>
            
            <!-- Static Data - SECOND, matches payroll-recorder naming/structure -->
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Static Data</h3>
                    <p class="pf-config-subtext">Fields rarely change but should be reviewed.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Company Name</span>
                        <input type="text" id="config-company-name" value="${Se(n)}" placeholder="Prairie Forge LLC">
                    </label>
                    <label class="pf-config-field">
                        <span>Company ID <span class="pf-field-hint">(from Prairie Forge CRM)</span></span>
                        <input type="text" id="config-company-id" value="${Se(i)}" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                    </label>
                    <label class="pf-config-field">
                        <span>PTO Provider / Report Location</span>
                        <input type="url" id="config-pto-provider" value="${Se(s)}" placeholder="https://\u2026">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Software / Import Location</span>
                        <input type="url" id="config-accounting-link" value="${Se(o)}" placeholder="https://\u2026">
                    </label>
                </div>
            </article>
            
            ${Qa({textareaId:"config-notes",value:c.notes||"",permanentId:"config-notes-lock",isPermanent:l,hintId:"",saveButtonId:"config-notes-save"})}
            ${en({reviewerInputId:"config-reviewer",reviewerValue:d,signoffInputId:"config-signoff-date",signoffValue:u,isComplete:f,saveButtonId:"config-signoff-save",completeButtonId:"config-signoff-toggle"})}
        </section>
    `}function Mk(){let e=Pe.file||Pe.headers.length>0,r=Pe.loading;return console.log("[PTO-Upload] renderPtoFileUploadZone state:",{hasFile:e,isLoading:r,file:Pe.file?Pe.fileName:null,headersLength:Pe.headers.length,headers:Pe.headers.slice(0,3)}),r?`
            <div class="pf-upload-zone pf-upload-zone--analyzing">
                <div class="pf-upload-spinner"></div>
                <p class="pf-upload-status">Processing your PTO report\u2026</p>
            </div>
        `:e?`
            <div class="pf-upload-zone pf-upload-zone--ready">
                <div class="pf-upload-file-info">
                    <svg class="pf-upload-file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                    </svg>
                    <div class="pf-upload-file-details">
                        <span class="pf-upload-filename">${Se(Pe.fileName)}</span>
                        <span class="pf-upload-meta">${Pe.headers.length} columns \u2022 ${(Pe.rowCount||0).toLocaleString()} rows</span>
                    </div>
                    <button type="button" class="pf-upload-clear" id="pto-upload-clear-btn" title="Remove file">\xD7</button>
                </div>
            </div>
        `:`
        <div class="pf-upload-zone" id="pto-upload-dropzone">
            <input type="file" id="pto-upload-file-input" accept=".csv,.xlsx,.xls" hidden>
            <div class="pf-upload-content">
                <svg class="pf-upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="17 8 12 3 7 8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
                <p class="pf-upload-text">Drop your PTO file here</p>
                <p class="pf-upload-hint">or <button type="button" class="pf-upload-browse" id="pto-upload-browse-btn">browse</button> to upload</p>
                <p class="pf-upload-formats">Supports CSV, XLSX, XLS</p>
            </div>
        </div>
    `}function $k(){let e=De.hasAnalyzed,r=De.loading,t=De.rosterCount||0,a=De.ptoCount||0,n=De.missingFromPto||[],i=De.extraInPto||[],s=e&&n.length===0&&i.length===0,o="",c="";r?o='<span class="pf-status-badge pf-status-badge--pending" role="status">\u23F3 Loading</span>':De.lastError?(o='<span class="pf-status-badge pf-status-badge--unavailable" role="status">\u26A0 Unavailable</span>',c="pf-coverage-unavailable"):e?s?(o='<span class="pf-status-badge pf-status-badge--ok" role="status">\u2713 OK</span>',c="pf-coverage-ok"):(o='<span class="pf-status-badge pf-status-badge--review" role="status">\u26A0 Review</span>',c="pf-coverage-review"):o='<span class="pf-status-badge pf-status-badge--pending" role="status">\u25CB Pending</span>';let l="";return r?l='<p class="pf-subsection-hint">Analyzing coverage...</p>':De.lastError?l=`<p class="pf-subsection-hint pf-subsection-hint--warn">${Se(De.lastError)}</p>`:e?(l='<div class="pf-recon-container">',l+=`
            <div class="pf-recon-row pf-recon-row--header">
                <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="summary">Roster Headcount</button>
                <span class="pf-recon-value">${t}</span>
            </div>
        `,(n.length>0||i.length>0)&&(l+='<div class="pf-recon-changes">',n.length>0&&(l+=`
                    <div class="pf-recon-row pf-recon-row--subtract">
                        <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="missing">
                            <span class="pf-recon-operator">\u2212</span> Missing from PTO
                </button>
                        <span class="pf-recon-value pf-recon-value--subtract">(${n.length})</span>
                    </div>
            `),i.length>0&&(l+=`
                    <div class="pf-recon-row pf-recon-row--add">
                        <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="extra">
                            <span class="pf-recon-operator">+</span> In PTO only
                </button>
                        <span class="pf-recon-value pf-recon-value--add">${i.length}</span>
                    </div>
                `),l+="</div>"),l+='<div class="pf-recon-divider"></div>',l+=`
            <div class="pf-recon-row pf-recon-row--footer">
                <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="summary">PTO File Headcount</button>
                <span class="pf-recon-value">${a}${s?" \u2713":""}</span>
            </div>
        `,l+="</div>",s?l+=`
                <div class="pf-coverage-item pf-coverage-item--ok" style="margin-top: 8px;">
                    <span class="pf-coverage-item-icon">\u2713</span>
                    <span>All roster employees found in PTO data</span>
                </div>
            `:l+='<p class="pf-coverage-hint">Click any row to see employee details</p>'):l='<p class="pf-subsection-hint">Upload a PTO file to run this check.</p>',`
        <article class="pf-step-card pf-step-detail pf-config-card pf-employee-coverage-card ${c}" id="pto-coverage-card">
            <div class="pf-config-head" style="display: flex; align-items: center;">
                <div>
                    <h3>Employee Coverage ${o}</h3>
                    <p class="pf-config-subtext">Compare PTO employees against roster.</p>
                </div>
                <button type="button" class="pf-action-toggle pf-action-toggle--subtle pf-clickable" id="pto-check-coverage-btn" title="Run coverage check" style="margin-left: auto;">
                    ${Gi}
                </button>
            </div>
            ${l}
        </article>
    `}function Uk(e){let r=De.rosterCount||0,t=De.ptoCount||0,a=De.missingFromPto||[],n=De.extraInPto||[],i="",s="";switch(e){case"summary":i="Coverage Summary",s=jk(r,t,a,n);break;case"missing":i=`${a.length} Active Employees Not in PTO Data`,s=Xf(a,"These employees are marked active in the roster but were not found in the PTO data. Verify they should have PTO balances.");break;case"extra":i=`${n.length} In PTO Data Only`,s=Xf(n,"These employees are in the PTO data but not found in the active roster. They may be terminated, on leave, or the roster needs updating.");break;default:return}Hk(i,s)}function jk(e,r,t,a){let n=r-e,i=n===0?"Match":n>0?`+${n}`:`${n}`,s=n===0?"match":"mismatch";return`
        <div class="pf-coverage-detail-summary">
            <h4>Headcount Bridge</h4>
            <div class="pf-headcount-bridge">
                <div class="pf-bridge-row pf-bridge-row--base">
                    <span class="pf-bridge-label">Active in Roster</span>
                    <span class="pf-bridge-value">${e}</span>
                </div>
                ${a.length>0?`
                <div class="pf-bridge-row pf-bridge-row--add">
                    <span class="pf-bridge-label">+ In PTO data only (not in roster)</span>
                    <span class="pf-bridge-value">+${a.length}</span>
                </div>
                `:""}
                ${t.length>0?`
                <div class="pf-bridge-row pf-bridge-row--subtract">
                    <span class="pf-bridge-label">\u2212 Active but not in PTO data</span>
                    <span class="pf-bridge-value">\u2212${t.length}</span>
                </div>
                `:""}
                <div class="pf-bridge-row pf-bridge-row--total">
                    <span class="pf-bridge-label">In PTO Data</span>
                    <span class="pf-bridge-value">${r}</span>
                </div>
                <div class="pf-bridge-row pf-bridge-row--diff pf-bridge-row--${s}">
                    <span class="pf-bridge-label">Difference</span>
                    <span class="pf-bridge-value">${i}</span>
                </div>
            </div>
            
            <h4 style="margin-top: 20px;">What to Review</h4>
            <ul class="pf-coverage-review-list">
                ${t.length>0?`<li><strong>${t.length} not in PTO</strong> \u2014 Verify these active employees should have PTO balances</li>`:""}
                ${a.length>0?`<li><strong>${a.length} PTO only</strong> \u2014 Check if these are terminated/on leave, or update roster via Payroll Recorder</li>`:""}
                ${t.length===0&&a.length===0?"<li>\u2713 No issues found \u2014 roster and PTO data are in sync</li>":""}
            </ul>
        </div>
    `}function Xf(e,r){if(!e||e.length===0)return`<p>${r}</p><p><em>No employees in this category.</em></p>`;let t=`<p style="margin-bottom: 16px;">${r}</p>`;return t+='<div class="pf-employee-list">',e.forEach((a,n)=>{let i=a.name||a,s=a.department||null;t+=`
            <div class="pf-employee-list-item">
                <span class="pf-employee-index">${n+1}.</span>
                <span class="pf-employee-name">${Se(i)}</span>
                ${s?`<span class="pf-employee-dept">${Se(s)}</span>`:""}
            </div>
        `}),t+="</div>",t}function Hk(e,r){let t=document.getElementById("pto-coverage-detail-modal");t&&t.remove();let a=document.createElement("div");a.id="pto-coverage-detail-modal",a.className="pf-coverage-modal",a.innerHTML=`
        <div class="pf-coverage-modal-backdrop" data-close></div>
        <div class="pf-coverage-modal-card">
            <div class="pf-coverage-modal-header">
                <h3 class="pf-coverage-modal-title">${Se(e)}</h3>
                <button class="pf-coverage-modal-close pf-clickable" type="button" aria-label="Close" data-close>
                    ${$o}
                </button>
            </div>
            <div class="pf-coverage-modal-body">
                ${r}
            </div>
        </div>
    `,document.body.appendChild(a),a.querySelectorAll("[data-close]").forEach(i=>{i.addEventListener("click",()=>a.remove())});let n=i=>{i.key==="Escape"&&(a.remove(),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n)}function Wo(e,r,t,a){if(!(t!=null&&t.length))return"";let n=ut.expandedSections.has(e),i=n?"\u25BC":"\u25B6",s=n?`<div class="pf-quality-issue-details">
            ${t.map(a).join("")}
           </div>`:"";return`
        <div class="pf-quality-issue-row">
            <button type="button" class="pf-quality-issue-toggle pf-clickable" data-quality-section="${e}">
                <span class="pf-quality-chevron">${i}</span>
                <span class="pf-quality-issue-label">${t.length} ${r}</span>
            </button>
            ${s}
        </div>
    `}function Vk(){let e=ut.hasRun,r=ut.totalIssues||0,t=r===0,a=e?t?'<span class="pf-status-badge pf-status-badge--ok" role="status">\u2713 OK</span>':'<span class="pf-status-badge pf-status-badge--review" role="status">\u26A0 Review</span>':'<span class="pf-status-badge pf-status-badge--pending" role="status">\u25CB Pending</span>',n=e?t?`${ut.totalEmployees||0} employees checked, no issues found`:`Found ${r} potential issue${r!==1?"s":""} to review`:"Check for negative balances, outliers, and data anomalies.",i="";if(e&&!t){let o=[];o.push(Wo("balanceIssues","negative balance(s)",ut.balanceIssues,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--warn">
                <span class="pf-quality-issue-name">${Se(l.name)}</span>
                <span class="pf-quality-issue-value">${Se(l.issue)}</span>
            </div>`)),o.push(Wo("zeroBalances","zero balance(s)",ut.zeroBalances,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--info">
                <span class="pf-quality-issue-name">${Se(l.name)}</span>
                <span class="pf-quality-issue-value">0 hrs balance</span>
            </div>`)),o.push(Wo("accrualOutliers","accrual rate outlier(s)",ut.accrualOutliers,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--info">
                <span class="pf-quality-issue-name">${Se(l.name)}</span>
                <span class="pf-quality-issue-value">${l.accrualRate.toFixed(2)} hrs/period</span>
            </div>`));let c=o.filter(l=>l).join("");c&&(i=`
                <div class="pf-quality-issues-container">
                    ${c}
                </div>
            `)}return`
        <article class="pf-step-card pf-step-detail pf-config-card" id="pto-quality-card">
            <div class="pf-config-head" style="display: flex; align-items: center;">
                <div>
                    <h3>Data Quality ${a}</h3>
                    <p class="pf-config-subtext">${n}</p>
                </div>
                <button type="button" class="pf-action-toggle pf-action-toggle--subtle pf-clickable" id="pto-check-quality-btn" title="Run quality check" style="margin-left: auto;">
                    ${Gi}
                </button>
            </div>
            ${i}
            ${e?"":'<p class="pf-metric-hint pf-metric-hint--info" style="margin-top: 12px; font-style: italic;">Upload a PTO file above to run this check.</p>'}
        </article>
    `}function Wk(e){let r=Gr(1),t=!!Ce.permanents[1],a=Qn(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(ts(Ce.completes[1])||n),s=Pe.error?`<p class="pf-upload-error">${Se(Pe.error)}</p>`:"";return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(an)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">Upload & Validate PTO Data</h2>
            <p class="pf-hero-copy">Upload your PTO export, create the data matrix, and verify coverage.</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Import</h3>
                    <p class="pf-config-subtext">Drop your PTO file to auto-normalize headers.</p>
                </div>
                ${Mk()}
                ${s}
            </article>
            
            <div class="pf-validation-section">
                <h3 class="pf-validation-header">Validation</h3>
                <p class="pf-validation-subtext">Advisory checks \u2014 review but not required to proceed.</p>
                ${$k()}
                ${Vk()}
            </div>
            
            ${Qa({textareaId:"step-notes-1",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-1",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-1"})}
            ${en({reviewerInputId:"step-reviewer-1",reviewerValue:a,signoffInputId:"step-signoff-1",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-1",completeButtonId:"step-signoff-toggle-1"})}
        </section>
    `}function Gk(e){let r=hr.find(o=>o.id===e);if(!r)return"";switch(e){case 0:return uu();case 1:return Wk(r);case 2:return GE(r);case 3:return zE(r);case 4:return Bk(r)}let t=Gr(e),a=!!Ce.permanents[e],n=Qn(t==null?void 0:t.reviewer),i=(t==null?void 0:t.signOffDate)||"",s=!!(ts(Ce.completes[e])||i);return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(an)} | Step ${r.id}</p>
            <h2 class="pf-hero-title">${Se(r.title)}</h2>
            <p class="pf-hero-copy">${Se(r.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            ${Qa({textareaId:`step-notes-${e}`,value:(t==null?void 0:t.notes)||"",permanentId:`step-notes-lock-${e}`,isPermanent:a,hintId:"",saveButtonId:`step-notes-save-${e}`})}
            ${en({reviewerInputId:`step-reviewer-${e}`,reviewerValue:n,signoffInputId:`step-signoff-${e}`,signoffValue:i,isComplete:s,saveButtonId:`step-signoff-save-${e}`,completeButtonId:`step-signoff-toggle-${e}`})}
        </section>
    `}function zk(){var i,s,o,c,l,f,d,u;(i=document.getElementById("nav-home"))==null||i.addEventListener("click",async()=>{var m;let h=si(oa);await ii(h.sheetName,h.title,h.subtitle),Zn({activeView:"home",activeStepId:null}),(m=document.getElementById("pf-hero"))==null||m.scrollIntoView({behavior:"smooth",block:"start"})}),(s=document.getElementById("nav-selector"))==null||s.addEventListener("click",()=>{window.location.href=_k}),(o=document.getElementById("nav-prev"))==null||o.addEventListener("click",()=>Ji(-1)),(c=document.getElementById("nav-next"))==null||c.addEventListener("click",()=>Ji(1));let e=document.getElementById("nav-quick-toggle"),r=document.getElementById("quick-access-modal"),t=document.getElementById("quick-access-close"),a=r==null?void 0:r.querySelector("[data-close]"),n=()=>{r==null||r.classList.add("hidden"),e==null||e.classList.remove("is-active")};e==null||e.addEventListener("click",h=>{h.stopPropagation(),r==null||r.classList.toggle("hidden"),e.classList.toggle("is-active")}),t==null||t.addEventListener("click",n),a==null||a.addEventListener("click",n),(l=document.getElementById("nav-accounting-software"))==null||l.addEventListener("click",async()=>{n(),await vu()}),(f=document.getElementById("nav-employee-roster"))==null||f.addEventListener("click",async()=>{n(),await Ra("SS_Employee_Roster"),Ne("Opened Employee Roster","success",2e3)}),(d=document.getElementById("nav-chart-of-accounts"))==null||d.addEventListener("click",async()=>{n(),await Ra("SS_Chart_of_Accounts"),Ne("Opened Chart of Accounts","success",2e3)}),(u=document.getElementById("nav-config"))==null||u.addEventListener("click",async()=>{n(),await Ra("SS_PF_Config"),Ne("Opened Configuration","success",2e3)}),document.querySelectorAll("[data-step-card]").forEach(h=>{let m=Number(h.getAttribute("data-step-index")),p=Number(h.getAttribute("data-step-id"));h.addEventListener("click",()=>es(m,p))}),it.activeView==="config"?Yk():it.activeView==="step"&&it.activeStepId!=null&&Xk(it.activeStepId)}function Xk(e){var u,h,m,p,g,v,y,x,F,I,A,k,N,D,M,W,L,ee,de,J;let r=document.getElementById(`step-notes-${e}`),t=document.getElementById(`step-reviewer-${e}`),a=document.getElementById(`step-signoff-${e}`),n=document.getElementById("step-back-btn"),i=document.getElementById(`step-notes-lock-${e}`),s=document.getElementById(`step-notes-save-${e}`);s==null||s.addEventListener("click",async()=>{let te=(r==null?void 0:r.value)||"";await dr(e,"notes",te),Wr(s,!0)});let o=document.getElementById(`step-signoff-save-${e}`);o==null||o.addEventListener("click",async()=>{let te=(t==null?void 0:t.value)||"";await dr(e,"reviewer",te),Wr(o,!0)}),jo();let c=`step-signoff-toggle-${e}`,l=`${c}-prev`,f=`${c}-next`,d=`step-signoff-${e}`;if(Eu(e,{buttonId:c,inputId:d,canActivate:null,onComplete:qk(e)}),pu(l,f),e===2){let te=document.querySelector('[data-copilot="pto-copilot"]');te&&fs(te,{id:"pto-copilot",contextProvider:ni({dataClean:"PTO_Data_Clean",review:"PTO_Review",config:"SS_PF_Config"}),onPrompt:xu})}if(n==null||n.addEventListener("click",async()=>{let te=si(oa);await ii(te.sheetName,te.title,te.subtitle),Zn({activeView:"home",activeStepId:null})}),i==null||i.addEventListener("click",async()=>{let te=!i.classList.contains("is-locked");Uo(i,te),await _u(e,te)}),e===4&&((u=document.getElementById("archive-run-btn"))==null||u.addEventListener("click",()=>{FE()})),e===1){let te=document.getElementById("pto-upload-dropzone"),ie=document.getElementById("pto-upload-file-input"),ye=document.getElementById("pto-upload-browse-btn"),re=document.getElementById("pto-upload-clear-btn");console.log("[PTO-Upload] bindStepView Step 1 - Element check:",{dropzone:!!te,fileInput:!!ie,browseBtn:!!ye,clearBtn:!!re}),te&&(te.addEventListener("click",()=>{console.log("[PTO-Upload] Dropzone clicked, opening file picker"),ie==null||ie.click()}),te.addEventListener("dragover",Z=>{Z.preventDefault(),Z.stopPropagation(),te.classList.add("pf-upload-zone--dragover")}),te.addEventListener("dragleave",Z=>{Z.preventDefault(),Z.stopPropagation(),te.classList.remove("pf-upload-zone--dragover")}),te.addEventListener("drop",Z=>{var C,B;Z.preventDefault(),Z.stopPropagation(),te.classList.remove("pf-upload-zone--dragover");let G=(B=(C=Z.dataTransfer)==null?void 0:C.files)==null?void 0:B[0];G&&Jf(G)})),ye==null||ye.addEventListener("click",Z=>{Z.stopPropagation(),console.log("[PTO-Upload] Browse button clicked"),ie==null||ie.click()}),ie==null||ie.addEventListener("change",Z=>{var C;let G=(C=Z.target.files)==null?void 0:C[0];console.log("[PTO-Upload] File selected:",G==null?void 0:G.name),G&&Jf(G)}),re==null||re.addEventListener("click",()=>{console.log("[PTO-Upload] Clear button clicked"),Pe.file=null,Pe.fileName="",Pe.headers=[],Pe.rowCount=0,Pe.parsedData=null,Pe.error=null,wt()}),(h=document.getElementById("pto-check-coverage-btn"))==null||h.addEventListener("click",async()=>{Ne("Refreshing coverage check...","info",2e3);let Z=window.scrollY;await Kn(),wt(),requestAnimationFrame(()=>window.scrollTo(0,Z))}),document.querySelectorAll("[data-pto-coverage-detail]").forEach(Z=>{Z.addEventListener("click",G=>{G.preventDefault();let C=Z.dataset.ptoCoverageDetail;Uk(C)})}),(m=document.getElementById("pto-check-quality-btn"))==null||m.addEventListener("click",async()=>{Ne("Refreshing quality check...","info",2e3);let Z=window.scrollY;await Ki(),wt(),requestAnimationFrame(()=>window.scrollTo(0,Z))}),document.querySelectorAll("[data-quality-section]").forEach(Z=>{Z.addEventListener("click",G=>{G.preventDefault();let C=Z.dataset.qualitySection,B=window.scrollY;ut.expandedSections.has(C)?ut.expandedSections.delete(C):ut.expandedSections.add(C),wt(),requestAnimationFrame(()=>window.scrollTo(0,B))})})}e===2&&((p=document.getElementById("review-generate-btn"))==null||p.addEventListener("click",()=>lE()),(g=document.getElementById("review-open-btn"))==null||g.addEventListener("click",()=>ME("PTO_Review"))),e===2&&((v=document.getElementById("headcount-skip-btn"))==null||v.addEventListener("click",()=>{De.skipAnalysis=!De.skipAnalysis;let te=document.getElementById("headcount-skip-btn");te==null||te.classList.toggle("is-active",De.skipAnalysis),De.skipAnalysis&&cu(),ou()}),(y=document.getElementById("headcount-run-btn"))==null||y.addEventListener("click",()=>Kn()),(x=document.getElementById("headcount-refresh-btn"))==null||x.addEventListener("click",()=>Kn()),ZE(),De.skipAnalysis&&cu(),ou()),e===3&&((F=document.getElementById("quality-run-btn"))==null||F.addEventListener("click",()=>Ki()),(I=document.getElementById("quality-refresh-btn"))==null||I.addEventListener("click",()=>Ki()),(A=document.getElementById("quality-acknowledge-btn"))==null||A.addEventListener("click",()=>SE())),e===4&&((k=document.getElementById("analysis-refresh-btn"))==null||k.addEventListener("click",()=>eu()),(N=document.getElementById("analysis-run-btn"))==null||N.addEventListener("click",()=>eu()),(D=document.getElementById("payrate-save-btn"))==null||D.addEventListener("click",Yf),(M=document.getElementById("payrate-ignore-btn"))==null||M.addEventListener("click",Zk),(W=document.getElementById("payrate-input"))==null||W.addEventListener("keydown",te=>{te.key==="Enter"&&Yf()})),e===3&&((L=document.getElementById("je-create-btn"))==null||L.addEventListener("click",()=>AE()),(ee=document.getElementById("je-run-btn"))==null||ee.addEventListener("click",()=>mu()),(de=document.getElementById("je-export-btn"))==null||de.addEventListener("click",()=>OE()),(J=document.getElementById("je-upload-btn"))==null||J.addEventListener("click",()=>vu()))}function Yk(){var o,c,l,f,d;gc("config-payroll-date",{onChange:u=>{if(Or(we.payrollDate,u),!!u){if(Ce.overrides.accountingPeriod=!1,Ce.overrides.journalId=!1,!Ce.overrides.accountingPeriod){let h=jE(u);if(h){let m=document.getElementById("config-accounting-period");m&&(m.value=h),Or(we.accountingPeriod,h)}}if(!Ce.overrides.journalId){let h=HE(u);if(h){let m=document.getElementById("config-journal-id");m&&(m.value=h),Or(we.journalEntryId,h)}}}}});let e=document.getElementById("config-accounting-period");e==null||e.addEventListener("change",u=>{Ce.overrides.accountingPeriod=!!u.target.value,Or(we.accountingPeriod,u.target.value||"")});let r=document.getElementById("config-journal-id");r==null||r.addEventListener("change",u=>{Ce.overrides.journalId=!!u.target.value,Or(we.journalEntryId,u.target.value.trim())}),(o=document.getElementById("config-company-name"))==null||o.addEventListener("change",u=>{Or(we.companyName,u.target.value.trim())}),(c=document.getElementById("config-payroll-provider"))==null||c.addEventListener("change",u=>{Or(we.payrollProvider,u.target.value.trim())}),(l=document.getElementById("config-accounting-link"))==null||l.addEventListener("change",u=>{Or(we.accountingSoftware,u.target.value.trim())}),(f=document.getElementById("config-user-name"))==null||f.addEventListener("change",u=>{Or(we.reviewerName,u.target.value.trim())});let t=document.getElementById("config-notes");t==null||t.addEventListener("input",u=>{dr(0,"notes",u.target.value)});let a=document.getElementById("config-notes-lock");a==null||a.addEventListener("click",async()=>{let u=!a.classList.contains("is-locked");Uo(a,u),await _u(0,u)});let n=document.getElementById("config-notes-save");n==null||n.addEventListener("click",async()=>{t&&(await dr(0,"notes",t.value),Wr(n,!0))});let i=document.getElementById("config-reviewer");i==null||i.addEventListener("change",u=>{let h=u.target.value.trim();dr(0,"reviewer",h);let m=document.getElementById("config-signoff-date");if(h&&m&&!m.value){let p=Zo();m.value=p,dr(0,"signOffDate",p),ku(0,!0)}}),(d=document.getElementById("config-signoff-date"))==null||d.addEventListener("change",u=>{dr(0,"signOffDate",u.target.value||"")});let s=document.getElementById("config-signoff-save");s==null||s.addEventListener("click",async()=>{var m,p;let u=((m=i==null?void 0:i.value)==null?void 0:m.trim())||"",h=((p=document.getElementById("config-signoff-date"))==null?void 0:p.value)||"";await dr(0,"reviewer",u),await dr(0,"signOffDate",h),Wr(s,!0)}),jo(),Eu(0,{buttonId:"config-signoff-toggle",inputId:"config-signoff-date",onComplete:()=>{WE(),du(0),hu()}}),pu("config-signoff-toggle-prev","config-signoff-toggle-next")}function es(e,r=null){if(e<0||e>=hr.length)return;Yi=e;let t=r!=null?r:hr[e].id;Zn({focusedIndex:e,activeView:t===0?"config":"step",activeStepId:t});let n=Ek[t];n&&(console.log("[NAV] Step\u2192Sheet activation",{moduleKey:oa,stepIndex:e,stepId:t,targetSheetName:n}),Ra(n).then(()=>{console.log("[NAV] Step\u2192Sheet activation success",{moduleKey:oa,stepId:t,targetSheetName:n})}).catch(i=>{var s;console.warn("[NAV] Step\u2192Sheet activation failed",{moduleKey:oa,stepId:t,targetSheetName:n,error:(s=i==null?void 0:i.message)!=null?s:String(i)})})),t===2&&!De.hasAnalyzed&&Kn()}function qk(e){return e===4?null:()=>du(e)}function du(e){let r=hr.findIndex(a=>a.id===e);if(r===-1)return;let t=r+1;t<hr.length&&(es(t,hr[t].id),hu())}function hu(){let e=[document.querySelector(".pf-root"),document.querySelector(".pf-step-guide"),document.body];for(let r of e)r&&r.scrollTo({top:0,behavior:"smooth"});window.scrollTo({top:0,behavior:"smooth"})}function Ji(e){let r=it.focusedIndex+e,t=Math.max(0,Math.min(hr.length-1,r));es(t,hr[t].id),window.scrollTo({top:0,behavior:"smooth"})}function pu(e,r){var t,a;(t=document.getElementById(e))==null||t.addEventListener("click",()=>Ji(-1)),(a=document.getElementById(r))==null||a.addEventListener("click",()=>Ji(1))}function Kk(){if(Yi===null)return;let e=document.querySelector(`[data-step-index="${Yi}"]`);Yi=null,e==null||e.scrollIntoView({behavior:"smooth",block:"center"})}function Jk(e){var a;let r=Su(Ce.completes[e]),t=!!((a=Ce.steps[e])!=null&&a.signOffDate);return r||t}function Zn(e){e.stepStatuses&&(it.stepStatuses={...it.stepStatuses,...e.stepStatuses}),Object.assign(it,{...e,stepStatuses:it.stepStatuses}),wt()}function Ot(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}async function Yf(){Ne("Please update pay rates in SS_Employee_Roster, then regenerate PTO_Review","info")}function Zk(){let e=document.getElementById("payrate-input");if(!e)return;let r=e.dataset.employee;r&&(Ia.ignoredMissingPayRates.add(r),Ia.missingPayRates=Ia.missingPayRates.filter(t=>t.name!==r)),es(3,3)}var sa={ROSTER_OVERRIDE:"Roster Override",ROSTER:"Roster",PAYROLL:"Payroll",DEFAULT:"Default",MISSING:"Missing"},Yo=2080;function nn(e){return e?String(e).trim().replace(/\s+/g," ").toUpperCase():""}var Vt={loaded:!1,loading:!1,lastRun:null,rates:new Map,diagnostics:{fromRosterOverride:0,fromRoster:0,fromPayroll:0,fromDefault:0,missing:0,total:0,missingEmployees:[],topByLiability:[]}};async function Qk(){console.log("[RateEngine] Starting rate load..."),Vt.loading=!0,Vt.rates.clear();let e=Vt.diagnostics;if(e.fromRosterOverride=0,e.fromRoster=0,e.fromPayroll=0,e.fromDefault=0,e.missing=0,e.total=0,e.missingEmployees=[],e.topByLiability=[],!Ot())return console.warn("[RateEngine] Excel not available"),Vt.loading=!1,Vt.rates;try{await Excel.run(async t=>{let a=await eE(t),n=await rE(t),i=await aE(t);for(let s of i){let o=nn(s.name);e.total++;let c=null,l=sa.MISSING,f="",d=a.get(o);if(d){if(d.isManuallyManaged&&d.hourlyRate>0)c=d.hourlyRate,l=sa.ROSTER_OVERRIDE,f=d.rateSource||"Manual override",e.fromRosterOverride++;else if(d.hourlyRate>0)c=d.hourlyRate,l=sa.ROSTER,f=d.rateSource||"Hourly_Rate column",e.fromRoster++;else if(d.salaryAnnual>0){let h=d.stdHoursPerYear||Yo;c=d.salaryAnnual/h,l=sa.ROSTER,f=`Salary ${d.salaryAnnual.toFixed(0)} / ${h} hrs`,e.fromRoster++}}if(!c&&n.has(o)){let h=n.get(o);h.rate>0&&(c=h.rate,l=sa.PAYROLL,f=`Fixed $${h.avgFixedPerPeriod.toFixed(0)} / ${tE}hrs (${h.periods} periods)`,e.fromPayroll++)}c||(l=sa.MISSING,f="No rate source available",e.missing++,e.missingEmployees.push({name:s.name,key:o}));let u=(d==null?void 0:d.department)||"";Vt.rates.set(o,{employeeName:s.name,rate:c||0,source:l,sourceDetail:f,balance:s.balance||0,department:u})}await t.sync()});let r=Array.from(Vt.rates.values()).filter(t=>t.rate>0&&t.balance>0).map(t=>({name:t.employeeName,balance:t.balance,rate:t.rate,liability:t.balance*t.rate})).sort((t,a)=>a.liability-t.liability).slice(0,10);e.topByLiability=r,console.log("[RateEngine] Load complete:",{total:e.total,fromRosterOverride:e.fromRosterOverride,fromRoster:e.fromRoster,fromPayroll:e.fromPayroll,fromDefault:e.fromDefault,missing:e.missing,missingNames:e.missingEmployees.map(t=>t.name)}),console.log("[RateEngine] Top 10 by liability:",e.topByLiability),Vt.loaded=!0,Vt.loading=!1,Vt.lastRun=new Date().toISOString()}catch(r){console.error("[RateEngine] Error loading rates:",r),Vt.loading=!1}return Vt.rates}async function eE(e){let r=new Map,t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(t.load("isNullObject"),await e.sync(),t.isNullObject)return console.log("[RateEngine] SS_Employee_Roster not found"),r;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return console.log("[RateEngine] SS_Employee_Roster is empty"),r;let n=a.values[0].map(h=>String(h||"").toLowerCase().trim()),i=n.findIndex(h=>h==="employee_name"||h==="employee name"||h==="name"),s=n.findIndex(h=>h==="hourly_rate_prismhr"||h==="hourly rate prismhr"),o=n.findIndex(h=>h==="hourly_rate"||h==="hourly rate"||h==="pay_rate"||h==="pay rate"),c=n.findIndex(h=>h==="salary_annual"||h==="annual salary"||h==="salary"),l=n.findIndex(h=>h==="std_hours_per_year"||h==="standard hours"),f=n.findIndex(h=>h==="is_manually_managed"||h==="manual"),d=n.findIndex(h=>h==="rate_source"||h==="rate source"),u=n.findIndex(h=>h==="department"||h==="department_name"||h==="dept"||h.includes("department"));if(console.log("[RateEngine] Roster columns found:",{nameIdx:i,hourlyPrismhrIdx:s,hourlyIdx:o,salaryIdx:c,stdHoursIdx:l,manualIdx:f,rateSourceIdx:d,deptIdx:u}),i<0)return console.warn("[RateEngine] No employee name column in roster"),r;for(let h=1;h<a.values.length;h++){let m=a.values[h],p=String(m[i]||"").trim();if(!p)continue;let g=nn(p),v=s>=0&&parseFloat(m[s])||0,y=o>=0&&parseFloat(m[o])||0,x=v>0?v:y,F=c>=0&&parseFloat(m[c])||0,I=l>=0&&parseFloat(m[l])||Yo,A=f>=0?String(m[f]||"").toUpperCase()==="TRUE":!1,k=d>=0?String(m[d]||"").trim():"",N=u>=0?String(m[u]||"").trim():"";r.set(g,{name:p,hourlyRate:x,salaryAnnual:F,stdHoursPerYear:I,isManuallyManaged:A,rateSource:k,department:N,rowIndex:h})}return console.log(`[RateEngine] Loaded ${r.size} employees from roster`),r}var tE=80;async function rE(e,r=3){let t=new Map;return console.log("[RateEngine] loadPayrollDerivedRates: Rates now sourced from SS_Employee_Roster.Hourly_Rate"),t}async function aE(e){let r=[],t=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(t.load("isNullObject"),await e.sync(),t.isNullObject)return console.log("[RateEngine] PTO_Data_Clean not found"),r;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return r;let n=a.values[0].map(o=>String(o||"").toLowerCase().trim()),i=n.findIndex(o=>o==="employee_name"||o==="employee name"||o.includes("employee")),s=n.findIndex(o=>o==="balance"||o.includes("balance"));if(i<0)return console.warn("[RateEngine] No employee name column in PTO data"),r;for(let o=1;o<a.values.length;o++){let c=a.values[o],l=String(c[i]||"").trim();if(!l)continue;let f=s>=0&&parseFloat(c[s])||0;r.push({name:l,balance:f,rowIndex:o})}return console.log(`[RateEngine] Found ${r.length} employees in PTO data`),r}function nE(e){let r=nn(e);return Vt.rates.get(r)||null}var qi=["Analysis_Date","Employee_ID","Employee_Name","Vested_Balance","Calc_Liability"],qf=5;async function iE(){if(!Ot())return{ok:!1,error:"Excel unavailable"};try{return await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Archive_Summary");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.log("[PTOArchive] Creating PTO_Archive_Summary sheet"),r=e.workbook.worksheets.add("PTO_Archive_Summary");let a=r.getRangeByIndexes(0,0,1,qi.length);return a.values=[qi],a.format.font.bold=!0,await e.sync(),{ok:!0,created:!0}}let t=r.getUsedRangeOrNullObject();if(t.load("values"),await e.sync(),!t.isNullObject&&t.values&&t.values.length>0){let a=t.values[0].map(s=>String(s||"").trim()),n=new Set(a.map(s=>s.toLowerCase())),i=qi.filter(s=>!n.has(s.toLowerCase()));if(i.length>0){console.log("[PTOArchive] Adding missing columns:",i);let s=a.length,o=r.getRangeByIndexes(0,s,1,i.length);o.values=[i],o.format.font.bold=!0;let c=t.values.length-1;if(c>0){let l=Array(c).fill(i.map(()=>0)),f=r.getRangeByIndexes(1,s,c,i.length);f.values=l}await e.sync()}}return{ok:!0}})}catch(e){return console.error("[PTOArchive] Error ensuring schema:",e),{ok:!1,error:e.message}}}async function sE(){let e=new Map;if(!Ot())return e;try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Archive_Summary");if(t.load("isNullObject"),await r.sync(),t.isNullObject){console.log("[PTOArchive] No archive sheet - all employees will show as NEW");return}let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)return;let n=a.values[0].map(u=>String(u||"").toLowerCase().trim()),i=n.findIndex(u=>u==="analysis_date"||u.includes("date")),s=n.findIndex(u=>u==="employee_id"||u==="employee_key"),o=n.findIndex(u=>u==="employee_name"||u.includes("employee")),c=n.findIndex(u=>u==="vested_balance"||u==="balance"),l=n.findIndex(u=>u==="calc_liability"||u==="liability_amount"||u.includes("liability")),f=n.findIndex(u=>u==="pay_rate"||u.includes("rate"));if(o<0&&s<0){console.warn("[PTOArchive] No employee identifier column");return}let d=new Map;for(let u=1;u<a.values.length;u++){let h=a.values[u],m=s>=0?String(h[s]||"").trim():nn(String(h[o]||""));if(!m)continue;let p=i>=0?String(h[i]||""):"",g=c>=0&&parseFloat(h[c])||0,v=l>=0&&parseFloat(h[l])||0,y=f>=0&&parseFloat(h[f])||0;d.has(m)||d.set(m,[]),d.get(m).push({analysisDate:p,liability:v,rate:y,balance:g})}for(let[u,h]of d)h.sort((m,p)=>String(p.analysisDate).localeCompare(String(m.analysisDate))),e.set(u,h[0]);console.log(`[PTOArchive] Loaded prior data for ${e.size} employees`)})}catch(r){console.error("[PTOArchive] Error loading prior data:",r)}return e}async function oE(e,r){if(!Ot()||!e||e.length===0)return{ok:!1,error:"No data to archive"};try{return await iE(),await Excel.run(async t=>{let a=t.workbook.worksheets.getItem("PTO_Archive_Summary"),n=a.getUsedRangeOrNullObject();n.load("values"),await t.sync();let i=qi,s=[];!n.isNullObject&&n.values&&n.values.length>0&&(i=n.values[0].map(y=>String(y||"").trim()),s=n.values.slice(1));let o=i.map(y=>y.toLowerCase()),c=o.indexOf("analysis_date"),l=o.indexOf("employee_id")>=0?o.indexOf("employee_id"):o.indexOf("employee_key"),f=new Map;for(let y of s){let x=c>=0?String(y[c]||""):"";x&&(f.has(x)||f.set(x,[]),f.get(x).push(y))}let d=String(r||"").substring(0,10);f.delete(d);let u=e.map(y=>{let x=new Array(i.length).fill("");return i.forEach((F,I)=>{var k,N,D,M;let A=F.toLowerCase();A==="analysis_date"?x[I]=d:A==="employee_id"||A==="employee_key"?x[I]=y.employeeId||nn(y.employeeName):A==="employee_name"?x[I]=y.employeeName||"":A==="vested_balance"||A==="balance"?x[I]=(N=(k=y.vestedBalance)!=null?k:y.balance)!=null?N:0:A==="department"?x[I]=y.department||"":A==="pay_rate"?x[I]=y.payRate||0:A==="accrual_rate"?x[I]=y.accrualRate||0:A==="carry_over"?x[I]=y.carryOver||0:A==="ytd_accrued"?x[I]=y.ytdAccrued||0:A==="ytd_used"?x[I]=y.ytdUsed||0:(A==="calc_liability"||A==="liability_amount")&&(x[I]=(M=(D=y.calculatedLiability)!=null?D:y.liabilityAmount)!=null?M:0)}),x});if(f.set(d,u),f.size>qf){let x=Array.from(f.keys()).sort().slice(0,f.size-qf);for(let F of x)console.log(`[PTOArchive] Removing oldest period: ${F}`),f.delete(F)}let h=[];for(let[,y]of f)h.push(...y);let m=a.getUsedRangeOrNullObject();await t.sync(),m.isNullObject||m.clear();let p=1+h.length,g=a.getRangeByIndexes(0,0,p,i.length);g.values=[i,...h];let v=a.getRangeByIndexes(0,0,1,i.length);return v.format.font.bold=!0,await t.sync(),console.log(`[PTOArchive] Saved ${u.length} rows for period ${d}`),{ok:!0,rowCount:u.length,periodCount:f.size}})}catch(t){return console.error("[PTOArchive] Error saving archive:",t),{ok:!1,error:t.message}}}var Go=["Analysis_Date","Employee_Name","Employee_ID","Department","Pay_Rate","Rate_Source","Accrual_Rate","Carry_Over","YTD_Accrued","YTD_Used","Vested_Balance","Register_Balance","Liability_Amount","Liability_Source","Report_Liability","Calc_Liability","Prior_Liability","Change","_Flags"];function Kf(e){return e?String(e).toUpperCase().replace(/,/g," ").replace(/\s+/g," ").trim():""}async function cE(e){let r={rosterCount:0,ptoReportCount:e.length,inBothCount:0,inPtoOnlyCount:0,inPtoOnlyNames:[],inPtoOnlyLiability:0,inRosterOnlyCount:0,inRosterOnlyNames:[]};if(!Ot())return r;try{await Excel.run(async t=>{let a=t.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(a.load("isNullObject"),await t.sync(),a.isNullObject){console.warn("[Coverage] SS_Employee_Roster not found");return}let n=a.getUsedRangeOrNullObject();if(n.load("values"),await t.sync(),n.isNullObject||!n.values||n.values.length<2)return;let i=n.values[0].map(u=>String(u||"").toLowerCase().trim()),s=i.findIndex(u=>u==="employee_name"||u.includes("employee")),o=i.findIndex(u=>u==="employment_status"||u.includes("status"));if(s<0){console.warn("[Coverage] Employee name column not found in roster");return}let c=new Map,l=new Set;for(let u=1;u<n.values.length;u++){let h=n.values[u],m=String(h[s]||"").trim(),p=Kf(m),g=o>=0?String(h[o]||"").toLowerCase():"";p&&!g.includes("terminated")&&!g.includes("inactive")&&(l.add(p),c.set(p,m))}r.rosterCount=l.size;let f=new Map,d=new Set;for(let u of e){let h=Kf(u.employeeName);h&&(d.add(h),f.set(h,u))}console.log("[Coverage] Roster employees:",l.size,"PTO employees:",d.size);for(let u of d)if(l.has(u))r.inBothCount++;else{r.inPtoOnlyCount++;let h=f.get(u);h&&(r.inPtoOnlyNames.push(h.employeeName),r.inPtoOnlyLiability+=h.calculatedLiability||0)}for(let u of l)if(!d.has(u)){r.inRosterOnlyCount++;let h=c.get(u);h&&r.inRosterOnlyNames.push(h)}await t.sync()})}catch(t){console.error("[Coverage] Error calculating employee coverage:",t)}return console.log("[Coverage] Results:",r),r}async function lE(){var e;console.log("[PTOReview] Starting review generation..."),Xe.loading=!0,Ne("Generating PTO Accrual Review...","info",3e3);try{await Qk();let r=await sE(),t=await fE(r);await uE(t);let a=0,n=0,i=0,s=0,o=0,c=0,l=0,f=0,d=0;for(let h of t){a+=h.liabilityAmount||0,n+=h.priorLiability||0,i+=h.reportLiability||0;let m=h.calculatedLiability||0;s+=m;let p=(e=h.vestedBalance)!=null?e:0;p<0?(o+=m,c++):p>0?l++:f++,(!h.payRate||h.payRate<=0)&&d++}Xe.reconciliation={reportLiabilityTotal:i,calcLiabilityTotal:s,negativeBalanceTotal:o,negativeBalanceCount:c,positiveBalanceCount:l,zeroBalanceCount:f,missingRateCount:d};let u=await cE(t);Xe.coverage=u,Xe.totalCurrentLiability=a,Xe.totalPriorLiability=n,Xe.netChange=a-n,Xe.employeeCount=t.length,Xe.reviewData=t,Xe.loaded=!0,Xe.loading=!1,Xe.lastRun=new Date().toISOString(),console.log("[PTOReview] Generation complete:",{employees:t.length,totalCurrent:a,totalPrior:n,netChange:a-n,reconciliation:Xe.reconciliation,coverage:Xe.coverage}),Ne(`PTO Review generated: ${t.length} employees, ${dE(a)} total liability`,"success"),wt()}catch(r){console.error("[PTOReview] Error generating review:",r),Ne(`Error generating review: ${r.message}`,"error"),Xe.loading=!1}}async function fE(e){let r=[],t=At(we.payrollDate)||new Date().toISOString().substring(0,10);return Ot()&&(await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(n.load("isNullObject"),await a.sync(),n.isNullObject)throw new Error("PTO_Data_Clean not found. Upload data in Step 1.");let i=n.getUsedRangeOrNullObject();if(i.load("values"),await a.sync(),i.isNullObject||!i.values||i.values.length<2)throw new Error("PTO_Data_Clean is empty.");let s=i.values[0].map(m=>String(m||"").toLowerCase().trim());console.log("[PTOReview] All headers from PTO_Data_Clean:",s);let o={employeeName:s.findIndex(m=>m==="employee_name"||m==="employee name"||m==="employeename"||m==="name"||m==="full_name"||m==="full name"),department:s.findIndex(m=>m==="department"||m==="department_name"),accrualRate:s.findIndex(m=>m==="accrual_rate"||m.includes("accrual")&&m.includes("rate")),carryOver:s.findIndex(m=>m==="carry_over"||m.includes("carry")),ytdAccrued:s.findIndex(m=>m==="ytd_accrued"||m.includes("ytd")&&m.includes("accrued")),ytdUsed:s.findIndex(m=>m==="ytd_used"||m.includes("ytd")&&m.includes("used")),balance:s.findIndex(m=>m==="balance")},c=s.findIndex(m=>m==="pay_rate_hourly"||m==="pay rate hourly"||m==="payratehourly"),l=s.findIndex(m=>m==="accrued_liability"||m==="accrued liability"||m==="accruedliability"),f=s.findIndex(m=>m==="as_of_date_balance"||m==="as of date balance"||m==="asofdatebalance"),d=s.findIndex(m=>m==="current_register_balance"||m==="current register balance"||m==="currentregisterbalance"),u=s.findIndex(m=>m==="employee_id"||m==="employee id"||m==="employeeid"),h=s.findIndex(m=>m==="department"||m==="department_name");if(console.log("[PTOReview] Column indexes:",o),console.log("[PTOReview] Employee name found at index:",o.employeeName,"header:",s[o.employeeName]),console.log("[PTOReview] Report columns detected:",{payRateHourly:c>=0,accruedLiability:l>=0,asOfDateBalance:f>=0,currentRegisterBalance:d>=0,employeeId:u>=0}),o.employeeName<0)throw console.error("[PTOReview] Could not find employee name column. Headers available:",s),new Error("Employee name column not found in PTO data. Check console for available headers.");for(let m=1;m<i.values.length;m++){let p=i.values[m],g=String(p[o.employeeName]||"").trim();if(!g)continue;let v=nn(g),y=nE(g),x=c>=0?Xo(p[c]):0,F=(y==null?void 0:y.rate)||0,I=x>0?x:F,A=x>0?"REPORT":(y==null?void 0:y.source)||sa.MISSING,k=h>=0?String(p[h]||"").trim():"",N=(y==null?void 0:y.department)||"",D=k||N,M=u>=0?String(p[u]||"").trim():"",W=o.accrualRate>=0&&parseFloat(p[o.accrualRate])||0,L=o.carryOver>=0&&parseFloat(p[o.carryOver])||0,ee=o.ytdAccrued>=0&&parseFloat(p[o.ytdAccrued])||0,de=o.ytdUsed>=0&&parseFloat(p[o.ytdUsed])||0,J=f>=0?parseFloat(p[f])||0:null,te=d>=0?parseFloat(p[d])||0:o.balance>=0&&parseFloat(p[o.balance])||0,ie=J!==null?J:te,ye=te,re=0,Z="NO_BALANCE",G=0,C=0;ie>0?(G=l>=0?Xo(p[l]):0,C=I>0?ie*I:0,G>0?(re=G,Z="REPORT"):(re=C,Z="CALCULATED")):ie<0?(re=0,Z="NEGATIVE_BALANCE",C=ie*I):(re=0,Z="NO_BALANCE"),console.log(`[PTOReview] ${g}: vestedBal=${ie}, displayBal=${ye}, liability=${re.toFixed(2)} (${Z})`);let B=e.get(v),R=(B==null?void 0:B.liability)||0,P=C-R,z=[];B||z.push("NEW"),A===sa.MISSING&&z.push("MISSING_RATE"),Math.abs(P)>Xe.flagThresholds.largeMove&&z.push("LARGE_MOVE"),ie<0&&z.push("NEG_BALANCE"),x>0&&F>0&&Math.abs(x-F)>5&&(z.push("RATE_VARIANCE"),console.log(`[PTOReview] Rate variance for ${g}: Report=$${x.toFixed(2)} vs Calc=$${F.toFixed(2)}`)),ie>0&&G>0&&C>0&&Math.abs(G-C)>100&&(z.push("LIABILITY_VARIANCE"),console.log(`[PTOReview] Liability variance for ${g}: Report=$${G.toFixed(2)} vs Calc=$${C.toFixed(2)}`)),r.push({analysisDate:t,employeeName:g,employeeId:M,department:D,payRate:I,rateSource:A,accrualRate:W,carryOver:L,ytdAccrued:ee,ytdUsed:de,vestedBalance:ie,displayBalance:ye,liabilityAmount:re,liabilitySource:Z,reportLiability:G,calculatedLiability:C,priorLiability:R,change:P,flags:z.join(", ")})}await a.sync()}),r.sort((a,n)=>n.liabilityAmount-a.liabilityAmount)),r}async function uE(e){Ot()&&await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");t.load("isNullObject"),await r.sync(),t.isNullObject&&(t=r.workbook.worksheets.add("PTO_Review"));let a=t.getUsedRangeOrNullObject();await r.sync(),a.isNullObject||a.clear();let n=e.map(l=>[l.analysisDate,l.employeeName,l.employeeId||"",l.department,l.payRate,l.rateSource||"",l.accrualRate,l.carryOver,l.ytdAccrued,l.ytdUsed,l.vestedBalance,l.displayBalance,l.liabilityAmount,l.liabilitySource||"",l.reportLiability||0,l.calculatedLiability||0,l.priorLiability,l.change,l.flags]),i=[Go,...n],s=t.getRangeByIndexes(0,0,i.length,Go.length);s.values=i;let o=t.getRangeByIndexes(0,0,1,Go.length);Xn(o);let c="$#,##0.00";n.length>0&&(t.getRangeByIndexes(1,4,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,12,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,14,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,15,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,16,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,17,n.length,1).numberFormat=[[c]]),s.format.autofitColumns(),t.freezePanes.freezeRows(1),await r.sync(),console.log(`[PTOReview] Wrote ${n.length} rows to PTO_Review sheet`)})}function dE(e){return(Number(e)||0).toLocaleString("en-US",{style:"currency",currency:"USD"})}var Pe={file:null,fileName:"",headers:[],rowCount:0,parsedData:null,mappings:null,unmappedHeaders:[],error:null,loading:!1},hE=["Company_Name","Form_Name","Selection_Criteria","Employee_Name","Plan_Description","Accrue_Through_Date","Year_Ending"],pE=["Accrual_Rate","Carry_Over","Pay_Period_Accrued","Pay_Period_Used","YTD_Accrued","YTD_Used","Balance"],qS=[...hE,...pE];async function Jf(e){if(e){await Zf(e);return}let r=document.getElementById("pto-file-input");r||(r=document.createElement("input"),r.type="file",r.id="pto-file-input",r.accept=".csv,.xlsx,.xls",r.style.display="none",document.body.appendChild(r),r.addEventListener("change",async t=>{var n;let a=(n=t.target.files)==null?void 0:n[0];a&&await Zf(a),r.value=""})),r.click()}async function Zf(e){let r=[".csv",".xlsx",".xls"],t=e.name.toLowerCase().slice(e.name.lastIndexOf("."));if(!r.includes(t)){Ne("Please upload a CSV or Excel file (.csv, .xlsx, .xls)","error");return}Pe.loading=!0,Pe.error=null,Pe.fileName=e.name,Pe.file=e,Ne(`Reading ${e.name}...`,"info",2e3),Yn("Reading file...");try{let a=await gE(e);if(!a||a.length<2)throw new Error("File appears empty or has no data rows.");Pe.headers=a[0].map(u=>String(u||"").trim()),Pe.rowCount=a.length-1,Pe.parsedData=a,console.log(`[PTOUpload] Parsed ${Pe.headers.length} columns, ${Pe.rowCount} rows`),console.log("[PTOUpload] Raw headers:",Pe.headers),Yn("Loading column mappings...");let n=At("SS_Company_ID"),i=await xE(n,"pto-accrual"),s=await EE();console.log(`[PTOUpload] Loaded ${i.length} customer mappings, ${s.size} dimension mappings`);let{normalizedHeaders:o,includedIndexes:c,unmapped:l,excluded:f}=vE(Pe.headers,i,s);Pe.mappings=s,Pe.unmappedHeaders=l,l.length>0&&(console.warn("[PTOUpload] Unmapped headers:",l),Ne(`Warning: ${l.length} column(s) could not be mapped`,"warning",4e3)),f.length>0&&console.log("[PTOUpload] Excluded columns (include_in_matrix=false):",f),console.log("[PTOUpload] Normalized headers:",o),console.log("[PTOUpload] Included column indexes:",c),Yn("Writing to PTO_Data_Clean..."),await kE(o,Pe.parsedData,c),Pe.loading=!1,Ne(`Successfully imported ${Pe.rowCount} rows to PTO_Data_Clean`,"success"),Yn(`\u2713 ${Pe.rowCount} rows imported`),wt();let d=await mE();d.ok&&d.rowsUpdated>0?(console.log(`[PTO] Synced ${d.rowsUpdated} employees to roster (${d.idUpdates} IDs, ${d.rateUpdates} rates)`),Ne(`Updated ${d.rowsUpdated} employees in roster`,"success",2e3)):d.ok||console.warn("[PTO] Roster sync skipped:",d.error),Ne("Running validation checks...","info",2e3),await Promise.all([Kn(),Ki()]),wt(),Ne("Validation checks complete!","success")}catch(a){console.error("[PTOUpload] Error:",a),Pe.error=a.message,Pe.loading=!1,Ne(`Upload failed: ${a.message}`,"error"),Yn(`Error: ${a.message}`)}}function Yn(e){let r=document.getElementById("pto-upload-status");r&&(r.textContent=e)}async function mE(){if(!Ot())return console.log("[PTO-Roster Sync] Excel not available, skipping roster sync"),{ok:!1,error:"Excel not available"};console.log("[PTO-Roster Sync] Starting sync to SS_Employee_Roster...");try{return await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean"),t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(r.load("isNullObject"),t.load("isNullObject"),await e.sync(),r.isNullObject)return console.warn("[PTO-Roster Sync] PTO_Data_Clean not found"),{ok:!1,error:"PTO_Data_Clean not found"};if(t.isNullObject)return console.warn("[PTO-Roster Sync] SS_Employee_Roster not found"),{ok:!1,error:"SS_Employee_Roster not found"};let a=r.getUsedRangeOrNullObject(),n=t.getUsedRangeOrNullObject();if(a.load("values"),n.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return{ok:!1,error:"PTO_Data_Clean is empty"};if(n.isNullObject||!n.values||n.values.length<2)return{ok:!1,error:"SS_Employee_Roster is empty"};let i=a.values[0].map(m=>String(m||"").toLowerCase().trim()),s={employeeName:i.findIndex(m=>m==="employee_name"||m==="employee name"),employeeId:i.findIndex(m=>m==="employee_id"||m==="employee id"),payRateHourly:i.findIndex(m=>m==="pay_rate_hourly"||m==="pay rate hourly")};if(console.log("[PTO-Roster Sync] PTO column indexes:",s),s.employeeName<0)return{ok:!1,error:"Employee_Name column not found in PTO data"};let o=new Map;for(let m=1;m<a.values.length;m++){let p=a.values[m],g=String(p[s.employeeName]||"").trim();if(!g)continue;let v=g.toLowerCase();o.set(v,{employeeId:s.employeeId>=0?String(p[s.employeeId]||"").trim():"",payRateHourly:s.payRateHourly>=0?Xo(p[s.payRateHourly]):0})}console.log(`[PTO-Roster Sync] Loaded ${o.size} employees from PTO data`);let c=n.values[0].map(m=>String(m||"").toLowerCase().trim()),l={employeeName:c.findIndex(m=>m==="employee_name"),employeeId:c.findIndex(m=>m==="employee_id"),hourlyRatePrismhr:c.findIndex(m=>m==="hourly_rate_prismhr")};if(console.log("[PTO-Roster Sync] Roster column indexes:",l),l.hourlyRatePrismhr<0&&console.warn("[PTO-Roster Sync] Hourly_Rate_Prismhr column not found in roster - it may need to be added via payroll-recorder schema update"),l.employeeName<0)return{ok:!1,error:"Employee_Name column not found in roster"};let f=0,d=0,u=0;for(let m=1;m<n.values.length;m++){let p=n.values[m],g=String(p[l.employeeName]||"").trim();if(!g)continue;let v=g.toLowerCase(),y=o.get(v);if(!y)continue;let x=!1;if(l.employeeId>=0&&y.employeeId){let F=String(p[l.employeeId]||"").trim();(!F||F.includes(" "))&&(t.getRangeByIndexes(m,l.employeeId,1,1).values=[[y.employeeId]],x=!0,d++)}l.hourlyRatePrismhr>=0&&y.payRateHourly>0&&(t.getRangeByIndexes(m,l.hourlyRatePrismhr,1,1).values=[[y.payRateHourly]],x=!0,u++),x&&f++}await e.sync();let h={ok:!0,totalMatched:o.size,rowsUpdated:f,idUpdates:d,rateUpdates:u};return console.log("[PTO-Roster Sync] Complete:",h),h})}catch(e){return console.error("[PTO-Roster Sync] Error:",e),{ok:!1,error:e.message}}}async function gE(e){return new Promise((r,t)=>{let a=new FileReader;a.onload=n=>{try{let i=n.target.result,s=Fi(i,{type:"array"}),o=s.SheetNames[0];if(!o)throw new Error("No sheets found in workbook");let c=s.Sheets[o],l=Vr.sheet_to_json(c,{header:1,defval:""}),f=0;for(let d=0;d<Math.min(10,l.length);d++){let h=l[d].map(m=>String(m||"").toLowerCase()).join(" ");if(h.includes("employee")||h.includes("balance")||h.includes("accrual")){f=d;break}}console.log(`[PTOUpload] Header row detected at index ${f}`),r(l.slice(f))}catch(i){t(i)}},a.onerror=()=>t(new Error("Failed to read file")),a.readAsArrayBuffer(e)})}async function xE(e,r){if(!e)return console.warn("[PTOUpload] No companyId provided, skipping customer mappings"),[];console.log(`[PTOUpload] Loading customer column mappings for company=${e}, module=${r}`);try{let t=`${Ko}/rest/v1/ada_customer_column_mappings?crm_company_id=eq.${encodeURIComponent(e)}&module=eq.${encodeURIComponent(r)}&select=raw_header,pf_column_name,include_in_matrix`,a=await fetch(t,{headers:{apikey:rn,Authorization:`Bearer ${rn}`,"Content-Type":"application/json"}});if(!a.ok)return console.warn(`[PTOUpload] Customer mappings API error: ${a.status}`),[];let n=await a.json();return console.log(`[PTOUpload] Loaded ${n.length} customer column mappings`),n}catch(t){return console.error("[PTOUpload] Error loading customer mappings:",t),[]}}function vE(e,r,t){let a=[],n=[],i=[],s=[],o=new Map;for(let c of r){let l=$e(c.raw_header);o.set(l,c)}for(let c=0;c<e.length;c++){let l=e[c],f=$e(l),d=o.get(f);if(d){let m=d.include_in_matrix;if(m===!1||m==="false"){s.push(l),console.log(`[PTOUpload] Excluding column "${l}" (include_in_matrix=false)`);continue}a.push(d.pf_column_name),n.push(c);continue}let u=t.get(f);if(u){a.push(u),n.push(c);continue}let h=l.trim().replace(/[^a-zA-Z0-9\s]/g,"").split(/\s+/).map(m=>m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()).join("_");a.push(h||`Column_${a.length+1}`),n.push(c),l.trim()&&i.push(l)}return{normalizedHeaders:a,includedIndexes:n,unmapped:i,excluded:s}}function yE(e){if(typeof e!="number"||e<1)return null;let r=new Date(1899,11,30);return new Date(r.getTime()+e*24*60*60*1e3)}function wE(e){if(!e)return"";if(typeof e=="string"){let r=e.trim();if(r.match(/^\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}$/))return r;if(r.match(/^\d{4}-\d{2}-\d{2}/)){let t=new Date(r);if(!isNaN(t.getTime()))return`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()}`}return r}if(typeof e=="number"&&e>1e3&&e<1e5){let r=yE(e);if(r)return`${r.getMonth()+1}/${r.getDate()}/${r.getFullYear()}`}return e instanceof Date&&!isNaN(e.getTime())?`${e.getMonth()+1}/${e.getDate()}/${e.getFullYear()}`:String(e)}function _E(e){let r=e.toLowerCase();return r.includes("balance")||r.includes("amount")||r.includes("liability")?!1:r.includes("_date")||r.includes("date_")||r==="date"||r.endsWith(" date")||r.startsWith("date ")||r.includes("hire")||r.includes("termination")||r.includes("start_date")||r.includes("end_date")||r==="as_of"}async function kE(e,r,t){if(!Ot())throw new Error("Excel runtime not available");let a=[];e.forEach((n,i)=>{_E(n)&&(a.push(i),console.log(`[PTOUpload] Detected date column: "${n}" at index ${i}`))}),await Excel.run(async n=>{let i=n.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");i.load("isNullObject"),await n.sync(),i.isNullObject&&(i=n.workbook.worksheets.add("PTO_Data_Clean"),console.log("[PTOUpload] Created PTO_Data_Clean sheet"));let s=i.getUsedRangeOrNullObject();await n.sync(),s.isNullObject||s.clear();let o=[e];for(let f=1;f<r.length;f++){let d=r[f],u=t.map((h,m)=>{let p=d[h];return a.includes(m)?wE(p):p!=null?p:""});o.push(u)}let c=i.getRangeByIndexes(0,0,o.length,e.length);c.values=o;let l=i.getRangeByIndexes(0,0,1,e.length);if(Xn(l),o.length>1&&a.length>0)for(let f of a){let d=i.getRangeByIndexes(1,f,o.length-1,1);d.numberFormat=[["mm/dd/yyyy"]]}c.format.autofitColumns(),i.freezePanes.freezeRows(1),await n.sync(),console.log(`[PTOUpload] Wrote ${o.length-1} rows, ${e.length} columns to PTO_Data_Clean`)})}async function EE(){console.log("[PTOUpload] Loading Obsidian dimension mappings via edge function...");try{let e=`${Ko}/functions/v1/column-mapper`,r=await fetch(e,{method:"POST",headers:{apikey:rn,Authorization:`Bearer ${rn}`,"Content-Type":"application/json"},body:JSON.stringify({action:"get_dimensions",provider:"obsidian"})});if(!r.ok){let n=await r.text();throw new Error(`Edge function error: ${r.status} - ${n}`)}let t=await r.json();if(!t.success||!t.dimensions)throw new Error("Edge function returned unsuccessful response");console.log(`[PTOUpload] Loaded ${t.dimensions.length} dimension mappings from edge function`);let a=new Map;for(let n of t.dimensions){let i=$e(n.raw_term),s=n.normalized_dimension;i&&s&&a.set(i,s)}return console.log(`[PTOUpload] Built ${a.size} unique mappings`),a.size===0?(console.log("[PTOUpload] No DB mappings found, using fallback mappings"),Qf()):a}catch(e){return console.error("[PTOUpload] Error loading dimension mappings:",e),console.log("[PTOUpload] Using fallback mappings due to error"),Qf()}}function Qf(){let e=new Map;return e.set($e("Company Name"),"Company_Name"),e.set($e("Form Name"),"Form_Name"),e.set($e("Selection Criteria"),"Selection_Criteria"),e.set($e("Employee Name"),"Employee_Name"),e.set($e("Employee"),"Employee_Name"),e.set($e("Name"),"Employee_Name"),e.set($e("Plan Description"),"Plan_Description"),e.set($e("Plan"),"Plan_Description"),e.set($e("Accrue Through Date"),"Accrue_Through_Date"),e.set($e("Accrue Thru Date"),"Accrue_Through_Date"),e.set($e("Year Ending"),"Year_Ending"),e.set($e("Year End"),"Year_Ending"),e.set($e("Accrual Rate"),"Accrual_Rate"),e.set($e("Rate"),"Accrual_Rate"),e.set($e("Carry Over"),"Carry_Over"),e.set($e("Carryover"),"Carry_Over"),e.set($e("Pay Period Accrued"),"Pay_Period_Accrued"),e.set($e("PP Accrued"),"Pay_Period_Accrued"),e.set($e("Period Accrued"),"Pay_Period_Accrued"),e.set($e("Pay Period Used"),"Pay_Period_Used"),e.set($e("PP Used"),"Pay_Period_Used"),e.set($e("Period Used"),"Pay_Period_Used"),e.set($e("YTD Accrued"),"YTD_Accrued"),e.set($e("Year To Date Accrued"),"YTD_Accrued"),e.set($e("YTD Used"),"YTD_Used"),e.set($e("Year To Date Used"),"YTD_Used"),e.set($e("Balance"),"Balance"),e.set($e("Current Balance"),"Balance"),e.set($e("Available Balance"),"Balance"),console.log(`[PTOUpload] Fallback mappings: ${e.size} entries`),e}function $e(e){return e?String(e).trim().toLowerCase().replace(/[_\-.]/g," ").replace(/\s+/g," "):""}async function Ki(){if(!Ot()){Ne("Excel is not available. Open this module inside Excel to run quality check.","info");return}ut.loading=!0,Ir(!0,"Analyzing data quality..."),Wr(document.getElementById("quality-save-btn"),!1);try{await Excel.run(async r=>{var g;let t=r.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(t.load("isNullObject"),await r.sync(),t.isNullObject)throw new Error("PTO_Data_Clean not found. Upload data in Step 1.");let a=t.getUsedRangeOrNullObject();a.load("values"),await r.sync();let n=a.isNullObject?[]:a.values||[];if(!n.length||n.length<2)throw new Error("PTO_Data_Clean is empty or has no data rows.");let i=(n[0]||[]).map(v=>Jn(v));console.log("[Data Quality] PTO data headers:",n[0]);let s=i.findIndex(v=>v==="employee name"||v==="employeename");s===-1&&(s=i.findIndex(v=>v.includes("employee")&&v.includes("name"))),s===-1&&(s=i.findIndex(v=>v==="name"||v.includes("name")&&!v.includes("company")&&!v.includes("form"))),console.log("[Data Quality] Employee name column index:",s,"Header:",(g=n[0])==null?void 0:g[s]);let o=Fr(i,["balance"]),c=Fr(i,["accrual rate","accrualrate"]),l=Fr(i,["carry over","carryover"]),f=Fr(i,["ytd accrued","ytdaccrued"]),d=Fr(i,["ytd used","ytdused"]),u=[],h=[],m=[],p=n.slice(1);p.forEach((v,y)=>{let x=y+2,F=s!==-1?String(v[s]||"").trim():`Row ${x}`;if(!F)return;let I=o!==-1&&Number(v[o])||0,A=c!==-1&&Number(v[c])||0,k=l!==-1&&Number(v[l])||0,N=f!==-1&&Number(v[f])||0,D=d!==-1&&Number(v[d])||0,M=k+N;I<0?u.push({name:F,issue:`Negative balance: ${I.toFixed(2)} hrs`,rowIndex:x}):D>M&&M>0&&u.push({name:F,issue:`Used ${D.toFixed(0)} hrs but only ${M.toFixed(0)} available`,rowIndex:x}),I===0&&(k>0||N>0)&&h.push({name:F,rowIndex:x}),A>8&&m.push({name:F,accrualRate:A,rowIndex:x})}),ut.balanceIssues=u,ut.zeroBalances=h,ut.accrualOutliers=m,ut.totalIssues=u.length,ut.totalEmployees=p.filter(v=>v.some(y=>y!==null&&y!=="")).length,ut.hasRun=!0});let e=ut.balanceIssues.length>0;Zn({stepStatuses:{3:e?"blocked":"complete"}})}catch(e){console.error("Data quality check error:",e),Ne(`Quality check failed: ${e.message}`,"error"),ut.hasRun=!1}finally{ut.loading=!1,Ir(!1),wt()}}function SE(){ut.acknowledged=!0,Zn({stepStatuses:{3:"complete"}}),wt()}async function bE(){if(Ot())try{await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.warn("[Completeness] PTO_Data_Clean not found");return}let t=e.workbook.worksheets.getItemOrNullObject("PTO_Analysis"),a=r.getUsedRangeOrNullObject();if(a.load("values"),t.load("isNullObject"),await e.sync(),t.isNullObject){Ia.completenessCheck={accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null};return}let n=t.getUsedRangeOrNullObject();n.load("values"),await e.sync();let i=a.isNullObject?[]:a.values||[],s=n.isNullObject?[]:n.values||[];if(!i.length||!s.length){Ia.completenessCheck={accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null};return}let o=(f,d,u)=>{let h=(f[0]||[]).map(g=>Jn(g)),m=Fr(h,d);return m===-1?null:f.slice(1).reduce((g,v)=>g+(Number(v[m])||0),0)},c=[{key:"accrualRate",aliases:["accrual rate","accrualrate"]},{key:"carryOver",aliases:["carry over","carryover","carry_over"]},{key:"ytdAccrued",aliases:["ytd accrued","ytdaccrued","ytd_accrued"]},{key:"ytdUsed",aliases:["ytd used","ytdused","ytd_used"]},{key:"balance",aliases:["balance"]}],l={};for(let f of c){let d=o(i,f.aliases,"PTO_Data_Clean"),u=o(s,f.aliases,"PTO_Analysis");if(d===null||u===null)l[f.key]=null;else{let h=Math.abs(d-u)<.01;l[f.key]={match:h,ptoDataClean:d,ptoAnalysis:u}}}Ia.completenessCheck=l})}catch(e){console.error("Completeness check failed:",e)}}async function eu(){if(!Ot()){Ne("Excel is not available. Open this module inside Excel to run analysis.","info");return}Ir(!0,"Running analysis...");try{await bE(),Ia.cleanDataReady=!0,wt()}catch(e){console.error("Full analysis error:",e),Ne(`Analysis failed: ${e.message}`,"error")}finally{Ir(!1)}}async function mu(){if(!Ot()){Ne("Excel is not available. Open this module inside Excel to run journal checks.","info");return}Ze.loading=!0,Ze.lastError=null,Wr(document.getElementById("je-save-btn"),!1),wt();try{let e=await Excel.run(async r=>{let a=r.workbook.worksheets.getItem("PTO_JE_Draft").getUsedRangeOrNullObject();a.load("values");let n=r.workbook.worksheets.getItemOrNullObject("PTO_Analysis");n.load("isNullObject"),await r.sync();let i=a.isNullObject?[]:a.values||[];if(!i.length)throw new Error("PTO_JE_Draft is empty. Generate the JE first.");let s=(i[0]||[]).map(v=>Jn(v)),o=Fr(s,["debits","debit"]),c=Fr(s,["credits","credit"]),l=Fr(s,["account name","accountname"]);if(o===-1||c===-1)throw new Error("Could not find Debits and Credits columns in PTO_JE_Draft.");let f=0,d=0,u=0;i.slice(1).forEach(v=>{let y=Number(v[o])||0,x=Number(v[c])||0,F=l!==-1?String(v[l]||"").trim().toLowerCase():"";f+=y,d+=x,F&&!F.includes("clearing")&&(u+=y-x)});let h=0;if(!n.isNullObject){let v=n.getUsedRangeOrNullObject();v.load("values"),await r.sync();let y=v.isNullObject?[]:v.values||[];if(y.length>1){let x=(y[0]||[]).map(I=>Jn(I)),F=Fr(x,["change"]);F!==-1&&y.slice(1).forEach(I=>{h+=Number(I[F])||0})}}let m=f-d,p=[];Math.abs(m)>=.01?p.push({check:"Debits = Credits",passed:!1,detail:m>0?`Debits exceed credits by $${Math.abs(m).toLocaleString(void 0,{minimumFractionDigits:2})}`:`Credits exceed debits by $${Math.abs(m).toLocaleString(void 0,{minimumFractionDigits:2})}`}):p.push({check:"Debits = Credits",passed:!0,detail:""}),p.push({check:"Line Amounts Sum to Zero",passed:Math.abs(m)<.01,detail:Math.abs(m)<.01?"":`Difference: $${m.toFixed(2)}`});let g=Math.abs(u-h);return g>=.01?p.push({check:"JE Matches Analysis Total",passed:!1,detail:`JE expense total ($${u.toLocaleString(void 0,{minimumFractionDigits:2})}) differs from PTO_Analysis Change total ($${h.toLocaleString(void 0,{minimumFractionDigits:2})}) by $${g.toLocaleString(void 0,{minimumFractionDigits:2})}`}):p.push({check:"JE Matches Analysis Total",passed:!0,detail:""}),{debitTotal:f,creditTotal:d,difference:m,jeChangeTotal:u,analysisChangeTotal:h,issues:p,validationRun:!0}});Object.assign(Ze,e,{lastError:null})}catch(e){console.warn("PTO JE summary:",e),Ze.lastError=(e==null?void 0:e.message)||"Unable to calculate journal totals.",Ze.debitTotal=null,Ze.creditTotal=null,Ze.difference=null,Ze.jeChangeTotal=null,Ze.analysisChangeTotal=null,Ze.issues=[],Ze.validationRun=!1}finally{Ze.loading=!1,wt()}}var gu="PTO_Liability_Change",Zi="pto-accrual";function qo(e){return String(e!=null?e:"").replace(/\u00a0/g," ").trim().toLowerCase().replace(/\s+/g," ").replace(/&/g,"and")}async function TE(e){console.log("[PTO-JE] Loading GL mappings for company:",e);try{let r=`${Ko}/rest/v1/ada_customer_gl_mappings?crm_company_id=eq.${e}&module=eq.${Zi}&pf_column_name=eq.${gu}&select=department,gl_account,gl_account_name`,t=await fetch(r,{headers:{apikey:rn,Authorization:`Bearer ${rn}`,"Content-Type":"application/json"}});if(!t.ok){let i=await t.text();throw new Error(`API error fetching GL mappings: ${t.status} - ${i}`)}let a=await t.json();console.log(`[PTO-JE] Fetched ${a.length} GL mapping rules`);let n=new Map;for(let i of a){let s=qo(i.department);s&&n.set(s,{gl_account:i.gl_account,gl_account_name:i.gl_account_name||""})}return console.log(`[PTO-JE] Built ${n.size} department -> GL mappings`),n}catch(r){throw console.error("[PTO-JE] Error loading GL mappings:",r),r}}async function CE(){let e=new Map;if(!Ot())throw new Error("Excel runtime not available");return await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");if(t.load("isNullObject"),await r.sync(),t.isNullObject)throw new Error("PTO_Review sheet not found. Run Step 2 (PTO Accrual Review) first.");let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)throw new Error("PTO_Review is empty. Run Step 2 first.");let n=a.values[0].map(o=>String(o||"").toLowerCase().trim()),i=n.findIndex(o=>o==="department"),s=n.findIndex(o=>o==="change");if(i<0||s<0)throw new Error(`Required columns not found in PTO_Review. Found: ${n.join(", ")}`);for(let o=1;o<a.values.length;o++){let c=a.values[o],l=String(c[i]||"").trim(),f=parseFloat(c[s])||0;if(!l||Math.abs(f)<.01)continue;let d=e.get(l)||0;e.set(l,d+f)}await r.sync()}),console.log("[PTO-JE] Department totals:",Object.fromEntries(e)),e}async function xu(e,r,t){let a,n,i,s;typeof e=="object"&&e!==null&&!Array.isArray(e)&&e.userPrompt!==void 0?{systemPrompt:a,userPrompt:n,contextPack:i,functionContext:s}=e:(n=e,i=r,s="analysis");let o="https://jgciqwzwacaesqjaoadc.supabase.co/functions/v1/copilot",c="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE",l=Re.crm_company_id;try{console.log("[Ada] Calling copilot API...",{module:Zi,function:s||"analysis",customerId:l?"set":"not set"});let f=await fetch(o,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`,apikey:c},body:JSON.stringify({prompt:n,context:i,module:Zi,function:s||"analysis",customerId:l,...a?{systemPrompt:a}:{}})});if(!f.ok){let u=await f.text();throw console.error("[Ada] API error:",f.status,u),new Error(`API request failed: ${f.status}`)}let d=await f.json();return console.log("[Ada] API response received:",d.usage||"no usage info"),d.message||d.response?d.message||d.response:(console.warn("[Ada] No message in API response, using local generation"),tu(params))}catch(f){return console.warn("[Ada] API call failed, using local generation:",f),tu(params)}}function tu(e){var n,i,s,o,c,l,f,d,u,h,m;let{userPrompt:r,contextPack:t}=e,a=(r||"").toLowerCase();return a.includes("diagnostic")||a.includes("check")?`**PTO Data Diagnostics:**

\u2713 **Data Completeness**: PTO file uploaded and processed successfully
\u2713 **Header Mapping**: All required columns identified and mapped
\u2713 **Rate Engine**: Pay rate calculations completed
\u2713 **Balance Calculations**: PTO balances computed for all employees

\u26A0\uFE0F **Potential Issues**:
\u2022 ${((n=t==null?void 0:t.summary)==null?void 0:n.missingRateCount)||0} employees missing pay rates
\u2022 Balance validation may be needed for large changes

**Next Steps:**
1. Review any missing pay rate warnings
2. Generate the accrual review table
3. Proceed to journal entry preparation`:a.includes("insight")||a.includes("analysis")?`**PTO Accrual Analysis:**

\u{1F4CA} **Key Metrics:**
\u2022 Total Current Liability: $${(((i=t==null?void 0:t.summary)==null?void 0:i.totalCurrent)||0).toLocaleString()}
\u2022 Total Prior Liability: $${(((s=t==null?void 0:t.summary)==null?void 0:s.totalPrior)||0).toLocaleString()}
\u2022 Net Change: $${(((o=t==null?void 0:t.summary)==null?void 0:o.netChange)||0).toLocaleString()}
\u2022 Active Employees: ${((c=t==null?void 0:t.summary)==null?void 0:c.employeeCount)||0}

\u{1F4A1} **Executive Insights:**
1. **Liability Trend**: ${(((l=t==null?void 0:t.summary)==null?void 0:l.netChange)||0)>=0?"Increasing":"Decreasing"} PTO liability
2. **Employee Coverage**: ${((f=t==null?void 0:t.summary)==null?void 0:f.employeeCount)||0} employees with PTO tracking
3. **Pay Rate Completeness**: ${(((d=t==null?void 0:t.summary)==null?void 0:d.missingRateCount)||0)===0?"Complete":"Missing rates for some employees"}

**Recommendations:**
\u2022 Review any employees with missing pay rates
\u2022 Monitor PTO liability trends quarter-over-quarter
\u2022 Ensure accurate employee headcount for future accruals`:`**PTO Analysis Assistant**

I can help you analyze your PTO accrual data. Try asking me about:

\u2022 **Diagnostics** - Check data quality and completeness
\u2022 **Insights** - Key findings and trends
\u2022 **Balances** - Employee PTO balance analysis
\u2022 **Accruals** - Liability calculation details

Your PTO data includes:
- ${((u=t==null?void 0:t.summary)==null?void 0:u.employeeCount)||0} employees
- Current liability: $${(((h=t==null?void 0:t.summary)==null?void 0:h.totalCurrent)||0).toLocaleString()}
- Net change: $${(((m=t==null?void 0:t.summary)==null?void 0:m.netChange)||0).toLocaleString()}

What would you like to explore?`}async function AE(){if(!Ot()){Ne("Excel is not available. Open this module inside Excel to create the journal entry.","info");return}Ir(!0,"Creating PTO Journal Entry...");try{let e=Re.crm_company_id;if(!e)throw new Error("Company ID not found. Please check your installation configuration.");let r=At(we.journalEntryId)||"",t=At(we.payrollDate)||"";if(console.log(`
\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550`),console.log("PTO JOURNAL ENTRY GENERATION (QuickBooks Format)"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log(`  Company ID: ${e}`),console.log(`  JournalNo (PTO_Journal_Entry_ID): ${r}`),console.log(`  JournalDate (PTO_Payroll_Date): ${t}`),!r)throw new Error("Journal Entry ID not set. Please enter a Journal Entry ID in the Configuration step.");if(!t)throw new Error("Payroll Date not set. Please enter a Payroll Date in the Configuration step.");let a=t;try{let p;if(typeof t=="number"||/^\d{4,5}$/.test(String(t).trim())){let g=Number(t),v=new Date(1899,11,30);p=new Date(v.getTime()+g*24*60*60*1e3)}else p=new Date(t);if(!isNaN(p.getTime())&&p.getFullYear()>1970){let g=String(p.getMonth()+1).padStart(2,"0"),v=String(p.getDate()).padStart(2,"0"),y=p.getFullYear();a=`${g}/${v}/${y}`}}catch{console.warn("[PTO-JE] Could not parse date, using as-is:",t)}let n=await TE(e);if(console.log(`  GL Mappings loaded: ${n.size}`),n.size===0)throw new Error(`No GL mappings found for PTO_Liability_Change.

Please configure GL mappings in ada_customer_gl_mappings:
  - company_id: ${e}
  - module: ${Zi}
  - pf_column_name: ${gu}
  - department: (your department names)
  - gl_account: (expense account numbers)`);let i=await CE();if(console.log(`  Departments with changes: ${i.size}`),i.size===0)throw new Error(`No department totals found with non-zero changes.

Please run Step 2 (PTO Accrual Review) first to generate change data.`);let s=[];for(let[p]of i){let g=qo(p);n.has(g)||s.push(p)}if(s.length>0)throw new Error(`Missing GL mappings for departments:
`+s.map(p=>`  \u2022 ${p}`).join(`
`)+`

Please add GL mappings for these departments in ada_customer_gl_mappings.`);let o=new Map;await Excel.run(async p=>{try{let g=p.workbook.worksheets.getItemOrNullObject("SS_Chart_of_Accounts");if(g.load("isNullObject"),await p.sync(),!g.isNullObject){let v=g.getUsedRangeOrNullObject();if(v.load("isNullObject"),await p.sync(),!v.isNullObject&&(v.load("values"),await p.sync(),v.values&&v.values.length>1)){let y=v.values[0],x=v.values.slice(1),F=y.findIndex(A=>{let k=String(A||"").toLowerCase().trim().replace(/[^a-z0-9]/g,"_");return k.includes("account")&&k.includes("num")||k==="account_number"||k==="number"}),I=y.findIndex(A=>{let k=String(A||"").toLowerCase().trim().replace(/[^a-z0-9]/g,"_");return k.includes("account")&&k.includes("name")||k==="account_name"||k==="name"});if(F>=0&&I>=0){for(let A of x){let k=String(A[F]||"").trim(),N=String(A[I]||"").trim();k&&o.set(k,N)}console.log(`  Chart of Accounts: ${o.size} accounts loaded`)}}}}catch(g){console.warn("[PTO-JE] Error reading SS_Chart_of_Accounts (non-fatal):",g.message)}});let c=["JournalNo","JournalDate","Account Name","Debits","Credits","Description"],l=[],f=0,d=0;for(let[p,g]of i){if(Math.abs(g)<.01)continue;let v=qo(p),y=n.get(v),x=String(y.gl_account||"").trim(),F,I=o.get(x);I?F=`${x} ${I}`:y.gl_account_name?F=`${x} ${y.gl_account_name}`:F=x;let A=Math.abs(g),k=`${p}${p?" - ":""}PTO Liability Change`;g>0?(f+=A,l.push([r,a,F,A,"",k])):(d+=A,l.push([r,a,F,"",A,k]))}let u="21540 Accrued Expenses:Accrued PTO Liability",h=f-d;if(Math.abs(h)>=.01&&(h>0?(l.push([r,a,u,"",h,"Accrued PTO Liability"]),d+=h):(l.push([r,a,u,Math.abs(h),"","Accrued PTO Liability"]),f+=Math.abs(h))),Math.abs(f-d)>.01)throw new Error(`JE is out of balance!
  Total Debits: ${f.toFixed(2)}
  Total Credits: ${d.toFixed(2)}
  Difference: ${(f-d).toFixed(2)}

Cannot write unbalanced journal entry.`);console.log(`  JE Lines: ${l.length}`),console.log(`  Total Debits: $${f.toFixed(2)}`),console.log(`  Total Credits: $${d.toFixed(2)}`),console.log(`\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550
`),await Excel.run(async p=>{let g=p.workbook.worksheets.getItemOrNullObject("PTO_JE_Draft");if(g.load("isNullObject"),await p.sync(),g.isNullObject)g=p.workbook.worksheets.add("PTO_JE_Draft"),console.log("[PTO-JE] Created PTO_JE_Draft sheet");else{g.visibility=Excel.SheetVisibility.visible;let I=g.getUsedRangeOrNullObject();await p.sync(),I.isNullObject||I.clear(),console.log("[PTO-JE] Cleared existing PTO_JE_Draft")}let v=[c,...l],y=g.getRangeByIndexes(0,0,v.length,c.length);y.values=v;let x=g.getRangeByIndexes(0,0,1,c.length);Xn(x);let F=l.length;if(F>0){let I="$#,##0.00";g.getRangeByIndexes(1,3,F,1).numberFormat=[[I]],g.getRangeByIndexes(1,4,F,1).numberFormat=[[I]]}y.format.autofitColumns(),g.freezePanes.freezeRows(1),g.activate(),await p.sync()}),Ze.debitTotal=f,Ze.creditTotal=d,Ze.validationRun=!0,Ze.lastError=null,await mu(),Ne(`Journal Entry created: ${l.length} lines (including offset), $${f.toFixed(2)} balanced \u2713`,"success"),wt()}catch(e){console.error("[PTO-JE] Error:",e),Ze.lastError=e.message,Ne(`Unable to create Journal Entry: ${e.message}`,"error")}finally{Ir(!1)}}async function OE(){if(!Ot()){Ne("Excel is not available. Open this module inside Excel to export.","info");return}Ir(!0,"Preparing JE CSV...");try{let{rows:e}=await Excel.run(async o=>{let l=o.workbook.worksheets.getItem("PTO_JE_Draft").getUsedRangeOrNullObject();l.load("values"),await o.sync();let f=l.isNullObject?[]:l.values||[];if(!f.length)throw new Error("PTO_JE_Draft is empty.");return{rows:f}}),r=(e[0]||[]).map(o=>String(o||"").trim().toLowerCase()),t=r.findIndex(o=>o.includes("debit")),a=r.findIndex(o=>o.includes("credit")),n=r.findIndex(o=>o.includes("journaldate")||o.includes("txndate")||o==="date"),i=e.map((o,c)=>{if(c===0)return o;let l=[...o||[]],f=u=>{if(u===null||u==="")return"";let h=Number(u);return Number.isFinite(h)?h.toFixed(2):""},d=u=>{if(u===null||u==="")return"";if(typeof u=="string"&&/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(u.trim()))return u.trim();if(typeof u=="number"&&Number.isFinite(u)){let h=Math.round((u-25569)*86400*1e3),m=new Date(h);if(Number.isFinite(m.getTime())){let p=String(m.getMonth()+1).padStart(2,"0"),g=String(m.getDate()).padStart(2,"0"),v=m.getFullYear();if(v>=1900&&v<=2100)return`${p}/${g}/${v}`}}if(u instanceof Date&&Number.isFinite(u.getTime())){let h=String(u.getMonth()+1).padStart(2,"0"),m=String(u.getDate()).padStart(2,"0"),p=u.getFullYear();return`${h}/${m}/${p}`}return String(u)};return t>=0&&(l[t]=f(l[t])),a>=0&&(l[a]=f(l[a])),n>=0&&(l[n]=d(l[n])),l}),s=KE(i);JE(`pto-je-draft-${Zo()}.csv`,s)}catch(e){console.error("PTO JE export:",e),Ne("Unable to export the JE draft. Confirm the sheet has data.","error")}finally{Ir(!1)}}async function vu(){let e=At(we.accountingSoftware)||At("SS_Accounting_Software");if(!e&&xt())try{let r=await ti(ca);e=r.SS_Accounting_Software||r.Accounting_Software||r[we.accountingSoftware]}catch(r){console.warn("Error reading accounting software URL:",r)}if(!e){Ne("No accounting software URL configured. Add SS_Accounting_Software to SS_PF_Config.","info",5e3);return}!e.startsWith("http://")&&!e.startsWith("https://")&&(e="https://"+e),window.open(e,"_blank"),Ne("Opening accounting software...","success",2e3)}function yu(e,r={}){return new Promise(t=>{let{title:a="Confirm",confirmText:n="Confirm",cancelText:i="Cancel",icon:s="\u{1F4E6}"}=r;document.querySelectorAll(".pf-confirm-dialog").forEach(c=>c.remove());let o=document.createElement("div");if(o.className="pf-confirm-dialog",o.innerHTML=`
            <div class="pf-confirm-backdrop"></div>
            <div class="pf-confirm-content">
                <div class="pf-confirm-icon">${s}</div>
                <div class="pf-confirm-title">${Se(a)}</div>
                <div class="pf-confirm-message">${Se(e).replace(/\n/g,"<br>")}</div>
                <div class="pf-confirm-buttons">
                    <button type="button" class="pf-confirm-btn pf-confirm-btn--cancel">${Se(i)}</button>
                    <button type="button" class="pf-confirm-btn pf-confirm-btn--confirm">${Se(n)}</button>
                </div>
            </div>
        `,!document.getElementById("pf-confirm-dialog-styles")){let c=document.createElement("style");c.id="pf-confirm-dialog-styles",c.textContent=`
                .pf-confirm-dialog { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 10001; display: flex; align-items: center; justify-content: center; }
                .pf-confirm-backdrop { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); }
                .pf-confirm-content { position: relative; background: linear-gradient(145deg, rgba(30, 30, 50, 1), rgba(20, 20, 35, 1)); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 16px; padding: 24px; max-width: 320px; text-align: center; box-shadow: 0 24px 64px rgba(0,0,0,0.5); }
                .pf-confirm-icon { font-size: 40px; margin-bottom: 12px; }
                .pf-confirm-title { font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 12px; }
                .pf-confirm-message { font-size: 13px; color: rgba(255,255,255,0.7); line-height: 1.5; margin-bottom: 20px; text-align: left; }
                .pf-confirm-buttons { display: flex; gap: 12px; justify-content: center; }
                .pf-confirm-btn { padding: 10px 20px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; border: none; transition: all 0.2s; }
                .pf-confirm-btn--cancel { background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); }
                .pf-confirm-btn--cancel:hover { background: rgba(255,255,255,0.15); }
                .pf-confirm-btn--confirm { background: linear-gradient(145deg, #6366f1, #4f46e5); color: white; }
                .pf-confirm-btn--confirm:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4); }
            `,document.head.appendChild(c)}document.body.appendChild(o),o.querySelector(".pf-confirm-btn--cancel").addEventListener("click",()=>{o.remove(),t(!1)}),o.querySelector(".pf-confirm-btn--confirm").addEventListener("click",()=>{o.remove(),t(!0)}),o.querySelector(".pf-confirm-backdrop").addEventListener("click",()=>{o.remove(),t(!1)})})}async function FE(){if(console.log("[Archive] archiveAndReset called"),!xt()){Ne("Excel not available currently","error");return}if(!await yu(`This will:

\u2022 Download an Excel archive file
\u2022 Update PTO_Archive_Summary
\u2022 Clear working data from all sheets
\u2022 Reset non-permanent notes & config

Make sure you've completed all review steps.`,{title:"Archive PTO Run",icon:"\u{1F4E6}",confirmText:"Archive Now",cancelText:"Not Yet"})){console.log("[PTOArchive] User cancelled"),Ne("Archive cancelled","info",2e3);return}console.log("[PTOArchive] User confirmed, starting archive process..."),Ir(!0,"Archiving PTO data...");try{if(console.log("[PTOArchive] Step 1: Creating archive workbook..."),!await IE()){console.log("[PTOArchive] Archive file creation failed");return}console.log("[PTOArchive] Step 1 complete: Archive file downloaded"),console.log("[PTOArchive] Step 2: Updating PTO_Archive_Summary...");let t=Xe.reviewData;if((!t||t.length===0)&&(t=await PE()),t&&t.length>0){let a=At(we.payrollDate)||new Date().toISOString().substring(0,10),n=await oE(t,a);console.log("[PTOArchive] Archive summary result:",n)}else console.warn("[PTOArchive] No review data to archive");console.log("[PTOArchive] Step 2 complete: Archive summary updated"),console.log("[PTOArchive] Step 3: Clearing working data..."),await RE(),console.log("[PTOArchive] Step 3 complete: Working data cleared"),console.log("[PTOArchive] Step 4: Clearing non-permanent config..."),await DE(),console.log("[PTOArchive] Step 4 complete: Config reset"),console.log("[PTOArchive] Archive workflow complete!"),Xe.loaded=!1,Xe.reviewData=[],Xe.totalCurrentLiability=0,Xe.totalPriorLiability=0,Xe.netChange=0,Xe.employeeCount=0,Vt.loaded=!1,Vt.rates.clear(),Ze.validationRun=!1,Ze.debitTotal=null,Ze.creditTotal=null,await fu(),wt(),NE()}catch(r){console.error("[PTOArchive] Error during archive:",r),Ne("Archive Error: "+r.message,"error",1e4)}finally{Ir(!1)}}async function IE(){try{let e=At(we.payrollDate)||new Date().toISOString().split("T")[0],r=At(we.accountingPeriod)||"",t=At(we.journalEntryId)||"",a=`PTO_Archive_${e}.xlsx`;return console.log("[PTOArchive] Creating Excel archive file..."),await Excel.run(async n=>{let s=n.workbook.worksheets;s.load("items/name"),await n.sync();let o=["PTO_JE_Draft","PTO_Review","PTO_Data_Clean"],c=Vr.book_new(),l=0,f=[];f.push(["PTO Accrual Archive Summary"]),f.push([]),f.push(["Archived At",new Date().toISOString()]),f.push(["Analysis Date",e]),f.push(["Accounting Period",r]),f.push(["Journal Entry ID",t]),f.push(["Company",Re.ss_company_name||""]),f.push([]),f.push(["--- Liability Summary ---"]),f.push(["Current Period Liability",Xe.totalCurrentLiability||0]),f.push(["Prior Period Liability",Xe.totalPriorLiability||0]),f.push(["Net Change (JE Amount)",Xe.netChange||0]),f.push(["Employee Count",Xe.employeeCount||0]),f.push([]),f.push(["--- Step Sign-offs ---"]);let d=Gr(0);f.push(["Config Reviewer",(d==null?void 0:d.reviewer)||""]),f.push(["Config Sign-off",(d==null?void 0:d.signOffDate)||""]),f.push(["Config Notes",(d==null?void 0:d.notes)||""]),f.push([]);let u=Gr(1);f.push(["Import Reviewer",(u==null?void 0:u.reviewer)||""]),f.push(["Import Sign-off",(u==null?void 0:u.signOffDate)||""]),f.push(["Import Notes",(u==null?void 0:u.notes)||""]),f.push([]);let h=Gr(2);f.push(["Review Reviewer",(h==null?void 0:h.reviewer)||""]),f.push(["Review Sign-off",(h==null?void 0:h.signOffDate)||""]),f.push(["Review Notes",(h==null?void 0:h.notes)||""]),f.push([]);let m=Gr(3);f.push(["JE Reviewer",(m==null?void 0:m.reviewer)||""]),f.push(["JE Sign-off",(m==null?void 0:m.signOffDate)||""]),f.push(["JE Notes",(m==null?void 0:m.notes)||""]),f.push([]),f.push(["--- Archive Metadata ---"]),f.push(["Generated By","PTO Accrual Module"]),f.push(["Archive File",a]);let p=Vr.aoa_to_sheet(f);Xi(p,[ia.extraWide,ia.description]),Vr.book_append_sheet(c,p,"Archive_Summary"),l++;for(let F of o){let I=s.items.find(k=>k.name===F);if(!I){console.log(`[PTOArchive] Sheet not found: ${F}`);continue}let A=I.getUsedRangeOrNullObject();if(A.load("values"),await n.sync(),!A.isNullObject&&A.values&&A.values.length>0){let k=Vr.aoa_to_sheet(A.values);if(A.values.length>0){let N=A.values[0],D=A.values.length;zf(k,N,D,{autoFormat:!0,autoSize:!0})}Vr.book_append_sheet(c,k,F),l++,console.log(`[PTOArchive] Added sheet: ${F} (${A.values.length} rows)`)}else console.log(`[PTOArchive] Sheet empty: ${F}`)}if(l<=1)return console.warn("[PTOArchive] No data sheets to archive"),Ne("No data to archive. Complete the PTO review first.","warning"),!1;let g=Io(c,{bookType:"xlsx",type:"array"}),v=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=URL.createObjectURL(v),x=document.createElement("a");return x.setAttribute("href",y),x.setAttribute("download",a),x.style.visibility="hidden",document.body.appendChild(x),x.click(),document.body.removeChild(x),setTimeout(()=>URL.revokeObjectURL(y),100),console.log(`[PTOArchive] Downloaded: ${a} with ${l} sheets`),Ne(`\u{1F4E5} Archive downloaded: ${a} (${l} sheets)`,"success",5e3),!0})}catch(e){return console.error("[PTOArchive] Error creating archive:",e),Ne("Archive Export Error: "+e.message,"error",8e3),await yu(`Archive download failed.

Do you want to continue with clearing the data?

Make sure you have saved a backup first!`,{title:"Continue Without Archive?",icon:"\u26A0\uFE0F",confirmText:"Continue Anyway",cancelText:"Cancel"})}}async function PE(){let e=[];try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");if(t.load("isNullObject"),await r.sync(),t.isNullObject)return;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)return;let n=a.values[0].map(s=>String(s||"").toLowerCase().trim()),i={employeeName:n.findIndex(s=>s.includes("employee")),department:n.findIndex(s=>s==="department"),payRate:n.findIndex(s=>s.includes("pay")&&s.includes("rate")),accrualRate:n.findIndex(s=>s.includes("accrual")&&s.includes("rate")),carryOver:n.findIndex(s=>s.includes("carry")),ytdAccrued:n.findIndex(s=>s.includes("ytd")&&s.includes("accrued")),ytdUsed:n.findIndex(s=>s.includes("ytd")&&s.includes("used")),balance:n.findIndex(s=>s==="balance"),liabilityAmount:n.findIndex(s=>s.includes("liability")),priorLiability:n.findIndex(s=>s.includes("prior")),change:n.findIndex(s=>s==="change")};for(let s=1;s<a.values.length;s++){let o=a.values[s];e.push({employeeName:i.employeeName>=0?String(o[i.employeeName]||""):"",department:i.department>=0?String(o[i.department]||""):"",payRate:i.payRate>=0&&parseFloat(o[i.payRate])||0,accrualRate:i.accrualRate>=0&&parseFloat(o[i.accrualRate])||0,carryOver:i.carryOver>=0&&parseFloat(o[i.carryOver])||0,ytdAccrued:i.ytdAccrued>=0&&parseFloat(o[i.ytdAccrued])||0,ytdUsed:i.ytdUsed>=0&&parseFloat(o[i.ytdUsed])||0,balance:i.balance>=0&&parseFloat(o[i.balance])||0,liabilityAmount:i.liabilityAmount>=0&&parseFloat(o[i.liabilityAmount])||0})}await r.sync()})}catch(r){console.error("[PTOArchive] Error reading PTO_Review:",r)}return e}async function RE(){let e=["PTO_Data_Clean","PTO_Review","PTO_JE_Draft"];await Excel.run(async r=>{for(let t of e){let a=r.workbook.worksheets.getItemOrNullObject(t);if(a.load("isNullObject"),await r.sync(),a.isNullObject){console.log(`[PTOArchive] Sheet not found: ${t}`);continue}let n=a.getUsedRangeOrNullObject();if(n.load("rowCount,columnCount,address"),await r.sync(),n.isNullObject||n.rowCount<=1){console.log(`[PTOArchive] Sheet empty or headers only: ${t}`);continue}a.getRange(`A2:${String.fromCharCode(64+Math.min(n.columnCount,26))}${n.rowCount}`).clear(Excel.ClearApplyTo.contents),await r.sync(),console.log(`[PTOArchive] Cleared data from: ${t}`)}})}async function DE(){await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("SS_PF_Config");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.warn("[PTOArchive] SS_PF_Config sheet not found");return}let t=r.getUsedRangeOrNullObject();if(t.load("values,rowCount,columnCount"),await e.sync(),t.isNullObject||!t.values||t.values.length<2)return;let a=t.values[0].map(f=>String(f||"").toLowerCase().trim()),n=a.findIndex(f=>f==="field"||f==="setting"||f==="key"),i=a.findIndex(f=>f==="value"),s=a.findIndex(f=>f==="permanent"||f==="persist");if(n<0||i<0){console.warn("[PTOArchive] Could not find field/value columns in config");return}let o=[we.payrollDate,we.accountingPeriod,we.journalEntryId],c=t.values.map((f,d)=>{if(d===0)return f;let u=String(f[n]||"").trim(),h=s>=0&&String(f[s]||"").toUpperCase()==="Y";if(o.includes(u)&&!h){let m=[...f];return m[i]="",m}return f}),l=r.getRangeByIndexes(0,0,c.length,a.length);l.values=c,await e.sync(),console.log("[PTOArchive] Non-permanent config values cleared")})}function NE(){document.querySelectorAll(".pf-save-prompt").forEach(t=>t.remove());let e=document.createElement("div");if(e.className="pf-save-prompt",e.innerHTML=`
        <div class="pf-save-prompt-content">
            <div class="pf-save-prompt-title">Good work!</div>
            <div class="pf-save-prompt-subtitle">Ready to finalize?</div>
            <button type="button" class="pf-save-prompt-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
                Finalize
            </button>
        </div>
    `,!document.getElementById("pf-save-prompt-styles")){let t=document.createElement("style");t.id="pf-save-prompt-styles",t.textContent=`
            .pf-save-prompt {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(145deg, rgba(30, 30, 50, 0.98), rgba(20, 20, 35, 0.99));
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 32px 40px;
                border-radius: 20px;
                box-shadow: 
                    0 24px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 60px rgba(99, 102, 241, 0.1);
                z-index: 10002;
                text-align: center;
                animation: pf-prompt-fade-in 0.3s ease;
            }
            @keyframes pf-prompt-fade-in {
                from { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
                to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            }
            .pf-save-prompt-content {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            .pf-save-prompt-title {
                font-size: 20px;
                font-weight: 700;
                color: #fff;
            }
            .pf-save-prompt-subtitle {
                font-size: 14px;
                color: rgba(255, 255, 255, 0.6);
                margin-bottom: 12px;
            }
            .pf-save-prompt-btn {
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border: none;
                color: white;
                padding: 16px 40px;
                border-radius: 12px;
                font-size: 18px;
                font-weight: 700;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
                transition: all 0.2s ease;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4), 0 0 0 2px rgba(99, 102, 241, 0.2);
                margin-top: 8px;
            }
            .pf-save-prompt-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 12px 32px rgba(99, 102, 241, 0.5), 0 0 0 2px rgba(99, 102, 241, 0.3);
                background: linear-gradient(145deg, #7c3aed, #6366f1);
            }
            .pf-save-prompt-btn:active {
                transform: translateY(-1px);
            }
            .pf-save-prompt.closing {
                animation: pf-prompt-fade-out 0.2s ease forwards;
            }
            @keyframes pf-prompt-fade-out {
                to { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
            }
        `,document.head.appendChild(t)}document.body.appendChild(e),e.querySelector(".pf-save-prompt-btn").addEventListener("click",()=>{e.classList.add("closing"),setTimeout(()=>{e.remove(),LE()},200)})}function LE(){document.querySelectorAll(".pf-toast, .pf-success-toast").forEach(n=>n.remove());let e=[{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"/></svg>',title:"Done.",subtitle:"Efficiency unlocked."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"/><path d="m9 12 2 2 4-4"/></svg>',title:"Locked in.",subtitle:"You're good to go."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><path d="M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z"/><path d="M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z"/></svg>',title:"Stored.",subtitle:"Everything stays aligned."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>',title:"PTO archived.",subtitle:"Flow restored."}],r=e[Math.floor(Math.random()*e.length)],t=document.createElement("div");if(t.className="pf-success-toast",t.innerHTML=`
        <div class="pf-success-toast-icon">${r.icon}</div>
        <div class="pf-success-toast-text">
            <div class="pf-success-toast-title">${r.title}</div>
            <div class="pf-success-toast-subtitle">${r.subtitle}</div>
        </div>
        <div class="pf-success-toast-progress"></div>
    `,!document.getElementById("pf-success-toast-styles")){let n=document.createElement("style");n.id="pf-success-toast-styles",n.textContent=`
            .pf-success-toast {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(145deg, rgba(30, 30, 50, 0.98), rgba(20, 20, 35, 0.99));
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 36px 48px 24px;
                border-radius: 24px;
                box-shadow: 
                    0 32px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 80px rgba(99, 102, 241, 0.15);
                z-index: 10002;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 16px;
                animation: pf-success-in 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                overflow: hidden;
                text-align: center;
                min-width: 220px;
            }
            @keyframes pf-success-in {
                from { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.9);
                }
                to { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
            }
            @keyframes pf-success-out {
                from { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
                to { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.95) translateY(-20px);
                }
            }
            .pf-success-toast-icon {
                width: 64px;
                height: 64px;
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border-radius: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
                animation: pf-icon-pulse 2s ease-in-out infinite;
            }
            @keyframes pf-icon-pulse {
                0%, 100% { box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4); }
                50% { box-shadow: 0 8px 32px rgba(99, 102, 241, 0.6); }
            }
            .pf-success-toast-text {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
            }
            .pf-success-toast-title {
                font-size: 22px;
                font-weight: 700;
                color: #fff;
                letter-spacing: -0.5px;
            }
            .pf-success-toast-subtitle {
                font-size: 15px;
                color: rgba(255, 255, 255, 0.6);
                font-weight: 500;
            }
            .pf-success-toast-progress {
                position: absolute;
                bottom: 0;
                left: 0;
                height: 4px;
                background: linear-gradient(90deg, #6366f1, #a855f7, #6366f1);
                background-size: 200% 100%;
                animation: pf-progress-shrink 5s linear forwards, pf-progress-shimmer 1s linear infinite;
                border-radius: 0 0 24px 24px;
            }
            @keyframes pf-progress-shrink {
                from { width: 100%; }
                to { width: 0%; }
            }
            @keyframes pf-progress-shimmer {
                from { background-position: 200% 0; }
                to { background-position: -200% 0; }
            }
            .pf-success-toast.closing {
                animation: pf-success-out 0.3s ease forwards;
            }
            .pf-success-backdrop {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.4);
                backdrop-filter: blur(4px);
                -webkit-backdrop-filter: blur(4px);
                z-index: 10001;
                animation: pf-confirm-fade-in 0.2s ease;
            }
        `,document.head.appendChild(n)}let a=document.createElement("div");a.className="pf-success-backdrop",document.body.appendChild(a),document.body.appendChild(t),setTimeout(()=>{t.classList.add("closing"),a.style.opacity="0",a.style.transition="opacity 0.3s ease",setTimeout(()=>{t.remove(),a.remove(),BE()},300)},5e3)}async function BE(){try{await ri("module-selector")}catch(e){console.warn("[PTO] Could not apply module-selector tab visibility before redirect:",e)}window.location.href="../module-selector/index.html"}async function ME(e){if(!(!e||!Ot()))try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItem(e);t.activate(),t.getRange("A1").select(),await r.sync()})}catch(r){console.error(r)}}function At(e){var t,a;let r=String(e!=null?e:"").trim();return(a=(t=Ce.values)==null?void 0:t[r])!=null?a:""}function Qn(e){var t;if(e)return e;let r=At(we.reviewerName);if(r)return r;if((t=window.PrairieForge)!=null&&t._sharedConfigCache){let a=window.PrairieForge._sharedConfigCache.get("SS_Default_Reviewer")||window.PrairieForge._sharedConfigCache.get("Default_Reviewer");if(a)return a}return""}function Or(e,r,t={}){var s;let a=String(e!=null?e:"").trim();if(!a)return;Ce.values[a]=r!=null?r:"";let n=(s=t.debounceMs)!=null?s:0;if(!n){let o=tn.get(a);o&&clearTimeout(o),tn.delete(a),fn(a,r!=null?r:"",ca);return}tn.has(a)&&clearTimeout(tn.get(a));let i=setTimeout(()=>{tn.delete(a),fn(a,r!=null?r:"",ca)},n);tn.set(a,i)}function Jn(e){return String(e!=null?e:"").trim().toLowerCase()}function Ir(e,r="Working..."){let t=document.getElementById(kk);t&&(t.style.display="none")}function zo(){Ak()}typeof Office!="undefined"&&Office.onReady?Office.onReady(()=>zo()).catch(()=>zo()):zo();function Gr(e){return Ce.steps[e]||{notes:"",reviewer:"",signOffDate:""}}function wu(e){return Qi[e]||{}}function $E(e){return e===0?"config":e===1?"upload":e===2?"review":e===3?"journal":e===4?"archive":""}async function dr(e,r,t){let a=Ce.steps[e]||{notes:"",reviewer:"",signOffDate:""};a[r]=t,Ce.steps[e]=a;let n=wu(e),i=r==="notes"?n.note:r==="reviewer"?n.reviewer:n.signOff;if(i&&xt())try{await fn(i,t,ca)}catch(s){console.warn("PTO: unable to save field",i,s)}}async function _u(e,r){Ce.permanents[e]=r;let t=wu(e);if(t!=null&&t.note&&xt())try{await Excel.run(async a=>{var u;let n=a.workbook.tables.getItemOrNullObject(ca[0]);if(await a.sync(),n.isNullObject)return;let i=n.getDataBodyRange(),s=n.getHeaderRowRange();i.load("values"),s.load("values"),await a.sync();let o=s.values[0]||[],c=o.map(h=>String(h||"").trim().toLowerCase()),l={field:c.findIndex(h=>h==="field"||h==="field name"||h==="setting"),permanent:c.findIndex(h=>h==="permanent"||h==="persist"),value:c.findIndex(h=>h==="value"||h==="setting value"),type:c.findIndex(h=>h==="type"||h==="category"),title:c.findIndex(h=>h==="title"||h==="display name")};if(l.field===-1)return;let d=(i.values||[]).findIndex(h=>String(h[l.field]||"").trim()===t.note);if(d>=0)l.permanent>=0&&(i.getCell(d,l.permanent).values=[[r?"Y":"N"]]);else{let h=new Array(o.length).fill("");l.type>=0&&(h[l.type]="Other"),l.title>=0&&(h[l.title]=""),h[l.field]=t.note,l.permanent>=0&&(h[l.permanent]=r?"Y":"N"),l.value>=0&&(h[l.value]=((u=Ce.steps[e])==null?void 0:u.notes)||""),n.rows.add(null,[h])}await a.sync()})}catch(a){console.warn("PTO: unable to update permanent flag",a)}}async function ku(e,r){let t=lu[e];if(t&&(Ce.completes[e]=r?"Y":"",!!xt()))try{await fn(t,r?"Y":"",ca)}catch(a){console.warn("PTO: unable to save completion flag",t,a)}}function ru(e,r){e&&(e.classList.toggle("is-active",r),e.setAttribute("aria-pressed",String(r)))}function UE(){let e={};return Object.keys(Qi).forEach(r=>{var i;let t=parseInt(r,10),a=!!((i=Ce.steps[t])!=null&&i.signOffDate),n=!!Ce.completes[t];e[t]=a||n}),e}function Eu(e,{buttonId:r,inputId:t,canActivate:a=null,onComplete:n=null}){var c;let i=document.getElementById(r);if(!i)return;let s=document.getElementById(t),o=!!((c=Ce.steps[e])!=null&&c.signOffDate)||!!Ce.completes[e];ru(i,o),i.addEventListener("click",()=>{if(!i.classList.contains("is-active")&&e>0){let d=UE(),{canComplete:u,message:h}=Vf(e,d);if(!u){Wf(h);return}}if(typeof a=="function"&&!a())return;let f=!i.classList.contains("is-active");ru(i,f),s&&(s.value=f?Zo():"",dr(e,"signOffDate",s.value)),ku(e,f),f&&window.scrollTo({top:0,behavior:"smooth"}),f&&typeof n=="function"&&n()})}function Se(e){return String(e!=null?e:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Su(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="true"||r==="y"||r==="yes"||r==="1"}function ts(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="true"||r==="y"||r==="yes"||r==="1"}function Jo(e){if(!e)return null;let r=/^(\d{4})-(\d{2})-(\d{2})$/.exec(String(e));if(!r)return null;let t=Number(r[1]),a=Number(r[2]),n=Number(r[3]);return!t||!a||!n?null:{year:t,month:a,day:n}}function au(e){if(!e)return"";let r=Jo(e);if(!r)return"";let{year:t,month:a,day:n}=r;return`${t}-${String(a).padStart(2,"0")}-${String(n).padStart(2,"0")}`}function jE(e){let r=Jo(e);return r?`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.month-1]} ${r.year}`:""}function HE(e){let r=Jo(e);return r?`PTO-AUTO-${r.year}-${String(r.month).padStart(2,"0")}-${String(r.day).padStart(2,"0")}`:""}function Zo(){let e=new Date,r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`}function VE(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="y"||r==="yes"||r==="true"||r==="t"||r==="1"}function WE(){let e=t=>{var a,n;return((n=(a=document.getElementById(t))==null?void 0:a.value)==null?void 0:n.trim())||""};[{id:"config-payroll-date",field:we.payrollDate},{id:"config-accounting-period",field:we.accountingPeriod},{id:"config-journal-id",field:we.journalEntryId},{id:"config-company-name",field:we.companyName},{id:"config-payroll-provider",field:we.payrollProvider},{id:"config-accounting-link",field:we.accountingSoftware},{id:"config-user-name",field:we.reviewerName}].forEach(({id:t,field:a})=>{let n=e(t);a&&Or(a,n)})}function Fr(e,r=[]){let t=r.map(a=>Jn(a));return e.findIndex(a=>t.some(n=>a.includes(n)))}function GE(e){let r=Gr(2),t=!!Ce.permanents[2],a=Qn(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(ts(Ce.completes[2])||n),s=Xe||{},o=s.reconciliation||{},c=s.coverage||{},l=s.totalPriorLiability||0,f=s.employeeCount||0,d=o.reportLiabilityTotal||0,u=o.calcLiabilityTotal||0,h=o.negativeBalanceTotal||0,m=o.negativeBalanceCount||0,p=o.missingRateCount||0,g=u-l,v=I=>(Number(I)||0).toLocaleString("en-US",{style:"currency",currency:"USD"}),x=`
        <article class="pf-step-card pf-step-detail pf-config-card">
            <div class="pf-config-head">
                <h3>PTO Liability Reconciliation</h3>
                <p class="pf-config-subtext">Report \u2192 Adjustments \u2192 JE Amount</p>
            </div>
            
            ${s.loaded&&f>0?`
            <!-- Liability Reconciliation Section -->
            <div class="pf-liability-recon" style="margin-top: 16px; padding: 16px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.7);">Report Liability (PrismHR)</span>
                    <span style="font-weight: 600; color: #fff;">${v(d)}</span>
                </div>
                
                ${m>0?`
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; padding-left: 20px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">Negative Balances (${m} employees)</span>
                    <span style="color: #f87171; font-size: 13px;">${v(h)}</span>
                </div>
                `:""}
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-top: 2px solid rgba(255,255,255,0.2); margin-top: 4px;">
                    <span style="font-weight: 600; color: #fff;">Calculated Liability</span>
                    <span style="font-weight: 600; color: #fff;">${v(u)}</span>
                </div>
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.5);">Prior Period Liability</span>
                    <span style="color: rgba(255,255,255,0.7);">${v(l)}</span>
                </div>
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-top: 2px solid rgba(255,255,255,0.2); margin-top: 4px;">
                    <span style="font-weight: 600; color: #fff;">Net Change (for JE)</span>
                    <span style="font-weight: 700; font-size: 18px; color: ${g>=0?"#4ade80":"#f87171"};">
                        ${g>=0?"+":""}${v(g)}
                    </span>
                    </div>
                </div>
            
            <!-- Employee Coverage Section -->
            <div class="pf-coverage-section" style="margin-top: 16px; padding: 16px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                <h4 style="margin: 0 0 12px 0; font-size: 14px; color: rgba(255,255,255,0.8);">Employee Coverage</h4>
                
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0;">
                    <span style="color: rgba(255,255,255,0.6);">Roster Headcount:</span>
                    <span style="color: #fff;">${c.rosterCount||0}</span>
                </div>
                
                ${c.inPtoOnlyCount>0?`
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0; padding-left: 20px;">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">+ In PTO only (not on roster):</span>
                    <span style="color: rgba(255,255,255,0.7); font-size: 13px;">+${c.inPtoOnlyCount}</span>
            </div>
                <div style="padding-left: 40px; font-size: 12px; color: rgba(255,255,255,0.4);">
                    (Liability: ${v(c.inPtoOnlyLiability||0)})
                </div>
                `:""}
                
                ${c.inRosterOnlyCount>0?`
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0; padding-left: 20px;">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">\u2212 On roster, not in PTO:</span>
                    <span style="color: rgba(255,255,255,0.7); font-size: 13px;">\u2212${c.inRosterOnlyCount}</span>
                </div>
                `:""}
                
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-top: 1px solid rgba(255,255,255,0.15); margin-top: 8px;">
                    <span style="font-weight: 600; color: #fff;">PTO Report Headcount:</span>
                    <span style="font-weight: 600; color: #fff;">${f}</span>
                </div>
            </div>
            `:`
            <div style="margin-top: 16px; padding: 20px; text-align: center; color: rgba(255,255,255,0.5);">
                <p>Click "Generate" to calculate liability reconciliation</p>
            </div>
            `}
            
            ${p>0?`
                <div style="margin-top: 12px; padding: 10px; background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 8px; font-size: 13px;">
                    <strong style="color: #fbbf24;">${p}</strong> employee(s) missing pay rate
                </div>
            `:""}
        </article>
    `,F=ls({id:"pto-copilot",heading:"Ada",subtext:"Ask questions about PTO data, liabilities, and insights",welcomeMessage:"What would you like to explore about PTO accruals?",placeholder:"Ask about PTO balances, accrual rates, or liability trends...",quickActions:[{id:"diagnostics",label:"Run Diagnostics",prompt:"Run a diagnostic check on the PTO data. Check for completeness, missing rates, and data quality issues."},{id:"insights",label:"Generate Insights",prompt:"What are the key insights and findings from this PTO accrual analysis?"},{id:"balances",label:"Balance Analysis",prompt:"Analyze PTO balances by employee and department. Highlight any concerning balances."},{id:"accruals",label:"Accrual Trends",prompt:"Show PTO accrual trends and changes from the prior period."}],contextProvider:ni({dataClean:"PTO_Data_Clean",analysis:"PTO_Analysis",review:"PTO_Review",config:"SS_PF_Config"}),onPrompt:xu});return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(an)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${Se(e.title)}</h2>
            <p class="pf-hero-copy">${Se(e.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Generate Review</h3>
                    <p class="pf-config-subtext">Calculate liabilities, load prior period, and compute variance.</p>
                </div>
                <div class="pf-signoff-action">
                    ${ur(`<button type="button" class="pf-action-toggle pf-clickable" id="review-generate-btn" title="Generate PTO review table">${Mf}</button>`,"Generate")}
                    ${ur(`<button type="button" class="pf-action-toggle pf-clickable" id="review-open-btn" title="Open PTO_Review sheet">${No}</button>`,"Open Sheet")}
                </div>
            </article>
            ${x}
            ${F}
            ${Qa({textareaId:"step-notes-2",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-2",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-2"})}
            ${en({reviewerInputId:"step-reviewer-2",reviewerValue:a,signoffInputId:"step-signoff-2",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-2",completeButtonId:"step-signoff-toggle-2"})}
        </section>
    `}function zE(e){let r=Gr(3),t=!!Ce.permanents[3],a=Qn(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(ts(Ce.completes[3])||n),s=Ze.lastError?`<p class="pf-step-note">${Se(Ze.lastError)}</p>`:"",o=Ze.validationRun,c=Ze.issues||[],l=[{key:"Debits = Credits",desc:"\u2211 Debits = \u2211 Credits"},{key:"Line Amounts Sum to Zero",desc:"\u2211 Line Amount = $0.00"},{key:"JE Matches Analysis Total",desc:"\u2211 JE expense = \u2211 PTO_Analysis Change"}],f=m=>{let p=c.find(y=>y.check===m.key),g=!o,v;return g?v='<span class="pf-je-check-circle pf-je-circle--pending"></span>':p!=null&&p.passed?v=`<span class="pf-je-check-circle pf-je-circle--pass">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </span>`:v=`<span class="pf-je-check-circle pf-je-circle--fail">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </span>`,`
            <div class="pf-je-check-row">
                ${v}
                <span class="pf-je-check-desc-pill">${Se(m.desc)}</span>
            </div>
        `},d=l.map(m=>f(m)).join(""),u=c.filter(m=>!m.passed),h="";return o&&u.length>0&&(h=`
            <article class="pf-step-card pf-step-detail pf-je-issues-card">
                <div class="pf-config-head">
                    <h3>\u26A0\uFE0F Issues Identified</h3>
                    <p class="pf-config-subtext">The following checks did not pass:</p>
                </div>
                <ul class="pf-je-issues-list">
                    ${u.map(m=>`<li><strong>${Se(m.check)}:</strong> ${Se(m.detail)}</li>`).join("")}
                </ul>
            </article>
        `),`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(an)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${Se(e.title)}</h2>
            <p class="pf-hero-copy">${Se(e.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Generate Journal Entry</h3>
                    <p class="pf-config-subtext">Create a balanced JE from your imported PTO data, grouped by department.</p>
                </div>
                <div class="pf-signoff-action">
                    ${ur(`<button type="button" class="pf-action-toggle pf-clickable" id="je-create-btn" title="Generate journal entry from PTO_Analysis">${No}</button>`,"Generate")}
                    ${ur(`<button type="button" class="pf-action-toggle pf-clickable" id="je-run-btn" title="Refresh validation checks">${Gi}</button>`,"Refresh")}
                    ${ur(`<button type="button" class="pf-action-toggle pf-clickable" id="je-export-btn" title="Export journal draft as CSV">${$f}</button>`,"Export")}
                    ${ur(`<button type="button" class="pf-action-toggle pf-clickable" id="je-upload-btn" title="Open accounting software upload">${Mo}</button>`,"Upload")}
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Validation Checks</h3>
                    <p class="pf-config-subtext">These checks run automatically after generating your JE.</p>
                </div>
                ${s}
                <div class="pf-je-checks-container">
                    ${d}
                </div>
            </article>
            ${h}
            ${Qa({textareaId:"step-notes-3",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-3",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-3"})}
            ${en({reviewerInputId:"step-reviewer-3",reviewerValue:a,signoffInputId:"step-signoff-3",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-3",completeButtonId:"step-signoff-toggle-3"})}
        </section>
    `}function XE(){var r,t;return Math.abs((t=(r=De.roster)==null?void 0:r.difference)!=null?t:0)>0}function YE(){return!De.skipAnalysis&&XE()}async function Kn(){if(!xt()){De.loading=!1,De.lastError="Excel runtime is unavailable.",wt();return}De.loading=!0,De.lastError=null,Wr(document.getElementById("headcount-save-btn"),!1),wt();try{let e=await Excel.run(async r=>{let t=r.workbook.worksheets.getItem("SS_Employee_Roster"),a=r.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(a.load("isNullObject"),await r.sync(),a.isNullObject)return console.warn("[Headcount] PTO_Data_Clean not found"),{rosterEmployees:[],ptoEmployees:[],missingFromPto:[],extraInPto:[]};let n=r.workbook.worksheets.getItemOrNullObject("PTO_Analysis"),i=t.getUsedRangeOrNullObject(),s=a.getUsedRangeOrNullObject();i.load("values"),s.load("values"),n.load("isNullObject"),await r.sync();let o=null;n.isNullObject||(o=n.getUsedRangeOrNullObject(),o.load("values")),await r.sync();let c=i.isNullObject?[]:i.values||[],l=s.isNullObject?[]:s.values||[],f=o&&!o.isNullObject?o.values||[]:[],d=f.length?f:l;return qE(c,d)});De.rosterCount=e.rosterCount,De.ptoCount=e.ptoCount,De.missingFromPto=e.missingFromPto,De.extraInPto=e.extraInPto,De.roster=e.roster,De.hasAnalyzed=!0,De.lastError=null}catch(e){console.warn("PTO headcount: unable to analyze data",e),De.lastError="Unable to analyze headcount data. Try re-running the analysis."}finally{De.loading=!1,wt()}}function nu(e){if(!e)return!0;let r=e.toLowerCase().trim();return r?["total","subtotal","sum","count","grand","average","avg"].some(a=>r.includes(a)):!0}function qE(e,r){let t={rosterCount:0,ptoCount:0,missingFromPto:[],extraInPto:[],roster:{rosterCount:0,payrollCount:0,difference:0,mismatches:[]}};if(((e==null?void 0:e.length)||0)<2||((r==null?void 0:r.length)||0)<2)return console.warn("Headcount: insufficient data rows",{rosterRows:(e==null?void 0:e.length)||0,payrollRows:(r==null?void 0:r.length)||0}),t;let a=iu(e),n=iu(r),i=a.headers,s=n.headers,o={employee:su(i),department:i.findIndex(d=>d.includes("department")),status:i.findIndex(d=>d==="employment_status"||d==="status"),termination:i.findIndex(d=>d.includes("termination"))},c={employee:su(s)};console.log("Headcount column detection:",{rosterEmployeeCol:o.employee,rosterDeptCol:o.department,rosterStatusCol:o.status,rosterTerminationCol:o.termination,payrollEmployeeCol:c.employee,rosterHeaders:i.slice(0,5),payrollHeaders:s.slice(0,5)});let l=new Map;for(let d=a.startIndex;d<e.length;d+=1){let u=e[d],h=o.employee>=0?Oa(u[o.employee]):"";if(nu(h))continue;if(o.status>=0){let p=Oa(u[o.status]).toLowerCase();if(p==="terminated"||p==="inactive"||p==="term")continue}if(o.termination>=0&&Oa(u[o.termination]))continue;let m=h.toLowerCase();l.has(m)||l.set(m,{name:h,department:o.department>=0?Oa(u[o.department]):""})}let f=new Map;for(let d=n.startIndex;d<r.length;d+=1){let u=r[d],h=c.employee>=0?Oa(u[c.employee]):"";if(nu(h))continue;let m=h.toLowerCase();f.has(m)||f.set(m,{name:h})}return t.rosterCount=l.size,t.ptoCount=f.size,l.forEach((d,u)=>{f.has(u)||t.missingFromPto.push({name:d.name,department:d.department||"\u2014"})}),f.forEach((d,u)=>{l.has(u)||t.extraInPto.push({name:d.name})}),console.log("Headcount results:",{rosterCount:t.rosterCount,ptoCount:t.ptoCount,missingFromPto:t.missingFromPto.length,extraInPto:t.extraInPto.length}),t.roster.rosterCount=t.rosterCount,t.roster.payrollCount=t.ptoCount,t.roster.difference=t.ptoCount-t.rosterCount,t.roster.mismatches=[...t.missingFromPto.map(d=>`In roster, missing in PTO_Data_Clean: ${d.name}`),...t.extraInPto.map(d=>`In PTO_Data_Clean, missing in roster: ${d.name}`)],t}function iu(e){if(!Array.isArray(e)||!e.length)return{headers:[],startIndex:1};let r=e.findIndex((n=[])=>n.some(i=>Oa(i).toLowerCase().includes("employee"))),t=r===-1?0:r;return{headers:(e[t]||[]).map(n=>Oa(n).toLowerCase()),startIndex:t+1}}function su(e=[]){let r=-1,t=-1;return e.forEach((a,n)=>{let i=a.toLowerCase();if(!i.includes("employee"))return;let s=1;i.includes("name")?s=4:i.includes("id")?s=2:s=3,s>t&&(t=s,r=n)}),r}function Oa(e){return e==null?"":String(e).trim()}function KE(e=[]){return e.map(r=>(r||[]).map(t=>{if(t==null)return"";let a=String(t);return/[",\n]/.test(a)?`"${a.replace(/"/g,'""')}"`:a}).join(",")).join(`
`)}function JE(e,r){let t=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=e,document.body.appendChild(n),n.click(),n.remove(),setTimeout(()=>URL.revokeObjectURL(a),1e3)}function ou(){let e=document.getElementById("headcount-signoff-toggle");if(!e)return;let r=YE(),t=document.getElementById("step-notes-input"),a=(t==null?void 0:t.value.trim())||"";e.disabled=r&&!a;let n=document.getElementById("headcount-notes-hint");n&&(n.textContent=r?"Please document outstanding differences before signing off.":"")}function cu(){let e=document.getElementById("step-notes-input");if(!e)return;let r=e.value||"",t=r.startsWith(Fa)?r.slice(Fa.length).replace(/^\s+/,""):r.replace(new RegExp(`^${Fa}\\s*`,"i"),"").trimStart(),a=Fa+(t?`
${t}`:"");e.value!==a&&(e.value=a),dr(2,"notes",e.value)}function ZE(){let e=document.getElementById("step-notes-input");e&&e.addEventListener("input",()=>{if(!De.skipAnalysis)return;let r=e.value||"";if(!r.startsWith(Fa)){let t=r.replace(Fa,"").trimStart();e.value=Fa+(t?`
${t}`:"")}dr(2,"notes",e.value)})}})();
/*! Bundled license information:

xlsx/xlsx.mjs:
  (*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com *)

xlsx/xlsx.mjs:
  (*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com *)
*/
//# sourceMappingURL=app.bundle.js.map
