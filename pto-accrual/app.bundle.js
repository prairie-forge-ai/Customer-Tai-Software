/* Prairie Forge PTO Accrual */
(()=>{var Hu=Object.defineProperty;var ss=(e,r)=>()=>(e&&(r=e(e=0)),r);var sc=(e,r)=>{for(var t in r)Hu(e,t,{get:r[t],enumerable:!0})};var Pa,ni=ss(()=>{Pa={COMPANY_NAME:"Prairie Forge LLC",PRODUCT_NAME:"Prairie Forge Tools",SUPPORT_URL:"https://prairieforge.ai/support",ADA_IMAGE_URL:"https://assets.prairieforge.ai/storage/v1/object/public/Other%20Public%20Material/Prairie%20Forge/Ada%20Image.png"}});var fc={};sc(fc,{DEFAULT_OPTIONS:()=>fs,bindCopilotCard:()=>us,createExcelContextProvider:()=>ds,renderCopilotCard:()=>td});function td(e={}){var a;let r={...fs,...e},t=((a=r.quickActions)==null?void 0:a.map(n=>`<option value="${rd(n.prompt)}">${n.label}</option>`).join(""))||"";return`
        <article class="pf-ada" data-copilot="${r.id}">
            <div class="pf-ada-search-bar-new">
                <input 
                    type="text" 
                    class="pf-ada-input-new" 
                    id="${r.id}-prompt" 
                    placeholder="What can I help you with" 
                    autocomplete="off"
                >
                <button type="button" class="pf-ada-send-new" id="${r.id}-ask" title="Send">
                    ${ed}
                </button>
            </div>
            
            <div class="pf-ada-conversation" id="${r.id}-messages" style="display: none;">
            </div>
        </article>
    `}function rd(e){return String(e||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function us(e,r={}){let t={...fs,...r},a=e.querySelector(`[data-copilot="${t.id}"]`);if(!a)return;let n=a.querySelector(`#${t.id}-messages`),i=a.querySelector(`#${t.id}-prompt`),s=a.querySelector(`#${t.id}-ask`),o=a.querySelector(`#${t.id}-status-dot`),c=a.querySelector(`#${t.id}-status-text`),l=a.querySelector(`#${t.id}-suggestions-toggle`),f=a.querySelector(`#${t.id}-suggestions-dropdown`),u=a.querySelector(`#${t.id}-suggestions-select`),d=!1,h=(x,O="ready")=>{o&&(o.classList.remove("pf-ada-status-dot--busy","pf-ada-status-dot--offline"),O==="busy"&&o.classList.add("pf-ada-status-dot--busy"),O==="offline"&&o.classList.add("pf-ada-status-dot--offline")),c&&(c.textContent=x)},m=(x,O="assistant")=>{if(!n)return;let I=O==="user"?"pf-ada-bubble--user":O==="system"?"pf-ada-bubble--system":"pf-ada-bubble--ai",A=document.createElement("div");A.className=`pf-ada-bubble ${I}`,A.innerHTML=`<p>${v(x)}</p>`,n.appendChild(A),n.scrollTop=n.scrollHeight,ls.push({role:O,content:x,timestamp:new Date().toISOString()})},p=()=>{if(!n)return;let x=document.createElement("div");x.className="pf-ada-bubble pf-ada-bubble--ai pf-ada-bubble--loading",x.id=`${t.id}-loading`,x.innerHTML=`
            <div class="pf-ada-typing">
                <span></span><span></span><span></span>
            </div>
        `,n.appendChild(x),n.scrollTop=n.scrollHeight},g=()=>{let x=document.getElementById(`${t.id}-loading`);x&&x.remove()},v=x=>String(x).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n\n/g,"</p><p>").replace(/\n- /g,"<br>\u2022 ").replace(/\n/g,"<br>"),y=async x=>{let O=x||(i==null?void 0:i.value.trim());if(!(!O||d)){d=!0,i&&(i.value=""),s&&(s.disabled=!0),n&&n.style.display==="none"&&(n.style.display="flex"),m(O,"user"),p(),h("Analyzing...","busy");try{let I=null;if(typeof t.contextProvider=="function")try{I=await t.contextProvider()}catch(k){console.warn("CoPilot: Context provider failed",k)}let A;typeof t.onPrompt=="function"?A=await t.onPrompt(O,I,ls):typeof t.apiEndpoint=="string"?A=await ad(t.apiEndpoint,O,I,t.systemPrompt):A=nd(O,I),g(),m(A,"assistant"),h("Ready to assist","ready")}catch(I){console.error("CoPilot error:",I),g(),m(`I encountered an issue: ${I.message}. Please try again.`,"system"),h("Error occurred","offline")}d=!1,s&&(s.disabled=!1),i==null||i.focus()}};s==null||s.addEventListener("click",()=>y()),i==null||i.addEventListener("keydown",x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),y())}),l&&f&&l.addEventListener("click",()=>{f.classList.contains("is-open")?(f.classList.remove("is-open"),l.classList.remove("is-active")):(f.classList.add("is-open"),l.classList.add("is-active"))}),u&&(u.addEventListener("change",()=>{let x=u.value;x&&(i&&(i.value=x),f&&(f.classList.remove("is-open"),l==null||l.classList.remove("is-active")),i==null||i.focus())}),u.addEventListener("dblclick",()=>{let x=u.value;x&&(f&&(f.classList.remove("is-open"),l==null||l.classList.remove("is-active")),y(x))}))}async function ad(e,r,t,a){let n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:r,context:t,systemPrompt:a,history:ls.slice(-10)})});if(!n.ok)throw new Error(`API request failed: ${n.status}`);let i=await n.json();return i.message||i.response||"No response received."}function nd(e,r){var a,n,i;let t=e.toLowerCase();return t.includes("diagnostic")||t.includes("check")?`Great question! Let me run through the diagnostics for you.

**\u2713 What Looks Good:**
\u2022 All required fields are populated
\u2022 Current period matches your config date
\u2022 All expense categories are mapped to GL accounts

**\u26A0\uFE0F Items Worth Reviewing:**
\u2022 2 departments show >15% variance from prior period
\u2022 Burden rate (14.6%) is slightly below your historical average (16.2%)

**My Recommendations:**
1. Take a closer look at the Sales & Marketing variance (-44.4%)
2. Verify headcount changes align with HR records
3. Once satisfied, you're clear to proceed to Journal Entry Prep!

Let me know if you'd like me to dig deeper into any of these.`:t.includes("insight")||t.includes("notable")||t.includes("finding")?`Here's what stands out this period \u2014 perfect for your executive summary.

**\u{1F4CA} The Headlines:**
\u2022 Total Payroll: ${(a=r==null?void 0:r.summary)!=null&&a.total?`$${(r.summary.total/1e3).toFixed(0)}K`:"$254K"}
\u2022 Headcount: ${((n=r==null?void 0:r.summary)==null?void 0:n.employeeCount)||38} employees
\u2022 Avg Cost/Employee: ${(i=r==null?void 0:r.summary)!=null&&i.avgPerEmployee?`$${r.summary.avgPerEmployee.toFixed(0)}`:"$6,674"}

**\u{1F4A1} Key Findings:**
1. **Payroll decreased 14.2%** \u2014 primarily driven by headcount reduction in Sales
2. **R&D remains your largest cost center** at 39% of total payroll
3. **Burden rate normalized** to 14.6% (was 18.2% prior period)

**\u26A0\uFE0F Items to Flag:**
\u2022 Sales & Marketing down $52K \u2014 worth confirming this was intentional
\u2022 2 fewer employees than prior period

**Suggested Talking Points:**
\u2022 "Payroll efficiency improved with 14% reduction while maintaining core operations"
\u2022 "R&D investment remains strong \u2014 aligned with product roadmap"

Would you like me to prepare more detailed talking points for any specific area?`:t.includes("variance")||t.includes("change")||t.includes("difference")?`**Variance Analysis: Current vs Prior Period**

\u{1F4C8} **Significant Changes**:

| Department | Change | % Change | Driver |
|------------|--------|----------|--------|
| Sales & Marketing | -$52,298 | -44.4% | \u{1F534} Headcount |
| Research & Dev | +$8,514 | +9.4% | Merit increases |
| General & Admin | +$1,610 | +3.9% | Normal variance |

\u{1F50D} **Root Cause Analysis**:

**Sales & Marketing (-44.4%)**:
\u2022 3 positions eliminated per restructuring plan
\u2022 Commission payouts lower due to Q4 timing
\u2022 \u26A0\uFE0F Verify: Is this aligned with sales targets?

**R&D (+9.4%)**:
\u2022 Annual merit increases effective this period
\u2022 1 new senior engineer hire
\u2022 \u2713 Expected per hiring plan

**Recommendation**: Document Sales variance in review notes. This is material and will be questioned.`:t.includes("journal")||t.includes("je")||t.includes("entry")?`Good news \u2014 your journal entry looks ready to go! Here's the full check:

**\u2713 Balance Check: PASSED**
\u2022 Total Debits: $253,625
\u2022 Total Credits: $253,625
\u2022 Difference: $0.00 \u2014 perfectly balanced!

**\u2713 Mapping Validation: Complete**
\u2022 9 unique GL accounts used
\u2022 All department codes are valid

**\u2713 Reference Data:**
\u2022 JE ID: PR-AUTO-2025-11-27
\u2022 Transaction Date: 2025-11-27
\u2022 Period: November 2025

**You're clear to export!** \u2705

**Next Steps:**
1. Click "Export" to download the CSV
2. Import into your accounting system
3. Post and reconcile

Let me know if you need me to double-check anything before you export!`:`Great question! I'm Ada, and I'm here to help with your payroll analysis.

Here's what I can help you with:

\u2022 **\u{1F50D} Diagnostics** \u2014 Check data quality and completeness
\u2022 **\u{1F4A1} Insights** \u2014 Key findings for executive review  
\u2022 **\u{1F4CA} Variance Analysis** \u2014 Period-over-period changes
\u2022 **\u{1F4CB} JE Readiness** \u2014 Validate journal entries before export

Try clicking one of the quick action buttons above, or just ask me something specific like:
\u2022 "What's driving the variance this period?"
\u2022 "Is my data ready for the CFO?"
\u2022 "Summarize the department breakdown"

I'm reading your actual spreadsheet data, so I can give you specific answers!`}function ds(e={}){return async()=>{if(typeof Excel=="undefined")return null;try{return await Excel.run(async r=>{var i;let t={},a=r.workbook.worksheets.getItemOrNullObject(e.dataClean||"PR_Data_Clean");if(a.load("isNullObject"),await r.sync(),!a.isNullObject){let s=a.getUsedRangeOrNullObject();s.load("values, rowCount"),await r.sync(),!s.isNullObject&&((i=s.values)==null?void 0:i.length)>1&&(t.rowCount=s.rowCount-1,t.dataAvailable=!0)}let n=r.workbook.worksheets.getItemOrNullObject(e.config||"SS_PF_Config");return n.load("isNullObject"),await r.sync(),n.isNullObject||(t.configAvailable=!0),{timestamp:new Date().toISOString(),summary:t}})}catch(r){return console.warn("CoPilot: Failed to read Excel context",r),null}}}var ed,sS,fs,ls,hs=ss(()=>{ni();ed='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>',sS=Pa.ADA_IMAGE_URL,fs={id:"pf-copilot",heading:"Ada",subtext:"Your smart assistant to help you analyze and troubleshoot.",welcomeMessage:"What would you like to explore?",placeholder:"Where should I focus this pay period?",quickActions:[{id:"diagnostics",label:"Diagnostics",prompt:"Run a diagnostic check on the current payroll data. Check for completeness, accuracy issues, and any data quality concerns."},{id:"insights",label:"Insights",prompt:"What are the key insights and notable findings from this payroll period that I should highlight for executive review?"},{id:"variance",label:"Variances",prompt:"Analyze the significant variances between this period and the prior period. What's driving the changes?"},{id:"journal",label:"JE Check",prompt:"Is the journal entry ready for export? Check that debits equal credits and flag any mapping issues."}],systemPrompt:`You are Prairie Forge CoPilot, an expert financial analyst assistant embedded in an Excel add-in. 

Your role is to help accountants and CFOs:
1. Analyze payroll expense data for accuracy and completeness
2. Identify trends, anomalies, and areas requiring attention
3. Prepare executive-ready insights and talking points
4. Validate journal entries before export

Communication style:
- Be concise but thorough
- Use bullet points for clarity
- Highlight actionable items with \u26A0\uFE0F or \u2713
- Format currency as $X,XXX and percentages as X.X%
- Always suggest 2-3 concrete next steps

When analyzing data, look for:
- Period-over-period changes > 10%
- Department cost anomalies
- Headcount vs payroll mismatches
- Burden rate outliers
- Missing or incomplete mappings`},ls=[]});var gc={};sc(gc,{HOMEPAGE_CONFIG:()=>ps,activateHomepageSheet:()=>dn,getHomepageConfig:()=>hn,hideAdaModal:()=>oi,removeAdaFab:()=>ci,renderAdaFab:()=>ms,showAdaModal:()=>mc});async function dc(e,r,t){let a=`${id}/functions/v1/copilot`;try{let n=window.PRAIRIE_FORGE_CONTEXT||{},i=n.module||"general",s=n.step!==null&&n.step!==void 0?String(n.step):"homepage",o=n.stepName||null,c=n.companyId||null;console.log("[Ada Popup] Calling copilot API with context:",{module:i,step:s,stepName:o,companyId:c});let l={...r,stepName:o},f=await fetch(a,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:`Bearer ${uc}`,apikey:uc},body:JSON.stringify({prompt:e,context:l,module:i,function:s,customerId:c,history:(t==null?void 0:t.slice(-10))||[]})});if(!f.ok){let d=await f.text();throw console.error("[Ada Popup] API error:",f.status,d),new Error(`API request failed: ${f.status}`)}let u=await f.json();return console.log("[Ada Popup] API response received"),u.message||u.response?u.message||u.response:"I received your question but couldn't generate a response. Please try again."}catch(n){return console.error("[Ada Popup] API call failed:",n),`I'm having trouble connecting right now. Error: ${n.message}. Please try again in a moment.`}}async function dn(e,r,t){if(typeof Excel=="undefined"){console.warn("Excel runtime not available for homepage sheet");return}try{await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject(e);n.load("isNullObject, name, visibility"),await a.sync();let i;n.isNullObject?(i=a.workbook.worksheets.add(e),await a.sync(),await hc(a,i,r,t)):(i=n,i.visibility!==Excel.SheetVisibility.visible&&(i.visibility=Excel.SheetVisibility.visible,await a.sync()),await hc(a,i,r,t)),i.activate(),i.getRange("A1").select(),await a.sync()})}catch(a){console.error(`Error activating homepage sheet ${e}:`,a)}}async function hc(e,r,t,a){try{let l=r.getUsedRangeOrNullObject();l.load("isNullObject"),await e.sync(),l.isNullObject||(l.clear(),await e.sync())}catch{}r.showGridlines=!1,r.getRange("A:A").format.columnWidth=400,r.getRange("B:B").format.columnWidth=50,r.getRange("1:1").format.rowHeight=60,r.getRange("2:2").format.rowHeight=30;let n=[[t,""],[a,""],["",""],["",""]],i=r.getRangeByIndexes(0,0,4,2);i.values=n;let s=r.getRange("A1:Z100");s.format.fill.color="#0f0f0f";let o=r.getRange("A1");o.format.font.bold=!0,o.format.font.size=36,o.format.font.color="#ffffff",o.format.font.name="Segoe UI Light",o.format.verticalAlignment="Center";let c=r.getRange("A2");c.format.font.size=14,c.format.font.color="#a0a0a0",c.format.font.name="Segoe UI",c.format.verticalAlignment="Top",r.freezePanes.freezeRows(0),r.freezePanes.freezeColumns(0),await e.sync()}function hn(e){return ps[e]||ps["module-selector"]}function ms(){ci();let e=document.createElement("button");return e.className="pf-ada-fab",e.id="pf-ada-fab",e.setAttribute("aria-label","Ask Ada"),e.setAttribute("title","Ask Ada"),e.innerHTML=`
        <span class="pf-ada-fab__ring"></span>
        <img 
            class="pf-ada-fab__image" 
            src="${pc}" 
            alt="Ada - Your AI Assistant"
            onerror="this.style.display='none'"
        />
    `,document.body.appendChild(e),e.addEventListener("click",mc),e}function ci(){let e=document.getElementById("pf-ada-fab");e&&e.remove();let r=document.getElementById("pf-ada-modal-overlay");r&&r.remove()}function sd(){let e,r,t,a=async()=>{try{let i=await Promise.resolve().then(()=>(hs(),fc));e=i.renderCopilotCard,r=i.bindCopilotCard,t=i.createExcelContextProvider}catch(i){console.warn("Could not load copilot functions:",i)}};return{subtext:"Your AI-powered assistant",copilotHtml:"",bindFunction:async()=>{if(await a(),e&&r){let i=document.getElementById("ada-modal-copilot");i&&(i.innerHTML=e({id:"ada-modal-copilot",heading:"Ada",subtext:"Ask questions about your data",welcomeMessage:"Hi! I'm Ada, your AI assistant. How can I help you today?",placeholder:"Ask about your data, analysis, or insights...",quickActions:[{id:"help",label:"What can you do?",prompt:"What kinds of questions can you help me with? What data do you have access to?"},{id:"overview",label:"Data Overview",prompt:"Give me an overview of the data available in this workbook."},{id:"tips",label:"Best Practices",prompt:"What are some best practices for using this tool effectively?"}],contextProvider:t?t({config:"SS_PF_Config"}):null,onPrompt:dc}),setTimeout(()=>{r(i,{id:"ada-modal-copilot",contextProvider:t?t({config:"SS_PF_Config"}):null,onPrompt:dc})},200))}}}}function mc(){let e=document.getElementById("pf-ada-modal-overlay");e&&e.remove();let r=sd(),t=document.createElement("div");t.className="pf-ada-modal-overlay",t.id="pf-ada-modal-overlay",t.innerHTML=`
        <div class="pf-ada-modal pf-ada-modal--chat">
            <div class="pf-ada-modal__header">
                <span class="pf-ada-modal__beta-tag">BETA</span>
                <button class="pf-ada-modal__close" id="ada-modal-close" title="Close">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <img class="pf-ada-modal__avatar" src="${pc}" alt="Ada" />
                <h2 class="pf-ada-modal__title">Ask Ada</h2>
                <p class="pf-ada-modal__subtitle">Your AI-powered assistant to help you troubleshoot, answer questions and perform deeper analyses.</p>
            </div>
            <div class="pf-ada-modal__body">
                <div class="pf-ada-copilot-container" id="ada-modal-copilot">
                    <div class="pf-ada-loading">
                        <div class="pf-ada-typing"><span></span><span></span><span></span></div>
                        <p>Loading Ada...</p>
                    </div>
                </div>
            </div>
        </div>
    `,document.body.appendChild(t),requestAnimationFrame(()=>{t.classList.add("is-visible")});let a=document.getElementById("ada-modal-close");a==null||a.addEventListener("click",oi),t.addEventListener("click",i=>{i.target===t&&oi()});let n=i=>{i.key==="Escape"&&(oi(),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n),r.bindFunction&&r.bindFunction()}function oi(){let e=document.getElementById("pf-ada-modal-overlay");e&&(e.classList.remove("is-visible"),setTimeout(()=>{e.remove()},300))}var pc,id,uc,ps,gs=ss(()=>{ni();pc=Pa.ADA_IMAGE_URL,id="https://jgciqwzwacaesqjaoadc.supabase.co",uc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE";ps={"module-selector":{sheetName:"SS_Homepage",title:"ForgeSuite",subtitle:"Select a module from the side panel to get started."},"payroll-recorder":{sheetName:"PR_Homepage",title:"Payroll Recorder",subtitle:"Normalize payroll exports, enforce controls, and prep journal entries without leaving Excel."},"pto-accrual":{sheetName:"PTO_Homepage",title:"PTO Accrual",subtitle:"Calculate employee PTO liabilities, compare period-over-period changes, and prepare accrual journal entries."}}});ni();function xt(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}var os="SS_PF_Config";async function oc(e,r=[os]){var n;let t=e.workbook.tables;t.load("items/name"),await e.sync();let a=(n=t.items)==null?void 0:n.find(i=>r.includes(i.name));return a?e.workbook.tables.getItem(a.name):(console.warn("Config table not found. Looking for:",r),null)}function cc(e){let r=e.map(t=>String(t||"").trim().toLowerCase());return{field:r.findIndex(t=>t==="field"||t==="field name"||t==="setting"),value:r.findIndex(t=>t==="value"||t==="setting value"),type:r.findIndex(t=>t==="type"||t==="category"),title:r.findIndex(t=>t==="title"||t==="display name"),permanent:r.findIndex(t=>t==="permanent"||t==="persist")}}async function ii(e=[os]){if(!xt())return{};try{return await Excel.run(async r=>{let t=await oc(r,e);if(!t)return{};let a=t.getDataBodyRange(),n=t.getHeaderRowRange();a.load("values"),n.load("values"),await r.sync();let i=n.values[0]||[],s=cc(i);if(s.field===-1||s.value===-1)return console.warn("Config table missing FIELD or VALUE columns. Headers:",i),{};let o={};return(a.values||[]).forEach(l=>{var u;let f=String(l[s.field]||"").trim();f&&(o[f]=(u=l[s.value])!=null?u:"")}),console.log("Configuration loaded:",Object.keys(o).length,"fields"),o})}catch(r){return console.error("Failed to load configuration:",r),{}}}var Vu=new Set(["SS_Installation_Key","SS_Company_ID","SS_Company_Name","SS_Accounting_Software","PTO_Payroll_Provider","PR_Payroll_Provider"]);async function un(e,r,t=[os]){if(!xt())return!1;try{return await Excel.run(async a=>{let n=await oc(a,t);if(!n){console.warn("Config table not found for write");return}let i=n.getDataBodyRange(),s=n.getHeaderRowRange();i.load("values"),s.load("values"),await a.sync();let o=s.values[0]||[],c=cc(o);if(c.field===-1||c.value===-1){console.error("Config table missing FIELD or VALUE columns");return}let f=(i.values||[]).findIndex(d=>String(d[c.field]||"").trim()===e),u=Vu.has(e);if(f>=0)i.getCell(f,c.value).values=[[r]],u&&c.permanent>=0&&(i.getCell(f,c.permanent).values=[["Y"]]);else{let d=new Array(o.length).fill("");c.type>=0&&(d[c.type]=u?"Shared":"Run Settings"),d[c.field]=e,d[c.value]=r,c.permanent>=0&&(d[c.permanent]=u?"Y":"N"),c.title>=0&&(d[c.title]=""),n.rows.add(null,[d]),console.log("Added new config row:",e,"=",r,u?"(permanent)":"")}await a.sync(),console.log("Saved config:",e,"=",r)}),!0}catch(a){return console.error("Failed to save config:",e,a),!1}}var Wu="SS_PF_Config",Gu="module-prefix",zu="system",cs="module-selector",Xu="SS_Homepage",Yu=["SS_Employee_Roster","SS_Chart_of_Accounts","SS_PF_Config"],Na={PR_:"payroll-recorder",PTO_:"pto-accrual",CC_:"credit-card-expense",COM_:"commission-calc",SS_:"system"};async function lc(){if(!xt())return{...Na};try{return await Excel.run(async e=>{var f,u;let r=e.workbook.worksheets.getItemOrNullObject(Wu);if(await e.sync(),r.isNullObject)return console.log("[Tab Visibility] Config sheet not found, using defaults"),{...Na};let t=r.getUsedRangeOrNullObject();if(t.load("values"),await e.sync(),t.isNullObject||!((f=t.values)!=null&&f.length))return{...Na};let a=t.values,n=Ju(a[0]),i=n.get("category"),s=n.get("field"),o=n.get("value");if(i===void 0||s===void 0||o===void 0)return console.warn("[Tab Visibility] Missing required columns, using defaults"),{...Na};let c={},l=!1;for(let d=1;d<a.length;d++){let h=a[d];if(qr(h[i])===Gu){let p=String((u=h[s])!=null?u:"").trim().toUpperCase(),g=qr(h[o]);p&&g&&(c[p]=g,l=!0)}}return l?(console.log("[Tab Visibility] Loaded prefix config:",c),c):(console.log("[Tab Visibility] No module-prefix rows found, using defaults"),{...Na})})}catch(e){return console.warn("[Tab Visibility] Error reading prefix config:",e),{...Na}}}async function si(e){var t;if(!xt())return;let r=qr(e);console.log(`[Tab Visibility] Applying visibility for module: ${r}`);try{let a=await lc(),n=Object.keys(a).map(o=>String(o!=null?o:"").trim().toUpperCase()).filter(Boolean).sort((o,c)=>c.length-o.length),i=Zu(a),s=r===qr(cs)?null:(t=i[r])!=null?t:null;if(r!==qr(cs)&&!s){console.warn(`[Tab Visibility] No active prefix found for moduleKey="${r}". Skipping visibility changes.`);return}await Excel.run(async o=>{let c=o.workbook.worksheets;c.load("items/name,visibility"),await o.sync();let l=[],f=[],u=[],d=[];c.items.forEach(p=>{let g=p.name,v=g.toUpperCase(),y=!1,x=!1,O=Yu.some(I=>v===I.toUpperCase());if(r===qr(cs))v===Xu.toUpperCase()?y=!0:x=!0;else{let I=Qu(v,n);I&&(I===s?y=!0:x=!0),O&&(y=!1,x=!0)}y?(l.push(p),console.log(`[Tab Visibility] SHOW: ${g}`),u.push(g)):x?(f.push(p),console.log(`[Tab Visibility] HIDE: ${g}`),d.push(g)):console.log(`[Tab Visibility] SKIP: ${g} (no prefix match)`)});for(let p of l)p.visibility=Excel.SheetVisibility.visible;if(await o.sync(),c.items.filter(p=>p.visibility===Excel.SheetVisibility.visible).filter(p=>!f.includes(p)).length>=1){for(let p of f)try{p.visibility=Excel.SheetVisibility.hidden}catch(g){console.warn(`[Tab Visibility] Could not hide "${p.name}":`,g.message)}await o.sync()}else console.warn("[Tab Visibility] Skipping hide - would leave no visible sheets");console.log(`[Tab Visibility] Done! Showed ${l.length}, hid ${f.length} tabs`),console.log("[Tab Visibility] Summary:",{moduleKey:r,activePrefix:s,shownSheets:u,hiddenSheets:d})})}catch(a){console.warn("[Tab Visibility] Error applying visibility:",a)}}async function qu(){if(!xt()){console.log("Excel not available");return}try{await Excel.run(async e=>{let r=e.workbook.worksheets;r.load("items/name,visibility"),await e.sync();let t=0;r.items.forEach(a=>{a.visibility!==Excel.SheetVisibility.visible&&(a.visibility=Excel.SheetVisibility.visible,console.log(`[ShowAll] Made visible: ${a.name}`),t++)}),await e.sync(),console.log(`[ShowAll] Done! Made ${t} sheets visible. Total: ${r.items.length}`)})}catch(e){console.error("[Tab Visibility] Unable to show all sheets:",e)}}async function Ku(){if(!xt()){console.log("Excel not available");return}try{let e=await lc(),r=[];for(let[t,a]of Object.entries(e))a===zu&&r.push(t);await Excel.run(async t=>{let a=t.workbook.worksheets;a.load("items/name,visibility"),await t.sync(),a.items.forEach(n=>{let i=n.name.toUpperCase();r.some(s=>i.startsWith(s))&&(n.visibility=Excel.SheetVisibility.visible,console.log(`[Unhide] Made visible: ${n.name}`))}),await t.sync(),console.log("[Unhide] System sheets are now visible!")})}catch(e){console.error("[Tab Visibility] Unable to unhide system sheets:",e)}}function Ju(e=[]){let r=new Map;return e.forEach((t,a)=>{let n=qr(t);n&&r.set(n,a)}),r}function qr(e){return String(e!=null?e:"").trim().toLowerCase().replace(/[\s_]+/g,"-")}function Zu(e){let r={};for(let[t,a]of Object.entries(e!=null?e:{})){let n=String(t!=null?t:"").trim().toUpperCase(),i=qr(a);!n||!i||r[i]||(r[i]=n)}return r}function Qu(e,r){for(let t of r)if(e.startsWith(t))return t;return null}async function Da(e){if(!xt())return!1;try{return await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject(e);return await r.sync(),t.isNullObject?(console.warn(`[Tab Visibility] Sheet "${e}" not found`),!1):(t.visibility=Excel.SheetVisibility.visible,t.activate(),await r.sync(),console.log(`[Tab Visibility] Showed and activated: ${e}`),!0)}),!0}catch(r){return console.error(`[Tab Visibility] Error showing sheet "${e}":`,r),!1}}typeof window!="undefined"&&(window.PrairieForge=window.PrairieForge||{},window.PrairieForge.showAllSheets=qu,window.PrairieForge.unhideSystemSheets=Ku,window.PrairieForge.applyModuleTabVisibility=si,window.PrairieForge.showAndActivateSheet=Da);gs();hs();var od=["January","February","March","April","May","June","July","August","September","October","November","December"],vc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],cd=["Su","Mo","Tu","We","Th","Fr","Sa"],$t=null,pr=null;function yc(e,r={}){let t=document.getElementById(e);if(!t)return;let{onChange:a=null,minDate:n=null,maxDate:i=null,readonly:s=!1}=r,o=t.closest(".pf-datepicker-wrapper");o||(o=document.createElement("div"),o.className="pf-datepicker-wrapper",t.parentNode.insertBefore(o,t),o.appendChild(t)),t.type="text",t.placeholder="Select date...",t.classList.add("pf-datepicker-input"),t.readOnly=!0;let c=t.value?xc(t.value):null;c&&(t.value=vs(c),t.dataset.value=pn(c));let l=o.querySelector(".pf-datepicker-icon");l||(l=document.createElement("span"),l.className="pf-datepicker-icon",l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>',o.appendChild(l));let f={inputId:e,input:t,selectedDate:c,viewDate:c?new Date(c):new Date,onChange:a,minDate:n,maxDate:i};function u(){s||(pr=f,ld())}return t.addEventListener("click",u),l.addEventListener("click",u),{getValue:()=>f.selectedDate?pn(f.selectedDate):"",setValue:d=>{let h=xc(d);f.selectedDate=h,f.viewDate=h?new Date(h):new Date,h?(t.value=vs(h),t.dataset.value=pn(h)):(t.value="",t.dataset.value="")},open:u,close:li}}function ld(){pr&&($t||($t=document.createElement("div"),$t.className="pf-datepicker-modal",$t.id="pf-datepicker-modal",document.body.appendChild($t)),_c(),requestAnimationFrame(()=>{$t.classList.add("is-open")}),document.addEventListener("keydown",wc))}function li(){$t&&$t.classList.remove("is-open"),document.removeEventListener("keydown",wc),pr=null}function wc(e){e.key==="Escape"&&li()}function _c(){if(!$t||!pr)return;let{viewDate:e,selectedDate:r,minDate:t,maxDate:a}=pr,n=e.getFullYear(),i=e.getMonth();$t.innerHTML=`
        <div class="pf-datepicker-backdrop"></div>
        <div class="pf-datepicker-container">
            <div class="pf-datepicker-header">
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="prev-year" title="Previous Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="11 17 6 12 11 7"/><polyline points="18 17 13 12 18 7"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="prev-month" title="Previous Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                    </button>
                </div>
                <span class="pf-datepicker-title">${od[i]} ${n}</span>
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="next-month" title="Next Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="next-year" title="Next Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="13 17 18 12 13 7"/><polyline points="6 17 11 12 6 7"/></svg>
                    </button>
                </div>
            </div>
            <div class="pf-datepicker-weekdays">
                ${cd.map(s=>`<span>${s}</span>`).join("")}
            </div>
            <div class="pf-datepicker-days">
                ${dd(n,i,r,t,a)}
            </div>
            <div class="pf-datepicker-footer">
                <button type="button" class="pf-datepicker-btn pf-datepicker-today" data-action="today">Today</button>
                <button type="button" class="pf-datepicker-btn pf-datepicker-clear" data-action="clear">Clear</button>
            </div>
        </div>
    `,fd()}function fd(){var e;$t&&((e=$t.querySelector(".pf-datepicker-backdrop"))==null||e.addEventListener("click",li),$t.querySelectorAll(".pf-datepicker-nav").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=r.dataset.action;ud(a)})}),$t.querySelectorAll(".pf-datepicker-day:not(.disabled)").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=parseInt(r.dataset.day),n=parseInt(r.dataset.month),i=parseInt(r.dataset.year);xs(new Date(i,n,a))})}),$t.querySelectorAll(".pf-datepicker-btn").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=r.dataset.action;a==="today"?xs(new Date):a==="clear"&&xs(null)})}))}function ud(e){if(!pr)return;let r=pr.viewDate;switch(e){case"prev-year":r.setFullYear(r.getFullYear()-1);break;case"prev-month":r.setMonth(r.getMonth()-1);break;case"next-month":r.setMonth(r.getMonth()+1);break;case"next-year":r.setFullYear(r.getFullYear()+1);break}_c()}function xs(e){if(!pr)return;let{input:r,onChange:t}=pr;pr.selectedDate=e,e?(r.value=vs(e),r.dataset.value=pn(e),pr.viewDate=new Date(e)):(r.value="",r.dataset.value=""),t&&t(e?pn(e):""),r.dispatchEvent(new Event("change",{bubbles:!0})),li()}function dd(e,r,t,a,n){let i=new Date(e,r,1).getDay(),s=new Date(e,r+1,0).getDate(),o=new Date(e,r,0).getDate(),c=new Date;c.setHours(0,0,0,0),t&&(t=new Date(t),t.setHours(0,0,0,0));let l="";for(let h=i-1;h>=0;h--){let m=o-h,p=r===0?11:r-1,g=r===0?e-1:e;l+=`<button type="button" class="pf-datepicker-day other-month" data-day="${m}" data-month="${p}" data-year="${g}">${m}</button>`}for(let h=1;h<=s;h++){let m=new Date(e,r,h);m.setHours(0,0,0,0);let p=m.getTime()===c.getTime(),g=t&&m.getTime()===t.getTime(),v="pf-datepicker-day";p&&(v+=" today"),g&&(v+=" selected");let y=!1;a&&m<a&&(y=!0),n&&m>n&&(y=!0),y&&(v+=" disabled"),l+=`<button type="button" class="${v}" data-day="${h}" data-month="${r}" data-year="${e}" ${y?"disabled":""}>${h}</button>`}let f=42,u=i+s,d=f-u;for(let h=1;h<=d;h++){let m=r===11?0:r+1,p=r===11?e+1:e;l+=`<button type="button" class="pf-datepicker-day other-month" data-day="${h}" data-month="${m}" data-year="${p}">${h}</button>`}return l}function xc(e){if(!e)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[a,n,i]=e.split("-").map(Number);return new Date(a,n-1,i)}let r=e.match(/^(\w+)\s+(\d+),\s+(\d{4})$/);if(r){let a=vc.findIndex(n=>n.toLowerCase()===r[1].toLowerCase().substring(0,3));if(a>=0)return new Date(parseInt(r[3]),a,parseInt(r[2]))}if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e)){let[a,n,i]=e.split("/").map(Number);return new Date(i,a-1,n)}let t=new Date(e);return isNaN(t.getTime())?null:t}function vs(e){return e?`${vc[e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`:""}function pn(e){if(!e)return"";let r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`}var An={};An.version="0.18.5";var br=1200,za=1252,hd=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gs={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},zs=function(e){hd.indexOf(e)!=-1&&(za=Gs[0]=e)};function pd(){zs(1252)}var gr=function(e){br=e,zs(e)};function Xs(){gr(1200),pd()}function Ps(e){for(var r=[],t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function md(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Fl(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var xn=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?md(e.slice(2)):r==254&&t==255?Fl(e.slice(2)):r==65279?e.slice(1):e},fi=function(r){return String.fromCharCode(r)},kc=function(r){return String.fromCharCode(r)},$e;var at=null,mn=!0,Jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function On(e){for(var r="",t=0,a=0,n=0,i=0,s=0,o=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),i=t>>2,a=e.charCodeAt(l++),s=(t&3)<<4|a>>4,n=e.charCodeAt(l++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),r+=Jr.charAt(i)+Jr.charAt(s)+Jr.charAt(o)+Jr.charAt(c);return r}function Qt(e){var r="",t=0,a=0,n=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=Jr.indexOf(e.charAt(l++)),s=Jr.indexOf(e.charAt(l++)),t=i<<2|s>>4,r+=String.fromCharCode(t),o=Jr.indexOf(e.charAt(l++)),a=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(a)),c=Jr.indexOf(e.charAt(l++)),n=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(n));return r}var Ae=(function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node})(),$r=(function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Qr(e){return Ae?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function Ec(e){return Ae?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var Jt=function(r){return Ae?$r(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Ni(e){if(typeof ArrayBuffer=="undefined")return Jt(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),a=0;a!=e.length;++a)t[a]=e.charCodeAt(a)&255;return r}function aa(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function gd(e){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(e)}function Ys(e){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ys(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Et=Ae?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:$r(r)}))}:function(e){if(typeof Uint8Array!="undefined"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var a=new Uint8Array(t),n=0;for(r=0,t=0;r<e.length;t+=n,++r)if(n=e[r].length,e[r]instanceof Uint8Array)a.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";a.set(new Uint8Array(e[r]),t)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function xd(e){for(var r=[],t=0,a=e.length+250,n=Qr(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)n[t++]=s;else if(s<2048)n[t++]=192|s>>6&31,n[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;n[t++]=240|s>>8&7,n[t++]=128|s>>2&63,n[t++]=128|o>>6&15|(s&3)<<4,n[t++]=128|o&63}else n[t++]=224|s>>12&15,n[t++]=128|s>>6&63,n[t++]=128|s&63;t>a&&(r.push(n.slice(0,t)),t=0,n=Qr(65535),a=65530)}return r.push(n.slice(0,t)),Et(r)}var Dt=/\u0000/g,vn=/[\u0001-\u0006]/g;function Ha(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function xr(e,r){var t=""+e;return t.length>=r?t:tt("0",r-t.length)+t}function qs(e,r){var t=""+e;return t.length>=r?t:tt(" ",r-t.length)+t}function _i(e,r){var t=""+e;return t.length>=r?t:t+tt(" ",r-t.length)}function vd(e,r){var t=""+Math.round(e);return t.length>=r?t:tt("0",r-t.length)+t}function yd(e,r){var t=""+e;return t.length>=r?t:tt("0",r-t.length)+t}var Sc=Math.pow(2,32);function La(e,r){if(e>Sc||e<-Sc)return vd(e,r);var t=Math.round(e);return yd(t,r)}function ki(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Tc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ys=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function wd(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var xe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},bc={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_d={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ei(e,r,t){for(var a=e<0?-1:1,n=e*a,i=0,s=1,o=0,c=1,l=0,f=0,u=Math.floor(n);l<r&&(u=Math.floor(n),o=u*s+i,f=u*l+c,!(n-u<5e-8));)n=1/(n-u),i=s,s=o,c=l,l=f;if(f>r&&(l>r?(f=c,o=i):(f=l,o=s)),!t)return[0,a*o,f];var d=Math.floor(a*o/f);return[d,a*o-d*f,f]}function da(e,r,t){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,s=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)s=t?[1317,10,29]:[1900,2,29],i=3;else if(a===0)s=t?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),t&&(i=Cd(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var Il=new Date(1899,11,31,0,0,0),kd=Il.getTime(),Ed=new Date(1900,2,1,0,0,0);function Rl(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=Ed&&(t+=1440*60*1e3),(t-(kd+(e.getTimezoneOffset()-Il.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Ks(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Sd(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Td(e){var r=e<0?12:11,t=Ks(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function bd(e){var r=Ks(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Fn(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Td(e):r===10?t=e.toFixed(10).substr(0,12):t=bd(e),Ks(Sd(t.toUpperCase()))}function xa(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Fn(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fr(14,Rl(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Cd(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Ad(e,r,t,a){var n="",i=0,s=0,o=t.y,c,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,l=r.length;break;case 3:return ys[t.m-1][1];case 5:return ys[t.m-1][0];default:return ys[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,l=r.length;break;case 3:return Tc[t.q][0];default:return Tc[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?xr(t.S,r.length):(a>=2?s=a===3?1e3:100:s=a===1?10:1,i=Math.round(s*(t.S+t.u)),i>=60*s&&(i=0),r==="s"?i===0?"0":""+i/s:(n=xr(i,2+a),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?xr(c,l):"";return f}function Zr(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,a=e.substr(0,t);t!=e.length;t+=r)a+=(a.length>0?",":"")+e.substr(t,r);return a}var Pl=/%/g;function Od(e,r,t){var a=r.replace(Pl,""),n=r.length-a.length;return Lr(e,a,t*Math.pow(10,2*n))+tt("%",n)}function Fd(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Lr(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Nl(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Nl(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Dl=/# (\?+)( ?)\/( ?)(\d+)/;function Id(e,r,t){var a=parseInt(e[4],10),n=Math.round(r*a),i=Math.floor(n/a),s=n-i*a,o=a;return t+(i===0?"":""+i)+" "+(s===0?tt(" ",e[1].length+1+e[4].length):qs(s,e[1].length)+e[2]+"/"+e[3]+xr(o,e[4].length))}function Rd(e,r,t){return t+(r===0?"":""+r)+tt(" ",e[1].length+2+e[4].length)}var Ll=/^#*0*\.([0#]+)/,Bl=/\).*[0#]/,Ml=/\(###\) ###\\?-####/;function jt(e){for(var r="",t,a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Cc(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Ac(e,r){var t=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(t*a)).length?0:Math.round(t*a)}function Pd(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Nd(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function nr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Bl)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?nr("n",a,t):"("+nr("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Fd(e,r,t);if(r.indexOf("%")!==-1)return Od(e,r,t);if(r.indexOf("E")!==-1)return Nl(r,t);if(r.charCodeAt(0)===36)return"$"+nr(e,r.substr(r.charAt(1)==" "?2:1),t);var n,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+La(c,r.length);if(r.match(/^[#?]+$/))return n=La(t,0),n==="0"&&(n=""),n.length>r.length?n:jt(r.substr(0,r.length-n.length))+n;if(i=r.match(Dl))return Id(i,c,l);if(r.match(/^#+0+$/))return l+La(c,r.length-r.indexOf("0"));if(i=r.match(Ll))return n=Cc(t,i[1].length).replace(/^([^\.]+)$/,"$1."+jt(i[1])).replace(/\.$/,"."+jt(i[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+tt("0",jt(i[1]).length-p.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+Cc(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+Zr(La(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+nr(e,r,-t):Zr(""+(Math.floor(t)+Pd(t,i[1].length)))+"."+xr(Ac(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return nr(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ha(nr(e,r.replace(/[\\-]/g,""),t)),s=0,Ha(Ha(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<n.length?n.charAt(s++):m==="0"?"0":""}));if(r.match(Ml))return n=nr(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Ei(c,Math.pow(10,s)-1,!1),n=""+l,f=Lr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=_i(o[2],s),f.length<i[4].length&&(f=jt(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Ei(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qs(o[1],s)+i[2]+"/"+i[3]+_i(o[2],s):tt(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=La(t,0),r.length<=n.length?n:jt(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var u=r.indexOf(".")-s,d=r.length-n.length-u;return jt(r.substr(0,u)+n+r.substr(r.length-d))}if(i=r.match(/^00,000\.([#0]*0)$/))return s=Ac(t,i[1].length),t<0?"-"+nr(e,r,-t):Zr(Nd(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?xr(0,3-m.length):"")+m})+"."+xr(s,i[1].length);switch(r){case"###,##0.00":return nr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Zr(La(c,0));return h!=="0"?l+h:"";case"###,###.00":return nr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return nr(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function Dd(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Lr(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Ld(e,r,t){var a=r.replace(Pl,""),n=r.length-a.length;return Lr(e,a,t*Math.pow(10,2*n))+tt("%",n)}function Ul(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ul(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Er(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Bl)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Er("n",a,t):"("+Er("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Dd(e,r,t);if(r.indexOf("%")!==-1)return Ld(e,r,t);if(r.indexOf("E")!==-1)return Ul(r,t);if(r.charCodeAt(0)===36)return"$"+Er(e,r.substr(r.charAt(1)==" "?2:1),t);var n,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+xr(c,r.length);if(r.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>r.length?n:jt(r.substr(0,r.length-n.length))+n;if(i=r.match(Dl))return Rd(i,c,l);if(r.match(/^#+0+$/))return l+xr(c,r.length-r.indexOf("0"));if(i=r.match(Ll))return n=(""+t).replace(/^([^\.]+)$/,"$1."+jt(i[1])).replace(/\.$/,"."+jt(i[1])),n=n.replace(/\.(\d*)$/,function(m,p){return"."+p+tt("0",jt(i[1]).length-p.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+Zr(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Er(e,r,-t):Zr(""+t)+"."+tt("0",i[1].length);if(i=r.match(/^#,#*,#0/))return Er(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ha(Er(e,r.replace(/[\\-]/g,""),t)),s=0,Ha(Ha(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<n.length?n.charAt(s++):m==="0"?"0":""}));if(r.match(Ml))return n=Er(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Ei(c,Math.pow(10,s)-1,!1),n=""+l,f=Lr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=_i(o[2],s),f.length<i[4].length&&(f=jt(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Ei(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qs(o[1],s)+i[2]+"/"+i[3]+_i(o[2],s):tt(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=""+t,r.length<=n.length?n:jt(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var u=r.indexOf(".")-s,d=r.length-n.length-u;return jt(r.substr(0,u)+n+r.substr(r.length-d))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Er(e,r,-t):Zr(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?xr(0,3-m.length):"")+m})+"."+xr(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Zr(""+c);return h!=="0"?l+h:"";default:if(r.match(/\.[0#?]*$/))return Er(e,r.slice(0,r.lastIndexOf(".")),t)+jt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Lr(e,r,t){return(t|0)===t?Er(e,r,t):nr(e,r,t)}function Bd(e){for(var r=[],t=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n),n=a+1}if(r[r.length]=e.substr(n),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var $l=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ka(e){for(var r=0,t="",a="";r<e.length;)switch(t=e.charAt(r)){case"G":ki(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(a=t;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match($l))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Md(e,r,t,a){for(var n=[],i="",s=0,o="",c="t",l,f,u,d="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!ki(e,s))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(u=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(u);n[n.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),m=h==="("||h===")"?h:"t";n[n.length]={t:m,v:h},++s;break;case"_":n[n.length]={t:"t",v:" "},s+=2;break;case"@":n[n.length]={t:"T",v:r},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(l==null&&(l=da(r,t,e.charAt(s+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=da(r,t),l==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"\u4E0A":var p={t:o,v:o};if(l==null&&(l=da(r,t)),e.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",s+=5,d="h"):e.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(p.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),p.t="T",s+=5,d="h"):(p.t="t",++s),l==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match($l)){if(l==null&&(l=da(r,t),l==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ka(e)||(n[n.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++s;break;case"$":n[n.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++s;break}var g=0,v=0,y;for(s=n.length-1,c="t";s>=0;--s)switch(n[s].t){case"h":case"H":n[s].t=d,c="h",g<1&&(g=1);break;case"s":(y=n[s].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[s].t;break;case"m":c==="s"&&(n[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[s].v.match(/[Hh]/)&&(g=1),g<2&&n[s].v.match(/[Mm]/)&&(g=2),g<3&&n[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var x="",O;for(s=0;s<n.length;++s)switch(n[s].t){case"t":case"T":case" ":case"D":break;case"X":n[s].v="",n[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[s].v=Ad(n[s].t.charCodeAt(0),n[s].v,l,v),n[s].t="t";break;case"n":case"?":for(O=s+1;n[O]!=null&&((o=n[O].t)==="?"||o==="D"||(o===" "||o==="t")&&n[O+1]!=null&&(n[O+1].t==="?"||n[O+1].t==="t"&&n[O+1].v==="/")||n[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[O].v==="/"||n[O].v===" "&&n[O+1]!=null&&n[O+1].t=="?"));)n[s].v+=n[O].v,n[O]={v:"",t:";"},++O;x+=n[s].v,s=O-1;break;case"G":n[s].t="t",n[s].v=xa(r,t);break}var I="",A,k;if(x.length>0){x.charCodeAt(0)==40?(A=r<0&&x.charCodeAt(0)===45?-r:r,k=Lr("n",x,A)):(A=r<0&&a>1?-r:r,k=Lr("n",x,A),A<0&&n[0]&&n[0].t=="t"&&(k=k.substr(1),n[0].v="-"+n[0].v)),O=k.length-1;var D=n.length;for(s=0;s<n.length;++s)if(n[s]!=null&&n[s].t!="t"&&n[s].v.indexOf(".")>-1){D=s;break}var N=n.length;if(D===n.length&&k.indexOf("E")===-1){for(s=n.length-1;s>=0;--s)n[s]==null||"n?".indexOf(n[s].t)===-1||(O>=n[s].v.length-1?(O-=n[s].v.length,n[s].v=k.substr(O+1,n[s].v.length)):O<0?n[s].v="":(n[s].v=k.substr(0,O+1),O=-1),n[s].t="t",N=s);O>=0&&N<n.length&&(n[N].v=k.substr(0,O+1)+n[N].v)}else if(D!==n.length&&k.indexOf("E")===-1){for(O=k.indexOf(".")-1,s=D;s>=0;--s)if(!(n[s]==null||"n?".indexOf(n[s].t)===-1)){for(f=n[s].v.indexOf(".")>-1&&s===D?n[s].v.indexOf(".")-1:n[s].v.length-1,I=n[s].v.substr(f+1);f>=0;--f)O>=0&&(n[s].v.charAt(f)==="0"||n[s].v.charAt(f)==="#")&&(I=k.charAt(O--)+I);n[s].v=I,n[s].t="t",N=s}for(O>=0&&N<n.length&&(n[N].v=k.substr(0,O+1)+n[N].v),O=k.indexOf(".")+1,s=D;s<n.length;++s)if(!(n[s]==null||"n?(".indexOf(n[s].t)===-1&&s!==D)){for(f=n[s].v.indexOf(".")>-1&&s===D?n[s].v.indexOf(".")+1:0,I=n[s].v.substr(0,f);f<n[s].v.length;++f)O<k.length&&(I+=k.charAt(O++));n[s].v=I,n[s].t="t",N=s}}}for(s=0;s<n.length;++s)n[s]!=null&&"n?".indexOf(n[s].t)>-1&&(A=a>1&&r<0&&s>0&&n[s-1].v==="-"?-r:r,n[s].v=Lr(n[s].t,n[s].v,A),n[s].t="t");var M="";for(s=0;s!==n.length;++s)n[s]!=null&&(M+=n[s].v);return M}var Oc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Fc(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Ud(e,r){var t=Bd(e),a=t.length,n=t[a-1].indexOf("@");if(a<4&&n>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(Oc),o=t[1].match(Oc);return Fc(r,s)?[a,t[0]]:Fc(r,o)?[a,t[1]]:[a,t[s!=null&&o!=null?2:1]]}return[a,i]}function fr(e,r,t){t==null&&(t={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?a=t.dateNF:a=e;break;case"number":e==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:xe)[e],a==null&&(a=t.table&&t.table[bc[e]]||xe[bc[e]]),a==null&&(a=_d[e]||"General");break}if(ki(a,0))return xa(r,t);r instanceof Date&&(r=Rl(r,t.date1904));var n=Ud(a,r);if(ki(n[1]))return xa(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Md(n[1],r,t,n[0])}function Br(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(xe[t]==null){r<0&&(r=t);continue}if(xe[t]==e){r=t;break}}r<0&&(r=391)}return xe[r]=e,r}function Di(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Br(e[r],r)}function Ja(){xe=wd()}var $d={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},jl=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function jd(e){var r=typeof e=="number"?xe[e]:e;return r=r.replace(jl,"(\\d+)"),new RegExp("^"+r+"$")}function Hd(e,r,t){var a=-1,n=-1,i=-1,s=-1,o=-1,c=-1;(r.match(jl)||[]).forEach(function(u,d){var h=parseInt(t[d+1],10);switch(u.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?o=h:n=h;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?l:a==-1&&n==-1&&i==-1?f:l+"T"+f}var Vd=(function(){var e={};e.version="1.2.0";function r(){for(var k=0,D=new Array(256),N=0;N!=256;++N)k=N,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,D[N]=k;return typeof Int32Array!="undefined"?new Int32Array(D):D}var t=r();function a(k){var D=0,N=0,M=0,G=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)G[M]=k[M];for(M=0;M!=256;++M)for(N=k[M],D=256+M;D<4096;D+=256)N=G[D]=N>>>8^k[N&255];var L=[];for(M=1;M!=16;++M)L[M-1]=typeof Int32Array!="undefined"?G.subarray(M*256,M*256+256):G.slice(M*256,M*256+256);return L}var n=a(t),i=n[0],s=n[1],o=n[2],c=n[3],l=n[4],f=n[5],u=n[6],d=n[7],h=n[8],m=n[9],p=n[10],g=n[11],v=n[12],y=n[13],x=n[14];function O(k,D){for(var N=D^-1,M=0,G=k.length;M<G;)N=N>>>8^t[(N^k.charCodeAt(M++))&255];return~N}function I(k,D){for(var N=D^-1,M=k.length-15,G=0;G<M;)N=x[k[G++]^N&255]^y[k[G++]^N>>8&255]^v[k[G++]^N>>16&255]^g[k[G++]^N>>>24]^p[k[G++]]^m[k[G++]]^h[k[G++]]^d[k[G++]]^u[k[G++]]^f[k[G++]]^l[k[G++]]^c[k[G++]]^o[k[G++]]^s[k[G++]]^i[k[G++]]^t[k[G++]];for(M+=15;G<M;)N=N>>>8^t[(N^k[G++])&255];return~N}function A(k,D){for(var N=D^-1,M=0,G=k.length,L=0,ee=0;M<G;)L=k.charCodeAt(M++),L<128?N=N>>>8^t[(N^L)&255]:L<2048?(N=N>>>8^t[(N^(192|L>>6&31))&255],N=N>>>8^t[(N^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,ee=k.charCodeAt(M++)&1023,N=N>>>8^t[(N^(240|L>>8&7))&255],N=N>>>8^t[(N^(128|L>>2&63))&255],N=N>>>8^t[(N^(128|ee>>6&15|(L&3)<<4))&255],N=N>>>8^t[(N^(128|ee&63))&255]):(N=N>>>8^t[(N^(224|L>>12&15))&255],N=N>>>8^t[(N^(128|L>>6&63))&255],N=N>>>8^t[(N^(128|L&63))&255]);return~N}return e.table=t,e.bstr=O,e.buf=I,e.str=A,e})(),me=(function(){var r={};r.version="1.2.1";function t(w,S){for(var _=w.split("/"),E=S.split("/"),T=0,b=0,U=Math.min(_.length,E.length);T<U;++T){if(b=_[T].length-E[T].length)return b;if(_[T]!=E[T])return _[T]<E[T]?-1:1}return _.length-E.length}function a(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:a(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(0,S+1)}function n(w){if(w.charAt(w.length-1)=="/")return n(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(S+1)}function i(w,S){typeof S=="string"&&(S=new Date(S));var _=S.getHours();_=_<<6|S.getMinutes(),_=_<<5|S.getSeconds()>>>1,w.write_shift(2,_);var E=S.getFullYear()-1980;E=E<<4|S.getMonth()+1,E=E<<5|S.getDate(),w.write_shift(2,E)}function s(w){var S=w.read_shift(2)&65535,_=w.read_shift(2)&65535,E=new Date,T=_&31;_>>>=5;var b=_&15;_>>>=4,E.setMilliseconds(0),E.setFullYear(_+1980),E.setMonth(b-1),E.setDate(T);var U=S&31;S>>>=5;var Y=S&63;return S>>>=6,E.setHours(S),E.setMinutes(Y),E.setSeconds(U<<1),E}function o(w){bt(w,0);for(var S={},_=0;w.l<=w.length-4;){var E=w.read_shift(2),T=w.read_shift(2),b=w.l+T,U={};switch(E){case 21589:_=w.read_shift(1),_&1&&(U.mtime=w.read_shift(4)),T>5&&(_&2&&(U.atime=w.read_shift(4)),_&4&&(U.ctime=w.read_shift(4))),U.mtime&&(U.mt=new Date(U.mtime*1e3));break}w.l=b,S[E]=U}return S}var c;function l(){return c||(c={})}function f(w,S){if(w[0]==80&&w[1]==75)return ic(w,S);if((w[0]|32)==109&&(w[1]|32)==105)return Lu(w,S);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var _=3,E=512,T=0,b=0,U=0,Y=0,H=0,j=[],W=w.slice(0,512);bt(W,0);var Q=u(W);switch(_=Q[0],_){case 3:E=512;break;case 4:E=4096;break;case 0:if(Q[1]==0)return ic(w,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+_)}E!==512&&(W=w.slice(0,E),bt(W,28));var se=w.slice(0,E);d(W,_);var he=W.read_shift(4,"i");if(_===3&&he!==0)throw new Error("# Directory Sectors: Expected 0 saw "+he);W.l+=4,U=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),Y=W.read_shift(4,"i"),T=W.read_shift(4,"i"),H=W.read_shift(4,"i"),b=W.read_shift(4,"i");for(var oe=-1,le=0;le<109&&(oe=W.read_shift(4,"i"),!(oe<0));++le)j[le]=oe;var _e=h(w,E);g(H,b,_e,E,j);var Ye=y(_e,U,j,E);Ye[U].name="!Directory",T>0&&Y!==ee&&(Ye[Y].name="!MiniFAT"),Ye[j[0]].name="!FAT",Ye.fat_addrs=j,Ye.ssz=E;var Wt={},dt=[],qt=[],ln=[];x(U,Ye,_e,dt,T,Wt,qt,Y),m(qt,ln,dt),dt.shift();var fn={FileIndex:qt,FullPaths:ln};return S&&S.raw&&(fn.raw={header:se,sectors:_e}),fn}function u(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(fe,"Header Signature: "),w.l+=16;var S=w.read_shift(2,"u");return[w.read_shift(2,"u"),S]}function d(w,S){var _=9;switch(w.l+=2,_=w.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+_);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+_);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+_)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function h(w,S){for(var _=Math.ceil(w.length/S)-1,E=[],T=1;T<_;++T)E[T-1]=w.slice(T*S,(T+1)*S);return E[_-1]=w.slice(_*S),E}function m(w,S,_){for(var E=0,T=0,b=0,U=0,Y=0,H=_.length,j=[],W=[];E<H;++E)j[E]=W[E]=E,S[E]=_[E];for(;Y<W.length;++Y)E=W[Y],T=w[E].L,b=w[E].R,U=w[E].C,j[E]===E&&(T!==-1&&j[T]!==T&&(j[E]=j[T]),b!==-1&&j[b]!==b&&(j[E]=j[b])),U!==-1&&(j[U]=E),T!==-1&&E!=j[E]&&(j[T]=j[E],W.lastIndexOf(T)<Y&&W.push(T)),b!==-1&&E!=j[E]&&(j[b]=j[E],W.lastIndexOf(b)<Y&&W.push(b));for(E=1;E<H;++E)j[E]===E&&(b!==-1&&j[b]!==b?j[E]=j[b]:T!==-1&&j[T]!==T&&(j[E]=j[T]));for(E=1;E<H;++E)if(w[E].type!==0){if(Y=E,Y!=j[Y])do Y=j[Y],S[E]=S[Y]+"/"+S[E];while(Y!==0&&j[Y]!==-1&&Y!=j[Y]);j[E]=-1}for(S[0]+="/",E=1;E<H;++E)w[E].type!==2&&(S[E]+="/")}function p(w,S,_){for(var E=w.start,T=w.size,b=[],U=E;_&&T>0&&U>=0;)b.push(S.slice(U*L,U*L+L)),T-=L,U=ua(_,U*4);return b.length===0?X(0):Et(b).slice(0,w.size)}function g(w,S,_,E,T){var b=ee;if(w===ee){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var U=_[w],Y=(E>>>2)-1;if(!U)return;for(var H=0;H<Y&&(b=ua(U,H*4))!==ee;++H)T.push(b);g(ua(U,E-4),S-1,_,E,T)}}function v(w,S,_,E,T){var b=[],U=[];T||(T=[]);var Y=E-1,H=0,j=0;for(H=S;H>=0;){T[H]=!0,b[b.length]=H,U.push(w[H]);var W=_[Math.floor(H*4/E)];if(j=H*4&Y,E<4+j)throw new Error("FAT boundary crossed: "+H+" 4 "+E);if(!w[W])break;H=ua(w[W],j)}return{nodes:b,data:Hc([U])}}function y(w,S,_,E){var T=w.length,b=[],U=[],Y=[],H=[],j=E-1,W=0,Q=0,se=0,he=0;for(W=0;W<T;++W)if(Y=[],se=W+S,se>=T&&(se-=T),!U[se]){H=[];var oe=[];for(Q=se;Q>=0;){oe[Q]=!0,U[Q]=!0,Y[Y.length]=Q,H.push(w[Q]);var le=_[Math.floor(Q*4/E)];if(he=Q*4&j,E<4+he)throw new Error("FAT boundary crossed: "+Q+" 4 "+E);if(!w[le]||(Q=ua(w[le],he),oe[Q]))break}b[se]={nodes:Y,data:Hc([H])}}return b}function x(w,S,_,E,T,b,U,Y){for(var H=0,j=E.length?2:0,W=S[w].data,Q=0,se=0,he;Q<W.length;Q+=128){var oe=W.slice(Q,Q+128);bt(oe,64),se=oe.read_shift(2),he=Ui(oe,0,se-j),E.push(he);var le={name:he,type:oe.read_shift(1),color:oe.read_shift(1),L:oe.read_shift(4,"i"),R:oe.read_shift(4,"i"),C:oe.read_shift(4,"i"),clsid:oe.read_shift(16),state:oe.read_shift(4,"i"),start:0,size:0},_e=oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2);_e!==0&&(le.ct=O(oe,oe.l-8));var Ye=oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2);Ye!==0&&(le.mt=O(oe,oe.l-8)),le.start=oe.read_shift(4,"i"),le.size=oe.read_shift(4,"i"),le.size<0&&le.start<0&&(le.size=le.type=0,le.start=ee,le.name=""),le.type===5?(H=le.start,T>0&&H!==ee&&(S[H].name="!StreamData")):le.size>=4096?(le.storage="fat",S[le.start]===void 0&&(S[le.start]=v(_,le.start,S.fat_addrs,S.ssz)),S[le.start].name=le.name,le.content=S[le.start].data.slice(0,le.size)):(le.storage="minifat",le.size<0?le.size=0:H!==ee&&le.start!==ee&&S[H]&&(le.content=p(le,S[H].data,(S[Y]||{}).data))),le.content&&bt(le.content,0),b[he]=le,U.push(le)}}function O(w,S){return new Date((kt(w,S+4)/1e7*Math.pow(2,32)+kt(w,S)/1e7-11644473600)*1e3)}function I(w,S){return l(),f(c.readFileSync(w),S)}function A(w,S){var _=S&&S.type;switch(_||Ae&&Buffer.isBuffer(w)&&(_="buffer"),_||"base64"){case"file":return I(w,S);case"base64":return f(Jt(Qt(w)),S);case"binary":return f(Jt(w),S)}return f(w,S)}function k(w,S){var _=S||{},E=_.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=E+"/",w.FileIndex[0]={name:E,type:5}),_.CLSID&&(w.FileIndex[0].clsid=_.CLSID),D(w)}function D(w){var S="Sh33tJ5";if(!me.find(w,"/"+S)){var _=X(4);_[0]=55,_[1]=_[3]=50,_[2]=54,w.FileIndex.push({name:S,type:2,content:_,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+S),N(w)}}function N(w,S){k(w);for(var _=!1,E=!1,T=w.FullPaths.length-1;T>=0;--T){var b=w.FileIndex[T];switch(b.type){case 0:E?_=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(b.R*b.L*b.C)&&(_=!0),b.R>-1&&b.L>-1&&b.R==b.L&&(_=!0);break;default:_=!0;break}}if(!(!_&&!S)){var U=new Date(1987,1,19),Y=0,H=Object.create?Object.create(null):{},j=[];for(T=0;T<w.FullPaths.length;++T)H[w.FullPaths[T]]=!0,w.FileIndex[T].type!==0&&j.push([w.FullPaths[T],w.FileIndex[T]]);for(T=0;T<j.length;++T){var W=a(j[T][0]);E=H[W],E||(j.push([W,{name:n(W).replace("/",""),type:1,clsid:pe,ct:U,mt:U,content:null}]),H[W]=!0)}for(j.sort(function(he,oe){return t(he[0],oe[0])}),w.FullPaths=[],w.FileIndex=[],T=0;T<j.length;++T)w.FullPaths[T]=j[T][0],w.FileIndex[T]=j[T][1];for(T=0;T<j.length;++T){var Q=w.FileIndex[T],se=w.FullPaths[T];if(Q.name=n(se).replace("/",""),Q.L=Q.R=Q.C=-(Q.color=1),Q.size=Q.content?Q.content.length:0,Q.start=0,Q.clsid=Q.clsid||pe,T===0)Q.C=j.length>1?1:-1,Q.size=0,Q.type=5;else if(se.slice(-1)=="/"){for(Y=T+1;Y<j.length&&a(w.FullPaths[Y])!=se;++Y);for(Q.C=Y>=j.length?-1:Y,Y=T+1;Y<j.length&&a(w.FullPaths[Y])!=a(se);++Y);Q.R=Y>=j.length?-1:Y,Q.type=1}else a(w.FullPaths[T+1]||"")==a(se)&&(Q.R=T+1),Q.type=2}}}function M(w,S){var _=S||{};if(_.fileType=="mad")return Bu(w,_);switch(N(w),_.fileType){case"zip":return Fu(w,_)}var E=(function(he){for(var oe=0,le=0,_e=0;_e<he.FileIndex.length;++_e){var Ye=he.FileIndex[_e];if(Ye.content){var Wt=Ye.content.length;Wt>0&&(Wt<4096?oe+=Wt+63>>6:le+=Wt+511>>9)}}for(var dt=he.FullPaths.length+3>>2,qt=oe+7>>3,ln=oe+127>>7,fn=qt+le+dt+ln,fa=fn+127>>7,is=fa<=109?0:Math.ceil((fa-109)/127);fn+fa+is+127>>7>fa;)is=++fa<=109?0:Math.ceil((fa-109)/127);var Nr=[1,is,fa,ln,dt,le,oe,0];return he.FileIndex[0].size=oe<<6,Nr[7]=(he.FileIndex[0].start=Nr[0]+Nr[1]+Nr[2]+Nr[3]+Nr[4]+Nr[5])+(Nr[6]+7>>3),Nr})(w),T=X(E[7]<<9),b=0,U=0;{for(b=0;b<8;++b)T.write_shift(1,Z[b]);for(b=0;b<8;++b)T.write_shift(2,0);for(T.write_shift(2,62),T.write_shift(2,3),T.write_shift(2,65534),T.write_shift(2,9),T.write_shift(2,6),b=0;b<3;++b)T.write_shift(2,0);for(T.write_shift(4,0),T.write_shift(4,E[2]),T.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),T.write_shift(4,0),T.write_shift(4,4096),T.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:ee),T.write_shift(4,E[3]),T.write_shift(-4,E[1]?E[0]-1:ee),T.write_shift(4,E[1]),b=0;b<109;++b)T.write_shift(-4,b<E[2]?E[1]+b:-1)}if(E[1])for(U=0;U<E[1];++U){for(;b<236+U*127;++b)T.write_shift(-4,b<E[2]?E[1]+b:-1);T.write_shift(-4,U===E[1]-1?ee:U+1)}var Y=function(he){for(U+=he;b<U-1;++b)T.write_shift(-4,b+1);he&&(++b,T.write_shift(-4,ee))};for(U=b=0,U+=E[1];b<U;++b)T.write_shift(-4,J.DIFSECT);for(U+=E[2];b<U;++b)T.write_shift(-4,J.FATSECT);Y(E[3]),Y(E[4]);for(var H=0,j=0,W=w.FileIndex[0];H<w.FileIndex.length;++H)W=w.FileIndex[H],W.content&&(j=W.content.length,!(j<4096)&&(W.start=U,Y(j+511>>9)));for(Y(E[6]+7>>3);T.l&511;)T.write_shift(-4,J.ENDOFCHAIN);for(U=b=0,H=0;H<w.FileIndex.length;++H)W=w.FileIndex[H],W.content&&(j=W.content.length,!(!j||j>=4096)&&(W.start=U,Y(j+63>>6)));for(;T.l&511;)T.write_shift(-4,J.ENDOFCHAIN);for(b=0;b<E[4]<<2;++b){var Q=w.FullPaths[b];if(!Q||Q.length===0){for(H=0;H<17;++H)T.write_shift(4,0);for(H=0;H<3;++H)T.write_shift(4,-1);for(H=0;H<12;++H)T.write_shift(4,0);continue}W=w.FileIndex[b],b===0&&(W.start=W.size?W.start-1:ee);var se=b===0&&_.root||W.name;if(j=2*(se.length+1),T.write_shift(64,se,"utf16le"),T.write_shift(2,j),T.write_shift(1,W.type),T.write_shift(1,W.color),T.write_shift(-4,W.L),T.write_shift(-4,W.R),T.write_shift(-4,W.C),W.clsid)T.write_shift(16,W.clsid,"hex");else for(H=0;H<4;++H)T.write_shift(4,0);T.write_shift(4,W.state||0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,W.start),T.write_shift(4,W.size),T.write_shift(4,0)}for(b=1;b<w.FileIndex.length;++b)if(W=w.FileIndex[b],W.size>=4096)if(T.l=W.start+1<<9,Ae&&Buffer.isBuffer(W.content))W.content.copy(T,T.l,0,W.size),T.l+=W.size+511&-512;else{for(H=0;H<W.size;++H)T.write_shift(1,W.content[H]);for(;H&511;++H)T.write_shift(1,0)}for(b=1;b<w.FileIndex.length;++b)if(W=w.FileIndex[b],W.size>0&&W.size<4096)if(Ae&&Buffer.isBuffer(W.content))W.content.copy(T,T.l,0,W.size),T.l+=W.size+63&-64;else{for(H=0;H<W.size;++H)T.write_shift(1,W.content[H]);for(;H&63;++H)T.write_shift(1,0)}if(Ae)T.l=T.length;else for(;T.l<T.length;)T.write_shift(1,0);return T}function G(w,S){var _=w.FullPaths.map(function(H){return H.toUpperCase()}),E=_.map(function(H){var j=H.split("/");return j[j.length-(H.slice(-1)=="/"?2:1)]}),T=!1;S.charCodeAt(0)===47?(T=!0,S=_[0].slice(0,-1)+S):T=S.indexOf("/")!==-1;var b=S.toUpperCase(),U=T===!0?_.indexOf(b):E.indexOf(b);if(U!==-1)return w.FileIndex[U];var Y=!b.match(vn);for(b=b.replace(Dt,""),Y&&(b=b.replace(vn,"!")),U=0;U<_.length;++U)if((Y?_[U].replace(vn,"!"):_[U]).replace(Dt,"")==b||(Y?E[U].replace(vn,"!"):E[U]).replace(Dt,"")==b)return w.FileIndex[U];return null}var L=64,ee=-2,fe="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],pe="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(w,S,_){l();var E=M(w,_);c.writeFileSync(S,E)}function te(w){for(var S=new Array(w.length),_=0;_<w.length;++_)S[_]=String.fromCharCode(w[_]);return S.join("")}function ue(w,S){var _=M(w,S);switch(S&&S.type||"buffer"){case"file":return l(),c.writeFileSync(S.filename,_),_;case"binary":return typeof _=="string"?_:te(_);case"base64":return On(typeof _=="string"?_:te(_));case"buffer":if(Ae)return Buffer.isBuffer(_)?_:$r(_);case"array":return typeof _=="string"?Jt(_):_}return _}var V;function C(w){try{var S=w.InflateRaw,_=new S;if(_._processChunk(new Uint8Array([3,0]),_._finishFlushFlag),_.bytesRead)V=w;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function B(w,S){if(!V)return ac(w,S);var _=V.InflateRaw,E=new _,T=E._processChunk(w.slice(w.l),E._finishFlushFlag);return w.l+=E.bytesRead,T}function R(w){return V?V.deflateRawSync(w):Oe(w)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function re(w){var S=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(S>>16|S>>8|S)&255}for(var ae=typeof Uint8Array!="undefined",q=ae?new Uint8Array(256):[],ke=0;ke<256;++ke)q[ke]=re(ke);function F(w,S){var _=q[w&255];return S<=8?_>>>8-S:(_=_<<8|q[w>>8&255],S<=16?_>>>16-S:(_=_<<8|q[w>>16&255],_>>>24-S))}function je(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=6?0:w[E+1]<<8))>>>_&3}function Ie(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=5?0:w[E+1]<<8))>>>_&7}function He(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=4?0:w[E+1]<<8))>>>_&15}function Re(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=3?0:w[E+1]<<8))>>>_&31}function de(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=1?0:w[E+1]<<8))>>>_&127}function st(w,S,_){var E=S&7,T=S>>>3,b=(1<<_)-1,U=w[T]>>>E;return _<8-E||(U|=w[T+1]<<8-E,_<16-E)||(U|=w[T+2]<<16-E,_<24-E)||(U|=w[T+3]<<24-E),U&b}function tr(w,S,_){var E=S&7,T=S>>>3;return E<=5?w[T]|=(_&7)<<E:(w[T]|=_<<E&255,w[T+1]=(_&7)>>8-E),S+3}function wr(w,S,_){var E=S&7,T=S>>>3;return _=(_&1)<<E,w[T]|=_,S+1}function Rr(w,S,_){var E=S&7,T=S>>>3;return _<<=E,w[T]|=_&255,_>>>=8,w[T+1]=_,S+8}function on(w,S,_){var E=S&7,T=S>>>3;return _<<=E,w[T]|=_&255,_>>>=8,w[T+1]=_&255,w[T+2]=_>>>8,S+16}function Xr(w,S){var _=w.length,E=2*_>S?2*_:S+5,T=0;if(_>=S)return w;if(Ae){var b=Ec(E);if(w.copy)w.copy(b);else for(;T<w.length;++T)b[T]=w[T];return b}else if(ae){var U=new Uint8Array(E);if(U.set)U.set(w);else for(;T<_;++T)U[T]=w[T];return U}return w.length=E,w}function Yt(w){for(var S=new Array(w),_=0;_<w;++_)S[_]=0;return S}function Pr(w,S,_){var E=1,T=0,b=0,U=0,Y=0,H=w.length,j=ae?new Uint16Array(32):Yt(32);for(b=0;b<32;++b)j[b]=0;for(b=H;b<_;++b)w[b]=0;H=w.length;var W=ae?new Uint16Array(H):Yt(H);for(b=0;b<H;++b)j[T=w[b]]++,E<T&&(E=T),W[b]=0;for(j[0]=0,b=1;b<=E;++b)j[b+16]=Y=Y+j[b-1]<<1;for(b=0;b<H;++b)Y=w[b],Y!=0&&(W[b]=j[Y+16]++);var Q=0;for(b=0;b<H;++b)if(Q=w[b],Q!=0)for(Y=F(W[b],E)>>E-Q,U=(1<<E+4-Q)-1;U>=0;--U)S[Y|U<<Q]=Q&15|b<<4;return E}var Yr=ae?new Uint16Array(512):Yt(512),cn=ae?new Uint16Array(32):Yt(32);if(!ae){for(var Ut=0;Ut<512;++Ut)Yr[Ut]=0;for(Ut=0;Ut<32;++Ut)cn[Ut]=0}(function(){for(var w=[],S=0;S<32;S++)w.push(5);Pr(w,cn,32);var _=[];for(S=0;S<=143;S++)_.push(8);for(;S<=255;S++)_.push(9);for(;S<=279;S++)_.push(7);for(;S<=287;S++)_.push(8);Pr(_,Yr,288)})();var _r=(function(){for(var S=ae?new Uint8Array(32768):[],_=0,E=0;_<ce.length-1;++_)for(;E<ce[_+1];++E)S[E]=_;for(;E<32768;++E)S[E]=29;var T=ae?new Uint8Array(259):[];for(_=0,E=0;_<z.length-1;++_)for(;E<z[_+1];++E)T[E]=_;function b(Y,H){for(var j=0;j<Y.length;){var W=Math.min(65535,Y.length-j),Q=j+W==Y.length;for(H.write_shift(1,+Q),H.write_shift(2,W),H.write_shift(2,~W&65535);W-- >0;)H[H.l++]=Y[j++]}return H.l}function U(Y,H){for(var j=0,W=0,Q=ae?new Uint16Array(32768):[];W<Y.length;){var se=Math.min(65535,Y.length-W);if(se<10){for(j=tr(H,j,+(W+se==Y.length)),j&7&&(j+=8-(j&7)),H.l=j/8|0,H.write_shift(2,se),H.write_shift(2,~se&65535);se-- >0;)H[H.l++]=Y[W++];j=H.l*8;continue}j=tr(H,j,+(W+se==Y.length)+2);for(var he=0;se-- >0;){var oe=Y[W];he=(he<<5^oe)&32767;var le=-1,_e=0;if((le=Q[he])&&(le|=W&-32768,le>W&&(le-=32768),le<W))for(;Y[le+_e]==Y[W+_e]&&_e<250;)++_e;if(_e>2){oe=T[_e],oe<=22?j=Rr(H,j,q[oe+1]>>1)-1:(Rr(H,j,3),j+=5,Rr(H,j,q[oe-23]>>5),j+=3);var Ye=oe<8?0:oe-4>>2;Ye>0&&(on(H,j,_e-z[oe]),j+=Ye),oe=S[W-le],j=Rr(H,j,q[oe]>>3),j-=3;var Wt=oe<4?0:oe-2>>1;Wt>0&&(on(H,j,W-le-ce[oe]),j+=Wt);for(var dt=0;dt<_e;++dt)Q[he]=W&32767,he=(he<<5^Y[W])&32767,++W;se-=_e-1}else oe<=143?oe=oe+48:j=wr(H,j,1),j=Rr(H,j,q[oe]),Q[he]=W&32767,++W}j=Rr(H,j,0)-1}return H.l=(j+7)/8|0,H.l}return function(H,j){return H.length<8?b(H,j):U(H,j)}})();function Oe(w){var S=X(50+Math.floor(w.length*1.1)),_=_r(w,S);return S.slice(0,_)}var ot=ae?new Uint16Array(32768):Yt(32768),rr=ae?new Uint16Array(32768):Yt(32768),gt=ae?new Uint16Array(128):Yt(128),la=1,rc=1;function Cu(w,S){var _=Re(w,S)+257;S+=5;var E=Re(w,S)+1;S+=5;var T=He(w,S)+4;S+=4;for(var b=0,U=ae?new Uint8Array(19):Yt(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=1,j=ae?new Uint8Array(8):Yt(8),W=ae?new Uint8Array(8):Yt(8),Q=U.length,se=0;se<T;++se)U[P[se]]=b=Ie(w,S),H<b&&(H=b),j[b]++,S+=3;var he=0;for(j[0]=0,se=1;se<=H;++se)W[se]=he=he+j[se-1]<<1;for(se=0;se<Q;++se)(he=U[se])!=0&&(Y[se]=W[he]++);var oe=0;for(se=0;se<Q;++se)if(oe=U[se],oe!=0){he=q[Y[se]]>>8-oe;for(var le=(1<<7-oe)-1;le>=0;--le)gt[he|le<<oe]=oe&7|se<<3}var _e=[];for(H=1;_e.length<_+E;)switch(he=gt[de(w,S)],S+=he&7,he>>>=3){case 16:for(b=3+je(w,S),S+=2,he=_e[_e.length-1];b-- >0;)_e.push(he);break;case 17:for(b=3+Ie(w,S),S+=3;b-- >0;)_e.push(0);break;case 18:for(b=11+de(w,S),S+=7;b-- >0;)_e.push(0);break;default:_e.push(he),H<he&&(H=he);break}var Ye=_e.slice(0,_),Wt=_e.slice(_);for(se=_;se<286;++se)Ye[se]=0;for(se=E;se<30;++se)Wt[se]=0;return la=Pr(Ye,ot,286),rc=Pr(Wt,rr,30),S}function Au(w,S){if(w[0]==3&&!(w[1]&3))return[Qr(S),2];for(var _=0,E=0,T=Ec(S||1<<18),b=0,U=T.length>>>0,Y=0,H=0;(E&1)==0;){if(E=Ie(w,_),_+=3,E>>>1)E>>1==1?(Y=9,H=5):(_=Cu(w,_),Y=la,H=rc);else{_&7&&(_+=8-(_&7));var j=w[_>>>3]|w[(_>>>3)+1]<<8;if(_+=32,j>0)for(!S&&U<b+j&&(T=Xr(T,b+j),U=T.length);j-- >0;)T[b++]=w[_>>>3],_+=8;continue}for(;;){!S&&U<b+32767&&(T=Xr(T,b+32767),U=T.length);var W=st(w,_,Y),Q=E>>>1==1?Yr[W]:ot[W];if(_+=Q&15,Q>>>=4,(Q>>>8&255)===0)T[b++]=Q;else{if(Q==256)break;Q-=257;var se=Q<8?0:Q-4>>2;se>5&&(se=0);var he=b+z[Q];se>0&&(he+=st(w,_,se),_+=se),W=st(w,_,H),Q=E>>>1==1?cn[W]:rr[W],_+=Q&15,Q>>>=4;var oe=Q<4?0:Q-2>>1,le=ce[Q];for(oe>0&&(le+=st(w,_,oe),_+=oe),!S&&U<he&&(T=Xr(T,he+100),U=T.length);b<he;)T[b]=T[b-le],++b}}}return S?[T,_+7>>>3]:[T.slice(0,b),_+7>>>3]}function ac(w,S){var _=w.slice(w.l||0),E=Au(_,S);return w.l+=E[1],E[0]}function nc(w,S){if(w)typeof console!="undefined"&&console.error(S);else throw new Error(S)}function ic(w,S){var _=w;bt(_,0);var E=[],T=[],b={FileIndex:E,FullPaths:T};k(b,{root:S.root});for(var U=_.length-4;(_[U]!=80||_[U+1]!=75||_[U+2]!=5||_[U+3]!=6)&&U>=0;)--U;_.l=U+4,_.l+=4;var Y=_.read_shift(2);_.l+=6;var H=_.read_shift(4);for(_.l=H,U=0;U<Y;++U){_.l+=20;var j=_.read_shift(4),W=_.read_shift(4),Q=_.read_shift(2),se=_.read_shift(2),he=_.read_shift(2);_.l+=8;var oe=_.read_shift(4),le=o(_.slice(_.l+Q,_.l+Q+se));_.l+=Q+se+he;var _e=_.l;_.l=oe+4,Ou(_,j,W,b,le),_.l=_e}return b}function Ou(w,S,_,E,T){w.l+=2;var b=w.read_shift(2),U=w.read_shift(2),Y=s(w);if(b&8257)throw new Error("Unsupported ZIP encryption");for(var H=w.read_shift(4),j=w.read_shift(4),W=w.read_shift(4),Q=w.read_shift(2),se=w.read_shift(2),he="",oe=0;oe<Q;++oe)he+=String.fromCharCode(w[w.l++]);if(se){var le=o(w.slice(w.l,w.l+se));(le[21589]||{}).mt&&(Y=le[21589].mt),((T||{})[21589]||{}).mt&&(Y=T[21589].mt)}w.l+=se;var _e=w.slice(w.l,w.l+j);switch(U){case 8:_e=B(w,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+U)}var Ye=!1;b&8&&(H=w.read_shift(4),H==134695760&&(H=w.read_shift(4),Ye=!0),j=w.read_shift(4),W=w.read_shift(4)),j!=S&&nc(Ye,"Bad compressed size: "+S+" != "+j),W!=_&&nc(Ye,"Bad uncompressed size: "+_+" != "+W),ns(E,he,_e,{unsafe:!0,mt:Y})}function Fu(w,S){var _=S||{},E=[],T=[],b=X(1),U=_.compression?8:0,Y=0,H=!1;H&&(Y|=8);var j=0,W=0,Q=0,se=0,he=w.FullPaths[0],oe=he,le=w.FileIndex[0],_e=[],Ye=0;for(j=1;j<w.FullPaths.length;++j)if(oe=w.FullPaths[j].slice(he.length),le=w.FileIndex[j],!(!le.size||!le.content||oe=="Sh33tJ5")){var Wt=Q,dt=X(oe.length);for(W=0;W<oe.length;++W)dt.write_shift(1,oe.charCodeAt(W)&127);dt=dt.slice(0,dt.l),_e[se]=Vd.buf(le.content,0);var qt=le.content;U==8&&(qt=R(qt)),b=X(30),b.write_shift(4,67324752),b.write_shift(2,20),b.write_shift(2,Y),b.write_shift(2,U),le.mt?i(b,le.mt):b.write_shift(4,0),b.write_shift(-4,Y&8?0:_e[se]),b.write_shift(4,Y&8?0:qt.length),b.write_shift(4,Y&8?0:le.content.length),b.write_shift(2,dt.length),b.write_shift(2,0),Q+=b.length,E.push(b),Q+=dt.length,E.push(dt),Q+=qt.length,E.push(qt),Y&8&&(b=X(12),b.write_shift(-4,_e[se]),b.write_shift(4,qt.length),b.write_shift(4,le.content.length),Q+=b.l,E.push(b)),b=X(46),b.write_shift(4,33639248),b.write_shift(2,0),b.write_shift(2,20),b.write_shift(2,Y),b.write_shift(2,U),b.write_shift(4,0),b.write_shift(-4,_e[se]),b.write_shift(4,qt.length),b.write_shift(4,le.content.length),b.write_shift(2,dt.length),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(4,0),b.write_shift(4,Wt),Ye+=b.l,T.push(b),Ye+=dt.length,T.push(dt),++se}return b=X(22),b.write_shift(4,101010256),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,se),b.write_shift(2,se),b.write_shift(4,Ye),b.write_shift(4,Q),b.write_shift(2,0),Et([Et(E),Et(T),b])}var ai={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Iu(w,S){if(w.ctype)return w.ctype;var _=w.name||"",E=_.match(/\.([^\.]+)$/);return E&&ai[E[1]]||S&&(E=(_=S).match(/[\.\\]([^\.\\])+$/),E&&ai[E[1]])?ai[E[1]]:"application/octet-stream"}function Ru(w){for(var S=On(w),_=[],E=0;E<S.length;E+=76)_.push(S.slice(E,E+76));return _.join(`\r
`)+`\r
`}function Pu(w){var S=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(j){var W=j.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var _=[],E=S.split(`\r
`),T=0;T<E.length;++T){var b=E[T];if(b.length==0){_.push("");continue}for(var U=0;U<b.length;){var Y=76,H=b.slice(U,U+Y);H.charAt(Y-1)=="="?Y--:H.charAt(Y-2)=="="?Y-=2:H.charAt(Y-3)=="="&&(Y-=3),H=b.slice(U,U+Y),U+=Y,U<b.length&&(H+="="),_.push(H)}}return _.join(`\r
`)}function Nu(w){for(var S=[],_=0;_<w.length;++_){for(var E=w[_];_<=w.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+w[++_];S.push(E)}for(var T=0;T<S.length;++T)S[T]=S[T].replace(/[=][0-9A-Fa-f]{2}/g,function(b){return String.fromCharCode(parseInt(b.slice(1),16))});return Jt(S.join(`\r
`))}function Du(w,S,_){for(var E="",T="",b="",U,Y=0;Y<10;++Y){var H=S[Y];if(!H||H.match(/^\s*$/))break;var j=H.match(/^(.*?):\s*([^\s].*)$/);if(j)switch(j[1].toLowerCase()){case"content-location":E=j[2].trim();break;case"content-type":b=j[2].trim();break;case"content-transfer-encoding":T=j[2].trim();break}}switch(++Y,T.toLowerCase()){case"base64":U=Jt(Qt(S.slice(Y).join("")));break;case"quoted-printable":U=Nu(S.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+T)}var W=ns(w,E.slice(_.length),U,{unsafe:!0});b&&(W.ctype=b)}function Lu(w,S){if(te(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var _=S&&S.root||"",E=(Ae&&Buffer.isBuffer(w)?w.toString("binary"):te(w)).split(`\r
`),T=0,b="";for(T=0;T<E.length;++T)if(b=E[T],!!/^Content-Location:/i.test(b)&&(b=b.slice(b.indexOf("file")),_||(_=b.slice(0,b.lastIndexOf("/")+1)),b.slice(0,_.length)!=_))for(;_.length>0&&(_=_.slice(0,_.length-1),_=_.slice(0,_.lastIndexOf("/")+1),b.slice(0,_.length)!=_););var U=(E[1]||"").match(/boundary="(.*?)"/);if(!U)throw new Error("MAD cannot find boundary");var Y="--"+(U[1]||""),H=[],j=[],W={FileIndex:H,FullPaths:j};k(W);var Q,se=0;for(T=0;T<E.length;++T){var he=E[T];he!==Y&&he!==Y+"--"||(se++&&Du(W,E.slice(Q,T),_),Q=T)}return W}function Bu(w,S){var _=S||{},E=_.boundary||"SheetJS";E="------="+E;for(var T=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],b=w.FullPaths[0],U=b,Y=w.FileIndex[0],H=1;H<w.FullPaths.length;++H)if(U=w.FullPaths[H].slice(b.length),Y=w.FileIndex[H],!(!Y.size||!Y.content||U=="Sh33tJ5")){U=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var j=Y.content,W=Ae&&Buffer.isBuffer(j)?j.toString("binary"):te(j),Q=0,se=Math.min(1024,W.length),he=0,oe=0;oe<=se;++oe)(he=W.charCodeAt(oe))>=32&&he<128&&++Q;var le=Q>=se*4/5;T.push(E),T.push("Content-Location: "+(_.root||"file:///C:/SheetJS/")+U),T.push("Content-Transfer-Encoding: "+(le?"quoted-printable":"base64")),T.push("Content-Type: "+Iu(Y,U)),T.push(""),T.push(le?Pu(W):Ru(W))}return T.push(E+`--\r
`),T.join(`\r
`)}function Mu(w){var S={};return k(S,w),S}function ns(w,S,_,E){var T=E&&E.unsafe;T||k(w);var b=!T&&me.find(w,S);if(!b){var U=w.FullPaths[0];S.slice(0,U.length)==U?U=S:(U.slice(-1)!="/"&&(U+="/"),U=(U+S).replace("//","/")),b={name:n(S),type:2},w.FileIndex.push(b),w.FullPaths.push(U),T||me.utils.cfb_gc(w)}return b.content=_,b.size=_?_.length:0,E&&(E.CLSID&&(b.clsid=E.CLSID),E.mt&&(b.mt=E.mt),E.ct&&(b.ct=E.ct)),b}function Uu(w,S){k(w);var _=me.find(w,S);if(_){for(var E=0;E<w.FileIndex.length;++E)if(w.FileIndex[E]==_)return w.FileIndex.splice(E,1),w.FullPaths.splice(E,1),!0}return!1}function $u(w,S,_){k(w);var E=me.find(w,S);if(E){for(var T=0;T<w.FileIndex.length;++T)if(w.FileIndex[T]==E)return w.FileIndex[T].name=n(_),w.FullPaths[T]=_,!0}return!1}function ju(w){N(w,!0)}return r.find=G,r.read=A,r.parse=f,r.write=ue,r.writeFile=ge,r.utils={cfb_new:Mu,cfb_add:ns,cfb_del:Uu,cfb_mov:$u,cfb_gc:ju,ReadShift:wn,CheckField:i0,prep_blob:bt,bconcat:Et,use_zlib:C,_deflateRaw:Oe,_inflateRaw:ac,consts:J},r})(),$a;function Wd(e){return typeof e=="string"?Ni(e):Array.isArray(e)?gd(e):e}function Hn(e,r,t){if(typeof $a!="undefined"&&$a.writeFileSync)return t?$a.writeFileSync(e,r,t):$a.writeFileSync(e,r);if(typeof Deno!="undefined"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Ni(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var a=t=="utf8"?Tr(r):r;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(a,e);if(typeof Blob!="undefined"){var n=new Blob([Wd(a)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs!="undefined")return saveAs(n,e);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=aa(r)),o.write(r),o.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Gd(e){if(typeof $a!="undefined")return $a.readFileSync(e);if(typeof Deno!="undefined")return Deno.readFileSync(e);if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function nt(e){for(var r=Object.keys(e),t=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&t.push(r[a]);return t}function Ic(e,r){for(var t=[],a=nt(e),n=0;n!==a.length;++n)t[e[a[n]][r]]==null&&(t[e[a[n]][r]]=a[n]);return t}function Li(e){for(var r=[],t=nt(e),a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}function Bi(e){for(var r=[],t=nt(e),a=0;a!==t.length;++a)r[e[t[a]]]=parseInt(t[a],10);return r}function zd(e){for(var r=[],t=nt(e),a=0;a!==t.length;++a)r[e[t[a]]]==null&&(r[e[t[a]]]=[]),r[e[t[a]]].push(t[a]);return r}var Si=new Date(1899,11,30,0,0,0);function yt(e,r){var t=e.getTime();r&&(t-=1462*24*60*60*1e3);var a=Si.getTime()+(e.getTimezoneOffset()-Si.getTimezoneOffset())*6e4;return(t-a)/(1440*60*1e3)}var Hl=new Date,Xd=Si.getTime()+(Hl.getTimezoneOffset()-Si.getTimezoneOffset())*6e4,Rc=Hl.getTimezoneOffset();function Mi(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Xd),r.getTimezoneOffset()!==Rc&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Rc)*6e4),r}function Yd(e){var r=0,t=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(t=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(a)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}r+=t*parseInt(n[i],10)}return r}var Pc=new Date("2017-02-19T19:06:09.000Z"),Vl=isNaN(Pc.getFullYear())?new Date("2/19/17"):Pc,qd=Vl.getFullYear()==2017;function Ke(e,r){var t=new Date(e);if(qd)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Vl.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return e.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function va(e,r){if(Ae&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Tr(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Tr(Fl(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder!="undefined")try{if(r){if(e[0]==255&&e[1]==254)return Tr(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Tr(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return t[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Je(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Je(e[t]));return r}function tt(e,r){for(var t="";t.length<r;)t+=e;return t}function vr(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return t=-t,i}),!isNaN(r=Number(a)))?r/t:r}var Kd=["january","february","march","april","may","june","july","august","september","october","november","december"];function Xa(e){var r=new Date(e),t=new Date(NaN),a=r.getYear(),n=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Kd.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return a<0||a>8099?t:(n>0||i>1)&&a!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Jd=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,a,n){if(e||typeof a=="string")return t.split(a);for(var i=t.split(a),s=[i[0]],o=1;o<i.length;++o)s.push(n),s.push(i[o]);return s}})();function Wl(e){return e?e.content&&e.type?va(e.content,!0):e.data?xn(e.data):e.asNodeBuffer&&Ae?xn(e.asNodeBuffer().toString("binary")):e.asBinary?xn(e.asBinary()):e._data&&e._data.getContent?xn(va(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Gl(e){if(!e)return null;if(e.data)return Ps(e.data);if(e.asNodeBuffer&&Ae)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Ps(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Zd(e){return e&&e.name.slice(-4)===".bin"?Gl(e):Wl(e)}function or(e,r){for(var t=e.FullPaths||nt(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<t.length;++i){var s=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==s||n==s)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function Js(e,r){var t=or(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function pt(e,r,t){if(!t)return Zd(Js(e,r));if(!r)return null;try{return pt(e,r)}catch{return null}}function Zt(e,r,t){if(!t)return Wl(Js(e,r));if(!r)return null;try{return Zt(e,r)}catch{return null}}function zl(e,r,t){if(!t)return Gl(Js(e,r));if(!r)return null;try{return zl(e,r)}catch{return null}}function Nc(e){for(var r=e.FullPaths||nt(e.files),t=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&t.push(r[a].replace(/^Root Entry[\/]/,""));return t.sort()}function Te(e,r,t){if(e.FullPaths){if(typeof t=="string"){var a;return Ae?a=$r(t):a=xd(t),me.utils.cfb_add(e,r,a)}me.utils.cfb_add(e,r,t)}else e.file(r,t)}function Zs(){return me.utils.cfb_new()}function Xl(e,r){switch(r.type){case"base64":return me.read(e,{type:"base64"});case"binary":return me.read(e,{type:"binary"});case"buffer":case"array":return me.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function yn(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var ft=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Qd=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Dc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,eh=/<[^>]*>/g,Mt=ft.match(Dc)?Dc:eh,th=/<\w*:/,rh=/<(\/?)\w+:/;function ye(e,r,t){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(r||(a[0]=e.slice(0,n)),n===e.length)return a;var s=e.match(Qd),o=0,c="",l=0,f="",u="",d=1;if(s)for(l=0;l!=s.length;++l){for(u=s[l],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(f=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(d=(n=u.charCodeAt(i+1))==34||n==39?1:0,c=u.slice(i+1+d,u.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=c,t||(a[f.toLowerCase()]=c);else{var h=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(a[h]&&f.slice(o-3,o)=="ext")continue;a[h]=c,t||(a[h.toLowerCase()]=c)}}return a}function Cr(e){return e.replace(rh,"<$1")}var Yl={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Qs=Li(Yl),Le=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return Yl[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=n.indexOf("]]>");return t(n.slice(0,i))+n.slice(i+9,s)+t(n.slice(s+3))}})(),eo=/[&<>'"]/g,ah=/[\u0000-\u0008\u000b-\u001f]/g;function Ge(e){var r=e+"";return r.replace(eo,function(t){return Qs[t]}).replace(ah,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Lc(e){return Ge(e).replace(/ /g,"_x0020_")}var ql=/[\u0000-\u001f]/g;function to(e){var r=e+"";return r.replace(eo,function(t){return Qs[t]}).replace(/\n/g,"<br/>").replace(ql,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function nh(e){var r=e+"";return r.replace(eo,function(t){return Qs[t]}).replace(ql,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Bc=(function(){var e=/&#(\d+);/g;function r(t,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}})();function ih(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function qe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ws(e){for(var r="",t=0,a=0,n=0,i=0,s=0,o=0;t<e.length;){if(a=e.charCodeAt(t++),a<128){r+=String.fromCharCode(a);continue}if(n=e.charCodeAt(t++),a>191&&a<224){s=(a&31)<<6,s|=n&63,r+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}s=e.charCodeAt(t++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function Mc(e){var r=Qr(2*e.length),t,a,n=1,i=0,s=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(t=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,t=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(r[i++]=s&255,r[i++]=s>>>8,s=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")}function Uc(e){return $r(e,"binary").toString("utf8")}var ui="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",ze=Ae&&(Uc(ui)==ws(ui)&&Uc||Mc(ui)==ws(ui)&&Mc)||ws,Tr=Ae?function(e){return $r(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,a=0,n=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(t++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},In=(function(){var e={};return function(t,a){var n=t+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}})(),Kl=(function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),sh=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),oh=/<\/?(?:vt:)?variant>/g,ch=/<(?:vt:)([^>]*)>([\s\S]*)</;function $c(e,r){var t=ye(e),a=e.match(sh(t.baseType))||[],n=[];if(a.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return n}return a.forEach(function(i){var s=i.replace(oh,"").match(ch);s&&n.push({v:ze(s[2]),t:s[1]})}),n}var Jl=/(^\s|\s$|\n)/;function Ct(e,r){return"<"+e+(r.match(Jl)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Rn(e){return nt(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function ne(e,r,t){return"<"+e+(t!=null?Rn(t):"")+(r!=null?(r.match(Jl)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Ns(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function lh(e,r){switch(typeof e){case"string":var t=ne("vt:lpwstr",Ge(e));return r&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return ne((e|0)==e?"vt:i4":"vt:r8",Ge(String(e)));case"boolean":return ne("vt:bool",e?"true":"false")}if(e instanceof Date)return ne("vt:filetime",Ns(e));throw new Error("Unable to serialize "+e)}function ro(e){if(Ae&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return ze(aa(Ys(e)));throw new Error("Bad input format: expected Buffer or string")}var Pn=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,vt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ea=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function fh(e,r){for(var t=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),n=e[r+6]&15,i=5;i>=0;--i)n=n*256+e[r+i];return a==2047?n==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),t*Math.pow(2,a-52)*n)}function uh(e,r,t){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,i=0,s=a?-r:r;isFinite(s)?s==0?n=i=0:(n=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[t+o]=i&255;e[t+6]=(n&15)<<4|i&15,e[t+7]=n>>4|a}var jc=function(e){for(var r=[],t=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=t)r.push.apply(r,e[0][a].slice(n,n+t));return r},Hc=Ae?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:$r(r)})):jc(e)}:jc,Vc=function(e,r,t){for(var a=[],n=r;n<t;n+=2)a.push(String.fromCharCode(Dr(e,n)));return a.join("").replace(Dt,"")},Ui=Ae?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Dt,""):Vc(e,r,t)}:Vc,Wc=function(e,r,t){for(var a=[],n=r;n<r+t;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},Zl=Ae?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Wc(e,r,t)}:Wc,Gc=function(e,r,t){for(var a=[],n=r;n<t;n++)a.push(String.fromCharCode(Ua(e,n)));return a.join("")},Za=Ae?function(r,t,a){return Buffer.isBuffer(r)?r.toString("utf8",t,a):Gc(r,t,a)}:Gc,Ql=function(e,r){var t=kt(e,r);return t>0?Za(e,r+4,r+4+t-1):""},ao=Ql,e0=function(e,r){var t=kt(e,r);return t>0?Za(e,r+4,r+4+t-1):""},no=e0,t0=function(e,r){var t=2*kt(e,r);return t>0?Za(e,r+4,r+4+t-1):""},io=t0,r0=function(r,t){var a=kt(r,t);return a>0?Ui(r,t+4,t+4+a):""},so=r0,a0=function(e,r){var t=kt(e,r);return t>0?Za(e,r+4,r+4+t):""},oo=a0,n0=function(e,r){return fh(e,r)},Ti=n0,co=function(r){return Array.isArray(r)||typeof Uint8Array!="undefined"&&r instanceof Uint8Array};Ae&&(ao=function(r,t){if(!Buffer.isBuffer(r))return Ql(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},no=function(r,t){if(!Buffer.isBuffer(r))return e0(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},io=function(r,t){if(!Buffer.isBuffer(r))return t0(r,t);var a=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a-1)},so=function(r,t){if(!Buffer.isBuffer(r))return r0(r,t);var a=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a)},oo=function(r,t){if(!Buffer.isBuffer(r))return a0(r,t);var a=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+a)},Ti=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):n0(r,t)},co=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array!="undefined"&&r instanceof Uint8Array});function dh(){Ui=function(e,r,t){return $e.utils.decode(1200,e.slice(r,t)).replace(Dt,"")},Za=function(e,r,t){return $e.utils.decode(65001,e.slice(r,t))},ao=function(e,r){var t=kt(e,r);return t>0?$e.utils.decode(za,e.slice(r+4,r+4+t-1)):""},no=function(e,r){var t=kt(e,r);return t>0?$e.utils.decode(br,e.slice(r+4,r+4+t-1)):""},io=function(e,r){var t=2*kt(e,r);return t>0?$e.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},so=function(e,r){var t=kt(e,r);return t>0?$e.utils.decode(1200,e.slice(r+4,r+4+t)):""},oo=function(e,r){var t=kt(e,r);return t>0?$e.utils.decode(65001,e.slice(r+4,r+4+t)):""}}typeof $e!="undefined"&&dh();var Ua=function(e,r){return e[r]},Dr=function(e,r){return e[r+1]*256+e[r]},hh=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},kt=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},ua=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},ph=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function wn(e,r){var t="",a,n,i=[],s,o,c,l;switch(r){case"dbcs":if(l=this.l,Ae&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(Dr(this,l)),l+=2;e*=2;break;case"utf8":t=Za(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Ui(this,this.l,this.l+e);break;case"wstr":if(typeof $e!="undefined")t=$e.utils.decode(br,this.slice(this.l,this.l+2*e));else return wn.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=ao(this,this.l),e=4+kt(this,this.l);break;case"lpstr-cp":t=no(this,this.l),e=4+kt(this,this.l);break;case"lpwstr":t=io(this,this.l),e=4+2*kt(this,this.l);break;case"lpp4":e=4+kt(this,this.l),t=so(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kt(this,this.l),t=oo(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=Ua(this,this.l+e++))!==0;)i.push(fi(s));t=i.join("");break;case"_wstr":for(e=0,t="";(s=Dr(this,this.l+e))!==0;)i.push(fi(s)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=Ua(this,l),this.l=l+1,o=wn.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(fi(Dr(this,l))),l+=2}t=i.join(""),e*=2;break;case"cpstr":if(typeof $e!="undefined"){t=$e.utils.decode(br,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=Ua(this,l),this.l=l+1,o=wn.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(fi(Ua(this,l))),l+=1}t=i.join("");break;default:switch(e){case 1:return a=Ua(this,this.l),this.l++,a;case 2:return a=(r==="i"?hh:Dr)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(e>0?ua:ph)(this,this.l),this.l+=4,a):(n=kt(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return e==8?n=Ti(this,this.l):n=Ti([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:t=Zl(this,this.l,e);break}}return this.l+=e,t}var mh=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},gh=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},xh=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function vh(e,r,t){var a=0,n=0;if(t==="dbcs"){for(n=0;n!=r.length;++n)xh(this,r.charCodeAt(n),this.l+2*n);a=2*r.length}else if(t==="sbcs"){if(typeof $e!="undefined"&&za==874)for(n=0;n!=r.length;++n){var i=$e.utils.encode(za,r.charAt(n));this[this.l+n]=i[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;a=r.length}else if(t==="hex"){for(;n<e;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(r.length,e);++n){var o=r.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,mh(this,r,this.l);break;case 8:if(a=8,t==="f"){uh(this,r,this.l);break}case 16:break;case-4:a=4,gh(this,r,this.l);break}return this.l+=a,this}function i0(e,r){var t=Zl(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function bt(e,r){e.l=r,e.read_shift=wn,e.chk=i0,e.write_shift=vh}function Bt(e,r){e.l+=r}function X(e){var r=Qr(e);return bt(r,0),r}function jr(e,r,t){if(e){var a,n,i;bt(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=Un[o]||Un[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var f=l.f&&l.f(e,i,t);if(e.l=c,r(f,l,o))return}}}function zt(){var e=[],r=Ae?256:2048,t=function(l){var f=X(l);return bt(f,0),f},a=t(r),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(l){return a&&l<a.length-a.l?a:(n(),a=t(Math.max(l+1,r)))},s=function(){return n(),Et(e)},o=function(l){n(),a=l,a.l==null&&(a.l=a.length),i(r)};return{next:i,push:o,end:s,_bufs:e}}function K(e,r,t,a){var n=+r,i;if(!isNaN(n)){a||(a=Un[n].p||(t||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var s=e.next(i);n<=127?s.write_shift(1,n):(s.write_shift(1,(n&127)+128),s.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)s.write_shift(1,(a&127)+128),a>>=7;else{s.write_shift(1,a);break}a>0&&co(t)&&e.push(t)}}function _n(e,r,t){var a=Je(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function zc(e,r,t){var a=Je(e);return a.s=_n(a.s,r.s,t),a.e=_n(a.e,r.s,t),a}function kn(e,r){if(e.cRel&&e.c<0)for(e=Je(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Je(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=ve(e);return!e.cRel&&e.cRel!=null&&(t=_h(t)),!e.rRel&&e.rRel!=null&&(t=yh(t)),t}function _s(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qe(e.s.c)+":"+(e.e.cRel?"":"$")+Qe(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+lt(e.s.r)+":"+(e.e.rRel?"":"$")+lt(e.e.r):kn(e.s,r.biff)+":"+kn(e.e,r.biff)}function lo(e){return parseInt(wh(e),10)-1}function lt(e){return""+(e+1)}function yh(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function wh(e){return e.replace(/\$(\d+)$/,"$1")}function fo(e){for(var r=kh(e),t=0,a=0;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function Qe(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function _h(e){return e.replace(/^([A-Z])/,"$$$1")}function kh(e){return e.replace(/^\$([A-Z])/,"$1")}function Eh(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function et(e){for(var r=0,t=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:r-1}}function ve(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Xt(e){var r=e.indexOf(":");return r==-1?{s:et(e),e:et(e)}:{s:et(e.slice(0,r)),e:et(e.slice(r+1))}}function Ee(e,r){return typeof r=="undefined"||typeof r=="number"?Ee(e.s,e.e):(typeof e!="string"&&(e=ve(e)),typeof r!="string"&&(r=ve(r)),e==r?e:e+":"+r)}function Be(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,n=0,i=e.length;for(t=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.s.c=--t,t=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;if(r.s.r=--t,a===i||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,t=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.e.c=--t,t=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;return r.e.r=--t,r}function Xc(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=fr(e.z,t?yt(r):r)}catch{}try{return e.w=fr((e.XF||{}).numFmtId||(t?14:0),t?yt(r):r)}catch{return""+r}}function Ur(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Hr[e.v]||e.v:r==null?Xc(e,e.v):Xc(e,r))}function na(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function s0(e,r,t){var a=t||{},n=e?Array.isArray(e):a.dense;at!=null&&n==null&&(n=at);var i=e||(n?[]:{}),s=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?et(a.origin):a.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Be(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),s==-1&&(l.e.r=s=f.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=r[u].length;++d)if(typeof r[u][d]!="undefined"){var h={v:r[u][d]},m=s+u,p=o+d;if(l.s.r>m&&(l.s.r=m),l.s.c>p&&(l.s.c=p),l.e.r<m&&(l.e.r=m),l.e.c<p&&(l.e.c=p),r[u][d]&&typeof r[u][d]=="object"&&!Array.isArray(r[u][d])&&!(r[u][d]instanceof Date))h=r[u][d];else if(Array.isArray(h.v)&&(h.f=r[u][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||xe[14],a.cellDates?(h.t="d",h.w=fr(h.z,yt(h.v))):(h.t="n",h.v=yt(h.v),h.w=fr(h.z,h.v))):h.t="s";if(n)i[m]||(i[m]=[]),i[m][p]&&i[m][p].z&&(h.z=i[m][p].z),i[m][p]=h;else{var g=ve({c:p,r:m});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return l.s.c<1e7&&(i["!ref"]=Ee(l)),i}function Qa(e,r){return s0(null,e,r)}function Sh(e){return e.read_shift(4,"i")}function yr(e,r){return r||(r=X(4)),r.write_shift(4,e),r}function Lt(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function St(e,r){var t=!1;return r==null&&(t=!0,r=X(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Th(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bh(e,r){return r||(r=X(4)),r.write_shift(2,e.ich||0),r.write_shift(2,e.ifnt||0),r}function uo(e,r){var t=e.l,a=e.read_shift(1),n=Lt(e),i=[],s={t:n,h:n};if((a&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(Th(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}function Ch(e,r){var t=!1;return r==null&&(t=!0,r=X(15+4*e.t.length)),r.write_shift(1,0),St(e.t,r),t?r.slice(0,r.l):r}var Ah=uo;function Oh(e,r){var t=!1;return r==null&&(t=!0,r=X(23+4*e.t.length)),r.write_shift(1,1),St(e.t,r),r.write_shift(4,1),bh({ich:0,ifnt:0},r),t?r.slice(0,r.l):r}function ur(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Sa(e,r){return r==null&&(r=X(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Ta(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function ba(e,r){return r==null&&(r=X(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Fh=Lt,o0=St;function ho(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function bi(e,r){var t=!1;return r==null&&(t=!0,r=X(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Ih=Lt,Ds=ho,po=bi;function mo(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,a=r[0]&2;e.l+=4;var n=a===0?Ti([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):ua(r,0)>>2;return t?n/100:n}function c0(e,r){r==null&&(r=X(4));var t=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(a=1,t=1),a)r.write_shift(-4,((t?n:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function l0(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function Rh(e,r){return r||(r=X(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Ca=l0,en=Rh;function Nt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ya(e,r){return(r||X(8)).write_shift(8,e,"f")}function Ph(e){var r={},t=e.read_shift(1),a=t>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var l=ha[n];l&&(r.rgb=Dn(l));break;case 2:r.rgb=Dn([s,o,c]);break;case 3:r.theme=n;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function Ci(e,r){if(r||(r=X(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),r.write_shift(1,parseInt(a.slice(0,2),16)),r.write_shift(1,parseInt(a.slice(2,4),16)),r.write_shift(1,parseInt(a.slice(4,6),16)),r.write_shift(1,255)}return r}function Nh(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Dh(e,r){r||(r=X(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function f0(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Lh(e){return f0(e,1)}function Bh(e){return f0(e,2)}var go=2,Gt=3,di=11,Yc=12,Ai=19;var hi=64,Mh=65,Uh=71;var $h=4108,jh=4126,_t=80,u0=81,Hh=[_t,u0],Ls={1:{n:"CodePage",t:go},2:{n:"Category",t:_t},3:{n:"PresentationFormat",t:_t},4:{n:"ByteCount",t:Gt},5:{n:"LineCount",t:Gt},6:{n:"ParagraphCount",t:Gt},7:{n:"SlideCount",t:Gt},8:{n:"NoteCount",t:Gt},9:{n:"HiddenCount",t:Gt},10:{n:"MultimediaClipCount",t:Gt},11:{n:"ScaleCrop",t:di},12:{n:"HeadingPairs",t:$h},13:{n:"TitlesOfParts",t:jh},14:{n:"Manager",t:_t},15:{n:"Company",t:_t},16:{n:"LinksUpToDate",t:di},17:{n:"CharacterCount",t:Gt},19:{n:"SharedDoc",t:di},22:{n:"HyperlinksChanged",t:di},23:{n:"AppVersion",t:Gt,p:"version"},24:{n:"DigSig",t:Mh},26:{n:"ContentType",t:_t},27:{n:"ContentStatus",t:_t},28:{n:"Language",t:_t},29:{n:"Version",t:_t},255:{},2147483648:{n:"Locale",t:Ai},2147483651:{n:"Behavior",t:Ai},1919054434:{}},Bs={1:{n:"CodePage",t:go},2:{n:"Title",t:_t},3:{n:"Subject",t:_t},4:{n:"Author",t:_t},5:{n:"Keywords",t:_t},6:{n:"Comments",t:_t},7:{n:"Template",t:_t},8:{n:"LastAuthor",t:_t},9:{n:"RevNumber",t:_t},10:{n:"EditTime",t:hi},11:{n:"LastPrinted",t:hi},12:{n:"CreatedDate",t:hi},13:{n:"ModifiedDate",t:hi},14:{n:"PageCount",t:Gt},15:{n:"WordCount",t:Gt},16:{n:"CharCount",t:Gt},17:{n:"Thumbnail",t:Uh},18:{n:"Application",t:_t},19:{n:"DocSecurity",t:Gt},255:{},2147483648:{n:"Locale",t:Ai},2147483651:{n:"Behavior",t:Ai},1919054434:{}},qc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Vh=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Wh(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Gh=Wh([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ha=Je(Gh),Hr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},d0={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ms={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},pi={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function xo(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function zh(e){var r=xo();if(!e||!e.match)return r;var t={};if((e.match(Mt)||[]).forEach(function(a){var n=ye(a);switch(n[0].replace(th,"<")){case"<?xml":break;case"<Types":r.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":r[Ms[n.ContentType]]!==void 0&&r[Ms[n.ContentType]].push(n.PartName);break}}),r.xmlns!==vt.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function h0(e,r){var t=zd(Ms),a=[],n;a[a.length]=ft,a[a.length]=ne("Types",null,{xmlns:vt.CT,"xmlns:xsd":vt.xsd,"xmlns:xsi":vt.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ne("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=ne("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:pi[c][r.bookType]||pi[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(l){a[a.length]=ne("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:pi[c][r.bookType]||pi[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(l){a[a.length]=ne("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var be={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Nn(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function En(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(Mt)||[]).forEach(function(n){var i=ye(n);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:yn(i.Target,r);t[o]=s,a[i.Id]=s}}),t["!id"]=a,t}function Va(e){var r=[ft,ne("Relationships",null,{xmlns:vt.RELS})];return nt(e["!id"]).forEach(function(t){r[r.length]=ne("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function We(e,r,t,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,n.Id="rId"+r,n.Type=a,n.Target=t,i?n.TargetMode=i:[be.HLINK,be.XPATH,be.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,r}var Xh="application/vnd.oasis.opendocument.spreadsheet";function Yh(e,r){for(var t=ro(e),a,n;a=Pn.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if(n=ye(a[0],!1),n.path=="/"&&n.type!==Xh)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}function qh(e){var r=[ft];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Kc(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Kh(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Jh(e){var r=[ft];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Kc(e[t][0],e[t][1])),r.push(Kh("",e[t][0]));return r.push(Kc("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function p0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+An.version+"</meta:generator></office:meta></office:document-meta>"}var lr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Zh=(function(){for(var e=new Array(lr.length),r=0;r<lr.length;++r){var t=lr[r],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function m0(e){var r={};e=ze(e);for(var t=0;t<lr.length;++t){var a=lr[t],n=e.match(Zh[t]);n!=null&&n.length>0&&(r[a[1]]=Le(n[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=Ke(r[a[1]]))}return r}function ks(e,r,t,a,n){n[e]!=null||r==null||r===""||(n[e]=r,r=Ge(r),a[a.length]=t?ne(e,r,t):Ct(e,r))}function g0(e,r){var t=r||{},a=[ft,ne("cp:coreProperties",null,{"xmlns:cp":vt.CORE_PROPS,"xmlns:dc":vt.dc,"xmlns:dcterms":vt.dcterms,"xmlns:dcmitype":vt.dcmitype,"xmlns:xsi":vt.xsi})],n={};if(!e&&!t.Props)return a.join("");e&&(e.CreatedDate!=null&&ks("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ns(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&ks("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ns(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=lr.length;++i){var s=lr[i],o=t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ks(s[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var pa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],x0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function v0(e,r,t,a){var n=[];if(typeof e=="string")n=$c(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(f){return{v:f}}));var s=typeof r=="string"?$c(r,a).map(function(f){return f.v}):r,o=0,c=0;if(s.length>0)for(var l=0;l!==n.length;l+=2){switch(c=+n[l+1].v,n[l].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=c,t.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(o,o+c);break}o+=c}}function Qh(e,r,t){var a={};return r||(r={}),e=ze(e),pa.forEach(function(n){var i=(e.match(In(n[0]))||[])[1];switch(n[2]){case"string":i&&(r[n[1]]=Le(i));break;case"bool":r[n[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));s&&s.length>0&&(a[n[1]]=s[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&v0(a.HeadingPairs,a.TitlesOfParts,r,t),r}function y0(e){var r=[],t=ne;return e||(e={}),e.Application="SheetJS",r[r.length]=ft,r[r.length]=ne("Properties",null,{xmlns:vt.EXT_PROPS,"xmlns:vt":vt.vt}),pa.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Ge(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(r[r.length]=t(a[0],n))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Ge(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var ep=/<[^>]+>[^<]*/g;function tp(e,r){var t={},a="",n=e.match(ep);if(n)for(var i=0;i!=n.length;++i){var s=n[i],o=ye(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Le(o.name);break;case"</property>":a=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[a]=Le(f);break;case"bool":t[a]=qe(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(f);break;case"filetime":case"date":t[a]=Ke(f);break;case"cy":case"error":t[a]=Le(f);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console!="undefined"&&console.warn("Unexpected",s,l,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return t}function w0(e){var r=[ft,ne("Properties",null,{xmlns:vt.CUST_PROPS,"xmlns:vt":vt.vt})];if(!e)return r.join("");var t=1;return nt(e).forEach(function(n){++t,r[r.length]=ne("property",lh(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Ge(n)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Us={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Es;function rp(e,r,t){Es||(Es=Li(Us)),r=Es[r]||r,e[r]=t}function ap(e,r){var t=[];return nt(Us).map(function(a){for(var n=0;n<lr.length;++n)if(lr[n][1]==a)return lr[n];for(n=0;n<pa.length;++n)if(pa[n][1]==a)return pa[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=r&&r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(Ct(Us[a[1]]||a[1],n))}}),ne("DocumentProperties",t.join(""),{xmlns:Kt.o})}function np(e,r){var t=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&nt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<lr.length;++s)if(i==lr[s][1])return;for(s=0;s<pa.length;++s)if(i==pa[s][1])return;for(s=0;s<t.length;++s)if(i==t[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(ne(Lc(i),o,{"dt:dt":c}))}}),r&&nt(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=r[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),n.push(ne(Lc(i),s,{"dt:dt":o}))}}),"<"+a+' xmlns="'+Kt.o+'">'+n.join("")+"</"+a+">"}function vo(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ip(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,a=t%Math.pow(2,32),n=(t-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var s=X(8);return s.write_shift(4,a),s.write_shift(4,n),s}function _0(e,r,t){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return n}function k0(e,r,t){var a=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(a.length+1&3)&3),a}function E0(e,r,t){return r===31?k0(e):_0(e,r,t)}function $s(e,r,t){return E0(e,r,t===!1?0:4)}function sp(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return E0(e,r,0)}function op(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a){var n=e.l;t[a]=e.read_shift(0,"lpwstr").replace(Dt,""),e.l-n&2&&(e.l+=2)}return t}function cp(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a)t[a]=e.read_shift(0,"lpstr-cp").replace(Dt,"");return t}function lp(e){var r=e.l,t=Oi(e,u0);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=Oi(e,Gt);return[t,a]}function fp(e){for(var r=e.read_shift(4),t=[],a=0;a<r/2;++a)t.push(lp(e));return t}function Jc(e,r){for(var t=e.read_shift(4),a={},n=0;n!=t;++n){var i=e.read_shift(4),s=e.read_shift(4);a[i]=e.read_shift(s,r===1200?"utf16le":"utf8").replace(Dt,"").replace(vn,"!"),r===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function S0(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function up(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Oi(e,r,t){var a=e.read_shift(2),n,i=t||{};if(e.l+=2,r!==Yc&&a!==r&&Hh.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===Yc?a:r){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return _0(e,a,4).replace(Dt,"");case 31:return k0(e);case 64:return vo(e);case 65:return S0(e);case 71:return up(e);case 80:return $s(e,a,!i.raw).replace(Dt,"");case 81:return sp(e,a).replace(Dt,"");case 4108:return fp(e);case 4126:case 4127:return a==4127?op(e):cp(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function Zc(e,r){var t=X(4),a=X(4);switch(t.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,r);break;case 5:a=X(8),a.write_shift(8,r,"f");break;case 11:a.write_shift(4,r?1:0);break;case 64:a=ip(r);break;case 31:case 80:for(a=X(4+2*(r.length+1)+(r.length%2?0:2)),a.write_shift(4,r.length+1),a.write_shift(0,r,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Et([t,a])}function Qc(e,r){var t=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],s=0,o=0,c=-1,l={};for(s=0;s!=n;++s){var f=e.read_shift(4),u=e.read_shift(4);i[s]=[f,u+t]}i.sort(function(y,x){return y[1]-x[1]});var d={};for(s=0;s!=n;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&r)switch(r[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!r||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(r){var m=r[i[s][0]];if(d[m.n]=Oi(e,m.t,{raw:!0}),m.p==="version"&&(d[m.n]=String(d[m.n]>>16)+"."+("0000"+String(d[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(d[m.n]){case 0:d[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:gr(o=d[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[m.n])}}else if(i[s][0]===1){if(o=d.CodePage=Oi(e,go),gr(o),c!==-1){var p=e.l;e.l=i[c][1],l=Jc(e,o),e.l=p}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}l=Jc(e,o)}else{var g=l[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=S0(e);break;case 30:e.l+=4,v=$s(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=$s(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=ct(e,4);break;case 64:e.l+=4,v=Ke(vo(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=v}}return e.l=t+a,d}var T0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function dp(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function el(e,r,t){var a=X(8),n=[],i=[],s=8,o=0,c=X(8),l=X(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),i.push(c),n.push(l),s+=8+c.length,!r){l=X(8),l.write_shift(4,0),n.unshift(l);var f=[X(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for(c=X(8+2*(u.length+1)+(u.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,u.length+1),c.write_shift(0,u,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=Et(f),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(r&&!r[e[o][0]])&&!(T0.indexOf(e[o][0])>-1||x0.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],h=0;if(r){h=+r[e[o][0]];var m=t[h];if(m.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}c=Zc(m.t,d)}else{var g=dp(d);g==-1&&(g=31,d=String(d)),c=Zc(g,d)}i.push(c),l=X(8),l.write_shift(4,r?h:2+o),n.push(l),s+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,v),v+=i[o].length;return a.write_shift(4,s),a.write_shift(4,i.length),Et([a].concat(n).concat(i))}function tl(e,r,t){var a=e.content;if(!a)return{};bt(a,0);var n,i,s,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),f=a.read_shift(16);if(f!==me.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(s=a.read_shift(16),c=a.read_shift(4));var u=Qc(a,r),d={SystemIdentifier:l};for(var h in u)d[h]=u[h];if(d.FMTID=i,n===1)return d;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var m;try{m=Qc(a,null)}catch{}for(h in m)d[h]=m[h];return d.FMTID=[i,s],d}function rl(e,r,t,a,n,i){var s=X(n?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,me.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,n?2:1),s.write_shift(16,r,"hex"),s.write_shift(4,n?68:48);var c=el(e,t,a);if(o.push(c),n){var l=el(n,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(l)}return Et(o)}function Kr(e,r){return e.read_shift(r),null}function hp(e,r){r||(r=X(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function pp(e,r,t){for(var a=[],n=e.l+r;e.l<n;)a.push(t(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function ct(e,r){return e.read_shift(r)===1}function Ht(e,r){return r||(r=X(2)),r.write_shift(2,+!!e),r}function mt(e){return e.read_shift(2,"u")}function cr(e,r){return r||(r=X(2)),r.write_shift(2,e),r}function b0(e,r){return pp(e,r,mt)}function mp(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function C0(e,r,t){return t||(t=X(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function Vn(e,r,t){var a=e.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont",i=br;if(t&&t.biff>=8&&(br=1200),!t||t.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return br=i,o}function gp(e){var r=br;br=1200;var t=e.read_shift(2),a=e.read_shift(1),n=a&4,i=a&8,s=1+(a&1),o=0,c,l={};i&&(o=e.read_shift(2)),n&&(c=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*o),n&&(e.l+=c),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),br=r,l}function xp(e){var r=e.t||"",t=1,a=X(3+(t>1?2:0));a.write_shift(2,r.length),a.write_shift(1,(t>1?8:0)|1),t>1&&a.write_shift(2,t);var n=X(2*r.length);n.write_shift(2*r.length,r,"utf16le");var i=[a,n];return Et(i)}function wa(e,r,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function Wn(e,r,t){var a=e.read_shift(t&&t.biff==2?1:2);return a===0?(e.l++,""):wa(e,a,t)}function Aa(e,r,t){if(t.biff>5)return Wn(e,r,t);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function A0(e,r,t){return t||(t=X(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function vp(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function yp(e){var r=e.read_shift(4),t=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=t);var n=e.read_shift((a?r-24:r)>>1,"utf16le").replace(Dt,"");return a&&(e.l+=24),n}function wp(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return t+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Dt,"");return t+s}function _p(e,r){var t=e.read_shift(16);switch(r-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return yp(e,r);case"0303000000000000c000000000000046":return wp(e,r);default:throw new Error("Unsupported Moniker "+t)}}function mi(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Dt,""):"";return t}function al(e,r){r||(r=X(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function kp(e,r){var t=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,s,o,c,l="",f,u;n&16&&(i=mi(e,t-e.l)),n&128&&(s=mi(e,t-e.l)),(n&257)===257&&(o=mi(e,t-e.l)),(n&257)===1&&(c=_p(e,t-e.l)),n&8&&(l=mi(e,t-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(u=vo(e)),e.l=t;var d=s||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),n&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return f&&(h.guid=f),u&&(h.time=u),i&&(h.Tooltip=i),h}function Ep(e){var r=X(512),t=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(t=0;t<s.length;++t)r.write_shift(4,s[t]);if(i==28)a=a.slice(1),al(a,r);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<s.length;++t)r.write_shift(1,parseInt(s[t],16));var o=n>-1?a.slice(0,n):a;for(r.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)r.write_shift(2,o.charCodeAt(t));r.write_shift(2,0),i&8&&al(n>-1?a.slice(n+1):"",r)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<s.length;++t)r.write_shift(1,parseInt(s[t],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,a.length-3*c+1),t=0;t<a.length-3*c;++t)r.write_shift(1,a.charCodeAt(t+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function O0(e){var r=e.read_shift(1),t=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[r,t,a,n]}function F0(e,r){var t=O0(e,r);return t[3]=0,t}function Ar(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return{r,c:t,ixfe:a}}function _a(e,r,t,a){return a||(a=X(6)),a.write_shift(2,e),a.write_shift(2,r),a.write_shift(2,t||0),a}function Sp(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Tp(e,r,t){return r===0?"":Aa(e,r,t)}function bp(e,r,t){var a=t.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),s=e.read_shift(a,"i");return[n,i,s]}function I0(e){var r=e.read_shift(2),t=mo(e);return[r,t]}function Cp(e,r,t){e.l+=4,r-=4;var a=e.l+r,n=Vn(e,r,t),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function $i(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r},e:{c:n,r:t}}}function R0(e,r){return r||(r=X(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function P0(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r},e:{c:n,r:t}}}var Ap=P0;function N0(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[t,r,a]}function Op(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Fp(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Ft(e){e.l+=2,e.l+=e.read_shift(2)}var Ip={0:Ft,4:Ft,5:Ft,6:Ft,7:Fp,8:Ft,9:Ft,10:Ft,11:Ft,12:Ft,13:Op,14:Ft,15:Ft,16:Ft,17:Ft,18:Ft,19:Ft,20:Ft,21:N0};function Rp(e,r){for(var t=e.l+r,a=[];e.l<t;){var n=e.read_shift(2);e.l-=2;try{a.push(Ip[n](e,t-e.l))}catch{return e.l=t,a}}return e.l!=t&&(e.l=t),a}function gi(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function yo(e,r,t){var a=1536,n=16;switch(t.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=X(n);return i.write_shift(2,a),i.write_shift(2,r),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Pp(e,r){return r===0||e.read_shift(2),1200}function Np(e,r,t){if(t.enc)return e.l+=r,"";var a=e.l,n=Aa(e,0,t);return e.read_shift(r+a-e.l),n}function Dp(e,r){var t=!r||r.biff==8,a=X(t?112:54);for(a.write_shift(r.biff==8?2:1,7),t&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(t?0:536870912));a.l<a.length;)a.write_shift(1,t?0:32);return a}function Lp(e,r,t){var a=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Bp(e,r,t){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Vn(e,0,t);return s.length===0&&(s="Sheet1"),{pos:a,hs:n,dt:i,name:s}}function Mp(e,r){var t=!r||r.biff>=8?2:1,a=X(8+t*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),r.biff>=8&&a.write_shift(1,1),a.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function Up(e,r){for(var t=e.l+r,a=e.read_shift(4),n=e.read_shift(4),i=[],s=0;s!=n&&e.l<t;++s)i.push(gp(e));return i.Count=a,i.Unique=n,i}function $p(e,r){var t=X(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=xp(e[n],r);var i=Et([t].concat(a));return i.parts=[t.length].concat(a.map(function(s){return s.length})),i}function jp(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function Hp(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=t/20),r}function Vp(e){var r=Sp(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function Wp(e){return e.read_shift(2),e.read_shift(4)}function nl(e,r,t){var a=0;t&&t.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);t&&t.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function Gp(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[a,n],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:l}}function zp(){var e=X(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Xp(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Yp(e){var r=X(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function qp(){}function Kp(e,r,t){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Vn(e,0,t),a}function Jp(e,r){var t=e.name||"Arial",a=r&&r.biff==5,n=a?15+t.length:16+2*t.length,i=X(n);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le"),i}function Zp(e){var r=Ar(e);return r.isst=e.read_shift(4),r}function Qp(e,r,t,a){var n=X(10);return _a(e,r,a,n),n.write_shift(4,t),n}function e1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=e.l+r,n=Ar(e,6);t.biff==2&&e.l++;var i=Wn(e,a-e.l,t);return n.val=i,n}function t1(e,r,t,a,n){var i=!n||n.biff==8,s=X(8+ +i+(1+i)*t.length);return _a(e,r,a,s),s.write_shift(2,t.length),i&&s.write_shift(1,1),s.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),s}function r1(e,r,t){var a=e.read_shift(2),n=Aa(e,0,t);return[a,n]}function a1(e,r,t,a){var n=t&&t.biff==5;a||(a=X(n?3+r.length:5+2*r.length)),a.write_shift(2,e),a.write_shift(n?1:2,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var n1=Aa;function il(e,r,t){var a=e.l+r,n=t.biff==8||!t.biff?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:o},e:{r:s,c}}}function i1(e,r){var t=r.biff==8||!r.biff?4:2,a=X(2*t+6);return a.write_shift(t,e.s.r),a.write_shift(t,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function s1(e){var r=e.read_shift(2),t=e.read_shift(2),a=I0(e);return{r,c:t,ixfe:a[0],rknum:a[1]}}function o1(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<t;)i.push(I0(e));if(e.l!==t)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:s,rkrec:i}}function c1(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<t;)i.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:s,ixfe:i}}function l1(e,r,t,a){var n={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=Vh[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=s&15,n.dgRight=s>>4&15,n.dgTop=s>>8&15,n.dgBottom=s>>12&15,n.icvLeft=s>>16&127,n.icvRight=s>>23&127,n.grbitDiag=s>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function f1(e,r,t){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=l1(e,r,a.fStyle,t),a}function sl(e,r,t,a){var n=t&&t.biff==5;a||(a=X(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,r<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function u1(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function d1(e){var r=X(8);return r.write_shift(4,0),r.write_shift(2,e[0]?e[0]+1:0),r.write_shift(2,e[1]?e[1]+1:0),r}function ol(e,r,t){var a=Ar(e,6);(t.biff==2||r==9)&&++e.l;var n=mp(e,2);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function h1(e,r,t,a,n,i){var s=X(8);return _a(e,r,a,s),C0(t,i,s),s}function p1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=Ar(e,6),n=Nt(e,8);return a.val=n,a}function m1(e,r,t,a){var n=X(14);return _a(e,r,a,n),ya(t,n),n}var cl=Tp;function g1(e,r,t){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=wa(e,i),o=[];a>e.l;)o.push(Wn(e));return[i,n,s,o]}function ll(e,r,t){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return t.sbcch===14849&&(n=Cp(e,r-2,t)),i.body=n||e.read_shift(r-2),typeof n=="string"&&(i.Name=n),i}var x1=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function fl(e,r,t){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=wa(e,s,t);n&32&&(l=x1[l.charCodeAt(0)]);var f=a-e.l;t&&t.biff==2&&--f;var u=a==e.l||o===0||!(f>0)?[]:Rv(e,f,t,o);return{chKey:i,Name:l,itab:c,rgce:u}}function D0(e,r,t){if(t.biff<8)return v1(e,r,t);for(var a=[],n=e.l+r,i=e.read_shift(t.biff>8?4:2);i--!==0;)a.push(bp(e,t.biff>8?12:6,t));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function v1(e,r,t){e[e.l+1]==3&&e[e.l]++;var a=Vn(e,r,t);return a.charCodeAt(0)==3?a.slice(1):a}function y1(e,r,t){if(t.biff<8){e.l+=r;return}var a=e.read_shift(2),n=e.read_shift(2),i=wa(e,a,t),s=wa(e,n,t);return[i,s]}function w1(e,r,t){var a=P0(e,6);e.l++;var n=e.read_shift(1);return r-=8,[Pv(e,r,t),n,a]}function ul(e,r,t){var a=Ap(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,Fv(e,r,t,a)]}function _1(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,a=e.read_shift(4);return[r,t,a]}function k1(e,r,t){if(!(t.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Aa(e,0,t);return t.biff<8&&e.read_shift(1),[{r:a,c:n},o,s,i]}}function E1(e,r,t){return k1(e,r,t)}function S1(e,r){for(var t=[],a=e.read_shift(2);a--;)t.push($i(e,r));return t}function T1(e){var r=X(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)R0(e[t],r);return r}function b1(e,r,t){if(t&&t.biff<8)return A1(e,r,t);var a=N0(e,22),n=Rp(e,r-22,a[1]);return{cmo:a,ft:n}}var C1={8:function(e,r){var t=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=t,{fmt:a}}};function A1(e,r,t){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var s=[];return s.push((C1[a]||Bt)(e,r,t)),{cmo:[n,a,i],ft:s}}function O1(e,r,t){var a=e.l,n="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=vp(e,6,t);var o=e.read_shift(2);e.read_shift(2),mt(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],u=wa(e,e.lens[l+1]-e.lens[l]-1);if(n+=u,n.length>=(f?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+r,{t:n}}catch{return e.l=a+r,{t:n}}}function F1(e,r){var t=$i(e,8);e.l+=16;var a=kp(e,r-24);return[t,a]}function I1(e){var r=X(24),t=et(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)r.write_shift(1,parseInt(a[n],16));return Et([r,Ep(e[1])])}function R1(e,r){e.read_shift(2);var t=$i(e,8),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(Dt,""),[t,a]}function P1(e){var r=e[1].Tooltip,t=X(10+2*(r.length+1));t.write_shift(2,2048);var a=et(e[0]);t.write_shift(2,a.r),t.write_shift(2,a.r),t.write_shift(2,a.c),t.write_shift(2,a.c);for(var n=0;n<r.length;++n)t.write_shift(2,r.charCodeAt(n));return t.write_shift(2,0),t}function N1(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=qc[t]||t,t=e.read_shift(2),r[1]=qc[t]||t,r}function D1(e){return e||(e=X(4)),e.write_shift(2,1),e.write_shift(2,1),e}function L1(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(F0(e,8));return t}function B1(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(F0(e,8));return t}function M1(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function L0(e,r,t){if(!t.cellStyles)return Bt(e,r);var a=t&&t.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:i,w:s,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function U1(e,r){var t=X(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var a=0;return e.hidden&&(a|=1),t.write_shift(1,a),a=e.level||0,t.write_shift(1,a),t.write_shift(2,0),t}function $1(e,r){var t={};return r<32||(e.l+=16,t.header=Nt(e,8),t.footer=Nt(e,8),e.l+=2),t}function j1(e,r,t){var a={area:!1};if(t.biff!=5)return e.l+=r,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function H1(e){for(var r=X(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var V1=Ar,W1=b0,G1=Wn;function z1(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function X1(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var a=Ar(e,6);++e.l;var n=Aa(e,r-7,t);return a.t="str",a.val=n,a}function Y1(e){var r=Ar(e,6);++e.l;var t=Nt(e,8);return r.t="n",r.val=t,r}function q1(e,r,t){var a=X(15);return Yn(a,e,r),a.write_shift(8,t,"f"),a}function K1(e){var r=Ar(e,6);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function J1(e,r,t){var a=X(9);return Yn(a,e,r),a.write_shift(2,t),a}function Z1(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function Q1(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function em(e,r,t){var a=e.l+r,n=Ar(e,6),i=e.read_shift(2),s=wa(e,i,t);return e.l=a,n.t="str",n.val=s,n}var tm=[2,3,48,49,131,139,140,245],js=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Li({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],f=Qr(1);switch(c.type){case"base64":f=Jt(Qt(o));break;case"binary":f=Jt(o);break;case"buffer":case"array":f=o;break}bt(f,0);var u=f.read_shift(1),d=!!(u&136),h=!1,m=!1;switch(u){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,g=521;u==2&&(p=f.read_shift(2)),f.l+=3,u!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(g=f.read_shift(2));var v=f.read_shift(2),y=c.codepage||1252;u!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var x=[],O={},I=Math.min(f.length,u==2?521:g-10-(h?264:0)),A=m?32:11;f.l<I&&f[f.l]!=13;)switch(O={},O.name=$e.utils.decode(y,f.slice(f.l,f.l+A)).replace(/[\u0000\r\n].*$/g,""),f.l+=A,O.type=String.fromCharCode(f.read_shift(1)),u!=2&&!m&&(O.offset=f.read_shift(4)),O.len=f.read_shift(1),u==2&&(O.offset=f.read_shift(2)),O.dec=f.read_shift(1),O.name.length&&x.push(O),u!=2&&(f.l+=m?13:14),O.type){case"B":(!h||O.len!=8)&&c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var k=0,D=0;for(l[0]=[],D=0;D!=x.length;++D)l[0][D]=x[D].name;for(;p-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,l[++k]=[],D=0,D=0;D!=x.length;++D){var N=f.slice(f.l,f.l+x[D].len);f.l+=x[D].len,bt(N,0);var M=$e.utils.decode(y,N);switch(x[D].type){case"C":M.trim().length&&(l[k][D]=M.replace(/\s+$/,""));break;case"D":M.length===8?l[k][D]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):l[k][D]=M;break;case"F":l[k][D]=parseFloat(M.trim());break;case"+":case"I":l[k][D]=m?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":l[k][D]=!0;break;case"N":case"F":l[k][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));l[k][D]="##MEMO##"+(m?parseInt(M.trim(),10):N.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(l[k][D]=+M||0);break;case"@":l[k][D]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":l[k][D]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":l[k][D]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[k][D]=-N.read_shift(-8,"f");break;case"B":if(h&&x[D].len==8){l[k][D]=N.read_shift(8,"f");break}case"G":case"P":N.l+=x[D].len;break;case"0":if(x[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[D].type)}}}if(u!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=x,l}function a(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Qa(t(o,l),l);return f["!cols"]=l.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete l.DBF,f}function n(o,c){try{return na(a(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var l=c||{};if(+l.codepage>=0&&gr(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=zt(),u=Pi(o,{header:1,raw:!0,cellDates:!0}),d=u[0],h=u.slice(1),m=o["!cols"]||[],p=0,g=0,v=0,y=1;for(p=0;p<d.length;++p){if(((m[p]||{}).DBF||{}).name){d[p]=m[p].DBF.name,++v;continue}if(d[p]!=null){if(++v,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(g=0;g<1024;++g)if(d.indexOf(d[p]+"_"+g)==-1){d[p]+="_"+g;break}}}}var x=Be(o["!ref"]),O=[],I=[],A=[];for(p=0;p<=x.e.c-x.s.c;++p){var k="",D="",N=0,M=[];for(g=0;g<h.length;++g)h[g][p]!=null&&M.push(h[g][p]);if(M.length==0||d[p]==null){O[p]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=M[g]instanceof Date?"D":"C";break;default:D="C"}N=Math.max(N,String(M[g]).length),k=k&&k!=D?"C":D}N>250&&(N=250),D=((m[p]||{}).DBF||{}).type,D=="C"&&m[p].DBF.len>N&&(N=m[p].DBF.len),k=="B"&&D=="N"&&(k="N",A[p]=m[p].DBF.dec,N=m[p].DBF.len),I[p]=k=="C"||D=="N"?N:i[k]||0,y+=I[p],O[p]=k}var G=f.next(32);for(G.write_shift(4,318902576),G.write_shift(4,h.length),G.write_shift(2,296+32*v),G.write_shift(2,y),p=0;p<4;++p)G.write_shift(4,0);for(G.write_shift(4,0|(+r[za]||3)<<8),p=0,g=0;p<d.length;++p)if(d[p]!=null){var L=f.next(32),ee=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,ee,"sbcs"),L.write_shift(1,O[p]=="?"?"C":O[p],"sbcs"),L.write_shift(4,g),L.write_shift(1,I[p]||i[O[p]]||0),L.write_shift(1,A[p]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),g+=I[p]||i[O[p]]||0}var fe=f.next(264);for(fe.write_shift(4,13),p=0;p<65;++p)fe.write_shift(4,0);for(p=0;p<h.length;++p){var Z=f.next(y);for(Z.write_shift(1,0),g=0;g<d.length;++g)if(d[g]!=null)switch(O[g]){case"L":Z.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":Z.write_shift(8,h[p][g]||0,"f");break;case"N":var pe="0";for(typeof h[p][g]=="number"&&(pe=h[p][g].toFixed(A[g]||0)),v=0;v<I[g]-pe.length;++v)Z.write_shift(1,32);Z.write_shift(1,pe,"sbcs");break;case"D":h[p][g]?(Z.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var J=String(h[p][g]!=null?h[p][g]:"").slice(0,I[g]);for(Z.write_shift(1,J,"sbcs"),v=0;v<I[g]-J.length;++v)Z.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:s}})(),B0=(function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+nt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,h){var m=e[h];return typeof m=="number"?kc(m):m},a=function(d,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?d:kc(p)};e["|"]=254;function n(d,h){switch(h.type){case"base64":return i(Qt(d),h);case"binary":return i(d,h);case"buffer":return i(Ae&&Buffer.isBuffer(d)?d.toString("binary"):aa(d),h);case"array":return i(va(d),h)}throw new Error("Unrecognized type "+h.type)}function i(d,h){var m=d.split(/[\n\r]+/),p=-1,g=-1,v=0,y=0,x=[],O=[],I=null,A={},k=[],D=[],N=[],M=0,G;for(+h.codepage>=0&&gr(+h.codepage);v!==m.length;++v){M=0;var L=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,t),ee=L.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),fe=ee[0],Z;if(L.length>0)switch(fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&O.push(L.slice(3).replace(/;;/g,";"));break;case"C":var pe=!1,J=!1,ge=!1,te=!1,ue=-1,V=-1;for(y=1;y<ee.length;++y)switch(ee[y].charAt(0)){case"A":break;case"X":g=parseInt(ee[y].slice(1))-1,J=!0;break;case"Y":for(p=parseInt(ee[y].slice(1))-1,J||(g=0),G=x.length;G<=p;++G)x[G]=[];break;case"K":Z=ee[y].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(vr(Z))?isNaN(Xa(Z).getDate())||(Z=Ke(Z)):(Z=vr(Z),I!==null&&Ka(I)&&(Z=Mi(Z))),typeof $e!="undefined"&&typeof Z=="string"&&(h||{}).type!="string"&&(h||{}).codepage&&(Z=$e.utils.decode(h.codepage,Z)),pe=!0;break;case"E":te=!0;var C=Wa(ee[y].slice(1),{r:p,c:g});x[p][g]=[x[p][g],C];break;case"S":ge=!0,x[p][g]=[x[p][g],"S5S"];break;case"G":break;case"R":ue=parseInt(ee[y].slice(1))-1;break;case"C":V=parseInt(ee[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}if(pe&&(x[p][g]&&x[p][g].length==2?x[p][g][0]=Z:x[p][g]=Z,I=null),ge){if(te)throw new Error("SYLK shared formula cannot have own formula");var B=ue>-1&&x[ue][V];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");x[p][g][1]=tf(B[1],{r:p-ue,c:g-V})}break;case"F":var R=0;for(y=1;y<ee.length;++y)switch(ee[y].charAt(0)){case"X":g=parseInt(ee[y].slice(1))-1,++R;break;case"Y":for(p=parseInt(ee[y].slice(1))-1,G=x.length;G<=p;++G)x[G]=[];break;case"M":M=parseInt(ee[y].slice(1))/20;break;case"F":break;case"G":break;case"P":I=O[parseInt(ee[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=ee[y].slice(1).split(" "),G=parseInt(N[0],10);G<=parseInt(N[1],10);++G)M=parseInt(N[2],10),D[G-1]=M===0?{hidden:!0}:{wch:M},ea(D[G-1]);break;case"C":g=parseInt(ee[y].slice(1))-1,D[g]||(D[g]={});break;case"R":p=parseInt(ee[y].slice(1))-1,k[p]||(k[p]={}),M>0?(k[p].hpt=M,k[p].hpx=qa(M)):M===0&&(k[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}R<1&&(I=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}}return k.length>0&&(A["!rows"]=k),D.length>0&&(A["!cols"]=D),h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),[x,A]}function s(d,h){var m=n(d,h),p=m[0],g=m[1],v=Qa(p,h);return nt(g).forEach(function(y){v[y]=g[y]}),v}function o(d,h){return na(s(d,h),h)}function c(d,h,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(d.t){case"n":g+=d.v||0,d.f&&!d.F&&(g+=";E"+To(d.f,{r:m,c:p}));break;case"b":g+=d.v?"TRUE":"FALSE";break;case"e":g+=d.w||d.v;break;case"d":g+='"'+(d.w||d.v)+'"';break;case"s":g+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function l(d,h){h.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Ln(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Bn(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&d.push(g)})}function f(d,h){h.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*Mn(m.hpx)+";"),g.length>2&&d.push(g+"R"+(p+1))})}function u(d,h){var m=["ID;PWXL;N;E"],p=[],g=Be(d["!ref"]),v,y=Array.isArray(d),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&l(m,d["!cols"]),d["!rows"]&&f(m,d["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var O=g.s.r;O<=g.e.r;++O)for(var I=g.s.c;I<=g.e.c;++I){var A=ve({r:O,c:I});v=y?(d[O]||[])[I]:d[A],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,d,O,I,h))}return m.join(x)+x+p.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:u}})(),M0=(function(){function e(i,s){switch(s.type){case"base64":return r(Qt(i),s);case"binary":return r(i,s);case"buffer":return r(Ae&&Buffer.isBuffer(i)?i.toString("binary"):aa(i),s);case"array":return r(va(i),s)}throw new Error("Unrecognized type "+s.type)}function r(i,s){for(var o=i.split(`
`),c=-1,l=-1,f=0,u=[];f!==o.length;++f){if(o[f].trim()==="BOT"){u[++c]=[],l=0;continue}if(!(c<0)){var d=o[f].trim().split(","),h=d[0],m=d[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+h){case-1:if(p==="BOT"){u[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[c][l]=!0:p==="FALSE"?u[c][l]=!1:isNaN(vr(m))?isNaN(Xa(m).getDate())?u[c][l]=m:u[c][l]=Ke(m):u[c][l]=vr(m),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),mn&&p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(u=u.slice(0,s.sheetRows)),u}function t(i,s){return Qa(e(i,s),s)}function a(i,s){return na(t(i,s),s)}var n=(function(){var i=function(c,l,f,u,d){c.push(l),c.push(f+","+u),c.push('"'+d.replace(/"/g,'""')+'"')},s=function(c,l,f,u){c.push(l+","+f),c.push(l==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var l=[],f=Be(c["!ref"]),u,d=Array.isArray(c);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,f.e.r-f.s.r+1,""),i(l,"TUPLES",0,f.e.c-f.s.c+1,""),i(l,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){s(l,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var p=ve({r:h,c:m});if(u=d?(c[h]||[])[m]:c[p],!u){s(l,1,0,"");continue}switch(u.t){case"n":var g=mn?u.w:u.v;!g&&u.v!=null&&(g=u.v),g==null?mn&&u.f&&!u.F?s(l,1,0,"="+u.f):s(l,1,0,""):s(l,0,g,"V");break;case"b":s(l,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":s(l,1,0,!mn||isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=fr(u.z||xe[14],yt(Ke(u.v)))),mn?s(l,0,u.w,"V"):s(l,1,0,u.w);break;default:s(l,1,0,"")}}}s(l,-1,0,"EOD");var v=`\r
`,y=l.join(v);return y}})();return{to_workbook:a,to_sheet:t,from_sheet:n}})(),U0=(function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(u,d){for(var h=u.split(`
`),m=-1,p=-1,g=0,v=[];g!==h.length;++g){var y=h[g].trim().split(":");if(y[0]==="cell"){var x=et(y[1]);if(v.length<=x.r)for(m=v.length;m<=x.r;++m)v[m]||(v[m]=[]);switch(m=x.r,p=x.c,y[2]){case"t":v[m][p]=e(y[3]);break;case"v":v[m][p]=+y[3];break;case"vtf":var O=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][p]=!!+y[4];break;default:v[m][p]=+y[4];break}y[2]=="vtf"&&(v[m][p]=[v[m][p],O])}}}return d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),v}function a(u,d){return Qa(t(u,d),d)}function n(u,d){return na(a(u,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(u){if(!u||!u["!ref"])return"";for(var d=[],h=[],m,p="",g=Xt(u["!ref"]),v=Array.isArray(u),y=g.s.r;y<=g.e.r;++y)for(var x=g.s.c;x<=g.e.c;++x)if(p=ve({r:y,c:x}),m=v?(u[y]||[])[x]:u[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(r(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=r(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=r(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var O=yt(Ke(m.v));h[2]="vtc",h[3]="nd",h[4]=""+O,h[5]=m.w||fr(m.z||xe[14],O);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(u){return[i,s,o,s,l(u),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}})(),Ya=(function(){function e(f,u,d,h,m){m.raw?u[d][h]=f:f===""||(f==="TRUE"?u[d][h]=!0:f==="FALSE"?u[d][h]=!1:isNaN(vr(f))?isNaN(Xa(f).getDate())?u[d][h]=f:u[d][h]=Ke(f):u[d][h]=vr(f))}function r(f,u){var d=u||{},h=[];if(!f||f.length===0)return h;for(var m=f.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,v=0,y=0;y<=p;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,g=Math.max(g,v);for(y=0;y<=p;++y){h[y]=[];var x=0;for(e(m[y].slice(0,g).trim(),h,y,x,d),x=1;x<=(m[y].length-g)/10+1;++x)e(m[y].slice(g+(x-1)*10,g+x*10).trim(),h,y,x,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var u={},d=!1,h=0,m=0;h<f.length;++h)(m=f.charCodeAt(h))==34?d=!d:!d&&m in t&&(u[m]=(u[m]||0)+1);m=[];for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&m.push([u[h],h]);if(!m.length){u=a;for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&m.push([u[h],h])}return m.sort(function(p,g){return p[0]-g[0]||a[p[1]]-a[g[1]]}),t[m.pop()[1]]||44}function i(f,u){var d=u||{},h="";at!=null&&d.dense==null&&(d.dense=at);var m=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=n(f.slice(0,1024)):d&&d.FS?h=d.FS:h=n(f.slice(0,1024));var g=0,v=0,y=0,x=0,O=0,I=h.charCodeAt(0),A=!1,k=0,D=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var N=d.dateNF!=null?jd(d.dateNF):null;function M(){var G=f.slice(x,O),L={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)L.t="z";else if(d.raw)L.t="s",L.v=G;else if(G.trim().length===0)L.t="s",L.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(L.t="s",L.v=G.slice(2,-1).replace(/""/g,'"')):gx(G)?(L.t="n",L.f=G.slice(1)):(L.t="s",L.v=G);else if(G=="TRUE")L.t="b",L.v=!0;else if(G=="FALSE")L.t="b",L.v=!1;else if(!isNaN(y=vr(G)))L.t="n",d.cellText!==!1&&(L.w=G),L.v=y;else if(!isNaN(Xa(G).getDate())||N&&G.match(N)){L.z=d.dateNF||xe[14];var ee=0;N&&G.match(N)&&(G=Hd(G,d.dateNF,G.match(N)||[]),ee=1),d.cellDates?(L.t="d",L.v=Ke(G,ee)):(L.t="n",L.v=yt(Ke(G,ee))),d.cellText!==!1&&(L.w=fr(L.z,L.v instanceof Date?yt(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=G;if(L.t=="z"||(d.dense?(m[g]||(m[g]=[]),m[g][v]=L):m[ve({c:v,r:g})]=L),x=O+1,D=f.charCodeAt(x),p.e.c<v&&(p.e.c=v),p.e.r<g&&(p.e.r=g),k==I)++v;else if(v=0,++g,d.sheetRows&&d.sheetRows<=g)return!0}e:for(;O<f.length;++O)switch(k=f.charCodeAt(O)){case 34:D===34&&(A=!A);break;case I:case 10:case 13:if(!A&&M())break e;break;default:break}return O-x>0&&M(),m["!ref"]=Ee(p),m}function s(f,u){return!(u&&u.PRN)||u.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,u):Qa(r(f,u),u)}function o(f,u){var d="",h=u.type=="string"?[0,0,0,0]:Po(f,u);switch(u.type){case"base64":d=Qt(f);break;case"binary":d=f;break;case"buffer":u.codepage==65001?d=f.toString("utf8"):u.codepage&&typeof $e!="undefined"?d=$e.utils.decode(u.codepage,f):d=Ae&&Buffer.isBuffer(f)?f.toString("binary"):aa(f);break;case"array":d=va(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+u.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=ze(d.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?d=ze(d):u.type=="binary"&&typeof $e!="undefined"&&u.codepage&&(d=$e.utils.decode(u.codepage,$e.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?U0.to_sheet(u.type=="string"?d:ze(d),u):s(d,u)}function c(f,u){return na(o(f,u),u)}function l(f){for(var u=[],d=Be(f["!ref"]),h,m=Array.isArray(f),p=d.s.r;p<=d.e.r;++p){for(var g=[],v=d.s.c;v<=d.e.c;++v){var y=ve({r:p,c:v});if(h=m?(f[p]||[])[v]:f[y],!h||h.v==null){g.push("          ");continue}for(var x=(h.w||(Ur(h),h.w)||"").slice(0,10);x.length<10;)x+=" ";g.push(x+(v===0?" ":""))}u.push(g.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}})();function rm(e,r){var t=r||{},a=!!t.WTF;t.WTF=!0;try{var n=B0.to_workbook(e,t);return t.WTF=a,n}catch(i){if(t.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Ya.to_workbook(e,r)}}var ma=(function(){function e(C,B,R){if(C){bt(C,C.l||0);for(var P=R.Enum||ue;C.l<C.length;){var z=C.read_shift(2),ce=P[z]||P[65535],re=C.read_shift(2),ae=C.l+re,q=ce.f&&ce.f(C,re,R);if(C.l=ae,B(q,ce,z))return}}}function r(C,B){switch(B.type){case"base64":return t(Jt(Qt(C)),B);case"binary":return t(Jt(C),B);case"buffer":case"array":return t(C,B)}throw"Unsupported type "+B.type}function t(C,B){if(!C)return C;var R=B||{};at!=null&&R.dense==null&&(R.dense=at);var P=R.dense?[]:{},z="Sheet1",ce="",re=0,ae={},q=[],ke=[],F={s:{r:0,c:0},e:{r:0,c:0}},je=R.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)R.Enum=ue,e(C,function(de,st,tr){switch(tr){case 0:R.vers=de,de>=4096&&(R.qpro=!0);break;case 6:F=de;break;case 204:de&&(ce=de);break;case 222:ce=de;break;case 15:case 51:R.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:tr==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=R.dateNF||xe[14],R.cellDates&&(de[1].t="d",de[1].v=Mi(de[1].v))),R.qpro&&de[3]>re&&(P["!ref"]=Ee(F),ae[z]=P,q.push(z),P=R.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},re=de[3],z=ce||"Sheet"+(re+1),ce="");var wr=R.dense?(P[de[0].r]||[])[de[0].c]:P[ve(de[0])];if(wr){wr.t=de[1].t,wr.v=de[1].v,de[1].z!=null&&(wr.z=de[1].z),de[1].f!=null&&(wr.f=de[1].f);break}R.dense?(P[de[0].r]||(P[de[0].r]=[]),P[de[0].r][de[0].c]=de[1]):P[ve(de[0])]=de[1];break;default:}},R);else if(C[2]==26||C[2]==14)R.Enum=V,C[2]==14&&(R.qpro=!0,C.l=0),e(C,function(de,st,tr){switch(tr){case 204:z=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>re&&(P["!ref"]=Ee(F),ae[z]=P,q.push(z),P=R.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},re=de[3],z="Sheet"+(re+1)),je>0&&de[0].r>=je)break;R.dense?(P[de[0].r]||(P[de[0].r]=[]),P[de[0].r][de[0].c]=de[1]):P[ve(de[0])]=de[1],F.e.c<de[0].c&&(F.e.c=de[0].c),F.e.r<de[0].r&&(F.e.r=de[0].r);break;case 27:de[14e3]&&(ke[de[14e3][0]]=de[14e3][1]);break;case 1537:ke[de[0]]=de[1],de[0]==re&&(z=de[1]);break;default:break}},R);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(P["!ref"]=Ee(F),ae[ce||z]=P,q.push(ce||z),!ke.length)return{SheetNames:q,Sheets:ae};for(var Ie={},He=[],Re=0;Re<ke.length;++Re)ae[q[Re]]?(He.push(ke[Re]||q[Re]),Ie[ke[Re]]=ae[ke[Re]]||ae[q[Re]]):(He.push(ke[Re]),Ie[ke[Re]]={"!ref":"A1"});return{SheetNames:He,Sheets:Ie}}function a(C,B){var R=B||{};if(+R.codepage>=0&&gr(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var P=zt(),z=Be(C["!ref"]),ce=Array.isArray(C),re=[];ie(P,0,i(1030)),ie(P,6,c(z));for(var ae=Math.min(z.e.r,8191),q=z.s.r;q<=ae;++q)for(var ke=lt(q),F=z.s.c;F<=z.e.c;++F){q===z.s.r&&(re[F]=Qe(F));var je=re[F]+ke,Ie=ce?(C[q]||[])[F]:C[je];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")(Ie.v|0)==Ie.v&&Ie.v>=-32768&&Ie.v<=32767?ie(P,13,h(q,F,Ie.v)):ie(P,14,p(q,F,Ie.v));else{var He=Ur(Ie);ie(P,15,u(q,F,He.slice(0,239)))}}return ie(P,1),P.end()}function n(C,B){var R=B||{};if(+R.codepage>=0&&gr(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var P=zt();ie(P,0,s(C));for(var z=0,ce=0;z<C.SheetNames.length;++z)(C.Sheets[C.SheetNames[z]]||{})["!ref"]&&ie(P,27,te(C.SheetNames[z],ce++));var re=0;for(z=0;z<C.SheetNames.length;++z){var ae=C.Sheets[C.SheetNames[z]];if(!(!ae||!ae["!ref"])){for(var q=Be(ae["!ref"]),ke=Array.isArray(ae),F=[],je=Math.min(q.e.r,8191),Ie=q.s.r;Ie<=je;++Ie)for(var He=lt(Ie),Re=q.s.c;Re<=q.e.c;++Re){Ie===q.s.r&&(F[Re]=Qe(Re));var de=F[Re]+He,st=ke?(ae[Ie]||[])[Re]:ae[de];if(!(!st||st.t=="z"))if(st.t=="n")ie(P,23,M(Ie,Re,re,st.v));else{var tr=Ur(st);ie(P,22,k(Ie,Re,re,tr.slice(0,239)))}}++re}}return ie(P,1),P.end()}function i(C){var B=X(2);return B.write_shift(2,C),B}function s(C){var B=X(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var R=0,P=0,z=0,ce=0;ce<C.SheetNames.length;++ce){var re=C.SheetNames[ce],ae=C.Sheets[re];if(!(!ae||!ae["!ref"])){++z;var q=Xt(ae["!ref"]);R<q.e.r&&(R=q.e.r),P<q.e.c&&(P=q.e.c)}}return R>8191&&(R=8191),B.write_shift(2,R),B.write_shift(1,z),B.write_shift(1,P),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function o(C,B,R){var P={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&R.qpro?(P.s.c=C.read_shift(1),C.l++,P.s.r=C.read_shift(2),P.e.c=C.read_shift(1),C.l++,P.e.r=C.read_shift(2),P):(P.s.c=C.read_shift(2),P.s.r=C.read_shift(2),B==12&&R.qpro&&(C.l+=2),P.e.c=C.read_shift(2),P.e.r=C.read_shift(2),B==12&&R.qpro&&(C.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function c(C){var B=X(8);return B.write_shift(2,C.s.c),B.write_shift(2,C.s.r),B.write_shift(2,C.e.c),B.write_shift(2,C.e.r),B}function l(C,B,R){var P=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(P[0].c=C.read_shift(1),P[3]=C.read_shift(1),P[0].r=C.read_shift(2),C.l+=2):(P[2]=C.read_shift(1),P[0].c=C.read_shift(2),P[0].r=C.read_shift(2)),P}function f(C,B,R){var P=C.l+B,z=l(C,B,R);if(z[1].t="s",R.vers==20768){C.l++;var ce=C.read_shift(1);return z[1].v=C.read_shift(ce,"utf8"),z}return R.qpro&&C.l++,z[1].v=C.read_shift(P-C.l,"cstr"),z}function u(C,B,R){var P=X(7+R.length);P.write_shift(1,255),P.write_shift(2,B),P.write_shift(2,C),P.write_shift(1,39);for(var z=0;z<P.length;++z){var ce=R.charCodeAt(z);P.write_shift(1,ce>=128?95:ce)}return P.write_shift(1,0),P}function d(C,B,R){var P=l(C,B,R);return P[1].v=C.read_shift(2,"i"),P}function h(C,B,R){var P=X(7);return P.write_shift(1,255),P.write_shift(2,B),P.write_shift(2,C),P.write_shift(2,R,"i"),P}function m(C,B,R){var P=l(C,B,R);return P[1].v=C.read_shift(8,"f"),P}function p(C,B,R){var P=X(13);return P.write_shift(1,255),P.write_shift(2,B),P.write_shift(2,C),P.write_shift(8,R,"f"),P}function g(C,B,R){var P=C.l+B,z=l(C,B,R);if(z[1].v=C.read_shift(8,"f"),R.qpro)C.l=P;else{var ce=C.read_shift(2);O(C.slice(C.l,C.l+ce),z),C.l+=ce}return z}function v(C,B,R){var P=B&32768;return B&=-32769,B=(P?C:0)+(B>=8192?B-16384:B),(P?"":"$")+(R?Qe(B):lt(B))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(C,B){bt(C,0);for(var R=[],P=0,z="",ce="",re="",ae="";C.l<C.length;){var q=C[C.l++];switch(q){case 0:R.push(C.read_shift(8,"f"));break;case 1:ce=v(B[0].c,C.read_shift(2),!0),z=v(B[0].r,C.read_shift(2),!1),R.push(ce+z);break;case 2:{var ke=v(B[0].c,C.read_shift(2),!0),F=v(B[0].r,C.read_shift(2),!1);ce=v(B[0].c,C.read_shift(2),!0),z=v(B[0].r,C.read_shift(2),!1),R.push(ke+F+":"+ce+z)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(C.read_shift(2));break;case 6:{for(var je="";q=C[C.l++];)je+=String.fromCharCode(q);R.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:ae=R.pop(),re=R.pop(),R.push(["AND","OR"][q-20]+"("+re+","+ae+")");break;default:if(q<32&&x[q])ae=R.pop(),re=R.pop(),R.push(re+x[q]+ae);else if(y[q]){if(P=y[q][1],P==69&&(P=C[C.l++]),P>R.length){console.error("WK1 bad formula parse 0x"+q.toString(16)+":|"+R.join("|")+"|");return}var Ie=R.slice(-P);R.length-=P,R.push(y[q][0]+"("+Ie.join(",")+")")}else return q<=7?console.error("WK1 invalid opcode "+q.toString(16)):q<=24?console.error("WK1 unsupported op "+q.toString(16)):q<=30?console.error("WK1 invalid opcode "+q.toString(16)):q<=115?console.error("WK1 unsupported function opcode "+q.toString(16)):console.error("WK1 unrecognized opcode "+q.toString(16))}}R.length==1?B[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function I(C){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=C.read_shift(2),B[3]=C[C.l++],B[0].c=C[C.l++],B}function A(C,B){var R=I(C,B);return R[1].t="s",R[1].v=C.read_shift(B-4,"cstr"),R}function k(C,B,R,P){var z=X(6+P.length);z.write_shift(2,C),z.write_shift(1,R),z.write_shift(1,B),z.write_shift(1,39);for(var ce=0;ce<P.length;++ce){var re=P.charCodeAt(ce);z.write_shift(1,re>=128?95:re)}return z.write_shift(1,0),z}function D(C,B){var R=I(C,B);R[1].v=C.read_shift(2);var P=R[1].v>>1;if(R[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return R[1].v=P,R}function N(C,B){var R=I(C,B),P=C.read_shift(4),z=C.read_shift(4),ce=C.read_shift(2);if(ce==65535)return P===0&&z===3221225472?(R[1].t="e",R[1].v=15):P===0&&z===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var re=ce&32768;return ce=(ce&32767)-16446,R[1].v=(1-re*2)*(z*Math.pow(2,ce+32)+P*Math.pow(2,ce)),R}function M(C,B,R,P){var z=X(14);if(z.write_shift(2,C),z.write_shift(1,R),z.write_shift(1,B),P==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var ce=0,re=0,ae=0,q=0;return P<0&&(ce=1,P=-P),re=Math.log2(P)|0,P/=Math.pow(2,re-31),q=P>>>0,(q&2147483648)==0&&(P/=2,++re,q=P>>>0),P-=q,q|=2147483648,q>>>=0,P*=Math.pow(2,32),ae=P>>>0,z.write_shift(4,ae),z.write_shift(4,q),re+=16383+(ce?32768:0),z.write_shift(2,re),z}function G(C,B){var R=N(C,14);return C.l+=B-14,R}function L(C,B){var R=I(C,B),P=C.read_shift(4);return R[1].v=P>>6,R}function ee(C,B){var R=I(C,B),P=C.read_shift(8,"f");return R[1].v=P,R}function fe(C,B){var R=ee(C,14);return C.l+=B-10,R}function Z(C,B){return C[C.l+B-1]==0?C.read_shift(B,"cstr"):""}function pe(C,B){var R=C[C.l++];R>B-1&&(R=B-1);for(var P="";P.length<R;)P+=String.fromCharCode(C[C.l++]);return P}function J(C,B,R){if(!(!R.qpro||B<21)){var P=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var z=C.read_shift(B-21,"cstr");return[P,z]}}function ge(C,B){for(var R={},P=C.l+B;C.l<P;){var z=C.read_shift(2);if(z==14e3){for(R[z]=[0,""],R[z][0]=C.read_shift(2);C[C.l];)R[z][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return R}function te(C,B){var R=X(5+C.length);R.write_shift(2,14e3),R.write_shift(2,B);for(var P=0;P<C.length;++P){var z=C.charCodeAt(P);R[R.l++]=z>127?95:z}return R[R.l++]=0,R}var ue={0:{n:"BOF",f:mt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:pe},65535:{n:""}},V={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}})();function am(e){var r={},t=e.match(Mt),a=0,n=!1;if(t)for(;a!=t.length;++a){var i=ye(t[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;r.cp=Gs[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return r}var nm=(function(){var e=In("t"),r=In("rPr");function t(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Le(s[1])},c=i.match(r);return c&&(o.s=am(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(s){return s.replace(a,"").split(n).map(t).filter(function(o){return o.v})}})(),im=(function(){var r=/(\r\n|\n)/g;function t(n,i,s){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),s.push("</b>")),n.i&&(i.push("<i>"),s.push("</i>")),n.strike&&(i.push("<s>"),s.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&t(n.s,i[0],i[2]),i[0].join("")+i[1].replace(r,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),sm=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,om=/<(?:\w+:)?r>/,cm=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function wo(e,r){var t=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Le(ze(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ze(e),t&&(a.h=to(a.t))):e.match(om)&&(a.r=ze(e),a.t=Le(ze((e.replace(cm,"").match(sm)||[]).join("").replace(Mt,""))),t&&(a.h=im(nm(a.r)))),a):{t:""}}var lm=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,fm=/<(?:\w+:)?(?:si|sstItem)>/g,um=/<\/(?:\w+:)?(?:si|sstItem)>/;function dm(e,r){var t=[],a="";if(!e)return t;var n=e.match(lm);if(n){a=n[2].replace(fm,"").split(um);for(var i=0;i!=a.length;++i){var s=wo(a[i].trim(),r);s!=null&&(t[t.length]=s)}n=ye(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}var hm=/^\s|\s$|[\t\n\r]/;function $0(e,r){if(!r.bookSST)return"";var t=[ft];t[t.length]=ne("sst",null,{xmlns:Ea[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(hm)&&(i+=' xml:space="preserve"'),i+=">"+Ge(n.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function pm(e){return[e.read_shift(4),e.read_shift(4)]}function mm(e,r){var t=[],a=!1;return jr(e,function(i,s,o){switch(o){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T,!a||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function gm(e,r){return r||(r=X(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var xm=Ch;function vm(e){var r=zt();K(r,159,gm(e));for(var t=0;t<e.length;++t)K(r,19,xm(e[t]));return K(r,160),r.end()}function j0(e){if(typeof $e!="undefined")return $e.utils.encode(za,e);for(var r=[],t=e.split(""),a=0;a<t.length;++a)r[a]=t[a].charCodeAt(0);return r}function Mr(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function ym(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Mr(e,4),r.U=Mr(e,4),r.W=Mr(e,4),r}function wm(e){for(var r=e.read_shift(4),t=e.l+r-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function _m(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(wm(e));return r}function km(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function Em(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Mr(e,4),r.U=Mr(e,4),r.W=Mr(e,4),r}function Sm(e){var r=Em(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function H0(e,r){var t=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,a}function V0(e,r){var t={},a=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function Tm(e){var r=Mr(e);switch(r.Minor){case 2:return[r.Minor,bm(e,r)];case 3:return[r.Minor,Cm(e,r)];case 4:return[r.Minor,Am(e,r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function bm(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),a=H0(e,t),n=V0(e,e.length-e.l);return{t:"Std",h:a,v:n}}function Cm(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Am(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),a={};return t.replace(Mt,function(i){var s=ye(i);switch(Cr(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){a[o]=s[o]});break;case"<dataIntegrity":a.encryptedHmacKey=s.encryptedHmacKey,a.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(s);break;default:throw s[0]}}),a}function Om(e,r){var t={},a=t.EncryptionVersionInfo=Mr(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e.read_shift(4),r-=4;var n=e.read_shift(4);return r-=4,t.EncryptionHeader=H0(e,n),r-=n,t.EncryptionVerifier=V0(e,r),t}function Fm(e){var r={},t=r.EncryptionVersionInfo=Mr(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function _o(e){var r=0,t,a=j0(e),n=a.length+1,i,s,o,c,l;for(t=Qr(n),t[0]=a.length,i=1;i!=n;++i)t[i]=a[i-1];for(i=n-1;i>=0;--i)s=t[i],o=(r&16384)===0?0:1,c=r<<1&32767,l=o|c,r=l^s;return r^52811}var W0=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(s){return(s/2|s*128)&255},n=function(s,o){return a(s^o)},i=function(s){for(var o=r[s.length-1],c=104,l=s.length-1;l>=0;--l)for(var f=s[l],u=0;u!=7;++u)f&64&&(o^=t[c]),f*=2,--c;return o};return function(s){for(var o=j0(s),c=i(o),l=o.length,f=Qr(16),u=0;u!=16;++u)f[u]=0;var d,h,m;for((l&1)===1&&(d=c>>8,f[l]=n(e[0],d),--l,d=c&255,h=o[o.length-1],f[l]=n(h,d));l>0;)--l,d=c>>8,f[l]=n(o[l],d),--l,d=c&255,f[l]=n(o[l],d);for(l=15,m=15-o.length;m>0;)d=c>>8,f[l]=n(e[m],d),--l,--m,d=c&255,f[l]=n(o[l],d),--l,--m;return f}})(),Im=function(e,r,t,a,n){n||(n=r),a||(a=W0(e));var i,s;for(i=0;i!=r.length;++i)s=r[i],s^=a[t],s=(s>>5|s<<3)&255,n[i]=s,++t;return[n,t,a]},Rm=function(e){var r=0,t=W0(e);return function(a){var n=Im("",a,r,t);return r=n[1],n[0]}};function Pm(e,r,t,a){var n={key:mt(e),verificationBytes:mt(e)};return t.password&&(n.verifier=_o(t.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Rm(t.password)),n}function Nm(e,r,t){var a=t||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Fm(e,r):a.Data=Om(e,r),a}function Dm(e,r,t){var a={Type:t.biff>=8?e.read_shift(2):0};return a.Type?Nm(e,r-2,a):Pm(e,t.biff>=8?r:r-2,t,a),a}var G0=(function(){function e(n,i){switch(i.type){case"base64":return r(Qt(n),i);case"binary":return r(n,i);case"buffer":return r(Ae&&Buffer.isBuffer(n)?n.toString("binary"):aa(n),i);case"array":return r(va(n),i)}throw new Error("Unrecognized type "+i.type)}function r(n,i){var s=i||{},o=s.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,u){Array.isArray(o)&&(o[u]=[]);for(var d=/\\\w+\b/g,h=0,m,p=-1;m=d.exec(f);){switch(m[0]){case"\\cell":var g=f.slice(h,d.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[u][p]=v:o[ve({r:u,c:p})]=v}break}h=d.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=Ee(l),o}function t(n,i){return na(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],s=Be(n["!ref"]),o,c=Array.isArray(n),l=s.s.r;l<=s.e.r;++l){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var u=ve({r:l,c:f});o=c?(n[l]||[])[f]:n[u],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ur(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:a}})();function Lm(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Dn(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Bm(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255,n=Math.max(r,t,a),i=Math.min(r,t,a),s=n-i;if(s===0)return[0,0,r];var o=0,c=0,l=n+i;switch(c=s/(l>1?2-l:l),n){case r:o=((t-a)/s+6)%6;break;case t:o=(a-r)/s+2;break;case a:o=(r-t)/s+4;break}return[o/6,c,l/2]}function Mm(e){var r=e[0],t=e[1],a=e[2],n=t*2*(a<.5?a:1-a),i=a-n/2,s=[i,i,i],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=n*o,s[0]+=n,s[1]+=c;break;case 1:c=n*(2-o),s[0]+=c,s[1]+=n;break;case 2:c=n*(o-2),s[1]+=n,s[2]+=c;break;case 3:c=n*(4-o),s[1]+=c,s[2]+=n;break;case 4:c=n*(o-4),s[2]+=n,s[0]+=c;break;case 5:c=n*(6-o),s[2]+=c,s[0]+=n;break}for(var l=0;l!=3;++l)s[l]=Math.round(s[l]*255);return s}function Fi(e,r){if(r===0)return e;var t=Bm(Lm(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Dn(Mm(t))}var z0=6,Um=15,$m=1,Pt=z0;function Ln(e){return Math.floor((e+Math.round(128/Pt)/256)*Pt)}function Bn(e){return Math.floor((e-5)/Pt*100+.5)/100}function Ii(e){return Math.round((e*Pt+5)/Pt*256)/256}function Ss(e){return Ii(Bn(Ln(e)))}function ko(e){var r=Math.abs(e-Ss(e)),t=Pt;if(r>.005)for(Pt=$m;Pt<Um;++Pt)Math.abs(e-Ss(e))<=r&&(r=Math.abs(e-Ss(e)),t=Pt);Pt=t}function ea(e){e.width?(e.wpx=Ln(e.width),e.wch=Bn(e.wpx),e.MDW=Pt):e.wpx?(e.wch=Bn(e.wpx),e.width=Ii(e.wch),e.MDW=Pt):typeof e.wch=="number"&&(e.width=Ii(e.wch),e.wpx=Ln(e.width),e.MDW=Pt),e.customWidth&&delete e.customWidth}var jm=96,X0=jm;function Mn(e){return e*96/X0}function qa(e){return e*X0/96}var Hm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Vm(e,r,t,a){r.Borders=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ye(s);switch(Cr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=qe(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=qe(o.diagonalDown)),r.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Wm(e,r,t,a){r.Fills=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ye(s);switch(Cr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function Gm(e,r,t,a){r.Fonts=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ye(s);switch(Cr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=ze(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?qe(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?qe(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?qe(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?qe(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?qe(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?qe(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?qe(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Gs[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=qe(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=ha[n.color.index];n.color.index==81&&(c=ha[1]),c||(c=ha[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=Fi(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function zm(e,r,t){r.NumberFmt=[];for(var a=nt(xe),n=0;n<a.length;++n)r.NumberFmt[a[n]]=xe[a[n]];var i=e[0].match(Mt);if(i)for(n=0;n<i.length;++n){var s=ye(i[n]);switch(Cr(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Le(ze(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}Br(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function Xm(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var a=t[0];a<=t[1];++a)e[a]!=null&&(r[r.length]=ne("numFmt",null,{numFmtId:a,formatCode:Ge(e[a])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=ne("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var xi=["numFmtId","fillId","fontId","borderId","xfId"],vi=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Ym(e,r,t){r.CellXf=[];var a,n=!1;(e[0].match(Mt)||[]).forEach(function(i){var s=ye(i),o=0;switch(Cr(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=s,delete a[0],o=0;o<xi.length;++o)a[xi[o]]&&(a[xi[o]]=parseInt(a[xi[o]],10));for(o=0;o<vi.length;++o)a[vi[o]]&&(a[vi[o]]=qe(a[vi[o]]));if(r.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[o]){a.numFmtId=o;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=qe(s.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function qm(e){var r=[];return r[r.length]=ne("cellXfs",null),e.forEach(function(t){r[r.length]=ne("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=ne("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Km=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(r))&&zm(u,f,l),(u=o.match(n))&&Gm(u,f,c,l),(u=o.match(a))&&Wm(u,f,c,l),(u=o.match(i))&&Vm(u,f,c,l),(u=o.match(t))&&Ym(u,f,l),f}})();function Y0(e,r){var t=[ft,ne("styleSheet",null,{xmlns:Ea[0],"xmlns:vt":vt.vt})],a;return e.SSF&&(a=Xm(e.SSF))!=null&&(t[t.length]=a),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=qm(r.cellXfs))&&(t[t.length]=a),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Jm(e,r){var t=e.read_shift(2),a=Lt(e,r-2);return[t,a]}function Zm(e,r,t){t||(t=X(6+4*r.length)),t.write_shift(2,e),St(r,t);var a=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),a}function Qm(e,r,t){var a={};a.sz=e.read_shift(2)/20;var n=Nh(e,2,t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(a.underline=s);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=Ph(e,8),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Lt(e,r-21),a}function eg(e,r){r||(r=X(153)),r.write_shift(2,e.sz*20),Dh(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),Ci(e.color,r);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),r.write_shift(1,a),St(e.name,r),r.length>r.l?r.slice(0,r.l):r}var tg=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ts,rg=Bt;function dl(e,r){r||(r=X(84)),Ts||(Ts=Li(tg));var t=Ts[e.patternType];t==null&&(t=40),r.write_shift(4,t);var a=0;if(t!=40)for(Ci({auto:1},r),Ci({auto:1},r);a<12;++a)r.write_shift(4,0);else{for(;a<4;++a)r.write_shift(4,0);for(;a<12;++a)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function ag(e,r){var t=e.l+r,a=e.read_shift(2),n=e.read_shift(2);return e.l=t,{ixfe:a,numFmtId:n}}function q0(e,r,t){t||(t=X(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var a=0;return t.write_shift(1,a),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function gn(e,r){return r||(r=X(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var ng=Bt;function ig(e,r){return r||(r=X(51)),r.write_shift(1,0),gn(null,r),gn(null,r),gn(null,r),gn(null,r),gn(null,r),r.length>r.l?r.slice(0,r.l):r}function sg(e,r){return r||(r=X(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,+e.builtinId),r.write_shift(1,0),bi(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function og(e,r,t){var a=X(2052);return a.write_shift(4,e),bi(r,a),bi(t,a),a.length>a.l?a.slice(0,a.l):a}function cg(e,r,t){var a={};a.NumberFmt=[];for(var n in xe)a.NumberFmt[n]=xe[n];a.CellXf=[],a.Fonts=[];var i=[],s=!1;return jr(e,function(c,l,f){switch(f){case 44:a.NumberFmt[c[0]]=c[1],Br(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Fi(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(l.T>0)i.push(f);else if(l.T<0)i.pop();else if(!s||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}function lg(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&++t}),t!=0&&(K(e,615,yr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&K(e,44,Zm(n,r[n]))}),K(e,616))}}function fg(e){var r=1;r!=0&&(K(e,611,yr(r)),K(e,43,eg({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),K(e,612))}function ug(e){var r=2;r!=0&&(K(e,603,yr(r)),K(e,45,dl({patternType:"none"})),K(e,45,dl({patternType:"gray125"})),K(e,604))}function dg(e){var r=1;r!=0&&(K(e,613,yr(r)),K(e,46,ig({})),K(e,614))}function hg(e){var r=1;K(e,626,yr(r)),K(e,47,q0({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),K(e,627)}function pg(e,r){K(e,617,yr(r.length)),r.forEach(function(t){K(e,47,q0(t,0))}),K(e,618)}function mg(e){var r=1;K(e,619,yr(r)),K(e,48,sg({xfId:0,builtinId:0,name:"Normal"})),K(e,620)}function gg(e){var r=0;K(e,505,yr(r)),K(e,506)}function xg(e){var r=0;K(e,508,og(r,"TableStyleMedium9","PivotStyleMedium4")),K(e,509)}function vg(e,r){var t=zt();return K(t,278),lg(t,e.SSF),fg(t,e),ug(t,e),dg(t,e),hg(t,e),pg(t,r.cellXfs),mg(t,e),gg(t,e),xg(t,e),K(t,279),t.end()}var yg=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function wg(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(Mt)||[]).forEach(function(n){var i=ye(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(r.themeElements.clrScheme[yg.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function _g(){}function kg(){}var Eg=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Sg=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Tg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function bg(e,r,t){r.themeElements={};var a;[["clrScheme",Eg,wg],["fontScheme",Sg,_g],["fmtScheme",Tg,kg]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,t)})}var Cg=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function K0(e,r){(!e||e.length===0)&&(e=Eo());var t,a={};if(!(t=e.match(Cg)))throw new Error("themeElements not found in theme");return bg(t[0],a,r),a.raw=e,a}function Eo(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[ft];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Ag(e,r,t){var a=e.l+r,n=e.read_shift(4);if(n!==124226){if(!t.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var s;try{s=Xl(i,{type:"array"})}catch{return}var o=Zt(s,"theme/theme/theme1.xml",!0);if(o)return K0(o,t)}}function Og(e){return e.read_shift(4)}function Fg(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Ig(e,4);break;case 2:r.xclrValue=O0(e,4);break;case 3:r.xclrValue=Og(e,4);break;case 4:e.l+=4;break}return e.l+=8,r}function Ig(e,r){return Bt(e,r)}function Rg(e,r){return Bt(e,r)}function Pg(e){var r=e.read_shift(2),t=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Fg(e,t);break;case 6:a[1]=Rg(e,t);break;case 14:case 15:a[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return a}function Ng(e,r){var t=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(Pg(e,t-e.l));return{ixfe:a,ext:i}}function Dg(e,r){r.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function Lg(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Lt(e,r-8)}}function Bg(e){var r=X(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),St(e.name,r),r.slice(0,r.l)}function Mg(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Ug(e){var r=X(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function $g(e,r){var t=X(8+2*r.length);return t.write_shift(4,e),St(r,t),t.slice(0,t.l)}function jg(e){return e.l+=4,e.read_shift(4)!=0}function Hg(e,r){var t=X(8);return t.write_shift(4,e),t.write_shift(4,r?1:0),t}function Vg(e,r,t){var a={Types:[],Cell:[],Value:[]},n=t||{},i=[],s=!1,o=2;return jr(e,function(c,l,f){switch(f){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?a.Cell.push({type:a.Types[u[0]-1].name,index:u[1]}):o==0&&a.Value.push({type:a.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!l.T){if(!s||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function Wg(){var e=zt();return K(e,332),K(e,334,yr(1)),K(e,335,Bg({name:"XLDAPR",version:12e4,flags:3496657072})),K(e,336),K(e,339,$g(1,"XLDAPR")),K(e,52),K(e,35,yr(514)),K(e,4096,yr(0)),K(e,4097,cr(1)),K(e,36),K(e,53),K(e,340),K(e,337,Hg(1,!0)),K(e,51,Ug([[1,0]])),K(e,338),K(e,333),e.end()}function Gg(e,r,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,s;return e.replace(Mt,function(o){var c=ye(o);switch(Cr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==c.name&&(s=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function J0(){var e=[ft];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function zg(e){var r=[];if(!e)return r;var t=1;return(e.match(Mt)||[]).forEach(function(a){var n=ye(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,r.push(n);break}}),r}function Xg(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=ve(t);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function Yg(e,r,t){var a=[],n=!1;return jr(e,function(s,o,c){switch(c){case 63:a.push(s);break;default:if(!o.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),a}function qg(e,r,t,a){if(!e)return e;var n=a||{},i=!1,s=!1;jr(e,function(c,l,f){if(!s)switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},n)}function Kg(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var ja=1024;function Z0(e,r){for(var t=[21600,21600],a=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),n=[ne("xml",null,{"xmlns:v":Kt.v,"xmlns:o":Kt.o,"xmlns:x":Kt.x,"xmlns:mv":Kt.mv}).replace(/\/>/,">"),ne("o:shapelayout",ne("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ne("v:shapetype",[ne("v:stroke",null,{joinstyle:"miter"}),ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:a})];ja<e*1e3;)ja+=1e3;return r.forEach(function(i){var s=et(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ne("v:fill",c,o),f={on:"t",obscured:"t"};++ja,n=n.concat(["<v:shape"+Rn({id:"_x0000_s"+ja,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ne("v:shadow",null,f),ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ct("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Ct("x:AutoFill","False"),Ct("x:Row",String(s.r)),Ct("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function hl(e,r,t,a){var n=Array.isArray(e),i;r.forEach(function(s){var o=et(s.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[s.ref]=i;var c=Be(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ee(c);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:t};s.h&&(f.h=s.h);for(var u=i.c.length-1;u>=0;--u){if(!t&&i.c[u].T)return;t&&!i.c[u].T&&i.c.splice(u,1)}if(t&&a){for(u=0;u<a.length;++u)if(f.a==a[u].id){f.a=a[u].name||f.a;break}}i.c.push(f)})}function Jg(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=ye(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=et(c.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var u=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!u&&!!u[1]&&wo(u[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=d.h),a.push(l)}}}}),a}function Q0(e){var r=[ft,ne("comments",null,{xmlns:Ea[0]})],t=[];return r.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=Ge(n.a);t.indexOf(i)==-1&&(t.push(i),r.push("<author>"+i+"</author>")),n.T&&n.ID&&t.indexOf("tc="+n.ID)==-1&&(t.push("tc="+n.ID),r.push("<author>tc="+n.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=t.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=t.indexOf(Ge(c.a))),i.push(c.t||"")}),r.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)r.push(Ct("t",Ge(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;r.push(Ct("t",Ge(s)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Zg(e,r){var t=[],a=!1,n={},i=0;return e.replace(Mt,function(o,c){var l=ye(o);switch(Cr(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function Qg(e,r,t){var a=[ft,ne("ThreadedComments",null,{xmlns:vt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&r.indexOf(s.a)==-1&&r.push(s.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(s.a)).slice(-12)+"}"),a.push(ne("threadedComment",Ct("text",s.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function ex(e,r){var t=[],a=!1;return e.replace(Mt,function(i){var s=ye(i);switch(Cr(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),t}function tx(e){var r=[ft,ne("personList",null,{xmlns:vt.TCMNT,"xmlns:x":Ea[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,a){r.push(ne("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function rx(e){var r={};r.iauthor=e.read_shift(4);var t=Ca(e,16);return r.rfx=t.s,r.ref=ve(t.s),e.l+=16,r}function ax(e,r){return r==null&&(r=X(36)),r.write_shift(4,e[1].iauthor),en(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var nx=Lt;function ix(e){return St(e.slice(0,54))}function sx(e,r){var t=[],a=[],n={},i=!1;return jr(e,function(o,c,l){switch(l){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}function ox(e){var r=zt(),t=[];return K(r,628),K(r,630),e.forEach(function(a){a[1].forEach(function(n){t.indexOf(n.a)>-1||(t.push(n.a.slice(0,54)),K(r,632,ix(n.a)))})}),K(r,631),K(r,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=t.indexOf(n.a);var i={s:et(a[0]),e:et(a[0])};K(r,635,ax([i,n])),n.t&&n.t.length>0&&K(r,637,Oh(n)),K(r,636),delete n.iauthor})}),K(r,634),K(r,629),r.end()}var cx="application/vnd.ms-office.vbaProject";function lx(e){var r=me.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,a){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");me.utils.cfb_add(r,n,e.FileIndex[a].content)}}),me.write(r)}function fx(e,r){r.FullPaths.forEach(function(t,a){if(a!=0){var n=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&me.utils.cfb_add(e,n,r.FileIndex[a].content)}})}var ef=["xlsb","xlsm","xlam","biff8","xla"];function ux(){return{"!type":"dialog"}}function dx(){return{"!type":"dialog"}}function hx(){return{"!type":"macro"}}function px(){return{"!type":"macro"}}var Wa=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(a,n,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=r.c:--f,c?l+=r.r:--l,n+(o?"":"$")+Qe(f)+(c?"":"$")+lt(l)}return function(n,i){return r=i,n.replace(e,t)}})(),So=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,To=(function(){return function(r,t){return r.replace(So,function(a,n,i,s,o,c){var l=fo(s)-(i?0:t.c),f=lo(c)-(o?0:t.r),u=f==0?"":o?f+1:"["+f+"]",d=l==0?"":i?l+1:"["+l+"]";return n+"R"+u+"C"+d})}})();function tf(e,r){return e.replace(So,function(t,a,n,i,s,o){return a+(n=="$"?n+i:Qe(fo(i)+r.c))+(s=="$"?s+o:lt(lo(o)+r.r))})}function mx(e,r,t){var a=Xt(r),n=a.s,i=et(t),s={r:i.r-n.r,c:i.c-n.c};return tf(e,s)}function gx(e){return e.length!=1}function pl(e){return e.replace(/_xlfn\./g,"")}function ht(e){e.l+=1}function ta(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function rf(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return af(e,r,t);t.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),s=ta(e,2),o=ta(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function af(e){var r=ta(e,2),t=ta(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function xx(e,r,t){if(t.biff<8)return af(e,r,t);var a=e.read_shift(t.biff==12?4:2),n=e.read_shift(t.biff==12?4:2),i=ta(e,2),s=ta(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}function nf(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return vx(e,r,t);var a=e.read_shift(t&&t.biff==12?4:2),n=ta(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function vx(e){var r=ta(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function yx(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function wx(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return _x(e,r,t);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:s,rRel:o}}function _x(e){var r=e.read_shift(2),t=e.read_shift(1),a=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),n==1&&t>=128&&(t=t-256),{r,c:t,cRel:n,rRel:a}}function kx(e,r,t){var a=(e[e.l++]&96)>>5,n=rf(e,t.biff>=2&&t.biff<=5?6:8,t);return[a,n]}function Ex(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=rf(e,i,t);return[a,n,s]}function Sx(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function Tx(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function bx(e,r,t){var a=(e[e.l++]&96)>>5,n=xx(e,r-1,t);return[a,n]}function Cx(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[a]}function ml(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Ax(e,r,t){e.l+=2;for(var a=e.read_shift(t&&t.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(t&&t.biff==2?1:2));return n}function Ox(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Fx(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Ix(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Rx(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[a]}function sf(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Px(e){return e.read_shift(2),sf(e,2)}function Nx(e){return e.read_shift(2),sf(e,2)}function Dx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=nf(e,0,t);return[a,n]}function Lx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=wx(e,0,t);return[a,n]}function Bx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=nf(e,0,t);return[a,n,i]}function Mx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(t&&t.biff<=3?1:2);return[jv[n],lf[n],a]}function Ux(e,r,t){var a=e[e.l++],n=e.read_shift(1),i=t&&t.biff<=3?[a==88?-1:0,e.read_shift(1)]:$x(e);return[n,(i[0]===0?lf:$v)[i[1]]]}function $x(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function jx(e,r,t){e.l+=t&&t.biff==2?3:4}function Hx(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function Vx(e){return e.l++,Hr[e.read_shift(1)]}function Wx(e){return e.l++,e.read_shift(2)}function Gx(e){return e.l++,e.read_shift(1)!==0}function zx(e){return e.l++,Nt(e,8)}function Xx(e,r,t){return e.l++,Vn(e,r-1,t)}function Yx(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=ct(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Hr[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Nt(e,8);break;case 2:t[1]=Aa(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function qx(e,r,t){for(var a=e.read_shift(t.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((t.biff==12?Ca:$i)(e,8));return n}function Kx(e,r,t){var a=0,n=0;t.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--n==0&&(n=256));for(var i=0,s=[];i!=a&&(s[i]=[]);++i)for(var o=0;o!=n;++o)s[i][o]=Yx(e,t.biff);return s}function Jx(e,r,t){var a=e.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,i=e.read_shift(n);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function Zx(e,r,t){if(t.biff==5)return Qx(e,r,t);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function Qx(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,t,a]}function ev(e,r,t){var a=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function tv(e,r,t){var a=e.read_shift(1)>>>5&3,n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function rv(e,r,t){var a=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[a]}function av(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var nv=Bt,iv=Bt,sv=Bt;function Gn(e,r,t){return e.l+=2,[yx(e,4,t)]}function bo(e){return e.l+=6,[]}var ov=Gn,cv=bo,lv=bo,fv=Gn;function of(e){return e.l+=2,[mt(e),e.read_shift(2)&1]}var uv=Gn,dv=of,hv=bo,pv=Gn,mv=Gn,gv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function xv(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),s=gv[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:a,c:n,C:i}}function vv(e){return e.l+=2,[e.read_shift(4)]}function yv(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function wv(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function _v(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function kv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Ev(e){return e.l+=4,[0,0]}var gl={1:{n:"PtgExp",f:Hx},2:{n:"PtgTbl",f:sv},3:{n:"PtgAdd",f:ht},4:{n:"PtgSub",f:ht},5:{n:"PtgMul",f:ht},6:{n:"PtgDiv",f:ht},7:{n:"PtgPower",f:ht},8:{n:"PtgConcat",f:ht},9:{n:"PtgLt",f:ht},10:{n:"PtgLe",f:ht},11:{n:"PtgEq",f:ht},12:{n:"PtgGe",f:ht},13:{n:"PtgGt",f:ht},14:{n:"PtgNe",f:ht},15:{n:"PtgIsect",f:ht},16:{n:"PtgUnion",f:ht},17:{n:"PtgRange",f:ht},18:{n:"PtgUplus",f:ht},19:{n:"PtgUminus",f:ht},20:{n:"PtgPercent",f:ht},21:{n:"PtgParen",f:ht},22:{n:"PtgMissArg",f:ht},23:{n:"PtgStr",f:Xx},26:{n:"PtgSheet",f:yv},27:{n:"PtgEndSheet",f:wv},28:{n:"PtgErr",f:Vx},29:{n:"PtgBool",f:Gx},30:{n:"PtgInt",f:Wx},31:{n:"PtgNum",f:zx},32:{n:"PtgArray",f:Cx},33:{n:"PtgFunc",f:Mx},34:{n:"PtgFuncVar",f:Ux},35:{n:"PtgName",f:Jx},36:{n:"PtgRef",f:Dx},37:{n:"PtgArea",f:kx},38:{n:"PtgMemArea",f:ev},39:{n:"PtgMemErr",f:nv},40:{n:"PtgMemNoMem",f:iv},41:{n:"PtgMemFunc",f:tv},42:{n:"PtgRefErr",f:rv},43:{n:"PtgAreaErr",f:Sx},44:{n:"PtgRefN",f:Lx},45:{n:"PtgAreaN",f:bx},46:{n:"PtgMemAreaN",f:_v},47:{n:"PtgMemNoMemN",f:kv},57:{n:"PtgNameX",f:Zx},58:{n:"PtgRef3d",f:Bx},59:{n:"PtgArea3d",f:Ex},60:{n:"PtgRefErr3d",f:av},61:{n:"PtgAreaErr3d",f:Tx},255:{}},Sv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Tv={1:{n:"PtgElfLel",f:of},2:{n:"PtgElfRw",f:pv},3:{n:"PtgElfCol",f:ov},6:{n:"PtgElfRwV",f:mv},7:{n:"PtgElfColV",f:fv},10:{n:"PtgElfRadical",f:uv},11:{n:"PtgElfRadicalS",f:hv},13:{n:"PtgElfColS",f:cv},15:{n:"PtgElfColSV",f:lv},16:{n:"PtgElfRadicalLel",f:dv},25:{n:"PtgList",f:xv},29:{n:"PtgSxName",f:vv},255:{}},bv={0:{n:"PtgAttrNoop",f:Ev},1:{n:"PtgAttrSemi",f:Rx},2:{n:"PtgAttrIf",f:Fx},4:{n:"PtgAttrChoose",f:Ax},8:{n:"PtgAttrGoto",f:Ox},16:{n:"PtgAttrSum",f:jx},32:{n:"PtgAttrBaxcel",f:ml},33:{n:"PtgAttrBaxcel",f:ml},64:{n:"PtgAttrSpace",f:Px},65:{n:"PtgAttrSpaceSemi",f:Nx},128:{n:"PtgAttrIfError",f:Ix},255:{}};function zn(e,r,t,a){if(a.biff<8)return Bt(e,r);for(var n=e.l+r,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=Kx(e,0,a),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=qx(e,t[s][1],a),i.push(t[s][2]);break;case"PtgExp":a&&a.biff==12&&(t[s][1][1]=e.read_shift(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0];default:break}return r=n-e.l,r!==0&&i.push(Bt(e,r)),i}function Xn(e,r,t){for(var a=e.l+r,n,i,s=[];a!=e.l;)r=a-e.l,i=e[e.l],n=gl[i]||gl[Sv[i]],(i===24||i===25)&&(n=(i===24?Tv:bv)[e[e.l+1]]),!n||!n.f?Bt(e,r):s.push([n.n,n.f(e,r,t)]);return s}function Cv(e){for(var r=[],t=0;t<e.length;++t){for(var a=e[t],n=[],i=0;i<a.length;++i){var s=a[i];if(s)switch(s[0]){case 2:n.push('"'+s[1].replace(/"/g,'""')+'"');break;default:n.push(s[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var Av={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ov(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function cf(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(t.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function xl(e,r,t){var a=cf(e,r,t);return a=="#REF"?a:Ov(a,t)}function Rt(e,r,t,a,n){var i=n&&n.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,f,u=0,d=0,h,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,y=e[0].length;v<y;++v){var x=e[0][v];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=tt(" ",e[0][p][1][1]);break;case 1:g=tt("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+g,p=-1}o.push(l+Av[x[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=_n(x[1][1],s,n),o.push(kn(f,i));break;case"PtgRefN":f=t?_n(x[1][1],t,n):x[1][1],o.push(kn(f,i));break;case"PtgRef3d":u=x[1][1],f=_n(x[1][2],s,n),m=xl(a,u,n);var O=m;o.push(m+"!"+kn(f,i));break;case"PtgFunc":case"PtgFuncVar":var I=x[1][0],A=x[1][1];I||(I=0),I&=127;var k=I==0?[]:o.slice(-I);o.length-=I,A==="User"&&(A=k.shift()),o.push(A+"("+k.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":h=zc(x[1][1],t?{s:t}:s,n),o.push(_s(h,n));break;case"PtgArea":h=zc(x[1][1],s,n),o.push(_s(h,n));break;case"PtgArea3d":u=x[1][1],h=x[1][2],m=xl(a,u,n),o.push(m+"!"+_s(h,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=x[1][2];var D=(a.names||[])[d-1]||(a[0]||[])[d],N=D?D.Name:"SH33TJSNAME"+String(d);N&&N.slice(0,6)=="_xlfn."&&!n.xlfn&&(N=N.slice(6)),o.push(N);break;case"PtgNameX":var M=x[1][1];d=x[1][2];var G;if(n.biff<=5)M<0&&(M=-M),a[M]&&(G=a[M][d]);else{var L="";if(((a[M]||[])[0]||[])[0]==14849||(((a[M]||[])[0]||[])[0]==1025?a[M][d]&&a[M][d].itab>0&&(L=a.SheetNames[a[M][d].itab-1]+"!"):L=a.SheetNames[d-1]+"!"),a[M]&&a[M][d])L+=a[M][d].Name;else if(a[0]&&a[0][d])L+=a[0][d].Name;else{var ee=(cf(a,M,n)||"").split(";;");ee[d-1]?L=ee[d-1]:L+="SH33TJSERRX"}o.push(L);break}G||(G={Name:"SH33TJSERRY"}),o.push(G.Name);break;case"PtgParen":var fe="(",Z=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:fe=tt(" ",e[0][p][1][1])+fe;break;case 3:fe=tt("\r",e[0][p][1][1])+fe;break;case 4:Z=tt(" ",e[0][p][1][1])+Z;break;case 5:Z=tt("\r",e[0][p][1][1])+Z;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(fe+o.pop()+Z);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var pe={c:t.c,r:t.r};if(a.sharedf[ve(f)]){var J=a.sharedf[ve(f)];o.push(Rt(J,s,pe,a,n))}else{var ge=!1;for(c=0;c!=a.arrayf.length;++c)if(l=a.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(Rt(l[1],s,pe,a,n)),ge=!0;break}ge||o.push(x[1])}break;case"PtgArray":o.push("{"+Cv(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&te.indexOf(e[0][v][0])==-1){x=e[0][p];var ue=!0;switch(x[1][0]){case 4:ue=!1;case 0:g=tt(" ",x[1][1]);break;case 5:ue=!1;case 1:g=tt("\r",x[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((ue?g:"")+o.pop()+(ue?"":g)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Fv(e,r,t){var a=e.l+r,n=t.biff==2?1:2,i,s=e.read_shift(n);if(s==65535)return[[],Bt(e,r-2)];var o=Xn(e,s,t);return r!==s+n&&(i=zn(e,r-s-n,o,t)),e.l=a,[o,i]}function Iv(e,r,t){var a=e.l+r,n=t.biff==2?1:2,i,s=e.read_shift(n);if(s==65535)return[[],Bt(e,r-2)];var o=Xn(e,s,t);return r!==s+n&&(i=zn(e,r-s-n,o,t)),e.l=a,[o,i]}function Rv(e,r,t,a){var n=e.l+r,i=Xn(e,a,t),s;return n!==e.l&&(s=zn(e,n-e.l,i,t)),[i,s]}function Pv(e,r,t){var a=e.l+r,n,i=e.read_shift(2),s=Xn(e,i,t);return i==65535?[[],Bt(e,r-2)]:(r!==i+2&&(n=zn(e,a-i-2,s,t)),[s,n])}function Nv(e){var r;if(Dr(e,e.l+6)!==65535)return[Nt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Dv(e){if(e==null){var r=X(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return ya(e);return ya(0)}function bs(e,r,t){var a=e.l+r,n=Ar(e,6);t.biff==2&&++e.l;var i=Nv(e,8),s=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=Iv(e,a-e.l,t);return{cell:n,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function Lv(e,r,t,a,n){var i=_a(r,t,n),s=Dv(e.v),o=X(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=X(e.bf.length),f=0;f<e.bf.length;++f)l[f]=e.bf[f];var u=Et([i,s,o,l]);return u}function ji(e,r,t){var a=e.read_shift(4),n=Xn(e,a,t),i=e.read_shift(4),s=i>0?zn(e,i,n,t):null;return[n,s]}var Bv=ji,Hi=ji,Mv=ji,Uv=ji,$v={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jv={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vl(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Hv(e){var r="of:="+e.replace(So,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Cs(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function Vv(e){return e.replace(/\./,"!")}var Sn={},Ga={},Tn=typeof Map!="undefined";function Co(e,r,t){var a=0,n=e.length;if(t){if(Tn?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var i=Tn?t.get(r):t[r];a<i.length;++a)if(e[i[a]].t===r)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===r)return e.Count++,a;return e[n]={t:r},e.Count++,e.Unique++,t&&(Tn?(t.has(r)||t.set(r,[]),t.get(r).push(n)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(n))),n}function Vi(e,r){var t={min:e+1,max:e+1},a=-1;return r.MDW&&(Pt=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?a=Bn(r.wpx):r.wch!=null&&(a=r.wch),a>-1?(t.width=Ii(a),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function ga(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function ia(e,r,t){var a=t.revssf[r.z!=null?r.z:"General"],n=60,i=e.length;if(a==null&&t.ssf){for(;n<392;++n)if(t.ssf[n]==null){Br(r.z,n),t.ssf[n]=r.z,t.revssf[r.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function ff(e,r,t,a,n,i){try{a.cellNF&&(e.z=xe[r])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ke(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(xe[r]==null&&Br($d[r]||"General",r),e.t==="e")e.w=e.w||Hr[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fn(e.v);else if(e.t==="d"){var s=yt(e.v);(s|0)===s?e.w=s.toString(10):e.w=Fn(s)}else{if(e.v===void 0)return"";e.w=xa(e.v,Ga)}else e.t==="d"?e.w=fr(r,yt(e.v),Ga):e.w=fr(r,e.v,Ga)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&t!=null)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Fi(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Fi(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function Wv(e,r,t){if(e&&e["!ref"]){var a=Be(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function Gv(e,r){var t=Be(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Ee(t))}var zv=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Xv=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Yv=/<(?:\w:)?hyperlink [^>]*>/mg,qv=/"(\w*:\w*)"/,Kv=/<(?:\w:)?col\b[^>]*[\/]?>/g,Jv=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Zv=/<(?:\w:)?pageMargins[^>]*\/>/g,uf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Qv=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,e2=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function t2(e,r,t,a,n,i,s){if(!e)return e;a||(a={"!id":{}}),at!=null&&r.dense==null&&(r.dense=at);var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",u=e.match(Xv);u?(l=e.slice(0,u.index),f=e.slice(u.index+u[0].length)):l=f=e;var d=l.match(uf);d?Ao(d[0],o,n,t):(d=l.match(Qv))&&a2(d[0],d[1]||"",o,n,t,s,i);var h=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=l.slice(h,h+50).match(qv);m&&Gv(o,m[1])}var p=l.match(e2);p&&p[1]&&g2(p[1],n);var g=[];if(r.cellStyles){var v=l.match(Kv);v&&u2(g,v)}u&&y2(u[1],o,r,c,i,s);var y=f.match(Jv);y&&(o["!autofilter"]=h2(y[0]));var x=[],O=f.match(zv);if(O)for(h=0;h!=O.length;++h)x[h]=Be(O[h].slice(O[h].indexOf('"')+1));var I=f.match(Yv);I&&c2(o,I,a);var A=f.match(Zv);if(A&&(o["!margins"]=l2(ye(A[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ee(c)),r.sheetRows>0&&o["!ref"]){var k=Be(o["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ee(k))}return g.length>0&&(o["!cols"]=g),x.length>0&&(o["!merges"]=x),o}function r2(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Ee(e[t])+'"/>';return r+"</mergeCells>"}function Ao(e,r,t,a){var n=ye(e);t.Sheets[a]||(t.Sheets[a]={}),n.codeName&&(t.Sheets[a].CodeName=Le(ze(n.codeName)))}function a2(e,r,t,a,n){Ao(e.slice(0,e.indexOf(">")),t,a,n)}function n2(e,r,t,a,n){var i=!1,s={},o=null;if(a.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[t];try{r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}i=!0,s.codeName=Tr(Ge(c))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+ne("outlinePr",null,l)}!i&&!o||(n[n.length]=ne("sheetPr",o,s))}var i2=["objects","scenarios","selectLockedCells","selectUnlockedCells"],s2=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function o2(e){var r={sheet:1};return i2.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),s2.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=_o(e.password).toString(16).toUpperCase()),ne("sheetProtection",null,r)}function c2(e,r,t){for(var a=Array.isArray(e),n=0;n!=r.length;++n){var i=ye(ze(r[n]),!0);if(!i.ref)return;var s=((t||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Le(i.location))):(i.Target="#"+Le(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Be(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=ve({c:l,r:c});a?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function l2(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function f2(e){return ga(e),ne("pageMargins",null,e)}function u2(e,r){for(var t=!1,a=0;a!=r.length;++a){var n=ye(r[a],!0);n.hidden&&(n.hidden=qe(n.hidden));var i=parseInt(n.min,10)-1,s=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,ko(n.width)),ea(n);i<=s;)e[i++]=Je(n)}}function d2(e,r){for(var t=["<cols>"],a,n=0;n!=r.length;++n)(a=r[n])&&(t[t.length]=ne("col",null,Vi(n,a)));return t[t.length]="</cols>",t.join("")}function h2(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function p2(e,r,t,a){var n=typeof e.ref=="string"?e.ref:Ee(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,s=Xt(n);s.s.r==s.e.r&&(s.e.r=Xt(r["!ref"]).e.r,n=Ee(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+t.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+n}),ne("autoFilter",null,{ref:n})}var m2=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function g2(e,r){r.Views||(r.Views=[{}]),(e.match(m2)||[]).forEach(function(t,a){var n=ye(t);r.Views[a]||(r.Views[a]={}),+n.zoomScale&&(r.Views[a].zoom=+n.zoomScale),qe(n.rightToLeft)&&(r.Views[a].RTL=!0)})}function x2(e,r,t,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),ne("sheetViews",ne("sheetView",null,n),{})}function v2(e,r,t,a){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Hr[e.v];break;case"d":a&&a.cellDates?n=Ke(e.v,-1).toISOString():(e=Je(e),e.t="n",n=""+(e.v=yt(Ke(e.v)))),typeof e.z=="undefined"&&(e.z=xe[14]);break;default:n=e.v;break}var o=Ct("v",Ge(n)),c={r},l=ia(a.cellXfs,e,a);switch(l!==0&&(c.s=l),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=Ct("v",""+Co(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;o=ne("f",Ge(e.f),f)+(e.v!=null?o:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(c.cm=1),ne("c",o,c)}var y2=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=In("v"),s=In("f");return function(c,l,f,u,d,h){for(var m=0,p="",g=[],v=[],y=0,x=0,O=0,I="",A,k,D=0,N=0,M,G,L=0,ee=0,fe=Array.isArray(h.CellXf),Z,pe=[],J=[],ge=Array.isArray(l),te=[],ue={},V=!1,C=!!f.sheetStubs,B=c.split(r),R=0,P=B.length;R!=P;++R){p=B[R].trim();var z=p.length;if(z!==0){var ce=0;e:for(m=0;m<z;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(k=ye(p.slice(ce,m),!0),D=k.r!=null?parseInt(k.r,10):D+1,N=-1,f.sheetRows&&f.sheetRows<D)continue;ue={},V=!1,k.ht&&(V=!0,ue.hpt=parseFloat(k.ht),ue.hpx=qa(ue.hpt)),k.hidden=="1"&&(V=!0,ue.hidden=!0),k.outlineLevel!=null&&(V=!0,ue.level=+k.outlineLevel),V&&(te[D-1]=ue)}break;case"<":ce=m;break}if(ce>=m)break;if(k=ye(p.slice(ce,m),!0),D=k.r!=null?parseInt(k.r,10):D+1,N=-1,!(f.sheetRows&&f.sheetRows<D)){u.s.r>D-1&&(u.s.r=D-1),u.e.r<D-1&&(u.e.r=D-1),f&&f.cellStyles&&(ue={},V=!1,k.ht&&(V=!0,ue.hpt=parseFloat(k.ht),ue.hpx=qa(ue.hpt)),k.hidden=="1"&&(V=!0,ue.hidden=!0),k.outlineLevel!=null&&(V=!0,ue.level=+k.outlineLevel),V&&(te[D-1]=ue)),g=p.slice(m).split(e);for(var re=0;re!=g.length&&g[re].trim().charAt(0)=="<";++re);for(g=g.slice(re),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(v=p.match(t),y=m,x=0,O=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,I=v[1],x=0;x!=I.length&&!((O=I.charCodeAt(x)-64)<1||O>26);++x)y=26*y+O;--y,N=y}else++N;for(x=0;x!=p.length&&p.charCodeAt(x)!==62;++x);if(++x,k=ye(p.slice(0,x),!0),k.r||(k.r=ve({r:D-1,c:N})),I=p.slice(x),A={t:""},(v=I.match(i))!=null&&v[1]!==""&&(A.v=Le(v[1])),f.cellFormula){if((v=I.match(s))!=null&&v[1]!==""){if(A.f=Le(ze(v[1])).replace(/\r\n/g,`
`),f.xlfn||(A.f=pl(A.f)),v[0].indexOf('t="array"')>-1)A.F=(I.match(n)||[])[1],A.F.indexOf(":")>-1&&pe.push([Be(A.F),A.F]);else if(v[0].indexOf('t="shared"')>-1){G=ye(v[0]);var ae=Le(ze(v[1]));f.xlfn||(ae=pl(ae)),J[parseInt(G.si,10)]=[G,ae,k.r]}}else(v=I.match(/<f[^>]*\/>/))&&(G=ye(v[0]),J[G.si]&&(A.f=mx(J[G.si][1],J[G.si][2],k.r)));var q=et(k.r);for(x=0;x<pe.length;++x)q.r>=pe[x][0].s.r&&q.r<=pe[x][0].e.r&&q.c>=pe[x][0].s.c&&q.c<=pe[x][0].e.c&&(A.F=pe[x][1])}if(k.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(C)A.t="z";else continue;else A.t=k.t||"n";switch(u.s.c>N&&(u.s.c=N),u.e.c<N&&(u.e.c=N),A.t){case"n":if(A.v==""||A.v==null){if(!C)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v=="undefined"){if(!C)continue;A.t="z"}else M=Sn[parseInt(A.v,10)],A.v=M.t,A.r=M.r,f.cellHTML&&(A.h=M.h);break;case"str":A.t="s",A.v=A.v!=null?ze(A.v):"",f.cellHTML&&(A.h=to(A.v));break;case"inlineStr":v=I.match(a),A.t="s",v!=null&&(M=wo(v[1]))?(A.v=M.t,f.cellHTML&&(A.h=M.h)):A.v="";break;case"b":A.v=qe(A.v);break;case"d":f.cellDates?A.v=Ke(A.v,1):(A.v=yt(Ke(A.v,1)),A.t="n");break;case"e":(!f||f.cellText!==!1)&&(A.w=A.v),A.v=d0[A.v];break}if(L=ee=0,Z=null,fe&&k.s!==void 0&&(Z=h.CellXf[k.s],Z!=null&&(Z.numFmtId!=null&&(L=Z.numFmtId),f.cellStyles&&Z.fillId!=null&&(ee=Z.fillId))),ff(A,L,ee,f,d,h),f.cellDates&&fe&&A.t=="n"&&Ka(xe[L])&&(A.t="d",A.v=Mi(A.v)),k.cm&&f.xlmeta){var ke=(f.xlmeta.Cell||[])[+k.cm-1];ke&&ke.type=="XLDAPR"&&(A.D=!0)}if(ge){var F=et(k.r);l[F.r]||(l[F.r]=[]),l[F.r][F.c]=A}else l[k.r]=A}}}}te.length>0&&(l["!rows"]=te)}})();function w2(e,r,t,a){var n=[],i=[],s=Be(e["!ref"]),o="",c,l="",f=[],u=0,d=0,h=e["!rows"],m=Array.isArray(e),p={r:l},g,v=-1;for(d=s.s.c;d<=s.e.c;++d)f[d]=Qe(d);for(u=s.s.r;u<=s.e.r;++u){for(i=[],l=lt(u),d=s.s.c;d<=s.e.c;++d){c=f[d]+l;var y=m?(e[u]||[])[d]:e[c];y!==void 0&&(o=v2(y,c,e,r,t,a))!=null&&i.push(o)}(i.length>0||h&&h[u])&&(p={r:l},h&&h[u]&&(g=h[u],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=Mn(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),n[n.length]=ne("row",i.join(""),p))}if(h)for(;u<h.length;++u)h&&h[u]&&(p={r:u+1},g=h[u],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=Mn(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level),n[n.length]=ne("row","",p));return n.join("")}function df(e,r,t,a){var n=[ft,ne("worksheet",null,{xmlns:Ea[0],"xmlns:r":vt.r})],i=t.SheetNames[e],s=0,o="",c=t.Sheets[i];c==null&&(c={});var l=c["!ref"]||"A1",f=Be(l);if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),l=Ee(f)}a||(a={}),c["!comments"]=[];var u=[];n2(c,t,e,r,n),n[n.length]=ne("dimension",null,{ref:l}),n[n.length]=x2(c,r,e,t),r.sheetFormat&&(n[n.length]=ne("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=d2(c,c["!cols"])),n[s=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=w2(c,r,e,t,a),o.length>0&&(n[n.length]=o)),n.length>s+1&&(n[n.length]="</sheetData>",n[s]=n[s].replace("/>",">")),c["!protect"]&&(n[n.length]=o2(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=p2(c["!autofilter"],c,t,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=r2(c["!merges"]));var d=-1,h,m=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=We(a,-1,Ge(p[1].Target).replace(/#.*$/,""),be.HLINK),h["r:id"]="rId"+m),(d=p[1].Target.indexOf("#"))>-1&&(h.location=Ge(p[1].Target.slice(d+1))),p[1].Tooltip&&(h.tooltip=Ge(p[1].Tooltip)),n[n.length]=ne("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=f2(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(n[n.length]=Ct("ignoredErrors",ne("ignoredError",null,{numberStoredAsText:1,sqref:l}))),u.length>0&&(m=We(a,-1,"../drawings/drawing"+(e+1)+".xml",be.DRAW),n[n.length]=ne("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=u),c["!comments"].length>0&&(m=We(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",be.VML),n[n.length]=ne("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function _2(e,r){var t={},a=e.l+r;t.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=n/20),t}function k2(e,r,t){var a=X(145),n=(t["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=Mn(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var s=0;n.level&&(s|=n.level),n.hidden&&(s|=16),(n.hpx||n.hpt)&&(s|=32),a.write_shift(1,s),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var l={r:e,c:0},f=0;f<16;++f)if(!(r.s.c>f+1<<10||r.e.c<f<<10)){for(var u=-1,d=-1,h=f<<10;h<f+1<<10;++h){l.c=h;var m=Array.isArray(t)?(t[l.r]||[])[l.c]:t[ve(l)];m&&(u<0&&(u=h),d=h)}u<0||(++o,a.write_shift(4,u),a.write_shift(4,d))}var p=a.l;return a.l=c,a.write_shift(4,o),a.l=p,a.length>a.l?a.slice(0,a.l):a}function E2(e,r,t,a){var n=k2(a,t,r);(n.length>17||(r["!rows"]||[])[a])&&K(e,0,n)}var S2=Ca,T2=en;function b2(){}function C2(e,r){var t={},a=e[e.l];return++e.l,t.above=!(a&64),t.left=!(a&128),e.l+=18,t.name=Fh(e,r-19),t}function A2(e,r,t){t==null&&(t=X(84+4*e.length));var a=192;r&&(r.above&&(a&=-65),r.left&&(a&=-129)),t.write_shift(1,a);for(var n=1;n<3;++n)t.write_shift(1,0);return Ci({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),o0(e,t),t.slice(0,t.l)}function O2(e){var r=ur(e);return[r]}function F2(e,r,t){return t==null&&(t=X(8)),Sa(r,t)}function I2(e){var r=Ta(e);return[r]}function R2(e,r,t){return t==null&&(t=X(4)),ba(r,t)}function P2(e){var r=ur(e),t=e.read_shift(1);return[r,t,"b"]}function N2(e,r,t){return t==null&&(t=X(9)),Sa(r,t),t.write_shift(1,e.v?1:0),t}function D2(e){var r=Ta(e),t=e.read_shift(1);return[r,t,"b"]}function L2(e,r,t){return t==null&&(t=X(5)),ba(r,t),t.write_shift(1,e.v?1:0),t}function B2(e){var r=ur(e),t=e.read_shift(1);return[r,t,"e"]}function M2(e,r,t){return t==null&&(t=X(9)),Sa(r,t),t.write_shift(1,e.v),t}function U2(e){var r=Ta(e),t=e.read_shift(1);return[r,t,"e"]}function $2(e,r,t){return t==null&&(t=X(8)),ba(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function j2(e){var r=ur(e),t=e.read_shift(4);return[r,t,"s"]}function H2(e,r,t){return t==null&&(t=X(12)),Sa(r,t),t.write_shift(4,r.v),t}function V2(e){var r=Ta(e),t=e.read_shift(4);return[r,t,"s"]}function W2(e,r,t){return t==null&&(t=X(8)),ba(r,t),t.write_shift(4,r.v),t}function G2(e){var r=ur(e),t=Nt(e);return[r,t,"n"]}function z2(e,r,t){return t==null&&(t=X(16)),Sa(r,t),ya(e.v,t),t}function hf(e){var r=Ta(e),t=Nt(e);return[r,t,"n"]}function X2(e,r,t){return t==null&&(t=X(12)),ba(r,t),ya(e.v,t),t}function Y2(e){var r=ur(e),t=mo(e);return[r,t,"n"]}function q2(e,r,t){return t==null&&(t=X(12)),Sa(r,t),c0(e.v,t),t}function K2(e){var r=Ta(e),t=mo(e);return[r,t,"n"]}function J2(e,r,t){return t==null&&(t=X(8)),ba(r,t),c0(e.v,t),t}function Z2(e){var r=ur(e),t=uo(e);return[r,t,"is"]}function Q2(e){var r=ur(e),t=Lt(e);return[r,t,"str"]}function ey(e,r,t){return t==null&&(t=X(12+4*e.v.length)),Sa(r,t),St(e.v,t),t.length>t.l?t.slice(0,t.l):t}function ty(e){var r=Ta(e),t=Lt(e);return[r,t,"str"]}function ry(e,r,t){return t==null&&(t=X(8+4*e.v.length)),ba(r,t),St(e.v,t),t.length>t.l?t.slice(0,t.l):t}function ay(e,r,t){var a=e.l+r,n=ur(e);n.r=t["!row"];var i=e.read_shift(1),s=[n,i,"b"];if(t.cellFormula){e.l+=2;var o=Hi(e,a-e.l,t);s[3]=Rt(o,null,n,t.supbooks,t)}else e.l=a;return s}function ny(e,r,t){var a=e.l+r,n=ur(e);n.r=t["!row"];var i=e.read_shift(1),s=[n,i,"e"];if(t.cellFormula){e.l+=2;var o=Hi(e,a-e.l,t);s[3]=Rt(o,null,n,t.supbooks,t)}else e.l=a;return s}function iy(e,r,t){var a=e.l+r,n=ur(e);n.r=t["!row"];var i=Nt(e),s=[n,i,"n"];if(t.cellFormula){e.l+=2;var o=Hi(e,a-e.l,t);s[3]=Rt(o,null,n,t.supbooks,t)}else e.l=a;return s}function sy(e,r,t){var a=e.l+r,n=ur(e);n.r=t["!row"];var i=Lt(e),s=[n,i,"str"];if(t.cellFormula){e.l+=2;var o=Hi(e,a-e.l,t);s[3]=Rt(o,null,n,t.supbooks,t)}else e.l=a;return s}var oy=Ca,cy=en;function ly(e,r){return r==null&&(r=X(4)),r.write_shift(4,e),r}function fy(e,r){var t=e.l+r,a=Ca(e,16),n=ho(e),i=Lt(e),s=Lt(e),o=Lt(e);e.l=t;var c={rfx:a,relId:n,loc:i,display:o};return s&&(c.Tooltip=s),c}function uy(e,r){var t=X(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));en({s:et(e[0]),e:et(e[0])},t),po("rId"+r,t);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return St(n||"",t),St(e[1].Tooltip||"",t),St("",t),t.slice(0,t.l)}function dy(){}function hy(e,r,t){var a=e.l+r,n=l0(e,16),i=e.read_shift(1),s=[n];if(s[2]=i,t.cellFormula){var o=Bv(e,a-e.l,t);s[1]=o}else e.l=a;return s}function py(e,r,t){var a=e.l+r,n=Ca(e,16),i=[n];if(t.cellFormula){var s=Uv(e,a-e.l,t);i[1]=s,e.l=a}else e.l=a;return i}function my(e,r,t){t==null&&(t=X(18));var a=Vi(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(a.width||10)*256),t.write_shift(4,0);var n=0;return r.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),r.level&&(n|=r.level<<8),t.write_shift(2,n),t}var pf=["left","right","top","bottom","header","footer"];function gy(e){var r={};return pf.forEach(function(t){r[t]=Nt(e,8)}),r}function xy(e,r){return r==null&&(r=X(48)),ga(e),pf.forEach(function(t){ya(e[t],r)}),r}function vy(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function yy(e,r,t){t==null&&(t=X(30));var a=924;return(((r||{}).Views||[])[0]||{}).RTL&&(a|=32),t.write_shift(2,a),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function wy(e){var r=X(24);return r.write_shift(4,4),r.write_shift(4,1),en(e,r),r}function _y(e,r){return r==null&&(r=X(66)),r.write_shift(2,e.password?_o(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function ky(){}function Ey(){}function Sy(e,r,t,a,n,i,s){if(!e)return e;var o=r||{};a||(a={"!id":{}}),at!=null&&o.dense==null&&(o.dense=at);var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=[],d=!1,h=!1,m,p,g,v,y,x,O,I,A,k=[];o.biff=12,o["!row"]=0;var D=0,N=!1,M=[],G={},L=o.supbooks||n.supbooks||[[]];if(L.sharedf=G,L.arrayf=M,L.SheetNames=n.SheetNames||n.Sheets.map(function(ue){return ue.name}),!o.supbooks&&(o.supbooks=L,n.Names))for(var ee=0;ee<n.Names.length;++ee)L[0][ee+1]=n.Names[ee];var fe=[],Z=[],pe=!1;Un[16]={n:"BrtShortReal",f:hf};var J,ge;if(jr(e,function(V,C,B){if(!h)switch(B){case 148:l=V;break;case 0:m=V,o.sheetRows&&o.sheetRows<=m.r&&(h=!0),I=lt(v=m.r),o["!row"]=m.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=qa(V.hpt)),Z[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:V[2]},V[2]){case"n":p.v=V[1];break;case"s":O=Sn[V[1]],p.v=O.t,p.r=O.r;break;case"b":p.v=!!V[1];break;case"e":p.v=V[1],o.cellText!==!1&&(p.w=Hr[p.v]);break;case"str":p.t="s",p.v=V[1];break;case"is":p.t="s",p.v=V[1].t;break}if((g=s.CellXf[V[0].iStyleRef])&&ff(p,g.numFmtId,null,o,i,s),y=V[0].c==-1?y+1:V[0].c,o.dense?(c[v]||(c[v]=[]),c[v][y]=p):c[Qe(y)+I]=p,o.cellFormula){for(N=!1,D=0;D<M.length;++D){var R=M[D];m.r>=R[0].s.r&&m.r<=R[0].e.r&&y>=R[0].s.c&&y<=R[0].e.c&&(p.F=Ee(R[0]),N=!0)}!N&&V.length>3&&(p.f=V[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),o.cellDates&&g&&p.t=="n"&&Ka(xe[g.numFmtId])){var P=da(p.v);P&&(p.t="d",p.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}J&&(J.type=="XLDAPR"&&(p.D=!0),J=void 0),ge&&(ge=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;p={t:"z",v:void 0},y=V[0].c==-1?y+1:V[0].c,o.dense?(c[v]||(c[v]=[]),c[v][y]=p):c[Qe(y)+I]=p,f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),J&&(J.type=="XLDAPR"&&(p.D=!0),J=void 0),ge&&(ge=void 0);break;case 176:k.push(V);break;case 49:J=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var z=a["!id"][V.relId];for(z?(V.Target=z.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=z):V.relId==""&&(V.Target="#"+V.loc),v=V.rfx.s.r;v<=V.rfx.e.r;++v)for(y=V.rfx.s.c;y<=V.rfx.e.c;++y)o.dense?(c[v]||(c[v]=[]),c[v][y]||(c[v][y]={t:"z",v:void 0}),c[v][y].l=V):(x=ve({c:y,r:v}),c[x]||(c[x]={t:"z",v:void 0}),c[x].l=V);break;case 426:if(!o.cellFormula)break;M.push(V),A=o.dense?c[v][y]:c[Qe(y)+I],A.f=Rt(V[1],f,{r:m.r,c:y},L,o),A.F=Ee(V[0]);break;case 427:if(!o.cellFormula)break;G[ve(V[0].s)]=V[1],A=o.dense?c[v][y]:c[Qe(y)+I],A.f=Rt(V[1],f,{r:m.r,c:y},L,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)fe[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},pe||(pe=!0,ko(V.w/256)),ea(fe[V.e+1]);break;case 161:c["!autofilter"]={ref:Ee(V)};break;case 476:c["!margins"]=V;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),V.name&&(n.Sheets[t].CodeName=V.name),(V.above||V.left)&&(c["!outline"]={above:V.above,left:V.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),V.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:u.push(B),d=!0;break;case 38:u.pop(),d=!1;break;default:if(!C.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ee(l||f)),o.sheetRows&&c["!ref"]){var te=Be(c["!ref"]);o.sheetRows<=+te.e.r&&(te.e.r=o.sheetRows-1,te.e.r>f.e.r&&(te.e.r=f.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>f.e.c&&(te.e.c=f.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ee(te))}return k.length>0&&(c["!merges"]=k),fe.length>0&&(c["!cols"]=fe),Z.length>0&&(c["!rows"]=Z),c}function Ty(e,r,t,a,n,i,s){if(r.v===void 0)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":r=Je(r),r.z=r.z||xe[14],r.v=yt(Ke(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v;break}var c={r:t,c:a};switch(c.s=ia(n.cellXfs,r,n),r.l&&i["!links"].push([ve(c),r.l]),r.c&&i["!comments"].push([ve(c),r.c]),r.t){case"s":case"str":return n.bookSST?(o=Co(n.Strings,r.v,n.revStrings),c.t="s",c.v=o,s?K(e,18,W2(r,c)):K(e,7,H2(r,c))):(c.t="str",s?K(e,17,ry(r,c)):K(e,6,ey(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?s?K(e,13,J2(r,c)):K(e,2,q2(r,c)):s?K(e,16,X2(r,c)):K(e,5,z2(r,c)),!0;case"b":return c.t="b",s?K(e,15,L2(r,c)):K(e,4,N2(r,c)),!0;case"e":return c.t="e",s?K(e,14,$2(r,c)):K(e,3,M2(r,c)),!0}return s?K(e,12,R2(r,c)):K(e,1,F2(r,c)),!0}function by(e,r,t,a){var n=Be(r["!ref"]||"A1"),i,s="",o=[];K(e,145);var c=Array.isArray(r),l=n.e.r;r["!rows"]&&(l=Math.max(n.e.r,r["!rows"].length-1));for(var f=n.s.r;f<=l;++f){s=lt(f),E2(e,r,n,f);var u=!1;if(f<=n.e.r)for(var d=n.s.c;d<=n.e.c;++d){f===n.s.r&&(o[d]=Qe(d)),i=o[d]+s;var h=c?(r[f]||[])[d]:r[i];if(!h){u=!1;continue}u=Ty(e,h,f,d,a,r,u)}}K(e,146)}function Cy(e,r){!r||!r["!merges"]||(K(e,177,ly(r["!merges"].length)),r["!merges"].forEach(function(t){K(e,176,cy(t))}),K(e,178))}function Ay(e,r){!r||!r["!cols"]||(K(e,390),r["!cols"].forEach(function(t,a){t&&K(e,60,my(a,t))}),K(e,391))}function Oy(e,r){!r||!r["!ref"]||(K(e,648),K(e,649,wy(Be(r["!ref"]))),K(e,650))}function Fy(e,r,t){r["!links"].forEach(function(a){if(a[1].Target){var n=We(t,-1,a[1].Target.replace(/#.*$/,""),be.HLINK);K(e,494,uy(a,n))}}),delete r["!links"]}function Iy(e,r,t,a){if(r["!comments"].length>0){var n=We(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",be.VML);K(e,551,po("rId"+n)),r["!legacy"]=n}}function Ry(e,r,t,a){if(r["!autofilter"]){var n=r["!autofilter"],i=typeof n.ref=="string"?n.ref:Ee(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,o=Xt(i);o.s.r==o.e.r&&(o.e.r=Xt(r["!ref"]).e.r,i=Ee(o));for(var c=0;c<s.length;++c){var l=s[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+t.SheetNames[a]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+i}),K(e,161,en(Be(i))),K(e,162)}}function Py(e,r,t){K(e,133),K(e,137,yy(r,t)),K(e,138),K(e,134)}function Ny(e,r){r["!protect"]&&K(e,535,_y(r["!protect"]))}function Dy(e,r,t,a){var n=zt(),i=t.SheetNames[e],s=t.Sheets[i]||{},o=i;try{t&&t.Workbook&&(o=t.Workbook.Sheets[e].CodeName||o)}catch{}var c=Be(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],K(n,129),(t.vbaraw||s["!outline"])&&K(n,147,A2(o,s["!outline"])),K(n,148,T2(c)),Py(n,s,t.Workbook),Ay(n,s,e,r,t),by(n,s,e,r,t),Ny(n,s),Ry(n,s,t,e),Cy(n,s),Fy(n,s,a),s["!margins"]&&K(n,476,xy(s["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&Oy(n,s),Iy(n,s,e,a),K(n,130),n.end()}function Ly(e){var r=[],t=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=t?+s[2]:s[2])});var n=Le((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[r,n,a]}function By(e,r,t,a,n,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var d=Ly(u);f.s.r=f.s.c=0,f.e.c=o,l=Qe(o),d[0].forEach(function(h,m){s[l+lt(m)]={t:"n",v:h,z:d[1]},c=m}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(s["!ref"]=Ee(f)),s}function My(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(uf);return o&&Ao(o[0],i,n,t),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Uy(e,r){e.l+=10;var t=Lt(e,r-10);return{name:t}}function $y(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return jr(e,function(l,f,u){switch(u){case 550:i["!rel"]=l;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),l.name&&(n.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u);break;case 38:s.pop();break;default:if(f.T>0)s.push(u);else if(f.T<0)s.pop();else if(!o||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}},r),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Oo=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jy=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Hy=[],Vy=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function yl(e,r){for(var t=0;t!=e.length;++t)for(var a=e[t],n=0;n!=r.length;++n){var i=r[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=qe(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function wl(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=qe(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function mf(e){wl(e.WBProps,Oo),wl(e.CalcPr,Vy),yl(e.WBView,jy),yl(e.Sheets,Hy),Ga.date1904=qe(e.WBProps.date1904)}function Wy(e){return!e.Workbook||!e.Workbook.WBProps?"false":qe(e.Workbook.WBProps.date1904)?"true":"false"}var Gy="][*?/\\".split("");function gf(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return Gy.forEach(function(a){if(e.indexOf(a)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}function zy(e,r,t){e.forEach(function(a,n){gf(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(t){var s=r&&r[n]&&r[n].CodeName||a;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Xy(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];zy(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Wv(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var Yy=/<\w+:workbook/;function qy(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},s=0;if(e.replace(Mt,function(c,l){var f=ye(c);switch(Cr(f[0])){case"<?xml":break;case"<workbook":c.match(Yy)&&(n="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Oo.forEach(function(u){if(f[u[0]]!=null)switch(u[2]){case"bool":t.WBProps[u[0]]=qe(f[u[0]]);break;case"int":t.WBProps[u[0]]=parseInt(f[u[0]],10);break;default:t.WBProps[u[0]]=f[u[0]]}}),f.codeName&&(t.WBProps.CodeName=ze(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Le(ze(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=ze(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),qe(f.hidden||"0")&&(i.Hidden=!0),s=l+c.length;break;case"</definedName>":i.Ref=Le(ze(e.slice(s,l))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Ea.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return mf(t),t}function xf(e){var r=[ft];r[r.length]=ne("workbook",null,{xmlns:Ea[0],"xmlns:r":vt.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Oo.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),r[r.length]=ne("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ge(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}r[r.length]=ne("sheet",null,s)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(r[r.length]=ne("definedName",Ge(o.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function Ky(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Ds(e,r-8),t.name=Lt(e),t}function Jy(e,r){return r||(r=X(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),po(e.strRelID,r),St(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function Zy(e,r){var t={},a=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var n=r>8?Lt(e):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function Qy(e,r){r||(r=X(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),o0(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function ew(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function tw(e,r,t){var a=e.l+r;e.l+=4,e.l+=1;var n=e.read_shift(4),i=Ih(e),s=Mv(e,0,t),o=ho(e);e.l=a;var c={Name:i,Ptg:s};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function rw(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Un[16]={n:"BrtFRTArchID$",f:ew},jr(e,function(c,l,f){switch(f){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=Rt(c.Ptg,null,null,s,r),delete r.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,c]):s[0]=[f,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},r),mf(t),t.Names=i,t.supbooks=s,t}function aw(e,r){K(e,143);for(var t=0;t!=r.SheetNames.length;++t){var a=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,n={Hidden:a,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};K(e,156,Jy(n))}K(e,144)}function nw(e,r){r||(r=X(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return St("SheetJS",r),St(An.version,r),St(An.version,r),St("7262",r),r.length>r.l?r.slice(0,r.l):r}function iw(e,r){r||(r=X(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function sw(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,a=0,n=-1,i=-1;a<t.length;++a)!t[a]||!t[a].Hidden&&n==-1?n=a:t[a].Hidden==1&&i==-1&&(i=a);i>n||(K(e,135),K(e,158,iw(n)),K(e,136))}}function ow(e,r){var t=zt();return K(t,131),K(t,128,nw()),K(t,153,Qy(e.Workbook&&e.Workbook.WBProps||null)),sw(t,e,r),aw(t,e,r),K(t,132),t.end()}function cw(e,r,t){return r.slice(-4)===".bin"?rw(e,t):qy(e,t)}function lw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?Sy(e,a,t,n,i,s,o):t2(e,a,t,n,i,s,o)}function fw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?$y(e,a,t,n,i,s,o):My(e,a,t,n,i,s,o)}function uw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?hx(e,a,t,n,i,s,o):px(e,a,t,n,i,s,o)}function dw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?ux(e,a,t,n,i,s,o):dx(e,a,t,n,i,s,o)}function hw(e,r,t,a){return r.slice(-4)===".bin"?cg(e,t,a):Km(e,t,a)}function pw(e,r,t){return K0(e,t)}function mw(e,r,t){return r.slice(-4)===".bin"?mm(e,t):dm(e,t)}function gw(e,r,t){return r.slice(-4)===".bin"?sx(e,t):Jg(e,t)}function xw(e,r,t){return r.slice(-4)===".bin"?Yg(e,r,t):zg(e,r,t)}function vw(e,r,t,a){return t.slice(-4)===".bin"?qg(e,r,t,a):void 0}function yw(e,r,t){return r.slice(-4)===".bin"?Vg(e,r,t):Gg(e,r,t)}function ww(e,r,t){return(r.slice(-4)===".bin"?ow:xf)(e,t)}function _w(e,r,t,a,n){return(r.slice(-4)===".bin"?Dy:df)(e,t,a,n)}function kw(e,r,t){return(r.slice(-4)===".bin"?vg:Y0)(e,t)}function Ew(e,r,t){return(r.slice(-4)===".bin"?vm:$0)(e,t)}function Sw(e,r,t){return(r.slice(-4)===".bin"?ox:Q0)(e,t)}function Tw(e){return(e.slice(-4)===".bin"?Wg:J0)()}var vf=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,yf=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mr(e,r){var t=e.split(/\s+/),a=[];if(r||(a[0]=t[0]),t.length===1)return a;var n=e.match(vf),i,s,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(yf),(s=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),a[o]=i[2].slice(1,i[2].length-1));return a}function bw(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var a=e.match(vf),n,i,s,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(yf),(i=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?s="xmlns"+n[1].slice(6):s=n[1].slice(i+1),t[s]=n[2].slice(1,n[2].length-1));return t}var bn;function Cw(e,r){var t=bn[e]||Le(e);return t==="General"?xa(r):fr(t,r)}function Aw(e,r,t,a){var n=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=qe(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Ke(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Le(r)]=n}function Ow(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Hr[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fn(e.v):e.w=xa(e.v):e.w=Cw(r||"General",e.v)}catch(i){if(t.WTF)throw i}try{var a=bn[r]||r||"General";if(t.cellNF&&(e.z=a),t.cellDates&&e.t=="n"&&Ka(a)){var n=da(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(t.WTF)throw i}}}function Fw(e,r,t){if(t.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=Hm[a.Pattern]||a.Pattern)}e[r.ID]=r}function Iw(e,r,t,a,n,i,s,o,c,l){var f="General",u=a.StyleID,d={};l=l||{};var h=[],m=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&s&&(u=s.StyleID);i[u]!==void 0&&(i[u].nf&&(f=i[u].nf),i[u].Interior&&h.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=qe(e);break;case"String":a.t="s",a.r=Bc(Le(e)),a.v=e.indexOf("<")>-1?Le(r||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Ke(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Le(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=d0[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=Bc(r||e));break}if(Ow(a,f,l),l.cellFormula!==!1)if(a.Formula){var p=Le(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=Wa(p,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Wa("RC:RC",n):a.ArrayRange&&(a.F=Wa(a.ArrayRange,n),c.push([Be(a.F),a.F]))}else for(m=0;m<c.length;++m)n.r>=c[m][0].s.r&&n.r<=c[m][0].e.r&&n.c>=c[m][0].s.c&&n.c<=c[m][0].e.c&&(a.F=c[m][1]);l.cellStyles&&(h.forEach(function(g){!d.patternType&&g.patternType&&(d.patternType=g.patternType)}),a.s=d),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function Rw(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function As(e,r){var t=r||{};Ja();var a=xn(ro(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof $e!="undefined"?a=$e.utils.decode(65001,Ps(a)):a=ze(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var s=Je(t);return s.type="string",Ya.to_workbook(a,s)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(st){n.indexOf("<"+st)>=0&&(i=!0)}),i)return x_(a,t);bn={"General Number":"General","General Date":xe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xe[15],"Short Date":xe[14],"Long Time":xe[19],"Medium Time":xe[18],"Short Time":xe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xe[2],Standard:xe[4],Percent:xe[10],Scientific:xe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l;at!=null&&t.dense==null&&(t.dense=at);var f={},u=[],d=t.dense?[]:{},h="",m={},p={},g=mr('<Data ss:Type="String">'),v=0,y=0,x=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},A={},k="",D=0,N=[],M={},G={},L=0,ee=[],fe=[],Z={},pe=[],J,ge=!1,te=[],ue=[],V={},C=0,B=0,R={Sheets:[],WBProps:{date1904:!1}},P={};Pn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";o=Pn.exec(a);)switch(o[3]=(z=o[3]).toLowerCase()){case"data":if(z=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Iw(a.slice(v,o.index),k,g,c[c.length-1][0]=="comment"?Z:m,{c:y,r:x},I,pe[y],p,te,t):(k="",g=mr(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(fe.length>0&&(m.c=fe),(!t.sheetRows||t.sheetRows>x)&&m.v!==void 0&&(t.dense?(d[x]||(d[x]=[]),d[x][y]=m):d[Qe(y)+lt(x)]=m),m.HRef&&(m.l={Target:Le(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(C=y+(parseInt(m.MergeAcross,10)|0),B=x+(parseInt(m.MergeDown,10)|0),N.push({s:{c:y,r:x},e:{c:C,r:B}})),!t.sheetStubs)m.MergeAcross?y=C+1:++y;else if(m.MergeAcross||m.MergeDown){for(var ce=y;ce<=C;++ce)for(var re=x;re<=B;++re)(ce>y||re>x)&&(t.dense?(d[re]||(d[re]=[]),d[re][ce]={t:"z"}):d[Qe(ce)+lt(re)]={t:"z"});y=C+1}else++y;else m=bw(o[0]),m.Index&&(y=+m.Index-1),y<O.s.c&&(O.s.c=y),y>O.e.c&&(O.e.c=y),o[0].slice(-2)==="/>"&&++y,fe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<O.s.r&&(O.s.r=x),x>O.e.r&&(O.e.r=x),o[0].slice(-2)==="/>"&&(p=mr(o[0]),p.Index&&(x=+p.Index-1)),y=0,++x):(p=mr(o[0]),p.Index&&(x=+p.Index-1),V={},(p.AutoFitHeight=="0"||p.Height)&&(V.hpx=parseInt(p.Height,10),V.hpt=Mn(V.hpx),ue[x]=V),p.Hidden=="1"&&(V.hidden=!0,ue[x]=V));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));u.push(h),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(d["!ref"]=Ee(O),t.sheetRows&&t.sheetRows<=O.e.r&&(d["!fullref"]=d["!ref"],O.e.r=t.sheetRows-1,d["!ref"]=Ee(O))),N.length&&(d["!merges"]=N),pe.length>0&&(d["!cols"]=pe),ue.length>0&&(d["!rows"]=ue),f[h]=d}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=y=0,c.push([o[3],!1]),l=mr(o[0]),h=Le(l.Name),d=t.dense?[]:{},N=[],te=[],ue=[],P={name:h,Hidden:0},R.Sheets.push(P);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),pe=[],ge=!1}break;case"style":o[1]==="/"?Fw(I,A,t):A=mr(o[0]);break;case"numberformat":A.nf=Le(mr(o[0]).Format||"General"),bn[A.nf]&&(A.nf=bn[A.nf]);for(var ae=0;ae!=392&&xe[ae]!=A.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(xe[ae]==null){Br(A.nf,ae);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(J=mr(o[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!ge&&J.wpx>10){ge=!0,Pt=z0;for(var q=0;q<pe.length;++q)pe[q]&&ea(pe[q])}ge&&ea(J),pe[J.Index-1||pe.length]=J;for(var ke=0;ke<+J.Span;++ke)pe[pe.length]=Je(J);break;case"namedrange":if(o[1]==="/")break;R.Names||(R.Names=[]);var F=ye(o[0]),je={Name:F.Name,Ref:Wa(F.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(je.Sheet=R.Sheets.length-1),R.Names.push(je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=a.slice(D,o.index):D=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;A.Interior=mr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?rp(M,z,a.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));Rw(Z),fe.push(Z)}else c.push([o[3],!1]),l=mr(o[0]),Z={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ie=mr(o[0]);d["!autofilter"]={ref:Wa(Ie.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Tl(a,t);var He=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(o[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(L,o.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else L=o.index+o[0].length;break;case"header":d["!margins"]||ga(d["!margins"]={},"xlml"),isNaN(+ye(o[0]).Margin)||(d["!margins"].header=+ye(o[0]).Margin);break;case"footer":d["!margins"]||ga(d["!margins"]={},"xlml"),isNaN(+ye(o[0]).Margin)||(d["!margins"].footer=+ye(o[0]).Margin);break;case"pagemargins":var Re=ye(o[0]);d["!margins"]||ga(d["!margins"]={},"xlml"),isNaN(+Re.Top)||(d["!margins"].top=+Re.Top),isNaN(+Re.Left)||(d["!margins"].left=+Re.Left),isNaN(+Re.Right)||(d["!margins"].right=+Re.Right),isNaN(+Re.Bottom)||(d["!margins"].bottom=+Re.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Aw(G,z,ee,a.slice(L,o.index)):(ee=o,L=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var de={};return!t.bookSheets&&!t.bookProps&&(de.Sheets=f),de.SheetNames=u,de.Workbook=R,de.SSF=Je(xe),de.Props=M,de.Custprops=G,de}function Hs(e,r){switch(Io(r=r||{}),r.type||"base64"){case"base64":return As(Qt(e),r);case"binary":case"buffer":case"file":return As(e,r);case"array":return As(aa(e),r)}}function Pw(e,r){var t=[];return e.Props&&t.push(ap(e.Props,r)),e.Custprops&&t.push(np(e.Props,e.Custprops,r)),t.join("")}function Nw(){return""}function Dw(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(a,n){var i=[];i.push(ne("NumberFormat",null,{"ss:Format":Ge(xe[a.numFmtId])}));var s={"ss:ID":"s"+(21+n)};t.push(ne("Style",i.join(""),s))}),ne("Styles",t.join(""))}function wf(e){return ne("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+To(e.Ref,{r:0,c:0})})}function Lw(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],a=0;a<r.length;++a){var n=r[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||t.push(wf(n)))}return ne("Names",t.join(""))}function Bw(e,r,t,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],s=0;s<n.length;++s){var o=n[s];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||i.push(wf(o)))}return i.join("")}function Mw(e,r,t,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(ne("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(ne("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(ne("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t])if(a.Workbook.Sheets[t].Hidden)n.push(ne("Visible",a.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==t&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Ct("ProtectContents","True")),e["!protect"].objects&&n.push(Ct("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Ct("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Ct("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Ct("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&n.push("<"+s[1]+"/>")})),n.length==0?"":ne("WorksheetOptions",n.join(""),{xmlns:Kt.x})}function Uw(e){return e.map(function(r){var t=ih(r.t||""),a=ne("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return ne("Comment",a,{"ss:Author":r.a})}).join("")}function $w(e,r,t,a,n,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ge(To(e.f,s))),e.F&&e.F.slice(0,r.length)==r){var c=et(e.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ge(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ge(e.l.Tooltip))),t["!merges"])for(var l=t["!merges"],f=0;f!=l.length;++f)l[f].s.c!=s.c||l[f].s.r!=s.r||(l[f].e.c>l[f].s.c&&(o["ss:MergeAcross"]=l[f].e.c-l[f].s.c),l[f].e.r>l[f].s.r&&(o["ss:MergeDown"]=l[f].e.r-l[f].s.r));var u="",d="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",d=String(e.v);break;case"b":u="Boolean",d=e.v?"1":"0";break;case"e":u="Error",d=Hr[e.v];break;case"d":u="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||xe[14]);break;case"s":u="String",d=nh(e.v||"");break}var h=ia(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var m=e.v!=null?d:"",p=e.t=="z"?"":'<Data ss:Type="'+u+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=Uw(e.c)),ne("Cell",p,o)}function jw(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=qa(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Hw(e,r,t,a){if(!e["!ref"])return"";var n=Be(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,v){ea(g);var y=!!g.width,x=Vi(v,g),O={"ss:Index":v+1};y&&(O["ss:Width"]=Ln(x.width)),g.hidden&&(O["ss:Hidden"]="1"),o.push(ne("Column",null,O))});for(var c=Array.isArray(e),l=n.s.r;l<=n.e.r;++l){for(var f=[jw(l,(e["!rows"]||[])[l])],u=n.s.c;u<=n.e.c;++u){var d=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>u)&&!(i[s].s.r>l)&&!(i[s].e.c<u)&&!(i[s].e.r<l)){(i[s].s.c!=u||i[s].s.r!=l)&&(d=!0);break}if(!d){var h={r:l,c:u},m=ve(h),p=c?(e[l]||[])[u]:e[m];f.push($w(p,m,e,r,t,a,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function Vw(e,r,t){var a=[],n=t.SheetNames[e],i=t.Sheets[n],s=i?Bw(i,r,e,t):"";return s.length>0&&a.push("<Names>"+s+"</Names>"),s=i?Hw(i,r,e,t):"",s.length>0&&a.push("<Table>"+s+"</Table>"),a.push(Mw(i,r,e,t)),a.join("")}function Ww(e,r){r||(r={}),e.SSF||(e.SSF=Je(xe)),e.SSF&&(Ja(),Di(e.SSF),r.revssf=Bi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],ia(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Pw(e,r)),t.push(Nw(e,r)),t.push(""),t.push("");for(var a=0;a<e.SheetNames.length;++a)t.push(ne("Worksheet",Vw(a,r,e),{"ss:Name":Ge(e.SheetNames[a])}));return t[2]=Dw(e,r),t[3]=Lw(e,r),ft+ne("Workbook",t.join(""),{xmlns:Kt.ss,"xmlns:o":Kt.o,"xmlns:x":Kt.x,"xmlns:ss":Kt.ss,"xmlns:dt":Kt.dt,"xmlns:html":Kt.html})}function Gw(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Lh(t),t.length-t.l<=4)return r;var a=t.read_shift(4);if(a==0||a>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(a=t.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=Bh(t),a=t.read_shift(4),a==0||a>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var zw=[60,1084,2066,2165,2175];function Xw(e,r,t,a,n){var i=a,s=[],o=t.slice(t.l,t.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}s.push(o),t.l+=i;for(var c=Dr(t,t.l),l=Vs[c],f=0;l!=null&&zw.indexOf(c)>-1;)i=Dr(t,t.l+2),f=t.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=t.slice(f,t.l+4+i),s.push(o),t.l+=4+i,l=Vs[c=Dr(t,t.l)];var u=Et(s);bt(u,0);var d=0;u.lens=[];for(var h=0;h<s.length;++h)u.lens.push(d),d+=s[h].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return r.f(u,u.length,n)}function kr(e,r,t){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=xe[a])}catch(i){if(r.WTF)throw i}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Hr[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fn(e.v):e.w=xa(e.v):e.w=fr(a,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&a&&e.t=="n"&&Ka(xe[a]||String(a))){var n=da(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function yi(e,r,t){return{v:e,ixfe:r,t}}function Yw(e,r){var t={opts:{}},a={};at!=null&&r.dense==null&&(r.dense=at);var n=r.dense?[]:{},i={},s={},o=null,c=[],l="",f={},u,d="",h,m,p,g,v={},y=[],x,O,I=[],A=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},N=function(Oe){return Oe<8?ha[Oe]:Oe<64&&A[Oe-8]||ha[Oe]},M=function(Oe,ot,rr){var gt=ot.XF.data;if(!(!gt||!gt.patternType||!rr||!rr.cellStyles)){ot.s={},ot.s.patternType=gt.patternType;var la;(la=Dn(N(gt.icvFore)))&&(ot.s.fgColor={rgb:la}),(la=Dn(N(gt.icvBack)))&&(ot.s.bgColor={rgb:la})}},G=function(Oe,ot,rr){if(!(V>1)&&!(rr.sheetRows&&Oe.r>=rr.sheetRows)){if(rr.cellStyles&&ot.XF&&ot.XF.data&&M(Oe,ot,rr),delete ot.ixfe,delete ot.XF,u=Oe,d=ve(Oe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Oe.r<s.s.r&&(s.s.r=Oe.r),Oe.c<s.s.c&&(s.s.c=Oe.c),Oe.r+1>s.e.r&&(s.e.r=Oe.r+1),Oe.c+1>s.e.c&&(s.e.c=Oe.c+1),rr.cellFormula&&ot.f){for(var gt=0;gt<y.length;++gt)if(!(y[gt][0].s.c>Oe.c||y[gt][0].s.r>Oe.r)&&!(y[gt][0].e.c<Oe.c||y[gt][0].e.r<Oe.r)){ot.F=Ee(y[gt][0]),(y[gt][0].s.c!=Oe.c||y[gt][0].s.r!=Oe.r)&&delete ot.f,ot.f&&(ot.f=""+Rt(y[gt][1],s,Oe,te,L));break}}rr.dense?(n[Oe.r]||(n[Oe.r]=[]),n[Oe.r][Oe.c]=ot):n[d]=ot}},L={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(L.password=r.password);var ee,fe=[],Z=[],pe=[],J=[],ge=!1,te=[];te.SheetNames=L.snames,te.sharedf=L.sharedf,te.arrayf=L.arrayf,te.names=[],te.XTI=[];var ue=0,V=0,C=0,B=[],R=[],P;L.codepage=1200,gr(1200);for(var z=!1;e.l<e.length-1;){var ce=e.l,re=e.read_shift(2);if(re===0&&ue===10)break;var ae=e.l===e.length?0:e.read_shift(2),q=Vs[re];if(q&&q.f){if(r.bookSheets&&ue===133&&re!==133)break;if(ue=re,q.r===2||q.r==12){var ke=e.read_shift(2);if(ae-=2,!L.enc&&ke!==re&&((ke&255)<<8|ke>>8)!==re)throw new Error("rt mismatch: "+ke+"!="+re);q.r==12&&(e.l+=10,ae-=10)}var F={};if(re===10?F=q.f(e,ae,L):F=Xw(re,q,e,ae,L),V==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(re){case 34:t.opts.Date1904=k.WBProps.date1904=F;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=F,!r.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=F;break;case 66:var je=Number(F);switch(je){case 21010:je=1200;break;case 32768:je=1e4;break;case 32769:je=1252;break}gr(L.codepage=je),z=!0;break;case 317:L.rrtabid=F;break;case 25:L.winlocked=F;break;case 439:t.opts.RefreshAll=F;break;case 12:t.opts.CalcCount=F;break;case 16:t.opts.CalcDelta=F;break;case 17:t.opts.CalcIter=F;break;case 13:t.opts.CalcMode=F;break;case 14:t.opts.CalcPrecision=F;break;case 95:t.opts.CalcSaveRecalc=F;break;case 15:L.CalcRefMode=F;break;case 2211:t.opts.FullCalc=F;break;case 129:F.fDialog&&(n["!type"]="dialog"),F.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),F.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:I.push(F);break;case 430:te.push([F]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(F);break;case 24:case 536:P={Name:F.Name,Ref:Rt(F.rgce,s,null,te,L)},F.itab>0&&(P.Sheet=F.itab-1),te.names.push(P),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(R[F.itab-1]={ref:Ee(F.rgce[0][0][1][2])});break;case 22:L.ExternCount=F;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(F),te.XTI=te.XTI.concat(F);break;case 2196:if(L.biff<8)break;P!=null&&(P.Comment=F[1]);break;case 18:n["!protect"]=F;break;case 19:F!==0&&L.WTF&&console.error("Password verifier: "+F);break;case 133:i[F.pos]=F,L.snames.push(F.name);break;case 10:{if(--V)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,n["!ref"]=Ee(s),r.sheetRows&&r.sheetRows<=s.e.r){var Ie=s.e.r;s.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Ee(s),s.e.r=Ie}s.e.r++,s.e.c++}fe.length>0&&(n["!merges"]=fe),Z.length>0&&(n["!objects"]=Z),pe.length>0&&(n["!cols"]=pe),J.length>0&&(n["!rows"]=J),k.Sheets.push(D)}l===""?f=n:a[l]=n,n=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),L.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(L.biff=5,z=!0,gr(L.codepage=28591)),L.biff==8&&F.BIFFVer==0&&F.dt==16&&(L.biff=2),V++)break;if(n=r.dense?[]:{},L.biff<8&&!z&&(z=!0,gr(L.codepage=r.codepage||1252)),L.biff<5||F.BIFFVer==0&&F.dt==4096){l===""&&(l="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var He={pos:e.l-ae,name:l};i[He.pos]=He,L.snames.push(l)}else l=(i[ce]||{name:""}).name;F.dt==32&&(n["!type"]="chart"),F.dt==64&&(n["!type"]="macro"),fe=[],Z=[],L.arrayf=y=[],pe=[],J=[],ge=!1,D={Hidden:(i[ce]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(r.dense?(n[F.r]||[])[F.c]:n[ve({c:F.c,r:F.r})])&&++F.c,x={ixfe:F.ixfe,XF:I[F.ixfe]||{},v:F.val,t:"n"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G({c:F.c,r:F.r},x,r);break;case 5:case 517:x={ixfe:F.ixfe,XF:I[F.ixfe],v:F.val,t:F.t},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G({c:F.c,r:F.r},x,r);break;case 638:x={ixfe:F.ixfe,XF:I[F.ixfe],v:F.rknum,t:"n"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G({c:F.c,r:F.r},x,r);break;case 189:for(var Re=F.c;Re<=F.C;++Re){var de=F.rkrec[Re-F.c][0];x={ixfe:de,XF:I[de],v:F.rkrec[Re-F.c][1],t:"n"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G({c:Re,r:F.r},x,r)}break;case 6:case 518:case 1030:{if(F.val=="String"){o=F;break}if(x=yi(F.val,F.cell.ixfe,F.tt),x.XF=I[x.ixfe],r.cellFormula){var st=F.formula;if(st&&st[0]&&st[0][0]&&st[0][0][0]=="PtgExp"){var tr=st[0][0][1][0],wr=st[0][0][1][1],Rr=ve({r:tr,c:wr});v[Rr]?x.f=""+Rt(F.formula,s,F.cell,te,L):x.F=((r.dense?(n[tr]||[])[wr]:n[Rr])||{}).F}else x.f=""+Rt(F.formula,s,F.cell,te,L)}C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G(F.cell,x,r),o=F}break;case 7:case 519:if(o)o.val=F,x=yi(F,o.cell.ixfe,"s"),x.XF=I[x.ixfe],r.cellFormula&&(x.f=""+Rt(o.formula,s,o.cell,te,L)),C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G(o.cell,x,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(F);var on=ve(F[0].s);if(h=r.dense?(n[F[0].s.r]||[])[F[0].s.c]:n[on],r.cellFormula&&h){if(!o||!on||!h)break;h.f=""+Rt(F[1],s,F[0],te,L),h.F=Ee(F[0])}}break;case 1212:{if(!r.cellFormula)break;if(d){if(!o)break;v[ve(o.cell)]=F[0],h=r.dense?(n[o.cell.r]||[])[o.cell.c]:n[ve(o.cell)],(h||{}).f=""+Rt(F[0],s,u,te,L)}}break;case 253:x=yi(c[F.isst].t,F.ixfe,"s"),c[F.isst].h&&(x.h=c[F.isst].h),x.XF=I[x.ixfe],C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G({c:F.c,r:F.r},x,r);break;case 513:r.sheetStubs&&(x={ixfe:F.ixfe,XF:I[F.ixfe],t:"z"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G({c:F.c,r:F.r},x,r));break;case 190:if(r.sheetStubs)for(var Xr=F.c;Xr<=F.C;++Xr){var Yt=F.ixfe[Xr-F.c];x={ixfe:Yt,XF:I[Yt],t:"z"},C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G({c:Xr,r:F.r},x,r)}break;case 214:case 516:case 4:x=yi(F.val,F.ixfe,"s"),x.XF=I[x.ixfe],C>0&&(x.z=B[x.ixfe>>8&63]),kr(x,r,t.opts.Date1904),G({c:F.c,r:F.r},x,r);break;case 0:case 512:V===1&&(s=F);break;case 252:c=F;break;case 1054:if(L.biff==4){B[C++]=F[1];for(var Pr=0;Pr<C+163&&xe[Pr]!=F[1];++Pr);Pr>=163&&Br(F[1],C+163)}else Br(F[1],F[0]);break;case 30:{B[C++]=F;for(var Yr=0;Yr<C+163&&xe[Yr]!=F;++Yr);Yr>=163&&Br(F,C+163)}break;case 229:fe=fe.concat(F);break;case 93:Z[F.cmo[0]]=L.lastobj=F;break;case 438:L.lastobj.TxO=F;break;case 127:L.lastobj.ImData=F;break;case 440:for(g=F[0].s.r;g<=F[0].e.r;++g)for(p=F[0].s.c;p<=F[0].e.c;++p)h=r.dense?(n[g]||[])[p]:n[ve({c:p,r:g})],h&&(h.l=F[1]);break;case 2048:for(g=F[0].s.r;g<=F[0].e.r;++g)for(p=F[0].s.c;p<=F[0].e.c;++p)h=r.dense?(n[g]||[])[p]:n[ve({c:p,r:g})],h&&h.l&&(h.l.Tooltip=F[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;h=r.dense?(n[F[0].r]||[])[F[0].c]:n[ve(F[0])];var cn=Z[F[2]];h||(r.dense?(n[F[0].r]||(n[F[0].r]=[]),h=n[F[0].r][F[0].c]={t:"z"}):h=n[ve(F[0])]={t:"z"},s.e.r=Math.max(s.e.r,F[0].r),s.s.r=Math.min(s.s.r,F[0].r),s.e.c=Math.max(s.e.c,F[0].c),s.s.c=Math.min(s.s.c,F[0].c)),h.c||(h.c=[]),m={a:F[1],t:cn.TxO.t},h.c.push(m)}break;case 2173:Dg(I[F.ixfe],F.ext);break;case 125:{if(!L.cellStyles)break;for(;F.e>=F.s;)pe[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},ge||(ge=!0,ko(F.w/256)),ea(pe[F.e+1])}break;case 520:{var Ut={};F.level!=null&&(J[F.r]=Ut,Ut.level=F.level),F.hidden&&(J[F.r]=Ut,Ut.hidden=!0),F.hpt&&(J[F.r]=Ut,Ut.hpt=F.hpt,Ut.hpx=qa(F.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||ga(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[re]]=F;break;case 161:n["!margins"]||ga(n["!margins"]={}),n["!margins"].header=F.header,n["!margins"].footer=F.footer;break;case 574:F.RTL&&(k.Views[0].RTL=!0);break;case 146:A=F;break;case 2198:ee=F;break;case 140:O=F;break;case 442:l?D.CodeName=F||D.name:k.WBProps.CodeName=F||"ThisWorkbook";break}}else q||console.error("Missing Info for XLS Record 0x"+re.toString(16)),e.l+=ae}return t.SheetNames=nt(i).sort(function(_r,Oe){return Number(_r)-Number(Oe)}).map(function(_r){return i[_r].name}),r.bookSheets||(t.Sheets=a),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&R.forEach(function(_r,Oe){t.Sheets[t.SheetNames[Oe]]["!autofilter"]=_r}),t.Strings=c,t.SSF=Je(xe),L.enc&&(t.Encryption=L.enc),ee&&(t.Themes=ee),t.Metadata={},O!==void 0&&(t.Metadata.Country=O),te.names.length>0&&(k.Names=te.names),t.Workbook=k,t}var Cn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function qw(e,r,t){var a=me.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=tl(a,Ls,Cn.DSI);for(var i in n)r[i]=n[i]}catch(l){if(t.WTF)throw l}var s=me.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=tl(s,Bs,Cn.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(v0(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function Kw(e,r){var t=[],a=[],n=[],i=0,s,o=Ic(Ls,"n"),c=Ic(Bs,"n");if(e.Props)for(s=nt(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(c,s[i])?a:n).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=nt(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(c,s[i])?a:n).push([s[i],e.Custprops[s[i]]]);var l=[];for(i=0;i<n.length;++i)T0.indexOf(n[i][0])>-1||x0.indexOf(n[i][0])>-1||n[i][1]!=null&&l.push(n[i]);a.length&&me.utils.cfb_add(r,"/SummaryInformation",rl(a,Cn.SI,c,Bs)),(t.length||l.length)&&me.utils.cfb_add(r,"/DocumentSummaryInformation",rl(t,Cn.DSI,o,Ls,l.length?l:null,Cn.UDI))}function _f(e,r){r||(r={}),Io(r),Xs(),r.codepage&&zs(r.codepage);var t,a;if(e.FullPaths){if(me.find(e,"/encryption"))throw new Error("File is password-protected");t=me.find(e,"!CompObj"),a=me.find(e,"/Workbook")||me.find(e,"/Book")}else{switch(r.type){case"base64":e=Jt(Qt(e));break;case"binary":e=Jt(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}bt(e,0),a={content:e}}var n,i;if(t&&Gw(t),r.bookProps&&!r.bookSheets)n={};else{var s=Ae?"buffer":"array";if(a&&a.content)n=Yw(a.content,r);else if((i=me.find(e,"PerfectOffice_MAIN"))&&i.content)n=ma.to_workbook(i.content,(r.type=s,r));else if((i=me.find(e,"NativeContent_MAIN"))&&i.content)n=ma.to_workbook(i.content,(r.type=s,r));else throw(i=me.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&me.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=lx(e))}var o={};return e.FullPaths&&qw(e,o,r),n.Props=n.Custprops=o,r.bookFiles&&(n.cfb=e),n}function Jw(e,r){var t=r||{},a=me.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return me.utils.cfb_add(a,n,kf(e,t)),t.biff==8&&(e.Props||e.Custprops)&&Kw(e,a),t.biff==8&&e.vbaraw&&fx(a,me.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Un={0:{f:_2},1:{f:O2},2:{f:Y2},3:{f:B2},4:{f:P2},5:{f:G2},6:{f:Q2},7:{f:j2},8:{f:sy},9:{f:iy},10:{f:ay},11:{f:ny},12:{f:I2},13:{f:K2},14:{f:U2},15:{f:D2},16:{f:hf},17:{f:ty},18:{f:V2},19:{f:uo},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tw},40:{},42:{},43:{f:Qm},44:{f:Jm},45:{f:rg},46:{f:ng},47:{f:ag},48:{},49:{f:Sh},50:{},51:{f:Mg},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:L0},62:{f:Z2},63:{f:Xg},64:{f:ky},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Bt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vy},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:C2},148:{f:S2,p:16},151:{f:dy},152:{},153:{f:Zy},154:{},155:{},156:{f:Ky},157:{},158:{},159:{T:1,f:pm},160:{T:-1},161:{T:1,f:Ca},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:oy},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Lg},336:{T:-1},337:{f:jg,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ds},357:{},358:{},359:{},360:{T:1},361:{},362:{f:D0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hy},427:{f:py},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:gy},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:b2},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fy},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ds},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nx},633:{T:1},634:{T:-1},635:{T:1,f:rx},636:{T:-1},637:{f:Ah},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Uy},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ey},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vs={6:{f:bs},10:{f:Kr},12:{f:mt},13:{f:mt},14:{f:ct},15:{f:ct},16:{f:Nt},17:{f:ct},18:{f:ct},19:{f:mt},20:{f:cl},21:{f:cl},23:{f:D0},24:{f:fl},25:{f:ct},26:{},27:{},28:{f:E1},29:{},34:{f:ct},35:{f:ll},38:{f:Nt},39:{f:Nt},40:{f:Nt},41:{f:Nt},42:{f:ct},43:{f:ct},47:{f:Dm},49:{f:Kp},51:{f:mt},60:{},61:{f:Gp},64:{f:ct},65:{f:qp},66:{f:mt},77:{},80:{},81:{},82:{},85:{f:mt},89:{},90:{},91:{},92:{f:Np},93:{f:b1},94:{},95:{f:ct},96:{},97:{},99:{f:ct},125:{f:L0},128:{f:u1},129:{f:Lp},130:{f:mt},131:{f:ct},132:{f:ct},133:{f:Bp},134:{},140:{f:N1},141:{f:mt},144:{},146:{f:B1},151:{},152:{},153:{},154:{},155:{},156:{f:mt},157:{},158:{},160:{f:W1},161:{f:$1},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:o1},190:{f:c1},193:{f:Kr},197:{},198:{},199:{},200:{},201:{},202:{f:ct},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mt},220:{},221:{f:ct},222:{},224:{f:f1},225:{f:Pp},226:{f:Kr},227:{},229:{f:S1},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Up},253:{f:Zp},255:{f:jp},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:b0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ct},353:{f:Kr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:g1},431:{f:ct},432:{},433:{},434:{},437:{},438:{f:O1},439:{f:ct},440:{f:F1},441:{},442:{f:Wn},443:{},444:{f:mt},445:{},446:{},448:{f:Kr},449:{f:Wp,r:2},450:{f:Kr},512:{f:il},513:{f:V1},515:{f:p1},516:{f:e1},517:{f:ol},519:{f:G1},520:{f:Hp},523:{},545:{f:ul},549:{f:nl},566:{},574:{f:Xp},638:{f:s1},659:{},1048:{},1054:{f:r1},1084:{},1212:{f:w1},2048:{f:R1},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:gi},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Kr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:M1,r:12},2173:{f:Ng,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ct,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:y1,r:12},2197:{},2198:{f:Ag,r:12},2199:{},2200:{},2201:{},2202:{f:_1,r:12},2203:{f:Kr},2204:{},2205:{},2206:{},2207:{},2211:{f:Vp},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:j1},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:L1},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:il},1:{},2:{f:K1},3:{f:Y1},4:{f:X1},5:{f:ol},7:{f:Z1},8:{},9:{f:gi},11:{},22:{f:mt},30:{f:n1},31:{},32:{},33:{f:ul},36:{},37:{f:nl},50:{f:Q1},62:{},52:{},67:{},68:{f:mt},69:{},86:{},126:{},127:{f:z1},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:em},223:{},234:{},354:{},421:{},518:{f:bs},521:{f:gi},536:{f:fl},547:{f:ll},561:{},579:{},1030:{f:bs},1033:{f:gi},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ie(e,r,t,a){var n=r;if(!isNaN(n)){var i=a||(t||[]).length||0,s=e.next(4);s.write_shift(2,n),s.write_shift(2,i),i>0&&co(t)&&e.push(t)}}function Zw(e,r,t,a){var n=a||(t||[]).length||0;if(n<=8224)return ie(e,r,t,n);var i=r;if(!isNaN(i)){for(var s=t.parts||[],o=0,c=0,l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,l),e.push(t.slice(c,c+l)),c+=l;c<n;){for(f=e.next(4),f.write_shift(2,60),l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;f.write_shift(2,l),e.push(t.slice(c,c+l)),c+=l}}}function Yn(e,r,t){return e||(e=X(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function Qw(e,r,t,a){var n=X(9);return Yn(n,e,r),C0(t,a||"b",n),n}function e_(e,r,t){var a=X(8+2*t.length);return Yn(a,e,r),a.write_shift(1,t.length),a.write_shift(t.length,t,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function t_(e,r,t,a){if(r.v!=null)switch(r.t){case"d":case"n":var n=r.t=="d"?yt(Ke(r.v)):r.v;n==(n|0)&&n>=0&&n<65536?ie(e,2,J1(t,a,n)):ie(e,3,q1(t,a,n));return;case"b":case"e":ie(e,5,Qw(t,a,r.v,r.t));return;case"s":case"str":ie(e,4,e_(t,a,(r.v||"").slice(0,255)));return}ie(e,1,Yn(null,t,a))}function r_(e,r,t,a){var n=Array.isArray(r),i=Be(r["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Ee(i)}for(var l=i.s.r;l<=i.e.r;++l){o=lt(l);for(var f=i.s.c;f<=i.e.c;++f){l===i.s.r&&(c[f]=Qe(f)),s=c[f]+o;var u=n?(r[l]||[])[f]:r[s];u&&t_(e,u,l,f,a)}}}function a_(e,r){var t=r||{};at!=null&&t.dense==null&&(t.dense=at);for(var a=zt(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(n=i);if(n==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return ie(a,t.biff==4?1033:t.biff==3?521:9,yo(e,16,t)),r_(a,e.Sheets[e.SheetNames[n]],n,t,e),ie(a,10),a.end()}function n_(e,r,t){ie(e,49,Jp({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function i_(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&ie(e,1054,a1(n,r[n],t))})}function s_(e,r){var t=X(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),ie(e,2151,t),t=X(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),R0(Be(r["!ref"]||"A1"),t),t.write_shift(4,4),ie(e,2152,t)}function o_(e,r){for(var t=0;t<16;++t)ie(e,224,sl({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(a){ie(e,224,sl(a,0,r))})}function c_(e,r){for(var t=0;t<r["!links"].length;++t){var a=r["!links"][t];ie(e,440,I1(a)),a[1].Tooltip&&ie(e,2048,P1(a))}delete r["!links"]}function l_(e,r){if(r){var t=0;r.forEach(function(a,n){++t<=256&&a&&ie(e,125,U1(Vi(n,a),n))})}}function f_(e,r,t,a,n){var i=16+ia(n.cellXfs,r,n);if(r.v==null&&!r.bf){ie(e,513,_a(t,a,i));return}if(r.bf)ie(e,6,Lv(r,t,a,n,i));else switch(r.t){case"d":case"n":var s=r.t=="d"?yt(Ke(r.v)):r.v;ie(e,515,m1(t,a,s,i,n));break;case"b":case"e":ie(e,517,h1(t,a,r.v,i,n,r.t));break;case"s":case"str":if(n.bookSST){var o=Co(n.Strings,r.v,n.revStrings);ie(e,253,Qp(t,a,o,i,n))}else ie(e,516,t1(t,a,(r.v||"").slice(0,255),i,n));break;default:ie(e,513,_a(t,a,i))}}function u_(e,r,t){var a=zt(),n=t.SheetNames[e],i=t.Sheets[n]||{},s=(t||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),l=r.biff==8,f,u="",d=[],h=Be(i["!ref"]||"A1"),m=l?65536:16384;if(h.e.c>255||h.e.r>=m){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}ie(a,2057,yo(t,16,r)),ie(a,13,cr(1)),ie(a,12,cr(100)),ie(a,15,Ht(!0)),ie(a,17,Ht(!1)),ie(a,16,ya(.001)),ie(a,95,Ht(!0)),ie(a,42,Ht(!1)),ie(a,43,Ht(!1)),ie(a,130,cr(1)),ie(a,128,d1([0,0])),ie(a,131,Ht(!1)),ie(a,132,Ht(!1)),l&&l_(a,i["!cols"]),ie(a,512,i1(h,r)),l&&(i["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){u=lt(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(d[g]=Qe(g)),f=d[g]+u;var v=c?(i[p]||[])[g]:i[f];v&&(f_(a,v,p,g,r),l&&v.l&&i["!links"].push([f,v.l]))}}var y=o.CodeName||o.name||n;return l&&ie(a,574,Yp((s.Views||[])[0])),l&&(i["!merges"]||[]).length&&ie(a,229,T1(i["!merges"])),l&&c_(a,i),ie(a,442,A0(y,r)),l&&s_(a,i),ie(a,10),a.end()}function d_(e,r,t){var a=zt(),n=(e||{}).Workbook||{},i=n.Sheets||[],s=n.WBProps||{},o=t.biff==8,c=t.biff==5;if(ie(a,2057,yo(e,5,t)),t.bookType=="xla"&&ie(a,135),ie(a,225,o?cr(1200):null),ie(a,193,hp(2)),c&&ie(a,191),c&&ie(a,192),ie(a,226),ie(a,92,Dp("SheetJS",t)),ie(a,66,cr(o?1200:1252)),o&&ie(a,353,cr(0)),o&&ie(a,448),ie(a,317,H1(e.SheetNames.length)),o&&e.vbaraw&&ie(a,211),o&&e.vbaraw){var l=s.CodeName||"ThisWorkbook";ie(a,442,A0(l,t))}ie(a,156,cr(17)),ie(a,25,Ht(!1)),ie(a,18,Ht(!1)),ie(a,19,cr(0)),o&&ie(a,431,Ht(!1)),o&&ie(a,444,cr(0)),ie(a,61,zp(t)),ie(a,64,Ht(!1)),ie(a,141,cr(0)),ie(a,34,Ht(Wy(e)=="true")),ie(a,14,Ht(!0)),o&&ie(a,439,Ht(!1)),ie(a,218,cr(0)),n_(a,e,t),i_(a,e.SSF,t),o_(a,t),o&&ie(a,352,Ht(!1));var f=a.end(),u=zt();o&&ie(u,140,D1()),o&&t.Strings&&Zw(u,252,$p(t.Strings,t)),ie(u,10);var d=u.end(),h=zt(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=f.length+m+d.length;for(p=0;p<e.SheetNames.length;++p){var v=i[p]||{};ie(h,133,Mp({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},t)),g+=r[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var x=[];return f.length&&x.push(f),y.length&&x.push(y),d.length&&x.push(d),Et(x)}function h_(e,r){var t=r||{},a=[];e&&!e.SSF&&(e.SSF=Je(xe)),e&&e.SSF&&(Ja(),Di(e.SSF),t.revssf=Bi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ro(t),t.cellXfs=[],ia(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=u_(n,t,e);return a.unshift(d_(e,a,t)),Et(a)}function kf(e,r){for(var t=0;t<=e.SheetNames.length;++t){var a=e.Sheets[e.SheetNames[t]];if(!(!a||!a["!ref"])){var n=Xt(a["!ref"]);n.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return h_(e,r);case 4:case 3:case 2:return a_(e,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function _l(e,r){var t=r||{};at!=null&&t.dense==null&&(t.dense=at);var a=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=n.index,o=i&&i.index||e.length,c=Jd(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,u=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<c.length;++s){var p=c[s].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var v=p.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var x=y,O=0;x.charAt(0)=="<"&&(O=x.indexOf(">"))>-1;)x=x.slice(O+1);for(var I=0;I<m.length;++I){var A=m[I];A.s.c==f&&A.s.r<l&&l<=A.e.r&&(f=A.e.c+1,I=-1)}var k=ye(y.slice(0,y.indexOf(">")));d=k.colspan?+k.colspan:1,((u=+k.rowspan)>1||d>1)&&m.push({s:{r:l,c:f},e:{r:l+(u||1)-1,c:f+d-1}});var D=k.t||k["data-t"]||"";if(!x.length){f+=d;continue}if(x=Kl(x),h.s.r>l&&(h.s.r=l),h.e.r<l&&(h.e.r=l),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!x.length){f+=d;continue}var N={t:"s",v:x};t.raw||!x.trim().length||D=="s"||(x==="TRUE"?N={t:"b",v:!0}:x==="FALSE"?N={t:"b",v:!1}:isNaN(vr(x))?isNaN(Xa(x).getDate())||(N={t:"d",v:Ke(x)},t.cellDates||(N={t:"n",v:yt(N.v)}),N.z=t.dateNF||xe[14]):N={t:"n",v:vr(x)}),t.dense?(a[l]||(a[l]=[]),a[l][f]=N):a[ve({r:l,c:f})]=N,f+=d}}}}return a["!ref"]=Ee(h),m.length&&(a["!merges"]=m),a}function p_(e,r,t,a){for(var n=e["!merges"]||[],i=[],s=r.s.c;s<=r.e.c;++s){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>t||n[l].s.c>s)&&!(n[l].e.r<t||n[l].e.c<s)){if(n[l].s.r<t||n[l].s.c<s){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var f=ve({r:t,c:s}),u=a.dense?(e[t]||[])[s]:e[f],d=u&&u.v!=null&&(u.h||to(u.w||(Ur(u),u.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),a.editable?d='<span contenteditable="true">'+d+"</span>":u&&(h["data-t"]=u&&u.t||"z",u.v!=null&&(h["data-v"]=u.v),u.z!=null&&(h["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),h.id=(a.id||"sjs")+"-"+f,i.push(ne("td",d,h))}}var m="<tr>";return m+i.join("")+"</tr>"}var m_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',g_="</body></html>";function x_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return na(_l(t[0],r),r);var a=Lo();return t.forEach(function(n,i){Bo(a,_l(n,r),"Sheet"+(i+1))}),a}function v_(e,r,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Ef(e,r){var t=r||{},a=t.header!=null?t.header:m_,n=t.footer!=null?t.footer:g_,i=[a],s=Xt(e["!ref"]);t.dense=Array.isArray(e),i.push(v_(e,s,t));for(var o=s.s.r;o<=s.e.r;++o)i.push(p_(e,s,o,t));return i.push("</table>"+n),i.join("")}function Sf(e,r,t){var a=t||{};at!=null&&(a.dense=at);var n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var s=typeof a.origin=="string"?et(a.origin):a.origin;n=s.r,i=s.c}var o=r.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var f=Xt(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),n==-1&&(l.e.r=n=f.e.r+1)}var u=[],d=0,h=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,v=0,y=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<c;++m){var O=o[m];if(kl(O)){if(a.display)continue;h[p]={hidden:!0}}var I=O.children;for(g=v=0;g<I.length;++g){var A=I[g];if(!(a.display&&kl(A))){var k=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):Kl(A.innerHTML),D=A.getAttribute("data-z")||A.getAttribute("z");for(d=0;d<u.length;++d){var N=u[d];N.s.c==v+i&&N.s.r<p+n&&p+n<=N.e.r&&(v=N.e.c+1-i,d=-1)}x=+A.getAttribute("colspan")||1,((y=+A.getAttribute("rowspan")||1)>1||x>1)&&u.push({s:{r:p+n,c:v+i},e:{r:p+n+(y||1)-1,c:v+i+(x||1)-1}});var M={t:"s",v:k},G=A.getAttribute("data-t")||A.getAttribute("t")||"";k!=null&&(k.length==0?M.t=G||"z":a.raw||k.trim().length==0||G=="s"||(k==="TRUE"?M={t:"b",v:!0}:k==="FALSE"?M={t:"b",v:!1}:isNaN(vr(k))?isNaN(Xa(k).getDate())||(M={t:"d",v:Ke(k)},a.cellDates||(M={t:"n",v:yt(M.v)}),M.z=a.dateNF||xe[14]):M={t:"n",v:vr(k)})),M.z===void 0&&D!=null&&(M.z=D);var L="",ee=A.getElementsByTagName("A");if(ee&&ee.length)for(var fe=0;fe<ee.length&&!(ee[fe].hasAttribute("href")&&(L=ee[fe].getAttribute("href"),L.charAt(0)!="#"));++fe);L&&L.charAt(0)!="#"&&(M.l={Target:L}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][v+i]=M):e[ve({c:v+i,r:p+n})]=M,l.e.c<v+i&&(l.e.c=v+i),v+=x}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),l.e.r=Math.max(l.e.r,p-1+n),e["!ref"]=Ee(l),p>=c&&(e["!fullref"]=Ee((l.e.r=o.length-m+p-1+n,l))),e}function Tf(e,r){var t=r||{},a=t.dense?[]:{};return Sf(a,e,r)}function y_(e,r){return na(Tf(e,r),r)}function kl(e){var r="",t=w_(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function w_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function __(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Le(r.replace(/<[^>]*>/g,""));return[t]}var El={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function bf(e,r){var t=r||{};at!=null&&t.dense==null&&(t.dense=at);var a=ro(e),n=[],i,s,o={name:""},c="",l=0,f,u,d={},h=[],m=t.dense?[]:{},p,g,v={value:""},y="",x=0,O,I=[],A=-1,k=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,M={},G=[],L={},ee=0,fe=0,Z=[],pe=1,J=1,ge=[],te={Names:[]},ue={},V=["",""],C=[],B={},R="",P=0,z=!1,ce=!1,re=0;for(Pn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Pn.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":p[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?m["!ref"]=Ee(D):m["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=D.e.r&&(m["!fullref"]=m["!ref"],D.e.r=t.sheetRows-1,m["!ref"]=Ee(D)),G.length&&(m["!merges"]=G),Z.length&&(m["!rows"]=Z),f.name=f.\u540D\u79F0||f.name,typeof JSON!="undefined"&&JSON.stringify(f),h.push(f.name),d[f.name]=m,ce=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=ye(p[0],!1),A=k=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,m=t.dense?[]:{},G=[],Z=[],ce=!0);break;case"table-row-group":p[1]==="/"?--N:++N;break;case"table-row":case"\u884C":if(p[1]==="/"){A+=pe,pe=1;break}if(u=ye(p[0],!1),u.\u884C\u53F7?A=u.\u884C\u53F7-1:A==-1&&(A=0),pe=+u["number-rows-repeated"]||1,pe<10)for(re=0;re<pe;++re)N>0&&(Z[A+re]={level:N});k=-1;break;case"covered-table-cell":p[1]!=="/"&&++k,t.sheetStubs&&(t.dense?(m[A]||(m[A]=[]),m[A][k]={t:"z"}):m[ve({r:A,c:k})]={t:"z"}),y="",I=[];break;case"table-cell":case"\u6570\u636E":if(p[0].charAt(p[0].length-2)==="/")++k,v=ye(p[0],!1),J=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(g.f=vl(Le(v.formula))),(v.\u6570\u636E\u7C7B\u578B||v["value-type"])=="string"&&(g.t="s",g.v=Le(v["string-value"]||""),t.dense?(m[A]||(m[A]=[]),m[A][k]=g):m[ve({r:A,c:k})]=g),k+=J-1;else if(p[1]!=="/"){++k,y="",x=0,I=[],J=1;var ae=pe?A+pe-1:A;if(k>D.e.c&&(D.e.c=k),k<D.s.c&&(D.s.c=k),A<D.s.r&&(D.s.r=A),ae>D.e.r&&(D.e.r=ae),v=ye(p[0],!1),C=[],B={},g={t:v.\u6570\u636E\u7C7B\u578B||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=Le(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(ee=parseInt(v["number-matrix-rows-spanned"],10)||0,fe=parseInt(v["number-matrix-columns-spanned"],10)||0,L={s:{r:A,c:k},e:{r:A+ee-1,c:k+fe-1}},g.F=Ee(L),ge.push([L,g.F])),v.formula)g.f=vl(v.formula);else for(re=0;re<ge.length;++re)A>=ge[re][0].s.r&&A<=ge[re][0].e.r&&k>=ge[re][0].s.c&&k<=ge[re][0].e.c&&(g.F=ge[re][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(ee=parseInt(v["number-rows-spanned"],10)||0,fe=parseInt(v["number-columns-spanned"],10)||0,L={s:{r:A,c:k},e:{r:A+ee-1,c:k+fe-1}},G.push(L)),v["number-columns-repeated"]&&(J=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=qe(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=Ke(v["date-value"]),t.cellDates||(g.t="n",g.v=yt(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=Yd(v["time-value"])/86400,t.cellDates&&(g.t="d",g.v=Mi(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.\u6570\u636E\u6570\u503C);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(y=Le(v["string-value"]),I=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(z=!1,g.t==="s"&&(g.v=y||"",I.length&&(g.R=I),z=x==0),ue.Target&&(g.l=ue),C.length>0&&(g.c=C,C=[]),y&&t.cellText!==!1&&(g.w=y),z&&(g.t="z",delete g.v),(!z||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=A))for(var q=0;q<pe;++q){if(J=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(m[A+q]||(m[A+q]=[]),m[A+q][k]=q==0?g:Je(g);--J>0;)m[A+q][k+J]=Je(g);else for(m[ve({r:A+q,c:k})]=g;--J>0;)m[ve({r:A+q,c:k+J})]=Je(g);D.e.c<=k&&(D.e.c=k)}J=parseInt(v["number-columns-repeated"]||"1",10),k+=J-1,J=0,g={},y="",I=[]}ue={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i;B.t=y,I.length&&(B.R=I),B.a=R,C.push(B)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);R="",P=0,y="",x=0,I=[];break;case"creator":p[1]==="/"?R=a.slice(P,p.index):P=p.index+p[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);y="",x=0,I=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(M[o.name]=c,(i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=ye(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":s=ye(p[0],!1),c+=El[p[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":s=ye(p[0],!1),c+=El[p[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":s=ye(p[0],!1),V=Cs(s["cell-range-address"]);var ke={Name:s.name,Ref:V[0]+"!"+V[1]};ce&&(ke.Sheet=h.length),te.Names.push(ke);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var F=__(a.slice(x,p.index),O);y=(y.length>0?y+`
`:"")+F[0]}else O=ye(p[0],!1),x=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{V=Cs(ye(p[0])["target-range-address"]),d[V[0]]["!autofilter"]={ref:V[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(ue=ye(p[0],!1),!ue.href)break;ue.Target=Le(ue.href),delete ue.href,ue.Target.charAt(0)=="#"&&ue.Target.indexOf(".")>-1?(V=Cs(ue.Target.slice(1)),ue.Target="#"+V[0]+"!"+V[1]):ue.Target.match(/^\.\.[\\\/]/)&&(ue.Target=ue.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(t.WTF)throw new Error(p)}}var je={Sheets:d,SheetNames:h,Workbook:te};return t.bookSheets&&delete je.Sheets,je}function Sl(e,r){r=r||{},or(e,"META-INF/manifest.xml")&&Yh(pt(e,"META-INF/manifest.xml"),r);var t=Zt(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var a=bf(ze(t),r);return or(e,"meta.xml")&&(a.Props=m0(pt(e,"meta.xml"))),a}function Tl(e,r){return bf(e,r)}var k_=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Rn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ft+r}})(),bl=(function(){var e=function(i){return Ge(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,a=function(i,s,o){var c=[];c.push('      <table:table table:name="'+Ge(s.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,f=0,u=Xt(i["!ref"]||"A1"),d=i["!merges"]||[],h=0,m=Array.isArray(i);if(i["!cols"])for(f=0;f<=u.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(l=0;l<u.s.r;++l)p=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=u.e.r;++l){for(p=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+p+`>
`),f=0;f<u.s.c;++f)c.push(r);for(;f<=u.e.c;++f){var v=!1,y={},x="";for(h=0;h!=d.length;++h)if(!(d[h].s.c>f)&&!(d[h].s.r>l)&&!(d[h].e.c<f)&&!(d[h].e.r<l)){(d[h].s.c!=f||d[h].s.r!=l)&&(v=!0),y["table:number-columns-spanned"]=d[h].e.c-d[h].s.c+1,y["table:number-rows-spanned"]=d[h].e.r-d[h].s.r+1;break}if(v){c.push(t);continue}var O=ve({r:l,c:f}),I=m?(i[l]||[])[f]:i[O];if(I&&I.f&&(y["table:formula"]=Ge(Hv(I.f)),I.F&&I.F.slice(0,O.length)==O)){var A=Xt(I.F);y["table:number-matrix-columns-spanned"]=A.e.c-A.s.c+1,y["table:number-matrix-rows-spanned"]=A.e.r-A.s.r+1}if(!I){c.push(r);continue}switch(I.t){case"b":x=I.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=I.v?"true":"false";break;case"n":x=I.w||String(I.v||0),y["office:value-type"]="float",y["office:value"]=I.v||0;break;case"s":case"str":x=I.v==null?"":I.v,y["office:value-type"]="string";break;case"d":x=I.w||Ke(I.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Ke(I.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(r);continue}var k=e(x);if(I.l&&I.l.Target){var D=I.l.Target;D=D.charAt(0)=="#"?"#"+Vv(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),k=ne("text:a",k,{"xlink:href":D.replace(/&/g,"&amp;")})}c.push("          "+ne("table:table-cell",ne("text:p",k,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var f=0;f<l["!cols"].length;++f)if(l["!cols"][f]){var u=l["!cols"][f];if(u.width==null&&u.wpx==null&&u.wch==null)continue;ea(u),u.ods=o;var d=l["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var f=0;f<l["!rows"].length;++f)if(l["!rows"][f]){l["!rows"][f].ods=c;var u=l["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[ft],l=Rn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Rn({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+f+`>
`),c.push(p0().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),n(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var u=0;u!=s.SheetNames.length;++u)c.push(a(s.Sheets[s.SheetNames[u]],s,u,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function Cf(e,r){if(r.bookType=="fods")return bl(e,r);var t=Zs(),a="",n=[],i=[];return a="mimetype",Te(t,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Te(t,a,bl(e,r)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Te(t,a,k_(e,r)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Te(t,a,ft+p0()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Te(t,a,Jh(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Te(t,a,qh(n)),t}function ka(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ws(e){return typeof TextDecoder!="undefined"?new TextDecoder().decode(e):ze(aa(e))}function E_(e){return typeof TextEncoder!="undefined"?new TextEncoder().encode(e):Jt(Tr(e))}function S_(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var a=0;a<r.length;++a)if(e[t+a]!=r[a])continue e;return!0}return!1}function ra(e){var r=e.reduce(function(n,i){return n+i.length},0),t=new Uint8Array(r),a=0;return e.forEach(function(n){t.set(n,a),a+=n.length}),t}function Cl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function T_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,n=r+13;n>=r;--n)a=a*256+e[n];return(e[r+15]&128?-a:a)*Math.pow(10,t-6176)}function b_(e,r,t){var a=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,n=t/Math.pow(10,a-6176);e[r+15]|=a>>7,e[r+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[r+i]=n&255;e[r+15]|=t>=0?0:128}function $n(e,r){var t=r?r[0]:0,a=e[t]&127;e:if(e[t++]>=128&&(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),a}function Ve(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function rt(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Me(e){for(var r=[],t=[0];t[0]<e.length;){var a=t[0],n=$n(e,t),i=n&7;n=Math.floor(n/8);var s=0,o;if(n==0)break;switch(i){case 0:{for(var c=t[0];e[t[0]++]>=128;);o=e.slice(c,t[0])}break;case 5:s=4,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=$n(e,t),o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var l={data:o,type:i};r[n]==null?r[n]=[l]:r[n].push(l)}return r}function Tt(e){var r=[];return e.forEach(function(t,a){t.forEach(function(n){n.data&&(r.push(Ve(a*8+n.type)),n.type==2&&r.push(Ve(n.data.length)),r.push(n.data))})}),ra(r)}function Fo(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function ir(e){for(var r,t=[],a=[0];a[0]<e.length;){var n=$n(e,a),i=Me(e.slice(a[0],a[0]+n));a[0]+=n;var s={id:rt(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Me(o.data),l=rt(c[3][0].data);s.messages.push({meta:c,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(r=i[3])!=null&&r[0]&&(s.merge=rt(i[3][0].data)>>>0>0),t.push(s)}return t}function Ba(e){var r=[];return e.forEach(function(t){var a=[];a[1]=[{data:Ve(t.id),type:0}],a[2]=[],t.merge!=null&&(a[3]=[{data:Ve(+!!t.merge),type:0}]);var n=[];t.messages.forEach(function(s){n.push(s.data),s.meta[3]=[{type:0,data:Ve(s.data.length)}],a[2].push({data:Tt(s.meta),type:2})});var i=Tt(a);r.push(Ve(i.length)),r.push(i),n.forEach(function(s){return r.push(s)})}),ra(r)}function C_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],a=$n(r,t),n=[];t[0]<r.length;){var i=r[t[0]]&3;if(i==0){var s=r[t[0]++]>>2;if(s<60)++s;else{var o=s-59;s=r[t[0]],o>1&&(s|=r[t[0]+1]<<8),o>2&&(s|=r[t[0]+2]<<16),o>3&&(s|=r[t[0]+3]<<24),s>>>=0,s++,t[0]+=o}n.push(r.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var c=0,l=0;if(i==1?(l=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,i==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),n=[ra(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var f=ra(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function sr(e){for(var r=[],t=0;t<e.length;){var a=e[t++],n=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(C_(a,e.slice(t,t+n))),t+=n}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ra(r)}function Ma(e){for(var r=[],t=0;t<e.length;){var a=Math.min(e.length-t,268435455),n=new Uint8Array(4);r.push(n);var i=Ve(a),s=i.length;r.push(i),a<=60?(s++,r.push(new Uint8Array([a-1<<2]))):a<=256?(s+=2,r.push(new Uint8Array([240,a-1&255]))):a<=65536?(s+=3,r.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(s+=4,r.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(s+=5,r.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),r.push(e.slice(t,t+a)),s+=a,n[0]=0,n[1]=s&255,n[2]=s>>8&255,n[3]=s>>16&255,t+=a}return ra(r)}function A_(e,r,t,a){var n=ka(e),i=n.getUint32(4,!0),s=(a>1?12:8)+Cl(i&(a>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);i&512&&(o=n.getUint32(s,!0),s+=4),s+=Cl(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(s,!0),s+=4),i&32&&(l=n.getFloat64(s,!0),s+=8),i&64&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:l};break;case 3:u={t:"s",v:r[c]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:t[o]};else if(c>-1)u={t:"s",v:r[c]};else if(!isNaN(l))u={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function O_(e,r,t){var a=ka(e),n=a.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);n&1&&(c=T_(e,i),i+=16),n&2&&(l=a.getFloat64(i,!0),i+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(s=a.getUint32(i,!0),i+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:r[o]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(s>-1)u={t:"s",v:t[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return u}function Os(e,r){var t=new Uint8Array(32),a=ka(t),n=12,i=0;switch(t[0]=5,e.t){case"n":t[1]=2,b_(t,n,e.v),i|=1,n+=16;break;case"b":t[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,a.setUint32(n,r.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),t.slice(0,n)}function Fs(e,r){var t=new Uint8Array(32),a=ka(t),n=12,i=0;switch(t[0]=3,e.t){case"n":t[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":t[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,a.setUint32(n,r.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),t.slice(0,n)}function F_(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return A_(e,r,t,e[0]);case 5:return O_(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function It(e){var r=Me(e);return $n(r[1][0].data)}function Al(e,r){var t=Me(r.data),a=rt(t[1][0].data),n=t[3],i=[];return(n||[]).forEach(function(s){var o=Me(s.data),c=rt(o[1][0].data)>>>0;switch(a){case 1:i[c]=Ws(o[3][0].data);break;case 8:{var l=e[It(o[9][0].data)][0],f=Me(l.data),u=e[It(f[1][0].data)][0],d=rt(u.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=Me(u.data);i[c]=h[3].map(function(m){return Ws(m.data)}).join("")}break}}),i}function I_(e,r){var t,a,n,i,s,o,c,l,f,u,d,h,m,p,g=Me(e),v=rt(g[1][0].data)>>>0,y=rt(g[2][0].data)>>>0,x=((a=(t=g[8])==null?void 0:t[0])==null?void 0:a.data)&&rt(g[8][0].data)>0||!1,O,I;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&r!=0)O=(o=(s=g[7])==null?void 0:s[0])==null?void 0:o.data,I=(l=(c=g[6])==null?void 0:c[0])==null?void 0:l.data;else if((u=(f=g[4])==null?void 0:f[0])!=null&&u.data&&r!=1)O=(h=(d=g[4])==null?void 0:d[0])==null?void 0:h.data,I=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var A=x?4:1,k=ka(O),D=[],N=0;N<O.length/2;++N){var M=k.getUint16(N*2,!0);M<65535&&D.push([N,M])}if(D.length!=y)throw"Expected ".concat(y," cells, found ").concat(D.length);var G=[];for(N=0;N<D.length-1;++N)G[D[N][0]]=I.subarray(D[N][1]*A,D[N+1][1]*A);return D.length>=1&&(G[D[D.length-1][0]]=I.subarray(D[D.length-1][1]*A)),{R:v,cells:G}}function R_(e,r){var t,a=Me(r.data),n=(t=a==null?void 0:a[7])!=null&&t[0]?rt(a[7][0].data)>>>0>0?1:0:-1,i=Fo(a[5],function(s){return I_(s,n)});return{nrows:rt(a[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,l){if(s[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));s[o.R][l]=c}),s},[])}}function P_(e,r,t){var a,n=Me(r.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(rt(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(rt(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=Ee(i);var s=Me(n[4][0].data),o=Al(e,e[It(s[4][0].data)][0]),c=(a=s[17])!=null&&a[0]?Al(e,e[It(s[17][0].data)][0]):[],l=Me(s[3][0].data),f=0;l[1].forEach(function(u){var d=Me(u.data),h=e[It(d[2][0].data)][0],m=rt(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=R_(e,h);p.data.forEach(function(g,v){g.forEach(function(y,x){var O=ve({r:f+v,c:x}),I=F_(y,o,c);I&&(t[O]=I)})}),f+=p.nrows})}function N_(e,r){var t=Me(r.data),a={"!ref":"A1"},n=e[It(t[2][0].data)],i=rt(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return P_(e,n[0],a),a}function D_(e,r){var t,a=Me(r.data),n={name:(t=a[1])!=null&&t[0]?Ws(a[1][0].data):"",sheets:[]},i=Fo(a[2],It);return i.forEach(function(s){e[s].forEach(function(o){var c=rt(o.meta[1][0].data);c==6e3&&n.sheets.push(N_(e,o))})}),n}function L_(e,r){var t=Lo(),a=Me(r.data),n=Fo(a[1],It);if(n.forEach(function(i){e[i].forEach(function(s){var o=rt(s.meta[1][0].data);if(o==2){var c=D_(e,s);c.sheets.forEach(function(l,f){Bo(t,l,f==0?c.name:c.name+"_"+f,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Is(e){var r,t,a,n,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=sr(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var f;try{f=ir(l)}catch(u){return console.log("## "+(u.message||u))}f.forEach(function(u){i[u.id]=u.messages,s.push(u.id)})}}),!s.length)throw new Error("File has no messages");var o=((n=(a=(t=(r=i==null?void 0:i[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&rt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(l){var f=rt(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return L_(i,o)}function B_(e,r,t){var a,n,i,s;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&rt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=ka(e[7][0].data),f=0,u=[],d=ka(e[4][0].data),h=0,m=[],p=0;p<r.length;++p){if(r[p]==null){l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}l.setUint16(p*2,f,!0),d.setUint16(p*2,h,!0);var g,v;switch(typeof r[p]){case"string":g=Os({t:"s",v:r[p]},t),v=Fs({t:"s",v:r[p]},t);break;case"number":g=Os({t:"n",v:r[p]},t),v=Fs({t:"n",v:r[p]},t);break;case"boolean":g=Os({t:"b",v:r[p]},t),v=Fs({t:"b",v:r[p]},t);break;default:throw new Error("Unsupported value "+r[p])}u.push(g),f+=g.length,m.push(v),h+=v.length,++c}for(e[2][0].data=Ve(c);p<e[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return e[6][0].data=ra(u),e[3][0].data=ra(m),c}function M_(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Xt(t["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Ee(a)));var i=Pi(t,{range:a,header:1}),s=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(P){typeof P=="string"&&s.push(P)})});var o={},c=[],l=me.read(r.numbers,{type:"base64"});l.FileIndex.map(function(R,P){return[R,l.FullPaths[P]]}).forEach(function(R){var P=R[0],z=R[1];if(P.type==2&&P.name.match(/\.iwa/)){var ce=P.content,re=sr(ce),ae=ir(re);ae.forEach(function(q){c.push(q.id),o[q.id]={deps:[],location:z,type:rt(q.messages[0].meta[1][0].data)}})}}),c.sort(function(R,P){return R-P});var f=c.filter(function(R){return R>1}).map(function(R){return[R,Ve(R)]});l.FileIndex.map(function(R,P){return[R,l.FullPaths[P]]}).forEach(function(R){var P=R[0],z=R[1];if(P.name.match(/\.iwa/)){var ce=ir(sr(P.content));ce.forEach(function(re){re.messages.forEach(function(ae){f.forEach(function(q){re.messages.some(function(ke){return rt(ke.meta[1][0].data)!=11006&&S_(ke.data,q[1])})&&o[q[0]].deps.push(re.id)})})})}});function u(){for(var R=927262;R<2e6;++R)if(!o[R])return R;throw new Error("Too many messages")}for(var d=me.find(l,o[1].location),h=ir(sr(d.content)),m,p=0;p<h.length;++p){var g=h[p];g.id==1&&(m=g)}var v=It(Me(m.messages[0].data)[1][0].data);for(d=me.find(l,o[v].location),h=ir(sr(d.content)),p=0;p<h.length;++p)g=h[p],g.id==v&&(m=g);for(v=It(Me(m.messages[0].data)[2][0].data),d=me.find(l,o[v].location),h=ir(sr(d.content)),p=0;p<h.length;++p)g=h[p],g.id==v&&(m=g);for(v=It(Me(m.messages[0].data)[2][0].data),d=me.find(l,o[v].location),h=ir(sr(d.content)),p=0;p<h.length;++p)g=h[p],g.id==v&&(m=g);var y=Me(m.messages[0].data);{y[6][0].data=Ve(a.e.r+1),y[7][0].data=Ve(a.e.c+1);var x=It(y[46][0].data),O=me.find(l,o[x].location),I=ir(sr(O.content));{for(var A=0;A<I.length&&I[A].id!=x;++A);if(I[A].id!=x)throw"Bad ColumnRowUIDMapArchive";var k=Me(I[A].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var D=0;D<=a.e.c;++D){var N=[];N[1]=N[2]=[{type:0,data:Ve(D+420690)}],k[1].push({type:2,data:Tt(N)}),k[2].push({type:0,data:Ve(D)}),k[3].push({type:0,data:Ve(D)})}k[4]=[],k[5]=[],k[6]=[];for(var M=0;M<=a.e.r;++M)N=[],N[1]=N[2]=[{type:0,data:Ve(M+726270)}],k[4].push({type:2,data:Tt(N)}),k[5].push({type:0,data:Ve(M)}),k[6].push({type:0,data:Ve(M)});I[A].messages[0].data=Tt(k)}O.content=Ma(Ba(I)),O.size=O.content.length,delete y[46];var G=Me(y[4][0].data);{G[7][0].data=Ve(a.e.r+1);var L=Me(G[1][0].data),ee=It(L[2][0].data);O=me.find(l,o[ee].location),I=ir(sr(O.content));{if(I[0].id!=ee)throw"Bad HeaderStorageBucket";var fe=Me(I[0].messages[0].data);for(M=0;M<i.length;++M){var Z=Me(fe[2][0].data);Z[1][0].data=Ve(M),Z[4][0].data=Ve(i[M].length),fe[2][M]={type:fe[2][0].type,data:Tt(Z)}}I[0].messages[0].data=Tt(fe)}O.content=Ma(Ba(I)),O.size=O.content.length;var pe=It(G[2][0].data);O=me.find(l,o[pe].location),I=ir(sr(O.content));{if(I[0].id!=pe)throw"Bad HeaderStorageBucket";for(fe=Me(I[0].messages[0].data),D=0;D<=a.e.c;++D)Z=Me(fe[2][0].data),Z[1][0].data=Ve(D),Z[4][0].data=Ve(a.e.r+1),fe[2][D]={type:fe[2][0].type,data:Tt(Z)};I[0].messages[0].data=Tt(fe)}O.content=Ma(Ba(I)),O.size=O.content.length;var J=It(G[4][0].data);(function(){for(var R=me.find(l,o[J].location),P=ir(sr(R.content)),z,ce=0;ce<P.length;++ce){var re=P[ce];re.id==J&&(z=re)}var ae=Me(z.messages[0].data);{ae[3]=[];var q=[];s.forEach(function(je,Ie){q[1]=[{type:0,data:Ve(Ie)}],q[2]=[{type:0,data:Ve(1)}],q[3]=[{type:2,data:E_(je)}],ae[3].push({type:2,data:Tt(q)})})}z.messages[0].data=Tt(ae);var ke=Ba(P),F=Ma(ke);R.content=F,R.size=R.content.length})();var ge=Me(G[3][0].data);{var te=ge[1][0];delete ge[2];var ue=Me(te.data);{var V=It(ue[2][0].data);(function(){for(var R=me.find(l,o[V].location),P=ir(sr(R.content)),z,ce=0;ce<P.length;++ce){var re=P[ce];re.id==V&&(z=re)}var ae=Me(z.messages[0].data);{delete ae[6],delete ge[7];var q=new Uint8Array(ae[5][0].data);ae[5]=[];for(var ke=0,F=0;F<=a.e.r;++F){var je=Me(q);ke+=B_(je,i[F],s),je[1][0].data=Ve(F),ae[5].push({data:Tt(je),type:2})}ae[1]=[{type:0,data:Ve(a.e.c+1)}],ae[2]=[{type:0,data:Ve(a.e.r+1)}],ae[3]=[{type:0,data:Ve(ke)}],ae[4]=[{type:0,data:Ve(a.e.r+1)}]}z.messages[0].data=Tt(ae);var Ie=Ba(P),He=Ma(Ie);R.content=He,R.size=R.content.length})()}te.data=Tt(ue)}G[3][0].data=Tt(ge)}y[4][0].data=Tt(G)}m.messages[0].data=Tt(y);var C=Ba(h),B=Ma(C);return d.content=B,d.size=d.content.length,l}function Af(e){return function(t){for(var a=0;a!=e.length;++a){var n=e[a];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function Io(e){Af([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ro(e){Af([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function U_(e){return be.WS.indexOf(e)>-1?"sheet":be.CS&&e==be.CS?"chart":be.DS&&e==be.DS?"dialog":be.MS&&e==be.MS?"macro":e&&e.length?e:"sheet"}function $_(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,U_(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function j_(e,r,t,a,n,i,s,o,c,l,f,u){try{i[a]=En(Zt(e,t,!0),r);var d=pt(e,r),h;switch(o){case"sheet":h=lw(d,r,n,c,i[a],l,f,u);break;case"chart":if(h=fw(d,r,n,c,i[a],l,f,u),!h||!h["!drawel"])break;var m=yn(h["!drawel"].Target,r),p=Nn(m),g=Kg(Zt(e,m,!0),En(Zt(e,p,!0),m)),v=yn(g,m),y=Nn(v);h=By(Zt(e,v,!0),v,c,En(Zt(e,y,!0),v),l,h);break;case"macro":h=uw(d,r,n,c,i[a],l,f,u);break;case"dialog":h=dw(d,r,n,c,i[a],l,f,u);break;default:throw new Error("Unrecognized sheet type "+o)}s[a]=h;var x=[];i&&i[a]&&nt(i[a]).forEach(function(O){var I="";if(i[a][O].Type==be.CMNT){I=yn(i[a][O].Target,r);var A=gw(pt(e,I,!0),I,c);if(!A||!A.length)return;hl(h,A,!1)}i[a][O].Type==be.TCMNT&&(I=yn(i[a][O].Target,r),x=x.concat(Zg(pt(e,I,!0),c)))}),x&&x.length&&hl(h,x,!0,c.people||[])}catch(O){if(c.WTF)throw O}}function ar(e){return e.charAt(0)=="/"?e.slice(1):e}function H_(e,r){if(Ja(),r=r||{},Io(r),or(e,"META-INF/manifest.xml")||or(e,"objectdata.xml"))return Sl(e,r);if(or(e,"Index/Document.iwa")){if(typeof Uint8Array=="undefined")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Is!="undefined"){if(e.FileIndex)return Is(e);var t=me.utils.cfb_new();return Nc(e).forEach(function(fe){Te(t,fe,zl(e,fe))}),Is(t)}throw new Error("Unsupported NUMBERS file")}if(!or(e,"[Content_Types].xml"))throw or(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):or(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Nc(e),n=zh(Zt(e,"[Content_Types].xml")),i=!1,s,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",pt(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!pt(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},l={};if(!r.bookSheets&&!r.bookProps){if(Sn=[],n.sst)try{Sn=mw(pt(e,ar(n.sst)),n.sst,r)}catch(fe){if(r.WTF)throw fe}r.cellStyles&&n.themes.length&&(c=pw(Zt(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],r)),n.style&&(l=hw(pt(e,ar(n.style)),n.style,c,r))}n.links.map(function(fe){try{var Z=En(Zt(e,Nn(ar(fe))),fe);return vw(pt(e,ar(fe)),Z,fe,r)}catch{}});var f=cw(pt(e,ar(n.workbooks[0])),n.workbooks[0],r),u={},d="";n.coreprops.length&&(d=pt(e,ar(n.coreprops[0]),!0),d&&(u=m0(d)),n.extprops.length!==0&&(d=pt(e,ar(n.extprops[0]),!0),d&&Qh(d,u,r)));var h={};(!r.bookSheets||r.bookProps)&&n.custprops.length!==0&&(d=Zt(e,ar(n.custprops[0]),!0),d&&(h=tp(d,r)));var m={};if((r.bookSheets||r.bookProps)&&(f.Sheets?s=f.Sheets.map(function(Z){return Z.name}):u.Worksheets&&u.SheetNames.length>0&&(s=u.SheetNames),r.bookProps&&(m.Props=u,m.Custprops=h),r.bookSheets&&typeof s!="undefined"&&(m.SheetNames=s),r.bookSheets?m.SheetNames:r.bookProps))return m;s={};var p={};r.bookDeps&&n.calcchain&&(p=xw(pt(e,ar(n.calcchain)),n.calcchain,r));var g=0,v={},y,x;{var O=f.Sheets;u.Worksheets=O.length,u.SheetNames=[];for(var I=0;I!=O.length;++I)u.SheetNames[I]=O[I].name}var A=i?"bin":"xml",k=n.workbooks[0].lastIndexOf("/"),D=(n.workbooks[0].slice(0,k+1)+"_rels/"+n.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");or(e,D)||(D="xl/_rels/workbook."+A+".rels");var N=En(Zt(e,D,!0),D.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(r.xlmeta=yw(pt(e,ar(n.metadata[0])),n.metadata[0],r)),(n.people||[]).length>=1&&(r.people=ex(pt(e,ar(n.people[0])),r)),N&&(N=$_(N,f.Sheets));var M=pt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=u.Worksheets;++g){var G="sheet";if(N&&N[g]?(y="xl/"+N[g][1].replace(/[\/]?xl\//,""),or(e,y)||(y=N[g][1]),or(e,y)||(y=D.replace(/_rels\/.*$/,"")+N[g][1]),G=N[g][2]):(y="xl/worksheets/sheet"+(g+1-M)+"."+A,y=y.replace(/sheet0\./,"sheet.")),x=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(u.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var L=!1,ee=0;ee!=r.sheets.length;++ee)typeof r.sheets[ee]=="number"&&r.sheets[ee]==g&&(L=1),typeof r.sheets[ee]=="string"&&r.sheets[ee].toLowerCase()==u.SheetNames[g].toLowerCase()&&(L=1);if(!L)continue e}}j_(e,y,x,u.SheetNames[g],g,v,s,G,r,f,c,l)}return m={Directory:n,Workbook:f,Props:u,Custprops:h,Deps:p,Sheets:s,SheetNames:u.SheetNames,Strings:Sn,Styles:l,Themes:c,SSF:Je(xe)},r&&r.bookFiles&&(e.files?(m.keys=a,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(fe,Z){fe=fe.replace(/^Root Entry[\/]/,""),m.keys.push(fe),m.files[fe]=e.FileIndex[Z]}))),r&&r.bookVBA&&(n.vba.length>0?m.vbaraw=pt(e,ar(n.vba[0]),!0):n.defaults&&n.defaults.bin===cx&&(m.vbaraw=pt(e,"xl/vbaProject.bin",!0))),m}function V_(e,r){var t=r||{},a="Workbook",n=me.find(e,a);try{if(a="/!DataSpaces/Version",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(ym(n.content),a="/!DataSpaces/DataSpaceMap",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=_m(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=km(n.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);Sm(n.content)}catch{}if(a="/EncryptionInfo",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=Tm(n.content);if(a="/EncryptedPackage",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile!="undefined")return decrypt_agile(o[1],n.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76!="undefined")return decrypt_std76(o[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function W_(e,r){return r.bookType=="ods"?Cf(e,r):r.bookType=="numbers"?M_(e,r):r.bookType=="xlsb"?G_(e,r):z_(e,r)}function G_(e,r){ja=1024,e&&!e.SSF&&(e.SSF=Je(xe)),e&&e.SSF&&(Ja(),Di(e.SSF),r.revssf=Bi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Tn?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",a=ef.indexOf(r.bookType)>-1,n=xo();Ro(r=r||{});var i=Zs(),s="",o=0;if(r.cellXfs=[],ia(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Te(i,s,g0(e.Props,r)),n.coreprops.push(s),We(r.rels,2,s,be.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Te(i,s,y0(e.Props,r)),n.extprops.push(s),We(r.rels,3,s,be.EXT_PROPS),e.Custprops!==e.Props&&nt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Te(i,s,w0(e.Custprops,r)),n.custprops.push(s),We(r.rels,4,s,be.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},u=e.Sheets[e.SheetNames[o-1]],d=(u||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,Te(i,s,_w(o-1,s,r,e,f)),n.sheets.push(s),We(r.wbrels,-1,"worksheets/sheet"+o+"."+t,be.WS[0])}if(u){var h=u["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+o+"."+t,Te(i,p,Sw(h,p,r)),n.comments.push(p),We(f,-1,"../comments"+o+"."+t,be.CMNT),m=!0),u["!legacy"]&&m&&Te(i,"xl/drawings/vmlDrawing"+o+".vml",Z0(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&Te(i,Nn(s),Va(f))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+t,Te(i,s,Ew(r.Strings,s,r)),n.strs.push(s),We(r.wbrels,-1,"sharedStrings."+t,be.SST)),s="xl/workbook."+t,Te(i,s,ww(e,s,r)),n.workbooks.push(s),We(r.rels,1,s,be.WB),s="xl/theme/theme1.xml",Te(i,s,Eo(e.Themes,r)),n.themes.push(s),We(r.wbrels,-1,"theme/theme1.xml",be.THEME),s="xl/styles."+t,Te(i,s,kw(e,s,r)),n.styles.push(s),We(r.wbrels,-1,"styles."+t,be.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",Te(i,s,e.vbaraw),n.vba.push(s),We(r.wbrels,-1,"vbaProject.bin",be.VBA)),s="xl/metadata."+t,Te(i,s,Tw(s)),n.metadata.push(s),We(r.wbrels,-1,"metadata."+t,be.XLMETA),Te(i,"[Content_Types].xml",h0(n,r)),Te(i,"_rels/.rels",Va(r.rels)),Te(i,"xl/_rels/workbook."+t+".rels",Va(r.wbrels)),delete r.revssf,delete r.ssf,i}function z_(e,r){ja=1024,e&&!e.SSF&&(e.SSF=Je(xe)),e&&e.SSF&&(Ja(),Di(e.SSF),r.revssf=Bi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Tn?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",a=ef.indexOf(r.bookType)>-1,n=xo();Ro(r=r||{});var i=Zs(),s="",o=0;if(r.cellXfs=[],ia(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Te(i,s,g0(e.Props,r)),n.coreprops.push(s),We(r.rels,2,s,be.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Te(i,s,y0(e.Props,r)),n.extprops.push(s),We(r.rels,3,s,be.EXT_PROPS),e.Custprops!==e.Props&&nt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Te(i,s,w0(e.Custprops,r)),n.custprops.push(s),We(r.rels,4,s,be.CUST_PROPS));var f=["SheetJ5"];for(r.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,Te(i,s,df(o-1,r,e,u)),n.sheets.push(s),We(r.wbrels,-1,"worksheets/sheet"+o+"."+t,be.WS[0])}if(d){var m=d["!comments"],p=!1,g="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+o+"."+t,Te(i,g,Qg(m,f,r)),n.threadedcomments.push(g),We(u,-1,"../threadedComments/threadedComment"+o+"."+t,be.TCMNT)),g="xl/comments"+o+"."+t,Te(i,g,Q0(m,r)),n.comments.push(g),We(u,-1,"../comments"+o+"."+t,be.CMNT),p=!0}d["!legacy"]&&p&&Te(i,"xl/drawings/vmlDrawing"+o+".vml",Z0(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Te(i,Nn(s),Va(u))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+t,Te(i,s,$0(r.Strings,r)),n.strs.push(s),We(r.wbrels,-1,"sharedStrings."+t,be.SST)),s="xl/workbook."+t,Te(i,s,xf(e,r)),n.workbooks.push(s),We(r.rels,1,s,be.WB),s="xl/theme/theme1.xml",Te(i,s,Eo(e.Themes,r)),n.themes.push(s),We(r.wbrels,-1,"theme/theme1.xml",be.THEME),s="xl/styles."+t,Te(i,s,Y0(e,r)),n.styles.push(s),We(r.wbrels,-1,"styles."+t,be.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",Te(i,s,e.vbaraw),n.vba.push(s),We(r.wbrels,-1,"vbaProject.bin",be.VBA)),s="xl/metadata."+t,Te(i,s,J0()),n.metadata.push(s),We(r.wbrels,-1,"metadata."+t,be.XLMETA),f.length>1&&(s="xl/persons/person.xml",Te(i,s,tx(f,r)),n.people.push(s),We(r.wbrels,-1,"persons/person.xml",be.PEOPLE)),Te(i,"[Content_Types].xml",h0(n,r)),Te(i,"_rels/.rels",Va(r.rels)),Te(i,"xl/_rels/workbook."+t+".rels",Va(r.wbrels)),delete r.revssf,delete r.ssf,i}function Po(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Qt(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function X_(e,r){return me.find(e,"EncryptedPackage")?V_(e,r):_f(e,r)}function Y_(e,r){var t,a=e,n=r||{};return n.type||(n.type=Ae&&Buffer.isBuffer(e)?"buffer":"base64"),t=Xl(a,n),H_(t,n)}function Of(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Hs(e.slice(t),r);default:break e}return Ya.to_workbook(e,r)}function q_(e,r){var t="",a=Po(e,r);switch(r.type){case"base64":t=Qt(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=va(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(t=ze(t)),r.type="binary",Of(t,r)}function K_(e,r){var t=e;return r.type=="base64"&&(t=Qt(t)),t=$e.utils.decode(1200,t.slice(2),"str"),r.type="binary",Of(t,r)}function J_(e){return e.match(/[^\x00-\x7F]/)?Tr(e):e}function Rs(e,r,t,a){return a?(t.type="string",Ya.to_workbook(e,t)):Ya.to_workbook(r,t)}function Ri(e,r){Xs();var t=r||{};if(typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer)return Ri(new Uint8Array(e),(t=Je(t),t.type="array",t));typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno!="undefined"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ga={},t.dateNF&&(Ga.dateNF=t.dateNF),t.type||(t.type=Ae&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Ae?"buffer":"binary",a=Gd(e),typeof Uint8Array!="undefined"&&!Ae&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,a=J_(e)),t.type=="array"&&typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!="undefined"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return t=Je(t),t.type="array",Ri(Ys(a),t)}switch((n=Po(a,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return X_(me.read(a,t),t);break;case 9:if(n[1]<=8)return _f(a,t);break;case 60:return Hs(a,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return rm(a,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return M0.to_workbook(a,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?Y_(a,t):Rs(e,a,t,i);case 239:return n[3]===60?Hs(a,t):Rs(e,a,t,i);case 255:if(n[1]===254)return K_(a,t);if(n[1]===0&&n[2]===2&&n[3]===0)return ma.to_workbook(a,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return ma.to_workbook(a,t);break;case 3:case 131:case 139:case 140:return js.to_workbook(a,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return G0.to_workbook(a,t);break;case 10:case 13:case 32:return q_(a,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tm.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?js.to_workbook(a,t):Rs(e,a,t,i)}function Ff(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Hn(r.file,me.write(e,{type:Ae?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return me.write(e,r)}function Z_(e,r){var t=Je(r||{}),a=W_(e,t);return Q_(a,t)}function Q_(e,r){var t={},a=Ae?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=a;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=a;break;default:throw new Error("Unrecognized type "+r.type)}var n=e.FullPaths?me.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno!="undefined"&&typeof n=="string"){if(r.type=="binary"||r.type=="base64")return n;n=new Uint8Array(Ni(n))}return r.password&&typeof encrypt_agile!="undefined"?Ff(encrypt_agile(n,r.password),r):r.type==="file"?Hn(r.file,n):r.type=="string"?ze(n):n}function ek(e,r){var t=r||{},a=Jw(e,t);return Ff(a,t)}function Sr(e,r,t){t||(t="");var a=t+e;switch(r.type){case"base64":return On(Tr(a));case"binary":return Tr(a);case"string":return e;case"file":return Hn(r.file,a,"utf8");case"buffer":return Ae?$r(a,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(a):Sr(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function tk(e,r){switch(r.type){case"base64":return On(e);case"binary":return e;case"string":return e;case"file":return Hn(r.file,e,"binary");case"buffer":return Ae?$r(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function wi(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",a=0;a<e.length;++a)t+=String.fromCharCode(e[a]);return r.type=="base64"?On(t):r.type=="string"?ze(t):t;case"file":return Hn(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function No(e,r){Xs(),Xy(e);var t=Je(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var a=No(e,t);return t.type="array",Ni(a)}var n=0;if(t.sheet&&(typeof t.sheet=="number"?n=t.sheet:n=e.SheetNames.indexOf(t.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Sr(Ww(e,t),t);case"slk":case"sylk":return Sr(B0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"htm":case"html":return Sr(Ef(e.Sheets[e.SheetNames[n]],t),t);case"txt":return tk(If(e.Sheets[e.SheetNames[n]],t),t);case"csv":return Sr(Do(e.Sheets[e.SheetNames[n]],t),t,"\uFEFF");case"dif":return Sr(M0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"dbf":return wi(js.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"prn":return Sr(Ya.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"rtf":return Sr(G0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"eth":return Sr(U0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"fods":return Sr(Cf(e,t),t);case"wk1":return wi(ma.sheet_to_wk1(e.Sheets[e.SheetNames[n]],t),t);case"wk3":return wi(ma.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),wi(kf(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),ek(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Z_(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function rk(e,r,t,a,n,i,s,o){var c=lt(t),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,d=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!s||e[t])for(var h=r.s.c;h<=r.e.c;++h){var m=s?e[t][h]:e[a[h]+c];if(m===void 0||m.t===void 0){if(l===void 0)continue;i[h]!=null&&(d[i[h]]=l);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[h]!=null){if(p==null)if(m.t=="e"&&p===null)d[i[h]]=null;else if(l!==void 0)d[i[h]]=l;else if(f&&p===null)d[i[h]]=null;else continue;else d[i[h]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:Ur(m,p,o);p!=null&&(u=!1)}}return{row:d,isempty:u}}function Pi(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},a=0,n=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof f){case"string":c=Be(f);break;case"number":c=Be(e["!ref"]),c.s.r=f;break;default:c=f}a>0&&(n=0);var u=lt(c.s.r),d=[],h=[],m=0,p=0,g=Array.isArray(e),v=c.s.r,y=0,x={};g&&!e[v]&&(e[v]=[]);var O=l.skipHidden&&e["!cols"]||[],I=l.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(O[y]||{}).hidden)switch(d[y]=Qe(y),t=g?e[v][y]:e[d[y]+u],a){case 1:i[y]=y-c.s.c;break;case 2:i[y]=d[y];break;case 3:i[y]=l.header[y-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=Ur(t,null,l),p=x[s]||0,!p)x[s]=1;else{do o=s+"_"+p++;while(x[o]);x[s]=p,x[o]=1}i[y]=o}for(v=c.s.r+n;v<=c.e.r;++v)if(!(I[v]||{}).hidden){var A=rk(e,c,v,d,a,i,g,l);(A.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(h[m++]=A.row)}return h.length=m,h}var Ol=/"/g;function ak(e,r,t,a,n,i,s,o){for(var c=!0,l=[],f="",u=lt(t),d=r.s.c;d<=r.e.c;++d)if(a[d]){var h=o.dense?(e[t]||[])[d]:e[a[d]+u];if(h==null)f="";else if(h.v!=null){c=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:Ur(h,null,o));for(var m=0,p=0;m!==f.length;++m)if((p=f.charCodeAt(m))===n||p===i||p===34||o.forceQuotes){f='"'+f.replace(Ol,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(c=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(Ol,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(s)}function Do(e,r){var t=[],a=r==null?{}:r;if(e==null||e["!ref"]==null)return"";var n=Be(e["!ref"]),i=a.FS!==void 0?a.FS:",",s=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),f="",u=[];a.dense=Array.isArray(e);for(var d=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(d[m]||{}).hidden||(u[m]=Qe(m));for(var p=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||(f=ak(e,n,g,u,s,c,i,a),f!=null&&(a.strip&&(f=f.replace(l,"")),(f||a.blankrows!==!1)&&t.push((p++?o:"")+f)));return delete a.dense,t.join("")}function If(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Do(e,r);if(typeof $e=="undefined"||r.type=="string")return t;var a=$e.utils.encode(1200,t,"str");return"\xFF\xFE"+a}function nk(e){var r="",t,a="";if(e==null||e["!ref"]==null)return[];var n=Be(e["!ref"]),i="",s=[],o,c=[],l=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)s[o]=Qe(o);for(var f=n.s.r;f<=n.e.r;++f)for(i=lt(f),o=n.s.c;o<=n.e.c;++o)if(r=s[o]+i,t=l?(e[f]||[])[o]:e[r],a="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;a=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}c[c.length]=r+"="+a}return c}function Rf(e,r,t){var a=t||{},n=+!a.skipHeader,i=e||{},s=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?et(a.origin):a.origin;s=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:s+r.length-1+n}};if(i["!ref"]){var u=Be(i["!ref"]);f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),s==-1&&(s=u.e.r+1,f.e.r=s+r.length-1+n)}else s==-1&&(s=0,f.e.r=r.length-1+n);var d=a.header||[],h=0;r.forEach(function(p,g){nt(p).forEach(function(v){(h=d.indexOf(v))==-1&&(d[h=d.length]=v);var y=p[v],x="z",O="",I=ve({c:o+h,r:s+g+n});l=jn(i,I),y&&typeof y=="object"&&!(y instanceof Date)?i[I]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",a.cellDates||(x="n",y=yt(y)),O=a.dateNF||xe[14]):y===null&&a.nullError&&(x="e",y=0),l?(l.t=x,l.v=y,delete l.w,delete l.R,O&&(l.z=O)):i[I]=l={t:x,v:y},O&&(l.z=O))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var m=lt(s);if(n)for(h=0;h<d.length;++h)i[Qe(h+o)+m]={t:"s",v:d[h]};return i["!ref"]=Ee(f),i}function ik(e,r){return Rf(null,e,r)}function jn(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var a=et(r);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?jn(e,ve(r)):jn(e,ve({r,c:t||0}))}function sk(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Lo(){return{SheetNames:[],Sheets:{}}}function Bo(e,r,t,a){var n=1;if(!t)for(;n<=65535&&e.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var s=i&&i[1]||t;for(++n;n<=65535&&e.SheetNames.indexOf(t=s+n)!=-1;++n);}if(gf(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function ok(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=sk(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[a].Hidden=t}function ck(e,r){return e.z=r,e}function Pf(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function lk(e,r,t){return Pf(e,"#"+r,t)}function fk(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function uk(e,r,t,a){for(var n=typeof r!="string"?r:Be(r),i=typeof r=="string"?r:Ee(r),s=n.s.r;s<=n.e.r;++s)for(var o=n.s.c;o<=n.e.c;++o){var c=jn(e,s,o);c.t="n",c.F=i,delete c.v,s==n.s.r&&o==n.s.c&&(c.f=t,a&&(c.D=!0))}return e}var Vr={encode_col:Qe,encode_row:lt,encode_cell:ve,encode_range:Ee,decode_col:fo,decode_row:lo,split_cell:Eh,decode_cell:et,decode_range:Xt,format_cell:Ur,sheet_add_aoa:s0,sheet_add_json:Rf,sheet_add_dom:Sf,aoa_to_sheet:Qa,json_to_sheet:ik,table_to_sheet:Tf,table_to_book:y_,sheet_to_csv:Do,sheet_to_txt:If,sheet_to_json:Pi,sheet_to_html:Ef,sheet_to_formulae:nk,sheet_to_row_object_array:Pi,sheet_get_cell:jn,book_new:Lo,book_append_sheet:Bo,book_set_sheet_visibility:ok,cell_set_number_format:ck,cell_set_hyperlink:Pf,cell_set_internal_link:lk,cell_add_comment:fk,sheet_set_array_formula:uk,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var lS=An.version;var Df=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
        <path
            d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
        />
    </svg>
`.trim(),Lf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <rect width="7" height="7" x="3" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="14" rx="1" />
        <rect width="7" height="7" x="3" y="14" rx="1" />
    </svg>
`.trim(),Bf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="1"/>
        <circle cx="12" cy="5" r="1"/>
        <circle cx="12" cy="19" r="1"/>
    </svg>
`.trim(),Mo=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M12 3v18"/>
        <rect width="18" height="18" x="3" y="3" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
    </svg>
`.trim(),Mf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
    </svg>
`.trim(),Uf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
        <path d="M8 7h6"/>
        <path d="M8 11h8"/>
    </svg>
`.trim(),dk={config:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3" />
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.82 2.82l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.82-2.82l.06-.06A1.65 1.65 0 0 0 3 15a1.65 1.65 0 0 0-1.51-1H1a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 3 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.82-2.82l.06.06A1.65 1.65 0 0 0 9 3.6a1.65 1.65 0 0 0 1-1.51V2a2 2 0 0 1 4 0v.09A1.65 1.65 0 0 0 15 3.6a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.82 2.82l-.06.06A1.65 1.65 0 0 0 21 9c0 .3.09.58.24.82.17.28.43.51.76.68.21.1.44.18.68.19H23a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z" />
        </svg>
    `,import:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 3v14" />
            <path d="m7 13 5 5 5-5" />
            <path d="M5 21h14" />
        </svg>
    `,headcount:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
            <circle cx="9" cy="7" r="4" />
            <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
    `,validate:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 6 9 17l-5-5" />
        </svg>
    `,review:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 12h3l2-5 4 10 2-5h5" />
        </svg>
    `,journal:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 7c-3-1-6-1-9 0v12c3-1 6-1 9 0 3-1 6-1 9 0V7c-3-1-6-1-9 0Z" />
            <path d="M12 7v12" />
        </svg>
    `,archive:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="4" rx="1" />
            <path d="M5 7v11a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7" />
            <path d="M10 12h4" />
        </svg>
    `};function $f(e){return e&&dk[e]||""}var Uo=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0" />
    </svg>
`.trim(),$o=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0v4" />
        <path d="M12 15v2" />
    </svg>
`.trim(),Wi=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M5 12l4 4 10-10" />
    </svg>
`.trim(),jf=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="4" y="3" width="16" height="18" rx="2" />
        <rect x="8" y="7" width="8" height="3" />
        <path d="M8 14h.01" />
        <path d="M12 14h.01" />
        <path d="M16 14h.01" />
        <path d="M8 17h.01" />
        <path d="M12 17h.01" />
        <path d="M16 17h.01" />
    </svg>
`.trim(),fS=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 5.5 20.5 8 16 12.5 13.5 10 18 5.5Z" />
        <path d="m12 11 6-6" />
        <path d="M3 22 12 13" />
        <path d="m3 18 4 4" />
        <path d="m11 11 3 3" />
    </svg>
`.trim(),hk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 1 0 7.07 7.07l1.71-1.71" />
    </svg>
`.trim(),Hf=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M7 10l5 5 5-5" />
        <path d="M12 15V3" />
    </svg>
`.trim(),jo=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M17 8l-5-5-5 5" />
        <path d="M12 3v12" />
    </svg>
`.trim(),pk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10" />
        <path d="m15 9-6 6" />
        <path d="m9 9 6 6" />
    </svg>
`.trim(),Gi=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 19-7-7 7-7" />
        <path d="M19 12H5" />
    </svg>
`.trim(),Vf=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" />
        <path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7" />
        <path d="M7 3v4a1 1 0 0 0 1 1h7" />
    </svg>
`.trim(),zi=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 5 7 7-7 7" />
        <path d="M5 12h14" />
    </svg>
`.trim(),uS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m9 12 2 2 4-4"/>
    </svg>
`.trim(),dS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" x2="12" y1="8" y2="12"/>
        <line x1="12" x2="12.01" y1="16" y2="16"/>
    </svg>
`.trim(),hS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/>
        <path d="M12 9v4"/>
        <path d="M12 17h.01"/>
    </svg>
`.trim(),pS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 16v-4"/>
        <path d="M12 8h.01"/>
    </svg>
`.trim(),mS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M21.801 10A10 10 0 1 1 17 3.335"/>
        <path d="m9 11 3 3L22 4"/>
    </svg>
`.trim(),gS=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m15 9-6 6"/>
        <path d="m9 9 6 6"/>
    </svg>
`.trim(),xS=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m18 9-6-6-6 6"/>
        <path d="M12 3v14"/>
        <path d="M5 21h14"/>
    </svg>
`.trim(),vS=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m6 15 6 6 6-6"/>
        <path d="M12 21V7"/>
        <path d="M5 3h14"/>
    </svg>
`.trim(),Xi=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
        <path d="M21 3v5h-5"/>
        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
        <path d="M3 21v-5h5"/>
    </svg>
`.trim(),mk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 6h18"/>
        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
        <line x1="10" x2="10" y1="11" y2="17"/>
        <line x1="14" x2="14" y1="11" y2="17"/>
    </svg>
`.trim(),Ho=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 6 6 18"/>
        <path d="m6 6 12 12"/>
    </svg>
`.trim(),Wf=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
        <circle cx="12" cy="12" r="3"/>
    </svg>
`.trim(),Gf=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>
        <path d="M14 2v4a2 2 0 0 0 2 2h4"/>
        <path d="M10 9H8"/>
        <path d="M16 13H8"/>
        <path d="M16 17H8"/>
    </svg>
`.trim(),yS=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/>
        <path d="M2 12h20"/>
    </svg>
`.trim(),wS=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="3" width="18" height="18" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
        <path d="M9 3v18"/>
        <path d="M15 3v18"/>
    </svg>
`.trim(),_S=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
        <path d="M12 11h4"/>
        <path d="M12 16h4"/>
        <path d="M8 11h.01"/>
        <path d="M8 16h.01"/>
    </svg>
`.trim();function qn(e){return e==null?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function dr(e,r){return`
        <div class="pf-labeled-btn">
            ${e}
            <span class="pf-btn-label">${r}</span>
        </div>
    `}function tn({textareaId:e,value:r,permanentId:t,isPermanent:a,hintId:n,saveButtonId:i,isSaved:s=!1,placeholder:o="Enter notes here..."}){let c=a?$o:Uo,l=i?`<button type="button" class="pf-action-toggle pf-save-btn ${s?"is-saved":""}" id="${i}" data-save-input="${e}" title="Save notes">${Vf}</button>`:"",f=t?`<button type="button" class="pf-action-toggle pf-notes-lock ${a?"is-locked":""}" id="${t}" aria-pressed="${a}" title="Lock notes (retain after archive)">${c}</button>`:"";return`
        <article class="pf-step-card pf-step-detail pf-notes-card">
            <div class="pf-notes-header">
                <div>
                    <h3 class="pf-notes-title">Notes</h3>
                    <p class="pf-notes-subtext">Leave notes your future self will appreciate. Notes clear after archiving. Click lock to retain permanently.</p>
                </div>
            </div>
            <div class="pf-notes-body">
                <textarea id="${e}" rows="6" placeholder="${qn(o)}">${qn(r||"")}</textarea>
                ${n?`<p class="pf-signoff-hint" id="${n}"></p>`:""}
            </div>
            <div class="pf-notes-action">
                ${t?dr(f,"Lock"):""}
                ${i?dr(l,"Save"):""}
            </div>
        </article>
    `}function rn({reviewerInputId:e,reviewerValue:r,signoffInputId:t,signoffValue:a,isComplete:n,saveButtonId:i,isSaved:s=!1,completeButtonId:o,subtext:c="Sign-off below. Click checkmark icon. Done.",prevButtonId:l=null,nextButtonId:f=null}){let u=l||`${o}-prev`,d=f||`${o}-next`,h=`<button type="button" class="pf-action-toggle ${n?"is-active":""}" id="${o}" aria-pressed="${!!n}" title="Mark step complete">${Wi}</button>`,m=`<button type="button" class="pf-action-toggle pf-nav-toggle" id="${u}" title="Previous step">${Gi}</button>`,p=`<button type="button" class="pf-action-toggle pf-nav-toggle" id="${d}" title="Next step">${zi}</button>`;return`
        <article class="pf-step-card pf-step-detail pf-config-card">
            <div class="pf-config-head pf-notes-header">
                <div>
                    <h3>Sign-off</h3>
                    <p class="pf-config-subtext">${qn(c)}</p>
                </div>
            </div>
            <div class="pf-config-grid">
                <label class="pf-config-field">
                    <span>Reviewer Name</span>
                    <input type="text" id="${e}" value="${qn(r)}" placeholder="Full name">
                </label>
                <label class="pf-config-field">
                    <span>Sign-off Date</span>
                    <input type="date" id="${t}" value="${qn(a)}" readonly>
                </label>
            </div>
            <div class="pf-signoff-action">
                ${m?dr(m,"Prev"):""}
                ${dr(h,"Done")}
                ${p?dr(p,"Next"):""}
            </div>
        </article>
    `}function Vo(e,r){e&&(e.classList.toggle("is-locked",r),e.setAttribute("aria-pressed",String(r)),e.innerHTML=r?$o:Uo)}function Wr(e,r){e&&e.classList.toggle("is-saved",r)}function Wo(e=document){let r=e.querySelectorAll(".pf-save-btn[data-save-input]"),t=[];return r.forEach(a=>{let n=a.getAttribute("data-save-input"),i=document.getElementById(n);if(!i)return;let s=()=>{Wr(a,!1)};i.addEventListener("input",s),t.push(()=>i.removeEventListener("input",s))}),()=>t.forEach(a=>a())}function zf(e,r){if(e===0)return{canComplete:!0,blockedBy:null,message:""};for(let t=0;t<e;t++)if(!r[t])return{canComplete:!1,blockedBy:t,message:`Complete Step ${t} before signing off on this step.`};return{canComplete:!0,blockedBy:null,message:""}}function Xf(e){let r=document.querySelector(".pf-workflow-toast");r&&r.remove();let t=document.createElement("div");t.className="pf-workflow-toast pf-workflow-toast--warning",t.innerHTML=`
        <span class="pf-workflow-toast-icon">\u26A0\uFE0F</span>
        <span class="pf-workflow-toast-message">${e}</span>
    `,document.body.appendChild(t),requestAnimationFrame(()=>{t.classList.add("pf-workflow-toast--visible")}),setTimeout(()=>{t.classList.remove("pf-workflow-toast--visible"),setTimeout(()=>t.remove(),300)},4e3)}var Go={fillColor:"#000000",fontColor:"#FFFFFF",bold:!0};function Kn(e){e.format.fill.color=Go.fillColor,e.format.font.color=Go.fontColor,e.format.font.bold=Go.bold}var Yi={currency:"$#,##0.00",currencyNegative:"$#,##0.00;[Red]($#,##0.00)",number:"#,##0.00",integer:"#,##0",percent:"0.00%",date:"yyyy-mm-dd",dateShort:"mm/dd/yyyy",text:"@"},sa={narrow:10,standard:15,wide:20,extraWide:30,description:40};function qi(e,r){!e||!r||r.length===0||(e["!cols"]=r.map(t=>({wch:t})))}function Yf(e,r,t){if(!(!e||!t||r<=1))for(let a=1;a<r;a++)for(let[n,i]of Object.entries(t)){let s=parseInt(n,10),o=Vr.encode_cell({r:a,c:s});e[o]&&(e[o].z=i)}}function gk(e,r,t){if(!e||!r||t<=1)return{};let a={};return r.forEach((n,i)=>{let s=String(n||"").toLowerCase().trim(),o=null;s.includes("amount")||s.includes("total")||s.includes("liability")||s.includes("pay")||s.includes("wage")||s.includes("salary")||s.includes("rate")&&!s.includes("accrual rate")||s.includes("debit")||s.includes("credit")||s.includes("change")||s.includes("fixed")||s.includes("variable")||s.includes("burden")||s.includes("gross")?o=Yi.currency:s.includes("date")||s.includes("period")?o=Yi.dateShort:s.includes("percent")||s.includes("rate")&&s.includes("burden")||s==="% of total"?o=Yi.percent:(s.includes("count")||s.includes("headcount")||s==="id"||s.includes("employee_id"))&&(o=Yi.integer),o&&(a[i]=o)}),Yf(e,t,a),a}function xk(e){return!e||e.length===0?[]:e.map(r=>{let t=String(r||"").toLowerCase().trim(),a=r.length;return t.includes("description")||t.includes("note")||t.includes("name")&&t.includes("account")?sa.description:t.includes("name")||t.includes("department")?sa.extraWide:a>12?sa.wide:a<8?sa.narrow:sa.standard})}function qf(e,r,t,a={}){if(!e||!r||r.length===0)return;let{columnFormats:n={},columnWidths:i=null,autoFormat:s=!0,autoSize:o=!0}=a;if(r.length,s&&gk(e,r,t),n&&Object.keys(n).length>0&&Yf(e,t,n),i)qi(e,i);else if(o){let c=xk(r);qi(e,c)}}var vk="d828f6f",zr="pto-accrual";var Ra="PTO Accrual";window.PRAIRIE_FORGE_CONTEXT={module:zr,step:null,moduleName:Ra,companyId:null};var Qo="https://jgciqwzwacaesqjaoadc.supabase.co",nn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE";function De(e,r="info",t=4e3){document.querySelectorAll(".pf-toast").forEach(n=>n.remove());let a=document.createElement("div");if(a.className=`pf-toast pf-toast--${r}`,a.innerHTML=`
        <div class="pf-toast-content">
            <span class="pf-toast-icon">${r==="success"?"\u2705":r==="error"?"\u274C":"\u2139\uFE0F"}</span>
            <span class="pf-toast-message">${e.replace(/\n/g,"<br>")}</span>
        </div>
        <button class="pf-toast-close" onclick="this.parentElement.remove()">\xD7</button>
    `,!document.getElementById("pf-toast-styles")){let n=document.createElement("style");n.id="pf-toast-styles",n.textContent=`
            .pf-toast {
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #1a1a2e;
                color: white;
                padding: 16px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 90%;
                display: flex;
                align-items: flex-start;
                gap: 12px;
                animation: toastIn 0.3s ease;
            }
            .pf-toast--success { border-left: 4px solid #22c55e; }
            .pf-toast--error { border-left: 4px solid #ef4444; }
            .pf-toast--info { border-left: 4px solid #3b82f6; }
            .pf-toast-content { display: flex; align-items: flex-start; gap: 8px; flex: 1; }
            .pf-toast-icon { font-size: 18px; }
            .pf-toast-message { font-size: 14px; line-height: 1.4; }
            .pf-toast-close { background: none; border: none; color: #888; font-size: 20px; cursor: pointer; padding: 0; margin-left: 8px; }
            .pf-toast-close:hover { color: white; }
            @keyframes toastIn { from { opacity: 0; transform: translateX(-50%) translateY(-20px); } }
        `,document.head.appendChild(n)}return document.body.appendChild(a),t>0&&setTimeout(()=>a.remove(),t),a}var yk="Calculate your PTO liability, compare against last period, and generate a balanced journal entry\u2014all without leaving Excel.",wk="../module-selector/index.html",_k="pf-loader-overlay",ca=["SS_PF_Config"],we={payrollProvider:"PTO_Payroll_Provider",payrollDate:"PTO_Analysis_Date",accountingPeriod:"PTO_Accounting_Period",journalEntryId:"PTO_Journal_Entry_ID",companyName:"SS_Company_Name",accountingSoftware:"SS_Accounting_Software",reviewerName:"PTO_Reviewer",validationDataBalance:"PTO_Validation_Data_Balance",validationCleanBalance:"PTO_Validation_Clean_Balance",validationDifference:"PTO_Validation_Difference",headcountRosterCount:"PTO_Headcount_Roster_Count",headcountPayrollCount:"PTO_Headcount_Payroll_Count",headcountDifference:"PTO_Headcount_Difference",journalDebitTotal:"PTO_JE_Debit_Total",journalCreditTotal:"PTO_JE_Credit_Total",journalDifference:"PTO_JE_Difference"},Fa="User opted to skip the headcount review this period.",ts={0:{note:"PTO_Notes_Config",reviewer:"PTO_Reviewer_Config",signOff:"PTO_SignOff_Config"},1:{note:"PTO_Notes_Upload",reviewer:"PTO_Reviewer_Upload",signOff:"PTO_SignOff_Upload"},2:{note:"PTO_Notes_Review",reviewer:"PTO_Reviewer_Review",signOff:"PTO_SignOff_Review"},3:{note:"PTO_Notes_JE",reviewer:"PTO_Reviewer_JE",signOff:"PTO_SignOff_JE"},4:{note:"PTO_Notes_Archive",reviewer:"PTO_Reviewer_Archive",signOff:"PTO_SignOff_Archive"}},du={0:"PTO_Complete_Config",1:"PTO_Complete_Upload",2:"PTO_Complete_Review",3:"PTO_Complete_JE",4:"PTO_Complete_Archive"};var er=[{id:0,title:"Configuration",summary:"Auto-loaded from system. Review period-specific settings before each run.",description:"Configuration is loaded from your installation. Only period-specific fields (analysis date, accounting period) need review each run.",actionLabel:"Review Configuration",icon:"\u{1F9ED}",secondaryAction:{sheet:"SS_PF_Config",label:"Open Config Sheet"}},{id:1,title:"Upload & Validate PTO Data",summary:"Import PTO report, normalize headers, and run validation checks.",description:"Upload your Obsidian PTO report, auto-map headers using ada_payroll_dimensions, create PTO_Data_Clean, and review advisory validation checks.",actionLabel:"Upload PTO Report",icon:"\u{1F4E5}",secondaryAction:{sheet:"PTO_Data_Clean",label:"Open Clean Data"}},{id:2,title:"PTO Accrual Review",summary:"Review accrued, used, and balance metrics with executive-ready summary.",description:"Analyze PTO data grouped by employee and plan. Review totals, trends, and variances using PTO_Data_Clean as the source of truth.",actionLabel:"Generate Review",icon:"\u{1F4CA}",secondaryAction:{sheet:"PTO_Review",label:"Open Review Sheet"}},{id:3,title:"Journal Entry Prep",summary:"Generate accounting-ready journal entry output.",description:"Create journal entry draft using PTO_Data_Clean and GL mappings. Produces output ready for QuickBooks or your accounting system.",actionLabel:"Generate JE Draft",icon:"\u{1F9FE}",secondaryAction:{sheet:"PTO_JE_Draft",label:"Open JE Draft"}},{id:4,title:"Archive & Clear",summary:"Archive the period and reset for next run.",description:"Save a snapshot of this period's work, then clear working tabs to prepare for the next PTO analysis cycle.",actionLabel:"Archive Period",icon:"\u{1F5C2}\uFE0F",secondaryAction:{sheet:"PTO_Archive_Summary",label:"Open Archive"}}],kk={0:"PTO_Homepage",1:"PTO_Data_Clean",2:"PTO_Review",3:"PTO_JE_Draft",4:"PTO_Archive_Summary"};function Ko(e){if(typeof e=="number")return e;if(!e)return 0;let r=String(e).replace(/[$,]/g,"").trim(),t=parseFloat(r);return isNaN(t)?0:t}var Ek=er.reduce((e,r)=>(e[r.id]="pending",e),{}),it={activeView:"home",activeStepId:null,focusedIndex:0,stepStatuses:Ek},Ce={loaded:!1,steps:{},permanents:{},completes:{},values:{},overrides:{accountingPeriod:!1,journalId:!1}},Zn=null,zo=null,Ki=null,an=new Map,Ne={skipAnalysis:!1,loading:!1,hasAnalyzed:!1,lastError:null,rosterCount:0,ptoCount:0,missingFromPto:[],extraInPto:[],roster:{rosterCount:null,payrollCount:null,difference:null,mismatches:[]}},Ze={debitTotal:null,creditTotal:null,difference:null,lineAmountSum:null,analysisChangeTotal:null,jeChangeTotal:null,loading:!1,lastError:null,validationRun:!1,issues:[]},ut={hasRun:!1,loading:!1,acknowledged:!1,balanceIssues:[],zeroBalances:[],accrualOutliers:[],totalIssues:0,totalEmployees:0,expandedSections:new Set},Ia={cleanDataReady:!1,employeeCount:0,lastRun:null,loading:!1,lastError:null,missingPayRates:[],missingDepartments:[],ignoredMissingPayRates:new Set,completenessCheck:{accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null}},Xe={loaded:!1,loading:!1,lastRun:null,totalCurrentLiability:0,totalPriorLiability:0,netChange:0,employeeCount:0,reconciliation:{reportLiabilityTotal:0,calcLiabilityTotal:0,negativeBalanceTotal:0,negativeBalanceCount:0,positiveBalanceCount:0,zeroBalanceCount:0,missingRateCount:0},coverage:{rosterCount:0,ptoReportCount:0,inBothCount:0,inPtoOnlyCount:0,inPtoOnlyNames:[],inPtoOnlyLiability:0,inRosterOnlyCount:0,inRosterOnlyNames:[]},reviewData:[],flagThresholds:{largeMove:500}},Fe={loaded:!1,loading:!1,error:null,crm_company_id:null,ss_company_name:null,pto_payroll_provider:null,ss_accounting_software:null,isValid:!1,validationErrors:[]};async function Sk(){console.log("[PTO] Loading installation configuration from SS_PF_Config..."),Fe.loading=!0,Fe.error=null,Fe.validationErrors=[];try{if(!xt())throw new Error("Excel runtime not available.");let e=await ii(["SS_PF_Config"]);console.log("[PTO] Config values loaded:",e),Fe.crm_company_id=(e==null?void 0:e.SS_Company_ID)||null,Fe.ss_company_name=(e==null?void 0:e.SS_Company_Name)||null,Fe.pto_payroll_provider=(e==null?void 0:e.PTO_Payroll_Provider)||null,Fe.ss_accounting_software=(e==null?void 0:e.SS_Accounting_Software)||null,Tk(),Fe.loaded=!0,Fe.loading=!1,console.log("[PTO] Installation config loaded successfully:",{crm_company_id:Fe.crm_company_id,company_name:Fe.ss_company_name,provider:Fe.pto_payroll_provider,isValid:Fe.isValid})}catch(e){console.error("[PTO] Failed to load installation:",e),Fe.error=e.message,Fe.loading=!1,Fe.loaded=!0,Fe.isValid=!1,Fe.validationErrors.push(e.message)}}function Tk(){Fe.validationErrors=[],Fe.crm_company_id||Fe.validationErrors.push("Company ID is not configured. Please open Module Selector to sync your configuration."),Fe.isValid=Fe.validationErrors.length===0,Fe.isValid||console.error("[PTO] Installation validation failed:",Fe.validationErrors)}async function bk(){if(xt())try{await Excel.run(async e=>{let r=e.workbook.worksheets;r.load("items/name"),await e.sync();let t=r.getItemOrNullObject("SS_PF_Config");if(t.load("isNullObject"),await e.sync(),t.isNullObject){console.log("[PTO] Creating SS_PF_Config sheet..."),t=r.add("SS_PF_Config");let a=["Category","Field","Value","Permanent"],n=t.getRange("A1:D1");n.values=[a],Kn(n);let i=[["module-prefix","PR_","payroll-recorder","Y"],["module-prefix","PTO_","pto-accrual","Y"],["module-prefix","SS_","system","Y"],["Run Settings","SS_Company_Name","","Y"],["Run Settings","SS_Company_ID","","Y"]],s=t.getRange(`A2:D${1+i.length}`);s.values=i,await e.sync();let o=t.getRange(`A1:D${1+i.length}`),c=t.tables.add(o,!0);c.name="SS_PF_Config",c.style="TableStyleMedium2",o.format.autofitColumns(),await e.sync(),console.log("[PTO] SS_PF_Config sheet and table created")}else{let a=e.workbook.tables;if(a.load("items/name"),await e.sync(),!a.items.some(i=>i.name==="SS_PF_Config")){console.log("[PTO] SS_PF_Config sheet exists but no table - creating table...");let i=t.getUsedRangeOrNullObject();if(i.load("address,rowCount"),await e.sync(),!i.isNullObject&&i.rowCount>0){let s=t.tables.add(i,!0);s.name="SS_PF_Config",s.style="TableStyleMedium2",await e.sync(),console.log("[PTO] SS_PF_Config table created from existing data")}else{let s=["Category","Field","Value","Permanent"],o=t.getRange("A1:D1");o.values=[s],o.format.font.bold=!0;let c=[["module-prefix","PR_","payroll-recorder","Y"],["module-prefix","PTO_","pto-accrual","Y"],["module-prefix","SS_","system","Y"],["Run Settings","SS_Company_Name","","Y"],["Run Settings","SS_Company_ID","","Y"]],l=t.getRange(`A2:D${1+c.length}`);l.values=c,await e.sync();let f=t.getRange(`A1:D${1+c.length}`),u=t.tables.add(f,!0);u.name="SS_PF_Config",u.style="TableStyleMedium2",f.format.autofitColumns(),await e.sync(),console.log("[PTO] SS_PF_Config table created with default data")}}}})}catch(e){console.error("[PTO] Error ensuring config sheet:",e)}}async function Ck(){var e;try{Zn=document.getElementById("app"),zo=document.getElementById("loading"),window.PRAIRIE_FORGE_CONTEXT.step=null,window.PRAIRIE_FORGE_CONTEXT.stepName="Homepage",await bk(),await Sk(),window.PRAIRIE_FORGE_CONTEXT.companyId=Fe.crm_company_id||null,Fe.isValid||(console.warn("[PTO] Installation config incomplete:",Fe.validationErrors),console.warn("[PTO] Continuing anyway - some features may be limited")),await Ok(),await hu(),(e=window.PrairieForge)!=null&&e.loadSharedConfig&&await window.PrairieForge.loadSharedConfig();let r=hn(zr);await dn(r.sheetName,r.title,r.subtitle),await Ak(),zo&&zo.remove(),Zn&&(Zn.hidden=!1),wt()}catch(r){throw console.error("[PTO] Module initialization failed:",r),r}}async function Ak(){console.log("[PTO] Worksheet change listener disabled (one-way sync mode)")}async function Ok(){try{await si(zr),console.log(`[PTO] Tab visibility applied for ${zr}`)}catch(e){console.warn("[PTO] Could not apply tab visibility:",e)}}async function hu(){var e;if(!xt()){Ce.loaded=!0;return}try{let r=await ii(ca),t={};(e=window.PrairieForge)!=null&&e.loadSharedConfig&&(await window.PrairieForge.loadSharedConfig(),window.PrairieForge._sharedConfigCache&&window.PrairieForge._sharedConfigCache.forEach((i,s)=>{t[s]=i}));let a={...r},n={SS_Default_Reviewer:we.reviewerName,Default_Reviewer:we.reviewerName,PTO_Reviewer:we.reviewerName,SS_Company_Name:we.companyName,Company_Name:we.companyName,SS_Payroll_Provider:we.payrollProvider,Payroll_Provider_Link:we.payrollProvider,SS_Accounting_Software:we.accountingSoftware,Accounting_Software_Link:we.accountingSoftware};Object.entries(n).forEach(([i,s])=>{t[i]&&!a[s]&&(a[s]=t[i])}),Object.entries(t).forEach(([i,s])=>{i.startsWith("PTO_")&&s&&(a[i]=s)}),Ce.permanents=await Fk(),Ce.values=a||{},Ce.overrides.accountingPeriod=!!(a!=null&&a[we.accountingPeriod]),Ce.overrides.journalId=!!(a!=null&&a[we.journalEntryId]),Object.entries(ts).forEach(([i,s])=>{var o,c,l;Ce.steps[i]={notes:(o=a[s.note])!=null?o:"",reviewer:(c=a[s.reviewer])!=null?c:"",signOffDate:(l=a[s.signOff])!=null?l:""}}),Ce.completes=Object.entries(du).reduce((i,[s,o])=>{var c;return i[s]=(c=a[o])!=null?c:"",i},{}),Ce.loaded=!0}catch(r){console.warn("PTO: unable to load configuration fields",r),Ce.loaded=!0}}async function Fk(){let e={};if(!xt())return e;let r=new Map;Object.entries(ts).forEach(([t,a])=>{a.note&&r.set(a.note.trim(),Number(t))});try{await Excel.run(async t=>{let a=t.workbook.tables.getItemOrNullObject(ca[0]);if(await t.sync(),a.isNullObject)return;let n=a.getDataBodyRange(),i=a.getHeaderRowRange();n.load("values"),i.load("values"),await t.sync();let o=(i.values[0]||[]).map(l=>String(l||"").trim().toLowerCase()),c={field:o.findIndex(l=>l==="field"||l==="field name"||l==="setting"),permanent:o.findIndex(l=>l==="permanent"||l==="persist")};c.field===-1||c.permanent===-1||(n.values||[]).forEach(l=>{let f=String(l[c.field]||"").trim(),u=r.get(f);if(u==null)return;let d=VE(l[c.permanent]);e[u]=d})})}catch(t){console.warn("PTO: unable to load permanent flags",t)}return e}function Ik(){let e=document.getElementById("quick-access-modal");e&&e.remove();let r=document.createElement("div");r.id="quick-access-modal",r.className="pf-quick-modal hidden",r.style.cssText="position:fixed!important;top:0;left:0;right:0;bottom:0;z-index:2147483647;",r.innerHTML=`
        <div class="pf-quick-modal-backdrop" data-close></div>
        <div class="pf-quick-modal-card">
            <div class="pf-quick-modal-header">
                <h3 class="pf-quick-modal-title">Quick Access</h3>
                <button id="quick-access-close" class="pf-quick-modal-close pf-clickable" type="button" aria-label="Close">
                    ${Ho}
                </button>
            </div>
            <div class="pf-quick-modal-items">
                ${Fe.pto_payroll_provider?`
                <a id="nav-provider-link" class="pf-quick-modal-item pf-clickable" href="${Se(Fe.pto_payroll_provider)}" target="_blank" rel="noopener">
                    ${Gf}
                    <span>PTO Provider Report</span>
                </a>
                `:""}
                <button id="nav-accounting-software" class="pf-quick-modal-item pf-clickable" type="button">
                    ${jo}
                    <span>Accounting Software</span>
                </button>
                <button id="nav-employee-roster" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Mf}
                    <span>Employee Roster</span>
                </button>
                <button id="nav-chart-of-accounts" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Uf}
                    <span>Chart of Accounts</span>
                </button>
                <button id="nav-config" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Wf}
                    <span>Configuration</span>
                </button>
            </div>
        </div>
    `,document.body.appendChild(r)}function wt(){var o;if(!Zn)return;let e=it.focusedIndex<=0?"disabled":"",r=it.focusedIndex>=er.length-1?"disabled":"",t=it.activeView==="step"&&it.activeStepId!=null,n=it.activeView==="config"?pu():t?Wk(it.activeStepId):`${Pk()}${Nk()}`;Zn.innerHTML=`
        <div class="pf-root">
            <div class="pf-brand-float" aria-hidden="true">
                <span class="pf-brand-wave"></span>
            </div>
            <header class="pf-banner">
                <div class="pf-nav-bar">
                    <button id="nav-prev" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Previous step" ${e}>
                        ${Gi}
                        <span class="sr-only">Previous step</span>
                    </button>
                    <button id="nav-home" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Home">
                        ${Df}
                        <span class="sr-only">Module Home</span>
                    </button>
                    <button id="nav-selector" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Selector">
                        ${Lf}
                        <span class="sr-only">Module Selector</span>
                    </button>
                    <button id="nav-next" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Next step" ${r}>
                        ${zi}
                        <span class="sr-only">Next step</span>
                    </button>
                    <div class="pf-nav-divider"></div>
                    <button id="nav-quick-toggle" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Quick Access">
                        ${Bf}
                        <span class="sr-only">Quick Access Menu</span>
                    </button>
                </div>
            </header>
            ${n}
            <footer class="pf-brand-footer">
                <div class="pf-brand-text">
                    <div class="pf-brand-label">prairie.forge</div>
                    <div class="pf-brand-meta"> Prairie Forge LLC, 2025. All rights reserved. Version ${vk}</div>
                </div>
            </footer>
        </div>
    `;let i=it.activeView==="home"||it.activeView!=="step"&&it.activeView!=="config",s=document.getElementById("pf-info-fab-pto");if(i)s&&s.remove();else if((o=window.PrairieForge)!=null&&o.mountInfoFab){let c=Rk(it.activeStepId);PrairieForge.mountInfoFab({title:c.title,content:c.content,buttonId:"pf-info-fab-pto"})}Ik(),Gk(),qk(),i?ms():ci()}function Rk(e){switch(e){case 0:return{title:"Configuration",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Configuration is auto-loaded from your installation. Review period-specific settings before each PTO run.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Auto-Loaded (Read-Only)</h4>
                        <ul>
                            <li><strong>Company Name</strong> \u2014 From your installation</li>
                            <li><strong>Company ID</strong> \u2014 Used for GL mapping lookups</li>
                            <li><strong>Company ID</strong> \u2014 Required for GL mappings</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4DD} Period-Specific (Editable)</h4>
                        <ul>
                            <li><strong>Analysis Date</strong> \u2014 The period-end date (e.g., 11/30/2024)</li>
                            <li><strong>Accounting Period</strong> \u2014 Shows up in your JE description</li>
                            <li><strong>Journal Entry ID</strong> \u2014 Reference number for your accounting system</li>
                        </ul>
                    </div>
                `};case 1:return{title:"Upload & Validate PTO Data",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Upload your Obsidian PTO export, auto-normalize headers, create PTO_Data_Clean, and run advisory validation checks.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4E5} Upload Process</h4>
                        <ol>
                            <li>Download your PTO report from Obsidian</li>
                            <li>Click Upload and select the file</li>
                            <li>Headers are auto-normalized using ada_payroll_dimensions</li>
                            <li>PTO_Data_Clean is created with standardized columns</li>
                        </ol>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u2705 Validation Checks (Advisory)</h4>
                        <ul>
                            <li><strong>Employee Coverage</strong> \u2014 Compare against SS_Employee_Roster</li>
                            <li><strong>Data Quality</strong> \u2014 Negative balances, outliers, date consistency</li>
                        </ul>
                        <p class="pf-info-note">Validation is advisory and does not block the workflow.</p>
                    </div>
                `};case 2:return{title:"PTO Accrual Review",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Review PTO accrual metrics with an executive-ready summary. Uses PTO_Data_Clean as the single source of truth.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CA} Key Measures</h4>
                        <ul>
                            <li><strong>Accrual Rate</strong> \u2014 Hours accrued per pay period</li>
                            <li><strong>Carry Over</strong> \u2014 Hours carried from prior year</li>
                            <li><strong>YTD Accrued / Used</strong> \u2014 Year-to-date totals</li>
                            <li><strong>Pay Period Accrued / Used</strong> \u2014 Current period activity</li>
                            <li><strong>Balance</strong> \u2014 Current available hours</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4C8} Analysis View</h4>
                        <p>Data is grouped by Employee Name and Plan Description for detailed review.</p>
                    </div>
                `};case 3:return{title:"Journal Entry Prep",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Generates accounting-ready journal entry output from your PTO analysis.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4DD} JE Generation</h4>
                        <ul>
                            <li>Uses PTO_Data_Clean as the data source</li>
                            <li>GL accounts resolved via ada_customer_gl_mappings</li>
                            <li>Output ready for QuickBooks or your accounting system</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u2705 Validation</h4>
                        <ul>
                            <li><strong>Debits = Credits</strong> \u2014 Entry must balance</li>
                            <li><strong>All rows mapped</strong> \u2014 Every line has a GL account</li>
                        </ul>
                    </div>
                `};case 4:return{title:"Archive & Clear",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Archive this period's results and reset working tabs for the next PTO cycle.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4E6} What Gets Archived</h4>
                        <ul>
                            <li><strong>PTO_Archive_Summary</strong> \u2014 Rolling summary of last 5 periods</li>
                            <li><strong>Excel Workbook</strong> \u2014 Full snapshot saved externally</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F9F9} What Gets Cleared</h4>
                        <ul>
                            <li>PTO_Data_Clean</li>
                            <li>PTO_Review</li>
                            <li>PTO_JE_Draft</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u26A0\uFE0F Important</h4>
                        <p>Ensure you've exported any needed files before clearing. The external workbook is your permanent backup.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Tip</h4>
                        <p>Make sure your JE has been uploaded to your accounting system before archiving.</p>
                    </div>
                `};default:return{title:"PTO Accrual",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F44B} Welcome to PTO Accrual</h4>
                        <p>This module helps you calculate PTO liabilities and generate journal entries each period.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Workflow Overview</h4>
                        <ol style="margin: 8px 0; padding-left: 20px;">
                            <li>Review period configuration (auto-loaded)</li>
                            <li>Upload & validate PTO data</li>
                            <li>Review PTO accrual metrics</li>
                            <li>Generate journal entry</li>
                            <li>Archive & clear for next period</li>
                        </ol>
                    </div>
                    <div class="pf-info-section">
                        <p>Click a step card to get started, or tap the <strong>\u24D8</strong> button on any step for detailed guidance.</p>
                    </div>
                `}}}function Pk(){return`
        <section class="pf-hero" id="pf-hero">
            <h2 class="pf-hero-title">PTO Accrual</h2>
            <p class="pf-hero-copy">${yk}</p>
        </section>
    `}function Nk(){return`
        <section class="pf-step-guide">
            <div class="pf-step-grid">
                ${er.map((e,r)=>Dk(e,r)).join("")}
            </div>
        </section>
    `}function Dk(e,r){let t=it.stepStatuses[e.id]||"pending",a=it.activeView==="step"&&it.focusedIndex===r?"pf-step-card--active":"",n=$f(UE(e.id));return`
        <article class="pf-step-card pf-clickable ${a}" data-step-card data-step-index="${r}" data-step-id="${e.id}">
            <p class="pf-step-index">Step ${e.id}</p>
            <h3 class="pf-step-title">${n?`${n}`:""}${e.title}</h3>
        </article>
    `}function Lk(e){let r=er.filter(i=>i.id!==4).map(i=>({id:i.id,title:i.title,complete:Kk(i.id)})),t=r.every(i=>i.complete),a=r.filter(i=>!i.complete).length;console.log("[Archive Step] Completion check:",r.map(i=>`Step ${i.id}: ${i.complete}`).join(", ")),console.log("[Archive Step] All complete:",t,"Incomplete count:",a);let n=r.map(i=>`
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head pf-notes-header">
                    <span class="pf-action-toggle ${i.complete?"is-active":""}" aria-pressed="${i.complete}">
                        ${Wi}
                    </span>
                    <div>
                        <h3>${Se(i.title)}</h3>
                        <p class="pf-config-subtext">${i.complete?"Complete":"Not complete"}</p>
                    </div>
                </div>
            </article>
        `).join("");return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(Ra)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${Se(e.title)}</h2>
            <p class="pf-hero-copy">${Se(e.summary||"")}</p>
            <p class="pf-hero-hint"></p>
        </section>
        <section class="pf-step-guide">
            ${n}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Archive & Reset</h3>
                    <p class="pf-config-subtext">Create an archive of this module's sheets and clear work tabs.</p>
                </div>
                ${t?'<p class="pf-step-note" style="color: #22c55e;">All steps complete. Ready to archive!</p>':`<p class="pf-step-note pf-step-note--info">Complete all ${a} remaining step(s) before archiving. Click the checkmark on each step's sign-off section.</p>`}
                <div class="pf-pill-row pf-config-actions">
                    <button type="button" class="pf-pill-btn ${t?"pf-cta-button":""}" id="archive-run-btn" ${t?"":"disabled"} style="${t?"":"opacity: 0.5; cursor: not-allowed;"}">
                        ${t?"Archive Now":"Archive (Complete Steps First)"}
                    </button>
                </div>
            </article>
        </section>
    `}function pu(){if(!Ce.loaded)return`
            <section class="pf-step-guide">
                <article class="pf-step-card pf-step-detail">
                    <p class="pf-step-title">Loading configuration\u2026</p>
                </article>
            </section>
        `;let e=su(At(we.payrollDate)),r=su(At(we.accountingPeriod)),t=At(we.journalEntryId),a=At(we.reviewerName),n=Fe.ss_company_name||At(we.companyName)||"",i=Fe.crm_company_id||"",s=Fe.pto_payroll_provider||"",o=Fe.ss_accounting_software||At(we.accountingSoftware)||"",c=Gr(0),l=!!Ce.permanents[0],f=!!(bu(Ce.completes[0])||c.signOffDate),u=ri(c==null?void 0:c.reviewer),d=(c==null?void 0:c.signOffDate)||"";return`
        <section class="pf-hero" id="pf-config-hero">
            <p class="pf-hero-copy">${Se(Ra)} | Step 0</p>
            <h2 class="pf-hero-title">Configuration Setup</h2>
            <p class="pf-hero-copy">Make quick adjustments before every PTO run.</p>
        </section>
        <section class="pf-step-guide">
            <!-- Period Data (User editable) - FIRST, matches payroll-recorder -->
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Period Data</h3>
                    <p class="pf-config-subtext">Fields in this section may change each period.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Your Name (Used for sign-offs)</span>
                        <input type="text" id="config-user-name" value="${Se(a)}" placeholder="Full name">
                    </label>
                    <label class="pf-config-field">
                        <span>PTO Analysis Date</span>
                        <input type="date" id="config-payroll-date" value="${Se(e)}">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Period</span>
                        <input type="text" id="config-accounting-period" value="${Se(r)}" placeholder="Nov 2025">
                    </label>
                    <label class="pf-config-field">
                        <span>Journal Entry ID</span>
                        <input type="text" id="config-journal-id" value="${Se(t)}" placeholder="PTO-AUTO-YYYY-MM-DD">
                    </label>
                </div>
            </article>
            
            <!-- Static Data - SECOND, matches payroll-recorder naming/structure -->
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Static Data</h3>
                    <p class="pf-config-subtext">Fields rarely change but should be reviewed.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Company Name</span>
                        <input type="text" id="config-company-name" value="${Se(n)}" placeholder="Prairie Forge LLC">
                    </label>
                    <label class="pf-config-field">
                        <span>Company ID <span class="pf-field-hint">(from Prairie Forge CRM)</span></span>
                        <input type="text" id="config-company-id" value="${Se(i)}" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                    </label>
                    <label class="pf-config-field">
                        <span>PTO Provider / Report Location</span>
                        <input type="url" id="config-pto-provider" value="${Se(s)}" placeholder="https://\u2026">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Software / Import Location</span>
                        <input type="url" id="config-accounting-link" value="${Se(o)}" placeholder="https://\u2026">
                    </label>
                </div>
            </article>
            
            ${tn({textareaId:"config-notes",value:c.notes||"",permanentId:"config-notes-lock",isPermanent:l,hintId:"",saveButtonId:"config-notes-save"})}
            ${rn({reviewerInputId:"config-reviewer",reviewerValue:u,signoffInputId:"config-signoff-date",signoffValue:d,isComplete:f,saveButtonId:"config-signoff-save",completeButtonId:"config-signoff-toggle"})}
        </section>
    `}function Bk(){let e=Pe.file||Pe.headers.length>0,r=Pe.loading;return console.log("[PTO-Upload] renderPtoFileUploadZone state:",{hasFile:e,isLoading:r,file:Pe.file?Pe.fileName:null,headersLength:Pe.headers.length,headers:Pe.headers.slice(0,3)}),r?`
            <div class="pf-upload-zone pf-upload-zone--analyzing">
                <div class="pf-upload-spinner"></div>
                <p class="pf-upload-status">Processing your PTO report\u2026</p>
            </div>
        `:e?`
            <div class="pf-upload-zone pf-upload-zone--ready">
                <div class="pf-upload-file-info">
                    <svg class="pf-upload-file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                    </svg>
                    <div class="pf-upload-file-details">
                        <span class="pf-upload-filename">${Se(Pe.fileName)}</span>
                        <span class="pf-upload-meta">${Pe.headers.length} columns \u2022 ${(Pe.rowCount||0).toLocaleString()} rows</span>
                    </div>
                    <button type="button" class="pf-upload-clear" id="pto-upload-clear-btn" title="Remove file">\xD7</button>
                </div>
            </div>
        `:`
        <div class="pf-upload-zone" id="pto-upload-dropzone">
            <input type="file" id="pto-upload-file-input" accept=".csv,.xlsx,.xls" hidden>
            <div class="pf-upload-content">
                <svg class="pf-upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="17 8 12 3 7 8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
                <p class="pf-upload-text">Drop your PTO file here</p>
                <p class="pf-upload-hint">or <button type="button" class="pf-upload-browse" id="pto-upload-browse-btn">browse</button> to upload</p>
                <p class="pf-upload-formats">Supports CSV, XLSX, XLS</p>
            </div>
        </div>
    `}function Mk(){let e=Ne.hasAnalyzed,r=Ne.loading,t=Ne.rosterCount||0,a=Ne.ptoCount||0,n=Ne.missingFromPto||[],i=Ne.extraInPto||[],s=e&&n.length===0&&i.length===0,o="",c="";r?o='<span class="pf-status-badge pf-status-badge--pending" role="status">\u23F3 Loading</span>':Ne.lastError?(o='<span class="pf-status-badge pf-status-badge--unavailable" role="status">\u26A0 Unavailable</span>',c="pf-coverage-unavailable"):e?s?(o='<span class="pf-status-badge pf-status-badge--ok" role="status">\u2713 OK</span>',c="pf-coverage-ok"):(o='<span class="pf-status-badge pf-status-badge--review" role="status">\u26A0 Review</span>',c="pf-coverage-review"):o='<span class="pf-status-badge pf-status-badge--pending" role="status">\u25CB Pending</span>';let l="";return r?l='<p class="pf-subsection-hint">Analyzing coverage...</p>':Ne.lastError?l=`<p class="pf-subsection-hint pf-subsection-hint--warn">${Se(Ne.lastError)}</p>`:e?(l='<div class="pf-recon-container">',l+=`
            <div class="pf-recon-row pf-recon-row--header">
                <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="summary">Roster Headcount</button>
                <span class="pf-recon-value">${t}</span>
            </div>
        `,(n.length>0||i.length>0)&&(l+='<div class="pf-recon-changes">',n.length>0&&(l+=`
                    <div class="pf-recon-row pf-recon-row--subtract">
                        <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="missing">
                            <span class="pf-recon-operator">\u2212</span> Missing from PTO
                </button>
                        <span class="pf-recon-value pf-recon-value--subtract">(${n.length})</span>
                    </div>
            `),i.length>0&&(l+=`
                    <div class="pf-recon-row pf-recon-row--add">
                        <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="extra">
                            <span class="pf-recon-operator">+</span> In PTO only
                </button>
                        <span class="pf-recon-value pf-recon-value--add">${i.length}</span>
                    </div>
                `),l+="</div>"),l+='<div class="pf-recon-divider"></div>',l+=`
            <div class="pf-recon-row pf-recon-row--footer">
                <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="summary">PTO File Headcount</button>
                <span class="pf-recon-value">${a}${s?" \u2713":""}</span>
            </div>
        `,l+="</div>",s?l+=`
                <div class="pf-coverage-item pf-coverage-item--ok" style="margin-top: 8px;">
                    <span class="pf-coverage-item-icon">\u2713</span>
                    <span>All roster employees found in PTO data</span>
                </div>
            `:l+='<p class="pf-coverage-hint">Click any row to see employee details</p>'):l='<p class="pf-subsection-hint">Upload a PTO file to run this check.</p>',`
        <article class="pf-step-card pf-step-detail pf-config-card pf-employee-coverage-card ${c}" id="pto-coverage-card">
            <div class="pf-config-head" style="display: flex; align-items: center;">
                <div>
                    <h3>Employee Coverage ${o}</h3>
                    <p class="pf-config-subtext">Compare PTO employees against roster.</p>
                </div>
                <button type="button" class="pf-action-toggle pf-action-toggle--subtle pf-clickable" id="pto-check-coverage-btn" title="Run coverage check" style="margin-left: auto;">
                    ${Xi}
                </button>
            </div>
            ${l}
        </article>
    `}function Uk(e){let r=Ne.rosterCount||0,t=Ne.ptoCount||0,a=Ne.missingFromPto||[],n=Ne.extraInPto||[],i="",s="";switch(e){case"summary":i="Coverage Summary",s=$k(r,t,a,n);break;case"missing":i=`${a.length} Active Employees Not in PTO Data`,s=Kf(a,"These employees are marked active in the roster but were not found in the PTO data. Verify they should have PTO balances.");break;case"extra":i=`${n.length} In PTO Data Only`,s=Kf(n,"These employees are in the PTO data but not found in the active roster. They may be terminated, on leave, or the roster needs updating.");break;default:return}jk(i,s)}function $k(e,r,t,a){let n=r-e,i=n===0?"Match":n>0?`+${n}`:`${n}`,s=n===0?"match":"mismatch";return`
        <div class="pf-coverage-detail-summary">
            <h4>Headcount Bridge</h4>
            <div class="pf-headcount-bridge">
                <div class="pf-bridge-row pf-bridge-row--base">
                    <span class="pf-bridge-label">Active in Roster</span>
                    <span class="pf-bridge-value">${e}</span>
                </div>
                ${a.length>0?`
                <div class="pf-bridge-row pf-bridge-row--add">
                    <span class="pf-bridge-label">+ In PTO data only (not in roster)</span>
                    <span class="pf-bridge-value">+${a.length}</span>
                </div>
                `:""}
                ${t.length>0?`
                <div class="pf-bridge-row pf-bridge-row--subtract">
                    <span class="pf-bridge-label">\u2212 Active but not in PTO data</span>
                    <span class="pf-bridge-value">\u2212${t.length}</span>
                </div>
                `:""}
                <div class="pf-bridge-row pf-bridge-row--total">
                    <span class="pf-bridge-label">In PTO Data</span>
                    <span class="pf-bridge-value">${r}</span>
                </div>
                <div class="pf-bridge-row pf-bridge-row--diff pf-bridge-row--${s}">
                    <span class="pf-bridge-label">Difference</span>
                    <span class="pf-bridge-value">${i}</span>
                </div>
            </div>
            
            <h4 style="margin-top: 20px;">What to Review</h4>
            <ul class="pf-coverage-review-list">
                ${t.length>0?`<li><strong>${t.length} not in PTO</strong> \u2014 Verify these active employees should have PTO balances</li>`:""}
                ${a.length>0?`<li><strong>${a.length} PTO only</strong> \u2014 Check if these are terminated/on leave, or update roster via Payroll Recorder</li>`:""}
                ${t.length===0&&a.length===0?"<li>\u2713 No issues found \u2014 roster and PTO data are in sync</li>":""}
            </ul>
        </div>
    `}function Kf(e,r){if(!e||e.length===0)return`<p>${r}</p><p><em>No employees in this category.</em></p>`;let t=`<p style="margin-bottom: 16px;">${r}</p>`;return t+='<div class="pf-employee-list">',e.forEach((a,n)=>{let i=a.name||a,s=a.department||null;t+=`
            <div class="pf-employee-list-item">
                <span class="pf-employee-index">${n+1}.</span>
                <span class="pf-employee-name">${Se(i)}</span>
                ${s?`<span class="pf-employee-dept">${Se(s)}</span>`:""}
            </div>
        `}),t+="</div>",t}function jk(e,r){let t=document.getElementById("pto-coverage-detail-modal");t&&t.remove();let a=document.createElement("div");a.id="pto-coverage-detail-modal",a.className="pf-coverage-modal",a.innerHTML=`
        <div class="pf-coverage-modal-backdrop" data-close></div>
        <div class="pf-coverage-modal-card">
            <div class="pf-coverage-modal-header">
                <h3 class="pf-coverage-modal-title">${Se(e)}</h3>
                <button class="pf-coverage-modal-close pf-clickable" type="button" aria-label="Close" data-close>
                    ${Ho}
                </button>
            </div>
            <div class="pf-coverage-modal-body">
                ${r}
            </div>
        </div>
    `,document.body.appendChild(a),a.querySelectorAll("[data-close]").forEach(i=>{i.addEventListener("click",()=>a.remove())});let n=i=>{i.key==="Escape"&&(a.remove(),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n)}function Xo(e,r,t,a){if(!(t!=null&&t.length))return"";let n=ut.expandedSections.has(e),i=n?"\u25BC":"\u25B6",s=n?`<div class="pf-quality-issue-details">
            ${t.map(a).join("")}
           </div>`:"";return`
        <div class="pf-quality-issue-row">
            <button type="button" class="pf-quality-issue-toggle pf-clickable" data-quality-section="${e}">
                <span class="pf-quality-chevron">${i}</span>
                <span class="pf-quality-issue-label">${t.length} ${r}</span>
            </button>
            ${s}
        </div>
    `}function Hk(){let e=ut.hasRun,r=ut.totalIssues||0,t=r===0,a=e?t?'<span class="pf-status-badge pf-status-badge--ok" role="status">\u2713 OK</span>':'<span class="pf-status-badge pf-status-badge--review" role="status">\u26A0 Review</span>':'<span class="pf-status-badge pf-status-badge--pending" role="status">\u25CB Pending</span>',n=e?t?`${ut.totalEmployees||0} employees checked, no issues found`:`Found ${r} potential issue${r!==1?"s":""} to review`:"Check for negative balances, outliers, and data anomalies.",i="";if(e&&!t){let o=[];o.push(Xo("balanceIssues","negative balance(s)",ut.balanceIssues,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--warn">
                <span class="pf-quality-issue-name">${Se(l.name)}</span>
                <span class="pf-quality-issue-value">${Se(l.issue)}</span>
            </div>`)),o.push(Xo("zeroBalances","zero balance(s)",ut.zeroBalances,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--info">
                <span class="pf-quality-issue-name">${Se(l.name)}</span>
                <span class="pf-quality-issue-value">0 hrs balance</span>
            </div>`)),o.push(Xo("accrualOutliers","accrual rate outlier(s)",ut.accrualOutliers,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--info">
                <span class="pf-quality-issue-name">${Se(l.name)}</span>
                <span class="pf-quality-issue-value">${l.accrualRate.toFixed(2)} hrs/period</span>
            </div>`));let c=o.filter(l=>l).join("");c&&(i=`
                <div class="pf-quality-issues-container">
                    ${c}
                </div>
            `)}return`
        <article class="pf-step-card pf-step-detail pf-config-card" id="pto-quality-card">
            <div class="pf-config-head" style="display: flex; align-items: center;">
                <div>
                    <h3>Data Quality ${a}</h3>
                    <p class="pf-config-subtext">${n}</p>
                </div>
                <button type="button" class="pf-action-toggle pf-action-toggle--subtle pf-clickable" id="pto-check-quality-btn" title="Run quality check" style="margin-left: auto;">
                    ${Xi}
                </button>
            </div>
            ${i}
            ${e?"":'<p class="pf-metric-hint pf-metric-hint--info" style="margin-top: 12px; font-style: italic;">Upload a PTO file above to run this check.</p>'}
        </article>
    `}function Vk(e){let r=Gr(1),t=!!Ce.permanents[1],a=ri(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(as(Ce.completes[1])||n),s=Pe.error?`<p class="pf-upload-error">${Se(Pe.error)}</p>`:"";return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(Ra)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">Upload & Validate PTO Data</h2>
            <p class="pf-hero-copy">Upload your PTO export, create the data matrix, and verify coverage.</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Import</h3>
                    <p class="pf-config-subtext">Drop your PTO file to auto-normalize headers.</p>
                </div>
                ${Bk()}
                ${s}
            </article>
            
            <div class="pf-validation-section">
                <h3 class="pf-validation-header">Validation</h3>
                <p class="pf-validation-subtext">Advisory checks \u2014 review but not required to proceed.</p>
                ${Mk()}
                ${Hk()}
            </div>
            
            ${tn({textareaId:"step-notes-1",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-1",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-1"})}
            ${rn({reviewerInputId:"step-reviewer-1",reviewerValue:a,signoffInputId:"step-signoff-1",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-1",completeButtonId:"step-signoff-toggle-1"})}
        </section>
    `}function Wk(e){let r=er.find(o=>o.id===e);if(!r)return"";switch(e){case 0:return pu();case 1:return Vk(r);case 2:return GE(r);case 3:return zE(r);case 4:return Lk(r)}let t=Gr(e),a=!!Ce.permanents[e],n=ri(t==null?void 0:t.reviewer),i=(t==null?void 0:t.signOffDate)||"",s=!!(as(Ce.completes[e])||i);return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(Ra)} | Step ${r.id}</p>
            <h2 class="pf-hero-title">${Se(r.title)}</h2>
            <p class="pf-hero-copy">${Se(r.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            ${tn({textareaId:`step-notes-${e}`,value:(t==null?void 0:t.notes)||"",permanentId:`step-notes-lock-${e}`,isPermanent:a,hintId:"",saveButtonId:`step-notes-save-${e}`})}
            ${rn({reviewerInputId:`step-reviewer-${e}`,reviewerValue:n,signoffInputId:`step-signoff-${e}`,signoffValue:i,isComplete:s,saveButtonId:`step-signoff-save-${e}`,completeButtonId:`step-signoff-toggle-${e}`})}
        </section>
    `}function Gk(){var i,s,o,c,l,f,u,d;(i=document.getElementById("nav-home"))==null||i.addEventListener("click",async()=>{var m;let h=hn(zr);await dn(h.sheetName,h.title,h.subtitle),ti({activeView:"home",activeStepId:null}),(m=document.getElementById("pf-hero"))==null||m.scrollIntoView({behavior:"smooth",block:"start"})}),(s=document.getElementById("nav-selector"))==null||s.addEventListener("click",()=>{window.location.href=wk}),(o=document.getElementById("nav-prev"))==null||o.addEventListener("click",()=>Qi(-1)),(c=document.getElementById("nav-next"))==null||c.addEventListener("click",()=>Qi(1));let e=document.getElementById("nav-quick-toggle"),r=document.getElementById("quick-access-modal"),t=document.getElementById("quick-access-close"),a=r==null?void 0:r.querySelector("[data-close]"),n=()=>{r==null||r.classList.add("hidden"),e==null||e.classList.remove("is-active")};e==null||e.addEventListener("click",h=>{h.stopPropagation(),r==null||r.classList.toggle("hidden"),e.classList.toggle("is-active")}),t==null||t.addEventListener("click",n),a==null||a.addEventListener("click",n),(l=document.getElementById("nav-accounting-software"))==null||l.addEventListener("click",async()=>{n(),await wu()}),(f=document.getElementById("nav-employee-roster"))==null||f.addEventListener("click",async()=>{n(),await Da("SS_Employee_Roster"),De("Opened Employee Roster","success",2e3)}),(u=document.getElementById("nav-chart-of-accounts"))==null||u.addEventListener("click",async()=>{n(),await Da("SS_Chart_of_Accounts"),De("Opened Chart of Accounts","success",2e3)}),(d=document.getElementById("nav-config"))==null||d.addEventListener("click",async()=>{n(),await Da("SS_PF_Config"),De("Opened Configuration","success",2e3)}),document.querySelectorAll("[data-step-card]").forEach(h=>{let m=Number(h.getAttribute("data-step-index")),p=Number(h.getAttribute("data-step-id"));h.addEventListener("click",()=>rs(m,p))}),it.activeView==="config"?Xk():it.activeView==="step"&&it.activeStepId!=null&&zk(it.activeStepId)}function zk(e){var d,h,m,p,g,v,y,x,O,I,A,k,D,N,M,G,L,ee,fe,Z,pe;let r=document.getElementById(`step-notes-${e}`),t=document.getElementById(`step-reviewer-${e}`),a=document.getElementById(`step-signoff-${e}`),n=document.getElementById("step-back-btn"),i=document.getElementById(`step-notes-lock-${e}`),s=document.getElementById(`step-notes-save-${e}`);s==null||s.addEventListener("click",async()=>{let J=(r==null?void 0:r.value)||"";await hr(e,"notes",J),Wr(s,!0)});let o=document.getElementById(`step-signoff-save-${e}`);o==null||o.addEventListener("click",async()=>{let J=(t==null?void 0:t.value)||"";await hr(e,"reviewer",J),Wr(o,!0)}),Wo();let c=`step-signoff-toggle-${e}`,l=`${c}-prev`,f=`${c}-next`,u=`step-signoff-${e}`;if(Tu(e,{buttonId:c,inputId:u,canActivate:null,onComplete:Yk(e)}),xu(l,f),e===2){let J=document.querySelector('[data-copilot="pto-copilot"]');J&&us(J,{id:"pto-copilot",contextProvider:ds({dataClean:"PTO_Data_Clean",review:"PTO_Review",config:"SS_PF_Config"}),onPrompt:CE})}if(n==null||n.addEventListener("click",async()=>{let J=hn(zr);await dn(J.sheetName,J.title,J.subtitle),ti({activeView:"home",activeStepId:null})}),i==null||i.addEventListener("click",async()=>{let J=!i.classList.contains("is-locked");Vo(i,J),await Eu(e,J)}),e===4&&((d=document.getElementById("archive-run-btn"))==null||d.addEventListener("click",()=>{FE()})),e===1){let J=document.getElementById("pto-upload-dropzone"),ge=document.getElementById("pto-upload-file-input"),te=document.getElementById("pto-upload-browse-btn"),ue=document.getElementById("pto-upload-clear-btn");console.log("[PTO-Upload] bindStepView Step 1 - Element check:",{dropzone:!!J,fileInput:!!ge,browseBtn:!!te,clearBtn:!!ue}),J&&(J.addEventListener("click",()=>{console.log("[PTO-Upload] Dropzone clicked, opening file picker"),ge==null||ge.click()}),J.addEventListener("dragover",V=>{V.preventDefault(),V.stopPropagation(),J.classList.add("pf-upload-zone--dragover")}),J.addEventListener("dragleave",V=>{V.preventDefault(),V.stopPropagation(),J.classList.remove("pf-upload-zone--dragover")}),J.addEventListener("drop",V=>{var B,R;V.preventDefault(),V.stopPropagation(),J.classList.remove("pf-upload-zone--dragover");let C=(R=(B=V.dataTransfer)==null?void 0:B.files)==null?void 0:R[0];C&&eu(C)})),te==null||te.addEventListener("click",V=>{V.stopPropagation(),console.log("[PTO-Upload] Browse button clicked"),ge==null||ge.click()}),ge==null||ge.addEventListener("change",V=>{var B;let C=(B=V.target.files)==null?void 0:B[0];console.log("[PTO-Upload] File selected:",C==null?void 0:C.name),C&&eu(C)}),ue==null||ue.addEventListener("click",()=>{console.log("[PTO-Upload] Clear button clicked"),Pe.file=null,Pe.fileName="",Pe.headers=[],Pe.rowCount=0,Pe.parsedData=null,Pe.error=null,wt()}),(h=document.getElementById("pto-check-coverage-btn"))==null||h.addEventListener("click",async()=>{De("Refreshing coverage check...","info",2e3);let V=window.scrollY;await Qn(),wt(),requestAnimationFrame(()=>window.scrollTo(0,V))}),document.querySelectorAll("[data-pto-coverage-detail]").forEach(V=>{V.addEventListener("click",C=>{C.preventDefault();let B=V.dataset.ptoCoverageDetail;Uk(B)})}),(m=document.getElementById("pto-check-quality-btn"))==null||m.addEventListener("click",async()=>{De("Refreshing quality check...","info",2e3);let V=window.scrollY;await Zi(),wt(),requestAnimationFrame(()=>window.scrollTo(0,V))}),document.querySelectorAll("[data-quality-section]").forEach(V=>{V.addEventListener("click",C=>{C.preventDefault();let B=V.dataset.qualitySection,R=window.scrollY;ut.expandedSections.has(B)?ut.expandedSections.delete(B):ut.expandedSections.add(B),wt(),requestAnimationFrame(()=>window.scrollTo(0,R))})})}e===2&&((p=document.getElementById("review-generate-btn"))==null||p.addEventListener("click",()=>cE()),(g=document.getElementById("review-open-btn"))==null||g.addEventListener("click",()=>ME("PTO_Review")),(v=document.getElementById("review-ada-btn"))==null||v.addEventListener("click",()=>{Promise.resolve().then(()=>(gs(),gc)).then(J=>{J.showAdaModal()})})),e===2&&((y=document.getElementById("headcount-skip-btn"))==null||y.addEventListener("click",()=>{Ne.skipAnalysis=!Ne.skipAnalysis;let J=document.getElementById("headcount-skip-btn");J==null||J.classList.toggle("is-active",Ne.skipAnalysis),Ne.skipAnalysis&&uu(),fu()}),(x=document.getElementById("headcount-run-btn"))==null||x.addEventListener("click",()=>Qn()),(O=document.getElementById("headcount-refresh-btn"))==null||O.addEventListener("click",()=>Qn()),ZE(),Ne.skipAnalysis&&uu(),fu()),e===3&&((I=document.getElementById("quality-run-btn"))==null||I.addEventListener("click",()=>Zi()),(A=document.getElementById("quality-refresh-btn"))==null||A.addEventListener("click",()=>Zi()),(k=document.getElementById("quality-acknowledge-btn"))==null||k.addEventListener("click",()=>EE())),e===4&&((D=document.getElementById("analysis-refresh-btn"))==null||D.addEventListener("click",()=>au()),(N=document.getElementById("analysis-run-btn"))==null||N.addEventListener("click",()=>au()),(M=document.getElementById("payrate-save-btn"))==null||M.addEventListener("click",Jf),(G=document.getElementById("payrate-ignore-btn"))==null||G.addEventListener("click",Jk),(L=document.getElementById("payrate-input"))==null||L.addEventListener("keydown",J=>{J.key==="Enter"&&Jf()})),e===3&&((ee=document.getElementById("je-create-btn"))==null||ee.addEventListener("click",()=>AE()),(fe=document.getElementById("je-run-btn"))==null||fe.addEventListener("click",()=>vu()),(Z=document.getElementById("je-export-btn"))==null||Z.addEventListener("click",()=>OE()),(pe=document.getElementById("je-upload-btn"))==null||pe.addEventListener("click",()=>wu()))}function Xk(){var o,c,l,f,u;yc("config-payroll-date",{onChange:d=>{if(Or(we.payrollDate,d),!!d){if(Ce.overrides.accountingPeriod=!1,Ce.overrides.journalId=!1,!Ce.overrides.accountingPeriod){let h=jE(d);if(h){let m=document.getElementById("config-accounting-period");m&&(m.value=h),Or(we.accountingPeriod,h)}}if(!Ce.overrides.journalId){let h=HE(d);if(h){let m=document.getElementById("config-journal-id");m&&(m.value=h),Or(we.journalEntryId,h)}}}}});let e=document.getElementById("config-accounting-period");e==null||e.addEventListener("change",d=>{Ce.overrides.accountingPeriod=!!d.target.value,Or(we.accountingPeriod,d.target.value||"")});let r=document.getElementById("config-journal-id");r==null||r.addEventListener("change",d=>{Ce.overrides.journalId=!!d.target.value,Or(we.journalEntryId,d.target.value.trim())}),(o=document.getElementById("config-company-name"))==null||o.addEventListener("change",d=>{Or(we.companyName,d.target.value.trim())}),(c=document.getElementById("config-payroll-provider"))==null||c.addEventListener("change",d=>{Or(we.payrollProvider,d.target.value.trim())}),(l=document.getElementById("config-accounting-link"))==null||l.addEventListener("change",d=>{Or(we.accountingSoftware,d.target.value.trim())}),(f=document.getElementById("config-user-name"))==null||f.addEventListener("change",d=>{Or(we.reviewerName,d.target.value.trim())});let t=document.getElementById("config-notes");t==null||t.addEventListener("input",d=>{hr(0,"notes",d.target.value)});let a=document.getElementById("config-notes-lock");a==null||a.addEventListener("click",async()=>{let d=!a.classList.contains("is-locked");Vo(a,d),await Eu(0,d)});let n=document.getElementById("config-notes-save");n==null||n.addEventListener("click",async()=>{t&&(await hr(0,"notes",t.value),Wr(n,!0))});let i=document.getElementById("config-reviewer");i==null||i.addEventListener("change",d=>{let h=d.target.value.trim();hr(0,"reviewer",h);let m=document.getElementById("config-signoff-date");if(h&&m&&!m.value){let p=tc();m.value=p,hr(0,"signOffDate",p),Su(0,!0)}}),(u=document.getElementById("config-signoff-date"))==null||u.addEventListener("change",d=>{hr(0,"signOffDate",d.target.value||"")});let s=document.getElementById("config-signoff-save");s==null||s.addEventListener("click",async()=>{var m,p;let d=((m=i==null?void 0:i.value)==null?void 0:m.trim())||"",h=((p=document.getElementById("config-signoff-date"))==null?void 0:p.value)||"";await hr(0,"reviewer",d),await hr(0,"signOffDate",h),Wr(s,!0)}),Wo(),Tu(0,{buttonId:"config-signoff-toggle",inputId:"config-signoff-date",onComplete:()=>{WE(),mu(0),gu()}}),xu("config-signoff-toggle-prev","config-signoff-toggle-next")}function rs(e,r=null){if(e<0||e>=er.length)return;Ki=e;let t=r!=null?r:er[e].id;ti({focusedIndex:e,activeView:t===0?"config":"step",activeStepId:t});let n=er[e];window.PRAIRIE_FORGE_CONTEXT.step=t,window.PRAIRIE_FORGE_CONTEXT.stepName=(n==null?void 0:n.title)||null,window.PRAIRIE_FORGE_CONTEXT.companyId=Fe.crm_company_id||null;let i=kk[t];i&&(console.log("[NAV] Step\u2192Sheet activation",{moduleKey:zr,stepIndex:e,stepId:t,targetSheetName:i}),Da(i).then(()=>{console.log("[NAV] Step\u2192Sheet activation success",{moduleKey:zr,stepId:t,targetSheetName:i})}).catch(s=>{var o;console.warn("[NAV] Step\u2192Sheet activation failed",{moduleKey:zr,stepId:t,targetSheetName:i,error:(o=s==null?void 0:s.message)!=null?o:String(s)})})),t===2&&!Ne.hasAnalyzed&&Qn()}function Yk(e){return e===4?null:()=>mu(e)}function mu(e){let r=er.findIndex(a=>a.id===e);if(r===-1)return;let t=r+1;t<er.length&&(rs(t,er[t].id),gu())}function gu(){let e=[document.querySelector(".pf-root"),document.querySelector(".pf-step-guide"),document.body];for(let r of e)r&&r.scrollTo({top:0,behavior:"smooth"});window.scrollTo({top:0,behavior:"smooth"})}function Qi(e){let r=it.focusedIndex+e,t=Math.max(0,Math.min(er.length-1,r));rs(t,er[t].id),window.scrollTo({top:0,behavior:"smooth"})}function xu(e,r){var t,a;(t=document.getElementById(e))==null||t.addEventListener("click",()=>Qi(-1)),(a=document.getElementById(r))==null||a.addEventListener("click",()=>Qi(1))}function qk(){if(Ki===null)return;let e=document.querySelector(`[data-step-index="${Ki}"]`);Ki=null,e==null||e.scrollIntoView({behavior:"smooth",block:"center"})}function Kk(e){var a;let r=bu(Ce.completes[e]),t=!!((a=Ce.steps[e])!=null&&a.signOffDate);return r||t}function ti(e){e.stepStatuses&&(it.stepStatuses={...it.stepStatuses,...e.stepStatuses}),Object.assign(it,{...e,stepStatuses:it.stepStatuses}),wt()}function Ot(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}async function Jf(){De("Please update pay rates in SS_Employee_Roster, then regenerate PTO_Review","info")}function Jk(){let e=document.getElementById("payrate-input");if(!e)return;let r=e.dataset.employee;r&&(Ia.ignoredMissingPayRates.add(r),Ia.missingPayRates=Ia.missingPayRates.filter(t=>t.name!==r)),rs(3,3)}var oa={ROSTER_OVERRIDE:"Roster Override",ROSTER:"Roster",PAYROLL:"Payroll",DEFAULT:"Default",MISSING:"Missing"},Jo=2080;function sn(e){return e?String(e).trim().replace(/\s+/g," ").toUpperCase():""}var Vt={loaded:!1,loading:!1,lastRun:null,rates:new Map,diagnostics:{fromRosterOverride:0,fromRoster:0,fromPayroll:0,fromDefault:0,missing:0,total:0,missingEmployees:[],topByLiability:[]}};async function Zk(){console.log("[RateEngine] Starting rate load..."),Vt.loading=!0,Vt.rates.clear();let e=Vt.diagnostics;if(e.fromRosterOverride=0,e.fromRoster=0,e.fromPayroll=0,e.fromDefault=0,e.missing=0,e.total=0,e.missingEmployees=[],e.topByLiability=[],!Ot())return console.warn("[RateEngine] Excel not available"),Vt.loading=!1,Vt.rates;try{await Excel.run(async t=>{let a=await Qk(t),n=await tE(t),i=await rE(t);for(let s of i){let o=sn(s.name);e.total++;let c=null,l=oa.MISSING,f="",u=a.get(o);if(u){if(u.isManuallyManaged&&u.hourlyRate>0)c=u.hourlyRate,l=oa.ROSTER_OVERRIDE,f=u.rateSource||"Manual override",e.fromRosterOverride++;else if(u.hourlyRate>0)c=u.hourlyRate,l=oa.ROSTER,f=u.rateSource||"Hourly_Rate column",e.fromRoster++;else if(u.salaryAnnual>0){let h=u.stdHoursPerYear||Jo;c=u.salaryAnnual/h,l=oa.ROSTER,f=`Salary ${u.salaryAnnual.toFixed(0)} / ${h} hrs`,e.fromRoster++}}if(!c&&n.has(o)){let h=n.get(o);h.rate>0&&(c=h.rate,l=oa.PAYROLL,f=`Fixed $${h.avgFixedPerPeriod.toFixed(0)} / ${eE}hrs (${h.periods} periods)`,e.fromPayroll++)}c||(l=oa.MISSING,f="No rate source available",e.missing++,e.missingEmployees.push({name:s.name,key:o}));let d=(u==null?void 0:u.department)||"";Vt.rates.set(o,{employeeName:s.name,rate:c||0,source:l,sourceDetail:f,balance:s.balance||0,department:d})}await t.sync()});let r=Array.from(Vt.rates.values()).filter(t=>t.rate>0&&t.balance>0).map(t=>({name:t.employeeName,balance:t.balance,rate:t.rate,liability:t.balance*t.rate})).sort((t,a)=>a.liability-t.liability).slice(0,10);e.topByLiability=r,console.log("[RateEngine] Load complete:",{total:e.total,fromRosterOverride:e.fromRosterOverride,fromRoster:e.fromRoster,fromPayroll:e.fromPayroll,fromDefault:e.fromDefault,missing:e.missing,missingNames:e.missingEmployees.map(t=>t.name)}),console.log("[RateEngine] Top 10 by liability:",e.topByLiability),Vt.loaded=!0,Vt.loading=!1,Vt.lastRun=new Date().toISOString()}catch(r){console.error("[RateEngine] Error loading rates:",r),Vt.loading=!1}return Vt.rates}async function Qk(e){let r=new Map,t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(t.load("isNullObject"),await e.sync(),t.isNullObject)return console.log("[RateEngine] SS_Employee_Roster not found"),r;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return console.log("[RateEngine] SS_Employee_Roster is empty"),r;let n=a.values[0].map(h=>String(h||"").toLowerCase().trim()),i=n.findIndex(h=>h==="employee_name"||h==="employee name"||h==="name"),s=n.findIndex(h=>h==="hourly_rate_prismhr"||h==="hourly rate prismhr"),o=n.findIndex(h=>h==="hourly_rate"||h==="hourly rate"||h==="pay_rate"||h==="pay rate"),c=n.findIndex(h=>h==="salary_annual"||h==="annual salary"||h==="salary"),l=n.findIndex(h=>h==="std_hours_per_year"||h==="standard hours"),f=n.findIndex(h=>h==="is_manually_managed"||h==="manual"),u=n.findIndex(h=>h==="rate_source"||h==="rate source"),d=n.findIndex(h=>h==="department"||h==="department_name"||h==="dept"||h.includes("department"));if(console.log("[RateEngine] Roster columns found:",{nameIdx:i,hourlyPrismhrIdx:s,hourlyIdx:o,salaryIdx:c,stdHoursIdx:l,manualIdx:f,rateSourceIdx:u,deptIdx:d}),i<0)return console.warn("[RateEngine] No employee name column in roster"),r;for(let h=1;h<a.values.length;h++){let m=a.values[h],p=String(m[i]||"").trim();if(!p)continue;let g=sn(p),v=s>=0&&parseFloat(m[s])||0,y=o>=0&&parseFloat(m[o])||0,x=v>0?v:y,O=c>=0&&parseFloat(m[c])||0,I=l>=0&&parseFloat(m[l])||Jo,A=f>=0?String(m[f]||"").toUpperCase()==="TRUE":!1,k=u>=0?String(m[u]||"").trim():"",D=d>=0?String(m[d]||"").trim():"";r.set(g,{name:p,hourlyRate:x,salaryAnnual:O,stdHoursPerYear:I,isManuallyManaged:A,rateSource:k,department:D,rowIndex:h})}return console.log(`[RateEngine] Loaded ${r.size} employees from roster`),r}var eE=80;async function tE(e,r=3){let t=new Map;return console.log("[RateEngine] loadPayrollDerivedRates: Rates now sourced from SS_Employee_Roster.Hourly_Rate"),t}async function rE(e){let r=[],t=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(t.load("isNullObject"),await e.sync(),t.isNullObject)return console.log("[RateEngine] PTO_Data_Clean not found"),r;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return r;let n=a.values[0].map(o=>String(o||"").toLowerCase().trim()),i=n.findIndex(o=>o==="employee_name"||o==="employee name"||o.includes("employee")),s=n.findIndex(o=>o==="balance"||o.includes("balance"));if(i<0)return console.warn("[RateEngine] No employee name column in PTO data"),r;for(let o=1;o<a.values.length;o++){let c=a.values[o],l=String(c[i]||"").trim();if(!l)continue;let f=s>=0&&parseFloat(c[s])||0;r.push({name:l,balance:f,rowIndex:o})}return console.log(`[RateEngine] Found ${r.length} employees in PTO data`),r}function aE(e){let r=sn(e);return Vt.rates.get(r)||null}var Ji=["Analysis_Date","Employee_ID","Employee_Name","Vested_Balance","Calc_Liability"],Zf=5;async function nE(){if(!Ot())return{ok:!1,error:"Excel unavailable"};try{return await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Archive_Summary");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.log("[PTOArchive] Creating PTO_Archive_Summary sheet"),r=e.workbook.worksheets.add("PTO_Archive_Summary");let a=r.getRangeByIndexes(0,0,1,Ji.length);return a.values=[Ji],a.format.font.bold=!0,await e.sync(),{ok:!0,created:!0}}let t=r.getUsedRangeOrNullObject();if(t.load("values"),await e.sync(),!t.isNullObject&&t.values&&t.values.length>0){let a=t.values[0].map(s=>String(s||"").trim()),n=new Set(a.map(s=>s.toLowerCase())),i=Ji.filter(s=>!n.has(s.toLowerCase()));if(i.length>0){console.log("[PTOArchive] Adding missing columns:",i);let s=a.length,o=r.getRangeByIndexes(0,s,1,i.length);o.values=[i],o.format.font.bold=!0;let c=t.values.length-1;if(c>0){let l=Array(c).fill(i.map(()=>0)),f=r.getRangeByIndexes(1,s,c,i.length);f.values=l}await e.sync()}}return{ok:!0}})}catch(e){return console.error("[PTOArchive] Error ensuring schema:",e),{ok:!1,error:e.message}}}async function iE(){let e=new Map;if(!Ot())return e;try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Archive_Summary");if(t.load("isNullObject"),await r.sync(),t.isNullObject){console.log("[PTOArchive] No archive sheet - all employees will show as NEW");return}let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)return;let n=a.values[0].map(d=>String(d||"").toLowerCase().trim()),i=n.findIndex(d=>d==="analysis_date"||d.includes("date")),s=n.findIndex(d=>d==="employee_id"||d==="employee_key"),o=n.findIndex(d=>d==="employee_name"||d.includes("employee")),c=n.findIndex(d=>d==="vested_balance"||d==="balance"),l=n.findIndex(d=>d==="calc_liability"||d==="liability_amount"||d.includes("liability")),f=n.findIndex(d=>d==="pay_rate"||d.includes("rate"));if(o<0&&s<0){console.warn("[PTOArchive] No employee identifier column");return}let u=new Map;for(let d=1;d<a.values.length;d++){let h=a.values[d],m=s>=0?String(h[s]||"").trim():sn(String(h[o]||""));if(!m)continue;let p=i>=0?String(h[i]||""):"",g=c>=0&&parseFloat(h[c])||0,v=l>=0&&parseFloat(h[l])||0,y=f>=0&&parseFloat(h[f])||0;u.has(m)||u.set(m,[]),u.get(m).push({analysisDate:p,liability:v,rate:y,balance:g})}for(let[d,h]of u)h.sort((m,p)=>String(p.analysisDate).localeCompare(String(m.analysisDate))),e.set(d,h[0]);console.log(`[PTOArchive] Loaded prior data for ${e.size} employees`)})}catch(r){console.error("[PTOArchive] Error loading prior data:",r)}return e}async function sE(e,r){if(!Ot()||!e||e.length===0)return{ok:!1,error:"No data to archive"};try{return await nE(),await Excel.run(async t=>{let a=t.workbook.worksheets.getItem("PTO_Archive_Summary"),n=a.getUsedRangeOrNullObject();n.load("values"),await t.sync();let i=Ji,s=[];!n.isNullObject&&n.values&&n.values.length>0&&(i=n.values[0].map(y=>String(y||"").trim()),s=n.values.slice(1));let o=i.map(y=>y.toLowerCase()),c=o.indexOf("analysis_date"),l=o.indexOf("employee_id")>=0?o.indexOf("employee_id"):o.indexOf("employee_key"),f=new Map;for(let y of s){let x=c>=0?String(y[c]||""):"";x&&(f.has(x)||f.set(x,[]),f.get(x).push(y))}let u=String(r||"").substring(0,10);f.delete(u);let d=e.map(y=>{let x=new Array(i.length).fill("");return i.forEach((O,I)=>{var k,D,N,M;let A=O.toLowerCase();A==="analysis_date"?x[I]=u:A==="employee_id"||A==="employee_key"?x[I]=y.employeeId||sn(y.employeeName):A==="employee_name"?x[I]=y.employeeName||"":A==="vested_balance"||A==="balance"?x[I]=(D=(k=y.vestedBalance)!=null?k:y.balance)!=null?D:0:A==="department"?x[I]=y.department||"":A==="pay_rate"?x[I]=y.payRate||0:A==="accrual_rate"?x[I]=y.accrualRate||0:A==="carry_over"?x[I]=y.carryOver||0:A==="ytd_accrued"?x[I]=y.ytdAccrued||0:A==="ytd_used"?x[I]=y.ytdUsed||0:(A==="calc_liability"||A==="liability_amount")&&(x[I]=(M=(N=y.calculatedLiability)!=null?N:y.liabilityAmount)!=null?M:0)}),x});if(f.set(u,d),f.size>Zf){let x=Array.from(f.keys()).sort().slice(0,f.size-Zf);for(let O of x)console.log(`[PTOArchive] Removing oldest period: ${O}`),f.delete(O)}let h=[];for(let[,y]of f)h.push(...y);let m=a.getUsedRangeOrNullObject();await t.sync(),m.isNullObject||m.clear();let p=1+h.length,g=a.getRangeByIndexes(0,0,p,i.length);g.values=[i,...h];let v=a.getRangeByIndexes(0,0,1,i.length);return v.format.font.bold=!0,await t.sync(),console.log(`[PTOArchive] Saved ${d.length} rows for period ${u}`),{ok:!0,rowCount:d.length,periodCount:f.size}})}catch(t){return console.error("[PTOArchive] Error saving archive:",t),{ok:!1,error:t.message}}}var Yo=["Analysis_Date","Employee_Name","Employee_ID","Department","Pay_Rate","Rate_Source","Accrual_Rate","Carry_Over","YTD_Accrued","YTD_Used","Vested_Balance","Register_Balance","Liability_Amount","Liability_Source","Report_Liability","Calc_Liability","Prior_Liability","Change","_Flags"];function Qf(e){return e?String(e).toUpperCase().replace(/,/g," ").replace(/\s+/g," ").trim():""}async function oE(e){let r={rosterCount:0,ptoReportCount:e.length,inBothCount:0,inPtoOnlyCount:0,inPtoOnlyNames:[],inPtoOnlyLiability:0,inRosterOnlyCount:0,inRosterOnlyNames:[]};if(!Ot())return r;try{await Excel.run(async t=>{let a=t.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(a.load("isNullObject"),await t.sync(),a.isNullObject){console.warn("[Coverage] SS_Employee_Roster not found");return}let n=a.getUsedRangeOrNullObject();if(n.load("values"),await t.sync(),n.isNullObject||!n.values||n.values.length<2)return;let i=n.values[0].map(d=>String(d||"").toLowerCase().trim()),s=i.findIndex(d=>d==="employee_name"||d.includes("employee")),o=i.findIndex(d=>d==="employment_status"||d.includes("status"));if(s<0){console.warn("[Coverage] Employee name column not found in roster");return}let c=new Map,l=new Set;for(let d=1;d<n.values.length;d++){let h=n.values[d],m=String(h[s]||"").trim(),p=Qf(m),g=o>=0?String(h[o]||"").toLowerCase():"";p&&!g.includes("terminated")&&!g.includes("inactive")&&(l.add(p),c.set(p,m))}r.rosterCount=l.size;let f=new Map,u=new Set;for(let d of e){let h=Qf(d.employeeName);h&&(u.add(h),f.set(h,d))}console.log("[Coverage] Roster employees:",l.size,"PTO employees:",u.size);for(let d of u)if(l.has(d))r.inBothCount++;else{r.inPtoOnlyCount++;let h=f.get(d);h&&(r.inPtoOnlyNames.push(h.employeeName),r.inPtoOnlyLiability+=h.calculatedLiability||0)}for(let d of l)if(!u.has(d)){r.inRosterOnlyCount++;let h=c.get(d);h&&r.inRosterOnlyNames.push(h)}await t.sync()})}catch(t){console.error("[Coverage] Error calculating employee coverage:",t)}return console.log("[Coverage] Results:",r),r}async function cE(){var e;console.log("[PTOReview] Starting review generation..."),Xe.loading=!0,De("Generating PTO Accrual Review...","info",3e3);try{await Zk();let r=await iE(),t=await lE(r);await fE(t);let a=0,n=0,i=0,s=0,o=0,c=0,l=0,f=0,u=0;for(let h of t){a+=h.liabilityAmount||0,n+=h.priorLiability||0,i+=h.reportLiability||0;let m=h.calculatedLiability||0;s+=m;let p=(e=h.vestedBalance)!=null?e:0;p<0?(o+=m,c++):p>0?l++:f++,(!h.payRate||h.payRate<=0)&&u++}Xe.reconciliation={reportLiabilityTotal:i,calcLiabilityTotal:s,negativeBalanceTotal:o,negativeBalanceCount:c,positiveBalanceCount:l,zeroBalanceCount:f,missingRateCount:u};let d=await oE(t);Xe.coverage=d,Xe.totalCurrentLiability=a,Xe.totalPriorLiability=n,Xe.netChange=a-n,Xe.employeeCount=t.length,Xe.reviewData=t,Xe.loaded=!0,Xe.loading=!1,Xe.lastRun=new Date().toISOString(),console.log("[PTOReview] Generation complete:",{employees:t.length,totalCurrent:a,totalPrior:n,netChange:a-n,reconciliation:Xe.reconciliation,coverage:Xe.coverage}),De(`PTO Review generated: ${t.length} employees, ${uE(a)} total liability`,"success"),wt()}catch(r){console.error("[PTOReview] Error generating review:",r),De(`Error generating review: ${r.message}`,"error"),Xe.loading=!1}}async function lE(e){let r=[],t=At(we.payrollDate)||new Date().toISOString().substring(0,10);return Ot()&&(await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(n.load("isNullObject"),await a.sync(),n.isNullObject)throw new Error("PTO_Data_Clean not found. Upload data in Step 1.");let i=n.getUsedRangeOrNullObject();if(i.load("values"),await a.sync(),i.isNullObject||!i.values||i.values.length<2)throw new Error("PTO_Data_Clean is empty.");let s=i.values[0].map(m=>String(m||"").toLowerCase().trim());console.log("[PTOReview] All headers from PTO_Data_Clean:",s);let o={employeeName:s.findIndex(m=>m==="employee_name"||m==="employee name"||m==="employeename"||m==="name"||m==="full_name"||m==="full name"),department:s.findIndex(m=>m==="department"||m==="department_name"),accrualRate:s.findIndex(m=>m==="accrual_rate"||m.includes("accrual")&&m.includes("rate")),carryOver:s.findIndex(m=>m==="carry_over"||m.includes("carry")),ytdAccrued:s.findIndex(m=>m==="ytd_accrued"||m.includes("ytd")&&m.includes("accrued")),ytdUsed:s.findIndex(m=>m==="ytd_used"||m.includes("ytd")&&m.includes("used")),balance:s.findIndex(m=>m==="balance")},c=s.findIndex(m=>m==="pay_rate_hourly"||m==="pay rate hourly"||m==="payratehourly"),l=s.findIndex(m=>m==="accrued_liability"||m==="accrued liability"||m==="accruedliability"),f=s.findIndex(m=>m==="as_of_date_balance"||m==="as of date balance"||m==="asofdatebalance"),u=s.findIndex(m=>m==="current_register_balance"||m==="current register balance"||m==="currentregisterbalance"),d=s.findIndex(m=>m==="employee_id"||m==="employee id"||m==="employeeid"),h=s.findIndex(m=>m==="department"||m==="department_name");if(console.log("[PTOReview] Column indexes:",o),console.log("[PTOReview] Employee name found at index:",o.employeeName,"header:",s[o.employeeName]),console.log("[PTOReview] Report columns detected:",{payRateHourly:c>=0,accruedLiability:l>=0,asOfDateBalance:f>=0,currentRegisterBalance:u>=0,employeeId:d>=0}),o.employeeName<0)throw console.error("[PTOReview] Could not find employee name column. Headers available:",s),new Error("Employee name column not found in PTO data. Check console for available headers.");for(let m=1;m<i.values.length;m++){let p=i.values[m],g=String(p[o.employeeName]||"").trim();if(!g)continue;let v=sn(g),y=aE(g),x=c>=0?Ko(p[c]):0,O=(y==null?void 0:y.rate)||0,I=x>0?x:O,A=x>0?"REPORT":(y==null?void 0:y.source)||oa.MISSING,k=h>=0?String(p[h]||"").trim():"",D=(y==null?void 0:y.department)||"",N=k||D,M=d>=0?String(p[d]||"").trim():"",G=o.accrualRate>=0&&parseFloat(p[o.accrualRate])||0,L=o.carryOver>=0&&parseFloat(p[o.carryOver])||0,ee=o.ytdAccrued>=0&&parseFloat(p[o.ytdAccrued])||0,fe=o.ytdUsed>=0&&parseFloat(p[o.ytdUsed])||0,Z=f>=0?parseFloat(p[f])||0:null,pe=u>=0?parseFloat(p[u])||0:o.balance>=0&&parseFloat(p[o.balance])||0,J=Z!==null?Z:pe,ge=pe,te=0,ue="NO_BALANCE",V=0,C=0;J>0?(V=l>=0?Ko(p[l]):0,C=I>0?J*I:0,V>0?(te=V,ue="REPORT"):(te=C,ue="CALCULATED")):J<0?(te=0,ue="NEGATIVE_BALANCE",C=J*I):(te=0,ue="NO_BALANCE"),console.log(`[PTOReview] ${g}: vestedBal=${J}, displayBal=${ge}, liability=${te.toFixed(2)} (${ue})`);let B=e.get(v),R=(B==null?void 0:B.liability)||0,P=C-R,z=[];B||z.push("NEW"),A===oa.MISSING&&z.push("MISSING_RATE"),Math.abs(P)>Xe.flagThresholds.largeMove&&z.push("LARGE_MOVE"),J<0&&z.push("NEG_BALANCE"),x>0&&O>0&&Math.abs(x-O)>5&&(z.push("RATE_VARIANCE"),console.log(`[PTOReview] Rate variance for ${g}: Report=$${x.toFixed(2)} vs Calc=$${O.toFixed(2)}`)),J>0&&V>0&&C>0&&Math.abs(V-C)>100&&(z.push("LIABILITY_VARIANCE"),console.log(`[PTOReview] Liability variance for ${g}: Report=$${V.toFixed(2)} vs Calc=$${C.toFixed(2)}`)),r.push({analysisDate:t,employeeName:g,employeeId:M,department:N,payRate:I,rateSource:A,accrualRate:G,carryOver:L,ytdAccrued:ee,ytdUsed:fe,vestedBalance:J,displayBalance:ge,liabilityAmount:te,liabilitySource:ue,reportLiability:V,calculatedLiability:C,priorLiability:R,change:P,flags:z.join(", ")})}await a.sync()}),r.sort((a,n)=>n.liabilityAmount-a.liabilityAmount)),r}async function fE(e){Ot()&&await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");t.load("isNullObject"),await r.sync(),t.isNullObject&&(t=r.workbook.worksheets.add("PTO_Review"));let a=t.getUsedRangeOrNullObject();await r.sync(),a.isNullObject||a.clear();let n=e.map(l=>[l.analysisDate,l.employeeName,l.employeeId||"",l.department,l.payRate,l.rateSource||"",l.accrualRate,l.carryOver,l.ytdAccrued,l.ytdUsed,l.vestedBalance,l.displayBalance,l.liabilityAmount,l.liabilitySource||"",l.reportLiability||0,l.calculatedLiability||0,l.priorLiability,l.change,l.flags]),i=[Yo,...n],s=t.getRangeByIndexes(0,0,i.length,Yo.length);s.values=i;let o=t.getRangeByIndexes(0,0,1,Yo.length);Kn(o);let c="$#,##0.00";n.length>0&&(t.getRangeByIndexes(1,4,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,12,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,14,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,15,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,16,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,17,n.length,1).numberFormat=[[c]]),s.format.autofitColumns(),t.freezePanes.freezeRows(1),await r.sync(),console.log(`[PTOReview] Wrote ${n.length} rows to PTO_Review sheet`)})}function uE(e){return(Number(e)||0).toLocaleString("en-US",{style:"currency",currency:"USD"})}var Pe={file:null,fileName:"",headers:[],rowCount:0,parsedData:null,mappings:null,unmappedHeaders:[],error:null,loading:!1},dE=["Company_Name","Form_Name","Selection_Criteria","Employee_Name","Plan_Description","Accrue_Through_Date","Year_Ending"],hE=["Accrual_Rate","Carry_Over","Pay_Period_Accrued","Pay_Period_Used","YTD_Accrued","YTD_Used","Balance"],JS=[...dE,...hE];async function eu(e){if(e){await tu(e);return}let r=document.getElementById("pto-file-input");r||(r=document.createElement("input"),r.type="file",r.id="pto-file-input",r.accept=".csv,.xlsx,.xls",r.style.display="none",document.body.appendChild(r),r.addEventListener("change",async t=>{var n;let a=(n=t.target.files)==null?void 0:n[0];a&&await tu(a),r.value=""})),r.click()}async function tu(e){let r=[".csv",".xlsx",".xls"],t=e.name.toLowerCase().slice(e.name.lastIndexOf("."));if(!r.includes(t)){De("Please upload a CSV or Excel file (.csv, .xlsx, .xls)","error");return}Pe.loading=!0,Pe.error=null,Pe.fileName=e.name,Pe.file=e,De(`Reading ${e.name}...`,"info",2e3),Jn("Reading file...");try{let a=await mE(e);if(!a||a.length<2)throw new Error("File appears empty or has no data rows.");Pe.headers=a[0].map(d=>String(d||"").trim()),Pe.rowCount=a.length-1,Pe.parsedData=a,console.log(`[PTOUpload] Parsed ${Pe.headers.length} columns, ${Pe.rowCount} rows`),console.log("[PTOUpload] Raw headers:",Pe.headers),Jn("Loading column mappings...");let n=At("SS_Company_ID"),i=await gE(n,"pto-accrual"),s=await kE();console.log(`[PTOUpload] Loaded ${i.length} customer mappings, ${s.size} dimension mappings`);let{normalizedHeaders:o,includedIndexes:c,unmapped:l,excluded:f}=xE(Pe.headers,i,s);Pe.mappings=s,Pe.unmappedHeaders=l,l.length>0&&(console.warn("[PTOUpload] Unmapped headers:",l),De(`Warning: ${l.length} column(s) could not be mapped`,"warning",4e3)),f.length>0&&console.log("[PTOUpload] Excluded columns (include_in_matrix=false):",f),console.log("[PTOUpload] Normalized headers:",o),console.log("[PTOUpload] Included column indexes:",c),Jn("Writing to PTO_Data_Clean..."),await _E(o,Pe.parsedData,c),Pe.loading=!1,De(`Successfully imported ${Pe.rowCount} rows to PTO_Data_Clean`,"success"),Jn(`\u2713 ${Pe.rowCount} rows imported`),wt();let u=await pE();u.ok&&u.rowsUpdated>0?(console.log(`[PTO] Synced ${u.rowsUpdated} employees to roster (${u.idUpdates} IDs, ${u.rateUpdates} rates)`),De(`Updated ${u.rowsUpdated} employees in roster`,"success",2e3)):u.ok||console.warn("[PTO] Roster sync skipped:",u.error),De("Running validation checks...","info",2e3),await Promise.all([Qn(),Zi()]),wt(),De("Validation checks complete!","success")}catch(a){console.error("[PTOUpload] Error:",a),Pe.error=a.message,Pe.loading=!1,De(`Upload failed: ${a.message}`,"error"),Jn(`Error: ${a.message}`)}}function Jn(e){let r=document.getElementById("pto-upload-status");r&&(r.textContent=e)}async function pE(){if(!Ot())return console.log("[PTO-Roster Sync] Excel not available, skipping roster sync"),{ok:!1,error:"Excel not available"};console.log("[PTO-Roster Sync] Starting sync to SS_Employee_Roster...");try{return await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean"),t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(r.load("isNullObject"),t.load("isNullObject"),await e.sync(),r.isNullObject)return console.warn("[PTO-Roster Sync] PTO_Data_Clean not found"),{ok:!1,error:"PTO_Data_Clean not found"};if(t.isNullObject)return console.warn("[PTO-Roster Sync] SS_Employee_Roster not found"),{ok:!1,error:"SS_Employee_Roster not found"};let a=r.getUsedRangeOrNullObject(),n=t.getUsedRangeOrNullObject();if(a.load("values"),n.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return{ok:!1,error:"PTO_Data_Clean is empty"};if(n.isNullObject||!n.values||n.values.length<2)return{ok:!1,error:"SS_Employee_Roster is empty"};let i=a.values[0].map(m=>String(m||"").toLowerCase().trim()),s={employeeName:i.findIndex(m=>m==="employee_name"||m==="employee name"),employeeId:i.findIndex(m=>m==="employee_id"||m==="employee id"),payRateHourly:i.findIndex(m=>m==="pay_rate_hourly"||m==="pay rate hourly")};if(console.log("[PTO-Roster Sync] PTO column indexes:",s),s.employeeName<0)return{ok:!1,error:"Employee_Name column not found in PTO data"};let o=new Map;for(let m=1;m<a.values.length;m++){let p=a.values[m],g=String(p[s.employeeName]||"").trim();if(!g)continue;let v=g.toLowerCase();o.set(v,{employeeId:s.employeeId>=0?String(p[s.employeeId]||"").trim():"",payRateHourly:s.payRateHourly>=0?Ko(p[s.payRateHourly]):0})}console.log(`[PTO-Roster Sync] Loaded ${o.size} employees from PTO data`);let c=n.values[0].map(m=>String(m||"").toLowerCase().trim()),l={employeeName:c.findIndex(m=>m==="employee_name"),employeeId:c.findIndex(m=>m==="employee_id"),hourlyRatePrismhr:c.findIndex(m=>m==="hourly_rate_prismhr")};if(console.log("[PTO-Roster Sync] Roster column indexes:",l),l.hourlyRatePrismhr<0&&console.warn("[PTO-Roster Sync] Hourly_Rate_Prismhr column not found in roster - it may need to be added via payroll-recorder schema update"),l.employeeName<0)return{ok:!1,error:"Employee_Name column not found in roster"};let f=0,u=0,d=0;for(let m=1;m<n.values.length;m++){let p=n.values[m],g=String(p[l.employeeName]||"").trim();if(!g)continue;let v=g.toLowerCase(),y=o.get(v);if(!y)continue;let x=!1;if(l.employeeId>=0&&y.employeeId){let O=String(p[l.employeeId]||"").trim();(!O||O.includes(" "))&&(t.getRangeByIndexes(m,l.employeeId,1,1).values=[[y.employeeId]],x=!0,u++)}l.hourlyRatePrismhr>=0&&y.payRateHourly>0&&(t.getRangeByIndexes(m,l.hourlyRatePrismhr,1,1).values=[[y.payRateHourly]],x=!0,d++),x&&f++}await e.sync();let h={ok:!0,totalMatched:o.size,rowsUpdated:f,idUpdates:u,rateUpdates:d};return console.log("[PTO-Roster Sync] Complete:",h),h})}catch(e){return console.error("[PTO-Roster Sync] Error:",e),{ok:!1,error:e.message}}}async function mE(e){return new Promise((r,t)=>{let a=new FileReader;a.onload=n=>{try{let i=n.target.result,s=Ri(i,{type:"array"}),o=s.SheetNames[0];if(!o)throw new Error("No sheets found in workbook");let c=s.Sheets[o],l=Vr.sheet_to_json(c,{header:1,defval:""}),f=0;for(let u=0;u<Math.min(10,l.length);u++){let h=l[u].map(m=>String(m||"").toLowerCase()).join(" ");if(h.includes("employee")||h.includes("balance")||h.includes("accrual")){f=u;break}}console.log(`[PTOUpload] Header row detected at index ${f}`),r(l.slice(f))}catch(i){t(i)}},a.onerror=()=>t(new Error("Failed to read file")),a.readAsArrayBuffer(e)})}async function gE(e,r){if(!e)return console.warn("[PTOUpload] No companyId provided, skipping customer mappings"),[];console.log(`[PTOUpload] Loading customer column mappings for company=${e}, module=${r}`);try{let t=`${Qo}/rest/v1/ada_customer_column_mappings?crm_company_id=eq.${encodeURIComponent(e)}&module=eq.${encodeURIComponent(r)}&select=raw_header,pf_column_name,include_in_matrix`,a=await fetch(t,{headers:{apikey:nn,Authorization:`Bearer ${nn}`,"Content-Type":"application/json"}});if(!a.ok)return console.warn(`[PTOUpload] Customer mappings API error: ${a.status}`),[];let n=await a.json();return console.log(`[PTOUpload] Loaded ${n.length} customer column mappings`),n}catch(t){return console.error("[PTOUpload] Error loading customer mappings:",t),[]}}function xE(e,r,t){let a=[],n=[],i=[],s=[],o=new Map;for(let c of r){let l=Ue(c.raw_header);o.set(l,c)}for(let c=0;c<e.length;c++){let l=e[c],f=Ue(l),u=o.get(f);if(u){let m=u.include_in_matrix;if(m===!1||m==="false"){s.push(l),console.log(`[PTOUpload] Excluding column "${l}" (include_in_matrix=false)`);continue}a.push(u.pf_column_name),n.push(c);continue}let d=t.get(f);if(d){a.push(d),n.push(c);continue}let h=l.trim().replace(/[^a-zA-Z0-9\s]/g,"").split(/\s+/).map(m=>m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()).join("_");a.push(h||`Column_${a.length+1}`),n.push(c),l.trim()&&i.push(l)}return{normalizedHeaders:a,includedIndexes:n,unmapped:i,excluded:s}}function vE(e){if(typeof e!="number"||e<1)return null;let r=new Date(1899,11,30);return new Date(r.getTime()+e*24*60*60*1e3)}function yE(e){if(!e)return"";if(typeof e=="string"){let r=e.trim();if(r.match(/^\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}$/))return r;if(r.match(/^\d{4}-\d{2}-\d{2}/)){let t=new Date(r);if(!isNaN(t.getTime()))return`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()}`}return r}if(typeof e=="number"&&e>1e3&&e<1e5){let r=vE(e);if(r)return`${r.getMonth()+1}/${r.getDate()}/${r.getFullYear()}`}return e instanceof Date&&!isNaN(e.getTime())?`${e.getMonth()+1}/${e.getDate()}/${e.getFullYear()}`:String(e)}function wE(e){let r=e.toLowerCase();return r.includes("balance")||r.includes("amount")||r.includes("liability")?!1:r.includes("_date")||r.includes("date_")||r==="date"||r.endsWith(" date")||r.startsWith("date ")||r.includes("hire")||r.includes("termination")||r.includes("start_date")||r.includes("end_date")||r==="as_of"}async function _E(e,r,t){if(!Ot())throw new Error("Excel runtime not available");let a=[];e.forEach((n,i)=>{wE(n)&&(a.push(i),console.log(`[PTOUpload] Detected date column: "${n}" at index ${i}`))}),await Excel.run(async n=>{let i=n.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");i.load("isNullObject"),await n.sync(),i.isNullObject&&(i=n.workbook.worksheets.add("PTO_Data_Clean"),console.log("[PTOUpload] Created PTO_Data_Clean sheet"));let s=i.getUsedRangeOrNullObject();await n.sync(),s.isNullObject||s.clear();let o=[e];for(let f=1;f<r.length;f++){let u=r[f],d=t.map((h,m)=>{let p=u[h];return a.includes(m)?yE(p):p!=null?p:""});o.push(d)}let c=i.getRangeByIndexes(0,0,o.length,e.length);c.values=o;let l=i.getRangeByIndexes(0,0,1,e.length);if(Kn(l),o.length>1&&a.length>0)for(let f of a){let u=i.getRangeByIndexes(1,f,o.length-1,1);u.numberFormat=[["mm/dd/yyyy"]]}c.format.autofitColumns(),i.freezePanes.freezeRows(1),await n.sync(),console.log(`[PTOUpload] Wrote ${o.length-1} rows, ${e.length} columns to PTO_Data_Clean`)})}async function kE(){console.log("[PTOUpload] Loading Obsidian dimension mappings via edge function...");try{let e=`${Qo}/functions/v1/column-mapper`,r=await fetch(e,{method:"POST",headers:{apikey:nn,Authorization:`Bearer ${nn}`,"Content-Type":"application/json"},body:JSON.stringify({action:"get_dimensions",provider:"obsidian"})});if(!r.ok){let n=await r.text();throw new Error(`Edge function error: ${r.status} - ${n}`)}let t=await r.json();if(!t.success||!t.dimensions)throw new Error("Edge function returned unsuccessful response");console.log(`[PTOUpload] Loaded ${t.dimensions.length} dimension mappings from edge function`);let a=new Map;for(let n of t.dimensions){let i=Ue(n.raw_term),s=n.normalized_dimension;i&&s&&a.set(i,s)}return console.log(`[PTOUpload] Built ${a.size} unique mappings`),a.size===0?(console.log("[PTOUpload] No DB mappings found, using fallback mappings"),ru()):a}catch(e){return console.error("[PTOUpload] Error loading dimension mappings:",e),console.log("[PTOUpload] Using fallback mappings due to error"),ru()}}function ru(){let e=new Map;return e.set(Ue("Company Name"),"Company_Name"),e.set(Ue("Form Name"),"Form_Name"),e.set(Ue("Selection Criteria"),"Selection_Criteria"),e.set(Ue("Employee Name"),"Employee_Name"),e.set(Ue("Employee"),"Employee_Name"),e.set(Ue("Name"),"Employee_Name"),e.set(Ue("Plan Description"),"Plan_Description"),e.set(Ue("Plan"),"Plan_Description"),e.set(Ue("Accrue Through Date"),"Accrue_Through_Date"),e.set(Ue("Accrue Thru Date"),"Accrue_Through_Date"),e.set(Ue("Year Ending"),"Year_Ending"),e.set(Ue("Year End"),"Year_Ending"),e.set(Ue("Accrual Rate"),"Accrual_Rate"),e.set(Ue("Rate"),"Accrual_Rate"),e.set(Ue("Carry Over"),"Carry_Over"),e.set(Ue("Carryover"),"Carry_Over"),e.set(Ue("Pay Period Accrued"),"Pay_Period_Accrued"),e.set(Ue("PP Accrued"),"Pay_Period_Accrued"),e.set(Ue("Period Accrued"),"Pay_Period_Accrued"),e.set(Ue("Pay Period Used"),"Pay_Period_Used"),e.set(Ue("PP Used"),"Pay_Period_Used"),e.set(Ue("Period Used"),"Pay_Period_Used"),e.set(Ue("YTD Accrued"),"YTD_Accrued"),e.set(Ue("Year To Date Accrued"),"YTD_Accrued"),e.set(Ue("YTD Used"),"YTD_Used"),e.set(Ue("Year To Date Used"),"YTD_Used"),e.set(Ue("Balance"),"Balance"),e.set(Ue("Current Balance"),"Balance"),e.set(Ue("Available Balance"),"Balance"),console.log(`[PTOUpload] Fallback mappings: ${e.size} entries`),e}function Ue(e){return e?String(e).trim().toLowerCase().replace(/[_\-.]/g," ").replace(/\s+/g," "):""}async function Zi(){if(!Ot()){De("Excel is not available. Open this module inside Excel to run quality check.","info");return}ut.loading=!0,Ir(!0,"Analyzing data quality..."),Wr(document.getElementById("quality-save-btn"),!1);try{await Excel.run(async r=>{var g;let t=r.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(t.load("isNullObject"),await r.sync(),t.isNullObject)throw new Error("PTO_Data_Clean not found. Upload data in Step 1.");let a=t.getUsedRangeOrNullObject();a.load("values"),await r.sync();let n=a.isNullObject?[]:a.values||[];if(!n.length||n.length<2)throw new Error("PTO_Data_Clean is empty or has no data rows.");let i=(n[0]||[]).map(v=>ei(v));console.log("[Data Quality] PTO data headers:",n[0]);let s=i.findIndex(v=>v==="employee name"||v==="employeename");s===-1&&(s=i.findIndex(v=>v.includes("employee")&&v.includes("name"))),s===-1&&(s=i.findIndex(v=>v==="name"||v.includes("name")&&!v.includes("company")&&!v.includes("form"))),console.log("[Data Quality] Employee name column index:",s,"Header:",(g=n[0])==null?void 0:g[s]);let o=Fr(i,["balance"]),c=Fr(i,["accrual rate","accrualrate"]),l=Fr(i,["carry over","carryover"]),f=Fr(i,["ytd accrued","ytdaccrued"]),u=Fr(i,["ytd used","ytdused"]),d=[],h=[],m=[],p=n.slice(1);p.forEach((v,y)=>{let x=y+2,O=s!==-1?String(v[s]||"").trim():`Row ${x}`;if(!O)return;let I=o!==-1&&Number(v[o])||0,A=c!==-1&&Number(v[c])||0,k=l!==-1&&Number(v[l])||0,D=f!==-1&&Number(v[f])||0,N=u!==-1&&Number(v[u])||0,M=k+D;I<0?d.push({name:O,issue:`Negative balance: ${I.toFixed(2)} hrs`,rowIndex:x}):N>M&&M>0&&d.push({name:O,issue:`Used ${N.toFixed(0)} hrs but only ${M.toFixed(0)} available`,rowIndex:x}),I===0&&(k>0||D>0)&&h.push({name:O,rowIndex:x}),A>8&&m.push({name:O,accrualRate:A,rowIndex:x})}),ut.balanceIssues=d,ut.zeroBalances=h,ut.accrualOutliers=m,ut.totalIssues=d.length,ut.totalEmployees=p.filter(v=>v.some(y=>y!==null&&y!=="")).length,ut.hasRun=!0});let e=ut.balanceIssues.length>0;ti({stepStatuses:{3:e?"blocked":"complete"}})}catch(e){console.error("Data quality check error:",e),De(`Quality check failed: ${e.message}`,"error"),ut.hasRun=!1}finally{ut.loading=!1,Ir(!1),wt()}}function EE(){ut.acknowledged=!0,ti({stepStatuses:{3:"complete"}}),wt()}async function SE(){if(Ot())try{await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.warn("[Completeness] PTO_Data_Clean not found");return}let t=e.workbook.worksheets.getItemOrNullObject("PTO_Analysis"),a=r.getUsedRangeOrNullObject();if(a.load("values"),t.load("isNullObject"),await e.sync(),t.isNullObject){Ia.completenessCheck={accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null};return}let n=t.getUsedRangeOrNullObject();n.load("values"),await e.sync();let i=a.isNullObject?[]:a.values||[],s=n.isNullObject?[]:n.values||[];if(!i.length||!s.length){Ia.completenessCheck={accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null};return}let o=(f,u,d)=>{let h=(f[0]||[]).map(g=>ei(g)),m=Fr(h,u);return m===-1?null:f.slice(1).reduce((g,v)=>g+(Number(v[m])||0),0)},c=[{key:"accrualRate",aliases:["accrual rate","accrualrate"]},{key:"carryOver",aliases:["carry over","carryover","carry_over"]},{key:"ytdAccrued",aliases:["ytd accrued","ytdaccrued","ytd_accrued"]},{key:"ytdUsed",aliases:["ytd used","ytdused","ytd_used"]},{key:"balance",aliases:["balance"]}],l={};for(let f of c){let u=o(i,f.aliases,"PTO_Data_Clean"),d=o(s,f.aliases,"PTO_Analysis");if(u===null||d===null)l[f.key]=null;else{let h=Math.abs(u-d)<.01;l[f.key]={match:h,ptoDataClean:u,ptoAnalysis:d}}}Ia.completenessCheck=l})}catch(e){console.error("Completeness check failed:",e)}}async function au(){if(!Ot()){De("Excel is not available. Open this module inside Excel to run analysis.","info");return}Ir(!0,"Running analysis...");try{await SE(),Ia.cleanDataReady=!0,wt()}catch(e){console.error("Full analysis error:",e),De(`Analysis failed: ${e.message}`,"error")}finally{Ir(!1)}}async function vu(){if(!Ot()){De("Excel is not available. Open this module inside Excel to run journal checks.","info");return}Ze.loading=!0,Ze.lastError=null,Wr(document.getElementById("je-save-btn"),!1),wt();try{let e=await Excel.run(async r=>{let a=r.workbook.worksheets.getItem("PTO_JE_Draft").getUsedRangeOrNullObject();a.load("values");let n=r.workbook.worksheets.getItemOrNullObject("PTO_Analysis");n.load("isNullObject"),await r.sync();let i=a.isNullObject?[]:a.values||[];if(!i.length)throw new Error("PTO_JE_Draft is empty. Generate the JE first.");let s=(i[0]||[]).map(v=>ei(v)),o=Fr(s,["debits","debit"]),c=Fr(s,["credits","credit"]),l=Fr(s,["account name","accountname"]);if(o===-1||c===-1)throw new Error("Could not find Debits and Credits columns in PTO_JE_Draft.");let f=0,u=0,d=0;i.slice(1).forEach(v=>{let y=Number(v[o])||0,x=Number(v[c])||0,O=l!==-1?String(v[l]||"").trim().toLowerCase():"";f+=y,u+=x,O&&!O.includes("clearing")&&(d+=y-x)});let h=0;if(!n.isNullObject){let v=n.getUsedRangeOrNullObject();v.load("values"),await r.sync();let y=v.isNullObject?[]:v.values||[];if(y.length>1){let x=(y[0]||[]).map(I=>ei(I)),O=Fr(x,["change"]);O!==-1&&y.slice(1).forEach(I=>{h+=Number(I[O])||0})}}let m=f-u,p=[];Math.abs(m)>=.01?p.push({check:"Debits = Credits",passed:!1,detail:m>0?`Debits exceed credits by $${Math.abs(m).toLocaleString(void 0,{minimumFractionDigits:2})}`:`Credits exceed debits by $${Math.abs(m).toLocaleString(void 0,{minimumFractionDigits:2})}`}):p.push({check:"Debits = Credits",passed:!0,detail:""}),p.push({check:"Line Amounts Sum to Zero",passed:Math.abs(m)<.01,detail:Math.abs(m)<.01?"":`Difference: $${m.toFixed(2)}`});let g=Math.abs(d-h);return g>=.01?p.push({check:"JE Matches Analysis Total",passed:!1,detail:`JE expense total ($${d.toLocaleString(void 0,{minimumFractionDigits:2})}) differs from PTO_Analysis Change total ($${h.toLocaleString(void 0,{minimumFractionDigits:2})}) by $${g.toLocaleString(void 0,{minimumFractionDigits:2})}`}):p.push({check:"JE Matches Analysis Total",passed:!0,detail:""}),{debitTotal:f,creditTotal:u,difference:m,jeChangeTotal:d,analysisChangeTotal:h,issues:p,validationRun:!0}});Object.assign(Ze,e,{lastError:null})}catch(e){console.warn("PTO JE summary:",e),Ze.lastError=(e==null?void 0:e.message)||"Unable to calculate journal totals.",Ze.debitTotal=null,Ze.creditTotal=null,Ze.difference=null,Ze.jeChangeTotal=null,Ze.analysisChangeTotal=null,Ze.issues=[],Ze.validationRun=!1}finally{Ze.loading=!1,wt()}}var yu="PTO_Liability_Change",es="pto-accrual";function Zo(e){return String(e!=null?e:"").replace(/\u00a0/g," ").trim().toLowerCase().replace(/\s+/g," ").replace(/&/g,"and")}async function TE(e){console.log("[PTO-JE] Loading GL mappings for company:",e);try{let r=`${Qo}/rest/v1/ada_customer_gl_mappings?crm_company_id=eq.${e}&module=eq.${es}&pf_column_name=eq.${yu}&select=department,gl_account,gl_account_name`,t=await fetch(r,{headers:{apikey:nn,Authorization:`Bearer ${nn}`,"Content-Type":"application/json"}});if(!t.ok){let i=await t.text();throw new Error(`API error fetching GL mappings: ${t.status} - ${i}`)}let a=await t.json();console.log(`[PTO-JE] Fetched ${a.length} GL mapping rules`);let n=new Map;for(let i of a){let s=Zo(i.department);s&&n.set(s,{gl_account:i.gl_account,gl_account_name:i.gl_account_name||""})}return console.log(`[PTO-JE] Built ${n.size} department -> GL mappings`),n}catch(r){throw console.error("[PTO-JE] Error loading GL mappings:",r),r}}async function bE(){let e=new Map;if(!Ot())throw new Error("Excel runtime not available");return await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");if(t.load("isNullObject"),await r.sync(),t.isNullObject)throw new Error("PTO_Review sheet not found. Run Step 2 (PTO Accrual Review) first.");let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)throw new Error("PTO_Review is empty. Run Step 2 first.");let n=a.values[0].map(o=>String(o||"").toLowerCase().trim()),i=n.findIndex(o=>o==="department"),s=n.findIndex(o=>o==="change");if(i<0||s<0)throw new Error(`Required columns not found in PTO_Review. Found: ${n.join(", ")}`);for(let o=1;o<a.values.length;o++){let c=a.values[o],l=String(c[i]||"").trim(),f=parseFloat(c[s])||0;if(!l||Math.abs(f)<.01)continue;let u=e.get(l)||0;e.set(l,u+f)}await r.sync()}),console.log("[PTO-JE] Department totals:",Object.fromEntries(e)),e}async function CE(e,r,t){let a,n,i,s;typeof e=="object"&&e!==null&&!Array.isArray(e)&&e.userPrompt!==void 0?{systemPrompt:a,userPrompt:n,contextPack:i,functionContext:s}=e:(n=e,i=r,s="analysis");let o="https://jgciqwzwacaesqjaoadc.supabase.co/functions/v1/copilot",c="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE",l=Fe.crm_company_id;try{console.log("[Ada] Calling copilot API...",{module:es,function:s||"analysis",customerId:l?"set":"not set"});let f=await fetch(o,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`,apikey:c},body:JSON.stringify({prompt:n,context:i,module:es,function:s||"analysis",customerId:l,...a?{systemPrompt:a}:{}})});if(!f.ok){let d=await f.text();throw console.error("[Ada] API error:",f.status,d),new Error(`API request failed: ${f.status}`)}let u=await f.json();return console.log("[Ada] API response received:",u.usage||"no usage info"),u.message||u.response?u.message||u.response:(console.warn("[Ada] No message in API response, using local generation"),nu(params))}catch(f){return console.warn("[Ada] API call failed, using local generation:",f),nu(params)}}function nu(e){var n,i,s,o,c,l,f,u,d,h,m;let{userPrompt:r,contextPack:t}=e,a=(r||"").toLowerCase();return a.includes("diagnostic")||a.includes("check")?`**PTO Data Diagnostics:**

\u2713 **Data Completeness**: PTO file uploaded and processed successfully
\u2713 **Header Mapping**: All required columns identified and mapped
\u2713 **Rate Engine**: Pay rate calculations completed
\u2713 **Balance Calculations**: PTO balances computed for all employees

\u26A0\uFE0F **Potential Issues**:
\u2022 ${((n=t==null?void 0:t.summary)==null?void 0:n.missingRateCount)||0} employees missing pay rates
\u2022 Balance validation may be needed for large changes

**Next Steps:**
1. Review any missing pay rate warnings
2. Generate the accrual review table
3. Proceed to journal entry preparation`:a.includes("insight")||a.includes("analysis")?`**PTO Accrual Analysis:**

\u{1F4CA} **Key Metrics:**
\u2022 Total Current Liability: $${(((i=t==null?void 0:t.summary)==null?void 0:i.totalCurrent)||0).toLocaleString()}
\u2022 Total Prior Liability: $${(((s=t==null?void 0:t.summary)==null?void 0:s.totalPrior)||0).toLocaleString()}
\u2022 Net Change: $${(((o=t==null?void 0:t.summary)==null?void 0:o.netChange)||0).toLocaleString()}
\u2022 Active Employees: ${((c=t==null?void 0:t.summary)==null?void 0:c.employeeCount)||0}

\u{1F4A1} **Executive Insights:**
1. **Liability Trend**: ${(((l=t==null?void 0:t.summary)==null?void 0:l.netChange)||0)>=0?"Increasing":"Decreasing"} PTO liability
2. **Employee Coverage**: ${((f=t==null?void 0:t.summary)==null?void 0:f.employeeCount)||0} employees with PTO tracking
3. **Pay Rate Completeness**: ${(((u=t==null?void 0:t.summary)==null?void 0:u.missingRateCount)||0)===0?"Complete":"Missing rates for some employees"}

**Recommendations:**
\u2022 Review any employees with missing pay rates
\u2022 Monitor PTO liability trends quarter-over-quarter
\u2022 Ensure accurate employee headcount for future accruals`:`**PTO Analysis Assistant**

I can help you analyze your PTO accrual data. Try asking me about:

\u2022 **Diagnostics** - Check data quality and completeness
\u2022 **Insights** - Key findings and trends
\u2022 **Balances** - Employee PTO balance analysis
\u2022 **Accruals** - Liability calculation details

Your PTO data includes:
- ${((d=t==null?void 0:t.summary)==null?void 0:d.employeeCount)||0} employees
- Current liability: $${(((h=t==null?void 0:t.summary)==null?void 0:h.totalCurrent)||0).toLocaleString()}
- Net change: $${(((m=t==null?void 0:t.summary)==null?void 0:m.netChange)||0).toLocaleString()}

What would you like to explore?`}async function AE(){if(!Ot()){De("Excel is not available. Open this module inside Excel to create the journal entry.","info");return}Ir(!0,"Creating PTO Journal Entry...");try{let e=Fe.crm_company_id;if(!e)throw new Error("Company ID not found. Please check your installation configuration.");let r=At(we.journalEntryId)||"",t=At(we.payrollDate)||"";if(console.log(`
\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550`),console.log("PTO JOURNAL ENTRY GENERATION (QuickBooks Format)"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log(`  Company ID: ${e}`),console.log(`  JournalNo (PTO_Journal_Entry_ID): ${r}`),console.log(`  JournalDate (PTO_Payroll_Date): ${t}`),!r)throw new Error("Journal Entry ID not set. Please enter a Journal Entry ID in the Configuration step.");if(!t)throw new Error("Payroll Date not set. Please enter a Payroll Date in the Configuration step.");let a=t;try{let p;if(typeof t=="number"||/^\d{4,5}$/.test(String(t).trim())){let g=Number(t),v=new Date(1899,11,30);p=new Date(v.getTime()+g*24*60*60*1e3)}else p=new Date(t);if(!isNaN(p.getTime())&&p.getFullYear()>1970){let g=String(p.getMonth()+1).padStart(2,"0"),v=String(p.getDate()).padStart(2,"0"),y=p.getFullYear();a=`${g}/${v}/${y}`}}catch{console.warn("[PTO-JE] Could not parse date, using as-is:",t)}let n=await TE(e);if(console.log(`  GL Mappings loaded: ${n.size}`),n.size===0)throw new Error(`No GL mappings found for PTO_Liability_Change.

Please configure GL mappings in ada_customer_gl_mappings:
  - company_id: ${e}
  - module: ${es}
  - pf_column_name: ${yu}
  - department: (your department names)
  - gl_account: (expense account numbers)`);let i=await bE();if(console.log(`  Departments with changes: ${i.size}`),i.size===0)throw new Error(`No department totals found with non-zero changes.

Please run Step 2 (PTO Accrual Review) first to generate change data.`);let s=[];for(let[p]of i){let g=Zo(p);n.has(g)||s.push(p)}if(s.length>0)throw new Error(`Missing GL mappings for departments:
`+s.map(p=>`  \u2022 ${p}`).join(`
`)+`

Please add GL mappings for these departments in ada_customer_gl_mappings.`);let o=new Map;await Excel.run(async p=>{try{let g=p.workbook.worksheets.getItemOrNullObject("SS_Chart_of_Accounts");if(g.load("isNullObject"),await p.sync(),!g.isNullObject){let v=g.getUsedRangeOrNullObject();if(v.load("isNullObject"),await p.sync(),!v.isNullObject&&(v.load("values"),await p.sync(),v.values&&v.values.length>1)){let y=v.values[0],x=v.values.slice(1),O=y.findIndex(A=>{let k=String(A||"").toLowerCase().trim().replace(/[^a-z0-9]/g,"_");return k.includes("account")&&k.includes("num")||k==="account_number"||k==="number"}),I=y.findIndex(A=>{let k=String(A||"").toLowerCase().trim().replace(/[^a-z0-9]/g,"_");return k.includes("account")&&k.includes("name")||k==="account_name"||k==="name"});if(O>=0&&I>=0){for(let A of x){let k=String(A[O]||"").trim(),D=String(A[I]||"").trim();k&&o.set(k,D)}console.log(`  Chart of Accounts: ${o.size} accounts loaded`)}}}}catch(g){console.warn("[PTO-JE] Error reading SS_Chart_of_Accounts (non-fatal):",g.message)}});let c=["JournalNo","JournalDate","Account Name","Debits","Credits","Description"],l=[],f=0,u=0;for(let[p,g]of i){if(Math.abs(g)<.01)continue;let v=Zo(p),y=n.get(v),x=String(y.gl_account||"").trim(),O,I=o.get(x);I?O=`${x} ${I}`:y.gl_account_name?O=`${x} ${y.gl_account_name}`:O=x;let A=Math.abs(g),k=`${p}${p?" - ":""}PTO Liability Change`;g>0?(f+=A,l.push([r,a,O,A,"",k])):(u+=A,l.push([r,a,O,"",A,k]))}let d="21540 Accrued Expenses:Accrued PTO Liability",h=f-u;if(Math.abs(h)>=.01&&(h>0?(l.push([r,a,d,"",h,"Accrued PTO Liability"]),u+=h):(l.push([r,a,d,Math.abs(h),"","Accrued PTO Liability"]),f+=Math.abs(h))),Math.abs(f-u)>.01)throw new Error(`JE is out of balance!
  Total Debits: ${f.toFixed(2)}
  Total Credits: ${u.toFixed(2)}
  Difference: ${(f-u).toFixed(2)}

Cannot write unbalanced journal entry.`);console.log(`  JE Lines: ${l.length}`),console.log(`  Total Debits: $${f.toFixed(2)}`),console.log(`  Total Credits: $${u.toFixed(2)}`),console.log(`\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550
`),await Excel.run(async p=>{let g=p.workbook.worksheets.getItemOrNullObject("PTO_JE_Draft");if(g.load("isNullObject"),await p.sync(),g.isNullObject)g=p.workbook.worksheets.add("PTO_JE_Draft"),console.log("[PTO-JE] Created PTO_JE_Draft sheet");else{g.visibility=Excel.SheetVisibility.visible;let I=g.getUsedRangeOrNullObject();await p.sync(),I.isNullObject||I.clear(),console.log("[PTO-JE] Cleared existing PTO_JE_Draft")}let v=[c,...l],y=g.getRangeByIndexes(0,0,v.length,c.length);y.values=v;let x=g.getRangeByIndexes(0,0,1,c.length);Kn(x);let O=l.length;if(O>0){let I="$#,##0.00";g.getRangeByIndexes(1,3,O,1).numberFormat=[[I]],g.getRangeByIndexes(1,4,O,1).numberFormat=[[I]]}y.format.autofitColumns(),g.freezePanes.freezeRows(1),g.activate(),await p.sync()}),Ze.debitTotal=f,Ze.creditTotal=u,Ze.validationRun=!0,Ze.lastError=null,await vu(),De(`Journal Entry created: ${l.length} lines (including offset), $${f.toFixed(2)} balanced \u2713`,"success"),wt()}catch(e){console.error("[PTO-JE] Error:",e),Ze.lastError=e.message,De(`Unable to create Journal Entry: ${e.message}`,"error")}finally{Ir(!1)}}async function OE(){if(!Ot()){De("Excel is not available. Open this module inside Excel to export.","info");return}Ir(!0,"Preparing JE CSV...");try{let{rows:e}=await Excel.run(async o=>{let l=o.workbook.worksheets.getItem("PTO_JE_Draft").getUsedRangeOrNullObject();l.load("values"),await o.sync();let f=l.isNullObject?[]:l.values||[];if(!f.length)throw new Error("PTO_JE_Draft is empty.");return{rows:f}}),r=(e[0]||[]).map(o=>String(o||"").trim().toLowerCase()),t=r.findIndex(o=>o.includes("debit")),a=r.findIndex(o=>o.includes("credit")),n=r.findIndex(o=>o.includes("journaldate")||o.includes("txndate")||o==="date"),i=e.map((o,c)=>{if(c===0)return o;let l=[...o||[]],f=d=>{if(d===null||d==="")return"";let h=Number(d);return Number.isFinite(h)?h.toFixed(2):""},u=d=>{if(d===null||d==="")return"";if(typeof d=="string"&&/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(d.trim()))return d.trim();if(typeof d=="number"&&Number.isFinite(d)){let h=Math.round((d-25569)*86400*1e3),m=new Date(h);if(Number.isFinite(m.getTime())){let p=String(m.getMonth()+1).padStart(2,"0"),g=String(m.getDate()).padStart(2,"0"),v=m.getFullYear();if(v>=1900&&v<=2100)return`${p}/${g}/${v}`}}if(d instanceof Date&&Number.isFinite(d.getTime())){let h=String(d.getMonth()+1).padStart(2,"0"),m=String(d.getDate()).padStart(2,"0"),p=d.getFullYear();return`${h}/${m}/${p}`}return String(d)};return t>=0&&(l[t]=f(l[t])),a>=0&&(l[a]=f(l[a])),n>=0&&(l[n]=u(l[n])),l}),s=KE(i);JE(`pto-je-draft-${tc()}.csv`,s)}catch(e){console.error("PTO JE export:",e),De("Unable to export the JE draft. Confirm the sheet has data.","error")}finally{Ir(!1)}}async function wu(){let e=At(we.accountingSoftware)||At("SS_Accounting_Software");if(!e&&xt())try{let r=await ii(ca);e=r.SS_Accounting_Software||r.Accounting_Software||r[we.accountingSoftware]}catch(r){console.warn("Error reading accounting software URL:",r)}if(!e){De("No accounting software URL configured. Add SS_Accounting_Software to SS_PF_Config.","info",5e3);return}!e.startsWith("http://")&&!e.startsWith("https://")&&(e="https://"+e),window.open(e,"_blank"),De("Opening accounting software...","success",2e3)}function _u(e,r={}){return new Promise(t=>{let{title:a="Confirm",confirmText:n="Confirm",cancelText:i="Cancel",icon:s="\u{1F4E6}"}=r;document.querySelectorAll(".pf-confirm-dialog").forEach(c=>c.remove());let o=document.createElement("div");if(o.className="pf-confirm-dialog",o.innerHTML=`
            <div class="pf-confirm-backdrop"></div>
            <div class="pf-confirm-content">
                <div class="pf-confirm-icon">${s}</div>
                <div class="pf-confirm-title">${Se(a)}</div>
                <div class="pf-confirm-message">${Se(e).replace(/\n/g,"<br>")}</div>
                <div class="pf-confirm-buttons">
                    <button type="button" class="pf-confirm-btn pf-confirm-btn--cancel">${Se(i)}</button>
                    <button type="button" class="pf-confirm-btn pf-confirm-btn--confirm">${Se(n)}</button>
                </div>
            </div>
        `,!document.getElementById("pf-confirm-dialog-styles")){let c=document.createElement("style");c.id="pf-confirm-dialog-styles",c.textContent=`
                .pf-confirm-dialog { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 10001; display: flex; align-items: center; justify-content: center; }
                .pf-confirm-backdrop { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); }
                .pf-confirm-content { position: relative; background: linear-gradient(145deg, rgba(30, 30, 50, 1), rgba(20, 20, 35, 1)); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 16px; padding: 24px; max-width: 320px; text-align: center; box-shadow: 0 24px 64px rgba(0,0,0,0.5); }
                .pf-confirm-icon { font-size: 40px; margin-bottom: 12px; }
                .pf-confirm-title { font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 12px; }
                .pf-confirm-message { font-size: 13px; color: rgba(255,255,255,0.7); line-height: 1.5; margin-bottom: 20px; text-align: left; }
                .pf-confirm-buttons { display: flex; gap: 12px; justify-content: center; }
                .pf-confirm-btn { padding: 10px 20px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; border: none; transition: all 0.2s; }
                .pf-confirm-btn--cancel { background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); }
                .pf-confirm-btn--cancel:hover { background: rgba(255,255,255,0.15); }
                .pf-confirm-btn--confirm { background: linear-gradient(145deg, #6366f1, #4f46e5); color: white; }
                .pf-confirm-btn--confirm:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4); }
            `,document.head.appendChild(c)}document.body.appendChild(o),o.querySelector(".pf-confirm-btn--cancel").addEventListener("click",()=>{o.remove(),t(!1)}),o.querySelector(".pf-confirm-btn--confirm").addEventListener("click",()=>{o.remove(),t(!0)}),o.querySelector(".pf-confirm-backdrop").addEventListener("click",()=>{o.remove(),t(!1)})})}async function FE(){if(console.log("[Archive] archiveAndReset called"),!xt()){De("Excel not available currently","error");return}if(!await _u(`This will:

\u2022 Download an Excel archive file
\u2022 Update PTO_Archive_Summary
\u2022 Clear working data from all sheets
\u2022 Reset non-permanent notes & config

Make sure you've completed all review steps.`,{title:"Archive PTO Run",icon:"\u{1F4E6}",confirmText:"Archive Now",cancelText:"Not Yet"})){console.log("[PTOArchive] User cancelled"),De("Archive cancelled","info",2e3);return}console.log("[PTOArchive] User confirmed, starting archive process..."),Ir(!0,"Archiving PTO data...");try{if(console.log("[PTOArchive] Step 1: Creating archive workbook..."),!await IE()){console.log("[PTOArchive] Archive file creation failed");return}console.log("[PTOArchive] Step 1 complete: Archive file downloaded"),console.log("[PTOArchive] Step 2: Updating PTO_Archive_Summary...");let t=Xe.reviewData;if((!t||t.length===0)&&(t=await RE()),t&&t.length>0){let a=At(we.payrollDate)||new Date().toISOString().substring(0,10),n=await sE(t,a);console.log("[PTOArchive] Archive summary result:",n)}else console.warn("[PTOArchive] No review data to archive");console.log("[PTOArchive] Step 2 complete: Archive summary updated"),console.log("[PTOArchive] Step 3: Clearing working data..."),await PE(),console.log("[PTOArchive] Step 3 complete: Working data cleared"),console.log("[PTOArchive] Step 4: Clearing non-permanent config..."),await NE(),console.log("[PTOArchive] Step 4 complete: Config reset"),console.log("[PTOArchive] Archive workflow complete!"),Xe.loaded=!1,Xe.reviewData=[],Xe.totalCurrentLiability=0,Xe.totalPriorLiability=0,Xe.netChange=0,Xe.employeeCount=0,Vt.loaded=!1,Vt.rates.clear(),Ze.validationRun=!1,Ze.debitTotal=null,Ze.creditTotal=null,await hu(),wt(),DE()}catch(r){console.error("[PTOArchive] Error during archive:",r),De("Archive Error: "+r.message,"error",1e4)}finally{Ir(!1)}}async function IE(){try{let e=At(we.payrollDate)||new Date().toISOString().split("T")[0],r=At(we.accountingPeriod)||"",t=At(we.journalEntryId)||"",a=`PTO_Archive_${e}.xlsx`;return console.log("[PTOArchive] Creating Excel archive file..."),await Excel.run(async n=>{let s=n.workbook.worksheets;s.load("items/name"),await n.sync();let o=["PTO_JE_Draft","PTO_Review","PTO_Data_Clean"],c=Vr.book_new(),l=0,f=[];f.push(["PTO Accrual Archive Summary"]),f.push([]),f.push(["Archived At",new Date().toISOString()]),f.push(["Analysis Date",e]),f.push(["Accounting Period",r]),f.push(["Journal Entry ID",t]),f.push(["Company",Fe.ss_company_name||""]),f.push([]),f.push(["--- Liability Summary ---"]),f.push(["Current Period Liability",Xe.totalCurrentLiability||0]),f.push(["Prior Period Liability",Xe.totalPriorLiability||0]),f.push(["Net Change (JE Amount)",Xe.netChange||0]),f.push(["Employee Count",Xe.employeeCount||0]),f.push([]),f.push(["--- Step Sign-offs ---"]);let u=Gr(0);f.push(["Config Reviewer",(u==null?void 0:u.reviewer)||""]),f.push(["Config Sign-off",(u==null?void 0:u.signOffDate)||""]),f.push(["Config Notes",(u==null?void 0:u.notes)||""]),f.push([]);let d=Gr(1);f.push(["Import Reviewer",(d==null?void 0:d.reviewer)||""]),f.push(["Import Sign-off",(d==null?void 0:d.signOffDate)||""]),f.push(["Import Notes",(d==null?void 0:d.notes)||""]),f.push([]);let h=Gr(2);f.push(["Review Reviewer",(h==null?void 0:h.reviewer)||""]),f.push(["Review Sign-off",(h==null?void 0:h.signOffDate)||""]),f.push(["Review Notes",(h==null?void 0:h.notes)||""]),f.push([]);let m=Gr(3);f.push(["JE Reviewer",(m==null?void 0:m.reviewer)||""]),f.push(["JE Sign-off",(m==null?void 0:m.signOffDate)||""]),f.push(["JE Notes",(m==null?void 0:m.notes)||""]),f.push([]),f.push(["--- Archive Metadata ---"]),f.push(["Generated By","PTO Accrual Module"]),f.push(["Archive File",a]);let p=Vr.aoa_to_sheet(f);qi(p,[sa.extraWide,sa.description]),Vr.book_append_sheet(c,p,"Archive_Summary"),l++;for(let O of o){let I=s.items.find(k=>k.name===O);if(!I){console.log(`[PTOArchive] Sheet not found: ${O}`);continue}let A=I.getUsedRangeOrNullObject();if(A.load("values"),await n.sync(),!A.isNullObject&&A.values&&A.values.length>0){let k=Vr.aoa_to_sheet(A.values);if(A.values.length>0){let D=A.values[0],N=A.values.length;qf(k,D,N,{autoFormat:!0,autoSize:!0})}Vr.book_append_sheet(c,k,O),l++,console.log(`[PTOArchive] Added sheet: ${O} (${A.values.length} rows)`)}else console.log(`[PTOArchive] Sheet empty: ${O}`)}if(l<=1)return console.warn("[PTOArchive] No data sheets to archive"),De("No data to archive. Complete the PTO review first.","warning"),!1;let g=No(c,{bookType:"xlsx",type:"array"}),v=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=URL.createObjectURL(v),x=document.createElement("a");return x.setAttribute("href",y),x.setAttribute("download",a),x.style.visibility="hidden",document.body.appendChild(x),x.click(),document.body.removeChild(x),setTimeout(()=>URL.revokeObjectURL(y),100),console.log(`[PTOArchive] Downloaded: ${a} with ${l} sheets`),De(`\u{1F4E5} Archive downloaded: ${a} (${l} sheets)`,"success",5e3),!0})}catch(e){return console.error("[PTOArchive] Error creating archive:",e),De("Archive Export Error: "+e.message,"error",8e3),await _u(`Archive download failed.

Do you want to continue with clearing the data?

Make sure you have saved a backup first!`,{title:"Continue Without Archive?",icon:"\u26A0\uFE0F",confirmText:"Continue Anyway",cancelText:"Cancel"})}}async function RE(){let e=[];try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");if(t.load("isNullObject"),await r.sync(),t.isNullObject)return;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)return;let n=a.values[0].map(s=>String(s||"").toLowerCase().trim()),i={employeeName:n.findIndex(s=>s.includes("employee")),department:n.findIndex(s=>s==="department"),payRate:n.findIndex(s=>s.includes("pay")&&s.includes("rate")),accrualRate:n.findIndex(s=>s.includes("accrual")&&s.includes("rate")),carryOver:n.findIndex(s=>s.includes("carry")),ytdAccrued:n.findIndex(s=>s.includes("ytd")&&s.includes("accrued")),ytdUsed:n.findIndex(s=>s.includes("ytd")&&s.includes("used")),balance:n.findIndex(s=>s==="balance"),liabilityAmount:n.findIndex(s=>s.includes("liability")),priorLiability:n.findIndex(s=>s.includes("prior")),change:n.findIndex(s=>s==="change")};for(let s=1;s<a.values.length;s++){let o=a.values[s];e.push({employeeName:i.employeeName>=0?String(o[i.employeeName]||""):"",department:i.department>=0?String(o[i.department]||""):"",payRate:i.payRate>=0&&parseFloat(o[i.payRate])||0,accrualRate:i.accrualRate>=0&&parseFloat(o[i.accrualRate])||0,carryOver:i.carryOver>=0&&parseFloat(o[i.carryOver])||0,ytdAccrued:i.ytdAccrued>=0&&parseFloat(o[i.ytdAccrued])||0,ytdUsed:i.ytdUsed>=0&&parseFloat(o[i.ytdUsed])||0,balance:i.balance>=0&&parseFloat(o[i.balance])||0,liabilityAmount:i.liabilityAmount>=0&&parseFloat(o[i.liabilityAmount])||0})}await r.sync()})}catch(r){console.error("[PTOArchive] Error reading PTO_Review:",r)}return e}async function PE(){let e=["PTO_Data_Clean","PTO_Review","PTO_JE_Draft"];await Excel.run(async r=>{for(let t of e){let a=r.workbook.worksheets.getItemOrNullObject(t);if(a.load("isNullObject"),await r.sync(),a.isNullObject){console.log(`[PTOArchive] Sheet not found: ${t}`);continue}let n=a.getUsedRangeOrNullObject();if(n.load("rowCount,columnCount,address"),await r.sync(),n.isNullObject||n.rowCount<=1){console.log(`[PTOArchive] Sheet empty or headers only: ${t}`);continue}a.getRange(`A2:${String.fromCharCode(64+Math.min(n.columnCount,26))}${n.rowCount}`).clear(Excel.ClearApplyTo.contents),await r.sync(),console.log(`[PTOArchive] Cleared data from: ${t}`)}})}async function NE(){await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("SS_PF_Config");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.warn("[PTOArchive] SS_PF_Config sheet not found");return}let t=r.getUsedRangeOrNullObject();if(t.load("values,rowCount,columnCount"),await e.sync(),t.isNullObject||!t.values||t.values.length<2)return;let a=t.values[0].map(f=>String(f||"").toLowerCase().trim()),n=a.findIndex(f=>f==="field"||f==="setting"||f==="key"),i=a.findIndex(f=>f==="value"),s=a.findIndex(f=>f==="permanent"||f==="persist");if(n<0||i<0){console.warn("[PTOArchive] Could not find field/value columns in config");return}let o=[we.payrollDate,we.accountingPeriod,we.journalEntryId],c=t.values.map((f,u)=>{if(u===0)return f;let d=String(f[n]||"").trim(),h=s>=0&&String(f[s]||"").toUpperCase()==="Y";if(o.includes(d)&&!h){let m=[...f];return m[i]="",m}return f}),l=r.getRangeByIndexes(0,0,c.length,a.length);l.values=c,await e.sync(),console.log("[PTOArchive] Non-permanent config values cleared")})}function DE(){document.querySelectorAll(".pf-save-prompt").forEach(t=>t.remove());let e=document.createElement("div");if(e.className="pf-save-prompt",e.innerHTML=`
        <div class="pf-save-prompt-content">
            <div class="pf-save-prompt-title">Good work!</div>
            <div class="pf-save-prompt-subtitle">Ready to finalize?</div>
            <button type="button" class="pf-save-prompt-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
                Finalize
            </button>
        </div>
    `,!document.getElementById("pf-save-prompt-styles")){let t=document.createElement("style");t.id="pf-save-prompt-styles",t.textContent=`
            .pf-save-prompt {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(145deg, rgba(30, 30, 50, 0.98), rgba(20, 20, 35, 0.99));
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 32px 40px;
                border-radius: 20px;
                box-shadow: 
                    0 24px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 60px rgba(99, 102, 241, 0.1);
                z-index: 10002;
                text-align: center;
                animation: pf-prompt-fade-in 0.3s ease;
            }
            @keyframes pf-prompt-fade-in {
                from { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
                to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            }
            .pf-save-prompt-content {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            .pf-save-prompt-title {
                font-size: 20px;
                font-weight: 700;
                color: #fff;
            }
            .pf-save-prompt-subtitle {
                font-size: 14px;
                color: rgba(255, 255, 255, 0.6);
                margin-bottom: 12px;
            }
            .pf-save-prompt-btn {
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border: none;
                color: white;
                padding: 16px 40px;
                border-radius: 12px;
                font-size: 18px;
                font-weight: 700;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
                transition: all 0.2s ease;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4), 0 0 0 2px rgba(99, 102, 241, 0.2);
                margin-top: 8px;
            }
            .pf-save-prompt-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 12px 32px rgba(99, 102, 241, 0.5), 0 0 0 2px rgba(99, 102, 241, 0.3);
                background: linear-gradient(145deg, #7c3aed, #6366f1);
            }
            .pf-save-prompt-btn:active {
                transform: translateY(-1px);
            }
            .pf-save-prompt.closing {
                animation: pf-prompt-fade-out 0.2s ease forwards;
            }
            @keyframes pf-prompt-fade-out {
                to { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
            }
        `,document.head.appendChild(t)}document.body.appendChild(e),e.querySelector(".pf-save-prompt-btn").addEventListener("click",()=>{e.classList.add("closing"),setTimeout(()=>{e.remove(),LE()},200)})}function LE(){document.querySelectorAll(".pf-toast, .pf-success-toast").forEach(n=>n.remove());let e=[{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"/></svg>',title:"Done.",subtitle:"Efficiency unlocked."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"/><path d="m9 12 2 2 4-4"/></svg>',title:"Locked in.",subtitle:"You're good to go."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><path d="M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z"/><path d="M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z"/></svg>',title:"Stored.",subtitle:"Everything stays aligned."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>',title:"PTO archived.",subtitle:"Flow restored."}],r=e[Math.floor(Math.random()*e.length)],t=document.createElement("div");if(t.className="pf-success-toast",t.innerHTML=`
        <div class="pf-success-toast-icon">${r.icon}</div>
        <div class="pf-success-toast-text">
            <div class="pf-success-toast-title">${r.title}</div>
            <div class="pf-success-toast-subtitle">${r.subtitle}</div>
        </div>
        <div class="pf-success-toast-progress"></div>
    `,!document.getElementById("pf-success-toast-styles")){let n=document.createElement("style");n.id="pf-success-toast-styles",n.textContent=`
            .pf-success-toast {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(145deg, rgba(30, 30, 50, 0.98), rgba(20, 20, 35, 0.99));
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 36px 48px 24px;
                border-radius: 24px;
                box-shadow: 
                    0 32px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 80px rgba(99, 102, 241, 0.15);
                z-index: 10002;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 16px;
                animation: pf-success-in 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                overflow: hidden;
                text-align: center;
                min-width: 220px;
            }
            @keyframes pf-success-in {
                from { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.9);
                }
                to { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
            }
            @keyframes pf-success-out {
                from { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
                to { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.95) translateY(-20px);
                }
            }
            .pf-success-toast-icon {
                width: 64px;
                height: 64px;
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border-radius: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
                animation: pf-icon-pulse 2s ease-in-out infinite;
            }
            @keyframes pf-icon-pulse {
                0%, 100% { box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4); }
                50% { box-shadow: 0 8px 32px rgba(99, 102, 241, 0.6); }
            }
            .pf-success-toast-text {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
            }
            .pf-success-toast-title {
                font-size: 22px;
                font-weight: 700;
                color: #fff;
                letter-spacing: -0.5px;
            }
            .pf-success-toast-subtitle {
                font-size: 15px;
                color: rgba(255, 255, 255, 0.6);
                font-weight: 500;
            }
            .pf-success-toast-progress {
                position: absolute;
                bottom: 0;
                left: 0;
                height: 4px;
                background: linear-gradient(90deg, #6366f1, #a855f7, #6366f1);
                background-size: 200% 100%;
                animation: pf-progress-shrink 5s linear forwards, pf-progress-shimmer 1s linear infinite;
                border-radius: 0 0 24px 24px;
            }
            @keyframes pf-progress-shrink {
                from { width: 100%; }
                to { width: 0%; }
            }
            @keyframes pf-progress-shimmer {
                from { background-position: 200% 0; }
                to { background-position: -200% 0; }
            }
            .pf-success-toast.closing {
                animation: pf-success-out 0.3s ease forwards;
            }
            .pf-success-backdrop {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.4);
                backdrop-filter: blur(4px);
                -webkit-backdrop-filter: blur(4px);
                z-index: 10001;
                animation: pf-confirm-fade-in 0.2s ease;
            }
        `,document.head.appendChild(n)}let a=document.createElement("div");a.className="pf-success-backdrop",document.body.appendChild(a),document.body.appendChild(t),setTimeout(()=>{t.classList.add("closing"),a.style.opacity="0",a.style.transition="opacity 0.3s ease",setTimeout(()=>{t.remove(),a.remove(),BE()},300)},5e3)}async function BE(){try{await si("module-selector")}catch(e){console.warn("[PTO] Could not apply module-selector tab visibility before redirect:",e)}window.location.href="../module-selector/index.html"}async function ME(e){if(!(!e||!Ot()))try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItem(e);t.activate(),t.getRange("A1").select(),await r.sync()})}catch(r){console.error(r)}}function At(e){var t,a;let r=String(e!=null?e:"").trim();return(a=(t=Ce.values)==null?void 0:t[r])!=null?a:""}function ri(e){var t;if(e)return e;let r=At(we.reviewerName);if(r)return r;if((t=window.PrairieForge)!=null&&t._sharedConfigCache){let a=window.PrairieForge._sharedConfigCache.get("SS_Default_Reviewer")||window.PrairieForge._sharedConfigCache.get("Default_Reviewer");if(a)return a}return""}function Or(e,r,t={}){var s;let a=String(e!=null?e:"").trim();if(!a)return;Ce.values[a]=r!=null?r:"";let n=(s=t.debounceMs)!=null?s:0;if(!n){let o=an.get(a);o&&clearTimeout(o),an.delete(a),un(a,r!=null?r:"",ca);return}an.has(a)&&clearTimeout(an.get(a));let i=setTimeout(()=>{an.delete(a),un(a,r!=null?r:"",ca)},n);an.set(a,i)}function ei(e){return String(e!=null?e:"").trim().toLowerCase()}function Ir(e,r="Working..."){let t=document.getElementById(_k);t&&(t.style.display="none")}function qo(){Ck()}typeof Office!="undefined"&&Office.onReady?Office.onReady(()=>qo()).catch(()=>qo()):qo();function Gr(e){return Ce.steps[e]||{notes:"",reviewer:"",signOffDate:""}}function ku(e){return ts[e]||{}}function UE(e){return e===0?"config":e===1?"upload":e===2?"review":e===3?"journal":e===4?"archive":""}async function hr(e,r,t){let a=Ce.steps[e]||{notes:"",reviewer:"",signOffDate:""};a[r]=t,Ce.steps[e]=a;let n=ku(e),i=r==="notes"?n.note:r==="reviewer"?n.reviewer:n.signOff;if(i&&xt())try{await un(i,t,ca)}catch(s){console.warn("PTO: unable to save field",i,s)}}async function Eu(e,r){Ce.permanents[e]=r;let t=ku(e);if(t!=null&&t.note&&xt())try{await Excel.run(async a=>{var d;let n=a.workbook.tables.getItemOrNullObject(ca[0]);if(await a.sync(),n.isNullObject)return;let i=n.getDataBodyRange(),s=n.getHeaderRowRange();i.load("values"),s.load("values"),await a.sync();let o=s.values[0]||[],c=o.map(h=>String(h||"").trim().toLowerCase()),l={field:c.findIndex(h=>h==="field"||h==="field name"||h==="setting"),permanent:c.findIndex(h=>h==="permanent"||h==="persist"),value:c.findIndex(h=>h==="value"||h==="setting value"),type:c.findIndex(h=>h==="type"||h==="category"),title:c.findIndex(h=>h==="title"||h==="display name")};if(l.field===-1)return;let u=(i.values||[]).findIndex(h=>String(h[l.field]||"").trim()===t.note);if(u>=0)l.permanent>=0&&(i.getCell(u,l.permanent).values=[[r?"Y":"N"]]);else{let h=new Array(o.length).fill("");l.type>=0&&(h[l.type]="Other"),l.title>=0&&(h[l.title]=""),h[l.field]=t.note,l.permanent>=0&&(h[l.permanent]=r?"Y":"N"),l.value>=0&&(h[l.value]=((d=Ce.steps[e])==null?void 0:d.notes)||""),n.rows.add(null,[h])}await a.sync()})}catch(a){console.warn("PTO: unable to update permanent flag",a)}}async function Su(e,r){let t=du[e];if(t&&(Ce.completes[e]=r?"Y":"",!!xt()))try{await un(t,r?"Y":"",ca)}catch(a){console.warn("PTO: unable to save completion flag",t,a)}}function iu(e,r){e&&(e.classList.toggle("is-active",r),e.setAttribute("aria-pressed",String(r)))}function $E(){let e={};return Object.keys(ts).forEach(r=>{var i;let t=parseInt(r,10),a=!!((i=Ce.steps[t])!=null&&i.signOffDate),n=!!Ce.completes[t];e[t]=a||n}),e}function Tu(e,{buttonId:r,inputId:t,canActivate:a=null,onComplete:n=null}){var c;let i=document.getElementById(r);if(!i)return;let s=document.getElementById(t),o=!!((c=Ce.steps[e])!=null&&c.signOffDate)||!!Ce.completes[e];iu(i,o),i.addEventListener("click",()=>{if(!i.classList.contains("is-active")&&e>0){let u=$E(),{canComplete:d,message:h}=zf(e,u);if(!d){Xf(h);return}}if(typeof a=="function"&&!a())return;let f=!i.classList.contains("is-active");iu(i,f),s&&(s.value=f?tc():"",hr(e,"signOffDate",s.value)),Su(e,f),f&&window.scrollTo({top:0,behavior:"smooth"}),f&&typeof n=="function"&&n()})}function Se(e){return String(e!=null?e:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function bu(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="true"||r==="y"||r==="yes"||r==="1"}function as(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="true"||r==="y"||r==="yes"||r==="1"}function ec(e){if(!e)return null;let r=/^(\d{4})-(\d{2})-(\d{2})$/.exec(String(e));if(!r)return null;let t=Number(r[1]),a=Number(r[2]),n=Number(r[3]);return!t||!a||!n?null:{year:t,month:a,day:n}}function su(e){if(!e)return"";let r=ec(e);if(!r)return"";let{year:t,month:a,day:n}=r;return`${t}-${String(a).padStart(2,"0")}-${String(n).padStart(2,"0")}`}function jE(e){let r=ec(e);return r?`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.month-1]} ${r.year}`:""}function HE(e){let r=ec(e);return r?`PTO-AUTO-${r.year}-${String(r.month).padStart(2,"0")}-${String(r.day).padStart(2,"0")}`:""}function tc(){let e=new Date,r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`}function VE(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="y"||r==="yes"||r==="true"||r==="t"||r==="1"}function WE(){let e=t=>{var a,n;return((n=(a=document.getElementById(t))==null?void 0:a.value)==null?void 0:n.trim())||""};[{id:"config-payroll-date",field:we.payrollDate},{id:"config-accounting-period",field:we.accountingPeriod},{id:"config-journal-id",field:we.journalEntryId},{id:"config-company-name",field:we.companyName},{id:"config-payroll-provider",field:we.payrollProvider},{id:"config-accounting-link",field:we.accountingSoftware},{id:"config-user-name",field:we.reviewerName}].forEach(({id:t,field:a})=>{let n=e(t);a&&Or(a,n)})}function Fr(e,r=[]){let t=r.map(a=>ei(a));return e.findIndex(a=>t.some(n=>a.includes(n)))}function GE(e){let r=Gr(2),t=!!Ce.permanents[2],a=ri(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(as(Ce.completes[2])||n),s=Xe||{},o=s.reconciliation||{},c=s.coverage||{},l=s.totalPriorLiability||0,f=s.employeeCount||0,u=o.reportLiabilityTotal||0,d=o.calcLiabilityTotal||0,h=o.negativeBalanceTotal||0,m=o.negativeBalanceCount||0,p=o.missingRateCount||0,g=d-l,v=O=>(Number(O)||0).toLocaleString("en-US",{style:"currency",currency:"USD"}),x=`
        <article class="pf-step-card pf-step-detail pf-config-card">
            <div class="pf-config-head">
                <h3>PTO Liability Reconciliation</h3>
                <p class="pf-config-subtext">Report \u2192 Adjustments \u2192 JE Amount</p>
            </div>
            
            ${s.loaded&&f>0?`
            <!-- Liability Reconciliation Section -->
            <div class="pf-liability-recon" style="margin-top: 16px; padding: 16px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.7);">Report Liability (PrismHR)</span>
                    <span style="font-weight: 600; color: #fff;">${v(u)}</span>
                </div>
                
                ${m>0?`
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; padding-left: 20px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">Negative Balances (${m} employees)</span>
                    <span style="color: #f87171; font-size: 13px;">${v(h)}</span>
                </div>
                `:""}
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-top: 2px solid rgba(255,255,255,0.2); margin-top: 4px;">
                    <span style="font-weight: 600; color: #fff;">Calculated Liability</span>
                    <span style="font-weight: 600; color: #fff;">${v(d)}</span>
                </div>
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.5);">Prior Period Liability</span>
                    <span style="color: rgba(255,255,255,0.7);">${v(l)}</span>
                </div>
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-top: 2px solid rgba(255,255,255,0.2); margin-top: 4px;">
                    <span style="font-weight: 600; color: #fff;">Net Change (for JE)</span>
                    <span style="font-weight: 700; font-size: 18px; color: ${g>=0?"#4ade80":"#f87171"};">
                        ${g>=0?"+":""}${v(g)}
                    </span>
                    </div>
                </div>
            
            <!-- Employee Coverage Section -->
            <div class="pf-coverage-section" style="margin-top: 16px; padding: 16px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                <h4 style="margin: 0 0 12px 0; font-size: 14px; color: rgba(255,255,255,0.8);">Employee Coverage</h4>
                
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0;">
                    <span style="color: rgba(255,255,255,0.6);">Roster Headcount:</span>
                    <span style="color: #fff;">${c.rosterCount||0}</span>
                </div>
                
                ${c.inPtoOnlyCount>0?`
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0; padding-left: 20px;">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">+ In PTO only (not on roster):</span>
                    <span style="color: rgba(255,255,255,0.7); font-size: 13px;">+${c.inPtoOnlyCount}</span>
            </div>
                <div style="padding-left: 40px; font-size: 12px; color: rgba(255,255,255,0.4);">
                    (Liability: ${v(c.inPtoOnlyLiability||0)})
                </div>
                `:""}
                
                ${c.inRosterOnlyCount>0?`
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0; padding-left: 20px;">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">\u2212 On roster, not in PTO:</span>
                    <span style="color: rgba(255,255,255,0.7); font-size: 13px;">\u2212${c.inRosterOnlyCount}</span>
                </div>
                `:""}
                
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-top: 1px solid rgba(255,255,255,0.15); margin-top: 8px;">
                    <span style="font-weight: 600; color: #fff;">PTO Report Headcount:</span>
                    <span style="font-weight: 600; color: #fff;">${f}</span>
                </div>
            </div>
            `:`
            <div style="margin-top: 16px; padding: 20px; text-align: center; color: rgba(255,255,255,0.5);">
                <p>Click "Generate" to calculate liability reconciliation</p>
            </div>
            `}
            
            ${p>0?`
                <div style="margin-top: 12px; padding: 10px; background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 8px; font-size: 13px;">
                    <strong style="color: #fbbf24;">${p}</strong> employee(s) missing pay rate
                </div>
            `:""}
        </article>
    `;return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(Ra)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${Se(e.title)}</h2>
            <p class="pf-hero-copy">${Se(e.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Generate Review</h3>
                    <p class="pf-config-subtext">Calculate liabilities, load prior period, and compute variance.</p>
                </div>
                <div class="pf-signoff-action">
                    ${dr(`<button type="button" class="pf-action-toggle pf-clickable" id="review-generate-btn" title="Generate PTO review table">${jf}</button>`,"Generate")}
                    ${dr(`<button type="button" class="pf-action-toggle pf-clickable" id="review-open-btn" title="Open PTO_Review sheet">${Mo}</button>`,"Open Sheet")}
                </div>
            </article>
            ${x}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-ada-card" id="review-ada-btn" title="Ask Ada about PTO data">
                    <img src="${Pa.ADA_IMAGE_URL}" alt="Ada" class="pf-ada-icon" onerror="this.style.display='none'" />
                    <div class="pf-button-label">Ask Ada</div>
                </div>
            </article>
            ${tn({textareaId:"step-notes-2",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-2",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-2"})}
            ${rn({reviewerInputId:"step-reviewer-2",reviewerValue:a,signoffInputId:"step-signoff-2",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-2",completeButtonId:"step-signoff-toggle-2"})}
        </section>
    `}function zE(e){let r=Gr(3),t=!!Ce.permanents[3],a=ri(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(as(Ce.completes[3])||n),s=Ze.lastError?`<p class="pf-step-note">${Se(Ze.lastError)}</p>`:"",o=Ze.validationRun,c=Ze.issues||[],l=[{key:"Debits = Credits",desc:"\u2211 Debits = \u2211 Credits"},{key:"Line Amounts Sum to Zero",desc:"\u2211 Line Amount = $0.00"},{key:"JE Matches Analysis Total",desc:"\u2211 JE expense = \u2211 PTO_Analysis Change"}],f=m=>{let p=c.find(y=>y.check===m.key),g=!o,v;return g?v='<span class="pf-je-check-circle pf-je-circle--pending"></span>':p!=null&&p.passed?v=`<span class="pf-je-check-circle pf-je-circle--pass">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </span>`:v=`<span class="pf-je-check-circle pf-je-circle--fail">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </span>`,`
            <div class="pf-je-check-row">
                ${v}
                <span class="pf-je-check-desc-pill">${Se(m.desc)}</span>
            </div>
        `},u=l.map(m=>f(m)).join(""),d=c.filter(m=>!m.passed),h="";return o&&d.length>0&&(h=`
            <article class="pf-step-card pf-step-detail pf-je-issues-card">
                <div class="pf-config-head">
                    <h3>\u26A0\uFE0F Issues Identified</h3>
                    <p class="pf-config-subtext">The following checks did not pass:</p>
                </div>
                <ul class="pf-je-issues-list">
                    ${d.map(m=>`<li><strong>${Se(m.check)}:</strong> ${Se(m.detail)}</li>`).join("")}
                </ul>
            </article>
        `),`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${Se(Ra)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${Se(e.title)}</h2>
            <p class="pf-hero-copy">${Se(e.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Generate Journal Entry</h3>
                    <p class="pf-config-subtext">Create a balanced JE from your imported PTO data, grouped by department.</p>
                </div>
                <div class="pf-signoff-action">
                    ${dr(`<button type="button" class="pf-action-toggle pf-clickable" id="je-create-btn" title="Generate journal entry from PTO_Analysis">${Mo}</button>`,"Generate")}
                    ${dr(`<button type="button" class="pf-action-toggle pf-clickable" id="je-run-btn" title="Refresh validation checks">${Xi}</button>`,"Refresh")}
                    ${dr(`<button type="button" class="pf-action-toggle pf-clickable" id="je-export-btn" title="Export journal draft as CSV">${Hf}</button>`,"Export")}
                    ${dr(`<button type="button" class="pf-action-toggle pf-clickable" id="je-upload-btn" title="Open accounting software upload">${jo}</button>`,"Upload")}
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Validation Checks</h3>
                    <p class="pf-config-subtext">These checks run automatically after generating your JE.</p>
                </div>
                ${s}
                <div class="pf-je-checks-container">
                    ${u}
                </div>
            </article>
            ${h}
            ${tn({textareaId:"step-notes-3",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-3",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-3"})}
            ${rn({reviewerInputId:"step-reviewer-3",reviewerValue:a,signoffInputId:"step-signoff-3",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-3",completeButtonId:"step-signoff-toggle-3"})}
        </section>
    `}function XE(){var r,t;return Math.abs((t=(r=Ne.roster)==null?void 0:r.difference)!=null?t:0)>0}function YE(){return!Ne.skipAnalysis&&XE()}async function Qn(){if(!xt()){Ne.loading=!1,Ne.lastError="Excel runtime is unavailable.",wt();return}Ne.loading=!0,Ne.lastError=null,Wr(document.getElementById("headcount-save-btn"),!1),wt();try{let e=await Excel.run(async r=>{let t=r.workbook.worksheets.getItem("SS_Employee_Roster"),a=r.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(a.load("isNullObject"),await r.sync(),a.isNullObject)return console.warn("[Headcount] PTO_Data_Clean not found"),{rosterEmployees:[],ptoEmployees:[],missingFromPto:[],extraInPto:[]};let n=r.workbook.worksheets.getItemOrNullObject("PTO_Analysis"),i=t.getUsedRangeOrNullObject(),s=a.getUsedRangeOrNullObject();i.load("values"),s.load("values"),n.load("isNullObject"),await r.sync();let o=null;n.isNullObject||(o=n.getUsedRangeOrNullObject(),o.load("values")),await r.sync();let c=i.isNullObject?[]:i.values||[],l=s.isNullObject?[]:s.values||[],f=o&&!o.isNullObject?o.values||[]:[],u=f.length?f:l;return qE(c,u)});Ne.rosterCount=e.rosterCount,Ne.ptoCount=e.ptoCount,Ne.missingFromPto=e.missingFromPto,Ne.extraInPto=e.extraInPto,Ne.roster=e.roster,Ne.hasAnalyzed=!0,Ne.lastError=null}catch(e){console.warn("PTO headcount: unable to analyze data",e),Ne.lastError="Unable to analyze headcount data. Try re-running the analysis."}finally{Ne.loading=!1,wt()}}function ou(e){if(!e)return!0;let r=e.toLowerCase().trim();return r?["total","subtotal","sum","count","grand","average","avg"].some(a=>r.includes(a)):!0}function qE(e,r){let t={rosterCount:0,ptoCount:0,missingFromPto:[],extraInPto:[],roster:{rosterCount:0,payrollCount:0,difference:0,mismatches:[]}};if(((e==null?void 0:e.length)||0)<2||((r==null?void 0:r.length)||0)<2)return console.warn("Headcount: insufficient data rows",{rosterRows:(e==null?void 0:e.length)||0,payrollRows:(r==null?void 0:r.length)||0}),t;let a=cu(e),n=cu(r),i=a.headers,s=n.headers,o={employee:lu(i),department:i.findIndex(u=>u.includes("department")),status:i.findIndex(u=>u==="employment_status"||u==="status"),termination:i.findIndex(u=>u.includes("termination"))},c={employee:lu(s)};console.log("Headcount column detection:",{rosterEmployeeCol:o.employee,rosterDeptCol:o.department,rosterStatusCol:o.status,rosterTerminationCol:o.termination,payrollEmployeeCol:c.employee,rosterHeaders:i.slice(0,5),payrollHeaders:s.slice(0,5)});let l=new Map;for(let u=a.startIndex;u<e.length;u+=1){let d=e[u],h=o.employee>=0?Oa(d[o.employee]):"";if(ou(h))continue;if(o.status>=0){let p=Oa(d[o.status]).toLowerCase();if(p==="terminated"||p==="inactive"||p==="term")continue}if(o.termination>=0&&Oa(d[o.termination]))continue;let m=h.toLowerCase();l.has(m)||l.set(m,{name:h,department:o.department>=0?Oa(d[o.department]):""})}let f=new Map;for(let u=n.startIndex;u<r.length;u+=1){let d=r[u],h=c.employee>=0?Oa(d[c.employee]):"";if(ou(h))continue;let m=h.toLowerCase();f.has(m)||f.set(m,{name:h})}return t.rosterCount=l.size,t.ptoCount=f.size,l.forEach((u,d)=>{f.has(d)||t.missingFromPto.push({name:u.name,department:u.department||"\u2014"})}),f.forEach((u,d)=>{l.has(d)||t.extraInPto.push({name:u.name})}),console.log("Headcount results:",{rosterCount:t.rosterCount,ptoCount:t.ptoCount,missingFromPto:t.missingFromPto.length,extraInPto:t.extraInPto.length}),t.roster.rosterCount=t.rosterCount,t.roster.payrollCount=t.ptoCount,t.roster.difference=t.ptoCount-t.rosterCount,t.roster.mismatches=[...t.missingFromPto.map(u=>`In roster, missing in PTO_Data_Clean: ${u.name}`),...t.extraInPto.map(u=>`In PTO_Data_Clean, missing in roster: ${u.name}`)],t}function cu(e){if(!Array.isArray(e)||!e.length)return{headers:[],startIndex:1};let r=e.findIndex((n=[])=>n.some(i=>Oa(i).toLowerCase().includes("employee"))),t=r===-1?0:r;return{headers:(e[t]||[]).map(n=>Oa(n).toLowerCase()),startIndex:t+1}}function lu(e=[]){let r=-1,t=-1;return e.forEach((a,n)=>{let i=a.toLowerCase();if(!i.includes("employee"))return;let s=1;i.includes("name")?s=4:i.includes("id")?s=2:s=3,s>t&&(t=s,r=n)}),r}function Oa(e){return e==null?"":String(e).trim()}function KE(e=[]){return e.map(r=>(r||[]).map(t=>{if(t==null)return"";let a=String(t);return/[",\n]/.test(a)?`"${a.replace(/"/g,'""')}"`:a}).join(",")).join(`
`)}function JE(e,r){let t=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=e,document.body.appendChild(n),n.click(),n.remove(),setTimeout(()=>URL.revokeObjectURL(a),1e3)}function fu(){let e=document.getElementById("headcount-signoff-toggle");if(!e)return;let r=YE(),t=document.getElementById("step-notes-input"),a=(t==null?void 0:t.value.trim())||"";e.disabled=r&&!a;let n=document.getElementById("headcount-notes-hint");n&&(n.textContent=r?"Please document outstanding differences before signing off.":"")}function uu(){let e=document.getElementById("step-notes-input");if(!e)return;let r=e.value||"",t=r.startsWith(Fa)?r.slice(Fa.length).replace(/^\s+/,""):r.replace(new RegExp(`^${Fa}\\s*`,"i"),"").trimStart(),a=Fa+(t?`
${t}`:"");e.value!==a&&(e.value=a),hr(2,"notes",e.value)}function ZE(){let e=document.getElementById("step-notes-input");e&&e.addEventListener("input",()=>{if(!Ne.skipAnalysis)return;let r=e.value||"";if(!r.startsWith(Fa)){let t=r.replace(Fa,"").trimStart();e.value=Fa+(t?`
${t}`:"")}hr(2,"notes",e.value)})}})();
/*! Bundled license information:

xlsx/xlsx.mjs:
  (*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com *)

xlsx/xlsx.mjs:
  (*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com *)
*/
//# sourceMappingURL=app.bundle.js.map
