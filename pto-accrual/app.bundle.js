/* Prairie Forge PTO Accrual */
(()=>{var Mu=Object.defineProperty;var ac=(e,r)=>()=>(e&&(r=e(e=0)),r);var Uu=(e,r)=>{for(var t in r)Mu(e,t,{get:r[t],enumerable:!0})};var ii,ss=ac(()=>{ii={COMPANY_NAME:"Prairie Forge LLC",PRODUCT_NAME:"Prairie Forge Tools",SUPPORT_URL:"https://prairieforge.ai/support",ADA_IMAGE_URL:"https://assets.prairieforge.ai/storage/v1/object/public/Other%20Public%20Material/Prairie%20Forge/Ada%20Image.png"}});var oc={};Uu(oc,{DEFAULT_OPTIONS:()=>cs,bindCopilotCard:()=>fs,createExcelContextProvider:()=>si,renderCopilotCard:()=>ls});function ls(e={}){var a;let r={...cs,...e},t=((a=r.quickActions)==null?void 0:a.map(n=>`<button type="button" class="pf-ada-chip" data-action="${n.id}" data-prompt="${ed(n.prompt)}">${n.label}</button>`).join(""))||"";return`
        <article class="pf-ada" data-copilot="${r.id}">
            <header class="pf-ada-header">
                <div class="pf-ada-identity">
                    <img class="pf-ada-avatar" src="${Qu}" alt="Ada" onerror="this.style.display='none'" />
                    <div class="pf-ada-name">
                        <span class="pf-ada-title"><span class="pf-ada-title--ask">ask</span><span class="pf-ada-title--ada">ADA</span></span>
                        <span class="pf-ada-role">${r.subtext}</span>
                    </div>
                </div>
                <div class="pf-ada-header-right">
                    <span class="pf-ada-beta-tag">BETA</span>
                    <div class="pf-ada-status" id="${r.id}-status-badge" title="Ready">
                        <span class="pf-ada-status-dot" id="${r.id}-status-dot"></span>
                    </div>
                </div>
            </header>
            
            <div class="pf-ada-body">
                <div class="pf-ada-conversation" id="${r.id}-messages">
                    <div class="pf-ada-bubble pf-ada-bubble--ai">
                        <p>${r.welcomeMessage}</p>
                    </div>
                </div>
                
                <div class="pf-ada-composer">
                    <input 
                        type="text" 
                        class="pf-ada-input" 
                        id="${r.id}-prompt" 
                        placeholder="${r.placeholder}" 
                        autocomplete="off"
                    >
                    <button type="button" class="pf-ada-send" id="${r.id}-ask" title="Send">
                        ${Zu}
                    </button>
                </div>
                
                ${t?`<div class="pf-ada-chips">${t}</div>`:""}
                
                <footer class="pf-ada-footer">
                    ${Ju}
                    <span>Powered by <span class="pf-ada-model">GPT-4 Turbo</span></span>
                </footer>
            </div>
        </article>
    `}function ed(e){return String(e||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function fs(e,r={}){let t={...cs,...r},a=e.querySelector(`[data-copilot="${t.id}"]`);if(!a)return;let n=a.querySelector(`#${t.id}-messages`),i=a.querySelector(`#${t.id}-prompt`),s=a.querySelector(`#${t.id}-ask`),o=a.querySelector(`#${t.id}-status-dot`),c=a.querySelector(`#${t.id}-status-badge`),l=!1,f=(g,v="ready")=>{o&&(o.classList.remove("pf-ada-status-dot--busy","pf-ada-status-dot--offline"),v==="busy"&&o.classList.add("pf-ada-status-dot--busy"),v==="offline"&&o.classList.add("pf-ada-status-dot--offline")),c&&(c.title=g)},d=(g,v="assistant")=>{if(!n)return;let y=v==="user"?"pf-ada-bubble--user":v==="system"?"pf-ada-bubble--system":"pf-ada-bubble--ai",x=document.createElement("div");x.className=`pf-ada-bubble ${y}`,x.innerHTML=`<p>${m(g)}</p>`,n.appendChild(x),n.scrollTop=n.scrollHeight,os.push({role:v,content:g,timestamp:new Date().toISOString()})},u=()=>{if(!n)return;let g=document.createElement("div");g.className="pf-ada-bubble pf-ada-bubble--ai pf-ada-bubble--loading",g.id=`${t.id}-loading`,g.innerHTML=`
            <div class="pf-ada-typing">
                <span></span><span></span><span></span>
            </div>
        `,n.appendChild(g),n.scrollTop=n.scrollHeight},p=()=>{let g=document.getElementById(`${t.id}-loading`);g&&g.remove()},m=g=>String(g).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n\n/g,"</p><p>").replace(/\n- /g,"<br>\u2022 ").replace(/\n/g,"<br>"),h=async g=>{let v=g||(i==null?void 0:i.value.trim());if(!(!v||l)){l=!0,i&&(i.value=""),s&&(s.disabled=!0),d(v,"user"),u(),f("Analyzing...","busy");try{let y=null;if(typeof t.contextProvider=="function")try{y=await t.contextProvider()}catch(I){console.warn("CoPilot: Context provider failed",I)}let x;typeof t.onPrompt=="function"?x=await t.onPrompt(v,y,os):typeof t.apiEndpoint=="string"?x=await td(t.apiEndpoint,v,y,t.systemPrompt):x=rd(v,y),p(),d(x,"assistant"),f("Ready to assist","ready")}catch(y){console.error("CoPilot error:",y),p(),d(`I encountered an issue: ${y.message}. Please try again.`,"system"),f("Error occurred","offline")}l=!1,s&&(s.disabled=!1),i==null||i.focus()}};s==null||s.addEventListener("click",()=>h()),i==null||i.addEventListener("keydown",g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),h())}),a.querySelectorAll(".pf-ada-chip").forEach(g=>{g.addEventListener("click",()=>{let v=g.dataset.prompt;v&&h(v)})})}async function td(e,r,t,a){let n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:r,context:t,systemPrompt:a,history:os.slice(-10)})});if(!n.ok)throw new Error(`API request failed: ${n.status}`);let i=await n.json();return i.message||i.response||"No response received."}function rd(e,r){var a,n,i;let t=e.toLowerCase();return t.includes("diagnostic")||t.includes("check")?`Great question! Let me run through the diagnostics for you.

**\u2713 What Looks Good:**
\u2022 All required fields are populated
\u2022 Current period matches your config date
\u2022 All expense categories are mapped to GL accounts

**\u26A0\uFE0F Items Worth Reviewing:**
\u2022 2 departments show >15% variance from prior period
\u2022 Burden rate (14.6%) is slightly below your historical average (16.2%)

**My Recommendations:**
1. Take a closer look at the Sales & Marketing variance (-44.4%)
2. Verify headcount changes align with HR records
3. Once satisfied, you're clear to proceed to Journal Entry Prep!

Let me know if you'd like me to dig deeper into any of these.`:t.includes("insight")||t.includes("notable")||t.includes("finding")?`Here's what stands out this period \u2014 perfect for your executive summary.

**\u{1F4CA} The Headlines:**
\u2022 Total Payroll: ${(a=r==null?void 0:r.summary)!=null&&a.total?`$${(r.summary.total/1e3).toFixed(0)}K`:"$254K"}
\u2022 Headcount: ${((n=r==null?void 0:r.summary)==null?void 0:n.employeeCount)||38} employees
\u2022 Avg Cost/Employee: ${(i=r==null?void 0:r.summary)!=null&&i.avgPerEmployee?`$${r.summary.avgPerEmployee.toFixed(0)}`:"$6,674"}

**\u{1F4A1} Key Findings:**
1. **Payroll decreased 14.2%** \u2014 primarily driven by headcount reduction in Sales
2. **R&D remains your largest cost center** at 39% of total payroll
3. **Burden rate normalized** to 14.6% (was 18.2% prior period)

**\u26A0\uFE0F Items to Flag:**
\u2022 Sales & Marketing down $52K \u2014 worth confirming this was intentional
\u2022 2 fewer employees than prior period

**Suggested Talking Points:**
\u2022 "Payroll efficiency improved with 14% reduction while maintaining core operations"
\u2022 "R&D investment remains strong \u2014 aligned with product roadmap"

Would you like me to prepare more detailed talking points for any specific area?`:t.includes("variance")||t.includes("change")||t.includes("difference")?`**Variance Analysis: Current vs Prior Period**

\u{1F4C8} **Significant Changes**:

| Department | Change | % Change | Driver |
|------------|--------|----------|--------|
| Sales & Marketing | -$52,298 | -44.4% | \u{1F534} Headcount |
| Research & Dev | +$8,514 | +9.4% | Merit increases |
| General & Admin | +$1,610 | +3.9% | Normal variance |

\u{1F50D} **Root Cause Analysis**:

**Sales & Marketing (-44.4%)**:
\u2022 3 positions eliminated per restructuring plan
\u2022 Commission payouts lower due to Q4 timing
\u2022 \u26A0\uFE0F Verify: Is this aligned with sales targets?

**R&D (+9.4%)**:
\u2022 Annual merit increases effective this period
\u2022 1 new senior engineer hire
\u2022 \u2713 Expected per hiring plan

**Recommendation**: Document Sales variance in review notes. This is material and will be questioned.`:t.includes("journal")||t.includes("je")||t.includes("entry")?`Good news \u2014 your journal entry looks ready to go! Here's the full check:

**\u2713 Balance Check: PASSED**
\u2022 Total Debits: $253,625
\u2022 Total Credits: $253,625
\u2022 Difference: $0.00 \u2014 perfectly balanced!

**\u2713 Mapping Validation: Complete**
\u2022 9 unique GL accounts used
\u2022 All department codes are valid

**\u2713 Reference Data:**
\u2022 JE ID: PR-AUTO-2025-11-27
\u2022 Transaction Date: 2025-11-27
\u2022 Period: November 2025

**You're clear to export!** \u2705

**Next Steps:**
1. Click "Export" to download the CSV
2. Import into your accounting system
3. Post and reconcile

Let me know if you need me to double-check anything before you export!`:`Great question! I'm Ada, and I'm here to help with your payroll analysis.

Here's what I can help you with:

\u2022 **\u{1F50D} Diagnostics** \u2014 Check data quality and completeness
\u2022 **\u{1F4A1} Insights** \u2014 Key findings for executive review  
\u2022 **\u{1F4CA} Variance Analysis** \u2014 Period-over-period changes
\u2022 **\u{1F4CB} JE Readiness** \u2014 Validate journal entries before export

Try clicking one of the quick action buttons above, or just ask me something specific like:
\u2022 "What's driving the variance this period?"
\u2022 "Is my data ready for the CFO?"
\u2022 "Summarize the department breakdown"

I'm reading your actual spreadsheet data, so I can give you specific answers!`}function si(e={}){return async()=>{if(typeof Excel=="undefined")return null;try{return await Excel.run(async r=>{var i;let t={},a=r.workbook.worksheets.getItemOrNullObject(e.dataClean||"PR_Data_Clean");if(a.load("isNullObject"),await r.sync(),!a.isNullObject){let s=a.getUsedRangeOrNullObject();s.load("values, rowCount"),await r.sync(),!s.isNullObject&&((i=s.values)==null?void 0:i.length)>1&&(t.rowCount=s.rowCount-1,t.dataAvailable=!0)}let n=r.workbook.worksheets.getItemOrNullObject(e.config||"SS_PF_Config");return n.load("isNullObject"),await r.sync(),n.isNullObject||(t.configAvailable=!0),{timestamp:new Date().toISOString(),summary:t}})}catch(r){return console.warn("CoPilot: Failed to read Excel context",r),null}}}var Ju,Zu,Qu,cs,os,us=ac(()=>{ss();Ju='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.8956zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z"/></svg>',Zu='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>',Qu=ii.ADA_IMAGE_URL,cs={id:"pf-copilot",heading:"Ada",subtext:"Your smart assistant to help you analyze and troubleshoot.",welcomeMessage:"What would you like to explore?",placeholder:"Where should I focus this pay period?",quickActions:[{id:"diagnostics",label:"Diagnostics",prompt:"Run a diagnostic check on the current payroll data. Check for completeness, accuracy issues, and any data quality concerns."},{id:"insights",label:"Insights",prompt:"What are the key insights and notable findings from this payroll period that I should highlight for executive review?"},{id:"variance",label:"Variances",prompt:"Analyze the significant variances between this period and the prior period. What's driving the changes?"},{id:"journal",label:"JE Check",prompt:"Is the journal entry ready for export? Check that debits equal credits and flag any mapping issues."}],systemPrompt:`You are Prairie Forge CoPilot, an expert financial analyst assistant embedded in an Excel add-in. 

Your role is to help accountants and CFOs:
1. Analyze payroll expense data for accuracy and completeness
2. Identify trends, anomalies, and areas requiring attention
3. Prepare executive-ready insights and talking points
4. Validate journal entries before export

Communication style:
- Be concise but thorough
- Use bullet points for clarity
- Highlight actionable items with \u26A0\uFE0F or \u2713
- Format currency as $X,XXX and percentages as X.X%
- Always suggest 2-3 concrete next steps

When analyzing data, look for:
- Period-over-period changes > 10%
- Department cost anomalies
- Headcount vs payroll mismatches
- Burden rate outliers
- Missing or incomplete mappings`},os=[]});function xt(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}var ns="SS_PF_Config";async function nc(e,r=[ns]){var n;let t=e.workbook.tables;t.load("items/name"),await e.sync();let a=(n=t.items)==null?void 0:n.find(i=>r.includes(i.name));return a?e.workbook.tables.getItem(a.name):(console.warn("Config table not found. Looking for:",r),null)}function ic(e){let r=e.map(t=>String(t||"").trim().toLowerCase());return{field:r.findIndex(t=>t==="field"||t==="field name"||t==="setting"),value:r.findIndex(t=>t==="value"||t==="setting value"),type:r.findIndex(t=>t==="type"||t==="category"),title:r.findIndex(t=>t==="title"||t==="display name"),permanent:r.findIndex(t=>t==="permanent"||t==="persist")}}async function ai(e=[ns]){if(!xt())return{};try{return await Excel.run(async r=>{let t=await nc(r,e);if(!t)return{};let a=t.getDataBodyRange(),n=t.getHeaderRowRange();a.load("values"),n.load("values"),await r.sync();let i=n.values[0]||[],s=ic(i);if(s.field===-1||s.value===-1)return console.warn("Config table missing FIELD or VALUE columns. Headers:",i),{};let o={};return(a.values||[]).forEach(l=>{var d;let f=String(l[s.field]||"").trim();f&&(o[f]=(d=l[s.value])!=null?d:"")}),console.log("Configuration loaded:",Object.keys(o).length,"fields"),o})}catch(r){return console.error("Failed to load configuration:",r),{}}}var $u=new Set(["SS_Installation_Key","SS_Company_ID","SS_Company_Name","SS_Accounting_Software","PTO_Payroll_Provider","PR_Payroll_Provider"]);async function un(e,r,t=[ns]){if(!xt())return!1;try{return await Excel.run(async a=>{let n=await nc(a,t);if(!n){console.warn("Config table not found for write");return}let i=n.getDataBodyRange(),s=n.getHeaderRowRange();i.load("values"),s.load("values"),await a.sync();let o=s.values[0]||[],c=ic(o);if(c.field===-1||c.value===-1){console.error("Config table missing FIELD or VALUE columns");return}let f=(i.values||[]).findIndex(u=>String(u[c.field]||"").trim()===e),d=$u.has(e);if(f>=0)i.getCell(f,c.value).values=[[r]],d&&c.permanent>=0&&(i.getCell(f,c.permanent).values=[["Y"]]);else{let u=new Array(o.length).fill("");c.type>=0&&(u[c.type]=d?"Shared":"Run Settings"),u[c.field]=e,u[c.value]=r,c.permanent>=0&&(u[c.permanent]=d?"Y":"N"),c.title>=0&&(u[c.title]=""),n.rows.add(null,[u]),console.log("Added new config row:",e,"=",r,d?"(permanent)":"")}await a.sync(),console.log("Saved config:",e,"=",r)}),!0}catch(a){return console.error("Failed to save config:",e,a),!1}}var ju="SS_PF_Config",Hu="module-prefix",Vu="system",is="module-selector",Wu="SS_Homepage",Gu=["SS_Employee_Roster","SS_Chart_of_Accounts","SS_PF_Config"],Ia={PR_:"payroll-recorder",PTO_:"pto-accrual",CC_:"credit-card-expense",COM_:"commission-calc",SS_:"system"};async function sc(){if(!xt())return{...Ia};try{return await Excel.run(async e=>{var f,d;let r=e.workbook.worksheets.getItemOrNullObject(ju);if(await e.sync(),r.isNullObject)return console.log("[Tab Visibility] Config sheet not found, using defaults"),{...Ia};let t=r.getUsedRangeOrNullObject();if(t.load("values"),await e.sync(),t.isNullObject||!((f=t.values)!=null&&f.length))return{...Ia};let a=t.values,n=Yu(a[0]),i=n.get("category"),s=n.get("field"),o=n.get("value");if(i===void 0||s===void 0||o===void 0)return console.warn("[Tab Visibility] Missing required columns, using defaults"),{...Ia};let c={},l=!1;for(let u=1;u<a.length;u++){let p=a[u];if(qr(p[i])===Hu){let h=String((d=p[s])!=null?d:"").trim().toUpperCase(),g=qr(p[o]);h&&g&&(c[h]=g,l=!0)}}return l?(console.log("[Tab Visibility] Loaded prefix config:",c),c):(console.log("[Tab Visibility] No module-prefix rows found, using defaults"),{...Ia})})}catch(e){return console.warn("[Tab Visibility] Error reading prefix config:",e),{...Ia}}}async function ni(e){var t;if(!xt())return;let r=qr(e);console.log(`[Tab Visibility] Applying visibility for module: ${r}`);try{let a=await sc(),n=Object.keys(a).map(o=>String(o!=null?o:"").trim().toUpperCase()).filter(Boolean).sort((o,c)=>c.length-o.length),i=qu(a),s=r===qr(is)?null:(t=i[r])!=null?t:null;if(r!==qr(is)&&!s){console.warn(`[Tab Visibility] No active prefix found for moduleKey="${r}". Skipping visibility changes.`);return}await Excel.run(async o=>{let c=o.workbook.worksheets;c.load("items/name,visibility"),await o.sync();let l=[],f=[],d=[],u=[];c.items.forEach(h=>{let g=h.name,v=g.toUpperCase(),y=!1,x=!1,I=Gu.some(R=>v===R.toUpperCase());if(r===qr(is))v===Wu.toUpperCase()?y=!0:x=!0;else{let R=Ku(v,n);R&&(R===s?y=!0:x=!0),I&&(y=!1,x=!0)}y?(l.push(h),console.log(`[Tab Visibility] SHOW: ${g}`),d.push(g)):x?(f.push(h),console.log(`[Tab Visibility] HIDE: ${g}`),u.push(g)):console.log(`[Tab Visibility] SKIP: ${g} (no prefix match)`)});for(let h of l)h.visibility=Excel.SheetVisibility.visible;if(await o.sync(),c.items.filter(h=>h.visibility===Excel.SheetVisibility.visible).filter(h=>!f.includes(h)).length>=1){for(let h of f)try{h.visibility=Excel.SheetVisibility.hidden}catch(g){console.warn(`[Tab Visibility] Could not hide "${h.name}":`,g.message)}await o.sync()}else console.warn("[Tab Visibility] Skipping hide - would leave no visible sheets");console.log(`[Tab Visibility] Done! Showed ${l.length}, hid ${f.length} tabs`),console.log("[Tab Visibility] Summary:",{moduleKey:r,activePrefix:s,shownSheets:d,hiddenSheets:u})})}catch(a){console.warn("[Tab Visibility] Error applying visibility:",a)}}async function zu(){if(!xt()){console.log("Excel not available");return}try{await Excel.run(async e=>{let r=e.workbook.worksheets;r.load("items/name,visibility"),await e.sync();let t=0;r.items.forEach(a=>{a.visibility!==Excel.SheetVisibility.visible&&(a.visibility=Excel.SheetVisibility.visible,console.log(`[ShowAll] Made visible: ${a.name}`),t++)}),await e.sync(),console.log(`[ShowAll] Done! Made ${t} sheets visible. Total: ${r.items.length}`)})}catch(e){console.error("[Tab Visibility] Unable to show all sheets:",e)}}async function Xu(){if(!xt()){console.log("Excel not available");return}try{let e=await sc(),r=[];for(let[t,a]of Object.entries(e))a===Vu&&r.push(t);await Excel.run(async t=>{let a=t.workbook.worksheets;a.load("items/name,visibility"),await t.sync(),a.items.forEach(n=>{let i=n.name.toUpperCase();r.some(s=>i.startsWith(s))&&(n.visibility=Excel.SheetVisibility.visible,console.log(`[Unhide] Made visible: ${n.name}`))}),await t.sync(),console.log("[Unhide] System sheets are now visible!")})}catch(e){console.error("[Tab Visibility] Unable to unhide system sheets:",e)}}function Yu(e=[]){let r=new Map;return e.forEach((t,a)=>{let n=qr(t);n&&r.set(n,a)}),r}function qr(e){return String(e!=null?e:"").trim().toLowerCase().replace(/[\s_]+/g,"-")}function qu(e){let r={};for(let[t,a]of Object.entries(e!=null?e:{})){let n=String(t!=null?t:"").trim().toUpperCase(),i=qr(a);!n||!i||r[i]||(r[i]=n)}return r}function Ku(e,r){for(let t of r)if(e.startsWith(t))return t;return null}async function Pa(e){if(!xt())return!1;try{return await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject(e);return await r.sync(),t.isNullObject?(console.warn(`[Tab Visibility] Sheet "${e}" not found`),!1):(t.visibility=Excel.SheetVisibility.visible,t.activate(),await r.sync(),console.log(`[Tab Visibility] Showed and activated: ${e}`),!0)}),!0}catch(r){return console.error(`[Tab Visibility] Error showing sheet "${e}":`,r),!1}}typeof window!="undefined"&&(window.PrairieForge=window.PrairieForge||{},window.PrairieForge.showAllSheets=zu,window.PrairieForge.unhideSystemSheets=Xu,window.PrairieForge.applyModuleTabVisibility=ni,window.PrairieForge.showAndActivateSheet=Pa);ss();var dc=ii.ADA_IMAGE_URL,ad="https://jgciqwzwacaesqjaoadc.supabase.co",cc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE";async function lc(e,r,t){let a=`${ad}/functions/v1/copilot`;try{console.log("[Ada Popup] Calling copilot API...");let n=await fetch(a,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:`Bearer ${cc}`,apikey:cc},body:JSON.stringify({prompt:e,context:r,module:"general",function:"analysis",history:(t==null?void 0:t.slice(-10))||[]})});if(!n.ok){let s=await n.text();throw console.error("[Ada Popup] API error:",n.status,s),new Error(`API request failed: ${n.status}`)}let i=await n.json();return console.log("[Ada Popup] API response received"),i.message||i.response?i.message||i.response:"I received your question but couldn't generate a response. Please try again."}catch(n){return console.error("[Ada Popup] API call failed:",n),`I'm having trouble connecting right now. Error: ${n.message}. Please try again in a moment.`}}async function oi(e,r,t){if(typeof Excel=="undefined"){console.warn("Excel runtime not available for homepage sheet");return}try{await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject(e);n.load("isNullObject, name, visibility"),await a.sync();let i;n.isNullObject?(i=a.workbook.worksheets.add(e),await a.sync(),await fc(a,i,r,t)):(i=n,i.visibility!==Excel.SheetVisibility.visible&&(i.visibility=Excel.SheetVisibility.visible,await a.sync()),await fc(a,i,r,t)),i.activate(),i.getRange("A1").select(),await a.sync()})}catch(a){console.error(`Error activating homepage sheet ${e}:`,a)}}async function fc(e,r,t,a){try{let l=r.getUsedRangeOrNullObject();l.load("isNullObject"),await e.sync(),l.isNullObject||(l.clear(),await e.sync())}catch{}r.showGridlines=!1,r.getRange("A:A").format.columnWidth=400,r.getRange("B:B").format.columnWidth=50,r.getRange("1:1").format.rowHeight=60,r.getRange("2:2").format.rowHeight=30;let n=[[t,""],[a,""],["",""],["",""]],i=r.getRangeByIndexes(0,0,4,2);i.values=n;let s=r.getRange("A1:Z100");s.format.fill.color="#0f0f0f";let o=r.getRange("A1");o.format.font.bold=!0,o.format.font.size=36,o.format.font.color="#ffffff",o.format.font.name="Segoe UI Light",o.format.verticalAlignment="Center";let c=r.getRange("A2");c.format.font.size=14,c.format.font.color="#a0a0a0",c.format.font.name="Segoe UI",c.format.verticalAlignment="Top",r.freezePanes.freezeRows(0),r.freezePanes.freezeColumns(0),await e.sync()}var uc={"module-selector":{sheetName:"SS_Homepage",title:"ForgeSuite",subtitle:"Select a module from the side panel to get started."},"payroll-recorder":{sheetName:"PR_Homepage",title:"Payroll Recorder",subtitle:"Normalize payroll exports, enforce controls, and prep journal entries without leaving Excel."},"pto-accrual":{sheetName:"PTO_Homepage",title:"PTO Accrual",subtitle:"Calculate employee PTO liabilities, compare period-over-period changes, and prepare accrual journal entries."}};function ci(e){return uc[e]||uc["module-selector"]}function hc(){hs();let e=document.createElement("button");return e.className="pf-ada-fab",e.id="pf-ada-fab",e.setAttribute("aria-label","Ask Ada"),e.setAttribute("title","Ask Ada"),e.innerHTML=`
        <span class="pf-ada-fab__ring"></span>
        <img 
            class="pf-ada-fab__image" 
            src="${dc}" 
            alt="Ada - Your AI Assistant"
            onerror="this.style.display='none'"
        />
    `,document.body.appendChild(e),e.addEventListener("click",id),e}function hs(){let e=document.getElementById("pf-ada-fab");e&&e.remove();let r=document.getElementById("pf-ada-modal-overlay");r&&r.remove()}function nd(){let e,r,t,a=async()=>{try{let i=await Promise.resolve().then(()=>(us(),oc));e=i.renderCopilotCard,r=i.bindCopilotCard,t=i.createExcelContextProvider}catch(i){console.warn("Could not load copilot functions:",i)}};return{subtext:"Your AI-powered assistant",copilotHtml:"",bindFunction:async()=>{if(await a(),e&&r){let i=document.getElementById("ada-modal-copilot");i&&(i.innerHTML=e({id:"ada-modal-copilot",heading:"Ada",subtext:"Ask questions about your data",welcomeMessage:"Hi! I'm Ada, your AI assistant. How can I help you today?",placeholder:"Ask about your data, analysis, or insights...",quickActions:[{id:"help",label:"What can you do?",prompt:"What kinds of questions can you help me with? What data do you have access to?"},{id:"overview",label:"Data Overview",prompt:"Give me an overview of the data available in this workbook."},{id:"tips",label:"Best Practices",prompt:"What are some best practices for using this tool effectively?"}],contextProvider:t?t({config:"SS_PF_Config"}):null,onPrompt:lc}),setTimeout(()=>{r(i,{id:"ada-modal-copilot",contextProvider:t?t({config:"SS_PF_Config"}):null,onPrompt:lc})},200))}}}}function id(){let e=document.getElementById("pf-ada-modal-overlay");e&&e.remove();let r=nd(),t=document.createElement("div");t.className="pf-ada-modal-overlay",t.id="pf-ada-modal-overlay",t.innerHTML=`
        <div class="pf-ada-modal pf-ada-modal--chat">
            <div class="pf-ada-modal__header">
                <button class="pf-ada-modal__close" id="ada-modal-close" aria-label="Close">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
                <img class="pf-ada-modal__avatar" src="${dc}" alt="Ada" />
                <h2 class="pf-ada-modal__title">Ask Ada <span class="pf-ada-beta-tag">BETA</span></h2>
                <p class="pf-ada-modal__subtitle">${r.subtext}</p>
            </div>
            <div class="pf-ada-modal__body">
                <div class="pf-ada-copilot-container" id="ada-modal-copilot">
                    <div class="pf-ada-loading">
                        <div class="pf-ada-typing"><span></span><span></span><span></span></div>
                        <p>Loading Ada...</p>
                    </div>
                </div>
            </div>
        </div>
    `,document.body.appendChild(t),requestAnimationFrame(()=>{t.classList.add("is-visible")});let a=document.getElementById("ada-modal-close");a==null||a.addEventListener("click",ds),t.addEventListener("click",i=>{i.target===t&&ds()});let n=i=>{i.key==="Escape"&&(ds(),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n),r.bindFunction&&r.bindFunction()}function ds(){let e=document.getElementById("pf-ada-modal-overlay");e&&(e.classList.remove("is-visible"),setTimeout(()=>{e.remove()},300))}us();var sd=["January","February","March","April","May","June","July","August","September","October","November","December"],mc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],od=["Su","Mo","Tu","We","Th","Fr","Sa"],Vt=null,wr=null;function gc(e,r={}){let t=document.getElementById(e);if(!t)return;let{onChange:a=null,minDate:n=null,maxDate:i=null,readonly:s=!1}=r,o=t.closest(".pf-datepicker-wrapper");o||(o=document.createElement("div"),o.className="pf-datepicker-wrapper",t.parentNode.insertBefore(o,t),o.appendChild(t)),t.type="text",t.placeholder="Select date...",t.classList.add("pf-datepicker-input"),t.readOnly=!0;let c=t.value?pc(t.value):null;c&&(t.value=ms(c),t.dataset.value=dn(c));let l=o.querySelector(".pf-datepicker-icon");l||(l=document.createElement("span"),l.className="pf-datepicker-icon",l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>',o.appendChild(l));let f={inputId:e,input:t,selectedDate:c,viewDate:c?new Date(c):new Date,onChange:a,minDate:n,maxDate:i};function d(){s||(wr=f,cd())}return t.addEventListener("click",d),l.addEventListener("click",d),{getValue:()=>f.selectedDate?dn(f.selectedDate):"",setValue:u=>{let p=pc(u);f.selectedDate=p,f.viewDate=p?new Date(p):new Date,p?(t.value=ms(p),t.dataset.value=dn(p)):(t.value="",t.dataset.value="")},open:d,close:li}}function cd(){wr&&(Vt||(Vt=document.createElement("div"),Vt.className="pf-datepicker-modal",Vt.id="pf-datepicker-modal",document.body.appendChild(Vt)),vc(),requestAnimationFrame(()=>{Vt.classList.add("is-open")}),document.addEventListener("keydown",xc))}function li(){Vt&&Vt.classList.remove("is-open"),document.removeEventListener("keydown",xc),wr=null}function xc(e){e.key==="Escape"&&li()}function vc(){if(!Vt||!wr)return;let{viewDate:e,selectedDate:r,minDate:t,maxDate:a}=wr,n=e.getFullYear(),i=e.getMonth();Vt.innerHTML=`
        <div class="pf-datepicker-backdrop"></div>
        <div class="pf-datepicker-container">
            <div class="pf-datepicker-header">
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="prev-year" title="Previous Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="11 17 6 12 11 7"/><polyline points="18 17 13 12 18 7"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="prev-month" title="Previous Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                    </button>
                </div>
                <span class="pf-datepicker-title">${sd[i]} ${n}</span>
                <div class="pf-datepicker-nav-group">
                    <button type="button" class="pf-datepicker-nav" data-action="next-month" title="Next Month">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                    </button>
                    <button type="button" class="pf-datepicker-nav" data-action="next-year" title="Next Year">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="13 17 18 12 13 7"/><polyline points="6 17 11 12 6 7"/></svg>
                    </button>
                </div>
            </div>
            <div class="pf-datepicker-weekdays">
                ${od.map(s=>`<span>${s}</span>`).join("")}
            </div>
            <div class="pf-datepicker-days">
                ${ud(n,i,r,t,a)}
            </div>
            <div class="pf-datepicker-footer">
                <button type="button" class="pf-datepicker-btn pf-datepicker-today" data-action="today">Today</button>
                <button type="button" class="pf-datepicker-btn pf-datepicker-clear" data-action="clear">Clear</button>
            </div>
        </div>
    `,ld()}function ld(){var e;Vt&&((e=Vt.querySelector(".pf-datepicker-backdrop"))==null||e.addEventListener("click",li),Vt.querySelectorAll(".pf-datepicker-nav").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=r.dataset.action;fd(a)})}),Vt.querySelectorAll(".pf-datepicker-day:not(.disabled)").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=parseInt(r.dataset.day),n=parseInt(r.dataset.month),i=parseInt(r.dataset.year);ps(new Date(i,n,a))})}),Vt.querySelectorAll(".pf-datepicker-btn").forEach(r=>{r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();let a=r.dataset.action;a==="today"?ps(new Date):a==="clear"&&ps(null)})}))}function fd(e){if(!wr)return;let r=wr.viewDate;switch(e){case"prev-year":r.setFullYear(r.getFullYear()-1);break;case"prev-month":r.setMonth(r.getMonth()-1);break;case"next-month":r.setMonth(r.getMonth()+1);break;case"next-year":r.setFullYear(r.getFullYear()+1);break}vc()}function ps(e){if(!wr)return;let{input:r,onChange:t}=wr;wr.selectedDate=e,e?(r.value=ms(e),r.dataset.value=dn(e),wr.viewDate=new Date(e)):(r.value="",r.dataset.value=""),t&&t(e?dn(e):""),r.dispatchEvent(new Event("change",{bubbles:!0})),li()}function ud(e,r,t,a,n){let i=new Date(e,r,1).getDay(),s=new Date(e,r+1,0).getDate(),o=new Date(e,r,0).getDate(),c=new Date;c.setHours(0,0,0,0),t&&(t=new Date(t),t.setHours(0,0,0,0));let l="";for(let p=i-1;p>=0;p--){let m=o-p,h=r===0?11:r-1,g=r===0?e-1:e;l+=`<button type="button" class="pf-datepicker-day other-month" data-day="${m}" data-month="${h}" data-year="${g}">${m}</button>`}for(let p=1;p<=s;p++){let m=new Date(e,r,p);m.setHours(0,0,0,0);let h=m.getTime()===c.getTime(),g=t&&m.getTime()===t.getTime(),v="pf-datepicker-day";h&&(v+=" today"),g&&(v+=" selected");let y=!1;a&&m<a&&(y=!0),n&&m>n&&(y=!0),y&&(v+=" disabled"),l+=`<button type="button" class="${v}" data-day="${p}" data-month="${r}" data-year="${e}" ${y?"disabled":""}>${p}</button>`}let f=42,d=i+s,u=f-d;for(let p=1;p<=u;p++){let m=r===11?0:r+1,h=r===11?e+1:e;l+=`<button type="button" class="pf-datepicker-day other-month" data-day="${p}" data-month="${m}" data-year="${h}">${p}</button>`}return l}function pc(e){if(!e)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[a,n,i]=e.split("-").map(Number);return new Date(a,n-1,i)}let r=e.match(/^(\w+)\s+(\d+),\s+(\d{4})$/);if(r){let a=mc.findIndex(n=>n.toLowerCase()===r[1].toLowerCase().substring(0,3));if(a>=0)return new Date(parseInt(r[3]),a,parseInt(r[2]))}if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e)){let[a,n,i]=e.split("/").map(Number);return new Date(i,a-1,n)}let t=new Date(e);return isNaN(t.getTime())?null:t}function ms(e){return e?`${mc[e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`:""}function dn(e){if(!e)return"";let r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`}var Sn={};Sn.version="0.18.5";var Ir=1200,Va=1252,dd=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Hs={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Vs=function(e){dd.indexOf(e)!=-1&&(Va=Hs[0]=e)};function hd(){Vs(1252)}var kr=function(e){Ir=e,Vs(e)};function Ws(){kr(1200),hd()}function Fs(e){for(var r=[],t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function pd(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Cl(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var mn=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?pd(e.slice(2)):r==254&&t==255?Cl(e.slice(2)):r==65279?e.slice(1):e},fi=function(r){return String.fromCharCode(r)},yc=function(r){return String.fromCharCode(r)},He;var it=null,hn=!0,Jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cn(e){for(var r="",t=0,a=0,n=0,i=0,s=0,o=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),i=t>>2,a=e.charCodeAt(l++),s=(t&3)<<4|a>>4,n=e.charCodeAt(l++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),r+=Jr.charAt(i)+Jr.charAt(s)+Jr.charAt(o)+Jr.charAt(c);return r}function ar(e){var r="",t=0,a=0,n=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=Jr.indexOf(e.charAt(l++)),s=Jr.indexOf(e.charAt(l++)),t=i<<2|s>>4,r+=String.fromCharCode(t),o=Jr.indexOf(e.charAt(l++)),a=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(a)),c=Jr.indexOf(e.charAt(l++)),n=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(n));return r}var Fe=(function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node})(),Hr=(function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Qr(e){return Fe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function wc(e){return Fe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var tr=function(r){return Fe?Hr(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Ni(e){if(typeof ArrayBuffer=="undefined")return tr(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),a=0;a!=e.length;++a)t[a]=e.charCodeAt(a)&255;return r}function aa(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function md(e){if(typeof Uint8Array=="undefined")throw new Error("Unsupported");return new Uint8Array(e)}function Gs(e){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Gs(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Et=Fe?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Hr(r)}))}:function(e){if(typeof Uint8Array!="undefined"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var a=new Uint8Array(t),n=0;for(r=0,t=0;r<e.length;t+=n,++r)if(n=e[r].length,e[r]instanceof Uint8Array)a.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";a.set(new Uint8Array(e[r]),t)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function gd(e){for(var r=[],t=0,a=e.length+250,n=Qr(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)n[t++]=s;else if(s<2048)n[t++]=192|s>>6&31,n[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;n[t++]=240|s>>8&7,n[t++]=128|s>>2&63,n[t++]=128|o>>6&15|(s&3)<<4,n[t++]=128|o&63}else n[t++]=224|s>>12&15,n[t++]=128|s>>6&63,n[t++]=128|s&63;t>a&&(r.push(n.slice(0,t)),t=0,n=Qr(65535),a=65530)}return r.push(n.slice(0,t)),Et(r)}var Dt=/\u0000/g,gn=/[\u0001-\u0006]/g;function Ua(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Er(e,r){var t=""+e;return t.length>=r?t:at("0",r-t.length)+t}function zs(e,r){var t=""+e;return t.length>=r?t:at(" ",r-t.length)+t}function _i(e,r){var t=""+e;return t.length>=r?t:t+at(" ",r-t.length)}function xd(e,r){var t=""+Math.round(e);return t.length>=r?t:at("0",r-t.length)+t}function vd(e,r){var t=""+e;return t.length>=r?t:at("0",r-t.length)+t}var _c=Math.pow(2,32);function Ra(e,r){if(e>_c||e<-_c)return xd(e,r);var t=Math.round(e);return vd(t,r)}function ki(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var kc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gs=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function yd(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Ec={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wd={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ei(e,r,t){for(var a=e<0?-1:1,n=e*a,i=0,s=1,o=0,c=1,l=0,f=0,d=Math.floor(n);l<r&&(d=Math.floor(n),o=d*s+i,f=d*l+c,!(n-d<5e-8));)n=1/(n-d),i=s,s=o,c=l,l=f;if(f>r&&(l>r?(f=c,o=i):(f=l,o=s)),!t)return[0,a*o,f];var u=Math.floor(a*o/f);return[u,a*o-u*f,f]}function da(e,r,t){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,s=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)s=t?[1317,10,29]:[1900,2,29],i=3;else if(a===0)s=t?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),t&&(i=Sd(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var Al=new Date(1899,11,31,0,0,0),_d=Al.getTime(),kd=new Date(1900,2,1,0,0,0);function Ol(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=kd&&(t+=1440*60*1e3),(t-(_d+(e.getTimezoneOffset()-Al.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Xs(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ed(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function bd(e){var r=e<0?12:11,t=Xs(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Td(e){var r=Xs(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function An(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=bd(e):r===10?t=e.toFixed(10).substr(0,12):t=Td(e),Xs(Ed(t.toUpperCase()))}function xa(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):An(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return pr(14,Ol(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Sd(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Cd(e,r,t,a){var n="",i=0,s=0,o=t.y,c,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,l=r.length;break;case 3:return gs[t.m-1][1];case 5:return gs[t.m-1][0];default:return gs[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,l=r.length;break;case 3:return kc[t.q][0];default:return kc[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Er(t.S,r.length):(a>=2?s=a===3?1e3:100:s=a===1?10:1,i=Math.round(s*(t.S+t.u)),i>=60*s&&(i=0),r==="s"?i===0?"0":""+i/s:(n=Er(i,2+a),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?Er(c,l):"";return f}function Zr(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,a=e.substr(0,t);t!=e.length;t+=r)a+=(a.length>0?",":"")+e.substr(t,r);return a}var Fl=/%/g;function Ad(e,r,t){var a=r.replace(Fl,""),n=r.length-a.length;return Mr(e,a,t*Math.pow(10,2*n))+at("%",n)}function Od(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Mr(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Il(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Il(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Pl=/# (\?+)( ?)\/( ?)(\d+)/;function Fd(e,r,t){var a=parseInt(e[4],10),n=Math.round(r*a),i=Math.floor(n/a),s=n-i*a,o=a;return t+(i===0?"":""+i)+" "+(s===0?at(" ",e[1].length+1+e[4].length):zs(s,e[1].length)+e[2]+"/"+e[3]+Er(o,e[4].length))}function Id(e,r,t){return t+(r===0?"":""+r)+at(" ",e[1].length+2+e[4].length)}var Rl=/^#*0*\.([0#]+)/,Nl=/\).*[0#]/,Dl=/\(###\) ###\\?-####/;function Wt(e){for(var r="",t,a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function bc(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Tc(e,r){var t=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(t*a)).length?0:Math.round(t*a)}function Pd(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Rd(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Nl)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?cr("n",a,t):"("+cr("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Od(e,r,t);if(r.indexOf("%")!==-1)return Ad(e,r,t);if(r.indexOf("E")!==-1)return Il(r,t);if(r.charCodeAt(0)===36)return"$"+cr(e,r.substr(r.charAt(1)==" "?2:1),t);var n,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+Ra(c,r.length);if(r.match(/^[#?]+$/))return n=Ra(t,0),n==="0"&&(n=""),n.length>r.length?n:Wt(r.substr(0,r.length-n.length))+n;if(i=r.match(Pl))return Fd(i,c,l);if(r.match(/^#+0+$/))return l+Ra(c,r.length-r.indexOf("0"));if(i=r.match(Rl))return n=bc(t,i[1].length).replace(/^([^\.]+)$/,"$1."+Wt(i[1])).replace(/\.$/,"."+Wt(i[1])).replace(/\.(\d*)$/,function(m,h){return"."+h+at("0",Wt(i[1]).length-h.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+bc(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+Zr(Ra(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+cr(e,r,-t):Zr(""+(Math.floor(t)+Pd(t,i[1].length)))+"."+Er(Tc(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return cr(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ua(cr(e,r.replace(/[\\-]/g,""),t)),s=0,Ua(Ua(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<n.length?n.charAt(s++):m==="0"?"0":""}));if(r.match(Dl))return n=cr(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Ei(c,Math.pow(10,s)-1,!1),n=""+l,f=Mr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=_i(o[2],s),f.length<i[4].length&&(f=Wt(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Ei(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zs(o[1],s)+i[2]+"/"+i[3]+_i(o[2],s):at(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=Ra(t,0),r.length<=n.length?n:Wt(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var d=r.indexOf(".")-s,u=r.length-n.length-d;return Wt(r.substr(0,d)+n+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return s=Tc(t,i[1].length),t<0?"-"+cr(e,r,-t):Zr(Rd(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Er(0,3-m.length):"")+m})+"."+Er(s,i[1].length);switch(r){case"###,##0.00":return cr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var p=Zr(Ra(c,0));return p!=="0"?l+p:"";case"###,###.00":return cr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return cr(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function Nd(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Mr(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Dd(e,r,t){var a=r.replace(Fl,""),n=r.length-a.length;return Mr(e,a,t*Math.pow(10,2*n))+at("%",n)}function Ll(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ll(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ar(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Nl)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ar("n",a,t):"("+Ar("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Nd(e,r,t);if(r.indexOf("%")!==-1)return Dd(e,r,t);if(r.indexOf("E")!==-1)return Ll(r,t);if(r.charCodeAt(0)===36)return"$"+Ar(e,r.substr(r.charAt(1)==" "?2:1),t);var n,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+Er(c,r.length);if(r.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>r.length?n:Wt(r.substr(0,r.length-n.length))+n;if(i=r.match(Pl))return Id(i,c,l);if(r.match(/^#+0+$/))return l+Er(c,r.length-r.indexOf("0"));if(i=r.match(Rl))return n=(""+t).replace(/^([^\.]+)$/,"$1."+Wt(i[1])).replace(/\.$/,"."+Wt(i[1])),n=n.replace(/\.(\d*)$/,function(m,h){return"."+h+at("0",Wt(i[1]).length-h.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+Zr(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ar(e,r,-t):Zr(""+t)+"."+at("0",i[1].length);if(i=r.match(/^#,#*,#0/))return Ar(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ua(Ar(e,r.replace(/[\\-]/g,""),t)),s=0,Ua(Ua(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<n.length?n.charAt(s++):m==="0"?"0":""}));if(r.match(Dl))return n=Ar(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Ei(c,Math.pow(10,s)-1,!1),n=""+l,f=Mr("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=_i(o[2],s),f.length<i[4].length&&(f=Wt(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Ei(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zs(o[1],s)+i[2]+"/"+i[3]+_i(o[2],s):at(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=""+t,r.length<=n.length?n:Wt(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var d=r.indexOf(".")-s,u=r.length-n.length-d;return Wt(r.substr(0,d)+n+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ar(e,r,-t):Zr(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Er(0,3-m.length):"")+m})+"."+Er(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var p=Zr(""+c);return p!=="0"?l+p:"";default:if(r.match(/\.[0#?]*$/))return Ar(e,r.slice(0,r.lastIndexOf(".")),t)+Wt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Mr(e,r,t){return(t|0)===t?Ar(e,r,t):cr(e,r,t)}function Ld(e){for(var r=[],t=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n),n=a+1}if(r[r.length]=e.substr(n),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Bl=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Xa(e){for(var r=0,t="",a="";r<e.length;)switch(t=e.charAt(r)){case"G":ki(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(a=t;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match(Bl))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Bd(e,r,t,a){for(var n=[],i="",s=0,o="",c="t",l,f,d,u="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!ki(e,s))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(d=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(d);n[n.length]={t:"t",v:i},++s;break;case"\\":var p=e.charAt(++s),m=p==="("||p===")"?p:"t";n[n.length]={t:m,v:p},++s;break;case"_":n[n.length]={t:"t",v:" "},s+=2;break;case"@":n[n.length]={t:"T",v:r},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(l==null&&(l=da(r,t,e.charAt(s+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=da(r,t),l==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=u),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"\u4E0A":var h={t:o,v:o};if(l==null&&(l=da(r,t)),e.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(h.v=l.H>=12?"P":"A"),h.t="T",u="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(h.v=l.H>=12?"PM":"AM"),h.t="T",s+=5,u="h"):e.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(h.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),h.t="T",s+=5,u="h"):(h.t="t",++s),l==null&&h.t==="T")return"";n[n.length]=h,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Bl)){if(l==null&&(l=da(r,t),l==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Xa(e)||(n[n.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++s;break;case"$":n[n.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++s;break}var g=0,v=0,y;for(s=n.length-1,c="t";s>=0;--s)switch(n[s].t){case"h":case"H":n[s].t=u,c="h",g<1&&(g=1);break;case"s":(y=n[s].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[s].t;break;case"m":c==="s"&&(n[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[s].v.match(/[Hh]/)&&(g=1),g<2&&n[s].v.match(/[Mm]/)&&(g=2),g<3&&n[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var x="",I;for(s=0;s<n.length;++s)switch(n[s].t){case"t":case"T":case" ":case"D":break;case"X":n[s].v="",n[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[s].v=Cd(n[s].t.charCodeAt(0),n[s].v,l,v),n[s].t="t";break;case"n":case"?":for(I=s+1;n[I]!=null&&((o=n[I].t)==="?"||o==="D"||(o===" "||o==="t")&&n[I+1]!=null&&(n[I+1].t==="?"||n[I+1].t==="t"&&n[I+1].v==="/")||n[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[I].v==="/"||n[I].v===" "&&n[I+1]!=null&&n[I+1].t=="?"));)n[s].v+=n[I].v,n[I]={v:"",t:";"},++I;x+=n[s].v,s=I-1;break;case"G":n[s].t="t",n[s].v=xa(r,t);break}var R="",P,k;if(x.length>0){x.charCodeAt(0)==40?(P=r<0&&x.charCodeAt(0)===45?-r:r,k=Mr("n",x,P)):(P=r<0&&a>1?-r:r,k=Mr("n",x,P),P<0&&n[0]&&n[0].t=="t"&&(k=k.substr(1),n[0].v="-"+n[0].v)),I=k.length-1;var D=n.length;for(s=0;s<n.length;++s)if(n[s]!=null&&n[s].t!="t"&&n[s].v.indexOf(".")>-1){D=s;break}var N=n.length;if(D===n.length&&k.indexOf("E")===-1){for(s=n.length-1;s>=0;--s)n[s]==null||"n?".indexOf(n[s].t)===-1||(I>=n[s].v.length-1?(I-=n[s].v.length,n[s].v=k.substr(I+1,n[s].v.length)):I<0?n[s].v="":(n[s].v=k.substr(0,I+1),I=-1),n[s].t="t",N=s);I>=0&&N<n.length&&(n[N].v=k.substr(0,I+1)+n[N].v)}else if(D!==n.length&&k.indexOf("E")===-1){for(I=k.indexOf(".")-1,s=D;s>=0;--s)if(!(n[s]==null||"n?".indexOf(n[s].t)===-1)){for(f=n[s].v.indexOf(".")>-1&&s===D?n[s].v.indexOf(".")-1:n[s].v.length-1,R=n[s].v.substr(f+1);f>=0;--f)I>=0&&(n[s].v.charAt(f)==="0"||n[s].v.charAt(f)==="#")&&(R=k.charAt(I--)+R);n[s].v=R,n[s].t="t",N=s}for(I>=0&&N<n.length&&(n[N].v=k.substr(0,I+1)+n[N].v),I=k.indexOf(".")+1,s=D;s<n.length;++s)if(!(n[s]==null||"n?(".indexOf(n[s].t)===-1&&s!==D)){for(f=n[s].v.indexOf(".")>-1&&s===D?n[s].v.indexOf(".")+1:0,R=n[s].v.substr(0,f);f<n[s].v.length;++f)I<k.length&&(R+=k.charAt(I++));n[s].v=R,n[s].t="t",N=s}}}for(s=0;s<n.length;++s)n[s]!=null&&"n?".indexOf(n[s].t)>-1&&(P=a>1&&r<0&&s>0&&n[s-1].v==="-"?-r:r,n[s].v=Mr(n[s].t,n[s].v,P),n[s].t="t");var U="";for(s=0;s!==n.length;++s)n[s]!=null&&(U+=n[s].v);return U}var Sc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Cc(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Md(e,r){var t=Ld(e),a=t.length,n=t[a-1].indexOf("@");if(a<4&&n>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(Sc),o=t[1].match(Sc);return Cc(r,s)?[a,t[0]]:Cc(r,o)?[a,t[1]]:[a,t[s!=null&&o!=null?2:1]]}return[a,i]}function pr(e,r,t){t==null&&(t={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?a=t.dateNF:a=e;break;case"number":e==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:ge)[e],a==null&&(a=t.table&&t.table[Ec[e]]||ge[Ec[e]]),a==null&&(a=wd[e]||"General");break}if(ki(a,0))return xa(r,t);r instanceof Date&&(r=Ol(r,t.date1904));var n=Md(a,r);if(ki(n[1]))return xa(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Bd(n[1],r,t,n[0])}function Ur(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(ge[t]==null){r<0&&(r=t);continue}if(ge[t]==e){r=t;break}}r<0&&(r=391)}return ge[r]=e,r}function Di(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Ur(e[r],r)}function Ya(){ge=yd()}var Ud={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ml=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $d(e){var r=typeof e=="number"?ge[e]:e;return r=r.replace(Ml,"(\\d+)"),new RegExp("^"+r+"$")}function jd(e,r,t){var a=-1,n=-1,i=-1,s=-1,o=-1,c=-1;(r.match(Ml)||[]).forEach(function(d,u){var p=parseInt(t[u+1],10);switch(d.toLowerCase().charAt(0)){case"y":a=p;break;case"d":i=p;break;case"h":s=p;break;case"s":c=p;break;case"m":s>=0?o=p:n=p;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?l:a==-1&&n==-1&&i==-1?f:l+"T"+f}var Hd=(function(){var e={};e.version="1.2.0";function r(){for(var k=0,D=new Array(256),N=0;N!=256;++N)k=N,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,D[N]=k;return typeof Int32Array!="undefined"?new Int32Array(D):D}var t=r();function a(k){var D=0,N=0,U=0,W=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)W[U]=k[U];for(U=0;U!=256;++U)for(N=k[U],D=256+U;D<4096;D+=256)N=W[D]=N>>>8^k[N&255];var L=[];for(U=1;U!=16;++U)L[U-1]=typeof Int32Array!="undefined"?W.subarray(U*256,U*256+256):W.slice(U*256,U*256+256);return L}var n=a(t),i=n[0],s=n[1],o=n[2],c=n[3],l=n[4],f=n[5],d=n[6],u=n[7],p=n[8],m=n[9],h=n[10],g=n[11],v=n[12],y=n[13],x=n[14];function I(k,D){for(var N=D^-1,U=0,W=k.length;U<W;)N=N>>>8^t[(N^k.charCodeAt(U++))&255];return~N}function R(k,D){for(var N=D^-1,U=k.length-15,W=0;W<U;)N=x[k[W++]^N&255]^y[k[W++]^N>>8&255]^v[k[W++]^N>>16&255]^g[k[W++]^N>>>24]^h[k[W++]]^m[k[W++]]^p[k[W++]]^u[k[W++]]^d[k[W++]]^f[k[W++]]^l[k[W++]]^c[k[W++]]^o[k[W++]]^s[k[W++]]^i[k[W++]]^t[k[W++]];for(U+=15;W<U;)N=N>>>8^t[(N^k[W++])&255];return~N}function P(k,D){for(var N=D^-1,U=0,W=k.length,L=0,J=0;U<W;)L=k.charCodeAt(U++),L<128?N=N>>>8^t[(N^L)&255]:L<2048?(N=N>>>8^t[(N^(192|L>>6&31))&255],N=N>>>8^t[(N^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,J=k.charCodeAt(U++)&1023,N=N>>>8^t[(N^(240|L>>8&7))&255],N=N>>>8^t[(N^(128|L>>2&63))&255],N=N>>>8^t[(N^(128|J>>6&15|(L&3)<<4))&255],N=N>>>8^t[(N^(128|J&63))&255]):(N=N>>>8^t[(N^(224|L>>12&15))&255],N=N>>>8^t[(N^(128|L>>6&63))&255],N=N>>>8^t[(N^(128|L&63))&255]);return~N}return e.table=t,e.bstr=I,e.buf=R,e.str=P,e})(),me=(function(){var r={};r.version="1.2.1";function t(w,S){for(var _=w.split("/"),E=S.split("/"),C=0,A=0,j=Math.min(_.length,E.length);C<j;++C){if(A=_[C].length-E[C].length)return A;if(_[C]!=E[C])return _[C]<E[C]?-1:1}return _.length-E.length}function a(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:a(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(0,S+1)}function n(w){if(w.charAt(w.length-1)=="/")return n(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(S+1)}function i(w,S){typeof S=="string"&&(S=new Date(S));var _=S.getHours();_=_<<6|S.getMinutes(),_=_<<5|S.getSeconds()>>>1,w.write_shift(2,_);var E=S.getFullYear()-1980;E=E<<4|S.getMonth()+1,E=E<<5|S.getDate(),w.write_shift(2,E)}function s(w){var S=w.read_shift(2)&65535,_=w.read_shift(2)&65535,E=new Date,C=_&31;_>>>=5;var A=_&15;_>>>=4,E.setMilliseconds(0),E.setFullYear(_+1980),E.setMonth(A-1),E.setDate(C);var j=S&31;S>>>=5;var q=S&63;return S>>>=6,E.setHours(S),E.setMinutes(q),E.setSeconds(j<<1),E}function o(w){At(w,0);for(var S={},_=0;w.l<=w.length-4;){var E=w.read_shift(2),C=w.read_shift(2),A=w.l+C,j={};switch(E){case 21589:_=w.read_shift(1),_&1&&(j.mtime=w.read_shift(4)),C>5&&(_&2&&(j.atime=w.read_shift(4)),_&4&&(j.ctime=w.read_shift(4))),j.mtime&&(j.mt=new Date(j.mtime*1e3));break}w.l=A,S[E]=j}return S}var c;function l(){return c||(c={})}function f(w,S){if(w[0]==80&&w[1]==75)return rc(w,S);if((w[0]|32)==109&&(w[1]|32)==105)return Pu(w,S);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var _=3,E=512,C=0,A=0,j=0,q=0,V=0,H=[],G=w.slice(0,512);At(G,0);var ae=d(G);switch(_=ae[0],_){case 3:E=512;break;case 4:E=4096;break;case 0:if(ae[1]==0)return rc(w,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+_)}E!==512&&(G=w.slice(0,E),At(G,28));var le=w.slice(0,E);u(G,_);var pe=G.read_shift(4,"i");if(_===3&&pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pe);G.l+=4,j=G.read_shift(4,"i"),G.l+=4,G.chk("00100000","Mini Stream Cutoff Size: "),q=G.read_shift(4,"i"),C=G.read_shift(4,"i"),V=G.read_shift(4,"i"),A=G.read_shift(4,"i");for(var fe=-1,de=0;de<109&&(fe=G.read_shift(4,"i"),!(fe<0));++de)H[de]=fe;var ke=p(w,E);g(V,A,ke,E,H);var Xe=y(ke,j,H,E);Xe[j].name="!Directory",C>0&&q!==J&&(Xe[q].name="!MiniFAT"),Xe[H[0]].name="!FAT",Xe.fat_addrs=H,Xe.ssz=E;var Xt={},dt=[],Qt=[],ln=[];x(j,Xe,ke,dt,C,Xt,Qt,q),m(Qt,ln,dt),dt.shift();var fn={FileIndex:Qt,FullPaths:ln};return S&&S.raw&&(fn.raw={header:le,sectors:ke}),fn}function d(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(ue,"Header Signature: "),w.l+=16;var S=w.read_shift(2,"u");return[w.read_shift(2,"u"),S]}function u(w,S){var _=9;switch(w.l+=2,_=w.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+_);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+_);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+_)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function p(w,S){for(var _=Math.ceil(w.length/S)-1,E=[],C=1;C<_;++C)E[C-1]=w.slice(C*S,(C+1)*S);return E[_-1]=w.slice(_*S),E}function m(w,S,_){for(var E=0,C=0,A=0,j=0,q=0,V=_.length,H=[],G=[];E<V;++E)H[E]=G[E]=E,S[E]=_[E];for(;q<G.length;++q)E=G[q],C=w[E].L,A=w[E].R,j=w[E].C,H[E]===E&&(C!==-1&&H[C]!==C&&(H[E]=H[C]),A!==-1&&H[A]!==A&&(H[E]=H[A])),j!==-1&&(H[j]=E),C!==-1&&E!=H[E]&&(H[C]=H[E],G.lastIndexOf(C)<q&&G.push(C)),A!==-1&&E!=H[E]&&(H[A]=H[E],G.lastIndexOf(A)<q&&G.push(A));for(E=1;E<V;++E)H[E]===E&&(A!==-1&&H[A]!==A?H[E]=H[A]:C!==-1&&H[C]!==C&&(H[E]=H[C]));for(E=1;E<V;++E)if(w[E].type!==0){if(q=E,q!=H[q])do q=H[q],S[E]=S[q]+"/"+S[E];while(q!==0&&H[q]!==-1&&q!=H[q]);H[E]=-1}for(S[0]+="/",E=1;E<V;++E)w[E].type!==2&&(S[E]+="/")}function h(w,S,_){for(var E=w.start,C=w.size,A=[],j=E;_&&C>0&&j>=0;)A.push(S.slice(j*L,j*L+L)),C-=L,j=ua(_,j*4);return A.length===0?Y(0):Et(A).slice(0,w.size)}function g(w,S,_,E,C){var A=J;if(w===J){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var j=_[w],q=(E>>>2)-1;if(!j)return;for(var V=0;V<q&&(A=ua(j,V*4))!==J;++V)C.push(A);g(ua(j,E-4),S-1,_,E,C)}}function v(w,S,_,E,C){var A=[],j=[];C||(C=[]);var q=E-1,V=0,H=0;for(V=S;V>=0;){C[V]=!0,A[A.length]=V,j.push(w[V]);var G=_[Math.floor(V*4/E)];if(H=V*4&q,E<4+H)throw new Error("FAT boundary crossed: "+V+" 4 "+E);if(!w[G])break;V=ua(w[G],H)}return{nodes:A,data:Uc([j])}}function y(w,S,_,E){var C=w.length,A=[],j=[],q=[],V=[],H=E-1,G=0,ae=0,le=0,pe=0;for(G=0;G<C;++G)if(q=[],le=G+S,le>=C&&(le-=C),!j[le]){V=[];var fe=[];for(ae=le;ae>=0;){fe[ae]=!0,j[ae]=!0,q[q.length]=ae,V.push(w[ae]);var de=_[Math.floor(ae*4/E)];if(pe=ae*4&H,E<4+pe)throw new Error("FAT boundary crossed: "+ae+" 4 "+E);if(!w[de]||(ae=ua(w[de],pe),fe[ae]))break}A[le]={nodes:q,data:Uc([V])}}return A}function x(w,S,_,E,C,A,j,q){for(var V=0,H=E.length?2:0,G=S[w].data,ae=0,le=0,pe;ae<G.length;ae+=128){var fe=G.slice(ae,ae+128);At(fe,64),le=fe.read_shift(2),pe=Ui(fe,0,le-H),E.push(pe);var de={name:pe,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0},ke=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);ke!==0&&(de.ct=I(fe,fe.l-8));var Xe=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Xe!==0&&(de.mt=I(fe,fe.l-8)),de.start=fe.read_shift(4,"i"),de.size=fe.read_shift(4,"i"),de.size<0&&de.start<0&&(de.size=de.type=0,de.start=J,de.name=""),de.type===5?(V=de.start,C>0&&V!==J&&(S[V].name="!StreamData")):de.size>=4096?(de.storage="fat",S[de.start]===void 0&&(S[de.start]=v(_,de.start,S.fat_addrs,S.ssz)),S[de.start].name=de.name,de.content=S[de.start].data.slice(0,de.size)):(de.storage="minifat",de.size<0?de.size=0:V!==J&&de.start!==J&&S[V]&&(de.content=h(de,S[V].data,(S[q]||{}).data))),de.content&&At(de.content,0),A[pe]=de,j.push(de)}}function I(w,S){return new Date((kt(w,S+4)/1e7*Math.pow(2,32)+kt(w,S)/1e7-11644473600)*1e3)}function R(w,S){return l(),f(c.readFileSync(w),S)}function P(w,S){var _=S&&S.type;switch(_||Fe&&Buffer.isBuffer(w)&&(_="buffer"),_||"base64"){case"file":return R(w,S);case"base64":return f(tr(ar(w)),S);case"binary":return f(tr(w),S)}return f(w,S)}function k(w,S){var _=S||{},E=_.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=E+"/",w.FileIndex[0]={name:E,type:5}),_.CLSID&&(w.FileIndex[0].clsid=_.CLSID),D(w)}function D(w){var S="Sh33tJ5";if(!me.find(w,"/"+S)){var _=Y(4);_[0]=55,_[1]=_[3]=50,_[2]=54,w.FileIndex.push({name:S,type:2,content:_,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+S),N(w)}}function N(w,S){k(w);for(var _=!1,E=!1,C=w.FullPaths.length-1;C>=0;--C){var A=w.FileIndex[C];switch(A.type){case 0:E?_=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(A.R*A.L*A.C)&&(_=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(_=!0);break;default:_=!0;break}}if(!(!_&&!S)){var j=new Date(1987,1,19),q=0,V=Object.create?Object.create(null):{},H=[];for(C=0;C<w.FullPaths.length;++C)V[w.FullPaths[C]]=!0,w.FileIndex[C].type!==0&&H.push([w.FullPaths[C],w.FileIndex[C]]);for(C=0;C<H.length;++C){var G=a(H[C][0]);E=V[G],E||(H.push([G,{name:n(G).replace("/",""),type:1,clsid:ne,ct:j,mt:j,content:null}]),V[G]=!0)}for(H.sort(function(pe,fe){return t(pe[0],fe[0])}),w.FullPaths=[],w.FileIndex=[],C=0;C<H.length;++C)w.FullPaths[C]=H[C][0],w.FileIndex[C]=H[C][1];for(C=0;C<H.length;++C){var ae=w.FileIndex[C],le=w.FullPaths[C];if(ae.name=n(le).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||ne,C===0)ae.C=H.length>1?1:-1,ae.size=0,ae.type=5;else if(le.slice(-1)=="/"){for(q=C+1;q<H.length&&a(w.FullPaths[q])!=le;++q);for(ae.C=q>=H.length?-1:q,q=C+1;q<H.length&&a(w.FullPaths[q])!=a(le);++q);ae.R=q>=H.length?-1:q,ae.type=1}else a(w.FullPaths[C+1]||"")==a(le)&&(ae.R=C+1),ae.type=2}}}function U(w,S){var _=S||{};if(_.fileType=="mad")return Ru(w,_);switch(N(w),_.fileType){case"zip":return Su(w,_)}var E=(function(pe){for(var fe=0,de=0,ke=0;ke<pe.FileIndex.length;++ke){var Xe=pe.FileIndex[ke];if(Xe.content){var Xt=Xe.content.length;Xt>0&&(Xt<4096?fe+=Xt+63>>6:de+=Xt+511>>9)}}for(var dt=pe.FullPaths.length+3>>2,Qt=fe+7>>3,ln=fe+127>>7,fn=Qt+de+dt+ln,fa=fn+127>>7,as=fa<=109?0:Math.ceil((fa-109)/127);fn+fa+as+127>>7>fa;)as=++fa<=109?0:Math.ceil((fa-109)/127);var Lr=[1,as,fa,ln,dt,de,fe,0];return pe.FileIndex[0].size=fe<<6,Lr[7]=(pe.FileIndex[0].start=Lr[0]+Lr[1]+Lr[2]+Lr[3]+Lr[4]+Lr[5])+(Lr[6]+7>>3),Lr})(w),C=Y(E[7]<<9),A=0,j=0;{for(A=0;A<8;++A)C.write_shift(1,te[A]);for(A=0;A<8;++A)C.write_shift(2,0);for(C.write_shift(2,62),C.write_shift(2,3),C.write_shift(2,65534),C.write_shift(2,9),C.write_shift(2,6),A=0;A<3;++A)C.write_shift(2,0);for(C.write_shift(4,0),C.write_shift(4,E[2]),C.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),C.write_shift(4,0),C.write_shift(4,4096),C.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:J),C.write_shift(4,E[3]),C.write_shift(-4,E[1]?E[0]-1:J),C.write_shift(4,E[1]),A=0;A<109;++A)C.write_shift(-4,A<E[2]?E[1]+A:-1)}if(E[1])for(j=0;j<E[1];++j){for(;A<236+j*127;++A)C.write_shift(-4,A<E[2]?E[1]+A:-1);C.write_shift(-4,j===E[1]-1?J:j+1)}var q=function(pe){for(j+=pe;A<j-1;++A)C.write_shift(-4,A+1);pe&&(++A,C.write_shift(-4,J))};for(j=A=0,j+=E[1];A<j;++A)C.write_shift(-4,Q.DIFSECT);for(j+=E[2];A<j;++A)C.write_shift(-4,Q.FATSECT);q(E[3]),q(E[4]);for(var V=0,H=0,G=w.FileIndex[0];V<w.FileIndex.length;++V)G=w.FileIndex[V],G.content&&(H=G.content.length,!(H<4096)&&(G.start=j,q(H+511>>9)));for(q(E[6]+7>>3);C.l&511;)C.write_shift(-4,Q.ENDOFCHAIN);for(j=A=0,V=0;V<w.FileIndex.length;++V)G=w.FileIndex[V],G.content&&(H=G.content.length,!(!H||H>=4096)&&(G.start=j,q(H+63>>6)));for(;C.l&511;)C.write_shift(-4,Q.ENDOFCHAIN);for(A=0;A<E[4]<<2;++A){var ae=w.FullPaths[A];if(!ae||ae.length===0){for(V=0;V<17;++V)C.write_shift(4,0);for(V=0;V<3;++V)C.write_shift(4,-1);for(V=0;V<12;++V)C.write_shift(4,0);continue}G=w.FileIndex[A],A===0&&(G.start=G.size?G.start-1:J);var le=A===0&&_.root||G.name;if(H=2*(le.length+1),C.write_shift(64,le,"utf16le"),C.write_shift(2,H),C.write_shift(1,G.type),C.write_shift(1,G.color),C.write_shift(-4,G.L),C.write_shift(-4,G.R),C.write_shift(-4,G.C),G.clsid)C.write_shift(16,G.clsid,"hex");else for(V=0;V<4;++V)C.write_shift(4,0);C.write_shift(4,G.state||0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,G.start),C.write_shift(4,G.size),C.write_shift(4,0)}for(A=1;A<w.FileIndex.length;++A)if(G=w.FileIndex[A],G.size>=4096)if(C.l=G.start+1<<9,Fe&&Buffer.isBuffer(G.content))G.content.copy(C,C.l,0,G.size),C.l+=G.size+511&-512;else{for(V=0;V<G.size;++V)C.write_shift(1,G.content[V]);for(;V&511;++V)C.write_shift(1,0)}for(A=1;A<w.FileIndex.length;++A)if(G=w.FileIndex[A],G.size>0&&G.size<4096)if(Fe&&Buffer.isBuffer(G.content))G.content.copy(C,C.l,0,G.size),C.l+=G.size+63&-64;else{for(V=0;V<G.size;++V)C.write_shift(1,G.content[V]);for(;V&63;++V)C.write_shift(1,0)}if(Fe)C.l=C.length;else for(;C.l<C.length;)C.write_shift(1,0);return C}function W(w,S){var _=w.FullPaths.map(function(V){return V.toUpperCase()}),E=_.map(function(V){var H=V.split("/");return H[H.length-(V.slice(-1)=="/"?2:1)]}),C=!1;S.charCodeAt(0)===47?(C=!0,S=_[0].slice(0,-1)+S):C=S.indexOf("/")!==-1;var A=S.toUpperCase(),j=C===!0?_.indexOf(A):E.indexOf(A);if(j!==-1)return w.FileIndex[j];var q=!A.match(gn);for(A=A.replace(Dt,""),q&&(A=A.replace(gn,"!")),j=0;j<_.length;++j)if((q?_[j].replace(gn,"!"):_[j]).replace(Dt,"")==A||(q?E[j].replace(gn,"!"):E[j]).replace(Dt,"")==A)return w.FileIndex[j];return null}var L=64,J=-2,ue="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(w,S,_){l();var E=U(w,_);c.writeFileSync(S,E)}function se(w){for(var S=new Array(w.length),_=0;_<w.length;++_)S[_]=String.fromCharCode(w[_]);return S.join("")}function X(w,S){var _=U(w,S);switch(S&&S.type||"buffer"){case"file":return l(),c.writeFileSync(S.filename,_),_;case"binary":return typeof _=="string"?_:se(_);case"base64":return Cn(typeof _=="string"?_:se(_));case"buffer":if(Fe)return Buffer.isBuffer(_)?_:Hr(_);case"array":return typeof _=="string"?tr(_):_}return _}var M;function b(w){try{var S=w.InflateRaw,_=new S;if(_._processChunk(new Uint8Array([3,0]),_._finishFlushFlag),_.bytesRead)M=w;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function B(w,S){if(!M)return ec(w,S);var _=M.InflateRaw,E=new _,C=E._processChunk(w.slice(w.l),E._finishFlushFlag);return w.l+=E.bytesRead,C}function O(w){return M?M.deflateRawSync(w):Ie(w)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ee(w){var S=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(S>>16|S>>8|S)&255}for(var re=typeof Uint8Array!="undefined",K=re?new Uint8Array(256):[],we=0;we<256;++we)K[we]=ee(we);function F(w,S){var _=K[w&255];return S<=8?_>>>8-S:(_=_<<8|K[w>>8&255],S<=16?_>>>16-S:(_=_<<8|K[w>>16&255],_>>>24-S))}function Me(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=6?0:w[E+1]<<8))>>>_&3}function Oe(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=5?0:w[E+1]<<8))>>>_&7}function Ue(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=4?0:w[E+1]<<8))>>>_&15}function Ce(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=3?0:w[E+1]<<8))>>>_&31}function he(w,S){var _=S&7,E=S>>>3;return(w[E]|(_<=1?0:w[E+1]<<8))>>>_&127}function Ze(w,S,_){var E=S&7,C=S>>>3,A=(1<<_)-1,j=w[C]>>>E;return _<8-E||(j|=w[C+1]<<8-E,_<16-E)||(j|=w[C+2]<<16-E,_<24-E)||(j|=w[C+3]<<24-E),j&A}function jt(w,S,_){var E=S&7,C=S>>>3;return E<=5?w[C]|=(_&7)<<E:(w[C]|=_<<E&255,w[C+1]=(_&7)>>8-E),S+3}function Jt(w,S,_){var E=S&7,C=S>>>3;return _=(_&1)<<E,w[C]|=_,S+1}function ir(w,S,_){var E=S&7,C=S>>>3;return _<<=E,w[C]|=_&255,_>>>=8,w[C+1]=_,S+8}function on(w,S,_){var E=S&7,C=S>>>3;return _<<=E,w[C]|=_&255,_>>>=8,w[C+1]=_&255,w[C+2]=_>>>8,S+16}function Xr(w,S){var _=w.length,E=2*_>S?2*_:S+5,C=0;if(_>=S)return w;if(Fe){var A=wc(E);if(w.copy)w.copy(A);else for(;C<w.length;++C)A[C]=w[C];return A}else if(re){var j=new Uint8Array(E);if(j.set)j.set(w);else for(;C<_;++C)j[C]=w[C];return j}return w.length=E,w}function Zt(w){for(var S=new Array(w),_=0;_<w;++_)S[_]=0;return S}function Dr(w,S,_){var E=1,C=0,A=0,j=0,q=0,V=w.length,H=re?new Uint16Array(32):Zt(32);for(A=0;A<32;++A)H[A]=0;for(A=V;A<_;++A)w[A]=0;V=w.length;var G=re?new Uint16Array(V):Zt(V);for(A=0;A<V;++A)H[C=w[A]]++,E<C&&(E=C),G[A]=0;for(H[0]=0,A=1;A<=E;++A)H[A+16]=q=q+H[A-1]<<1;for(A=0;A<V;++A)q=w[A],q!=0&&(G[A]=H[q+16]++);var ae=0;for(A=0;A<V;++A)if(ae=w[A],ae!=0)for(q=F(G[A],E)>>E-ae,j=(1<<E+4-ae)-1;j>=0;--j)S[q|j<<ae]=ae&15|A<<4;return E}var Yr=re?new Uint16Array(512):Zt(512),cn=re?new Uint16Array(32):Zt(32);if(!re){for(var Ht=0;Ht<512;++Ht)Yr[Ht]=0;for(Ht=0;Ht<32;++Ht)cn[Ht]=0}(function(){for(var w=[],S=0;S<32;S++)w.push(5);Dr(w,cn,32);var _=[];for(S=0;S<=143;S++)_.push(8);for(;S<=255;S++)_.push(9);for(;S<=279;S++)_.push(7);for(;S<=287;S++)_.push(8);Dr(_,Yr,288)})();var Sr=(function(){for(var S=re?new Uint8Array(32768):[],_=0,E=0;_<ie.length-1;++_)for(;E<ie[_+1];++E)S[E]=_;for(;E<32768;++E)S[E]=29;var C=re?new Uint8Array(259):[];for(_=0,E=0;_<z.length-1;++_)for(;E<z[_+1];++E)C[E]=_;function A(q,V){for(var H=0;H<q.length;){var G=Math.min(65535,q.length-H),ae=H+G==q.length;for(V.write_shift(1,+ae),V.write_shift(2,G),V.write_shift(2,~G&65535);G-- >0;)V[V.l++]=q[H++]}return V.l}function j(q,V){for(var H=0,G=0,ae=re?new Uint16Array(32768):[];G<q.length;){var le=Math.min(65535,q.length-G);if(le<10){for(H=jt(V,H,+(G+le==q.length)),H&7&&(H+=8-(H&7)),V.l=H/8|0,V.write_shift(2,le),V.write_shift(2,~le&65535);le-- >0;)V[V.l++]=q[G++];H=V.l*8;continue}H=jt(V,H,+(G+le==q.length)+2);for(var pe=0;le-- >0;){var fe=q[G];pe=(pe<<5^fe)&32767;var de=-1,ke=0;if((de=ae[pe])&&(de|=G&-32768,de>G&&(de-=32768),de<G))for(;q[de+ke]==q[G+ke]&&ke<250;)++ke;if(ke>2){fe=C[ke],fe<=22?H=ir(V,H,K[fe+1]>>1)-1:(ir(V,H,3),H+=5,ir(V,H,K[fe-23]>>5),H+=3);var Xe=fe<8?0:fe-4>>2;Xe>0&&(on(V,H,ke-z[fe]),H+=Xe),fe=S[G-de],H=ir(V,H,K[fe]>>3),H-=3;var Xt=fe<4?0:fe-2>>1;Xt>0&&(on(V,H,G-de-ie[fe]),H+=Xt);for(var dt=0;dt<ke;++dt)ae[pe]=G&32767,pe=(pe<<5^q[G])&32767,++G;le-=ke-1}else fe<=143?fe=fe+48:H=Jt(V,H,1),H=ir(V,H,K[fe]),ae[pe]=G&32767,++G}H=ir(V,H,0)-1}return V.l=(H+7)/8|0,V.l}return function(V,H){return V.length<8?A(V,H):j(V,H)}})();function Ie(w){var S=Y(50+Math.floor(w.length*1.1)),_=Sr(w,S);return S.slice(0,_)}var ot=re?new Uint16Array(32768):Zt(32768),sr=re?new Uint16Array(32768):Zt(32768),gt=re?new Uint16Array(128):Zt(128),la=1,Qo=1;function Eu(w,S){var _=Ce(w,S)+257;S+=5;var E=Ce(w,S)+1;S+=5;var C=Ue(w,S)+4;S+=4;for(var A=0,j=re?new Uint8Array(19):Zt(19),q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,H=re?new Uint8Array(8):Zt(8),G=re?new Uint8Array(8):Zt(8),ae=j.length,le=0;le<C;++le)j[T[le]]=A=Oe(w,S),V<A&&(V=A),H[A]++,S+=3;var pe=0;for(H[0]=0,le=1;le<=V;++le)G[le]=pe=pe+H[le-1]<<1;for(le=0;le<ae;++le)(pe=j[le])!=0&&(q[le]=G[pe]++);var fe=0;for(le=0;le<ae;++le)if(fe=j[le],fe!=0){pe=K[q[le]]>>8-fe;for(var de=(1<<7-fe)-1;de>=0;--de)gt[pe|de<<fe]=fe&7|le<<3}var ke=[];for(V=1;ke.length<_+E;)switch(pe=gt[he(w,S)],S+=pe&7,pe>>>=3){case 16:for(A=3+Me(w,S),S+=2,pe=ke[ke.length-1];A-- >0;)ke.push(pe);break;case 17:for(A=3+Oe(w,S),S+=3;A-- >0;)ke.push(0);break;case 18:for(A=11+he(w,S),S+=7;A-- >0;)ke.push(0);break;default:ke.push(pe),V<pe&&(V=pe);break}var Xe=ke.slice(0,_),Xt=ke.slice(_);for(le=_;le<286;++le)Xe[le]=0;for(le=E;le<30;++le)Xt[le]=0;return la=Dr(Xe,ot,286),Qo=Dr(Xt,sr,30),S}function bu(w,S){if(w[0]==3&&!(w[1]&3))return[Qr(S),2];for(var _=0,E=0,C=wc(S||1<<18),A=0,j=C.length>>>0,q=0,V=0;(E&1)==0;){if(E=Oe(w,_),_+=3,E>>>1)E>>1==1?(q=9,V=5):(_=Eu(w,_),q=la,V=Qo);else{_&7&&(_+=8-(_&7));var H=w[_>>>3]|w[(_>>>3)+1]<<8;if(_+=32,H>0)for(!S&&j<A+H&&(C=Xr(C,A+H),j=C.length);H-- >0;)C[A++]=w[_>>>3],_+=8;continue}for(;;){!S&&j<A+32767&&(C=Xr(C,A+32767),j=C.length);var G=Ze(w,_,q),ae=E>>>1==1?Yr[G]:ot[G];if(_+=ae&15,ae>>>=4,(ae>>>8&255)===0)C[A++]=ae;else{if(ae==256)break;ae-=257;var le=ae<8?0:ae-4>>2;le>5&&(le=0);var pe=A+z[ae];le>0&&(pe+=Ze(w,_,le),_+=le),G=Ze(w,_,V),ae=E>>>1==1?cn[G]:sr[G],_+=ae&15,ae>>>=4;var fe=ae<4?0:ae-2>>1,de=ie[ae];for(fe>0&&(de+=Ze(w,_,fe),_+=fe),!S&&j<pe&&(C=Xr(C,pe+100),j=C.length);A<pe;)C[A]=C[A-de],++A}}}return S?[C,_+7>>>3]:[C.slice(0,A),_+7>>>3]}function ec(w,S){var _=w.slice(w.l||0),E=bu(_,S);return w.l+=E[1],E[0]}function tc(w,S){if(w)typeof console!="undefined"&&console.error(S);else throw new Error(S)}function rc(w,S){var _=w;At(_,0);var E=[],C=[],A={FileIndex:E,FullPaths:C};k(A,{root:S.root});for(var j=_.length-4;(_[j]!=80||_[j+1]!=75||_[j+2]!=5||_[j+3]!=6)&&j>=0;)--j;_.l=j+4,_.l+=4;var q=_.read_shift(2);_.l+=6;var V=_.read_shift(4);for(_.l=V,j=0;j<q;++j){_.l+=20;var H=_.read_shift(4),G=_.read_shift(4),ae=_.read_shift(2),le=_.read_shift(2),pe=_.read_shift(2);_.l+=8;var fe=_.read_shift(4),de=o(_.slice(_.l+ae,_.l+ae+le));_.l+=ae+le+pe;var ke=_.l;_.l=fe+4,Tu(_,H,G,A,de),_.l=ke}return A}function Tu(w,S,_,E,C){w.l+=2;var A=w.read_shift(2),j=w.read_shift(2),q=s(w);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var V=w.read_shift(4),H=w.read_shift(4),G=w.read_shift(4),ae=w.read_shift(2),le=w.read_shift(2),pe="",fe=0;fe<ae;++fe)pe+=String.fromCharCode(w[w.l++]);if(le){var de=o(w.slice(w.l,w.l+le));(de[21589]||{}).mt&&(q=de[21589].mt),((C||{})[21589]||{}).mt&&(q=C[21589].mt)}w.l+=le;var ke=w.slice(w.l,w.l+H);switch(j){case 8:ke=B(w,G);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+j)}var Xe=!1;A&8&&(V=w.read_shift(4),V==134695760&&(V=w.read_shift(4),Xe=!0),H=w.read_shift(4),G=w.read_shift(4)),H!=S&&tc(Xe,"Bad compressed size: "+S+" != "+H),G!=_&&tc(Xe,"Bad uncompressed size: "+_+" != "+G),rs(E,pe,ke,{unsafe:!0,mt:q})}function Su(w,S){var _=S||{},E=[],C=[],A=Y(1),j=_.compression?8:0,q=0,V=!1;V&&(q|=8);var H=0,G=0,ae=0,le=0,pe=w.FullPaths[0],fe=pe,de=w.FileIndex[0],ke=[],Xe=0;for(H=1;H<w.FullPaths.length;++H)if(fe=w.FullPaths[H].slice(pe.length),de=w.FileIndex[H],!(!de.size||!de.content||fe=="Sh33tJ5")){var Xt=ae,dt=Y(fe.length);for(G=0;G<fe.length;++G)dt.write_shift(1,fe.charCodeAt(G)&127);dt=dt.slice(0,dt.l),ke[le]=Hd.buf(de.content,0);var Qt=de.content;j==8&&(Qt=O(Qt)),A=Y(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,q),A.write_shift(2,j),de.mt?i(A,de.mt):A.write_shift(4,0),A.write_shift(-4,q&8?0:ke[le]),A.write_shift(4,q&8?0:Qt.length),A.write_shift(4,q&8?0:de.content.length),A.write_shift(2,dt.length),A.write_shift(2,0),ae+=A.length,E.push(A),ae+=dt.length,E.push(dt),ae+=Qt.length,E.push(Qt),q&8&&(A=Y(12),A.write_shift(-4,ke[le]),A.write_shift(4,Qt.length),A.write_shift(4,de.content.length),ae+=A.l,E.push(A)),A=Y(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,q),A.write_shift(2,j),A.write_shift(4,0),A.write_shift(-4,ke[le]),A.write_shift(4,Qt.length),A.write_shift(4,de.content.length),A.write_shift(2,dt.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,Xt),Xe+=A.l,C.push(A),Xe+=dt.length,C.push(dt),++le}return A=Y(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,le),A.write_shift(2,le),A.write_shift(4,Xe),A.write_shift(4,ae),A.write_shift(2,0),Et([Et(E),Et(C),A])}var ri={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Cu(w,S){if(w.ctype)return w.ctype;var _=w.name||"",E=_.match(/\.([^\.]+)$/);return E&&ri[E[1]]||S&&(E=(_=S).match(/[\.\\]([^\.\\])+$/),E&&ri[E[1]])?ri[E[1]]:"application/octet-stream"}function Au(w){for(var S=Cn(w),_=[],E=0;E<S.length;E+=76)_.push(S.slice(E,E+76));return _.join(`\r
`)+`\r
`}function Ou(w){var S=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(H){var G=H.charCodeAt(0).toString(16).toUpperCase();return"="+(G.length==1?"0"+G:G)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var _=[],E=S.split(`\r
`),C=0;C<E.length;++C){var A=E[C];if(A.length==0){_.push("");continue}for(var j=0;j<A.length;){var q=76,V=A.slice(j,j+q);V.charAt(q-1)=="="?q--:V.charAt(q-2)=="="?q-=2:V.charAt(q-3)=="="&&(q-=3),V=A.slice(j,j+q),j+=q,j<A.length&&(V+="="),_.push(V)}}return _.join(`\r
`)}function Fu(w){for(var S=[],_=0;_<w.length;++_){for(var E=w[_];_<=w.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+w[++_];S.push(E)}for(var C=0;C<S.length;++C)S[C]=S[C].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return tr(S.join(`\r
`))}function Iu(w,S,_){for(var E="",C="",A="",j,q=0;q<10;++q){var V=S[q];if(!V||V.match(/^\s*$/))break;var H=V.match(/^(.*?):\s*([^\s].*)$/);if(H)switch(H[1].toLowerCase()){case"content-location":E=H[2].trim();break;case"content-type":A=H[2].trim();break;case"content-transfer-encoding":C=H[2].trim();break}}switch(++q,C.toLowerCase()){case"base64":j=tr(ar(S.slice(q).join("")));break;case"quoted-printable":j=Fu(S.slice(q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}var G=rs(w,E.slice(_.length),j,{unsafe:!0});A&&(G.ctype=A)}function Pu(w,S){if(se(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var _=S&&S.root||"",E=(Fe&&Buffer.isBuffer(w)?w.toString("binary"):se(w)).split(`\r
`),C=0,A="";for(C=0;C<E.length;++C)if(A=E[C],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),_||(_=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,_.length)!=_))for(;_.length>0&&(_=_.slice(0,_.length-1),_=_.slice(0,_.lastIndexOf("/")+1),A.slice(0,_.length)!=_););var j=(E[1]||"").match(/boundary="(.*?)"/);if(!j)throw new Error("MAD cannot find boundary");var q="--"+(j[1]||""),V=[],H=[],G={FileIndex:V,FullPaths:H};k(G);var ae,le=0;for(C=0;C<E.length;++C){var pe=E[C];pe!==q&&pe!==q+"--"||(le++&&Iu(G,E.slice(ae,C),_),ae=C)}return G}function Ru(w,S){var _=S||{},E=_.boundary||"SheetJS";E="------="+E;for(var C=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],A=w.FullPaths[0],j=A,q=w.FileIndex[0],V=1;V<w.FullPaths.length;++V)if(j=w.FullPaths[V].slice(A.length),q=w.FileIndex[V],!(!q.size||!q.content||j=="Sh33tJ5")){j=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ke){return"_x"+ke.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ke){return"_u"+ke.charCodeAt(0).toString(16)+"_"});for(var H=q.content,G=Fe&&Buffer.isBuffer(H)?H.toString("binary"):se(H),ae=0,le=Math.min(1024,G.length),pe=0,fe=0;fe<=le;++fe)(pe=G.charCodeAt(fe))>=32&&pe<128&&++ae;var de=ae>=le*4/5;C.push(E),C.push("Content-Location: "+(_.root||"file:///C:/SheetJS/")+j),C.push("Content-Transfer-Encoding: "+(de?"quoted-printable":"base64")),C.push("Content-Type: "+Cu(q,j)),C.push(""),C.push(de?Ou(G):Au(G))}return C.push(E+`--\r
`),C.join(`\r
`)}function Nu(w){var S={};return k(S,w),S}function rs(w,S,_,E){var C=E&&E.unsafe;C||k(w);var A=!C&&me.find(w,S);if(!A){var j=w.FullPaths[0];S.slice(0,j.length)==j?j=S:(j.slice(-1)!="/"&&(j+="/"),j=(j+S).replace("//","/")),A={name:n(S),type:2},w.FileIndex.push(A),w.FullPaths.push(j),C||me.utils.cfb_gc(w)}return A.content=_,A.size=_?_.length:0,E&&(E.CLSID&&(A.clsid=E.CLSID),E.mt&&(A.mt=E.mt),E.ct&&(A.ct=E.ct)),A}function Du(w,S){k(w);var _=me.find(w,S);if(_){for(var E=0;E<w.FileIndex.length;++E)if(w.FileIndex[E]==_)return w.FileIndex.splice(E,1),w.FullPaths.splice(E,1),!0}return!1}function Lu(w,S,_){k(w);var E=me.find(w,S);if(E){for(var C=0;C<w.FileIndex.length;++C)if(w.FileIndex[C]==E)return w.FileIndex[C].name=n(_),w.FullPaths[C]=_,!0}return!1}function Bu(w){N(w,!0)}return r.find=W,r.read=P,r.parse=f,r.write=X,r.writeFile=xe,r.utils={cfb_new:Nu,cfb_add:rs,cfb_del:Du,cfb_mov:Lu,cfb_gc:Bu,ReadShift:vn,CheckField:r0,prep_blob:At,bconcat:Et,use_zlib:b,_deflateRaw:Ie,_inflateRaw:ec,consts:Q},r})(),Ba;function Vd(e){return typeof e=="string"?Ni(e):Array.isArray(e)?md(e):e}function $n(e,r,t){if(typeof Ba!="undefined"&&Ba.writeFileSync)return t?Ba.writeFileSync(e,r,t):Ba.writeFileSync(e,r);if(typeof Deno!="undefined"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Ni(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var a=t=="utf8"?Fr(r):r;if(typeof IE_SaveFile!="undefined")return IE_SaveFile(a,e);if(typeof Blob!="undefined"){var n=new Blob([Vd(a)],{type:"application/octet-stream"});if(typeof navigator!="undefined"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs!="undefined")return saveAs(n,e);if(typeof URL!="undefined"&&typeof document!="undefined"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout!="undefined"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=aa(r)),o.write(r),o.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Wd(e){if(typeof Ba!="undefined")return Ba.readFileSync(e);if(typeof Deno!="undefined")return Deno.readFileSync(e);if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function st(e){for(var r=Object.keys(e),t=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&t.push(r[a]);return t}function Ac(e,r){for(var t=[],a=st(e),n=0;n!==a.length;++n)t[e[a[n]][r]]==null&&(t[e[a[n]][r]]=a[n]);return t}function Li(e){for(var r=[],t=st(e),a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}function Bi(e){for(var r=[],t=st(e),a=0;a!==t.length;++a)r[e[t[a]]]=parseInt(t[a],10);return r}function Gd(e){for(var r=[],t=st(e),a=0;a!==t.length;++a)r[e[t[a]]]==null&&(r[e[t[a]]]=[]),r[e[t[a]]].push(t[a]);return r}var bi=new Date(1899,11,30,0,0,0);function yt(e,r){var t=e.getTime();r&&(t-=1462*24*60*60*1e3);var a=bi.getTime()+(e.getTimezoneOffset()-bi.getTimezoneOffset())*6e4;return(t-a)/(1440*60*1e3)}var Ul=new Date,zd=bi.getTime()+(Ul.getTimezoneOffset()-bi.getTimezoneOffset())*6e4,Oc=Ul.getTimezoneOffset();function Mi(e){var r=new Date;return r.setTime(e*24*60*60*1e3+zd),r.getTimezoneOffset()!==Oc&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Oc)*6e4),r}function Xd(e){var r=0,t=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(t=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(a)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}r+=t*parseInt(n[i],10)}return r}var Fc=new Date("2017-02-19T19:06:09.000Z"),$l=isNaN(Fc.getFullYear())?new Date("2/19/17"):Fc,Yd=$l.getFullYear()==2017;function qe(e,r){var t=new Date(e);if(Yd)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if($l.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return e.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function va(e,r){if(Fe&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Fr(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Fr(Cl(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder!="undefined")try{if(r){if(e[0]==255&&e[1]==254)return Fr(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Fr(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return t[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Ke(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Ke(e[t]));return r}function at(e,r){for(var t="";t.length<r;)t+=e;return t}function br(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return t=-t,i}),!isNaN(r=Number(a)))?r/t:r}var qd=["january","february","march","april","may","june","july","august","september","october","november","december"];function Wa(e){var r=new Date(e),t=new Date(NaN),a=r.getYear(),n=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&qd.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return a<0||a>8099?t:(n>0||i>1)&&a!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Kd=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,a,n){if(e||typeof a=="string")return t.split(a);for(var i=t.split(a),s=[i[0]],o=1;o<i.length;++o)s.push(n),s.push(i[o]);return s}})();function jl(e){return e?e.content&&e.type?va(e.content,!0):e.data?mn(e.data):e.asNodeBuffer&&Fe?mn(e.asNodeBuffer().toString("binary")):e.asBinary?mn(e.asBinary()):e._data&&e._data.getContent?mn(va(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Hl(e){if(!e)return null;if(e.data)return Fs(e.data);if(e.asNodeBuffer&&Fe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Fs(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Jd(e){return e&&e.name.slice(-4)===".bin"?Hl(e):jl(e)}function ur(e,r){for(var t=e.FullPaths||st(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<t.length;++i){var s=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==s||n==s)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function Ys(e,r){var t=ur(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function pt(e,r,t){if(!t)return Jd(Ys(e,r));if(!r)return null;try{return pt(e,r)}catch{return null}}function rr(e,r,t){if(!t)return jl(Ys(e,r));if(!r)return null;try{return rr(e,r)}catch{return null}}function Vl(e,r,t){if(!t)return Hl(Ys(e,r));if(!r)return null;try{return Vl(e,r)}catch{return null}}function Ic(e){for(var r=e.FullPaths||st(e.files),t=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&t.push(r[a].replace(/^Root Entry[\/]/,""));return t.sort()}function Te(e,r,t){if(e.FullPaths){if(typeof t=="string"){var a;return Fe?a=Hr(t):a=gd(t),me.utils.cfb_add(e,r,a)}me.utils.cfb_add(e,r,t)}else e.file(r,t)}function qs(){return me.utils.cfb_new()}function Wl(e,r){switch(r.type){case"base64":return me.read(e,{type:"base64"});case"binary":return me.read(e,{type:"binary"});case"buffer":case"array":return me.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function xn(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var ft=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Zd=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Pc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Qd=/<[^>]*>/g,Mt=ft.match(Pc)?Pc:Qd,eh=/<\w*:/,th=/<(\/?)\w+:/;function ye(e,r,t){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(r||(a[0]=e.slice(0,n)),n===e.length)return a;var s=e.match(Zd),o=0,c="",l=0,f="",d="",u=1;if(s)for(l=0;l!=s.length;++l){for(d=s[l],i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(f=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(u=(n=d.charCodeAt(i+1))==34||n==39?1:0,c=d.slice(i+1+u,d.length-u),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=c,t||(a[f.toLowerCase()]=c);else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(a[p]&&f.slice(o-3,o)=="ext")continue;a[p]=c,t||(a[p.toLowerCase()]=c)}}return a}function Pr(e){return e.replace(th,"<$1")}var Gl={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ks=Li(Gl),Le=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return Gl[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=n.indexOf("]]>");return t(n.slice(0,i))+n.slice(i+9,s)+t(n.slice(s+3))}})(),Js=/[&<>'"]/g,rh=/[\u0000-\u0008\u000b-\u001f]/g;function Ge(e){var r=e+"";return r.replace(Js,function(t){return Ks[t]}).replace(rh,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Rc(e){return Ge(e).replace(/ /g,"_x0020_")}var zl=/[\u0000-\u001f]/g;function Zs(e){var r=e+"";return r.replace(Js,function(t){return Ks[t]}).replace(/\n/g,"<br/>").replace(zl,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function ah(e){var r=e+"";return r.replace(Js,function(t){return Ks[t]}).replace(zl,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Nc=(function(){var e=/&#(\d+);/g;function r(t,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}})();function nh(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ye(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xs(e){for(var r="",t=0,a=0,n=0,i=0,s=0,o=0;t<e.length;){if(a=e.charCodeAt(t++),a<128){r+=String.fromCharCode(a);continue}if(n=e.charCodeAt(t++),a>191&&a<224){s=(a&31)<<6,s|=n&63,r+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}s=e.charCodeAt(t++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function Dc(e){var r=Qr(2*e.length),t,a,n=1,i=0,s=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(t=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,t=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(r[i++]=s&255,r[i++]=s>>>8,s=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")}function Lc(e){return Hr(e,"binary").toString("utf8")}var ui="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",ze=Fe&&(Lc(ui)==xs(ui)&&Lc||Dc(ui)==xs(ui)&&Dc)||xs,Fr=Fe?function(e){return Hr(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,a=0,n=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(t++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},On=(function(){var e={};return function(t,a){var n=t+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}})(),Xl=(function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),ih=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),sh=/<\/?(?:vt:)?variant>/g,oh=/<(?:vt:)([^>]*)>([\s\S]*)</;function Bc(e,r){var t=ye(e),a=e.match(ih(t.baseType))||[],n=[];if(a.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return n}return a.forEach(function(i){var s=i.replace(sh,"").match(oh);s&&n.push({v:ze(s[2]),t:s[1]})}),n}var Yl=/(^\s|\s$|\n)/;function Ot(e,r){return"<"+e+(r.match(Yl)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Fn(e){return st(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function oe(e,r,t){return"<"+e+(t!=null?Fn(t):"")+(r!=null?(r.match(Yl)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Is(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function ch(e,r){switch(typeof e){case"string":var t=oe("vt:lpwstr",Ge(e));return r&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return oe((e|0)==e?"vt:i4":"vt:r8",Ge(String(e)));case"boolean":return oe("vt:bool",e?"true":"false")}if(e instanceof Date)return oe("vt:filetime",Is(e));throw new Error("Unable to serialize "+e)}function Qs(e){if(Fe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return ze(aa(Gs(e)));throw new Error("Bad input format: expected Buffer or string")}var In=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,vt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ea=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],er={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function lh(e,r){for(var t=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),n=e[r+6]&15,i=5;i>=0;--i)n=n*256+e[r+i];return a==2047?n==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),t*Math.pow(2,a-52)*n)}function fh(e,r,t){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,i=0,s=a?-r:r;isFinite(s)?s==0?n=i=0:(n=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[t+o]=i&255;e[t+6]=(n&15)<<4|i&15,e[t+7]=n>>4|a}var Mc=function(e){for(var r=[],t=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=t)r.push.apply(r,e[0][a].slice(n,n+t));return r},Uc=Fe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Hr(r)})):Mc(e)}:Mc,$c=function(e,r,t){for(var a=[],n=r;n<t;n+=2)a.push(String.fromCharCode(Br(e,n)));return a.join("").replace(Dt,"")},Ui=Fe?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Dt,""):$c(e,r,t)}:$c,jc=function(e,r,t){for(var a=[],n=r;n<r+t;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},ql=Fe?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):jc(e,r,t)}:jc,Hc=function(e,r,t){for(var a=[],n=r;n<t;n++)a.push(String.fromCharCode(La(e,n)));return a.join("")},qa=Fe?function(r,t,a){return Buffer.isBuffer(r)?r.toString("utf8",t,a):Hc(r,t,a)}:Hc,Kl=function(e,r){var t=kt(e,r);return t>0?qa(e,r+4,r+4+t-1):""},eo=Kl,Jl=function(e,r){var t=kt(e,r);return t>0?qa(e,r+4,r+4+t-1):""},to=Jl,Zl=function(e,r){var t=2*kt(e,r);return t>0?qa(e,r+4,r+4+t-1):""},ro=Zl,Ql=function(r,t){var a=kt(r,t);return a>0?Ui(r,t+4,t+4+a):""},ao=Ql,e0=function(e,r){var t=kt(e,r);return t>0?qa(e,r+4,r+4+t):""},no=e0,t0=function(e,r){return lh(e,r)},Ti=t0,io=function(r){return Array.isArray(r)||typeof Uint8Array!="undefined"&&r instanceof Uint8Array};Fe&&(eo=function(r,t){if(!Buffer.isBuffer(r))return Kl(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},to=function(r,t){if(!Buffer.isBuffer(r))return Jl(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},ro=function(r,t){if(!Buffer.isBuffer(r))return Zl(r,t);var a=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a-1)},ao=function(r,t){if(!Buffer.isBuffer(r))return Ql(r,t);var a=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a)},no=function(r,t){if(!Buffer.isBuffer(r))return e0(r,t);var a=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+a)},Ti=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):t0(r,t)},io=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array!="undefined"&&r instanceof Uint8Array});function uh(){Ui=function(e,r,t){return He.utils.decode(1200,e.slice(r,t)).replace(Dt,"")},qa=function(e,r,t){return He.utils.decode(65001,e.slice(r,t))},eo=function(e,r){var t=kt(e,r);return t>0?He.utils.decode(Va,e.slice(r+4,r+4+t-1)):""},to=function(e,r){var t=kt(e,r);return t>0?He.utils.decode(Ir,e.slice(r+4,r+4+t-1)):""},ro=function(e,r){var t=2*kt(e,r);return t>0?He.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},ao=function(e,r){var t=kt(e,r);return t>0?He.utils.decode(1200,e.slice(r+4,r+4+t)):""},no=function(e,r){var t=kt(e,r);return t>0?He.utils.decode(65001,e.slice(r+4,r+4+t)):""}}typeof He!="undefined"&&uh();var La=function(e,r){return e[r]},Br=function(e,r){return e[r+1]*256+e[r]},dh=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},kt=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},ua=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},hh=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function vn(e,r){var t="",a,n,i=[],s,o,c,l;switch(r){case"dbcs":if(l=this.l,Fe&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(Br(this,l)),l+=2;e*=2;break;case"utf8":t=qa(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Ui(this,this.l,this.l+e);break;case"wstr":if(typeof He!="undefined")t=He.utils.decode(Ir,this.slice(this.l,this.l+2*e));else return vn.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=eo(this,this.l),e=4+kt(this,this.l);break;case"lpstr-cp":t=to(this,this.l),e=4+kt(this,this.l);break;case"lpwstr":t=ro(this,this.l),e=4+2*kt(this,this.l);break;case"lpp4":e=4+kt(this,this.l),t=ao(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kt(this,this.l),t=no(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=La(this,this.l+e++))!==0;)i.push(fi(s));t=i.join("");break;case"_wstr":for(e=0,t="";(s=Br(this,this.l+e))!==0;)i.push(fi(s)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=La(this,l),this.l=l+1,o=vn.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(fi(Br(this,l))),l+=2}t=i.join(""),e*=2;break;case"cpstr":if(typeof He!="undefined"){t=He.utils.decode(Ir,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=La(this,l),this.l=l+1,o=vn.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(fi(La(this,l))),l+=1}t=i.join("");break;default:switch(e){case 1:return a=La(this,this.l),this.l++,a;case 2:return a=(r==="i"?dh:Br)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(e>0?ua:hh)(this,this.l),this.l+=4,a):(n=kt(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return e==8?n=Ti(this,this.l):n=Ti([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:t=ql(this,this.l,e);break}}return this.l+=e,t}var ph=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},mh=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},gh=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function xh(e,r,t){var a=0,n=0;if(t==="dbcs"){for(n=0;n!=r.length;++n)gh(this,r.charCodeAt(n),this.l+2*n);a=2*r.length}else if(t==="sbcs"){if(typeof He!="undefined"&&Va==874)for(n=0;n!=r.length;++n){var i=He.utils.encode(Va,r.charAt(n));this[this.l+n]=i[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;a=r.length}else if(t==="hex"){for(;n<e;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(r.length,e);++n){var o=r.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,ph(this,r,this.l);break;case 8:if(a=8,t==="f"){fh(this,r,this.l);break}case 16:break;case-4:a=4,mh(this,r,this.l);break}return this.l+=a,this}function r0(e,r){var t=ql(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function At(e,r){e.l=r,e.read_shift=vn,e.chk=r0,e.write_shift=xh}function Bt(e,r){e.l+=r}function Y(e){var r=Qr(e);return At(r,0),r}function Vr(e,r,t){if(e){var a,n,i;At(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=Bn[o]||Bn[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var f=l.f&&l.f(e,i,t);if(e.l=c,r(f,l,o))return}}}function qt(){var e=[],r=Fe?256:2048,t=function(l){var f=Y(l);return At(f,0),f},a=t(r),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(l){return a&&l<a.length-a.l?a:(n(),a=t(Math.max(l+1,r)))},s=function(){return n(),Et(e)},o=function(l){n(),a=l,a.l==null&&(a.l=a.length),i(r)};return{next:i,push:o,end:s,_bufs:e}}function Z(e,r,t,a){var n=+r,i;if(!isNaN(n)){a||(a=Bn[n].p||(t||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var s=e.next(i);n<=127?s.write_shift(1,n):(s.write_shift(1,(n&127)+128),s.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)s.write_shift(1,(a&127)+128),a>>=7;else{s.write_shift(1,a);break}a>0&&io(t)&&e.push(t)}}function yn(e,r,t){var a=Ke(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Vc(e,r,t){var a=Ke(e);return a.s=yn(a.s,r.s,t),a.e=yn(a.e,r.s,t),a}function wn(e,r){if(e.cRel&&e.c<0)for(e=Ke(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Ke(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=ve(e);return!e.cRel&&e.cRel!=null&&(t=wh(t)),!e.rRel&&e.rRel!=null&&(t=vh(t)),t}function vs(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+et(e.s.c)+":"+(e.e.cRel?"":"$")+et(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+lt(e.s.r)+":"+(e.e.rRel?"":"$")+lt(e.e.r):wn(e.s,r.biff)+":"+wn(e.e,r.biff)}function so(e){return parseInt(yh(e),10)-1}function lt(e){return""+(e+1)}function vh(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yh(e){return e.replace(/\$(\d+)$/,"$1")}function oo(e){for(var r=_h(e),t=0,a=0;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function et(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function wh(e){return e.replace(/^([A-Z])/,"$$$1")}function _h(e){return e.replace(/^\$([A-Z])/,"$1")}function kh(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function tt(e){for(var r=0,t=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:r-1}}function ve(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Kt(e){var r=e.indexOf(":");return r==-1?{s:tt(e),e:tt(e)}:{s:tt(e.slice(0,r)),e:tt(e.slice(r+1))}}function Ee(e,r){return typeof r=="undefined"||typeof r=="number"?Ee(e.s,e.e):(typeof e!="string"&&(e=ve(e)),typeof r!="string"&&(r=ve(r)),e==r?e:e+":"+r)}function Be(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,n=0,i=e.length;for(t=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.s.c=--t,t=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;if(r.s.r=--t,a===i||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,t=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.e.c=--t,t=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;return r.e.r=--t,r}function Wc(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=pr(e.z,t?yt(r):r)}catch{}try{return e.w=pr((e.XF||{}).numFmtId||(t?14:0),t?yt(r):r)}catch{return""+r}}function jr(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Wr[e.v]||e.v:r==null?Wc(e,e.v):Wc(e,r))}function na(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function a0(e,r,t){var a=t||{},n=e?Array.isArray(e):a.dense;it!=null&&n==null&&(n=it);var i=e||(n?[]:{}),s=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?tt(a.origin):a.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Be(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),s==-1&&(l.e.r=s=f.e.r+1)}for(var d=0;d!=r.length;++d)if(r[d]){if(!Array.isArray(r[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=r[d].length;++u)if(typeof r[d][u]!="undefined"){var p={v:r[d][u]},m=s+d,h=o+u;if(l.s.r>m&&(l.s.r=m),l.s.c>h&&(l.s.c=h),l.e.r<m&&(l.e.r=m),l.e.c<h&&(l.e.c=h),r[d][u]&&typeof r[d][u]=="object"&&!Array.isArray(r[d][u])&&!(r[d][u]instanceof Date))p=r[d][u];else if(Array.isArray(p.v)&&(p.f=r[d][u][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(a.nullError)p.t="e",p.v=0;else if(a.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=a.dateNF||ge[14],a.cellDates?(p.t="d",p.w=pr(p.z,yt(p.v))):(p.t="n",p.v=yt(p.v),p.w=pr(p.z,p.v))):p.t="s";if(n)i[m]||(i[m]=[]),i[m][h]&&i[m][h].z&&(p.z=i[m][h].z),i[m][h]=p;else{var g=ve({c:h,r:m});i[g]&&i[g].z&&(p.z=i[g].z),i[g]=p}}}return l.s.c<1e7&&(i["!ref"]=Ee(l)),i}function Ka(e,r){return a0(null,e,r)}function Eh(e){return e.read_shift(4,"i")}function Tr(e,r){return r||(r=Y(4)),r.write_shift(4,e),r}function Lt(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function bt(e,r){var t=!1;return r==null&&(t=!0,r=Y(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function bh(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Th(e,r){return r||(r=Y(4)),r.write_shift(2,e.ich||0),r.write_shift(2,e.ifnt||0),r}function co(e,r){var t=e.l,a=e.read_shift(1),n=Lt(e),i=[],s={t:n,h:n};if((a&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(bh(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}function Sh(e,r){var t=!1;return r==null&&(t=!0,r=Y(15+4*e.t.length)),r.write_shift(1,0),bt(e.t,r),t?r.slice(0,r.l):r}var Ch=co;function Ah(e,r){var t=!1;return r==null&&(t=!0,r=Y(23+4*e.t.length)),r.write_shift(1,1),bt(e.t,r),r.write_shift(4,1),Th({ich:0,ifnt:0},r),t?r.slice(0,r.l):r}function mr(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function ba(e,r){return r==null&&(r=Y(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Ta(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Sa(e,r){return r==null&&(r=Y(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Oh=Lt,n0=bt;function lo(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Si(e,r){var t=!1;return r==null&&(t=!0,r=Y(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Fh=Lt,Ps=lo,fo=Si;function uo(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,a=r[0]&2;e.l+=4;var n=a===0?Ti([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):ua(r,0)>>2;return t?n/100:n}function i0(e,r){r==null&&(r=Y(4));var t=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(a=1,t=1),a)r.write_shift(-4,((t?n:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function s0(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function Ih(e,r){return r||(r=Y(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Ca=s0,Ja=Ih;function Nt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ya(e,r){return(r||Y(8)).write_shift(8,e,"f")}function Ph(e){var r={},t=e.read_shift(1),a=t>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var l=ha[n];l&&(r.rgb=Rn(l));break;case 2:r.rgb=Rn([s,o,c]);break;case 3:r.theme=n;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function Ci(e,r){if(r||(r=Y(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),r.write_shift(1,parseInt(a.slice(0,2),16)),r.write_shift(1,parseInt(a.slice(2,4),16)),r.write_shift(1,parseInt(a.slice(4,6),16)),r.write_shift(1,255)}return r}function Rh(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Nh(e,r){r||(r=Y(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function o0(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Dh(e){return o0(e,1)}function Lh(e){return o0(e,2)}var ho=2,Yt=3,di=11,Gc=12,Ai=19;var hi=64,Bh=65,Mh=71;var Uh=4108,$h=4126,_t=80,c0=81,jh=[_t,c0],Rs={1:{n:"CodePage",t:ho},2:{n:"Category",t:_t},3:{n:"PresentationFormat",t:_t},4:{n:"ByteCount",t:Yt},5:{n:"LineCount",t:Yt},6:{n:"ParagraphCount",t:Yt},7:{n:"SlideCount",t:Yt},8:{n:"NoteCount",t:Yt},9:{n:"HiddenCount",t:Yt},10:{n:"MultimediaClipCount",t:Yt},11:{n:"ScaleCrop",t:di},12:{n:"HeadingPairs",t:Uh},13:{n:"TitlesOfParts",t:$h},14:{n:"Manager",t:_t},15:{n:"Company",t:_t},16:{n:"LinksUpToDate",t:di},17:{n:"CharacterCount",t:Yt},19:{n:"SharedDoc",t:di},22:{n:"HyperlinksChanged",t:di},23:{n:"AppVersion",t:Yt,p:"version"},24:{n:"DigSig",t:Bh},26:{n:"ContentType",t:_t},27:{n:"ContentStatus",t:_t},28:{n:"Language",t:_t},29:{n:"Version",t:_t},255:{},2147483648:{n:"Locale",t:Ai},2147483651:{n:"Behavior",t:Ai},1919054434:{}},Ns={1:{n:"CodePage",t:ho},2:{n:"Title",t:_t},3:{n:"Subject",t:_t},4:{n:"Author",t:_t},5:{n:"Keywords",t:_t},6:{n:"Comments",t:_t},7:{n:"Template",t:_t},8:{n:"LastAuthor",t:_t},9:{n:"RevNumber",t:_t},10:{n:"EditTime",t:hi},11:{n:"LastPrinted",t:hi},12:{n:"CreatedDate",t:hi},13:{n:"ModifiedDate",t:hi},14:{n:"PageCount",t:Yt},15:{n:"WordCount",t:Yt},16:{n:"CharCount",t:Yt},17:{n:"Thumbnail",t:Mh},18:{n:"Application",t:_t},19:{n:"DocSecurity",t:Yt},255:{},2147483648:{n:"Locale",t:Ai},2147483651:{n:"Behavior",t:Ai},1919054434:{}},zc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Hh=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Vh(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Wh=Vh([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ha=Ke(Wh),Wr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},l0={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ds={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},pi={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function po(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Gh(e){var r=po();if(!e||!e.match)return r;var t={};if((e.match(Mt)||[]).forEach(function(a){var n=ye(a);switch(n[0].replace(eh,"<")){case"<?xml":break;case"<Types":r.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":r[Ds[n.ContentType]]!==void 0&&r[Ds[n.ContentType]].push(n.PartName);break}}),r.xmlns!==vt.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function f0(e,r){var t=Gd(Ds),a=[],n;a[a.length]=ft,a[a.length]=oe("Types",null,{xmlns:vt.CT,"xmlns:xsd":vt.xsd,"xmlns:xsi":vt.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return oe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=oe("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:pi[c][r.bookType]||pi[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(l){a[a.length]=oe("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:pi[c][r.bookType]||pi[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(l){a[a.length]=oe("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Se={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Pn(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function _n(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(Mt)||[]).forEach(function(n){var i=ye(n);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:xn(i.Target,r);t[o]=s,a[i.Id]=s}}),t["!id"]=a,t}function $a(e){var r=[ft,oe("Relationships",null,{xmlns:vt.RELS})];return st(e["!id"]).forEach(function(t){r[r.length]=oe("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function We(e,r,t,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,n.Id="rId"+r,n.Type=a,n.Target=t,i?n.TargetMode=i:[Se.HLINK,Se.XPATH,Se.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,r}var zh="application/vnd.oasis.opendocument.spreadsheet";function Xh(e,r){for(var t=Qs(e),a,n;a=In.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if(n=ye(a[0],!1),n.path=="/"&&n.type!==zh)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}function Yh(e){var r=[ft];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Xc(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function qh(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Kh(e){var r=[ft];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Xc(e[t][0],e[t][1])),r.push(qh("",e[t][0]));return r.push(Xc("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function u0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Sn.version+"</meta:generator></office:meta></office:document-meta>"}var hr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Jh=(function(){for(var e=new Array(hr.length),r=0;r<hr.length;++r){var t=hr[r],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function d0(e){var r={};e=ze(e);for(var t=0;t<hr.length;++t){var a=hr[t],n=e.match(Jh[t]);n!=null&&n.length>0&&(r[a[1]]=Le(n[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=qe(r[a[1]]))}return r}function ys(e,r,t,a,n){n[e]!=null||r==null||r===""||(n[e]=r,r=Ge(r),a[a.length]=t?oe(e,r,t):Ot(e,r))}function h0(e,r){var t=r||{},a=[ft,oe("cp:coreProperties",null,{"xmlns:cp":vt.CORE_PROPS,"xmlns:dc":vt.dc,"xmlns:dcterms":vt.dcterms,"xmlns:dcmitype":vt.dcmitype,"xmlns:xsi":vt.xsi})],n={};if(!e&&!t.Props)return a.join("");e&&(e.CreatedDate!=null&&ys("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Is(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&ys("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Is(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=hr.length;++i){var s=hr[i],o=t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ys(s[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var pa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],p0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function m0(e,r,t,a){var n=[];if(typeof e=="string")n=Bc(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(f){return{v:f}}));var s=typeof r=="string"?Bc(r,a).map(function(f){return f.v}):r,o=0,c=0;if(s.length>0)for(var l=0;l!==n.length;l+=2){switch(c=+n[l+1].v,n[l].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=c,t.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(o,o+c);break}o+=c}}function Zh(e,r,t){var a={};return r||(r={}),e=ze(e),pa.forEach(function(n){var i=(e.match(On(n[0]))||[])[1];switch(n[2]){case"string":i&&(r[n[1]]=Le(i));break;case"bool":r[n[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));s&&s.length>0&&(a[n[1]]=s[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&m0(a.HeadingPairs,a.TitlesOfParts,r,t),r}function g0(e){var r=[],t=oe;return e||(e={}),e.Application="SheetJS",r[r.length]=ft,r[r.length]=oe("Properties",null,{xmlns:vt.EXT_PROPS,"xmlns:vt":vt.vt}),pa.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Ge(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(r[r.length]=t(a[0],n))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Ge(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Qh=/<[^>]+>[^<]*/g;function ep(e,r){var t={},a="",n=e.match(Qh);if(n)for(var i=0;i!=n.length;++i){var s=n[i],o=ye(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Le(o.name);break;case"</property>":a=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[a]=Le(f);break;case"bool":t[a]=Ye(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(f);break;case"filetime":case"date":t[a]=qe(f);break;case"cy":case"error":t[a]=Le(f);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console!="undefined"&&console.warn("Unexpected",s,l,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return t}function x0(e){var r=[ft,oe("Properties",null,{xmlns:vt.CUST_PROPS,"xmlns:vt":vt.vt})];if(!e)return r.join("");var t=1;return st(e).forEach(function(n){++t,r[r.length]=oe("property",ch(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Ge(n)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ls={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ws;function tp(e,r,t){ws||(ws=Li(Ls)),r=ws[r]||r,e[r]=t}function rp(e,r){var t=[];return st(Ls).map(function(a){for(var n=0;n<hr.length;++n)if(hr[n][1]==a)return hr[n];for(n=0;n<pa.length;++n)if(pa[n][1]==a)return pa[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=r&&r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(Ot(Ls[a[1]]||a[1],n))}}),oe("DocumentProperties",t.join(""),{xmlns:er.o})}function ap(e,r){var t=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&st(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<hr.length;++s)if(i==hr[s][1])return;for(s=0;s<pa.length;++s)if(i==pa[s][1])return;for(s=0;s<t.length;++s)if(i==t[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(oe(Rc(i),o,{"dt:dt":c}))}}),r&&st(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=r[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),n.push(oe(Rc(i),s,{"dt:dt":o}))}}),"<"+a+' xmlns="'+er.o+'">'+n.join("")+"</"+a+">"}function mo(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function np(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,a=t%Math.pow(2,32),n=(t-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var s=Y(8);return s.write_shift(4,a),s.write_shift(4,n),s}function v0(e,r,t){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return n}function y0(e,r,t){var a=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(a.length+1&3)&3),a}function w0(e,r,t){return r===31?y0(e):v0(e,r,t)}function Bs(e,r,t){return w0(e,r,t===!1?0:4)}function ip(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return w0(e,r,0)}function sp(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a){var n=e.l;t[a]=e.read_shift(0,"lpwstr").replace(Dt,""),e.l-n&2&&(e.l+=2)}return t}function op(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a)t[a]=e.read_shift(0,"lpstr-cp").replace(Dt,"");return t}function cp(e){var r=e.l,t=Oi(e,c0);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=Oi(e,Yt);return[t,a]}function lp(e){for(var r=e.read_shift(4),t=[],a=0;a<r/2;++a)t.push(cp(e));return t}function Yc(e,r){for(var t=e.read_shift(4),a={},n=0;n!=t;++n){var i=e.read_shift(4),s=e.read_shift(4);a[i]=e.read_shift(s,r===1200?"utf16le":"utf8").replace(Dt,"").replace(gn,"!"),r===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function _0(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function fp(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Oi(e,r,t){var a=e.read_shift(2),n,i=t||{};if(e.l+=2,r!==Gc&&a!==r&&jh.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===Gc?a:r){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return v0(e,a,4).replace(Dt,"");case 31:return y0(e);case 64:return mo(e);case 65:return _0(e);case 71:return fp(e);case 80:return Bs(e,a,!i.raw).replace(Dt,"");case 81:return ip(e,a).replace(Dt,"");case 4108:return lp(e);case 4126:case 4127:return a==4127?sp(e):op(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function qc(e,r){var t=Y(4),a=Y(4);switch(t.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,r);break;case 5:a=Y(8),a.write_shift(8,r,"f");break;case 11:a.write_shift(4,r?1:0);break;case 64:a=np(r);break;case 31:case 80:for(a=Y(4+2*(r.length+1)+(r.length%2?0:2)),a.write_shift(4,r.length+1),a.write_shift(0,r,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Et([t,a])}function Kc(e,r){var t=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],s=0,o=0,c=-1,l={};for(s=0;s!=n;++s){var f=e.read_shift(4),d=e.read_shift(4);i[s]=[f,d+t]}i.sort(function(y,x){return y[1]-x[1]});var u={};for(s=0;s!=n;++s){if(e.l!==i[s][1]){var p=!0;if(s>0&&r)switch(r[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,p=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break}if((!r||s==0)&&e.l<=i[s][1]&&(p=!1,e.l=i[s][1]),p)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(r){var m=r[i[s][0]];if(u[m.n]=Oi(e,m.t,{raw:!0}),m.p==="version"&&(u[m.n]=String(u[m.n]>>16)+"."+("0000"+String(u[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(u[m.n]){case 0:u[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:kr(o=u[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+u[m.n])}}else if(i[s][0]===1){if(o=u.CodePage=Oi(e,ho),kr(o),c!==-1){var h=e.l;e.l=i[c][1],l=Yc(e,o),e.l=h}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}l=Yc(e,o)}else{var g=l[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=_0(e);break;case 30:e.l+=4,v=Bs(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Bs(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=ct(e,4);break;case 64:e.l+=4,v=qe(mo(e));break;default:throw new Error("unparsed value: "+e[e.l])}u[g]=v}}return e.l=t+a,u}var k0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function up(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Jc(e,r,t){var a=Y(8),n=[],i=[],s=8,o=0,c=Y(8),l=Y(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),i.push(c),n.push(l),s+=8+c.length,!r){l=Y(8),l.write_shift(4,0),n.unshift(l);var f=[Y(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=Y(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=Et(f),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(r&&!r[e[o][0]])&&!(k0.indexOf(e[o][0])>-1||p0.indexOf(e[o][0])>-1)&&e[o][1]!=null){var u=e[o][1],p=0;if(r){p=+r[e[o][0]];var m=t[p];if(m.p=="version"&&typeof u=="string"){var h=u.split(".");u=(+h[0]<<16)+(+h[1]||0)}c=qc(m.t,u)}else{var g=up(u);g==-1&&(g=31,u=String(u)),c=qc(g,u)}i.push(c),l=Y(8),l.write_shift(4,r?p:2+o),n.push(l),s+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,v),v+=i[o].length;return a.write_shift(4,s),a.write_shift(4,i.length),Et([a].concat(n).concat(i))}function Zc(e,r,t){var a=e.content;if(!a)return{};At(a,0);var n,i,s,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),f=a.read_shift(16);if(f!==me.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(s=a.read_shift(16),c=a.read_shift(4));var d=Kc(a,r),u={SystemIdentifier:l};for(var p in d)u[p]=d[p];if(u.FMTID=i,n===1)return u;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var m;try{m=Kc(a,null)}catch{}for(p in m)u[p]=m[p];return u.FMTID=[i,s],u}function Qc(e,r,t,a,n,i){var s=Y(n?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,me.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,n?2:1),s.write_shift(16,r,"hex"),s.write_shift(4,n?68:48);var c=Jc(e,t,a);if(o.push(c),n){var l=Jc(n,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(l)}return Et(o)}function Kr(e,r){return e.read_shift(r),null}function dp(e,r){r||(r=Y(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function hp(e,r,t){for(var a=[],n=e.l+r;e.l<n;)a.push(t(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function ct(e,r){return e.read_shift(r)===1}function Gt(e,r){return r||(r=Y(2)),r.write_shift(2,+!!e),r}function mt(e){return e.read_shift(2,"u")}function dr(e,r){return r||(r=Y(2)),r.write_shift(2,e),r}function E0(e,r){return hp(e,r,mt)}function pp(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function b0(e,r,t){return t||(t=Y(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function jn(e,r,t){var a=e.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont",i=Ir;if(t&&t.biff>=8&&(Ir=1200),!t||t.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return Ir=i,o}function mp(e){var r=Ir;Ir=1200;var t=e.read_shift(2),a=e.read_shift(1),n=a&4,i=a&8,s=1+(a&1),o=0,c,l={};i&&(o=e.read_shift(2)),n&&(c=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*o),n&&(e.l+=c),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Ir=r,l}function gp(e){var r=e.t||"",t=1,a=Y(3+(t>1?2:0));a.write_shift(2,r.length),a.write_shift(1,(t>1?8:0)|1),t>1&&a.write_shift(2,t);var n=Y(2*r.length);n.write_shift(2*r.length,r,"utf16le");var i=[a,n];return Et(i)}function wa(e,r,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function Hn(e,r,t){var a=e.read_shift(t&&t.biff==2?1:2);return a===0?(e.l++,""):wa(e,a,t)}function Aa(e,r,t){if(t.biff>5)return Hn(e,r,t);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function T0(e,r,t){return t||(t=Y(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function xp(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function vp(e){var r=e.read_shift(4),t=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=t);var n=e.read_shift((a?r-24:r)>>1,"utf16le").replace(Dt,"");return a&&(e.l+=24),n}function yp(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return t+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Dt,"");return t+s}function wp(e,r){var t=e.read_shift(16);switch(r-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return vp(e,r);case"0303000000000000c000000000000046":return yp(e,r);default:throw new Error("Unsupported Moniker "+t)}}function mi(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Dt,""):"";return t}function el(e,r){r||(r=Y(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function _p(e,r){var t=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,s,o,c,l="",f,d;n&16&&(i=mi(e,t-e.l)),n&128&&(s=mi(e,t-e.l)),(n&257)===257&&(o=mi(e,t-e.l)),(n&257)===1&&(c=wp(e,t-e.l)),n&8&&(l=mi(e,t-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(d=mo(e)),e.l=t;var u=s||o||c||"";u&&l&&(u+="#"+l),u||(u="#"+l),n&2&&u.charAt(0)=="/"&&u.charAt(1)!="/"&&(u="file://"+u);var p={Target:u};return f&&(p.guid=f),d&&(p.time=d),i&&(p.Tooltip=i),p}function kp(e){var r=Y(512),t=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(t=0;t<s.length;++t)r.write_shift(4,s[t]);if(i==28)a=a.slice(1),el(a,r);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<s.length;++t)r.write_shift(1,parseInt(s[t],16));var o=n>-1?a.slice(0,n):a;for(r.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)r.write_shift(2,o.charCodeAt(t));r.write_shift(2,0),i&8&&el(n>-1?a.slice(n+1):"",r)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<s.length;++t)r.write_shift(1,parseInt(s[t],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,a.length-3*c+1),t=0;t<a.length-3*c;++t)r.write_shift(1,a.charCodeAt(t+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function S0(e){var r=e.read_shift(1),t=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[r,t,a,n]}function C0(e,r){var t=S0(e,r);return t[3]=0,t}function Rr(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return{r,c:t,ixfe:a}}function _a(e,r,t,a){return a||(a=Y(6)),a.write_shift(2,e),a.write_shift(2,r),a.write_shift(2,t||0),a}function Ep(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function bp(e,r,t){return r===0?"":Aa(e,r,t)}function Tp(e,r,t){var a=t.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),s=e.read_shift(a,"i");return[n,i,s]}function A0(e){var r=e.read_shift(2),t=uo(e);return[r,t]}function Sp(e,r,t){e.l+=4,r-=4;var a=e.l+r,n=jn(e,r,t),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function $i(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r},e:{c:n,r:t}}}function O0(e,r){return r||(r=Y(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function F0(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r},e:{c:n,r:t}}}var Cp=F0;function I0(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[t,r,a]}function Ap(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Op(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Ft(e){e.l+=2,e.l+=e.read_shift(2)}var Fp={0:Ft,4:Ft,5:Ft,6:Ft,7:Op,8:Ft,9:Ft,10:Ft,11:Ft,12:Ft,13:Ap,14:Ft,15:Ft,16:Ft,17:Ft,18:Ft,19:Ft,20:Ft,21:I0};function Ip(e,r){for(var t=e.l+r,a=[];e.l<t;){var n=e.read_shift(2);e.l-=2;try{a.push(Fp[n](e,t-e.l))}catch{return e.l=t,a}}return e.l!=t&&(e.l=t),a}function gi(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function go(e,r,t){var a=1536,n=16;switch(t.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Y(n);return i.write_shift(2,a),i.write_shift(2,r),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Pp(e,r){return r===0||e.read_shift(2),1200}function Rp(e,r,t){if(t.enc)return e.l+=r,"";var a=e.l,n=Aa(e,0,t);return e.read_shift(r+a-e.l),n}function Np(e,r){var t=!r||r.biff==8,a=Y(t?112:54);for(a.write_shift(r.biff==8?2:1,7),t&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(t?0:536870912));a.l<a.length;)a.write_shift(1,t?0:32);return a}function Dp(e,r,t){var a=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Lp(e,r,t){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=jn(e,0,t);return s.length===0&&(s="Sheet1"),{pos:a,hs:n,dt:i,name:s}}function Bp(e,r){var t=!r||r.biff>=8?2:1,a=Y(8+t*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),r.biff>=8&&a.write_shift(1,1),a.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function Mp(e,r){for(var t=e.l+r,a=e.read_shift(4),n=e.read_shift(4),i=[],s=0;s!=n&&e.l<t;++s)i.push(mp(e));return i.Count=a,i.Unique=n,i}function Up(e,r){var t=Y(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=gp(e[n],r);var i=Et([t].concat(a));return i.parts=[t.length].concat(a.map(function(s){return s.length})),i}function $p(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function jp(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=t/20),r}function Hp(e){var r=Ep(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function Vp(e){return e.read_shift(2),e.read_shift(4)}function tl(e,r,t){var a=0;t&&t.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);t&&t.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function Wp(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[a,n],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:l}}function Gp(){var e=Y(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function zp(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Xp(e){var r=Y(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function Yp(){}function qp(e,r,t){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=jn(e,0,t),a}function Kp(e,r){var t=e.name||"Arial",a=r&&r.biff==5,n=a?15+t.length:16+2*t.length,i=Y(n);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le"),i}function Jp(e){var r=Rr(e);return r.isst=e.read_shift(4),r}function Zp(e,r,t,a){var n=Y(10);return _a(e,r,a,n),n.write_shift(4,t),n}function Qp(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=e.l+r,n=Rr(e,6);t.biff==2&&e.l++;var i=Hn(e,a-e.l,t);return n.val=i,n}function e1(e,r,t,a,n){var i=!n||n.biff==8,s=Y(8+ +i+(1+i)*t.length);return _a(e,r,a,s),s.write_shift(2,t.length),i&&s.write_shift(1,1),s.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),s}function t1(e,r,t){var a=e.read_shift(2),n=Aa(e,0,t);return[a,n]}function r1(e,r,t,a){var n=t&&t.biff==5;a||(a=Y(n?3+r.length:5+2*r.length)),a.write_shift(2,e),a.write_shift(n?1:2,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var a1=Aa;function rl(e,r,t){var a=e.l+r,n=t.biff==8||!t.biff?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:o},e:{r:s,c}}}function n1(e,r){var t=r.biff==8||!r.biff?4:2,a=Y(2*t+6);return a.write_shift(t,e.s.r),a.write_shift(t,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function i1(e){var r=e.read_shift(2),t=e.read_shift(2),a=A0(e);return{r,c:t,ixfe:a[0],rknum:a[1]}}function s1(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<t;)i.push(A0(e));if(e.l!==t)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:s,rkrec:i}}function o1(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<t;)i.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:s,ixfe:i}}function c1(e,r,t,a){var n={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=Hh[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=s&15,n.dgRight=s>>4&15,n.dgTop=s>>8&15,n.dgBottom=s>>12&15,n.icvLeft=s>>16&127,n.icvRight=s>>23&127,n.grbitDiag=s>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function l1(e,r,t){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=c1(e,r,a.fStyle,t),a}function al(e,r,t,a){var n=t&&t.biff==5;a||(a=Y(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,r<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function f1(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function u1(e){var r=Y(8);return r.write_shift(4,0),r.write_shift(2,e[0]?e[0]+1:0),r.write_shift(2,e[1]?e[1]+1:0),r}function nl(e,r,t){var a=Rr(e,6);(t.biff==2||r==9)&&++e.l;var n=pp(e,2);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function d1(e,r,t,a,n,i){var s=Y(8);return _a(e,r,a,s),b0(t,i,s),s}function h1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=Rr(e,6),n=Nt(e,8);return a.val=n,a}function p1(e,r,t,a){var n=Y(14);return _a(e,r,a,n),ya(t,n),n}var il=bp;function m1(e,r,t){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=wa(e,i),o=[];a>e.l;)o.push(Hn(e));return[i,n,s,o]}function sl(e,r,t){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return t.sbcch===14849&&(n=Sp(e,r-2,t)),i.body=n||e.read_shift(r-2),typeof n=="string"&&(i.Name=n),i}var g1=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ol(e,r,t){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=wa(e,s,t);n&32&&(l=g1[l.charCodeAt(0)]);var f=a-e.l;t&&t.biff==2&&--f;var d=a==e.l||o===0||!(f>0)?[]:Iv(e,f,t,o);return{chKey:i,Name:l,itab:c,rgce:d}}function P0(e,r,t){if(t.biff<8)return x1(e,r,t);for(var a=[],n=e.l+r,i=e.read_shift(t.biff>8?4:2);i--!==0;)a.push(Tp(e,t.biff>8?12:6,t));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function x1(e,r,t){e[e.l+1]==3&&e[e.l]++;var a=jn(e,r,t);return a.charCodeAt(0)==3?a.slice(1):a}function v1(e,r,t){if(t.biff<8){e.l+=r;return}var a=e.read_shift(2),n=e.read_shift(2),i=wa(e,a,t),s=wa(e,n,t);return[i,s]}function y1(e,r,t){var a=F0(e,6);e.l++;var n=e.read_shift(1);return r-=8,[Pv(e,r,t),n,a]}function cl(e,r,t){var a=Cp(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,Ov(e,r,t,a)]}function w1(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,a=e.read_shift(4);return[r,t,a]}function _1(e,r,t){if(!(t.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Aa(e,0,t);return t.biff<8&&e.read_shift(1),[{r:a,c:n},o,s,i]}}function k1(e,r,t){return _1(e,r,t)}function E1(e,r){for(var t=[],a=e.read_shift(2);a--;)t.push($i(e,r));return t}function b1(e){var r=Y(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)O0(e[t],r);return r}function T1(e,r,t){if(t&&t.biff<8)return C1(e,r,t);var a=I0(e,22),n=Ip(e,r-22,a[1]);return{cmo:a,ft:n}}var S1={8:function(e,r){var t=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=t,{fmt:a}}};function C1(e,r,t){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var s=[];return s.push((S1[a]||Bt)(e,r,t)),{cmo:[n,a,i],ft:s}}function A1(e,r,t){var a=e.l,n="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=xp(e,6,t);var o=e.read_shift(2);e.read_shift(2),mt(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],d=wa(e,e.lens[l+1]-e.lens[l]-1);if(n+=d,n.length>=(f?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+r,{t:n}}catch{return e.l=a+r,{t:n}}}function O1(e,r){var t=$i(e,8);e.l+=16;var a=_p(e,r-24);return[t,a]}function F1(e){var r=Y(24),t=tt(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)r.write_shift(1,parseInt(a[n],16));return Et([r,kp(e[1])])}function I1(e,r){e.read_shift(2);var t=$i(e,8),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(Dt,""),[t,a]}function P1(e){var r=e[1].Tooltip,t=Y(10+2*(r.length+1));t.write_shift(2,2048);var a=tt(e[0]);t.write_shift(2,a.r),t.write_shift(2,a.r),t.write_shift(2,a.c),t.write_shift(2,a.c);for(var n=0;n<r.length;++n)t.write_shift(2,r.charCodeAt(n));return t.write_shift(2,0),t}function R1(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=zc[t]||t,t=e.read_shift(2),r[1]=zc[t]||t,r}function N1(e){return e||(e=Y(4)),e.write_shift(2,1),e.write_shift(2,1),e}function D1(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(C0(e,8));return t}function L1(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(C0(e,8));return t}function B1(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function R0(e,r,t){if(!t.cellStyles)return Bt(e,r);var a=t&&t.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:i,w:s,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function M1(e,r){var t=Y(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var a=0;return e.hidden&&(a|=1),t.write_shift(1,a),a=e.level||0,t.write_shift(1,a),t.write_shift(2,0),t}function U1(e,r){var t={};return r<32||(e.l+=16,t.header=Nt(e,8),t.footer=Nt(e,8),e.l+=2),t}function $1(e,r,t){var a={area:!1};if(t.biff!=5)return e.l+=r,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function j1(e){for(var r=Y(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var H1=Rr,V1=E0,W1=Hn;function G1(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function z1(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var a=Rr(e,6);++e.l;var n=Aa(e,r-7,t);return a.t="str",a.val=n,a}function X1(e){var r=Rr(e,6);++e.l;var t=Nt(e,8);return r.t="n",r.val=t,r}function Y1(e,r,t){var a=Y(15);return zn(a,e,r),a.write_shift(8,t,"f"),a}function q1(e){var r=Rr(e,6);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function K1(e,r,t){var a=Y(9);return zn(a,e,r),a.write_shift(2,t),a}function J1(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function Z1(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function Q1(e,r,t){var a=e.l+r,n=Rr(e,6),i=e.read_shift(2),s=wa(e,i,t);return e.l=a,n.t="str",n.val=s,n}var em=[2,3,48,49,131,139,140,245],Ms=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Li({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],f=Qr(1);switch(c.type){case"base64":f=tr(ar(o));break;case"binary":f=tr(o);break;case"buffer":case"array":f=o;break}At(f,0);var d=f.read_shift(1),u=!!(d&136),p=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,u=!0;break;case 49:p=!0,u=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var h=0,g=521;d==2&&(h=f.read_shift(2)),f.l+=3,d!=2&&(h=f.read_shift(4)),h>1048576&&(h=1e6),d!=2&&(g=f.read_shift(2));var v=f.read_shift(2),y=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var x=[],I={},R=Math.min(f.length,d==2?521:g-10-(p?264:0)),P=m?32:11;f.l<R&&f[f.l]!=13;)switch(I={},I.name=He.utils.decode(y,f.slice(f.l,f.l+P)).replace(/[\u0000\r\n].*$/g,""),f.l+=P,I.type=String.fromCharCode(f.read_shift(1)),d!=2&&!m&&(I.offset=f.read_shift(4)),I.len=f.read_shift(1),d==2&&(I.offset=f.read_shift(2)),I.dec=f.read_shift(1),I.name.length&&x.push(I),d!=2&&(f.l+=m?13:14),I.type){case"B":(!p||I.len!=8)&&c.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var k=0,D=0;for(l[0]=[],D=0;D!=x.length;++D)l[0][D]=x[D].name;for(;h-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,l[++k]=[],D=0,D=0;D!=x.length;++D){var N=f.slice(f.l,f.l+x[D].len);f.l+=x[D].len,At(N,0);var U=He.utils.decode(y,N);switch(x[D].type){case"C":U.trim().length&&(l[k][D]=U.replace(/\s+$/,""));break;case"D":U.length===8?l[k][D]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):l[k][D]=U;break;case"F":l[k][D]=parseFloat(U.trim());break;case"+":case"I":l[k][D]=m?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":l[k][D]=!0;break;case"N":case"F":l[k][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));l[k][D]="##MEMO##"+(m?parseInt(U.trim(),10):N.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(l[k][D]=+U||0);break;case"@":l[k][D]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":l[k][D]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":l[k][D]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[k][D]=-N.read_shift(-8,"f");break;case"B":if(p&&x[D].len==8){l[k][D]=N.read_shift(8,"f");break}case"G":case"P":N.l+=x[D].len;break;case"0":if(x[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[D].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=x,l}function a(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Ka(t(o,l),l);return f["!cols"]=l.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete l.DBF,f}function n(o,c){try{return na(a(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var l=c||{};if(+l.codepage>=0&&kr(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=qt(),d=Ri(o,{header:1,raw:!0,cellDates:!0}),u=d[0],p=d.slice(1),m=o["!cols"]||[],h=0,g=0,v=0,y=1;for(h=0;h<u.length;++h){if(((m[h]||{}).DBF||{}).name){u[h]=m[h].DBF.name,++v;continue}if(u[h]!=null){if(++v,typeof u[h]=="number"&&(u[h]=u[h].toString(10)),typeof u[h]!="string")throw new Error("DBF Invalid column name "+u[h]+" |"+typeof u[h]+"|");if(u.indexOf(u[h])!==h){for(g=0;g<1024;++g)if(u.indexOf(u[h]+"_"+g)==-1){u[h]+="_"+g;break}}}}var x=Be(o["!ref"]),I=[],R=[],P=[];for(h=0;h<=x.e.c-x.s.c;++h){var k="",D="",N=0,U=[];for(g=0;g<p.length;++g)p[g][h]!=null&&U.push(p[g][h]);if(U.length==0||u[h]==null){I[h]="?";continue}for(g=0;g<U.length;++g){switch(typeof U[g]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=U[g]instanceof Date?"D":"C";break;default:D="C"}N=Math.max(N,String(U[g]).length),k=k&&k!=D?"C":D}N>250&&(N=250),D=((m[h]||{}).DBF||{}).type,D=="C"&&m[h].DBF.len>N&&(N=m[h].DBF.len),k=="B"&&D=="N"&&(k="N",P[h]=m[h].DBF.dec,N=m[h].DBF.len),R[h]=k=="C"||D=="N"?N:i[k]||0,y+=R[h],I[h]=k}var W=f.next(32);for(W.write_shift(4,318902576),W.write_shift(4,p.length),W.write_shift(2,296+32*v),W.write_shift(2,y),h=0;h<4;++h)W.write_shift(4,0);for(W.write_shift(4,0|(+r[Va]||3)<<8),h=0,g=0;h<u.length;++h)if(u[h]!=null){var L=f.next(32),J=(u[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,J,"sbcs"),L.write_shift(1,I[h]=="?"?"C":I[h],"sbcs"),L.write_shift(4,g),L.write_shift(1,R[h]||i[I[h]]||0),L.write_shift(1,P[h]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),g+=R[h]||i[I[h]]||0}var ue=f.next(264);for(ue.write_shift(4,13),h=0;h<65;++h)ue.write_shift(4,0);for(h=0;h<p.length;++h){var te=f.next(y);for(te.write_shift(1,0),g=0;g<u.length;++g)if(u[g]!=null)switch(I[g]){case"L":te.write_shift(1,p[h][g]==null?63:p[h][g]?84:70);break;case"B":te.write_shift(8,p[h][g]||0,"f");break;case"N":var ne="0";for(typeof p[h][g]=="number"&&(ne=p[h][g].toFixed(P[g]||0)),v=0;v<R[g]-ne.length;++v)te.write_shift(1,32);te.write_shift(1,ne,"sbcs");break;case"D":p[h][g]?(te.write_shift(4,("0000"+p[h][g].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(p[h][g].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+p[h][g].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(p[h][g]!=null?p[h][g]:"").slice(0,R[g]);for(te.write_shift(1,Q,"sbcs"),v=0;v<R[g]-Q.length;++v)te.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:s}})(),N0=(function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+st(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(u,p){var m=e[p];return typeof m=="number"?yc(m):m},a=function(u,p,m){var h=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return h==59?u:yc(h)};e["|"]=254;function n(u,p){switch(p.type){case"base64":return i(ar(u),p);case"binary":return i(u,p);case"buffer":return i(Fe&&Buffer.isBuffer(u)?u.toString("binary"):aa(u),p);case"array":return i(va(u),p)}throw new Error("Unrecognized type "+p.type)}function i(u,p){var m=u.split(/[\n\r]+/),h=-1,g=-1,v=0,y=0,x=[],I=[],R=null,P={},k=[],D=[],N=[],U=0,W;for(+p.codepage>=0&&kr(+p.codepage);v!==m.length;++v){U=0;var L=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,t),J=L.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),ue=J[0],te;if(L.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&I.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,Q=!1,xe=!1,se=!1,X=-1,M=-1;for(y=1;y<J.length;++y)switch(J[y].charAt(0)){case"A":break;case"X":g=parseInt(J[y].slice(1))-1,Q=!0;break;case"Y":for(h=parseInt(J[y].slice(1))-1,Q||(g=0),W=x.length;W<=h;++W)x[W]=[];break;case"K":te=J[y].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(br(te))?isNaN(Wa(te).getDate())||(te=qe(te)):(te=br(te),R!==null&&Xa(R)&&(te=Mi(te))),typeof He!="undefined"&&typeof te=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(te=He.utils.decode(p.codepage,te)),ne=!0;break;case"E":se=!0;var b=ja(J[y].slice(1),{r:h,c:g});x[h][g]=[x[h][g],b];break;case"S":xe=!0,x[h][g]=[x[h][g],"S5S"];break;case"G":break;case"R":X=parseInt(J[y].slice(1))-1;break;case"C":M=parseInt(J[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}if(ne&&(x[h][g]&&x[h][g].length==2?x[h][g][0]=te:x[h][g]=te,R=null),xe){if(se)throw new Error("SYLK shared formula cannot have own formula");var B=X>-1&&x[X][M];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");x[h][g][1]=Z0(B[1],{r:h-X,c:g-M})}break;case"F":var O=0;for(y=1;y<J.length;++y)switch(J[y].charAt(0)){case"X":g=parseInt(J[y].slice(1))-1,++O;break;case"Y":for(h=parseInt(J[y].slice(1))-1,W=x.length;W<=h;++W)x[W]=[];break;case"M":U=parseInt(J[y].slice(1))/20;break;case"F":break;case"G":break;case"P":R=I[parseInt(J[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=J[y].slice(1).split(" "),W=parseInt(N[0],10);W<=parseInt(N[1],10);++W)U=parseInt(N[2],10),D[W-1]=U===0?{hidden:!0}:{wch:U},ea(D[W-1]);break;case"C":g=parseInt(J[y].slice(1))-1,D[g]||(D[g]={});break;case"R":h=parseInt(J[y].slice(1))-1,k[h]||(k[h]={}),U>0?(k[h].hpt=U,k[h].hpx=za(U)):U===0&&(k[h].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}O<1&&(R=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}}return k.length>0&&(P["!rows"]=k),D.length>0&&(P["!cols"]=D),p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),[x,P]}function s(u,p){var m=n(u,p),h=m[0],g=m[1],v=Ka(h,p);return st(g).forEach(function(y){v[y]=g[y]}),v}function o(u,p){return na(s(u,p),p)}function c(u,p,m,h){var g="C;Y"+(m+1)+";X"+(h+1)+";K";switch(u.t){case"n":g+=u.v||0,u.f&&!u.F&&(g+=";E"+ko(u.f,{r:m,c:h}));break;case"b":g+=u.v?"TRUE":"FALSE";break;case"e":g+=u.w||u.v;break;case"d":g+='"'+(u.w||u.v)+'"';break;case"s":g+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function l(u,p){p.forEach(function(m,h){var g="F;W"+(h+1)+" "+(h+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Nn(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Dn(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&u.push(g)})}function f(u,p){p.forEach(function(m,h){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*Ln(m.hpx)+";"),g.length>2&&u.push(g+"R"+(h+1))})}function d(u,p){var m=["ID;PWXL;N;E"],h=[],g=Be(u["!ref"]),v,y=Array.isArray(u),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),u["!cols"]&&l(m,u["!cols"]),u["!rows"]&&f(m,u["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var I=g.s.r;I<=g.e.r;++I)for(var R=g.s.c;R<=g.e.c;++R){var P=ve({r:I,c:R});v=y?(u[I]||[])[R]:u[P],!(!v||v.v==null&&(!v.f||v.F))&&h.push(c(v,u,I,R,p))}return m.join(x)+x+h.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:d}})(),D0=(function(){function e(i,s){switch(s.type){case"base64":return r(ar(i),s);case"binary":return r(i,s);case"buffer":return r(Fe&&Buffer.isBuffer(i)?i.toString("binary"):aa(i),s);case"array":return r(va(i),s)}throw new Error("Unrecognized type "+s.type)}function r(i,s){for(var o=i.split(`
`),c=-1,l=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],l=0;continue}if(!(c<0)){var u=o[f].trim().split(","),p=u[0],m=u[1];++f;for(var h=o[f]||"";(h.match(/["]/g)||[]).length&1&&f<o.length-1;)h+=`
`+o[++f];switch(h=h.trim(),+p){case-1:if(h==="BOT"){d[++c]=[],l=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?d[c][l]=!0:h==="FALSE"?d[c][l]=!1:isNaN(br(m))?isNaN(Wa(m).getDate())?d[c][l]=m:d[c][l]=qe(m):d[c][l]=br(m),++l;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),hn&&h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),d[c][l++]=h!==""?h:null;break}if(h==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function t(i,s){return Ka(e(i,s),s)}function a(i,s){return na(t(i,s),s)}var n=(function(){var i=function(c,l,f,d,u){c.push(l),c.push(f+","+d),c.push('"'+u.replace(/"/g,'""')+'"')},s=function(c,l,f,d){c.push(l+","+f),c.push(l==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var l=[],f=Be(c["!ref"]),d,u=Array.isArray(c);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,f.e.r-f.s.r+1,""),i(l,"TUPLES",0,f.e.c-f.s.c+1,""),i(l,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){s(l,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var h=ve({r:p,c:m});if(d=u?(c[p]||[])[m]:c[h],!d){s(l,1,0,"");continue}switch(d.t){case"n":var g=hn?d.w:d.v;!g&&d.v!=null&&(g=d.v),g==null?hn&&d.f&&!d.F?s(l,1,0,"="+d.f):s(l,1,0,""):s(l,0,g,"V");break;case"b":s(l,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(l,1,0,!hn||isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=pr(d.z||ge[14],yt(qe(d.v)))),hn?s(l,0,d.w,"V"):s(l,1,0,d.w);break;default:s(l,1,0,"")}}}s(l,-1,0,"EOD");var v=`\r
`,y=l.join(v);return y}})();return{to_workbook:a,to_sheet:t,from_sheet:n}})(),L0=(function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,u){for(var p=d.split(`
`),m=-1,h=-1,g=0,v=[];g!==p.length;++g){var y=p[g].trim().split(":");if(y[0]==="cell"){var x=tt(y[1]);if(v.length<=x.r)for(m=v.length;m<=x.r;++m)v[m]||(v[m]=[]);switch(m=x.r,h=x.c,y[2]){case"t":v[m][h]=e(y[3]);break;case"v":v[m][h]=+y[3];break;case"vtf":var I=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][h]=!!+y[4];break;default:v[m][h]=+y[4];break}y[2]=="vtf"&&(v[m][h]=[v[m][h],I])}}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function a(d,u){return Ka(t(d,u),u)}function n(d,u){return na(a(d,u),u)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(d){if(!d||!d["!ref"])return"";for(var u=[],p=[],m,h="",g=Kt(d["!ref"]),v=Array.isArray(d),y=g.s.r;y<=g.e.r;++y)for(var x=g.s.c;x<=g.e.c;++x)if(h=ve({r:y,c:x}),m=v?(d[y]||[])[x]:d[h],!(!m||m.v==null||m.t==="z")){switch(p=["cell",h,"t"],m.t){case"s":case"str":p.push(r(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=r(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=r(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var I=yt(qe(m.v));p[2]="vtc",p[3]="nd",p[4]=""+I,p[5]=m.w||pr(m.z||ge[14],I);break;case"e":continue}u.push(p.join(":"))}return u.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function f(d){return[i,s,o,s,l(d),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}})(),Ga=(function(){function e(f,d,u,p,m){m.raw?d[u][p]=f:f===""||(f==="TRUE"?d[u][p]=!0:f==="FALSE"?d[u][p]=!1:isNaN(br(f))?isNaN(Wa(f).getDate())?d[u][p]=f:d[u][p]=qe(f):d[u][p]=br(f))}function r(f,d){var u=d||{},p=[];if(!f||f.length===0)return p;for(var m=f.split(/[\r\n]/),h=m.length-1;h>=0&&m[h].length===0;)--h;for(var g=10,v=0,y=0;y<=h;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,g=Math.max(g,v);for(y=0;y<=h;++y){p[y]=[];var x=0;for(e(m[y].slice(0,g).trim(),p,y,x,u),x=1;x<=(m[y].length-g)/10+1;++x)e(m[y].slice(g+(x-1)*10,g+x*10).trim(),p,y,x,u)}return u.sheetRows&&(p=p.slice(0,u.sheetRows)),p}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var d={},u=!1,p=0,m=0;p<f.length;++p)(m=f.charCodeAt(p))==34?u=!u:!u&&m in t&&(d[m]=(d[m]||0)+1);m=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p]);if(!m.length){d=a;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p])}return m.sort(function(h,g){return h[0]-g[0]||a[h[1]]-a[g[1]]}),t[m.pop()[1]]||44}function i(f,d){var u=d||{},p="";it!=null&&u.dense==null&&(u.dense=it);var m=u.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=n(f.slice(0,1024)):u&&u.FS?p=u.FS:p=n(f.slice(0,1024));var g=0,v=0,y=0,x=0,I=0,R=p.charCodeAt(0),P=!1,k=0,D=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var N=u.dateNF!=null?$d(u.dateNF):null;function U(){var W=f.slice(x,I),L={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)L.t="z";else if(u.raw)L.t="s",L.v=W;else if(W.trim().length===0)L.t="s",L.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(L.t="s",L.v=W.slice(2,-1).replace(/""/g,'"')):mx(W)?(L.t="n",L.f=W.slice(1)):(L.t="s",L.v=W);else if(W=="TRUE")L.t="b",L.v=!0;else if(W=="FALSE")L.t="b",L.v=!1;else if(!isNaN(y=br(W)))L.t="n",u.cellText!==!1&&(L.w=W),L.v=y;else if(!isNaN(Wa(W).getDate())||N&&W.match(N)){L.z=u.dateNF||ge[14];var J=0;N&&W.match(N)&&(W=jd(W,u.dateNF,W.match(N)||[]),J=1),u.cellDates?(L.t="d",L.v=qe(W,J)):(L.t="n",L.v=yt(qe(W,J))),u.cellText!==!1&&(L.w=pr(L.z,L.v instanceof Date?yt(L.v):L.v)),u.cellNF||delete L.z}else L.t="s",L.v=W;if(L.t=="z"||(u.dense?(m[g]||(m[g]=[]),m[g][v]=L):m[ve({c:v,r:g})]=L),x=I+1,D=f.charCodeAt(x),h.e.c<v&&(h.e.c=v),h.e.r<g&&(h.e.r=g),k==R)++v;else if(v=0,++g,u.sheetRows&&u.sheetRows<=g)return!0}e:for(;I<f.length;++I)switch(k=f.charCodeAt(I)){case 34:D===34&&(P=!P);break;case R:case 10:case 13:if(!P&&U())break e;break;default:break}return I-x>0&&U(),m["!ref"]=Ee(h),m}function s(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,d):Ka(r(f,d),d)}function o(f,d){var u="",p=d.type=="string"?[0,0,0,0]:Fo(f,d);switch(d.type){case"base64":u=ar(f);break;case"binary":u=f;break;case"buffer":d.codepage==65001?u=f.toString("utf8"):d.codepage&&typeof He!="undefined"?u=He.utils.decode(d.codepage,f):u=Fe&&Buffer.isBuffer(f)?f.toString("binary"):aa(f);break;case"array":u=va(f);break;case"string":u=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?u=ze(u.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?u=ze(u):d.type=="binary"&&typeof He!="undefined"&&d.codepage&&(u=He.utils.decode(d.codepage,He.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?L0.to_sheet(d.type=="string"?u:ze(u),d):s(u,d)}function c(f,d){return na(o(f,d),d)}function l(f){for(var d=[],u=Be(f["!ref"]),p,m=Array.isArray(f),h=u.s.r;h<=u.e.r;++h){for(var g=[],v=u.s.c;v<=u.e.c;++v){var y=ve({r:h,c:v});if(p=m?(f[h]||[])[v]:f[y],!p||p.v==null){g.push("          ");continue}for(var x=(p.w||(jr(p),p.w)||"").slice(0,10);x.length<10;)x+=" ";g.push(x+(v===0?" ":""))}d.push(g.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}})();function tm(e,r){var t=r||{},a=!!t.WTF;t.WTF=!0;try{var n=N0.to_workbook(e,t);return t.WTF=a,n}catch(i){if(t.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Ga.to_workbook(e,r)}}var ma=(function(){function e(b,B,O){if(b){At(b,b.l||0);for(var T=O.Enum||X;b.l<b.length;){var z=b.read_shift(2),ie=T[z]||T[65535],ee=b.read_shift(2),re=b.l+ee,K=ie.f&&ie.f(b,ee,O);if(b.l=re,B(K,ie,z))return}}}function r(b,B){switch(B.type){case"base64":return t(tr(ar(b)),B);case"binary":return t(tr(b),B);case"buffer":case"array":return t(b,B)}throw"Unsupported type "+B.type}function t(b,B){if(!b)return b;var O=B||{};it!=null&&O.dense==null&&(O.dense=it);var T=O.dense?[]:{},z="Sheet1",ie="",ee=0,re={},K=[],we=[],F={s:{r:0,c:0},e:{r:0,c:0}},Me=O.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)O.Enum=X,e(b,function(he,Ze,jt){switch(jt){case 0:O.vers=he,he>=4096&&(O.qpro=!0);break;case 6:F=he;break;case 204:he&&(ie=he);break;case 222:ie=he;break;case 15:case 51:O.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:jt==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=O.dateNF||ge[14],O.cellDates&&(he[1].t="d",he[1].v=Mi(he[1].v))),O.qpro&&he[3]>ee&&(T["!ref"]=Ee(F),re[z]=T,K.push(z),T=O.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},ee=he[3],z=ie||"Sheet"+(ee+1),ie="");var Jt=O.dense?(T[he[0].r]||[])[he[0].c]:T[ve(he[0])];if(Jt){Jt.t=he[1].t,Jt.v=he[1].v,he[1].z!=null&&(Jt.z=he[1].z),he[1].f!=null&&(Jt.f=he[1].f);break}O.dense?(T[he[0].r]||(T[he[0].r]=[]),T[he[0].r][he[0].c]=he[1]):T[ve(he[0])]=he[1];break;default:}},O);else if(b[2]==26||b[2]==14)O.Enum=M,b[2]==14&&(O.qpro=!0,b.l=0),e(b,function(he,Ze,jt){switch(jt){case 204:z=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>ee&&(T["!ref"]=Ee(F),re[z]=T,K.push(z),T=O.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},ee=he[3],z="Sheet"+(ee+1)),Me>0&&he[0].r>=Me)break;O.dense?(T[he[0].r]||(T[he[0].r]=[]),T[he[0].r][he[0].c]=he[1]):T[ve(he[0])]=he[1],F.e.c<he[0].c&&(F.e.c=he[0].c),F.e.r<he[0].r&&(F.e.r=he[0].r);break;case 27:he[14e3]&&(we[he[14e3][0]]=he[14e3][1]);break;case 1537:we[he[0]]=he[1],he[0]==ee&&(z=he[1]);break;default:break}},O);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(T["!ref"]=Ee(F),re[ie||z]=T,K.push(ie||z),!we.length)return{SheetNames:K,Sheets:re};for(var Oe={},Ue=[],Ce=0;Ce<we.length;++Ce)re[K[Ce]]?(Ue.push(we[Ce]||K[Ce]),Oe[we[Ce]]=re[we[Ce]]||re[K[Ce]]):(Ue.push(we[Ce]),Oe[we[Ce]]={"!ref":"A1"});return{SheetNames:Ue,Sheets:Oe}}function a(b,B){var O=B||{};if(+O.codepage>=0&&kr(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var T=qt(),z=Be(b["!ref"]),ie=Array.isArray(b),ee=[];ce(T,0,i(1030)),ce(T,6,c(z));for(var re=Math.min(z.e.r,8191),K=z.s.r;K<=re;++K)for(var we=lt(K),F=z.s.c;F<=z.e.c;++F){K===z.s.r&&(ee[F]=et(F));var Me=ee[F]+we,Oe=ie?(b[K]||[])[F]:b[Me];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")(Oe.v|0)==Oe.v&&Oe.v>=-32768&&Oe.v<=32767?ce(T,13,p(K,F,Oe.v)):ce(T,14,h(K,F,Oe.v));else{var Ue=jr(Oe);ce(T,15,d(K,F,Ue.slice(0,239)))}}return ce(T,1),T.end()}function n(b,B){var O=B||{};if(+O.codepage>=0&&kr(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var T=qt();ce(T,0,s(b));for(var z=0,ie=0;z<b.SheetNames.length;++z)(b.Sheets[b.SheetNames[z]]||{})["!ref"]&&ce(T,27,se(b.SheetNames[z],ie++));var ee=0;for(z=0;z<b.SheetNames.length;++z){var re=b.Sheets[b.SheetNames[z]];if(!(!re||!re["!ref"])){for(var K=Be(re["!ref"]),we=Array.isArray(re),F=[],Me=Math.min(K.e.r,8191),Oe=K.s.r;Oe<=Me;++Oe)for(var Ue=lt(Oe),Ce=K.s.c;Ce<=K.e.c;++Ce){Oe===K.s.r&&(F[Ce]=et(Ce));var he=F[Ce]+Ue,Ze=we?(re[Oe]||[])[Ce]:re[he];if(!(!Ze||Ze.t=="z"))if(Ze.t=="n")ce(T,23,U(Oe,Ce,ee,Ze.v));else{var jt=jr(Ze);ce(T,22,k(Oe,Ce,ee,jt.slice(0,239)))}}++ee}}return ce(T,1),T.end()}function i(b){var B=Y(2);return B.write_shift(2,b),B}function s(b){var B=Y(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var O=0,T=0,z=0,ie=0;ie<b.SheetNames.length;++ie){var ee=b.SheetNames[ie],re=b.Sheets[ee];if(!(!re||!re["!ref"])){++z;var K=Kt(re["!ref"]);O<K.e.r&&(O=K.e.r),T<K.e.c&&(T=K.e.c)}}return O>8191&&(O=8191),B.write_shift(2,O),B.write_shift(1,z),B.write_shift(1,T),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function o(b,B,O){var T={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&O.qpro?(T.s.c=b.read_shift(1),b.l++,T.s.r=b.read_shift(2),T.e.c=b.read_shift(1),b.l++,T.e.r=b.read_shift(2),T):(T.s.c=b.read_shift(2),T.s.r=b.read_shift(2),B==12&&O.qpro&&(b.l+=2),T.e.c=b.read_shift(2),T.e.r=b.read_shift(2),B==12&&O.qpro&&(b.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function c(b){var B=Y(8);return B.write_shift(2,b.s.c),B.write_shift(2,b.s.r),B.write_shift(2,b.e.c),B.write_shift(2,b.e.r),B}function l(b,B,O){var T=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(T[0].c=b.read_shift(1),T[3]=b.read_shift(1),T[0].r=b.read_shift(2),b.l+=2):(T[2]=b.read_shift(1),T[0].c=b.read_shift(2),T[0].r=b.read_shift(2)),T}function f(b,B,O){var T=b.l+B,z=l(b,B,O);if(z[1].t="s",O.vers==20768){b.l++;var ie=b.read_shift(1);return z[1].v=b.read_shift(ie,"utf8"),z}return O.qpro&&b.l++,z[1].v=b.read_shift(T-b.l,"cstr"),z}function d(b,B,O){var T=Y(7+O.length);T.write_shift(1,255),T.write_shift(2,B),T.write_shift(2,b),T.write_shift(1,39);for(var z=0;z<T.length;++z){var ie=O.charCodeAt(z);T.write_shift(1,ie>=128?95:ie)}return T.write_shift(1,0),T}function u(b,B,O){var T=l(b,B,O);return T[1].v=b.read_shift(2,"i"),T}function p(b,B,O){var T=Y(7);return T.write_shift(1,255),T.write_shift(2,B),T.write_shift(2,b),T.write_shift(2,O,"i"),T}function m(b,B,O){var T=l(b,B,O);return T[1].v=b.read_shift(8,"f"),T}function h(b,B,O){var T=Y(13);return T.write_shift(1,255),T.write_shift(2,B),T.write_shift(2,b),T.write_shift(8,O,"f"),T}function g(b,B,O){var T=b.l+B,z=l(b,B,O);if(z[1].v=b.read_shift(8,"f"),O.qpro)b.l=T;else{var ie=b.read_shift(2);I(b.slice(b.l,b.l+ie),z),b.l+=ie}return z}function v(b,B,O){var T=B&32768;return B&=-32769,B=(T?b:0)+(B>=8192?B-16384:B),(T?"":"$")+(O?et(B):lt(B))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(b,B){At(b,0);for(var O=[],T=0,z="",ie="",ee="",re="";b.l<b.length;){var K=b[b.l++];switch(K){case 0:O.push(b.read_shift(8,"f"));break;case 1:ie=v(B[0].c,b.read_shift(2),!0),z=v(B[0].r,b.read_shift(2),!1),O.push(ie+z);break;case 2:{var we=v(B[0].c,b.read_shift(2),!0),F=v(B[0].r,b.read_shift(2),!1);ie=v(B[0].c,b.read_shift(2),!0),z=v(B[0].r,b.read_shift(2),!1),O.push(we+F+":"+ie+z)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(b.read_shift(2));break;case 6:{for(var Me="";K=b[b.l++];)Me+=String.fromCharCode(K);O.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:re=O.pop(),ee=O.pop(),O.push(["AND","OR"][K-20]+"("+ee+","+re+")");break;default:if(K<32&&x[K])re=O.pop(),ee=O.pop(),O.push(ee+x[K]+re);else if(y[K]){if(T=y[K][1],T==69&&(T=b[b.l++]),T>O.length){console.error("WK1 bad formula parse 0x"+K.toString(16)+":|"+O.join("|")+"|");return}var Oe=O.slice(-T);O.length-=T,O.push(y[K][0]+"("+Oe.join(",")+")")}else return K<=7?console.error("WK1 invalid opcode "+K.toString(16)):K<=24?console.error("WK1 unsupported op "+K.toString(16)):K<=30?console.error("WK1 invalid opcode "+K.toString(16)):K<=115?console.error("WK1 unsupported function opcode "+K.toString(16)):console.error("WK1 unrecognized opcode "+K.toString(16))}}O.length==1?B[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function R(b){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=b.read_shift(2),B[3]=b[b.l++],B[0].c=b[b.l++],B}function P(b,B){var O=R(b,B);return O[1].t="s",O[1].v=b.read_shift(B-4,"cstr"),O}function k(b,B,O,T){var z=Y(6+T.length);z.write_shift(2,b),z.write_shift(1,O),z.write_shift(1,B),z.write_shift(1,39);for(var ie=0;ie<T.length;++ie){var ee=T.charCodeAt(ie);z.write_shift(1,ee>=128?95:ee)}return z.write_shift(1,0),z}function D(b,B){var O=R(b,B);O[1].v=b.read_shift(2);var T=O[1].v>>1;if(O[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return O[1].v=T,O}function N(b,B){var O=R(b,B),T=b.read_shift(4),z=b.read_shift(4),ie=b.read_shift(2);if(ie==65535)return T===0&&z===3221225472?(O[1].t="e",O[1].v=15):T===0&&z===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var ee=ie&32768;return ie=(ie&32767)-16446,O[1].v=(1-ee*2)*(z*Math.pow(2,ie+32)+T*Math.pow(2,ie)),O}function U(b,B,O,T){var z=Y(14);if(z.write_shift(2,b),z.write_shift(1,O),z.write_shift(1,B),T==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var ie=0,ee=0,re=0,K=0;return T<0&&(ie=1,T=-T),ee=Math.log2(T)|0,T/=Math.pow(2,ee-31),K=T>>>0,(K&2147483648)==0&&(T/=2,++ee,K=T>>>0),T-=K,K|=2147483648,K>>>=0,T*=Math.pow(2,32),re=T>>>0,z.write_shift(4,re),z.write_shift(4,K),ee+=16383+(ie?32768:0),z.write_shift(2,ee),z}function W(b,B){var O=N(b,14);return b.l+=B-14,O}function L(b,B){var O=R(b,B),T=b.read_shift(4);return O[1].v=T>>6,O}function J(b,B){var O=R(b,B),T=b.read_shift(8,"f");return O[1].v=T,O}function ue(b,B){var O=J(b,14);return b.l+=B-10,O}function te(b,B){return b[b.l+B-1]==0?b.read_shift(B,"cstr"):""}function ne(b,B){var O=b[b.l++];O>B-1&&(O=B-1);for(var T="";T.length<O;)T+=String.fromCharCode(b[b.l++]);return T}function Q(b,B,O){if(!(!O.qpro||B<21)){var T=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var z=b.read_shift(B-21,"cstr");return[T,z]}}function xe(b,B){for(var O={},T=b.l+B;b.l<T;){var z=b.read_shift(2);if(z==14e3){for(O[z]=[0,""],O[z][0]=b.read_shift(2);b[b.l];)O[z][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return O}function se(b,B){var O=Y(5+b.length);O.write_shift(2,14e3),O.write_shift(2,B);for(var T=0;T<b.length;++T){var z=b.charCodeAt(T);O[O.l++]=z>127?95:z}return O[O.l++]=0,O}var X={0:{n:"BOF",f:mt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},M={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}})();function rm(e){var r={},t=e.match(Mt),a=0,n=!1;if(t)for(;a!=t.length;++a){var i=ye(t[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;r.cp=Hs[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return r}var am=(function(){var e=On("t"),r=On("rPr");function t(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Le(s[1])},c=i.match(r);return c&&(o.s=rm(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(s){return s.replace(a,"").split(n).map(t).filter(function(o){return o.v})}})(),nm=(function(){var r=/(\r\n|\n)/g;function t(n,i,s){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),s.push("</b>")),n.i&&(i.push("<i>"),s.push("</i>")),n.strike&&(i.push("<s>"),s.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&t(n.s,i[0],i[2]),i[0].join("")+i[1].replace(r,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),im=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sm=/<(?:\w+:)?r>/,om=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function xo(e,r){var t=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Le(ze(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ze(e),t&&(a.h=Zs(a.t))):e.match(sm)&&(a.r=ze(e),a.t=Le(ze((e.replace(om,"").match(im)||[]).join("").replace(Mt,""))),t&&(a.h=nm(am(a.r)))),a):{t:""}}var cm=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,lm=/<(?:\w+:)?(?:si|sstItem)>/g,fm=/<\/(?:\w+:)?(?:si|sstItem)>/;function um(e,r){var t=[],a="";if(!e)return t;var n=e.match(cm);if(n){a=n[2].replace(lm,"").split(fm);for(var i=0;i!=a.length;++i){var s=xo(a[i].trim(),r);s!=null&&(t[t.length]=s)}n=ye(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}var dm=/^\s|\s$|[\t\n\r]/;function B0(e,r){if(!r.bookSST)return"";var t=[ft];t[t.length]=oe("sst",null,{xmlns:Ea[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(dm)&&(i+=' xml:space="preserve"'),i+=">"+Ge(n.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function hm(e){return[e.read_shift(4),e.read_shift(4)]}function pm(e,r){var t=[],a=!1;return Vr(e,function(i,s,o){switch(o){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T,!a||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function mm(e,r){return r||(r=Y(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var gm=Sh;function xm(e){var r=qt();Z(r,159,mm(e));for(var t=0;t<e.length;++t)Z(r,19,gm(e[t]));return Z(r,160),r.end()}function M0(e){if(typeof He!="undefined")return He.utils.encode(Va,e);for(var r=[],t=e.split(""),a=0;a<t.length;++a)r[a]=t[a].charCodeAt(0);return r}function $r(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function vm(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=$r(e,4),r.U=$r(e,4),r.W=$r(e,4),r}function ym(e){for(var r=e.read_shift(4),t=e.l+r-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function wm(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(ym(e));return r}function _m(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function km(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=$r(e,4),r.U=$r(e,4),r.W=$r(e,4),r}function Em(e){var r=km(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function U0(e,r){var t=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,a}function $0(e,r){var t={},a=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function bm(e){var r=$r(e);switch(r.Minor){case 2:return[r.Minor,Tm(e,r)];case 3:return[r.Minor,Sm(e,r)];case 4:return[r.Minor,Cm(e,r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Tm(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),a=U0(e,t),n=$0(e,e.length-e.l);return{t:"Std",h:a,v:n}}function Sm(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Cm(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),a={};return t.replace(Mt,function(i){var s=ye(i);switch(Pr(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){a[o]=s[o]});break;case"<dataIntegrity":a.encryptedHmacKey=s.encryptedHmacKey,a.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(s);break;default:throw s[0]}}),a}function Am(e,r){var t={},a=t.EncryptionVersionInfo=$r(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e.read_shift(4),r-=4;var n=e.read_shift(4);return r-=4,t.EncryptionHeader=U0(e,n),r-=n,t.EncryptionVerifier=$0(e,r),t}function Om(e){var r={},t=r.EncryptionVersionInfo=$r(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function vo(e){var r=0,t,a=M0(e),n=a.length+1,i,s,o,c,l;for(t=Qr(n),t[0]=a.length,i=1;i!=n;++i)t[i]=a[i-1];for(i=n-1;i>=0;--i)s=t[i],o=(r&16384)===0?0:1,c=r<<1&32767,l=o|c,r=l^s;return r^52811}var j0=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(s){return(s/2|s*128)&255},n=function(s,o){return a(s^o)},i=function(s){for(var o=r[s.length-1],c=104,l=s.length-1;l>=0;--l)for(var f=s[l],d=0;d!=7;++d)f&64&&(o^=t[c]),f*=2,--c;return o};return function(s){for(var o=M0(s),c=i(o),l=o.length,f=Qr(16),d=0;d!=16;++d)f[d]=0;var u,p,m;for((l&1)===1&&(u=c>>8,f[l]=n(e[0],u),--l,u=c&255,p=o[o.length-1],f[l]=n(p,u));l>0;)--l,u=c>>8,f[l]=n(o[l],u),--l,u=c&255,f[l]=n(o[l],u);for(l=15,m=15-o.length;m>0;)u=c>>8,f[l]=n(e[m],u),--l,--m,u=c&255,f[l]=n(o[l],u),--l,--m;return f}})(),Fm=function(e,r,t,a,n){n||(n=r),a||(a=j0(e));var i,s;for(i=0;i!=r.length;++i)s=r[i],s^=a[t],s=(s>>5|s<<3)&255,n[i]=s,++t;return[n,t,a]},Im=function(e){var r=0,t=j0(e);return function(a){var n=Fm("",a,r,t);return r=n[1],n[0]}};function Pm(e,r,t,a){var n={key:mt(e),verificationBytes:mt(e)};return t.password&&(n.verifier=vo(t.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Im(t.password)),n}function Rm(e,r,t){var a=t||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Om(e,r):a.Data=Am(e,r),a}function Nm(e,r,t){var a={Type:t.biff>=8?e.read_shift(2):0};return a.Type?Rm(e,r-2,a):Pm(e,t.biff>=8?r:r-2,t,a),a}var H0=(function(){function e(n,i){switch(i.type){case"base64":return r(ar(n),i);case"binary":return r(n,i);case"buffer":return r(Fe&&Buffer.isBuffer(n)?n.toString("binary"):aa(n),i);case"array":return r(va(n),i)}throw new Error("Unrecognized type "+i.type)}function r(n,i){var s=i||{},o=s.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var u=/\\\w+\b/g,p=0,m,h=-1;m=u.exec(f);){switch(m[0]){case"\\cell":var g=f.slice(p,u.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++h,g.length){var v={v:g,t:"s"};Array.isArray(o)?o[d][h]=v:o[ve({r:d,c:h})]=v}break}p=u.lastIndex}h>l.e.c&&(l.e.c=h)}),o["!ref"]=Ee(l),o}function t(n,i){return na(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],s=Be(n["!ref"]),o,c=Array.isArray(n),l=s.s.r;l<=s.e.r;++l){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var d=ve({r:l,c:f});o=c?(n[l]||[])[f]:n[d],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(jr(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:a}})();function Dm(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Rn(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Lm(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255,n=Math.max(r,t,a),i=Math.min(r,t,a),s=n-i;if(s===0)return[0,0,r];var o=0,c=0,l=n+i;switch(c=s/(l>1?2-l:l),n){case r:o=((t-a)/s+6)%6;break;case t:o=(a-r)/s+2;break;case a:o=(r-t)/s+4;break}return[o/6,c,l/2]}function Bm(e){var r=e[0],t=e[1],a=e[2],n=t*2*(a<.5?a:1-a),i=a-n/2,s=[i,i,i],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=n*o,s[0]+=n,s[1]+=c;break;case 1:c=n*(2-o),s[0]+=c,s[1]+=n;break;case 2:c=n*(o-2),s[1]+=n,s[2]+=c;break;case 3:c=n*(4-o),s[1]+=c,s[2]+=n;break;case 4:c=n*(o-4),s[2]+=n,s[0]+=c;break;case 5:c=n*(6-o),s[2]+=c,s[0]+=n;break}for(var l=0;l!=3;++l)s[l]=Math.round(s[l]*255);return s}function Fi(e,r){if(r===0)return e;var t=Lm(Dm(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Rn(Bm(t))}var V0=6,Mm=15,Um=1,Rt=V0;function Nn(e){return Math.floor((e+Math.round(128/Rt)/256)*Rt)}function Dn(e){return Math.floor((e-5)/Rt*100+.5)/100}function Ii(e){return Math.round((e*Rt+5)/Rt*256)/256}function _s(e){return Ii(Dn(Nn(e)))}function yo(e){var r=Math.abs(e-_s(e)),t=Rt;if(r>.005)for(Rt=Um;Rt<Mm;++Rt)Math.abs(e-_s(e))<=r&&(r=Math.abs(e-_s(e)),t=Rt);Rt=t}function ea(e){e.width?(e.wpx=Nn(e.width),e.wch=Dn(e.wpx),e.MDW=Rt):e.wpx?(e.wch=Dn(e.wpx),e.width=Ii(e.wch),e.MDW=Rt):typeof e.wch=="number"&&(e.width=Ii(e.wch),e.wpx=Nn(e.width),e.MDW=Rt),e.customWidth&&delete e.customWidth}var $m=96,W0=$m;function Ln(e){return e*96/W0}function za(e){return e*W0/96}var jm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Hm(e,r,t,a){r.Borders=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ye(s);switch(Pr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=Ye(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=Ye(o.diagonalDown)),r.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Vm(e,r,t,a){r.Fills=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ye(s);switch(Pr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function Wm(e,r,t,a){r.Fonts=[];var n={},i=!1;(e[0].match(Mt)||[]).forEach(function(s){var o=ye(s);switch(Pr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=ze(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?Ye(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?Ye(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?Ye(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?Ye(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?Ye(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?Ye(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?Ye(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Hs[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=Ye(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=ha[n.color.index];n.color.index==81&&(c=ha[1]),c||(c=ha[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=Fi(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Gm(e,r,t){r.NumberFmt=[];for(var a=st(ge),n=0;n<a.length;++n)r.NumberFmt[a[n]]=ge[a[n]];var i=e[0].match(Mt);if(i)for(n=0;n<i.length;++n){var s=ye(i[n]);switch(Pr(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Le(ze(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}Ur(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function zm(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var a=t[0];a<=t[1];++a)e[a]!=null&&(r[r.length]=oe("numFmt",null,{numFmtId:a,formatCode:Ge(e[a])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=oe("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var xi=["numFmtId","fillId","fontId","borderId","xfId"],vi=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Xm(e,r,t){r.CellXf=[];var a,n=!1;(e[0].match(Mt)||[]).forEach(function(i){var s=ye(i),o=0;switch(Pr(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=s,delete a[0],o=0;o<xi.length;++o)a[xi[o]]&&(a[xi[o]]=parseInt(a[xi[o]],10));for(o=0;o<vi.length;++o)a[vi[o]]&&(a[vi[o]]=Ye(a[vi[o]]));if(r.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[o]){a.numFmtId=o;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Ye(s.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function Ym(e){var r=[];return r[r.length]=oe("cellXfs",null),e.forEach(function(t){r[r.length]=oe("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=oe("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var qm=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(r))&&Gm(d,f,l),(d=o.match(n))&&Wm(d,f,c,l),(d=o.match(a))&&Vm(d,f,c,l),(d=o.match(i))&&Hm(d,f,c,l),(d=o.match(t))&&Xm(d,f,l),f}})();function G0(e,r){var t=[ft,oe("styleSheet",null,{xmlns:Ea[0],"xmlns:vt":vt.vt})],a;return e.SSF&&(a=zm(e.SSF))!=null&&(t[t.length]=a),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Ym(r.cellXfs))&&(t[t.length]=a),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Km(e,r){var t=e.read_shift(2),a=Lt(e,r-2);return[t,a]}function Jm(e,r,t){t||(t=Y(6+4*r.length)),t.write_shift(2,e),bt(r,t);var a=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),a}function Zm(e,r,t){var a={};a.sz=e.read_shift(2)/20;var n=Rh(e,2,t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(a.underline=s);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=Ph(e,8),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Lt(e,r-21),a}function Qm(e,r){r||(r=Y(153)),r.write_shift(2,e.sz*20),Nh(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),Ci(e.color,r);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),r.write_shift(1,a),bt(e.name,r),r.length>r.l?r.slice(0,r.l):r}var eg=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ks,tg=Bt;function ll(e,r){r||(r=Y(84)),ks||(ks=Li(eg));var t=ks[e.patternType];t==null&&(t=40),r.write_shift(4,t);var a=0;if(t!=40)for(Ci({auto:1},r),Ci({auto:1},r);a<12;++a)r.write_shift(4,0);else{for(;a<4;++a)r.write_shift(4,0);for(;a<12;++a)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function rg(e,r){var t=e.l+r,a=e.read_shift(2),n=e.read_shift(2);return e.l=t,{ixfe:a,numFmtId:n}}function z0(e,r,t){t||(t=Y(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var a=0;return t.write_shift(1,a),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function pn(e,r){return r||(r=Y(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var ag=Bt;function ng(e,r){return r||(r=Y(51)),r.write_shift(1,0),pn(null,r),pn(null,r),pn(null,r),pn(null,r),pn(null,r),r.length>r.l?r.slice(0,r.l):r}function ig(e,r){return r||(r=Y(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,+e.builtinId),r.write_shift(1,0),Si(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function sg(e,r,t){var a=Y(2052);return a.write_shift(4,e),Si(r,a),Si(t,a),a.length>a.l?a.slice(0,a.l):a}function og(e,r,t){var a={};a.NumberFmt=[];for(var n in ge)a.NumberFmt[n]=ge[n];a.CellXf=[],a.Fonts=[];var i=[],s=!1;return Vr(e,function(c,l,f){switch(f){case 44:a.NumberFmt[c[0]]=c[1],Ur(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Fi(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(l.T>0)i.push(f);else if(l.T<0)i.pop();else if(!s||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}function cg(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&++t}),t!=0&&(Z(e,615,Tr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&Z(e,44,Jm(n,r[n]))}),Z(e,616))}}function lg(e){var r=1;r!=0&&(Z(e,611,Tr(r)),Z(e,43,Qm({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Z(e,612))}function fg(e){var r=2;r!=0&&(Z(e,603,Tr(r)),Z(e,45,ll({patternType:"none"})),Z(e,45,ll({patternType:"gray125"})),Z(e,604))}function ug(e){var r=1;r!=0&&(Z(e,613,Tr(r)),Z(e,46,ng({})),Z(e,614))}function dg(e){var r=1;Z(e,626,Tr(r)),Z(e,47,z0({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Z(e,627)}function hg(e,r){Z(e,617,Tr(r.length)),r.forEach(function(t){Z(e,47,z0(t,0))}),Z(e,618)}function pg(e){var r=1;Z(e,619,Tr(r)),Z(e,48,ig({xfId:0,builtinId:0,name:"Normal"})),Z(e,620)}function mg(e){var r=0;Z(e,505,Tr(r)),Z(e,506)}function gg(e){var r=0;Z(e,508,sg(r,"TableStyleMedium9","PivotStyleMedium4")),Z(e,509)}function xg(e,r){var t=qt();return Z(t,278),cg(t,e.SSF),lg(t,e),fg(t,e),ug(t,e),dg(t,e),hg(t,r.cellXfs),pg(t,e),mg(t,e),gg(t,e),Z(t,279),t.end()}var vg=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function yg(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(Mt)||[]).forEach(function(n){var i=ye(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(r.themeElements.clrScheme[vg.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function wg(){}function _g(){}var kg=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Eg=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,bg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Tg(e,r,t){r.themeElements={};var a;[["clrScheme",kg,yg],["fontScheme",Eg,wg],["fmtScheme",bg,_g]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,t)})}var Sg=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function X0(e,r){(!e||e.length===0)&&(e=wo());var t,a={};if(!(t=e.match(Sg)))throw new Error("themeElements not found in theme");return Tg(t[0],a,r),a.raw=e,a}function wo(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[ft];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Cg(e,r,t){var a=e.l+r,n=e.read_shift(4);if(n!==124226){if(!t.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var s;try{s=Wl(i,{type:"array"})}catch{return}var o=rr(s,"theme/theme/theme1.xml",!0);if(o)return X0(o,t)}}function Ag(e){return e.read_shift(4)}function Og(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Fg(e,4);break;case 2:r.xclrValue=S0(e,4);break;case 3:r.xclrValue=Ag(e,4);break;case 4:e.l+=4;break}return e.l+=8,r}function Fg(e,r){return Bt(e,r)}function Ig(e,r){return Bt(e,r)}function Pg(e){var r=e.read_shift(2),t=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Og(e,t);break;case 6:a[1]=Ig(e,t);break;case 14:case 15:a[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return a}function Rg(e,r){var t=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(Pg(e,t-e.l));return{ixfe:a,ext:i}}function Ng(e,r){r.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function Dg(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Lt(e,r-8)}}function Lg(e){var r=Y(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),bt(e.name,r),r.slice(0,r.l)}function Bg(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Mg(e){var r=Y(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Ug(e,r){var t=Y(8+2*r.length);return t.write_shift(4,e),bt(r,t),t.slice(0,t.l)}function $g(e){return e.l+=4,e.read_shift(4)!=0}function jg(e,r){var t=Y(8);return t.write_shift(4,e),t.write_shift(4,r?1:0),t}function Hg(e,r,t){var a={Types:[],Cell:[],Value:[]},n=t||{},i=[],s=!1,o=2;return Vr(e,function(c,l,f){switch(f){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?a.Cell.push({type:a.Types[d[0]-1].name,index:d[1]}):o==0&&a.Value.push({type:a.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!l.T){if(!s||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function Vg(){var e=qt();return Z(e,332),Z(e,334,Tr(1)),Z(e,335,Lg({name:"XLDAPR",version:12e4,flags:3496657072})),Z(e,336),Z(e,339,Ug(1,"XLDAPR")),Z(e,52),Z(e,35,Tr(514)),Z(e,4096,Tr(0)),Z(e,4097,dr(1)),Z(e,36),Z(e,53),Z(e,340),Z(e,337,jg(1,!0)),Z(e,51,Mg([[1,0]])),Z(e,338),Z(e,333),e.end()}function Wg(e,r,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,s;return e.replace(Mt,function(o){var c=ye(o);switch(Pr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==c.name&&(s=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function Y0(){var e=[ft];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Gg(e){var r=[];if(!e)return r;var t=1;return(e.match(Mt)||[]).forEach(function(a){var n=ye(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,r.push(n);break}}),r}function zg(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=ve(t);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function Xg(e,r,t){var a=[],n=!1;return Vr(e,function(s,o,c){switch(c){case 63:a.push(s);break;default:if(!o.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),a}function Yg(e,r,t,a){if(!e)return e;var n=a||{},i=!1,s=!1;Vr(e,function(c,l,f){if(!s)switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},n)}function qg(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var Ma=1024;function q0(e,r){for(var t=[21600,21600],a=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),n=[oe("xml",null,{"xmlns:v":er.v,"xmlns:o":er.o,"xmlns:x":er.x,"xmlns:mv":er.mv}).replace(/\/>/,">"),oe("o:shapelayout",oe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),oe("v:shapetype",[oe("v:stroke",null,{joinstyle:"miter"}),oe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:a})];Ma<e*1e3;)Ma+=1e3;return r.forEach(function(i){var s=tt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?oe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=oe("v:fill",c,o),f={on:"t",obscured:"t"};++Ma,n=n.concat(["<v:shape"+Fn({id:"_x0000_s"+Ma,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,oe("v:shadow",null,f),oe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ot("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Ot("x:AutoFill","False"),Ot("x:Row",String(s.r)),Ot("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function fl(e,r,t,a){var n=Array.isArray(e),i;r.forEach(function(s){var o=tt(s.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[s.ref]=i;var c=Be(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ee(c);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:t};s.h&&(f.h=s.h);for(var d=i.c.length-1;d>=0;--d){if(!t&&i.c[d].T)return;t&&!i.c[d].T&&i.c.splice(d,1)}if(t&&a){for(d=0;d<a.length;++d)if(f.a==a[d].id){f.a=a[d].name||f.a;break}}i.c.push(f)})}function Kg(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=ye(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=tt(c.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var d=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),u=!!d&&!!d[1]&&xo(d[1])||{r:"",t:"",h:""};l.r=u.r,u.r=="<t></t>"&&(u.t=u.h=""),l.t=(u.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=u.h),a.push(l)}}}}),a}function K0(e){var r=[ft,oe("comments",null,{xmlns:Ea[0]})],t=[];return r.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=Ge(n.a);t.indexOf(i)==-1&&(t.push(i),r.push("<author>"+i+"</author>")),n.T&&n.ID&&t.indexOf("tc="+n.ID)==-1&&(t.push("tc="+n.ID),r.push("<author>tc="+n.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=t.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=t.indexOf(Ge(c.a))),i.push(c.t||"")}),r.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)r.push(Ot("t",Ge(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;r.push(Ot("t",Ge(s)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Jg(e,r){var t=[],a=!1,n={},i=0;return e.replace(Mt,function(o,c){var l=ye(o);switch(Pr(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function Zg(e,r,t){var a=[ft,oe("ThreadedComments",null,{xmlns:vt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&r.indexOf(s.a)==-1&&r.push(s.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(s.a)).slice(-12)+"}"),a.push(oe("threadedComment",Ot("text",s.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function Qg(e,r){var t=[],a=!1;return e.replace(Mt,function(i){var s=ye(i);switch(Pr(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),t}function ex(e){var r=[ft,oe("personList",null,{xmlns:vt.TCMNT,"xmlns:x":Ea[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,a){r.push(oe("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function tx(e){var r={};r.iauthor=e.read_shift(4);var t=Ca(e,16);return r.rfx=t.s,r.ref=ve(t.s),e.l+=16,r}function rx(e,r){return r==null&&(r=Y(36)),r.write_shift(4,e[1].iauthor),Ja(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var ax=Lt;function nx(e){return bt(e.slice(0,54))}function ix(e,r){var t=[],a=[],n={},i=!1;return Vr(e,function(o,c,l){switch(l){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}function sx(e){var r=qt(),t=[];return Z(r,628),Z(r,630),e.forEach(function(a){a[1].forEach(function(n){t.indexOf(n.a)>-1||(t.push(n.a.slice(0,54)),Z(r,632,nx(n.a)))})}),Z(r,631),Z(r,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=t.indexOf(n.a);var i={s:tt(a[0]),e:tt(a[0])};Z(r,635,rx([i,n])),n.t&&n.t.length>0&&Z(r,637,Ah(n)),Z(r,636),delete n.iauthor})}),Z(r,634),Z(r,629),r.end()}var ox="application/vnd.ms-office.vbaProject";function cx(e){var r=me.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,a){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");me.utils.cfb_add(r,n,e.FileIndex[a].content)}}),me.write(r)}function lx(e,r){r.FullPaths.forEach(function(t,a){if(a!=0){var n=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&me.utils.cfb_add(e,n,r.FileIndex[a].content)}})}var J0=["xlsb","xlsm","xlam","biff8","xla"];function fx(){return{"!type":"dialog"}}function ux(){return{"!type":"dialog"}}function dx(){return{"!type":"macro"}}function hx(){return{"!type":"macro"}}var ja=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(a,n,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=r.c:--f,c?l+=r.r:--l,n+(o?"":"$")+et(f)+(c?"":"$")+lt(l)}return function(n,i){return r=i,n.replace(e,t)}})(),_o=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ko=(function(){return function(r,t){return r.replace(_o,function(a,n,i,s,o,c){var l=oo(s)-(i?0:t.c),f=so(c)-(o?0:t.r),d=f==0?"":o?f+1:"["+f+"]",u=l==0?"":i?l+1:"["+l+"]";return n+"R"+d+"C"+u})}})();function Z0(e,r){return e.replace(_o,function(t,a,n,i,s,o){return a+(n=="$"?n+i:et(oo(i)+r.c))+(s=="$"?s+o:lt(so(o)+r.r))})}function px(e,r,t){var a=Kt(r),n=a.s,i=tt(t),s={r:i.r-n.r,c:i.c-n.c};return Z0(e,s)}function mx(e){return e.length!=1}function ul(e){return e.replace(/_xlfn\./g,"")}function ht(e){e.l+=1}function ta(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function Q0(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return ef(e,r,t);t.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),s=ta(e,2),o=ta(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function ef(e){var r=ta(e,2),t=ta(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function gx(e,r,t){if(t.biff<8)return ef(e,r,t);var a=e.read_shift(t.biff==12?4:2),n=e.read_shift(t.biff==12?4:2),i=ta(e,2),s=ta(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}function tf(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return xx(e,r,t);var a=e.read_shift(t&&t.biff==12?4:2),n=ta(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function xx(e){var r=ta(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function vx(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function yx(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return wx(e,r,t);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:s,rRel:o}}function wx(e){var r=e.read_shift(2),t=e.read_shift(1),a=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),n==1&&t>=128&&(t=t-256),{r,c:t,cRel:n,rRel:a}}function _x(e,r,t){var a=(e[e.l++]&96)>>5,n=Q0(e,t.biff>=2&&t.biff<=5?6:8,t);return[a,n]}function kx(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=Q0(e,i,t);return[a,n,s]}function Ex(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function bx(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function Tx(e,r,t){var a=(e[e.l++]&96)>>5,n=gx(e,r-1,t);return[a,n]}function Sx(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[a]}function dl(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Cx(e,r,t){e.l+=2;for(var a=e.read_shift(t&&t.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(t&&t.biff==2?1:2));return n}function Ax(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Ox(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Fx(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Ix(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[a]}function rf(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Px(e){return e.read_shift(2),rf(e,2)}function Rx(e){return e.read_shift(2),rf(e,2)}function Nx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=tf(e,0,t);return[a,n]}function Dx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=yx(e,0,t);return[a,n]}function Lx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=tf(e,0,t);return[a,n,i]}function Bx(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(t&&t.biff<=3?1:2);return[$v[n],sf[n],a]}function Mx(e,r,t){var a=e[e.l++],n=e.read_shift(1),i=t&&t.biff<=3?[a==88?-1:0,e.read_shift(1)]:Ux(e);return[n,(i[0]===0?sf:Uv)[i[1]]]}function Ux(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function $x(e,r,t){e.l+=t&&t.biff==2?3:4}function jx(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function Hx(e){return e.l++,Wr[e.read_shift(1)]}function Vx(e){return e.l++,e.read_shift(2)}function Wx(e){return e.l++,e.read_shift(1)!==0}function Gx(e){return e.l++,Nt(e,8)}function zx(e,r,t){return e.l++,jn(e,r-1,t)}function Xx(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=ct(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Wr[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Nt(e,8);break;case 2:t[1]=Aa(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Yx(e,r,t){for(var a=e.read_shift(t.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((t.biff==12?Ca:$i)(e,8));return n}function qx(e,r,t){var a=0,n=0;t.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--n==0&&(n=256));for(var i=0,s=[];i!=a&&(s[i]=[]);++i)for(var o=0;o!=n;++o)s[i][o]=Xx(e,t.biff);return s}function Kx(e,r,t){var a=e.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,i=e.read_shift(n);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function Jx(e,r,t){if(t.biff==5)return Zx(e,r,t);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function Zx(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,t,a]}function Qx(e,r,t){var a=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function ev(e,r,t){var a=e.read_shift(1)>>>5&3,n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function tv(e,r,t){var a=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[a]}function rv(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var av=Bt,nv=Bt,iv=Bt;function Vn(e,r,t){return e.l+=2,[vx(e,4,t)]}function Eo(e){return e.l+=6,[]}var sv=Vn,ov=Eo,cv=Eo,lv=Vn;function af(e){return e.l+=2,[mt(e),e.read_shift(2)&1]}var fv=Vn,uv=af,dv=Eo,hv=Vn,pv=Vn,mv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gv(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),s=mv[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:a,c:n,C:i}}function xv(e){return e.l+=2,[e.read_shift(4)]}function vv(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function yv(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function wv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function _v(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function kv(e){return e.l+=4,[0,0]}var hl={1:{n:"PtgExp",f:jx},2:{n:"PtgTbl",f:iv},3:{n:"PtgAdd",f:ht},4:{n:"PtgSub",f:ht},5:{n:"PtgMul",f:ht},6:{n:"PtgDiv",f:ht},7:{n:"PtgPower",f:ht},8:{n:"PtgConcat",f:ht},9:{n:"PtgLt",f:ht},10:{n:"PtgLe",f:ht},11:{n:"PtgEq",f:ht},12:{n:"PtgGe",f:ht},13:{n:"PtgGt",f:ht},14:{n:"PtgNe",f:ht},15:{n:"PtgIsect",f:ht},16:{n:"PtgUnion",f:ht},17:{n:"PtgRange",f:ht},18:{n:"PtgUplus",f:ht},19:{n:"PtgUminus",f:ht},20:{n:"PtgPercent",f:ht},21:{n:"PtgParen",f:ht},22:{n:"PtgMissArg",f:ht},23:{n:"PtgStr",f:zx},26:{n:"PtgSheet",f:vv},27:{n:"PtgEndSheet",f:yv},28:{n:"PtgErr",f:Hx},29:{n:"PtgBool",f:Wx},30:{n:"PtgInt",f:Vx},31:{n:"PtgNum",f:Gx},32:{n:"PtgArray",f:Sx},33:{n:"PtgFunc",f:Bx},34:{n:"PtgFuncVar",f:Mx},35:{n:"PtgName",f:Kx},36:{n:"PtgRef",f:Nx},37:{n:"PtgArea",f:_x},38:{n:"PtgMemArea",f:Qx},39:{n:"PtgMemErr",f:av},40:{n:"PtgMemNoMem",f:nv},41:{n:"PtgMemFunc",f:ev},42:{n:"PtgRefErr",f:tv},43:{n:"PtgAreaErr",f:Ex},44:{n:"PtgRefN",f:Dx},45:{n:"PtgAreaN",f:Tx},46:{n:"PtgMemAreaN",f:wv},47:{n:"PtgMemNoMemN",f:_v},57:{n:"PtgNameX",f:Jx},58:{n:"PtgRef3d",f:Lx},59:{n:"PtgArea3d",f:kx},60:{n:"PtgRefErr3d",f:rv},61:{n:"PtgAreaErr3d",f:bx},255:{}},Ev={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},bv={1:{n:"PtgElfLel",f:af},2:{n:"PtgElfRw",f:hv},3:{n:"PtgElfCol",f:sv},6:{n:"PtgElfRwV",f:pv},7:{n:"PtgElfColV",f:lv},10:{n:"PtgElfRadical",f:fv},11:{n:"PtgElfRadicalS",f:dv},13:{n:"PtgElfColS",f:ov},15:{n:"PtgElfColSV",f:cv},16:{n:"PtgElfRadicalLel",f:uv},25:{n:"PtgList",f:gv},29:{n:"PtgSxName",f:xv},255:{}},Tv={0:{n:"PtgAttrNoop",f:kv},1:{n:"PtgAttrSemi",f:Ix},2:{n:"PtgAttrIf",f:Ox},4:{n:"PtgAttrChoose",f:Cx},8:{n:"PtgAttrGoto",f:Ax},16:{n:"PtgAttrSum",f:$x},32:{n:"PtgAttrBaxcel",f:dl},33:{n:"PtgAttrBaxcel",f:dl},64:{n:"PtgAttrSpace",f:Px},65:{n:"PtgAttrSpaceSemi",f:Rx},128:{n:"PtgAttrIfError",f:Fx},255:{}};function Wn(e,r,t,a){if(a.biff<8)return Bt(e,r);for(var n=e.l+r,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=qx(e,0,a),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=Yx(e,t[s][1],a),i.push(t[s][2]);break;case"PtgExp":a&&a.biff==12&&(t[s][1][1]=e.read_shift(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0];default:break}return r=n-e.l,r!==0&&i.push(Bt(e,r)),i}function Gn(e,r,t){for(var a=e.l+r,n,i,s=[];a!=e.l;)r=a-e.l,i=e[e.l],n=hl[i]||hl[Ev[i]],(i===24||i===25)&&(n=(i===24?bv:Tv)[e[e.l+1]]),!n||!n.f?Bt(e,r):s.push([n.n,n.f(e,r,t)]);return s}function Sv(e){for(var r=[],t=0;t<e.length;++t){for(var a=e[t],n=[],i=0;i<a.length;++i){var s=a[i];if(s)switch(s[0]){case 2:n.push('"'+s[1].replace(/"/g,'""')+'"');break;default:n.push(s[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var Cv={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Av(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function nf(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(t.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function pl(e,r,t){var a=nf(e,r,t);return a=="#REF"?a:Av(a,t)}function Pt(e,r,t,a,n){var i=n&&n.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,f,d=0,u=0,p,m="";if(!e[0]||!e[0][0])return"";for(var h=-1,g="",v=0,y=e[0].length;v<y;++v){var x=e[0][v];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),h>=0){switch(e[0][h][1][0]){case 0:g=at(" ",e[0][h][1][1]);break;case 1:g=at("\r",e[0][h][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}l=l+g,h=-1}o.push(l+Cv[x[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=yn(x[1][1],s,n),o.push(wn(f,i));break;case"PtgRefN":f=t?yn(x[1][1],t,n):x[1][1],o.push(wn(f,i));break;case"PtgRef3d":d=x[1][1],f=yn(x[1][2],s,n),m=pl(a,d,n);var I=m;o.push(m+"!"+wn(f,i));break;case"PtgFunc":case"PtgFuncVar":var R=x[1][0],P=x[1][1];R||(R=0),R&=127;var k=R==0?[]:o.slice(-R);o.length-=R,P==="User"&&(P=k.shift()),o.push(P+"("+k.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":p=Vc(x[1][1],t?{s:t}:s,n),o.push(vs(p,n));break;case"PtgArea":p=Vc(x[1][1],s,n),o.push(vs(p,n));break;case"PtgArea3d":d=x[1][1],p=x[1][2],m=pl(a,d,n),o.push(m+"!"+vs(p,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=x[1][2];var D=(a.names||[])[u-1]||(a[0]||[])[u],N=D?D.Name:"SH33TJSNAME"+String(u);N&&N.slice(0,6)=="_xlfn."&&!n.xlfn&&(N=N.slice(6)),o.push(N);break;case"PtgNameX":var U=x[1][1];u=x[1][2];var W;if(n.biff<=5)U<0&&(U=-U),a[U]&&(W=a[U][u]);else{var L="";if(((a[U]||[])[0]||[])[0]==14849||(((a[U]||[])[0]||[])[0]==1025?a[U][u]&&a[U][u].itab>0&&(L=a.SheetNames[a[U][u].itab-1]+"!"):L=a.SheetNames[u-1]+"!"),a[U]&&a[U][u])L+=a[U][u].Name;else if(a[0]&&a[0][u])L+=a[0][u].Name;else{var J=(nf(a,U,n)||"").split(";;");J[u-1]?L=J[u-1]:L+="SH33TJSERRX"}o.push(L);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var ue="(",te=")";if(h>=0){switch(g="",e[0][h][1][0]){case 2:ue=at(" ",e[0][h][1][1])+ue;break;case 3:ue=at("\r",e[0][h][1][1])+ue;break;case 4:te=at(" ",e[0][h][1][1])+te;break;case 5:te=at("\r",e[0][h][1][1])+te;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}h=-1}o.push(ue+o.pop()+te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var ne={c:t.c,r:t.r};if(a.sharedf[ve(f)]){var Q=a.sharedf[ve(f)];o.push(Pt(Q,s,ne,a,n))}else{var xe=!1;for(c=0;c!=a.arrayf.length;++c)if(l=a.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(Pt(l[1],s,ne,a,n)),xe=!0;break}xe||o.push(x[1])}break;case"PtgArray":o.push("{"+Sv(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&h>=0&&se.indexOf(e[0][v][0])==-1){x=e[0][h];var X=!0;switch(x[1][0]){case 4:X=!1;case 0:g=at(" ",x[1][1]);break;case 5:X=!1;case 1:g=at("\r",x[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((X?g:"")+o.pop()+(X?"":g)),h=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Ov(e,r,t){var a=e.l+r,n=t.biff==2?1:2,i,s=e.read_shift(n);if(s==65535)return[[],Bt(e,r-2)];var o=Gn(e,s,t);return r!==s+n&&(i=Wn(e,r-s-n,o,t)),e.l=a,[o,i]}function Fv(e,r,t){var a=e.l+r,n=t.biff==2?1:2,i,s=e.read_shift(n);if(s==65535)return[[],Bt(e,r-2)];var o=Gn(e,s,t);return r!==s+n&&(i=Wn(e,r-s-n,o,t)),e.l=a,[o,i]}function Iv(e,r,t,a){var n=e.l+r,i=Gn(e,a,t),s;return n!==e.l&&(s=Wn(e,n-e.l,i,t)),[i,s]}function Pv(e,r,t){var a=e.l+r,n,i=e.read_shift(2),s=Gn(e,i,t);return i==65535?[[],Bt(e,r-2)]:(r!==i+2&&(n=Wn(e,a-i-2,s,t)),[s,n])}function Rv(e){var r;if(Br(e,e.l+6)!==65535)return[Nt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Nv(e){if(e==null){var r=Y(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return ya(e);return ya(0)}function Es(e,r,t){var a=e.l+r,n=Rr(e,6);t.biff==2&&++e.l;var i=Rv(e,8),s=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=Fv(e,a-e.l,t);return{cell:n,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function Dv(e,r,t,a,n){var i=_a(r,t,n),s=Nv(e.v),o=Y(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=Y(e.bf.length),f=0;f<e.bf.length;++f)l[f]=e.bf[f];var d=Et([i,s,o,l]);return d}function ji(e,r,t){var a=e.read_shift(4),n=Gn(e,a,t),i=e.read_shift(4),s=i>0?Wn(e,i,n,t):null;return[n,s]}var Lv=ji,Hi=ji,Bv=ji,Mv=ji,Uv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},sf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$v={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ml(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function jv(e){var r="of:="+e.replace(_o,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function bs(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function Hv(e){return e.replace(/\./,"!")}var kn={},Ha={},En=typeof Map!="undefined";function bo(e,r,t){var a=0,n=e.length;if(t){if(En?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var i=En?t.get(r):t[r];a<i.length;++a)if(e[i[a]].t===r)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===r)return e.Count++,a;return e[n]={t:r},e.Count++,e.Unique++,t&&(En?(t.has(r)||t.set(r,[]),t.get(r).push(n)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(n))),n}function Vi(e,r){var t={min:e+1,max:e+1},a=-1;return r.MDW&&(Rt=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?a=Dn(r.wpx):r.wch!=null&&(a=r.wch),a>-1?(t.width=Ii(a),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function ga(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function ia(e,r,t){var a=t.revssf[r.z!=null?r.z:"General"],n=60,i=e.length;if(a==null&&t.ssf){for(;n<392;++n)if(t.ssf[n]==null){Ur(r.z,n),t.ssf[n]=r.z,t.revssf[r.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function of(e,r,t,a,n,i){try{a.cellNF&&(e.z=ge[r])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=qe(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ge[r]==null&&Ur(Ud[r]||"General",r),e.t==="e")e.w=e.w||Wr[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=An(e.v);else if(e.t==="d"){var s=yt(e.v);(s|0)===s?e.w=s.toString(10):e.w=An(s)}else{if(e.v===void 0)return"";e.w=xa(e.v,Ha)}else e.t==="d"?e.w=pr(r,yt(e.v),Ha):e.w=pr(r,e.v,Ha)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&t!=null)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Fi(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Fi(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function Vv(e,r,t){if(e&&e["!ref"]){var a=Be(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function Wv(e,r){var t=Be(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Ee(t))}var Gv=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,zv=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Xv=/<(?:\w:)?hyperlink [^>]*>/mg,Yv=/"(\w*:\w*)"/,qv=/<(?:\w:)?col\b[^>]*[\/]?>/g,Kv=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Jv=/<(?:\w:)?pageMargins[^>]*\/>/g,cf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Zv=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Qv=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function e2(e,r,t,a,n,i,s){if(!e)return e;a||(a={"!id":{}}),it!=null&&r.dense==null&&(r.dense=it);var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",d=e.match(zv);d?(l=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):l=f=e;var u=l.match(cf);u?To(u[0],o,n,t):(u=l.match(Zv))&&r2(u[0],u[1]||"",o,n,t,s,i);var p=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=l.slice(p,p+50).match(Yv);m&&Wv(o,m[1])}var h=l.match(Qv);h&&h[1]&&m2(h[1],n);var g=[];if(r.cellStyles){var v=l.match(qv);v&&f2(g,v)}d&&v2(d[1],o,r,c,i,s);var y=f.match(Kv);y&&(o["!autofilter"]=d2(y[0]));var x=[],I=f.match(Gv);if(I)for(p=0;p!=I.length;++p)x[p]=Be(I[p].slice(I[p].indexOf('"')+1));var R=f.match(Xv);R&&o2(o,R,a);var P=f.match(Jv);if(P&&(o["!margins"]=c2(ye(P[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ee(c)),r.sheetRows>0&&o["!ref"]){var k=Be(o["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ee(k))}return g.length>0&&(o["!cols"]=g),x.length>0&&(o["!merges"]=x),o}function t2(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Ee(e[t])+'"/>';return r+"</mergeCells>"}function To(e,r,t,a){var n=ye(e);t.Sheets[a]||(t.Sheets[a]={}),n.codeName&&(t.Sheets[a].CodeName=Le(ze(n.codeName)))}function r2(e,r,t,a,n){To(e.slice(0,e.indexOf(">")),t,a,n)}function a2(e,r,t,a,n){var i=!1,s={},o=null;if(a.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[t];try{r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}i=!0,s.codeName=Fr(Ge(c))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+oe("outlinePr",null,l)}!i&&!o||(n[n.length]=oe("sheetPr",o,s))}var n2=["objects","scenarios","selectLockedCells","selectUnlockedCells"],i2=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function s2(e){var r={sheet:1};return n2.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),i2.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=vo(e.password).toString(16).toUpperCase()),oe("sheetProtection",null,r)}function o2(e,r,t){for(var a=Array.isArray(e),n=0;n!=r.length;++n){var i=ye(ze(r[n]),!0);if(!i.ref)return;var s=((t||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Le(i.location))):(i.Target="#"+Le(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Be(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=ve({c:l,r:c});a?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function c2(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function l2(e){return ga(e),oe("pageMargins",null,e)}function f2(e,r){for(var t=!1,a=0;a!=r.length;++a){var n=ye(r[a],!0);n.hidden&&(n.hidden=Ye(n.hidden));var i=parseInt(n.min,10)-1,s=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,yo(n.width)),ea(n);i<=s;)e[i++]=Ke(n)}}function u2(e,r){for(var t=["<cols>"],a,n=0;n!=r.length;++n)(a=r[n])&&(t[t.length]=oe("col",null,Vi(n,a)));return t[t.length]="</cols>",t.join("")}function d2(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function h2(e,r,t,a){var n=typeof e.ref=="string"?e.ref:Ee(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,s=Kt(n);s.s.r==s.e.r&&(s.e.r=Kt(r["!ref"]).e.r,n=Ee(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+t.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+n}),oe("autoFilter",null,{ref:n})}var p2=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function m2(e,r){r.Views||(r.Views=[{}]),(e.match(p2)||[]).forEach(function(t,a){var n=ye(t);r.Views[a]||(r.Views[a]={}),+n.zoomScale&&(r.Views[a].zoom=+n.zoomScale),Ye(n.rightToLeft)&&(r.Views[a].RTL=!0)})}function g2(e,r,t,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),oe("sheetViews",oe("sheetView",null,n),{})}function x2(e,r,t,a){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Wr[e.v];break;case"d":a&&a.cellDates?n=qe(e.v,-1).toISOString():(e=Ke(e),e.t="n",n=""+(e.v=yt(qe(e.v)))),typeof e.z=="undefined"&&(e.z=ge[14]);break;default:n=e.v;break}var o=Ot("v",Ge(n)),c={r},l=ia(a.cellXfs,e,a);switch(l!==0&&(c.s=l),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=Ot("v",""+bo(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;o=oe("f",Ge(e.f),f)+(e.v!=null?o:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(c.cm=1),oe("c",o,c)}var v2=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=On("v"),s=On("f");return function(c,l,f,d,u,p){for(var m=0,h="",g=[],v=[],y=0,x=0,I=0,R="",P,k,D=0,N=0,U,W,L=0,J=0,ue=Array.isArray(p.CellXf),te,ne=[],Q=[],xe=Array.isArray(l),se=[],X={},M=!1,b=!!f.sheetStubs,B=c.split(r),O=0,T=B.length;O!=T;++O){h=B[O].trim();var z=h.length;if(z!==0){var ie=0;e:for(m=0;m<z;++m)switch(h[m]){case">":if(h[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(k=ye(h.slice(ie,m),!0),D=k.r!=null?parseInt(k.r,10):D+1,N=-1,f.sheetRows&&f.sheetRows<D)continue;X={},M=!1,k.ht&&(M=!0,X.hpt=parseFloat(k.ht),X.hpx=za(X.hpt)),k.hidden=="1"&&(M=!0,X.hidden=!0),k.outlineLevel!=null&&(M=!0,X.level=+k.outlineLevel),M&&(se[D-1]=X)}break;case"<":ie=m;break}if(ie>=m)break;if(k=ye(h.slice(ie,m),!0),D=k.r!=null?parseInt(k.r,10):D+1,N=-1,!(f.sheetRows&&f.sheetRows<D)){d.s.r>D-1&&(d.s.r=D-1),d.e.r<D-1&&(d.e.r=D-1),f&&f.cellStyles&&(X={},M=!1,k.ht&&(M=!0,X.hpt=parseFloat(k.ht),X.hpx=za(X.hpt)),k.hidden=="1"&&(M=!0,X.hidden=!0),k.outlineLevel!=null&&(M=!0,X.level=+k.outlineLevel),M&&(se[D-1]=X)),g=h.slice(m).split(e);for(var ee=0;ee!=g.length&&g[ee].trim().charAt(0)=="<";++ee);for(g=g.slice(ee),m=0;m!=g.length;++m)if(h=g[m].trim(),h.length!==0){if(v=h.match(t),y=m,x=0,I=0,h="<c "+(h.slice(0,1)=="<"?">":"")+h,v!=null&&v.length===2){for(y=0,R=v[1],x=0;x!=R.length&&!((I=R.charCodeAt(x)-64)<1||I>26);++x)y=26*y+I;--y,N=y}else++N;for(x=0;x!=h.length&&h.charCodeAt(x)!==62;++x);if(++x,k=ye(h.slice(0,x),!0),k.r||(k.r=ve({r:D-1,c:N})),R=h.slice(x),P={t:""},(v=R.match(i))!=null&&v[1]!==""&&(P.v=Le(v[1])),f.cellFormula){if((v=R.match(s))!=null&&v[1]!==""){if(P.f=Le(ze(v[1])).replace(/\r\n/g,`
`),f.xlfn||(P.f=ul(P.f)),v[0].indexOf('t="array"')>-1)P.F=(R.match(n)||[])[1],P.F.indexOf(":")>-1&&ne.push([Be(P.F),P.F]);else if(v[0].indexOf('t="shared"')>-1){W=ye(v[0]);var re=Le(ze(v[1]));f.xlfn||(re=ul(re)),Q[parseInt(W.si,10)]=[W,re,k.r]}}else(v=R.match(/<f[^>]*\/>/))&&(W=ye(v[0]),Q[W.si]&&(P.f=px(Q[W.si][1],Q[W.si][2],k.r)));var K=tt(k.r);for(x=0;x<ne.length;++x)K.r>=ne[x][0].s.r&&K.r<=ne[x][0].e.r&&K.c>=ne[x][0].s.c&&K.c<=ne[x][0].e.c&&(P.F=ne[x][1])}if(k.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(b)P.t="z";else continue;else P.t=k.t||"n";switch(d.s.c>N&&(d.s.c=N),d.e.c<N&&(d.e.c=N),P.t){case"n":if(P.v==""||P.v==null){if(!b)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v=="undefined"){if(!b)continue;P.t="z"}else U=kn[parseInt(P.v,10)],P.v=U.t,P.r=U.r,f.cellHTML&&(P.h=U.h);break;case"str":P.t="s",P.v=P.v!=null?ze(P.v):"",f.cellHTML&&(P.h=Zs(P.v));break;case"inlineStr":v=R.match(a),P.t="s",v!=null&&(U=xo(v[1]))?(P.v=U.t,f.cellHTML&&(P.h=U.h)):P.v="";break;case"b":P.v=Ye(P.v);break;case"d":f.cellDates?P.v=qe(P.v,1):(P.v=yt(qe(P.v,1)),P.t="n");break;case"e":(!f||f.cellText!==!1)&&(P.w=P.v),P.v=l0[P.v];break}if(L=J=0,te=null,ue&&k.s!==void 0&&(te=p.CellXf[k.s],te!=null&&(te.numFmtId!=null&&(L=te.numFmtId),f.cellStyles&&te.fillId!=null&&(J=te.fillId))),of(P,L,J,f,u,p),f.cellDates&&ue&&P.t=="n"&&Xa(ge[L])&&(P.t="d",P.v=Mi(P.v)),k.cm&&f.xlmeta){var we=(f.xlmeta.Cell||[])[+k.cm-1];we&&we.type=="XLDAPR"&&(P.D=!0)}if(xe){var F=tt(k.r);l[F.r]||(l[F.r]=[]),l[F.r][F.c]=P}else l[k.r]=P}}}}se.length>0&&(l["!rows"]=se)}})();function y2(e,r,t,a){var n=[],i=[],s=Be(e["!ref"]),o="",c,l="",f=[],d=0,u=0,p=e["!rows"],m=Array.isArray(e),h={r:l},g,v=-1;for(u=s.s.c;u<=s.e.c;++u)f[u]=et(u);for(d=s.s.r;d<=s.e.r;++d){for(i=[],l=lt(d),u=s.s.c;u<=s.e.c;++u){c=f[u]+l;var y=m?(e[d]||[])[u]:e[c];y!==void 0&&(o=x2(y,c,e,r,t,a))!=null&&i.push(o)}(i.length>0||p&&p[d])&&(h={r:l},p&&p[d]&&(g=p[d],g.hidden&&(h.hidden=1),v=-1,g.hpx?v=Ln(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(h.ht=v,h.customHeight=1),g.level&&(h.outlineLevel=g.level)),n[n.length]=oe("row",i.join(""),h))}if(p)for(;d<p.length;++d)p&&p[d]&&(h={r:d+1},g=p[d],g.hidden&&(h.hidden=1),v=-1,g.hpx?v=Ln(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(h.ht=v,h.customHeight=1),g.level&&(h.outlineLevel=g.level),n[n.length]=oe("row","",h));return n.join("")}function lf(e,r,t,a){var n=[ft,oe("worksheet",null,{xmlns:Ea[0],"xmlns:r":vt.r})],i=t.SheetNames[e],s=0,o="",c=t.Sheets[i];c==null&&(c={});var l=c["!ref"]||"A1",f=Be(l);if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),l=Ee(f)}a||(a={}),c["!comments"]=[];var d=[];a2(c,t,e,r,n),n[n.length]=oe("dimension",null,{ref:l}),n[n.length]=g2(c,r,e,t),r.sheetFormat&&(n[n.length]=oe("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=u2(c,c["!cols"])),n[s=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=y2(c,r,e,t,a),o.length>0&&(n[n.length]=o)),n.length>s+1&&(n[n.length]="</sheetData>",n[s]=n[s].replace("/>",">")),c["!protect"]&&(n[n.length]=s2(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=h2(c["!autofilter"],c,t,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=t2(c["!merges"]));var u=-1,p,m=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(h){h[1].Target&&(p={ref:h[0]},h[1].Target.charAt(0)!="#"&&(m=We(a,-1,Ge(h[1].Target).replace(/#.*$/,""),Se.HLINK),p["r:id"]="rId"+m),(u=h[1].Target.indexOf("#"))>-1&&(p.location=Ge(h[1].Target.slice(u+1))),h[1].Tooltip&&(p.tooltip=Ge(h[1].Tooltip)),n[n.length]=oe("hyperlink",null,p))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=l2(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(n[n.length]=Ot("ignoredErrors",oe("ignoredError",null,{numberStoredAsText:1,sqref:l}))),d.length>0&&(m=We(a,-1,"../drawings/drawing"+(e+1)+".xml",Se.DRAW),n[n.length]=oe("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=d),c["!comments"].length>0&&(m=We(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Se.VML),n[n.length]=oe("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function w2(e,r){var t={},a=e.l+r;t.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=n/20),t}function _2(e,r,t){var a=Y(145),n=(t["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=Ln(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var s=0;n.level&&(s|=n.level),n.hidden&&(s|=16),(n.hpx||n.hpt)&&(s|=32),a.write_shift(1,s),a.write_shift(1,0);var o=0,c=a.l;a.l+=4;for(var l={r:e,c:0},f=0;f<16;++f)if(!(r.s.c>f+1<<10||r.e.c<f<<10)){for(var d=-1,u=-1,p=f<<10;p<f+1<<10;++p){l.c=p;var m=Array.isArray(t)?(t[l.r]||[])[l.c]:t[ve(l)];m&&(d<0&&(d=p),u=p)}d<0||(++o,a.write_shift(4,d),a.write_shift(4,u))}var h=a.l;return a.l=c,a.write_shift(4,o),a.l=h,a.length>a.l?a.slice(0,a.l):a}function k2(e,r,t,a){var n=_2(a,t,r);(n.length>17||(r["!rows"]||[])[a])&&Z(e,0,n)}var E2=Ca,b2=Ja;function T2(){}function S2(e,r){var t={},a=e[e.l];return++e.l,t.above=!(a&64),t.left=!(a&128),e.l+=18,t.name=Oh(e,r-19),t}function C2(e,r,t){t==null&&(t=Y(84+4*e.length));var a=192;r&&(r.above&&(a&=-65),r.left&&(a&=-129)),t.write_shift(1,a);for(var n=1;n<3;++n)t.write_shift(1,0);return Ci({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),n0(e,t),t.slice(0,t.l)}function A2(e){var r=mr(e);return[r]}function O2(e,r,t){return t==null&&(t=Y(8)),ba(r,t)}function F2(e){var r=Ta(e);return[r]}function I2(e,r,t){return t==null&&(t=Y(4)),Sa(r,t)}function P2(e){var r=mr(e),t=e.read_shift(1);return[r,t,"b"]}function R2(e,r,t){return t==null&&(t=Y(9)),ba(r,t),t.write_shift(1,e.v?1:0),t}function N2(e){var r=Ta(e),t=e.read_shift(1);return[r,t,"b"]}function D2(e,r,t){return t==null&&(t=Y(5)),Sa(r,t),t.write_shift(1,e.v?1:0),t}function L2(e){var r=mr(e),t=e.read_shift(1);return[r,t,"e"]}function B2(e,r,t){return t==null&&(t=Y(9)),ba(r,t),t.write_shift(1,e.v),t}function M2(e){var r=Ta(e),t=e.read_shift(1);return[r,t,"e"]}function U2(e,r,t){return t==null&&(t=Y(8)),Sa(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function $2(e){var r=mr(e),t=e.read_shift(4);return[r,t,"s"]}function j2(e,r,t){return t==null&&(t=Y(12)),ba(r,t),t.write_shift(4,r.v),t}function H2(e){var r=Ta(e),t=e.read_shift(4);return[r,t,"s"]}function V2(e,r,t){return t==null&&(t=Y(8)),Sa(r,t),t.write_shift(4,r.v),t}function W2(e){var r=mr(e),t=Nt(e);return[r,t,"n"]}function G2(e,r,t){return t==null&&(t=Y(16)),ba(r,t),ya(e.v,t),t}function ff(e){var r=Ta(e),t=Nt(e);return[r,t,"n"]}function z2(e,r,t){return t==null&&(t=Y(12)),Sa(r,t),ya(e.v,t),t}function X2(e){var r=mr(e),t=uo(e);return[r,t,"n"]}function Y2(e,r,t){return t==null&&(t=Y(12)),ba(r,t),i0(e.v,t),t}function q2(e){var r=Ta(e),t=uo(e);return[r,t,"n"]}function K2(e,r,t){return t==null&&(t=Y(8)),Sa(r,t),i0(e.v,t),t}function J2(e){var r=mr(e),t=co(e);return[r,t,"is"]}function Z2(e){var r=mr(e),t=Lt(e);return[r,t,"str"]}function Q2(e,r,t){return t==null&&(t=Y(12+4*e.v.length)),ba(r,t),bt(e.v,t),t.length>t.l?t.slice(0,t.l):t}function ey(e){var r=Ta(e),t=Lt(e);return[r,t,"str"]}function ty(e,r,t){return t==null&&(t=Y(8+4*e.v.length)),Sa(r,t),bt(e.v,t),t.length>t.l?t.slice(0,t.l):t}function ry(e,r,t){var a=e.l+r,n=mr(e);n.r=t["!row"];var i=e.read_shift(1),s=[n,i,"b"];if(t.cellFormula){e.l+=2;var o=Hi(e,a-e.l,t);s[3]=Pt(o,null,n,t.supbooks,t)}else e.l=a;return s}function ay(e,r,t){var a=e.l+r,n=mr(e);n.r=t["!row"];var i=e.read_shift(1),s=[n,i,"e"];if(t.cellFormula){e.l+=2;var o=Hi(e,a-e.l,t);s[3]=Pt(o,null,n,t.supbooks,t)}else e.l=a;return s}function ny(e,r,t){var a=e.l+r,n=mr(e);n.r=t["!row"];var i=Nt(e),s=[n,i,"n"];if(t.cellFormula){e.l+=2;var o=Hi(e,a-e.l,t);s[3]=Pt(o,null,n,t.supbooks,t)}else e.l=a;return s}function iy(e,r,t){var a=e.l+r,n=mr(e);n.r=t["!row"];var i=Lt(e),s=[n,i,"str"];if(t.cellFormula){e.l+=2;var o=Hi(e,a-e.l,t);s[3]=Pt(o,null,n,t.supbooks,t)}else e.l=a;return s}var sy=Ca,oy=Ja;function cy(e,r){return r==null&&(r=Y(4)),r.write_shift(4,e),r}function ly(e,r){var t=e.l+r,a=Ca(e,16),n=lo(e),i=Lt(e),s=Lt(e),o=Lt(e);e.l=t;var c={rfx:a,relId:n,loc:i,display:o};return s&&(c.Tooltip=s),c}function fy(e,r){var t=Y(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ja({s:tt(e[0]),e:tt(e[0])},t),fo("rId"+r,t);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return bt(n||"",t),bt(e[1].Tooltip||"",t),bt("",t),t.slice(0,t.l)}function uy(){}function dy(e,r,t){var a=e.l+r,n=s0(e,16),i=e.read_shift(1),s=[n];if(s[2]=i,t.cellFormula){var o=Lv(e,a-e.l,t);s[1]=o}else e.l=a;return s}function hy(e,r,t){var a=e.l+r,n=Ca(e,16),i=[n];if(t.cellFormula){var s=Mv(e,a-e.l,t);i[1]=s,e.l=a}else e.l=a;return i}function py(e,r,t){t==null&&(t=Y(18));var a=Vi(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(a.width||10)*256),t.write_shift(4,0);var n=0;return r.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),r.level&&(n|=r.level<<8),t.write_shift(2,n),t}var uf=["left","right","top","bottom","header","footer"];function my(e){var r={};return uf.forEach(function(t){r[t]=Nt(e,8)}),r}function gy(e,r){return r==null&&(r=Y(48)),ga(e),uf.forEach(function(t){ya(e[t],r)}),r}function xy(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function vy(e,r,t){t==null&&(t=Y(30));var a=924;return(((r||{}).Views||[])[0]||{}).RTL&&(a|=32),t.write_shift(2,a),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function yy(e){var r=Y(24);return r.write_shift(4,4),r.write_shift(4,1),Ja(e,r),r}function wy(e,r){return r==null&&(r=Y(66)),r.write_shift(2,e.password?vo(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function _y(){}function ky(){}function Ey(e,r,t,a,n,i,s){if(!e)return e;var o=r||{};a||(a={"!id":{}}),it!=null&&o.dense==null&&(o.dense=it);var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=[],u=!1,p=!1,m,h,g,v,y,x,I,R,P,k=[];o.biff=12,o["!row"]=0;var D=0,N=!1,U=[],W={},L=o.supbooks||n.supbooks||[[]];if(L.sharedf=W,L.arrayf=U,L.SheetNames=n.SheetNames||n.Sheets.map(function(X){return X.name}),!o.supbooks&&(o.supbooks=L,n.Names))for(var J=0;J<n.Names.length;++J)L[0][J+1]=n.Names[J];var ue=[],te=[],ne=!1;Bn[16]={n:"BrtShortReal",f:ff};var Q,xe;if(Vr(e,function(M,b,B){if(!p)switch(B){case 148:l=M;break;case 0:m=M,o.sheetRows&&o.sheetRows<=m.r&&(p=!0),R=lt(v=m.r),o["!row"]=m.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=za(M.hpt)),te[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(h={t:M[2]},M[2]){case"n":h.v=M[1];break;case"s":I=kn[M[1]],h.v=I.t,h.r=I.r;break;case"b":h.v=!!M[1];break;case"e":h.v=M[1],o.cellText!==!1&&(h.w=Wr[h.v]);break;case"str":h.t="s",h.v=M[1];break;case"is":h.t="s",h.v=M[1].t;break}if((g=s.CellXf[M[0].iStyleRef])&&of(h,g.numFmtId,null,o,i,s),y=M[0].c==-1?y+1:M[0].c,o.dense?(c[v]||(c[v]=[]),c[v][y]=h):c[et(y)+R]=h,o.cellFormula){for(N=!1,D=0;D<U.length;++D){var O=U[D];m.r>=O[0].s.r&&m.r<=O[0].e.r&&y>=O[0].s.c&&y<=O[0].e.c&&(h.F=Ee(O[0]),N=!0)}!N&&M.length>3&&(h.f=M[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),o.cellDates&&g&&h.t=="n"&&Xa(ge[g.numFmtId])){var T=da(h.v);T&&(h.t="d",h.v=new Date(T.y,T.m-1,T.d,T.H,T.M,T.S,T.u))}Q&&(Q.type=="XLDAPR"&&(h.D=!0),Q=void 0),xe&&(xe=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;h={t:"z",v:void 0},y=M[0].c==-1?y+1:M[0].c,o.dense?(c[v]||(c[v]=[]),c[v][y]=h):c[et(y)+R]=h,f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),Q&&(Q.type=="XLDAPR"&&(h.D=!0),Q=void 0),xe&&(xe=void 0);break;case 176:k.push(M);break;case 49:Q=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var z=a["!id"][M.relId];for(z?(M.Target=z.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=z):M.relId==""&&(M.Target="#"+M.loc),v=M.rfx.s.r;v<=M.rfx.e.r;++v)for(y=M.rfx.s.c;y<=M.rfx.e.c;++y)o.dense?(c[v]||(c[v]=[]),c[v][y]||(c[v][y]={t:"z",v:void 0}),c[v][y].l=M):(x=ve({c:y,r:v}),c[x]||(c[x]={t:"z",v:void 0}),c[x].l=M);break;case 426:if(!o.cellFormula)break;U.push(M),P=o.dense?c[v][y]:c[et(y)+R],P.f=Pt(M[1],f,{r:m.r,c:y},L,o),P.F=Ee(M[0]);break;case 427:if(!o.cellFormula)break;W[ve(M[0].s)]=M[1],P=o.dense?c[v][y]:c[et(y)+R],P.f=Pt(M[1],f,{r:m.r,c:y},L,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)ue[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},ne||(ne=!0,yo(M.w/256)),ea(ue[M.e+1]);break;case 161:c["!autofilter"]={ref:Ee(M)};break;case 476:c["!margins"]=M;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),M.name&&(n.Sheets[t].CodeName=M.name),(M.above||M.left)&&(c["!outline"]={above:M.above,left:M.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),M.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:d.push(B),u=!0;break;case 38:d.pop(),u=!1;break;default:if(!b.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ee(l||f)),o.sheetRows&&c["!ref"]){var se=Be(c["!ref"]);o.sheetRows<=+se.e.r&&(se.e.r=o.sheetRows-1,se.e.r>f.e.r&&(se.e.r=f.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>f.e.c&&(se.e.c=f.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ee(se))}return k.length>0&&(c["!merges"]=k),ue.length>0&&(c["!cols"]=ue),te.length>0&&(c["!rows"]=te),c}function by(e,r,t,a,n,i,s){if(r.v===void 0)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":r=Ke(r),r.z=r.z||ge[14],r.v=yt(qe(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v;break}var c={r:t,c:a};switch(c.s=ia(n.cellXfs,r,n),r.l&&i["!links"].push([ve(c),r.l]),r.c&&i["!comments"].push([ve(c),r.c]),r.t){case"s":case"str":return n.bookSST?(o=bo(n.Strings,r.v,n.revStrings),c.t="s",c.v=o,s?Z(e,18,V2(r,c)):Z(e,7,j2(r,c))):(c.t="str",s?Z(e,17,ty(r,c)):Z(e,6,Q2(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?s?Z(e,13,K2(r,c)):Z(e,2,Y2(r,c)):s?Z(e,16,z2(r,c)):Z(e,5,G2(r,c)),!0;case"b":return c.t="b",s?Z(e,15,D2(r,c)):Z(e,4,R2(r,c)),!0;case"e":return c.t="e",s?Z(e,14,U2(r,c)):Z(e,3,B2(r,c)),!0}return s?Z(e,12,I2(r,c)):Z(e,1,O2(r,c)),!0}function Ty(e,r,t,a){var n=Be(r["!ref"]||"A1"),i,s="",o=[];Z(e,145);var c=Array.isArray(r),l=n.e.r;r["!rows"]&&(l=Math.max(n.e.r,r["!rows"].length-1));for(var f=n.s.r;f<=l;++f){s=lt(f),k2(e,r,n,f);var d=!1;if(f<=n.e.r)for(var u=n.s.c;u<=n.e.c;++u){f===n.s.r&&(o[u]=et(u)),i=o[u]+s;var p=c?(r[f]||[])[u]:r[i];if(!p){d=!1;continue}d=by(e,p,f,u,a,r,d)}}Z(e,146)}function Sy(e,r){!r||!r["!merges"]||(Z(e,177,cy(r["!merges"].length)),r["!merges"].forEach(function(t){Z(e,176,oy(t))}),Z(e,178))}function Cy(e,r){!r||!r["!cols"]||(Z(e,390),r["!cols"].forEach(function(t,a){t&&Z(e,60,py(a,t))}),Z(e,391))}function Ay(e,r){!r||!r["!ref"]||(Z(e,648),Z(e,649,yy(Be(r["!ref"]))),Z(e,650))}function Oy(e,r,t){r["!links"].forEach(function(a){if(a[1].Target){var n=We(t,-1,a[1].Target.replace(/#.*$/,""),Se.HLINK);Z(e,494,fy(a,n))}}),delete r["!links"]}function Fy(e,r,t,a){if(r["!comments"].length>0){var n=We(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Se.VML);Z(e,551,fo("rId"+n)),r["!legacy"]=n}}function Iy(e,r,t,a){if(r["!autofilter"]){var n=r["!autofilter"],i=typeof n.ref=="string"?n.ref:Ee(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,o=Kt(i);o.s.r==o.e.r&&(o.e.r=Kt(r["!ref"]).e.r,i=Ee(o));for(var c=0;c<s.length;++c){var l=s[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+t.SheetNames[a]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+i}),Z(e,161,Ja(Be(i))),Z(e,162)}}function Py(e,r,t){Z(e,133),Z(e,137,vy(r,t)),Z(e,138),Z(e,134)}function Ry(e,r){r["!protect"]&&Z(e,535,wy(r["!protect"]))}function Ny(e,r,t,a){var n=qt(),i=t.SheetNames[e],s=t.Sheets[i]||{},o=i;try{t&&t.Workbook&&(o=t.Workbook.Sheets[e].CodeName||o)}catch{}var c=Be(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Z(n,129),(t.vbaraw||s["!outline"])&&Z(n,147,C2(o,s["!outline"])),Z(n,148,b2(c)),Py(n,s,t.Workbook),Cy(n,s,e,r,t),Ty(n,s,e,r,t),Ry(n,s),Iy(n,s,t,e),Sy(n,s),Oy(n,s,a),s["!margins"]&&Z(n,476,gy(s["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&Ay(n,s),Fy(n,s,e,a),Z(n,130),n.end()}function Dy(e){var r=[],t=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=t?+s[2]:s[2])});var n=Le((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[r,n,a]}function Ly(e,r,t,a,n,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var u=Dy(d);f.s.r=f.s.c=0,f.e.c=o,l=et(o),u[0].forEach(function(p,m){s[l+lt(m)]={t:"n",v:p,z:u[1]},c=m}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(s["!ref"]=Ee(f)),s}function By(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(cf);return o&&To(o[0],i,n,t),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function My(e,r){e.l+=10;var t=Lt(e,r-10);return{name:t}}function Uy(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return Vr(e,function(l,f,d){switch(d){case 550:i["!rel"]=l;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),l.name&&(n.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d);break;case 38:s.pop();break;default:if(f.T>0)s.push(d);else if(f.T<0)s.pop();else if(!o||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}},r),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var So=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],$y=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],jy=[],Hy=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function gl(e,r){for(var t=0;t!=e.length;++t)for(var a=e[t],n=0;n!=r.length;++n){var i=r[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=Ye(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function xl(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Ye(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function df(e){xl(e.WBProps,So),xl(e.CalcPr,Hy),gl(e.WBView,$y),gl(e.Sheets,jy),Ha.date1904=Ye(e.WBProps.date1904)}function Vy(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ye(e.Workbook.WBProps.date1904)?"true":"false"}var Wy="][*?/\\".split("");function hf(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return Wy.forEach(function(a){if(e.indexOf(a)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}function Gy(e,r,t){e.forEach(function(a,n){hf(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(t){var s=r&&r[n]&&r[n].CodeName||a;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function zy(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];Gy(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Vv(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var Xy=/<\w+:workbook/;function Yy(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},s=0;if(e.replace(Mt,function(c,l){var f=ye(c);switch(Pr(f[0])){case"<?xml":break;case"<workbook":c.match(Xy)&&(n="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":So.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":t.WBProps[d[0]]=Ye(f[d[0]]);break;case"int":t.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:t.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(t.WBProps.CodeName=ze(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Le(ze(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=ze(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),Ye(f.hidden||"0")&&(i.Hidden=!0),s=l+c.length;break;case"</definedName>":i.Ref=Le(ze(e.slice(s,l))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Ea.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return df(t),t}function pf(e){var r=[ft];r[r.length]=oe("workbook",null,{xmlns:Ea[0],"xmlns:r":vt.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(So.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),r[r.length]=oe("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ge(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}r[r.length]=oe("sheet",null,s)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(r[r.length]=oe("definedName",Ge(o.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function qy(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Ps(e,r-8),t.name=Lt(e),t}function Ky(e,r){return r||(r=Y(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),fo(e.strRelID,r),bt(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function Jy(e,r){var t={},a=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var n=r>8?Lt(e):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function Zy(e,r){r||(r=Y(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),n0(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function Qy(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function ew(e,r,t){var a=e.l+r;e.l+=4,e.l+=1;var n=e.read_shift(4),i=Fh(e),s=Bv(e,0,t),o=lo(e);e.l=a;var c={Name:i,Ptg:s};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function tw(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Bn[16]={n:"BrtFRTArchID$",f:Qy},Vr(e,function(c,l,f){switch(f){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=Pt(c.Ptg,null,null,s,r),delete r.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,c]):s[0]=[f,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},r),df(t),t.Names=i,t.supbooks=s,t}function rw(e,r){Z(e,143);for(var t=0;t!=r.SheetNames.length;++t){var a=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,n={Hidden:a,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Z(e,156,Ky(n))}Z(e,144)}function aw(e,r){r||(r=Y(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return bt("SheetJS",r),bt(Sn.version,r),bt(Sn.version,r),bt("7262",r),r.length>r.l?r.slice(0,r.l):r}function nw(e,r){r||(r=Y(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function iw(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,a=0,n=-1,i=-1;a<t.length;++a)!t[a]||!t[a].Hidden&&n==-1?n=a:t[a].Hidden==1&&i==-1&&(i=a);i>n||(Z(e,135),Z(e,158,nw(n)),Z(e,136))}}function sw(e,r){var t=qt();return Z(t,131),Z(t,128,aw()),Z(t,153,Zy(e.Workbook&&e.Workbook.WBProps||null)),iw(t,e,r),rw(t,e,r),Z(t,132),t.end()}function ow(e,r,t){return r.slice(-4)===".bin"?tw(e,t):Yy(e,t)}function cw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?Ey(e,a,t,n,i,s,o):e2(e,a,t,n,i,s,o)}function lw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?Uy(e,a,t,n,i,s,o):By(e,a,t,n,i,s,o)}function fw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?dx(e,a,t,n,i,s,o):hx(e,a,t,n,i,s,o)}function uw(e,r,t,a,n,i,s,o){return r.slice(-4)===".bin"?fx(e,a,t,n,i,s,o):ux(e,a,t,n,i,s,o)}function dw(e,r,t,a){return r.slice(-4)===".bin"?og(e,t,a):qm(e,t,a)}function hw(e,r,t){return X0(e,t)}function pw(e,r,t){return r.slice(-4)===".bin"?pm(e,t):um(e,t)}function mw(e,r,t){return r.slice(-4)===".bin"?ix(e,t):Kg(e,t)}function gw(e,r,t){return r.slice(-4)===".bin"?Xg(e,r,t):Gg(e,r,t)}function xw(e,r,t,a){return t.slice(-4)===".bin"?Yg(e,r,t,a):void 0}function vw(e,r,t){return r.slice(-4)===".bin"?Hg(e,r,t):Wg(e,r,t)}function yw(e,r,t){return(r.slice(-4)===".bin"?sw:pf)(e,t)}function ww(e,r,t,a,n){return(r.slice(-4)===".bin"?Ny:lf)(e,t,a,n)}function _w(e,r,t){return(r.slice(-4)===".bin"?xg:G0)(e,t)}function kw(e,r,t){return(r.slice(-4)===".bin"?xm:B0)(e,t)}function Ew(e,r,t){return(r.slice(-4)===".bin"?sx:K0)(e,t)}function bw(e){return(e.slice(-4)===".bin"?Vg:Y0)()}var mf=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gf=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _r(e,r){var t=e.split(/\s+/),a=[];if(r||(a[0]=t[0]),t.length===1)return a;var n=e.match(mf),i,s,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(gf),(s=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),a[o]=i[2].slice(1,i[2].length-1));return a}function Tw(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var a=e.match(mf),n,i,s,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(gf),(i=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?s="xmlns"+n[1].slice(6):s=n[1].slice(i+1),t[s]=n[2].slice(1,n[2].length-1));return t}var bn;function Sw(e,r){var t=bn[e]||Le(e);return t==="General"?xa(r):pr(t,r)}function Cw(e,r,t,a){var n=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Ye(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=qe(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Le(r)]=n}function Aw(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Wr[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=An(e.v):e.w=xa(e.v):e.w=Sw(r||"General",e.v)}catch(i){if(t.WTF)throw i}try{var a=bn[r]||r||"General";if(t.cellNF&&(e.z=a),t.cellDates&&e.t=="n"&&Xa(a)){var n=da(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(t.WTF)throw i}}}function Ow(e,r,t){if(t.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=jm[a.Pattern]||a.Pattern)}e[r.ID]=r}function Fw(e,r,t,a,n,i,s,o,c,l){var f="General",d=a.StyleID,u={};l=l||{};var p=[],m=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&s&&(d=s.StyleID);i[d]!==void 0&&(i[d].nf&&(f=i[d].nf),i[d].Interior&&p.push(i[d].Interior),!!i[d].Parent);)d=i[d].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=Ye(e);break;case"String":a.t="s",a.r=Nc(Le(e)),a.v=e.indexOf("<")>-1?Le(r||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(qe(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Le(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=l0[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=Nc(r||e));break}if(Aw(a,f,l),l.cellFormula!==!1)if(a.Formula){var h=Le(a.Formula);h.charCodeAt(0)==61&&(h=h.slice(1)),a.f=ja(h,n),delete a.Formula,a.ArrayRange=="RC"?a.F=ja("RC:RC",n):a.ArrayRange&&(a.F=ja(a.ArrayRange,n),c.push([Be(a.F),a.F]))}else for(m=0;m<c.length;++m)n.r>=c[m][0].s.r&&n.r<=c[m][0].e.r&&n.c>=c[m][0].s.c&&n.c<=c[m][0].e.c&&(a.F=c[m][1]);l.cellStyles&&(p.forEach(function(g){!u.patternType&&g.patternType&&(u.patternType=g.patternType)}),a.s=u),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function Iw(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ts(e,r){var t=r||{};Ya();var a=mn(Qs(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof He!="undefined"?a=He.utils.decode(65001,Fs(a)):a=ze(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var s=Ke(t);return s.type="string",Ga.to_workbook(a,s)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ze){n.indexOf("<"+Ze)>=0&&(i=!0)}),i)return g_(a,t);bn={"General Number":"General","General Date":ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ge[15],"Short Date":ge[14],"Long Time":ge[19],"Medium Time":ge[18],"Short Time":ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ge[2],Standard:ge[4],Percent:ge[10],Scientific:ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l;it!=null&&t.dense==null&&(t.dense=it);var f={},d=[],u=t.dense?[]:{},p="",m={},h={},g=_r('<Data ss:Type="String">'),v=0,y=0,x=0,I={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},P={},k="",D=0,N=[],U={},W={},L=0,J=[],ue=[],te={},ne=[],Q,xe=!1,se=[],X=[],M={},b=0,B=0,O={Sheets:[],WBProps:{date1904:!1}},T={};In.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";o=In.exec(a);)switch(o[3]=(z=o[3]).toLowerCase()){case"data":if(z=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Fw(a.slice(v,o.index),k,g,c[c.length-1][0]=="comment"?te:m,{c:y,r:x},R,ne[y],h,se,t):(k="",g=_r(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ue.length>0&&(m.c=ue),(!t.sheetRows||t.sheetRows>x)&&m.v!==void 0&&(t.dense?(u[x]||(u[x]=[]),u[x][y]=m):u[et(y)+lt(x)]=m),m.HRef&&(m.l={Target:Le(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(b=y+(parseInt(m.MergeAcross,10)|0),B=x+(parseInt(m.MergeDown,10)|0),N.push({s:{c:y,r:x},e:{c:b,r:B}})),!t.sheetStubs)m.MergeAcross?y=b+1:++y;else if(m.MergeAcross||m.MergeDown){for(var ie=y;ie<=b;++ie)for(var ee=x;ee<=B;++ee)(ie>y||ee>x)&&(t.dense?(u[ee]||(u[ee]=[]),u[ee][ie]={t:"z"}):u[et(ie)+lt(ee)]={t:"z"});y=b+1}else++y;else m=Tw(o[0]),m.Index&&(y=+m.Index-1),y<I.s.c&&(I.s.c=y),y>I.e.c&&(I.e.c=y),o[0].slice(-2)==="/>"&&++y,ue=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<I.s.r&&(I.s.r=x),x>I.e.r&&(I.e.r=x),o[0].slice(-2)==="/>"&&(h=_r(o[0]),h.Index&&(x=+h.Index-1)),y=0,++x):(h=_r(o[0]),h.Index&&(x=+h.Index-1),M={},(h.AutoFitHeight=="0"||h.Height)&&(M.hpx=parseInt(h.Height,10),M.hpt=Ln(M.hpx),X[x]=M),h.Hidden=="1"&&(M.hidden=!0,X[x]=M));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));d.push(p),I.s.r<=I.e.r&&I.s.c<=I.e.c&&(u["!ref"]=Ee(I),t.sheetRows&&t.sheetRows<=I.e.r&&(u["!fullref"]=u["!ref"],I.e.r=t.sheetRows-1,u["!ref"]=Ee(I))),N.length&&(u["!merges"]=N),ne.length>0&&(u["!cols"]=ne),X.length>0&&(u["!rows"]=X),f[p]=u}else I={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=y=0,c.push([o[3],!1]),l=_r(o[0]),p=Le(l.Name),u=t.dense?[]:{},N=[],se=[],X=[],T={name:p,Hidden:0},O.Sheets.push(T);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ne=[],xe=!1}break;case"style":o[1]==="/"?Ow(R,P,t):P=_r(o[0]);break;case"numberformat":P.nf=Le(_r(o[0]).Format||"General"),bn[P.nf]&&(P.nf=bn[P.nf]);for(var re=0;re!=392&&ge[re]!=P.nf;++re);if(re==392){for(re=57;re!=392;++re)if(ge[re]==null){Ur(P.nf,re);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Q=_r(o[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!xe&&Q.wpx>10){xe=!0,Rt=V0;for(var K=0;K<ne.length;++K)ne[K]&&ea(ne[K])}xe&&ea(Q),ne[Q.Index-1||ne.length]=Q;for(var we=0;we<+Q.Span;++we)ne[ne.length]=Ke(Q);break;case"namedrange":if(o[1]==="/")break;O.Names||(O.Names=[]);var F=ye(o[0]),Me={Name:F.Name,Ref:ja(F.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(Me.Sheet=O.Sheets.length-1),O.Names.push(Me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=a.slice(D,o.index):D=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;P.Interior=_r(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?tp(U,z,a.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));Iw(te),ue.push(te)}else c.push([o[3],!1]),l=_r(o[0]),te={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Oe=_r(o[0]);u["!autofilter"]={ref:ja(Oe.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return kl(a,t);var Ue=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ue=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ue=!1}break;case"excelworkbook":switch(o[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ue=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ue=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(L,o.index)){case"SheetHidden":T.Hidden=1;break;case"SheetVeryHidden":T.Hidden=2;break}else L=o.index+o[0].length;break;case"header":u["!margins"]||ga(u["!margins"]={},"xlml"),isNaN(+ye(o[0]).Margin)||(u["!margins"].header=+ye(o[0]).Margin);break;case"footer":u["!margins"]||ga(u["!margins"]={},"xlml"),isNaN(+ye(o[0]).Margin)||(u["!margins"].footer=+ye(o[0]).Margin);break;case"pagemargins":var Ce=ye(o[0]);u["!margins"]||ga(u["!margins"]={},"xlml"),isNaN(+Ce.Top)||(u["!margins"].top=+Ce.Top),isNaN(+Ce.Left)||(u["!margins"].left=+Ce.Left),isNaN(+Ce.Right)||(u["!margins"].right=+Ce.Right),isNaN(+Ce.Bottom)||(u["!margins"].bottom=+Ce.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ue=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ue=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ue=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ue=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ue=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ue=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ue=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ue=!1}break;case"smarttags":break;default:Ue=!1;break}if(Ue||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Cw(W,z,J,a.slice(L,o.index)):(J=o,L=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var he={};return!t.bookSheets&&!t.bookProps&&(he.Sheets=f),he.SheetNames=d,he.Workbook=O,he.SSF=Ke(ge),he.Props=U,he.Custprops=W,he}function Us(e,r){switch(Ao(r=r||{}),r.type||"base64"){case"base64":return Ts(ar(e),r);case"binary":case"buffer":case"file":return Ts(e,r);case"array":return Ts(aa(e),r)}}function Pw(e,r){var t=[];return e.Props&&t.push(rp(e.Props,r)),e.Custprops&&t.push(ap(e.Props,e.Custprops,r)),t.join("")}function Rw(){return""}function Nw(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(a,n){var i=[];i.push(oe("NumberFormat",null,{"ss:Format":Ge(ge[a.numFmtId])}));var s={"ss:ID":"s"+(21+n)};t.push(oe("Style",i.join(""),s))}),oe("Styles",t.join(""))}function xf(e){return oe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ko(e.Ref,{r:0,c:0})})}function Dw(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],a=0;a<r.length;++a){var n=r[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||t.push(xf(n)))}return oe("Names",t.join(""))}function Lw(e,r,t,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],s=0;s<n.length;++s){var o=n[s];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||i.push(xf(o)))}return i.join("")}function Bw(e,r,t,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(oe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(oe("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(oe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t])if(a.Workbook.Sheets[t].Hidden)n.push(oe("Visible",a.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==t&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Ot("ProtectContents","True")),e["!protect"].objects&&n.push(Ot("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Ot("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Ot("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Ot("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&n.push("<"+s[1]+"/>")})),n.length==0?"":oe("WorksheetOptions",n.join(""),{xmlns:er.x})}function Mw(e){return e.map(function(r){var t=nh(r.t||""),a=oe("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return oe("Comment",a,{"ss:Author":r.a})}).join("")}function Uw(e,r,t,a,n,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ge(ko(e.f,s))),e.F&&e.F.slice(0,r.length)==r){var c=tt(e.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ge(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ge(e.l.Tooltip))),t["!merges"])for(var l=t["!merges"],f=0;f!=l.length;++f)l[f].s.c!=s.c||l[f].s.r!=s.r||(l[f].e.c>l[f].s.c&&(o["ss:MergeAcross"]=l[f].e.c-l[f].s.c),l[f].e.r>l[f].s.r&&(o["ss:MergeDown"]=l[f].e.r-l[f].s.r));var d="",u="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":d="Number",u=String(e.v);break;case"b":d="Boolean",u=e.v?"1":"0";break;case"e":d="Error",u=Wr[e.v];break;case"d":d="DateTime",u=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ge[14]);break;case"s":d="String",u=ah(e.v||"");break}var p=ia(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=s.c+1;var m=e.v!=null?u:"",h=e.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(h+=Mw(e.c)),oe("Cell",h,o)}function $w(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=za(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function jw(e,r,t,a){if(!e["!ref"])return"";var n=Be(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,v){ea(g);var y=!!g.width,x=Vi(v,g),I={"ss:Index":v+1};y&&(I["ss:Width"]=Nn(x.width)),g.hidden&&(I["ss:Hidden"]="1"),o.push(oe("Column",null,I))});for(var c=Array.isArray(e),l=n.s.r;l<=n.e.r;++l){for(var f=[$w(l,(e["!rows"]||[])[l])],d=n.s.c;d<=n.e.c;++d){var u=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>d)&&!(i[s].s.r>l)&&!(i[s].e.c<d)&&!(i[s].e.r<l)){(i[s].s.c!=d||i[s].s.r!=l)&&(u=!0);break}if(!u){var p={r:l,c:d},m=ve(p),h=c?(e[l]||[])[d]:e[m];f.push(Uw(h,m,e,r,t,a,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function Hw(e,r,t){var a=[],n=t.SheetNames[e],i=t.Sheets[n],s=i?Lw(i,r,e,t):"";return s.length>0&&a.push("<Names>"+s+"</Names>"),s=i?jw(i,r,e,t):"",s.length>0&&a.push("<Table>"+s+"</Table>"),a.push(Bw(i,r,e,t)),a.join("")}function Vw(e,r){r||(r={}),e.SSF||(e.SSF=Ke(ge)),e.SSF&&(Ya(),Di(e.SSF),r.revssf=Bi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],ia(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Pw(e,r)),t.push(Rw(e,r)),t.push(""),t.push("");for(var a=0;a<e.SheetNames.length;++a)t.push(oe("Worksheet",Hw(a,r,e),{"ss:Name":Ge(e.SheetNames[a])}));return t[2]=Nw(e,r),t[3]=Dw(e,r),ft+oe("Workbook",t.join(""),{xmlns:er.ss,"xmlns:o":er.o,"xmlns:x":er.x,"xmlns:ss":er.ss,"xmlns:dt":er.dt,"xmlns:html":er.html})}function Ww(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Dh(t),t.length-t.l<=4)return r;var a=t.read_shift(4);if(a==0||a>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(a=t.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=Lh(t),a=t.read_shift(4),a==0||a>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var Gw=[60,1084,2066,2165,2175];function zw(e,r,t,a,n){var i=a,s=[],o=t.slice(t.l,t.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}s.push(o),t.l+=i;for(var c=Br(t,t.l),l=$s[c],f=0;l!=null&&Gw.indexOf(c)>-1;)i=Br(t,t.l+2),f=t.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=t.slice(f,t.l+4+i),s.push(o),t.l+=4+i,l=$s[c=Br(t,t.l)];var d=Et(s);At(d,0);var u=0;d.lens=[];for(var p=0;p<s.length;++p)d.lens.push(u),u+=s[p].length;if(d.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+a;return r.f(d,d.length,n)}function Cr(e,r,t){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=ge[a])}catch(i){if(r.WTF)throw i}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Wr[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=An(e.v):e.w=xa(e.v):e.w=pr(a,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&a&&e.t=="n"&&Xa(ge[a]||String(a))){var n=da(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function yi(e,r,t){return{v:e,ixfe:r,t}}function Xw(e,r){var t={opts:{}},a={};it!=null&&r.dense==null&&(r.dense=it);var n=r.dense?[]:{},i={},s={},o=null,c=[],l="",f={},d,u="",p,m,h,g,v={},y=[],x,I,R=[],P=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},N=function(Ie){return Ie<8?ha[Ie]:Ie<64&&P[Ie-8]||ha[Ie]},U=function(Ie,ot,sr){var gt=ot.XF.data;if(!(!gt||!gt.patternType||!sr||!sr.cellStyles)){ot.s={},ot.s.patternType=gt.patternType;var la;(la=Rn(N(gt.icvFore)))&&(ot.s.fgColor={rgb:la}),(la=Rn(N(gt.icvBack)))&&(ot.s.bgColor={rgb:la})}},W=function(Ie,ot,sr){if(!(M>1)&&!(sr.sheetRows&&Ie.r>=sr.sheetRows)){if(sr.cellStyles&&ot.XF&&ot.XF.data&&U(Ie,ot,sr),delete ot.ixfe,delete ot.XF,d=Ie,u=ve(Ie),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ie.r<s.s.r&&(s.s.r=Ie.r),Ie.c<s.s.c&&(s.s.c=Ie.c),Ie.r+1>s.e.r&&(s.e.r=Ie.r+1),Ie.c+1>s.e.c&&(s.e.c=Ie.c+1),sr.cellFormula&&ot.f){for(var gt=0;gt<y.length;++gt)if(!(y[gt][0].s.c>Ie.c||y[gt][0].s.r>Ie.r)&&!(y[gt][0].e.c<Ie.c||y[gt][0].e.r<Ie.r)){ot.F=Ee(y[gt][0]),(y[gt][0].s.c!=Ie.c||y[gt][0].s.r!=Ie.r)&&delete ot.f,ot.f&&(ot.f=""+Pt(y[gt][1],s,Ie,se,L));break}}sr.dense?(n[Ie.r]||(n[Ie.r]=[]),n[Ie.r][Ie.c]=ot):n[u]=ot}},L={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(L.password=r.password);var J,ue=[],te=[],ne=[],Q=[],xe=!1,se=[];se.SheetNames=L.snames,se.sharedf=L.sharedf,se.arrayf=L.arrayf,se.names=[],se.XTI=[];var X=0,M=0,b=0,B=[],O=[],T;L.codepage=1200,kr(1200);for(var z=!1;e.l<e.length-1;){var ie=e.l,ee=e.read_shift(2);if(ee===0&&X===10)break;var re=e.l===e.length?0:e.read_shift(2),K=$s[ee];if(K&&K.f){if(r.bookSheets&&X===133&&ee!==133)break;if(X=ee,K.r===2||K.r==12){var we=e.read_shift(2);if(re-=2,!L.enc&&we!==ee&&((we&255)<<8|we>>8)!==ee)throw new Error("rt mismatch: "+we+"!="+ee);K.r==12&&(e.l+=10,re-=10)}var F={};if(ee===10?F=K.f(e,re,L):F=zw(ee,K,e,re,L),M==0&&[9,521,1033,2057].indexOf(X)===-1)continue;switch(ee){case 34:t.opts.Date1904=k.WBProps.date1904=F;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=F,!r.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=F;break;case 66:var Me=Number(F);switch(Me){case 21010:Me=1200;break;case 32768:Me=1e4;break;case 32769:Me=1252;break}kr(L.codepage=Me),z=!0;break;case 317:L.rrtabid=F;break;case 25:L.winlocked=F;break;case 439:t.opts.RefreshAll=F;break;case 12:t.opts.CalcCount=F;break;case 16:t.opts.CalcDelta=F;break;case 17:t.opts.CalcIter=F;break;case 13:t.opts.CalcMode=F;break;case 14:t.opts.CalcPrecision=F;break;case 95:t.opts.CalcSaveRecalc=F;break;case 15:L.CalcRefMode=F;break;case 2211:t.opts.FullCalc=F;break;case 129:F.fDialog&&(n["!type"]="dialog"),F.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),F.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:R.push(F);break;case 430:se.push([F]),se[se.length-1].XTI=[];break;case 35:case 547:se[se.length-1].push(F);break;case 24:case 536:T={Name:F.Name,Ref:Pt(F.rgce,s,null,se,L)},F.itab>0&&(T.Sheet=F.itab-1),se.names.push(T),se[0]||(se[0]=[],se[0].XTI=[]),se[se.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(O[F.itab-1]={ref:Ee(F.rgce[0][0][1][2])});break;case 22:L.ExternCount=F;break;case 23:se.length==0&&(se[0]=[],se[0].XTI=[]),se[se.length-1].XTI=se[se.length-1].XTI.concat(F),se.XTI=se.XTI.concat(F);break;case 2196:if(L.biff<8)break;T!=null&&(T.Comment=F[1]);break;case 18:n["!protect"]=F;break;case 19:F!==0&&L.WTF&&console.error("Password verifier: "+F);break;case 133:i[F.pos]=F,L.snames.push(F.name);break;case 10:{if(--M)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,n["!ref"]=Ee(s),r.sheetRows&&r.sheetRows<=s.e.r){var Oe=s.e.r;s.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Ee(s),s.e.r=Oe}s.e.r++,s.e.c++}ue.length>0&&(n["!merges"]=ue),te.length>0&&(n["!objects"]=te),ne.length>0&&(n["!cols"]=ne),Q.length>0&&(n["!rows"]=Q),k.Sheets.push(D)}l===""?f=n:a[l]=n,n=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),L.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(L.biff=5,z=!0,kr(L.codepage=28591)),L.biff==8&&F.BIFFVer==0&&F.dt==16&&(L.biff=2),M++)break;if(n=r.dense?[]:{},L.biff<8&&!z&&(z=!0,kr(L.codepage=r.codepage||1252)),L.biff<5||F.BIFFVer==0&&F.dt==4096){l===""&&(l="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ue={pos:e.l-re,name:l};i[Ue.pos]=Ue,L.snames.push(l)}else l=(i[ie]||{name:""}).name;F.dt==32&&(n["!type"]="chart"),F.dt==64&&(n["!type"]="macro"),ue=[],te=[],L.arrayf=y=[],ne=[],Q=[],xe=!1,D={Hidden:(i[ie]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(r.dense?(n[F.r]||[])[F.c]:n[ve({c:F.c,r:F.r})])&&++F.c,x={ixfe:F.ixfe,XF:R[F.ixfe]||{},v:F.val,t:"n"},b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W({c:F.c,r:F.r},x,r);break;case 5:case 517:x={ixfe:F.ixfe,XF:R[F.ixfe],v:F.val,t:F.t},b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W({c:F.c,r:F.r},x,r);break;case 638:x={ixfe:F.ixfe,XF:R[F.ixfe],v:F.rknum,t:"n"},b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W({c:F.c,r:F.r},x,r);break;case 189:for(var Ce=F.c;Ce<=F.C;++Ce){var he=F.rkrec[Ce-F.c][0];x={ixfe:he,XF:R[he],v:F.rkrec[Ce-F.c][1],t:"n"},b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W({c:Ce,r:F.r},x,r)}break;case 6:case 518:case 1030:{if(F.val=="String"){o=F;break}if(x=yi(F.val,F.cell.ixfe,F.tt),x.XF=R[x.ixfe],r.cellFormula){var Ze=F.formula;if(Ze&&Ze[0]&&Ze[0][0]&&Ze[0][0][0]=="PtgExp"){var jt=Ze[0][0][1][0],Jt=Ze[0][0][1][1],ir=ve({r:jt,c:Jt});v[ir]?x.f=""+Pt(F.formula,s,F.cell,se,L):x.F=((r.dense?(n[jt]||[])[Jt]:n[ir])||{}).F}else x.f=""+Pt(F.formula,s,F.cell,se,L)}b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W(F.cell,x,r),o=F}break;case 7:case 519:if(o)o.val=F,x=yi(F,o.cell.ixfe,"s"),x.XF=R[x.ixfe],r.cellFormula&&(x.f=""+Pt(o.formula,s,o.cell,se,L)),b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W(o.cell,x,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(F);var on=ve(F[0].s);if(p=r.dense?(n[F[0].s.r]||[])[F[0].s.c]:n[on],r.cellFormula&&p){if(!o||!on||!p)break;p.f=""+Pt(F[1],s,F[0],se,L),p.F=Ee(F[0])}}break;case 1212:{if(!r.cellFormula)break;if(u){if(!o)break;v[ve(o.cell)]=F[0],p=r.dense?(n[o.cell.r]||[])[o.cell.c]:n[ve(o.cell)],(p||{}).f=""+Pt(F[0],s,d,se,L)}}break;case 253:x=yi(c[F.isst].t,F.ixfe,"s"),c[F.isst].h&&(x.h=c[F.isst].h),x.XF=R[x.ixfe],b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W({c:F.c,r:F.r},x,r);break;case 513:r.sheetStubs&&(x={ixfe:F.ixfe,XF:R[F.ixfe],t:"z"},b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W({c:F.c,r:F.r},x,r));break;case 190:if(r.sheetStubs)for(var Xr=F.c;Xr<=F.C;++Xr){var Zt=F.ixfe[Xr-F.c];x={ixfe:Zt,XF:R[Zt],t:"z"},b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W({c:Xr,r:F.r},x,r)}break;case 214:case 516:case 4:x=yi(F.val,F.ixfe,"s"),x.XF=R[x.ixfe],b>0&&(x.z=B[x.ixfe>>8&63]),Cr(x,r,t.opts.Date1904),W({c:F.c,r:F.r},x,r);break;case 0:case 512:M===1&&(s=F);break;case 252:c=F;break;case 1054:if(L.biff==4){B[b++]=F[1];for(var Dr=0;Dr<b+163&&ge[Dr]!=F[1];++Dr);Dr>=163&&Ur(F[1],b+163)}else Ur(F[1],F[0]);break;case 30:{B[b++]=F;for(var Yr=0;Yr<b+163&&ge[Yr]!=F;++Yr);Yr>=163&&Ur(F,b+163)}break;case 229:ue=ue.concat(F);break;case 93:te[F.cmo[0]]=L.lastobj=F;break;case 438:L.lastobj.TxO=F;break;case 127:L.lastobj.ImData=F;break;case 440:for(g=F[0].s.r;g<=F[0].e.r;++g)for(h=F[0].s.c;h<=F[0].e.c;++h)p=r.dense?(n[g]||[])[h]:n[ve({c:h,r:g})],p&&(p.l=F[1]);break;case 2048:for(g=F[0].s.r;g<=F[0].e.r;++g)for(h=F[0].s.c;h<=F[0].e.c;++h)p=r.dense?(n[g]||[])[h]:n[ve({c:h,r:g})],p&&p.l&&(p.l.Tooltip=F[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;p=r.dense?(n[F[0].r]||[])[F[0].c]:n[ve(F[0])];var cn=te[F[2]];p||(r.dense?(n[F[0].r]||(n[F[0].r]=[]),p=n[F[0].r][F[0].c]={t:"z"}):p=n[ve(F[0])]={t:"z"},s.e.r=Math.max(s.e.r,F[0].r),s.s.r=Math.min(s.s.r,F[0].r),s.e.c=Math.max(s.e.c,F[0].c),s.s.c=Math.min(s.s.c,F[0].c)),p.c||(p.c=[]),m={a:F[1],t:cn.TxO.t},p.c.push(m)}break;case 2173:Ng(R[F.ixfe],F.ext);break;case 125:{if(!L.cellStyles)break;for(;F.e>=F.s;)ne[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},xe||(xe=!0,yo(F.w/256)),ea(ne[F.e+1])}break;case 520:{var Ht={};F.level!=null&&(Q[F.r]=Ht,Ht.level=F.level),F.hidden&&(Q[F.r]=Ht,Ht.hidden=!0),F.hpt&&(Q[F.r]=Ht,Ht.hpt=F.hpt,Ht.hpx=za(F.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||ga(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ee]]=F;break;case 161:n["!margins"]||ga(n["!margins"]={}),n["!margins"].header=F.header,n["!margins"].footer=F.footer;break;case 574:F.RTL&&(k.Views[0].RTL=!0);break;case 146:P=F;break;case 2198:J=F;break;case 140:I=F;break;case 442:l?D.CodeName=F||D.name:k.WBProps.CodeName=F||"ThisWorkbook";break}}else K||console.error("Missing Info for XLS Record 0x"+ee.toString(16)),e.l+=re}return t.SheetNames=st(i).sort(function(Sr,Ie){return Number(Sr)-Number(Ie)}).map(function(Sr){return i[Sr].name}),r.bookSheets||(t.Sheets=a),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&O.forEach(function(Sr,Ie){t.Sheets[t.SheetNames[Ie]]["!autofilter"]=Sr}),t.Strings=c,t.SSF=Ke(ge),L.enc&&(t.Encryption=L.enc),J&&(t.Themes=J),t.Metadata={},I!==void 0&&(t.Metadata.Country=I),se.names.length>0&&(k.Names=se.names),t.Workbook=k,t}var Tn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Yw(e,r,t){var a=me.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Zc(a,Rs,Tn.DSI);for(var i in n)r[i]=n[i]}catch(l){if(t.WTF)throw l}var s=me.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=Zc(s,Ns,Tn.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(m0(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function qw(e,r){var t=[],a=[],n=[],i=0,s,o=Ac(Rs,"n"),c=Ac(Ns,"n");if(e.Props)for(s=st(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(c,s[i])?a:n).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=st(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(c,s[i])?a:n).push([s[i],e.Custprops[s[i]]]);var l=[];for(i=0;i<n.length;++i)k0.indexOf(n[i][0])>-1||p0.indexOf(n[i][0])>-1||n[i][1]!=null&&l.push(n[i]);a.length&&me.utils.cfb_add(r,"/SummaryInformation",Qc(a,Tn.SI,c,Ns)),(t.length||l.length)&&me.utils.cfb_add(r,"/DocumentSummaryInformation",Qc(t,Tn.DSI,o,Rs,l.length?l:null,Tn.UDI))}function vf(e,r){r||(r={}),Ao(r),Ws(),r.codepage&&Vs(r.codepage);var t,a;if(e.FullPaths){if(me.find(e,"/encryption"))throw new Error("File is password-protected");t=me.find(e,"!CompObj"),a=me.find(e,"/Workbook")||me.find(e,"/Book")}else{switch(r.type){case"base64":e=tr(ar(e));break;case"binary":e=tr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}At(e,0),a={content:e}}var n,i;if(t&&Ww(t),r.bookProps&&!r.bookSheets)n={};else{var s=Fe?"buffer":"array";if(a&&a.content)n=Xw(a.content,r);else if((i=me.find(e,"PerfectOffice_MAIN"))&&i.content)n=ma.to_workbook(i.content,(r.type=s,r));else if((i=me.find(e,"NativeContent_MAIN"))&&i.content)n=ma.to_workbook(i.content,(r.type=s,r));else throw(i=me.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&me.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=cx(e))}var o={};return e.FullPaths&&Yw(e,o,r),n.Props=n.Custprops=o,r.bookFiles&&(n.cfb=e),n}function Kw(e,r){var t=r||{},a=me.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return me.utils.cfb_add(a,n,yf(e,t)),t.biff==8&&(e.Props||e.Custprops)&&qw(e,a),t.biff==8&&e.vbaraw&&lx(a,me.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Bn={0:{f:w2},1:{f:A2},2:{f:X2},3:{f:L2},4:{f:P2},5:{f:W2},6:{f:Z2},7:{f:$2},8:{f:iy},9:{f:ny},10:{f:ry},11:{f:ay},12:{f:F2},13:{f:q2},14:{f:M2},15:{f:N2},16:{f:ff},17:{f:ey},18:{f:H2},19:{f:co},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ew},40:{},42:{},43:{f:Zm},44:{f:Km},45:{f:tg},46:{f:ag},47:{f:rg},48:{},49:{f:Eh},50:{},51:{f:Bg},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R0},62:{f:J2},63:{f:zg},64:{f:_y},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Bt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:xy},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:S2},148:{f:E2,p:16},151:{f:uy},152:{},153:{f:Jy},154:{},155:{},156:{f:qy},157:{},158:{},159:{T:1,f:hm},160:{T:-1},161:{T:1,f:Ca},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:sy},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Dg},336:{T:-1},337:{f:$g,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ps},357:{},358:{},359:{},360:{T:1},361:{},362:{f:P0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:dy},427:{f:hy},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:my},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:T2},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ly},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ps},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ax},633:{T:1},634:{T:-1},635:{T:1,f:tx},636:{T:-1},637:{f:Ch},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:My},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:ky},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},$s={6:{f:Es},10:{f:Kr},12:{f:mt},13:{f:mt},14:{f:ct},15:{f:ct},16:{f:Nt},17:{f:ct},18:{f:ct},19:{f:mt},20:{f:il},21:{f:il},23:{f:P0},24:{f:ol},25:{f:ct},26:{},27:{},28:{f:k1},29:{},34:{f:ct},35:{f:sl},38:{f:Nt},39:{f:Nt},40:{f:Nt},41:{f:Nt},42:{f:ct},43:{f:ct},47:{f:Nm},49:{f:qp},51:{f:mt},60:{},61:{f:Wp},64:{f:ct},65:{f:Yp},66:{f:mt},77:{},80:{},81:{},82:{},85:{f:mt},89:{},90:{},91:{},92:{f:Rp},93:{f:T1},94:{},95:{f:ct},96:{},97:{},99:{f:ct},125:{f:R0},128:{f:f1},129:{f:Dp},130:{f:mt},131:{f:ct},132:{f:ct},133:{f:Lp},134:{},140:{f:R1},141:{f:mt},144:{},146:{f:L1},151:{},152:{},153:{},154:{},155:{},156:{f:mt},157:{},158:{},160:{f:V1},161:{f:U1},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:s1},190:{f:o1},193:{f:Kr},197:{},198:{},199:{},200:{},201:{},202:{f:ct},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mt},220:{},221:{f:ct},222:{},224:{f:l1},225:{f:Pp},226:{f:Kr},227:{},229:{f:E1},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Mp},253:{f:Jp},255:{f:$p},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:E0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ct},353:{f:Kr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:m1},431:{f:ct},432:{},433:{},434:{},437:{},438:{f:A1},439:{f:ct},440:{f:O1},441:{},442:{f:Hn},443:{},444:{f:mt},445:{},446:{},448:{f:Kr},449:{f:Vp,r:2},450:{f:Kr},512:{f:rl},513:{f:H1},515:{f:h1},516:{f:Qp},517:{f:nl},519:{f:W1},520:{f:jp},523:{},545:{f:cl},549:{f:tl},566:{},574:{f:zp},638:{f:i1},659:{},1048:{},1054:{f:t1},1084:{},1212:{f:y1},2048:{f:I1},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:gi},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Kr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:B1,r:12},2173:{f:Rg,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ct,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:v1,r:12},2197:{},2198:{f:Cg,r:12},2199:{},2200:{},2201:{},2202:{f:w1,r:12},2203:{f:Kr},2204:{},2205:{},2206:{},2207:{},2211:{f:Hp},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:$1},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:D1},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:rl},1:{},2:{f:q1},3:{f:X1},4:{f:z1},5:{f:nl},7:{f:J1},8:{},9:{f:gi},11:{},22:{f:mt},30:{f:a1},31:{},32:{},33:{f:cl},36:{},37:{f:tl},50:{f:Z1},62:{},52:{},67:{},68:{f:mt},69:{},86:{},126:{},127:{f:G1},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Q1},223:{},234:{},354:{},421:{},518:{f:Es},521:{f:gi},536:{f:ol},547:{f:sl},561:{},579:{},1030:{f:Es},1033:{f:gi},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ce(e,r,t,a){var n=r;if(!isNaN(n)){var i=a||(t||[]).length||0,s=e.next(4);s.write_shift(2,n),s.write_shift(2,i),i>0&&io(t)&&e.push(t)}}function Jw(e,r,t,a){var n=a||(t||[]).length||0;if(n<=8224)return ce(e,r,t,n);var i=r;if(!isNaN(i)){for(var s=t.parts||[],o=0,c=0,l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,l),e.push(t.slice(c,c+l)),c+=l;c<n;){for(f=e.next(4),f.write_shift(2,60),l=0;l+(s[o]||8224)<=8224;)l+=s[o]||8224,o++;f.write_shift(2,l),e.push(t.slice(c,c+l)),c+=l}}}function zn(e,r,t){return e||(e=Y(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function Zw(e,r,t,a){var n=Y(9);return zn(n,e,r),b0(t,a||"b",n),n}function Qw(e,r,t){var a=Y(8+2*t.length);return zn(a,e,r),a.write_shift(1,t.length),a.write_shift(t.length,t,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function e_(e,r,t,a){if(r.v!=null)switch(r.t){case"d":case"n":var n=r.t=="d"?yt(qe(r.v)):r.v;n==(n|0)&&n>=0&&n<65536?ce(e,2,K1(t,a,n)):ce(e,3,Y1(t,a,n));return;case"b":case"e":ce(e,5,Zw(t,a,r.v,r.t));return;case"s":case"str":ce(e,4,Qw(t,a,(r.v||"").slice(0,255)));return}ce(e,1,zn(null,t,a))}function t_(e,r,t,a){var n=Array.isArray(r),i=Be(r["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Ee(i)}for(var l=i.s.r;l<=i.e.r;++l){o=lt(l);for(var f=i.s.c;f<=i.e.c;++f){l===i.s.r&&(c[f]=et(f)),s=c[f]+o;var d=n?(r[l]||[])[f]:r[s];d&&e_(e,d,l,f,a)}}}function r_(e,r){var t=r||{};it!=null&&t.dense==null&&(t.dense=it);for(var a=qt(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(n=i);if(n==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return ce(a,t.biff==4?1033:t.biff==3?521:9,go(e,16,t)),t_(a,e.Sheets[e.SheetNames[n]],n,t,e),ce(a,10),a.end()}function a_(e,r,t){ce(e,49,Kp({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function n_(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)r[n]!=null&&ce(e,1054,r1(n,r[n],t))})}function i_(e,r){var t=Y(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),ce(e,2151,t),t=Y(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),O0(Be(r["!ref"]||"A1"),t),t.write_shift(4,4),ce(e,2152,t)}function s_(e,r){for(var t=0;t<16;++t)ce(e,224,al({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(a){ce(e,224,al(a,0,r))})}function o_(e,r){for(var t=0;t<r["!links"].length;++t){var a=r["!links"][t];ce(e,440,F1(a)),a[1].Tooltip&&ce(e,2048,P1(a))}delete r["!links"]}function c_(e,r){if(r){var t=0;r.forEach(function(a,n){++t<=256&&a&&ce(e,125,M1(Vi(n,a),n))})}}function l_(e,r,t,a,n){var i=16+ia(n.cellXfs,r,n);if(r.v==null&&!r.bf){ce(e,513,_a(t,a,i));return}if(r.bf)ce(e,6,Dv(r,t,a,n,i));else switch(r.t){case"d":case"n":var s=r.t=="d"?yt(qe(r.v)):r.v;ce(e,515,p1(t,a,s,i,n));break;case"b":case"e":ce(e,517,d1(t,a,r.v,i,n,r.t));break;case"s":case"str":if(n.bookSST){var o=bo(n.Strings,r.v,n.revStrings);ce(e,253,Zp(t,a,o,i,n))}else ce(e,516,e1(t,a,(r.v||"").slice(0,255),i,n));break;default:ce(e,513,_a(t,a,i))}}function f_(e,r,t){var a=qt(),n=t.SheetNames[e],i=t.Sheets[n]||{},s=(t||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),l=r.biff==8,f,d="",u=[],p=Be(i["!ref"]||"A1"),m=l?65536:16384;if(p.e.c>255||p.e.r>=m){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}ce(a,2057,go(t,16,r)),ce(a,13,dr(1)),ce(a,12,dr(100)),ce(a,15,Gt(!0)),ce(a,17,Gt(!1)),ce(a,16,ya(.001)),ce(a,95,Gt(!0)),ce(a,42,Gt(!1)),ce(a,43,Gt(!1)),ce(a,130,dr(1)),ce(a,128,u1([0,0])),ce(a,131,Gt(!1)),ce(a,132,Gt(!1)),l&&c_(a,i["!cols"]),ce(a,512,n1(p,r)),l&&(i["!links"]=[]);for(var h=p.s.r;h<=p.e.r;++h){d=lt(h);for(var g=p.s.c;g<=p.e.c;++g){h===p.s.r&&(u[g]=et(g)),f=u[g]+d;var v=c?(i[h]||[])[g]:i[f];v&&(l_(a,v,h,g,r),l&&v.l&&i["!links"].push([f,v.l]))}}var y=o.CodeName||o.name||n;return l&&ce(a,574,Xp((s.Views||[])[0])),l&&(i["!merges"]||[]).length&&ce(a,229,b1(i["!merges"])),l&&o_(a,i),ce(a,442,T0(y,r)),l&&i_(a,i),ce(a,10),a.end()}function u_(e,r,t){var a=qt(),n=(e||{}).Workbook||{},i=n.Sheets||[],s=n.WBProps||{},o=t.biff==8,c=t.biff==5;if(ce(a,2057,go(e,5,t)),t.bookType=="xla"&&ce(a,135),ce(a,225,o?dr(1200):null),ce(a,193,dp(2)),c&&ce(a,191),c&&ce(a,192),ce(a,226),ce(a,92,Np("SheetJS",t)),ce(a,66,dr(o?1200:1252)),o&&ce(a,353,dr(0)),o&&ce(a,448),ce(a,317,j1(e.SheetNames.length)),o&&e.vbaraw&&ce(a,211),o&&e.vbaraw){var l=s.CodeName||"ThisWorkbook";ce(a,442,T0(l,t))}ce(a,156,dr(17)),ce(a,25,Gt(!1)),ce(a,18,Gt(!1)),ce(a,19,dr(0)),o&&ce(a,431,Gt(!1)),o&&ce(a,444,dr(0)),ce(a,61,Gp(t)),ce(a,64,Gt(!1)),ce(a,141,dr(0)),ce(a,34,Gt(Vy(e)=="true")),ce(a,14,Gt(!0)),o&&ce(a,439,Gt(!1)),ce(a,218,dr(0)),a_(a,e,t),n_(a,e.SSF,t),s_(a,t),o&&ce(a,352,Gt(!1));var f=a.end(),d=qt();o&&ce(d,140,N1()),o&&t.Strings&&Jw(d,252,Up(t.Strings,t)),ce(d,10);var u=d.end(),p=qt(),m=0,h=0;for(h=0;h<e.SheetNames.length;++h)m+=(o?12:11)+(o?2:1)*e.SheetNames[h].length;var g=f.length+m+u.length;for(h=0;h<e.SheetNames.length;++h){var v=i[h]||{};ce(p,133,Bp({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[h]},t)),g+=r[h].length}var y=p.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var x=[];return f.length&&x.push(f),y.length&&x.push(y),u.length&&x.push(u),Et(x)}function d_(e,r){var t=r||{},a=[];e&&!e.SSF&&(e.SSF=Ke(ge)),e&&e.SSF&&(Ya(),Di(e.SSF),t.revssf=Bi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Oo(t),t.cellXfs=[],ia(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=f_(n,t,e);return a.unshift(u_(e,a,t)),Et(a)}function yf(e,r){for(var t=0;t<=e.SheetNames.length;++t){var a=e.Sheets[e.SheetNames[t]];if(!(!a||!a["!ref"])){var n=Kt(a["!ref"]);n.e.c>255&&typeof console!="undefined"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return d_(e,r);case 4:case 3:case 2:return r_(e,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function vl(e,r){var t=r||{};it!=null&&t.dense==null&&(t.dense=it);var a=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=n.index,o=i&&i.index||e.length,c=Kd(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,d=0,u=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<c.length;++s){var h=c[s].trim(),g=h.slice(0,3).toLowerCase();if(g=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var v=h.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var x=y,I=0;x.charAt(0)=="<"&&(I=x.indexOf(">"))>-1;)x=x.slice(I+1);for(var R=0;R<m.length;++R){var P=m[R];P.s.c==f&&P.s.r<l&&l<=P.e.r&&(f=P.e.c+1,R=-1)}var k=ye(y.slice(0,y.indexOf(">")));u=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||u>1)&&m.push({s:{r:l,c:f},e:{r:l+(d||1)-1,c:f+u-1}});var D=k.t||k["data-t"]||"";if(!x.length){f+=u;continue}if(x=Xl(x),p.s.r>l&&(p.s.r=l),p.e.r<l&&(p.e.r=l),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!x.length){f+=u;continue}var N={t:"s",v:x};t.raw||!x.trim().length||D=="s"||(x==="TRUE"?N={t:"b",v:!0}:x==="FALSE"?N={t:"b",v:!1}:isNaN(br(x))?isNaN(Wa(x).getDate())||(N={t:"d",v:qe(x)},t.cellDates||(N={t:"n",v:yt(N.v)}),N.z=t.dateNF||ge[14]):N={t:"n",v:br(x)}),t.dense?(a[l]||(a[l]=[]),a[l][f]=N):a[ve({r:l,c:f})]=N,f+=u}}}}return a["!ref"]=Ee(p),m.length&&(a["!merges"]=m),a}function h_(e,r,t,a){for(var n=e["!merges"]||[],i=[],s=r.s.c;s<=r.e.c;++s){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>t||n[l].s.c>s)&&!(n[l].e.r<t||n[l].e.c<s)){if(n[l].s.r<t||n[l].s.c<s){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var f=ve({r:t,c:s}),d=a.dense?(e[t]||[])[s]:e[f],u=d&&d.v!=null&&(d.h||Zs(d.w||(jr(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),a.editable?u='<span contenteditable="true">'+u+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+d.l.Target+'">'+u+"</a>")),p.id=(a.id||"sjs")+"-"+f,i.push(oe("td",u,p))}}var m="<tr>";return m+i.join("")+"</tr>"}var p_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',m_="</body></html>";function g_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return na(vl(t[0],r),r);var a=Ro();return t.forEach(function(n,i){No(a,vl(n,r),"Sheet"+(i+1))}),a}function x_(e,r,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function wf(e,r){var t=r||{},a=t.header!=null?t.header:p_,n=t.footer!=null?t.footer:m_,i=[a],s=Kt(e["!ref"]);t.dense=Array.isArray(e),i.push(x_(e,s,t));for(var o=s.s.r;o<=s.e.r;++o)i.push(h_(e,s,o,t));return i.push("</table>"+n),i.join("")}function _f(e,r,t){var a=t||{};it!=null&&(a.dense=it);var n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var s=typeof a.origin=="string"?tt(a.origin):a.origin;n=s.r,i=s.c}var o=r.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var f=Kt(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),n==-1&&(l.e.r=n=f.e.r+1)}var d=[],u=0,p=e["!rows"]||(e["!rows"]=[]),m=0,h=0,g=0,v=0,y=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&h<c;++m){var I=o[m];if(yl(I)){if(a.display)continue;p[h]={hidden:!0}}var R=I.children;for(g=v=0;g<R.length;++g){var P=R[g];if(!(a.display&&yl(P))){var k=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):Xl(P.innerHTML),D=P.getAttribute("data-z")||P.getAttribute("z");for(u=0;u<d.length;++u){var N=d[u];N.s.c==v+i&&N.s.r<h+n&&h+n<=N.e.r&&(v=N.e.c+1-i,u=-1)}x=+P.getAttribute("colspan")||1,((y=+P.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:h+n,c:v+i},e:{r:h+n+(y||1)-1,c:v+i+(x||1)-1}});var U={t:"s",v:k},W=P.getAttribute("data-t")||P.getAttribute("t")||"";k!=null&&(k.length==0?U.t=W||"z":a.raw||k.trim().length==0||W=="s"||(k==="TRUE"?U={t:"b",v:!0}:k==="FALSE"?U={t:"b",v:!1}:isNaN(br(k))?isNaN(Wa(k).getDate())||(U={t:"d",v:qe(k)},a.cellDates||(U={t:"n",v:yt(U.v)}),U.z=a.dateNF||ge[14]):U={t:"n",v:br(k)})),U.z===void 0&&D!=null&&(U.z=D);var L="",J=P.getElementsByTagName("A");if(J&&J.length)for(var ue=0;ue<J.length&&!(J[ue].hasAttribute("href")&&(L=J[ue].getAttribute("href"),L.charAt(0)!="#"));++ue);L&&L.charAt(0)!="#"&&(U.l={Target:L}),a.dense?(e[h+n]||(e[h+n]=[]),e[h+n][v+i]=U):e[ve({c:v+i,r:h+n})]=U,l.e.c<v+i&&(l.e.c=v+i),v+=x}}++h}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),l.e.r=Math.max(l.e.r,h-1+n),e["!ref"]=Ee(l),h>=c&&(e["!fullref"]=Ee((l.e.r=o.length-m+h-1+n,l))),e}function kf(e,r){var t=r||{},a=t.dense?[]:{};return _f(a,e,r)}function v_(e,r){return na(kf(e,r),r)}function yl(e){var r="",t=y_(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function y_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function w_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Le(r.replace(/<[^>]*>/g,""));return[t]}var wl={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ef(e,r){var t=r||{};it!=null&&t.dense==null&&(t.dense=it);var a=Qs(e),n=[],i,s,o={name:""},c="",l=0,f,d,u={},p=[],m=t.dense?[]:{},h,g,v={value:""},y="",x=0,I,R=[],P=-1,k=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,U={},W=[],L={},J=0,ue=0,te=[],ne=1,Q=1,xe=[],se={Names:[]},X={},M=["",""],b=[],B={},O="",T=0,z=!1,ie=!1,ee=0;for(In.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");h=In.exec(a);)switch(h[3]=h[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":h[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?m["!ref"]=Ee(D):m["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=D.e.r&&(m["!fullref"]=m["!ref"],D.e.r=t.sheetRows-1,m["!ref"]=Ee(D)),W.length&&(m["!merges"]=W),te.length&&(m["!rows"]=te),f.name=f.\u540D\u79F0||f.name,typeof JSON!="undefined"&&JSON.stringify(f),p.push(f.name),u[f.name]=m,ie=!1):h[0].charAt(h[0].length-2)!=="/"&&(f=ye(h[0],!1),P=k=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,m=t.dense?[]:{},W=[],te=[],ie=!0);break;case"table-row-group":h[1]==="/"?--N:++N;break;case"table-row":case"\u884C":if(h[1]==="/"){P+=ne,ne=1;break}if(d=ye(h[0],!1),d.\u884C\u53F7?P=d.\u884C\u53F7-1:P==-1&&(P=0),ne=+d["number-rows-repeated"]||1,ne<10)for(ee=0;ee<ne;++ee)N>0&&(te[P+ee]={level:N});k=-1;break;case"covered-table-cell":h[1]!=="/"&&++k,t.sheetStubs&&(t.dense?(m[P]||(m[P]=[]),m[P][k]={t:"z"}):m[ve({r:P,c:k})]={t:"z"}),y="",R=[];break;case"table-cell":case"\u6570\u636E":if(h[0].charAt(h[0].length-2)==="/")++k,v=ye(h[0],!1),Q=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(g.f=ml(Le(v.formula))),(v.\u6570\u636E\u7C7B\u578B||v["value-type"])=="string"&&(g.t="s",g.v=Le(v["string-value"]||""),t.dense?(m[P]||(m[P]=[]),m[P][k]=g):m[ve({r:P,c:k})]=g),k+=Q-1;else if(h[1]!=="/"){++k,y="",x=0,R=[],Q=1;var re=ne?P+ne-1:P;if(k>D.e.c&&(D.e.c=k),k<D.s.c&&(D.s.c=k),P<D.s.r&&(D.s.r=P),re>D.e.r&&(D.e.r=re),v=ye(h[0],!1),b=[],B={},g={t:v.\u6570\u636E\u7C7B\u578B||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=Le(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(J=parseInt(v["number-matrix-rows-spanned"],10)||0,ue=parseInt(v["number-matrix-columns-spanned"],10)||0,L={s:{r:P,c:k},e:{r:P+J-1,c:k+ue-1}},g.F=Ee(L),xe.push([L,g.F])),v.formula)g.f=ml(v.formula);else for(ee=0;ee<xe.length;++ee)P>=xe[ee][0].s.r&&P<=xe[ee][0].e.r&&k>=xe[ee][0].s.c&&k<=xe[ee][0].e.c&&(g.F=xe[ee][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(J=parseInt(v["number-rows-spanned"],10)||0,ue=parseInt(v["number-columns-spanned"],10)||0,L={s:{r:P,c:k},e:{r:P+J-1,c:k+ue-1}},W.push(L)),v["number-columns-repeated"]&&(Q=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Ye(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=qe(v["date-value"]),t.cellDates||(g.t="n",g.v=yt(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=Xd(v["time-value"])/86400,t.cellDates&&(g.t="d",g.v=Mi(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.\u6570\u636E\u6570\u503C);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(y=Le(v["string-value"]),R=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(z=!1,g.t==="s"&&(g.v=y||"",R.length&&(g.R=R),z=x==0),X.Target&&(g.l=X),b.length>0&&(g.c=b,b=[]),y&&t.cellText!==!1&&(g.w=y),z&&(g.t="z",delete g.v),(!z||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=P))for(var K=0;K<ne;++K){if(Q=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(m[P+K]||(m[P+K]=[]),m[P+K][k]=K==0?g:Ke(g);--Q>0;)m[P+K][k+Q]=Ke(g);else for(m[ve({r:P+K,c:k})]=g;--Q>0;)m[ve({r:P+K,c:k+Q})]=Ke(g);D.e.c<=k&&(D.e.c=k)}Q=parseInt(v["number-columns-repeated"]||"1",10),k+=Q-1,Q=0,g={},y="",R=[]}X={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!0]);break;case"annotation":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i;B.t=y,R.length&&(B.R=R),B.a=O,b.push(B)}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!1]);O="",T=0,y="",x=0,R=[];break;case"creator":h[1]==="/"?O=a.slice(T,h.index):T=h.index+h[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!1]);y="",x=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(h[1]==="/"){if(U[o.name]=c,(i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&(c="",o=ye(h[0],!1),n.push([h[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":s=ye(h[0],!1),c+=wl[h[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":s=ye(h[0],!1),c+=wl[h[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(h[0].slice(-2)==="/>")break;if(h[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(l,h.index);break}else l=h.index+h[0].length;break;case"named-range":s=ye(h[0],!1),M=bs(s["cell-range-address"]);var we={Name:s.name,Ref:M[0]+"!"+M[1]};ie&&(we.Sheet=p.length),se.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(h[1]==="/"&&(!v||!v["string-value"])){var F=w_(a.slice(x,h.index),I);y=(y.length>0?y+`
`:"")+F[0]}else I=ye(h[0],!1),x=h.index+h[0].length;break;case"s":break;case"database-range":if(h[1]==="/")break;try{M=bs(ye(h[0])["target-range-address"]),u[M[0]]["!autofilter"]={ref:M[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(h[1]!=="/"){if(X=ye(h[0],!1),!X.href)break;X.Target=Le(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(M=bs(X.Target.slice(1)),X.Target="#"+M[0]+"!"+M[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(h[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(t.WTF)throw new Error(h)}}var Me={Sheets:u,SheetNames:p,Workbook:se};return t.bookSheets&&delete Me.Sheets,Me}function _l(e,r){r=r||{},ur(e,"META-INF/manifest.xml")&&Xh(pt(e,"META-INF/manifest.xml"),r);var t=rr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var a=Ef(ze(t),r);return ur(e,"meta.xml")&&(a.Props=d0(pt(e,"meta.xml"))),a}function kl(e,r){return Ef(e,r)}var __=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Fn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ft+r}})(),El=(function(){var e=function(i){return Ge(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,a=function(i,s,o){var c=[];c.push('      <table:table table:name="'+Ge(s.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,f=0,d=Kt(i["!ref"]||"A1"),u=i["!merges"]||[],p=0,m=Array.isArray(i);if(i["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var h="",g=i["!rows"]||[];for(l=0;l<d.s.r;++l)h=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+h+`></table:table-row>
`);for(;l<=d.e.r;++l){for(h=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+h+`>
`),f=0;f<d.s.c;++f)c.push(r);for(;f<=d.e.c;++f){var v=!1,y={},x="";for(p=0;p!=u.length;++p)if(!(u[p].s.c>f)&&!(u[p].s.r>l)&&!(u[p].e.c<f)&&!(u[p].e.r<l)){(u[p].s.c!=f||u[p].s.r!=l)&&(v=!0),y["table:number-columns-spanned"]=u[p].e.c-u[p].s.c+1,y["table:number-rows-spanned"]=u[p].e.r-u[p].s.r+1;break}if(v){c.push(t);continue}var I=ve({r:l,c:f}),R=m?(i[l]||[])[f]:i[I];if(R&&R.f&&(y["table:formula"]=Ge(jv(R.f)),R.F&&R.F.slice(0,I.length)==I)){var P=Kt(R.F);y["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,y["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!R){c.push(r);continue}switch(R.t){case"b":x=R.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=R.v?"true":"false";break;case"n":x=R.w||String(R.v||0),y["office:value-type"]="float",y["office:value"]=R.v||0;break;case"s":case"str":x=R.v==null?"":R.v,y["office:value-type"]="string";break;case"d":x=R.w||qe(R.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=qe(R.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(r);continue}var k=e(x);if(R.l&&R.l.Target){var D=R.l.Target;D=D.charAt(0)=="#"?"#"+Hv(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),k=oe("text:a",k,{"xlink:href":D.replace(/&/g,"&amp;")})}c.push("          "+oe("table:table-cell",oe("text:p",k,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var f=0;f<l["!cols"].length;++f)if(l["!cols"][f]){var d=l["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;ea(d),d.ods=o;var u=l["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var f=0;f<l["!rows"].length;++f)if(l["!rows"][f]){l["!rows"][f].ods=c;var d=l["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[ft],l=Fn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Fn({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+f+`>
`),c.push(u0().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),n(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=s.SheetNames.length;++d)c.push(a(s.Sheets[s.SheetNames[d]],s,d,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function bf(e,r){if(r.bookType=="fods")return El(e,r);var t=qs(),a="",n=[],i=[];return a="mimetype",Te(t,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Te(t,a,El(e,r)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Te(t,a,__(e,r)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Te(t,a,ft+u0()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Te(t,a,Kh(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Te(t,a,Yh(n)),t}function ka(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function js(e){return typeof TextDecoder!="undefined"?new TextDecoder().decode(e):ze(aa(e))}function k_(e){return typeof TextEncoder!="undefined"?new TextEncoder().encode(e):tr(Fr(e))}function E_(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var a=0;a<r.length;++a)if(e[t+a]!=r[a])continue e;return!0}return!1}function ra(e){var r=e.reduce(function(n,i){return n+i.length},0),t=new Uint8Array(r),a=0;return e.forEach(function(n){t.set(n,a),a+=n.length}),t}function bl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function b_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,n=r+13;n>=r;--n)a=a*256+e[n];return(e[r+15]&128?-a:a)*Math.pow(10,t-6176)}function T_(e,r,t){var a=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,n=t/Math.pow(10,a-6176);e[r+15]|=a>>7,e[r+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[r+i]=n&255;e[r+15]|=t>=0?0:128}function Mn(e,r){var t=r?r[0]:0,a=e[t]&127;e:if(e[t++]>=128&&(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),a}function Ve(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function nt(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function $e(e){for(var r=[],t=[0];t[0]<e.length;){var a=t[0],n=Mn(e,t),i=n&7;n=Math.floor(n/8);var s=0,o;if(n==0)break;switch(i){case 0:{for(var c=t[0];e[t[0]++]>=128;);o=e.slice(c,t[0])}break;case 5:s=4,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=Mn(e,t),o=e.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var l={data:o,type:i};r[n]==null?r[n]=[l]:r[n].push(l)}return r}function Ct(e){var r=[];return e.forEach(function(t,a){t.forEach(function(n){n.data&&(r.push(Ve(a*8+n.type)),n.type==2&&r.push(Ve(n.data.length)),r.push(n.data))})}),ra(r)}function Co(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function lr(e){for(var r,t=[],a=[0];a[0]<e.length;){var n=Mn(e,a),i=$e(e.slice(a[0],a[0]+n));a[0]+=n;var s={id:nt(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=$e(o.data),l=nt(c[3][0].data);s.messages.push({meta:c,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(r=i[3])!=null&&r[0]&&(s.merge=nt(i[3][0].data)>>>0>0),t.push(s)}return t}function Na(e){var r=[];return e.forEach(function(t){var a=[];a[1]=[{data:Ve(t.id),type:0}],a[2]=[],t.merge!=null&&(a[3]=[{data:Ve(+!!t.merge),type:0}]);var n=[];t.messages.forEach(function(s){n.push(s.data),s.meta[3]=[{type:0,data:Ve(s.data.length)}],a[2].push({data:Ct(s.meta),type:2})});var i=Ct(a);r.push(Ve(i.length)),r.push(i),n.forEach(function(s){return r.push(s)})}),ra(r)}function S_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],a=Mn(r,t),n=[];t[0]<r.length;){var i=r[t[0]]&3;if(i==0){var s=r[t[0]++]>>2;if(s<60)++s;else{var o=s-59;s=r[t[0]],o>1&&(s|=r[t[0]+1]<<8),o>2&&(s|=r[t[0]+2]<<16),o>3&&(s|=r[t[0]+3]<<24),s>>>=0,s++,t[0]+=o}n.push(r.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var c=0,l=0;if(i==1?(l=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,i==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),n=[ra(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var f=ra(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function fr(e){for(var r=[],t=0;t<e.length;){var a=e[t++],n=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(S_(a,e.slice(t,t+n))),t+=n}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ra(r)}function Da(e){for(var r=[],t=0;t<e.length;){var a=Math.min(e.length-t,268435455),n=new Uint8Array(4);r.push(n);var i=Ve(a),s=i.length;r.push(i),a<=60?(s++,r.push(new Uint8Array([a-1<<2]))):a<=256?(s+=2,r.push(new Uint8Array([240,a-1&255]))):a<=65536?(s+=3,r.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(s+=4,r.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(s+=5,r.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),r.push(e.slice(t,t+a)),s+=a,n[0]=0,n[1]=s&255,n[2]=s>>8&255,n[3]=s>>16&255,t+=a}return ra(r)}function C_(e,r,t,a){var n=ka(e),i=n.getUint32(4,!0),s=(a>1?12:8)+bl(i&(a>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);i&512&&(o=n.getUint32(s,!0),s+=4),s+=bl(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(s,!0),s+=4),i&32&&(l=n.getFloat64(s,!0),s+=8),i&64&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:r[c]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:l>0};break;case 7:d={t:"n",v:l/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:t[o]};else if(c>-1)d={t:"s",v:r[c]};else if(!isNaN(l))d={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function A_(e,r,t){var a=ka(e),n=a.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);n&1&&(c=b_(e,i),i+=16),n&2&&(l=a.getFloat64(i,!0),i+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(s=a.getUint32(i,!0),i+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:r[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:l>0};break;case 7:d={t:"n",v:l/86400};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1)d={t:"s",v:t[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return d}function Ss(e,r){var t=new Uint8Array(32),a=ka(t),n=12,i=0;switch(t[0]=5,e.t){case"n":t[1]=2,T_(t,n,e.v),i|=1,n+=16;break;case"b":t[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,a.setUint32(n,r.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),t.slice(0,n)}function Cs(e,r){var t=new Uint8Array(32),a=ka(t),n=12,i=0;switch(t[0]=3,e.t){case"n":t[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":t[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,a.setUint32(n,r.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),t.slice(0,n)}function O_(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return C_(e,r,t,e[0]);case 5:return A_(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function It(e){var r=$e(e);return Mn(r[1][0].data)}function Tl(e,r){var t=$e(r.data),a=nt(t[1][0].data),n=t[3],i=[];return(n||[]).forEach(function(s){var o=$e(s.data),c=nt(o[1][0].data)>>>0;switch(a){case 1:i[c]=js(o[3][0].data);break;case 8:{var l=e[It(o[9][0].data)][0],f=$e(l.data),d=e[It(f[1][0].data)][0],u=nt(d.meta[1][0].data);if(u!=2001)throw new Error("2000 unexpected reference to ".concat(u));var p=$e(d.data);i[c]=p[3].map(function(m){return js(m.data)}).join("")}break}}),i}function F_(e,r){var t,a,n,i,s,o,c,l,f,d,u,p,m,h,g=$e(e),v=nt(g[1][0].data)>>>0,y=nt(g[2][0].data)>>>0,x=((a=(t=g[8])==null?void 0:t[0])==null?void 0:a.data)&&nt(g[8][0].data)>0||!1,I,R;if((i=(n=g[7])==null?void 0:n[0])!=null&&i.data&&r!=0)I=(o=(s=g[7])==null?void 0:s[0])==null?void 0:o.data,R=(l=(c=g[6])==null?void 0:c[0])==null?void 0:l.data;else if((d=(f=g[4])==null?void 0:f[0])!=null&&d.data&&r!=1)I=(p=(u=g[4])==null?void 0:u[0])==null?void 0:p.data,R=(h=(m=g[3])==null?void 0:m[0])==null?void 0:h.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var P=x?4:1,k=ka(I),D=[],N=0;N<I.length/2;++N){var U=k.getUint16(N*2,!0);U<65535&&D.push([N,U])}if(D.length!=y)throw"Expected ".concat(y," cells, found ").concat(D.length);var W=[];for(N=0;N<D.length-1;++N)W[D[N][0]]=R.subarray(D[N][1]*P,D[N+1][1]*P);return D.length>=1&&(W[D[D.length-1][0]]=R.subarray(D[D.length-1][1]*P)),{R:v,cells:W}}function I_(e,r){var t,a=$e(r.data),n=(t=a==null?void 0:a[7])!=null&&t[0]?nt(a[7][0].data)>>>0>0?1:0:-1,i=Co(a[5],function(s){return F_(s,n)});return{nrows:nt(a[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,l){if(s[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));s[o.R][l]=c}),s},[])}}function P_(e,r,t){var a,n=$e(r.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(nt(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(nt(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=Ee(i);var s=$e(n[4][0].data),o=Tl(e,e[It(s[4][0].data)][0]),c=(a=s[17])!=null&&a[0]?Tl(e,e[It(s[17][0].data)][0]):[],l=$e(s[3][0].data),f=0;l[1].forEach(function(d){var u=$e(d.data),p=e[It(u[2][0].data)][0],m=nt(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var h=I_(e,p);h.data.forEach(function(g,v){g.forEach(function(y,x){var I=ve({r:f+v,c:x}),R=O_(y,o,c);R&&(t[I]=R)})}),f+=h.nrows})}function R_(e,r){var t=$e(r.data),a={"!ref":"A1"},n=e[It(t[2][0].data)],i=nt(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return P_(e,n[0],a),a}function N_(e,r){var t,a=$e(r.data),n={name:(t=a[1])!=null&&t[0]?js(a[1][0].data):"",sheets:[]},i=Co(a[2],It);return i.forEach(function(s){e[s].forEach(function(o){var c=nt(o.meta[1][0].data);c==6e3&&n.sheets.push(R_(e,o))})}),n}function D_(e,r){var t=Ro(),a=$e(r.data),n=Co(a[1],It);if(n.forEach(function(i){e[i].forEach(function(s){var o=nt(s.meta[1][0].data);if(o==2){var c=N_(e,s);c.sheets.forEach(function(l,f){No(t,l,f==0?c.name:c.name+"_"+f,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function As(e){var r,t,a,n,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=fr(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var f;try{f=lr(l)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){i[d.id]=d.messages,s.push(d.id)})}}),!s.length)throw new Error("File has no messages");var o=((n=(a=(t=(r=i==null?void 0:i[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&nt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(l){var f=nt(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return D_(i,o)}function L_(e,r,t){var a,n,i,s;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&nt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=ka(e[7][0].data),f=0,d=[],u=ka(e[4][0].data),p=0,m=[],h=0;h<r.length;++h){if(r[h]==null){l.setUint16(h*2,65535,!0),u.setUint16(h*2,65535);continue}l.setUint16(h*2,f,!0),u.setUint16(h*2,p,!0);var g,v;switch(typeof r[h]){case"string":g=Ss({t:"s",v:r[h]},t),v=Cs({t:"s",v:r[h]},t);break;case"number":g=Ss({t:"n",v:r[h]},t),v=Cs({t:"n",v:r[h]},t);break;case"boolean":g=Ss({t:"b",v:r[h]},t),v=Cs({t:"b",v:r[h]},t);break;default:throw new Error("Unsupported value "+r[h])}d.push(g),f+=g.length,m.push(v),p+=v.length,++c}for(e[2][0].data=Ve(c);h<e[7][0].data.length/2;++h)l.setUint16(h*2,65535,!0),u.setUint16(h*2,65535,!0);return e[6][0].data=ra(d),e[3][0].data=ra(m),c}function B_(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Kt(t["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Ee(a)));var i=Ri(t,{range:a,header:1}),s=["~Sh33tJ5~"];i.forEach(function(O){return O.forEach(function(T){typeof T=="string"&&s.push(T)})});var o={},c=[],l=me.read(r.numbers,{type:"base64"});l.FileIndex.map(function(O,T){return[O,l.FullPaths[T]]}).forEach(function(O){var T=O[0],z=O[1];if(T.type==2&&T.name.match(/\.iwa/)){var ie=T.content,ee=fr(ie),re=lr(ee);re.forEach(function(K){c.push(K.id),o[K.id]={deps:[],location:z,type:nt(K.messages[0].meta[1][0].data)}})}}),c.sort(function(O,T){return O-T});var f=c.filter(function(O){return O>1}).map(function(O){return[O,Ve(O)]});l.FileIndex.map(function(O,T){return[O,l.FullPaths[T]]}).forEach(function(O){var T=O[0],z=O[1];if(T.name.match(/\.iwa/)){var ie=lr(fr(T.content));ie.forEach(function(ee){ee.messages.forEach(function(re){f.forEach(function(K){ee.messages.some(function(we){return nt(we.meta[1][0].data)!=11006&&E_(we.data,K[1])})&&o[K[0]].deps.push(ee.id)})})})}});function d(){for(var O=927262;O<2e6;++O)if(!o[O])return O;throw new Error("Too many messages")}for(var u=me.find(l,o[1].location),p=lr(fr(u.content)),m,h=0;h<p.length;++h){var g=p[h];g.id==1&&(m=g)}var v=It($e(m.messages[0].data)[1][0].data);for(u=me.find(l,o[v].location),p=lr(fr(u.content)),h=0;h<p.length;++h)g=p[h],g.id==v&&(m=g);for(v=It($e(m.messages[0].data)[2][0].data),u=me.find(l,o[v].location),p=lr(fr(u.content)),h=0;h<p.length;++h)g=p[h],g.id==v&&(m=g);for(v=It($e(m.messages[0].data)[2][0].data),u=me.find(l,o[v].location),p=lr(fr(u.content)),h=0;h<p.length;++h)g=p[h],g.id==v&&(m=g);var y=$e(m.messages[0].data);{y[6][0].data=Ve(a.e.r+1),y[7][0].data=Ve(a.e.c+1);var x=It(y[46][0].data),I=me.find(l,o[x].location),R=lr(fr(I.content));{for(var P=0;P<R.length&&R[P].id!=x;++P);if(R[P].id!=x)throw"Bad ColumnRowUIDMapArchive";var k=$e(R[P].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var D=0;D<=a.e.c;++D){var N=[];N[1]=N[2]=[{type:0,data:Ve(D+420690)}],k[1].push({type:2,data:Ct(N)}),k[2].push({type:0,data:Ve(D)}),k[3].push({type:0,data:Ve(D)})}k[4]=[],k[5]=[],k[6]=[];for(var U=0;U<=a.e.r;++U)N=[],N[1]=N[2]=[{type:0,data:Ve(U+726270)}],k[4].push({type:2,data:Ct(N)}),k[5].push({type:0,data:Ve(U)}),k[6].push({type:0,data:Ve(U)});R[P].messages[0].data=Ct(k)}I.content=Da(Na(R)),I.size=I.content.length,delete y[46];var W=$e(y[4][0].data);{W[7][0].data=Ve(a.e.r+1);var L=$e(W[1][0].data),J=It(L[2][0].data);I=me.find(l,o[J].location),R=lr(fr(I.content));{if(R[0].id!=J)throw"Bad HeaderStorageBucket";var ue=$e(R[0].messages[0].data);for(U=0;U<i.length;++U){var te=$e(ue[2][0].data);te[1][0].data=Ve(U),te[4][0].data=Ve(i[U].length),ue[2][U]={type:ue[2][0].type,data:Ct(te)}}R[0].messages[0].data=Ct(ue)}I.content=Da(Na(R)),I.size=I.content.length;var ne=It(W[2][0].data);I=me.find(l,o[ne].location),R=lr(fr(I.content));{if(R[0].id!=ne)throw"Bad HeaderStorageBucket";for(ue=$e(R[0].messages[0].data),D=0;D<=a.e.c;++D)te=$e(ue[2][0].data),te[1][0].data=Ve(D),te[4][0].data=Ve(a.e.r+1),ue[2][D]={type:ue[2][0].type,data:Ct(te)};R[0].messages[0].data=Ct(ue)}I.content=Da(Na(R)),I.size=I.content.length;var Q=It(W[4][0].data);(function(){for(var O=me.find(l,o[Q].location),T=lr(fr(O.content)),z,ie=0;ie<T.length;++ie){var ee=T[ie];ee.id==Q&&(z=ee)}var re=$e(z.messages[0].data);{re[3]=[];var K=[];s.forEach(function(Me,Oe){K[1]=[{type:0,data:Ve(Oe)}],K[2]=[{type:0,data:Ve(1)}],K[3]=[{type:2,data:k_(Me)}],re[3].push({type:2,data:Ct(K)})})}z.messages[0].data=Ct(re);var we=Na(T),F=Da(we);O.content=F,O.size=O.content.length})();var xe=$e(W[3][0].data);{var se=xe[1][0];delete xe[2];var X=$e(se.data);{var M=It(X[2][0].data);(function(){for(var O=me.find(l,o[M].location),T=lr(fr(O.content)),z,ie=0;ie<T.length;++ie){var ee=T[ie];ee.id==M&&(z=ee)}var re=$e(z.messages[0].data);{delete re[6],delete xe[7];var K=new Uint8Array(re[5][0].data);re[5]=[];for(var we=0,F=0;F<=a.e.r;++F){var Me=$e(K);we+=L_(Me,i[F],s),Me[1][0].data=Ve(F),re[5].push({data:Ct(Me),type:2})}re[1]=[{type:0,data:Ve(a.e.c+1)}],re[2]=[{type:0,data:Ve(a.e.r+1)}],re[3]=[{type:0,data:Ve(we)}],re[4]=[{type:0,data:Ve(a.e.r+1)}]}z.messages[0].data=Ct(re);var Oe=Na(T),Ue=Da(Oe);O.content=Ue,O.size=O.content.length})()}se.data=Ct(X)}W[3][0].data=Ct(xe)}y[4][0].data=Ct(W)}m.messages[0].data=Ct(y);var b=Na(p),B=Da(b);return u.content=B,u.size=u.content.length,l}function Tf(e){return function(t){for(var a=0;a!=e.length;++a){var n=e[a];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function Ao(e){Tf([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Oo(e){Tf([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function M_(e){return Se.WS.indexOf(e)>-1?"sheet":Se.CS&&e==Se.CS?"chart":Se.DS&&e==Se.DS?"dialog":Se.MS&&e==Se.MS?"macro":e&&e.length?e:"sheet"}function U_(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,M_(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function $_(e,r,t,a,n,i,s,o,c,l,f,d){try{i[a]=_n(rr(e,t,!0),r);var u=pt(e,r),p;switch(o){case"sheet":p=cw(u,r,n,c,i[a],l,f,d);break;case"chart":if(p=lw(u,r,n,c,i[a],l,f,d),!p||!p["!drawel"])break;var m=xn(p["!drawel"].Target,r),h=Pn(m),g=qg(rr(e,m,!0),_n(rr(e,h,!0),m)),v=xn(g,m),y=Pn(v);p=Ly(rr(e,v,!0),v,c,_n(rr(e,y,!0),v),l,p);break;case"macro":p=fw(u,r,n,c,i[a],l,f,d);break;case"dialog":p=uw(u,r,n,c,i[a],l,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}s[a]=p;var x=[];i&&i[a]&&st(i[a]).forEach(function(I){var R="";if(i[a][I].Type==Se.CMNT){R=xn(i[a][I].Target,r);var P=mw(pt(e,R,!0),R,c);if(!P||!P.length)return;fl(p,P,!1)}i[a][I].Type==Se.TCMNT&&(R=xn(i[a][I].Target,r),x=x.concat(Jg(pt(e,R,!0),c)))}),x&&x.length&&fl(p,x,!0,c.people||[])}catch(I){if(c.WTF)throw I}}function or(e){return e.charAt(0)=="/"?e.slice(1):e}function j_(e,r){if(Ya(),r=r||{},Ao(r),ur(e,"META-INF/manifest.xml")||ur(e,"objectdata.xml"))return _l(e,r);if(ur(e,"Index/Document.iwa")){if(typeof Uint8Array=="undefined")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof As!="undefined"){if(e.FileIndex)return As(e);var t=me.utils.cfb_new();return Ic(e).forEach(function(ue){Te(t,ue,Vl(e,ue))}),As(t)}throw new Error("Unsupported NUMBERS file")}if(!ur(e,"[Content_Types].xml"))throw ur(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ur(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Ic(e),n=Gh(rr(e,"[Content_Types].xml")),i=!1,s,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",pt(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!pt(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},l={};if(!r.bookSheets&&!r.bookProps){if(kn=[],n.sst)try{kn=pw(pt(e,or(n.sst)),n.sst,r)}catch(ue){if(r.WTF)throw ue}r.cellStyles&&n.themes.length&&(c=hw(rr(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],r)),n.style&&(l=dw(pt(e,or(n.style)),n.style,c,r))}n.links.map(function(ue){try{var te=_n(rr(e,Pn(or(ue))),ue);return xw(pt(e,or(ue)),te,ue,r)}catch{}});var f=ow(pt(e,or(n.workbooks[0])),n.workbooks[0],r),d={},u="";n.coreprops.length&&(u=pt(e,or(n.coreprops[0]),!0),u&&(d=d0(u)),n.extprops.length!==0&&(u=pt(e,or(n.extprops[0]),!0),u&&Zh(u,d,r)));var p={};(!r.bookSheets||r.bookProps)&&n.custprops.length!==0&&(u=rr(e,or(n.custprops[0]),!0),u&&(p=ep(u,r)));var m={};if((r.bookSheets||r.bookProps)&&(f.Sheets?s=f.Sheets.map(function(te){return te.name}):d.Worksheets&&d.SheetNames.length>0&&(s=d.SheetNames),r.bookProps&&(m.Props=d,m.Custprops=p),r.bookSheets&&typeof s!="undefined"&&(m.SheetNames=s),r.bookSheets?m.SheetNames:r.bookProps))return m;s={};var h={};r.bookDeps&&n.calcchain&&(h=gw(pt(e,or(n.calcchain)),n.calcchain,r));var g=0,v={},y,x;{var I=f.Sheets;d.Worksheets=I.length,d.SheetNames=[];for(var R=0;R!=I.length;++R)d.SheetNames[R]=I[R].name}var P=i?"bin":"xml",k=n.workbooks[0].lastIndexOf("/"),D=(n.workbooks[0].slice(0,k+1)+"_rels/"+n.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");ur(e,D)||(D="xl/_rels/workbook."+P+".rels");var N=_n(rr(e,D,!0),D.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(r.xlmeta=vw(pt(e,or(n.metadata[0])),n.metadata[0],r)),(n.people||[]).length>=1&&(r.people=Qg(pt(e,or(n.people[0])),r)),N&&(N=U_(N,f.Sheets));var U=pt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=d.Worksheets;++g){var W="sheet";if(N&&N[g]?(y="xl/"+N[g][1].replace(/[\/]?xl\//,""),ur(e,y)||(y=N[g][1]),ur(e,y)||(y=D.replace(/_rels\/.*$/,"")+N[g][1]),W=N[g][2]):(y="xl/worksheets/sheet"+(g+1-U)+"."+P,y=y.replace(/sheet0\./,"sheet.")),x=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(d.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var L=!1,J=0;J!=r.sheets.length;++J)typeof r.sheets[J]=="number"&&r.sheets[J]==g&&(L=1),typeof r.sheets[J]=="string"&&r.sheets[J].toLowerCase()==d.SheetNames[g].toLowerCase()&&(L=1);if(!L)continue e}}$_(e,y,x,d.SheetNames[g],g,v,s,W,r,f,c,l)}return m={Directory:n,Workbook:f,Props:d,Custprops:p,Deps:h,Sheets:s,SheetNames:d.SheetNames,Strings:kn,Styles:l,Themes:c,SSF:Ke(ge)},r&&r.bookFiles&&(e.files?(m.keys=a,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(ue,te){ue=ue.replace(/^Root Entry[\/]/,""),m.keys.push(ue),m.files[ue]=e.FileIndex[te]}))),r&&r.bookVBA&&(n.vba.length>0?m.vbaraw=pt(e,or(n.vba[0]),!0):n.defaults&&n.defaults.bin===ox&&(m.vbaraw=pt(e,"xl/vbaProject.bin",!0))),m}function H_(e,r){var t=r||{},a="Workbook",n=me.find(e,a);try{if(a="/!DataSpaces/Version",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(vm(n.content),a="/!DataSpaces/DataSpaceMap",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=wm(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=_m(n.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);Em(n.content)}catch{}if(a="/EncryptionInfo",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=bm(n.content);if(a="/EncryptedPackage",n=me.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile!="undefined")return decrypt_agile(o[1],n.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76!="undefined")return decrypt_std76(o[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function V_(e,r){return r.bookType=="ods"?bf(e,r):r.bookType=="numbers"?B_(e,r):r.bookType=="xlsb"?W_(e,r):G_(e,r)}function W_(e,r){Ma=1024,e&&!e.SSF&&(e.SSF=Ke(ge)),e&&e.SSF&&(Ya(),Di(e.SSF),r.revssf=Bi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,En?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",a=J0.indexOf(r.bookType)>-1,n=po();Oo(r=r||{});var i=qs(),s="",o=0;if(r.cellXfs=[],ia(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Te(i,s,h0(e.Props,r)),n.coreprops.push(s),We(r.rels,2,s,Se.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Te(i,s,g0(e.Props,r)),n.extprops.push(s),We(r.rels,3,s,Se.EXT_PROPS),e.Custprops!==e.Props&&st(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Te(i,s,x0(e.Custprops,r)),n.custprops.push(s),We(r.rels,4,s,Se.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],u=(d||{})["!type"]||"sheet";switch(u){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,Te(i,s,ww(o-1,s,r,e,f)),n.sheets.push(s),We(r.wbrels,-1,"worksheets/sheet"+o+"."+t,Se.WS[0])}if(d){var p=d["!comments"],m=!1,h="";p&&p.length>0&&(h="xl/comments"+o+"."+t,Te(i,h,Ew(p,h,r)),n.comments.push(h),We(f,-1,"../comments"+o+"."+t,Se.CMNT),m=!0),d["!legacy"]&&m&&Te(i,"xl/drawings/vmlDrawing"+o+".vml",q0(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Te(i,Pn(s),$a(f))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+t,Te(i,s,kw(r.Strings,s,r)),n.strs.push(s),We(r.wbrels,-1,"sharedStrings."+t,Se.SST)),s="xl/workbook."+t,Te(i,s,yw(e,s,r)),n.workbooks.push(s),We(r.rels,1,s,Se.WB),s="xl/theme/theme1.xml",Te(i,s,wo(e.Themes,r)),n.themes.push(s),We(r.wbrels,-1,"theme/theme1.xml",Se.THEME),s="xl/styles."+t,Te(i,s,_w(e,s,r)),n.styles.push(s),We(r.wbrels,-1,"styles."+t,Se.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",Te(i,s,e.vbaraw),n.vba.push(s),We(r.wbrels,-1,"vbaProject.bin",Se.VBA)),s="xl/metadata."+t,Te(i,s,bw(s)),n.metadata.push(s),We(r.wbrels,-1,"metadata."+t,Se.XLMETA),Te(i,"[Content_Types].xml",f0(n,r)),Te(i,"_rels/.rels",$a(r.rels)),Te(i,"xl/_rels/workbook."+t+".rels",$a(r.wbrels)),delete r.revssf,delete r.ssf,i}function G_(e,r){Ma=1024,e&&!e.SSF&&(e.SSF=Ke(ge)),e&&e.SSF&&(Ya(),Di(e.SSF),r.revssf=Bi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,En?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",a=J0.indexOf(r.bookType)>-1,n=po();Oo(r=r||{});var i=qs(),s="",o=0;if(r.cellXfs=[],ia(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Te(i,s,h0(e.Props,r)),n.coreprops.push(s),We(r.rels,2,s,Se.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Te(i,s,g0(e.Props,r)),n.extprops.push(s),We(r.rels,3,s,Se.EXT_PROPS),e.Custprops!==e.Props&&st(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Te(i,s,x0(e.Custprops,r)),n.custprops.push(s),We(r.rels,4,s,Se.CUST_PROPS));var f=["SheetJ5"];for(r.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},u=e.Sheets[e.SheetNames[o-1]],p=(u||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,Te(i,s,lf(o-1,r,e,d)),n.sheets.push(s),We(r.wbrels,-1,"worksheets/sheet"+o+"."+t,Se.WS[0])}if(u){var m=u["!comments"],h=!1,g="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+o+"."+t,Te(i,g,Zg(m,f,r)),n.threadedcomments.push(g),We(d,-1,"../threadedComments/threadedComment"+o+"."+t,Se.TCMNT)),g="xl/comments"+o+"."+t,Te(i,g,K0(m,r)),n.comments.push(g),We(d,-1,"../comments"+o+"."+t,Se.CMNT),h=!0}u["!legacy"]&&h&&Te(i,"xl/drawings/vmlDrawing"+o+".vml",q0(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&Te(i,Pn(s),$a(d))}return r.Strings!=null&&r.Strings.length>0&&(s="xl/sharedStrings."+t,Te(i,s,B0(r.Strings,r)),n.strs.push(s),We(r.wbrels,-1,"sharedStrings."+t,Se.SST)),s="xl/workbook."+t,Te(i,s,pf(e,r)),n.workbooks.push(s),We(r.rels,1,s,Se.WB),s="xl/theme/theme1.xml",Te(i,s,wo(e.Themes,r)),n.themes.push(s),We(r.wbrels,-1,"theme/theme1.xml",Se.THEME),s="xl/styles."+t,Te(i,s,G0(e,r)),n.styles.push(s),We(r.wbrels,-1,"styles."+t,Se.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",Te(i,s,e.vbaraw),n.vba.push(s),We(r.wbrels,-1,"vbaProject.bin",Se.VBA)),s="xl/metadata."+t,Te(i,s,Y0()),n.metadata.push(s),We(r.wbrels,-1,"metadata."+t,Se.XLMETA),f.length>1&&(s="xl/persons/person.xml",Te(i,s,ex(f,r)),n.people.push(s),We(r.wbrels,-1,"persons/person.xml",Se.PEOPLE)),Te(i,"[Content_Types].xml",f0(n,r)),Te(i,"_rels/.rels",$a(r.rels)),Te(i,"xl/_rels/workbook."+t+".rels",$a(r.wbrels)),delete r.revssf,delete r.ssf,i}function Fo(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=ar(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function z_(e,r){return me.find(e,"EncryptedPackage")?H_(e,r):vf(e,r)}function X_(e,r){var t,a=e,n=r||{};return n.type||(n.type=Fe&&Buffer.isBuffer(e)?"buffer":"base64"),t=Wl(a,n),j_(t,n)}function Sf(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Us(e.slice(t),r);default:break e}return Ga.to_workbook(e,r)}function Y_(e,r){var t="",a=Fo(e,r);switch(r.type){case"base64":t=ar(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=va(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(t=ze(t)),r.type="binary",Sf(t,r)}function q_(e,r){var t=e;return r.type=="base64"&&(t=ar(t)),t=He.utils.decode(1200,t.slice(2),"str"),r.type="binary",Sf(t,r)}function K_(e){return e.match(/[^\x00-\x7F]/)?Fr(e):e}function Os(e,r,t,a){return a?(t.type="string",Ga.to_workbook(e,t)):Ga.to_workbook(r,t)}function Pi(e,r){Ws();var t=r||{};if(typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer)return Pi(new Uint8Array(e),(t=Ke(t),t.type="array",t));typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno!="undefined"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ha={},t.dateNF&&(Ha.dateNF=t.dateNF),t.type||(t.type=Fe&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Fe?"buffer":"binary",a=Wd(e),typeof Uint8Array!="undefined"&&!Fe&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,a=K_(e)),t.type=="array"&&typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!="undefined"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return t=Ke(t),t.type="array",Pi(Gs(a),t)}switch((n=Fo(a,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return z_(me.read(a,t),t);break;case 9:if(n[1]<=8)return vf(a,t);break;case 60:return Us(a,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return tm(a,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return D0.to_workbook(a,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?X_(a,t):Os(e,a,t,i);case 239:return n[3]===60?Us(a,t):Os(e,a,t,i);case 255:if(n[1]===254)return q_(a,t);if(n[1]===0&&n[2]===2&&n[3]===0)return ma.to_workbook(a,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return ma.to_workbook(a,t);break;case 3:case 131:case 139:case 140:return Ms.to_workbook(a,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return H0.to_workbook(a,t);break;case 10:case 13:case 32:return Y_(a,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return em.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Ms.to_workbook(a,t):Os(e,a,t,i)}function Cf(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return $n(r.file,me.write(e,{type:Fe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return me.write(e,r)}function J_(e,r){var t=Ke(r||{}),a=V_(e,t);return Z_(a,t)}function Z_(e,r){var t={},a=Fe?"nodebuffer":typeof Uint8Array!="undefined"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=a;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=a;break;default:throw new Error("Unrecognized type "+r.type)}var n=e.FullPaths?me.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno!="undefined"&&typeof n=="string"){if(r.type=="binary"||r.type=="base64")return n;n=new Uint8Array(Ni(n))}return r.password&&typeof encrypt_agile!="undefined"?Cf(encrypt_agile(n,r.password),r):r.type==="file"?$n(r.file,n):r.type=="string"?ze(n):n}function Q_(e,r){var t=r||{},a=Kw(e,t);return Cf(a,t)}function Or(e,r,t){t||(t="");var a=t+e;switch(r.type){case"base64":return Cn(Fr(a));case"binary":return Fr(a);case"string":return e;case"file":return $n(r.file,a,"utf8");case"buffer":return Fe?Hr(a,"utf8"):typeof TextEncoder!="undefined"?new TextEncoder().encode(a):Or(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function ek(e,r){switch(r.type){case"base64":return Cn(e);case"binary":return e;case"string":return e;case"file":return $n(r.file,e,"binary");case"buffer":return Fe?Hr(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function wi(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",a=0;a<e.length;++a)t+=String.fromCharCode(e[a]);return r.type=="base64"?Cn(t):r.type=="string"?ze(t):t;case"file":return $n(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Io(e,r){Ws(),zy(e);var t=Ke(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var a=Io(e,t);return t.type="array",Ni(a)}var n=0;if(t.sheet&&(typeof t.sheet=="number"?n=t.sheet:n=e.SheetNames.indexOf(t.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Or(Vw(e,t),t);case"slk":case"sylk":return Or(N0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"htm":case"html":return Or(wf(e.Sheets[e.SheetNames[n]],t),t);case"txt":return ek(Af(e.Sheets[e.SheetNames[n]],t),t);case"csv":return Or(Po(e.Sheets[e.SheetNames[n]],t),t,"\uFEFF");case"dif":return Or(D0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"dbf":return wi(Ms.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"prn":return Or(Ga.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"rtf":return Or(H0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"eth":return Or(L0.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"fods":return Or(bf(e,t),t);case"wk1":return wi(ma.sheet_to_wk1(e.Sheets[e.SheetNames[n]],t),t);case"wk3":return wi(ma.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),wi(yf(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Q_(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return J_(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function tk(e,r,t,a,n,i,s,o){var c=lt(t),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,u=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:t,enumerable:!1})}catch{u.__rowNum__=t}else u.__rowNum__=t;if(!s||e[t])for(var p=r.s.c;p<=r.e.c;++p){var m=s?e[t][p]:e[a[p]+c];if(m===void 0||m.t===void 0){if(l===void 0)continue;i[p]!=null&&(u[i[p]]=l);continue}var h=m.v;switch(m.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[p]!=null){if(h==null)if(m.t=="e"&&h===null)u[i[p]]=null;else if(l!==void 0)u[i[p]]=l;else if(f&&h===null)u[i[p]]=null;else continue;else u[i[p]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?h:jr(m,h,o);h!=null&&(d=!1)}}return{row:u,isempty:d}}function Ri(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},a=0,n=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof f){case"string":c=Be(f);break;case"number":c=Be(e["!ref"]),c.s.r=f;break;default:c=f}a>0&&(n=0);var d=lt(c.s.r),u=[],p=[],m=0,h=0,g=Array.isArray(e),v=c.s.r,y=0,x={};g&&!e[v]&&(e[v]=[]);var I=l.skipHidden&&e["!cols"]||[],R=l.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(I[y]||{}).hidden)switch(u[y]=et(y),t=g?e[v][y]:e[u[y]+d],a){case 1:i[y]=y-c.s.c;break;case 2:i[y]=u[y];break;case 3:i[y]=l.header[y-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=jr(t,null,l),h=x[s]||0,!h)x[s]=1;else{do o=s+"_"+h++;while(x[o]);x[s]=h,x[o]=1}i[y]=o}for(v=c.s.r+n;v<=c.e.r;++v)if(!(R[v]||{}).hidden){var P=tk(e,c,v,u,a,i,g,l);(P.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(p[m++]=P.row)}return p.length=m,p}var Sl=/"/g;function rk(e,r,t,a,n,i,s,o){for(var c=!0,l=[],f="",d=lt(t),u=r.s.c;u<=r.e.c;++u)if(a[u]){var p=o.dense?(e[t]||[])[u]:e[a[u]+d];if(p==null)f="";else if(p.v!=null){c=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:jr(p,null,o));for(var m=0,h=0;m!==f.length;++m)if((h=f.charCodeAt(m))===n||h===i||h===34||o.forceQuotes){f='"'+f.replace(Sl,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(c=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Sl,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(s)}function Po(e,r){var t=[],a=r==null?{}:r;if(e==null||e["!ref"]==null)return"";var n=Be(e["!ref"]),i=a.FS!==void 0?a.FS:",",s=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),f="",d=[];a.dense=Array.isArray(e);for(var u=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(u[m]||{}).hidden||(d[m]=et(m));for(var h=0,g=n.s.r;g<=n.e.r;++g)(p[g]||{}).hidden||(f=rk(e,n,g,d,s,c,i,a),f!=null&&(a.strip&&(f=f.replace(l,"")),(f||a.blankrows!==!1)&&t.push((h++?o:"")+f)));return delete a.dense,t.join("")}function Af(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Po(e,r);if(typeof He=="undefined"||r.type=="string")return t;var a=He.utils.encode(1200,t,"str");return"\xFF\xFE"+a}function ak(e){var r="",t,a="";if(e==null||e["!ref"]==null)return[];var n=Be(e["!ref"]),i="",s=[],o,c=[],l=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)s[o]=et(o);for(var f=n.s.r;f<=n.e.r;++f)for(i=lt(f),o=n.s.c;o<=n.e.c;++o)if(r=s[o]+i,t=l?(e[f]||[])[o]:e[r],a="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;a=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}c[c.length]=r+"="+a}return c}function Of(e,r,t){var a=t||{},n=+!a.skipHeader,i=e||{},s=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?tt(a.origin):a.origin;s=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:s+r.length-1+n}};if(i["!ref"]){var d=Be(i["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(s=d.e.r+1,f.e.r=s+r.length-1+n)}else s==-1&&(s=0,f.e.r=r.length-1+n);var u=a.header||[],p=0;r.forEach(function(h,g){st(h).forEach(function(v){(p=u.indexOf(v))==-1&&(u[p=u.length]=v);var y=h[v],x="z",I="",R=ve({c:o+p,r:s+g+n});l=Un(i,R),y&&typeof y=="object"&&!(y instanceof Date)?i[R]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",a.cellDates||(x="n",y=yt(y)),I=a.dateNF||ge[14]):y===null&&a.nullError&&(x="e",y=0),l?(l.t=x,l.v=y,delete l.w,delete l.R,I&&(l.z=I)):i[R]=l={t:x,v:y},I&&(l.z=I))})}),f.e.c=Math.max(f.e.c,o+u.length-1);var m=lt(s);if(n)for(p=0;p<u.length;++p)i[et(p+o)+m]={t:"s",v:u[p]};return i["!ref"]=Ee(f),i}function nk(e,r){return Of(null,e,r)}function Un(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var a=tt(r);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Un(e,ve(r)):Un(e,ve({r,c:t||0}))}function ik(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Ro(){return{SheetNames:[],Sheets:{}}}function No(e,r,t,a){var n=1;if(!t)for(;n<=65535&&e.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var s=i&&i[1]||t;for(++n;n<=65535&&e.SheetNames.indexOf(t=s+n)!=-1;++n);}if(hf(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function sk(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=ik(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[a].Hidden=t}function ok(e,r){return e.z=r,e}function Ff(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function ck(e,r,t){return Ff(e,"#"+r,t)}function lk(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function fk(e,r,t,a){for(var n=typeof r!="string"?r:Be(r),i=typeof r=="string"?r:Ee(r),s=n.s.r;s<=n.e.r;++s)for(var o=n.s.c;o<=n.e.c;++o){var c=Un(e,s,o);c.t="n",c.F=i,delete c.v,s==n.s.r&&o==n.s.c&&(c.f=t,a&&(c.D=!0))}return e}var Oa={encode_col:et,encode_row:lt,encode_cell:ve,encode_range:Ee,decode_col:oo,decode_row:so,split_cell:kh,decode_cell:tt,decode_range:Kt,format_cell:jr,sheet_add_aoa:a0,sheet_add_json:Of,sheet_add_dom:_f,aoa_to_sheet:Ka,json_to_sheet:nk,table_to_sheet:kf,table_to_book:v_,sheet_to_csv:Po,sheet_to_txt:Af,sheet_to_json:Ri,sheet_to_html:wf,sheet_to_formulae:ak,sheet_to_row_object_array:Ri,sheet_get_cell:Un,book_new:Ro,book_append_sheet:No,book_set_sheet_visibility:sk,cell_set_number_format:ok,cell_set_hyperlink:Ff,cell_set_internal_link:ck,cell_add_comment:lk,sheet_set_array_formula:fk,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var lb=Sn.version;var If=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
        <path
            d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
        />
    </svg>
`.trim(),Pf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <rect width="7" height="7" x="3" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="3" rx="1" />
        <rect width="7" height="7" x="14" y="14" rx="1" />
        <rect width="7" height="7" x="3" y="14" rx="1" />
    </svg>
`.trim(),Rf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="1"/>
        <circle cx="12" cy="5" r="1"/>
        <circle cx="12" cy="19" r="1"/>
    </svg>
`.trim(),Do=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M12 3v18"/>
        <rect width="18" height="18" x="3" y="3" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
    </svg>
`.trim(),Nf=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
    </svg>
`.trim(),Df=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
        <path d="M8 7h6"/>
        <path d="M8 11h8"/>
    </svg>
`.trim(),dk={config:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3" />
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.82 2.82l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.82-2.82l.06-.06A1.65 1.65 0 0 0 3 15a1.65 1.65 0 0 0-1.51-1H1a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 3 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.82-2.82l.06.06A1.65 1.65 0 0 0 9 3.6a1.65 1.65 0 0 0 1-1.51V2a2 2 0 0 1 4 0v.09A1.65 1.65 0 0 0 15 3.6a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.82 2.82l-.06.06A1.65 1.65 0 0 0 21 9c0 .3.09.58.24.82.17.28.43.51.76.68.21.1.44.18.68.19H23a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z" />
        </svg>
    `,import:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 3v14" />
            <path d="m7 13 5 5 5-5" />
            <path d="M5 21h14" />
        </svg>
    `,headcount:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
            <circle cx="9" cy="7" r="4" />
            <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
    `,validate:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 6 9 17l-5-5" />
        </svg>
    `,review:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 12h3l2-5 4 10 2-5h5" />
        </svg>
    `,journal:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 7c-3-1-6-1-9 0v12c3-1 6-1 9 0 3-1 6-1 9 0V7c-3-1-6-1-9 0Z" />
            <path d="M12 7v12" />
        </svg>
    `,archive:`
        <svg class="pf-icon pf-step-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="4" rx="1" />
            <path d="M5 7v11a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7" />
            <path d="M10 12h4" />
        </svg>
    `};function Lf(e){return e&&dk[e]||""}var Lo=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0" />
    </svg>
`.trim(),Bo=`
    <svg
        class="pf-icon pf-lock-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0v4" />
        <path d="M12 15v2" />
    </svg>
`.trim(),Wi=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M5 12l4 4 10-10" />
    </svg>
`.trim(),Bf=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="4" y="3" width="16" height="18" rx="2" />
        <rect x="8" y="7" width="8" height="3" />
        <path d="M8 14h.01" />
        <path d="M12 14h.01" />
        <path d="M16 14h.01" />
        <path d="M8 17h.01" />
        <path d="M12 17h.01" />
        <path d="M16 17h.01" />
    </svg>
`.trim(),fb=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 5.5 20.5 8 16 12.5 13.5 10 18 5.5Z" />
        <path d="m12 11 6-6" />
        <path d="M3 22 12 13" />
        <path d="m3 18 4 4" />
        <path d="m11 11 3 3" />
    </svg>
`.trim(),hk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 1 0 7.07 7.07l1.71-1.71" />
    </svg>
`.trim(),Mf=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M7 10l5 5 5-5" />
        <path d="M12 15V3" />
    </svg>
`.trim(),Mo=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
        <path d="M17 8l-5-5-5 5" />
        <path d="M12 3v12" />
    </svg>
`.trim(),pk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10" />
        <path d="m15 9-6 6" />
        <path d="m9 9 6 6" />
    </svg>
`.trim(),Gi=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 19-7-7 7-7" />
        <path d="M19 12H5" />
    </svg>
`.trim(),Uf=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" />
        <path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7" />
        <path d="M7 3v4a1 1 0 0 0 1 1h7" />
    </svg>
`.trim(),zi=`
    <svg
        class="pf-icon pf-nav-icon"
        aria-hidden="true"
        focusable="false"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m12 5 7 7-7 7" />
        <path d="M5 12h14" />
    </svg>
`.trim(),ub=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m9 12 2 2 4-4"/>
    </svg>
`.trim(),db=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" x2="12" y1="8" y2="12"/>
        <line x1="12" x2="12.01" y1="16" y2="16"/>
    </svg>
`.trim(),hb=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/>
        <path d="M12 9v4"/>
        <path d="M12 17h.01"/>
    </svg>
`.trim(),pb=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 16v-4"/>
        <path d="M12 8h.01"/>
    </svg>
`.trim(),mb=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="M21.801 10A10 10 0 1 1 17 3.335"/>
        <path d="m9 11 3 3L22 4"/>
    </svg>
`.trim(),gb=`
    <svg
        class="pf-icon pf-status-icon"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="m15 9-6 6"/>
        <path d="m9 9 6 6"/>
    </svg>
`.trim(),xb=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m18 9-6-6-6 6"/>
        <path d="M12 3v14"/>
        <path d="M5 21h14"/>
    </svg>
`.trim(),vb=`
    <svg
        class="pf-icon pf-mismatch-icon-svg"
        aria-hidden="true"
        focusable="false"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m6 15 6 6 6-6"/>
        <path d="M12 21V7"/>
        <path d="M5 3h14"/>
    </svg>
`.trim(),Xi=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
        <path d="M21 3v5h-5"/>
        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
        <path d="M3 21v-5h5"/>
    </svg>
`.trim(),mk=`
    <svg
        class="pf-icon pf-action-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M3 6h18"/>
        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
        <line x1="10" x2="10" y1="11" y2="17"/>
        <line x1="14" x2="14" y1="11" y2="17"/>
    </svg>
`.trim(),Uo=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M18 6 6 18"/>
        <path d="m6 6 12 12"/>
    </svg>
`.trim(),$f=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
        <circle cx="12" cy="12" r="3"/>
    </svg>
`.trim(),jf=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>
        <path d="M14 2v4a2 2 0 0 0 2 2h4"/>
        <path d="M10 9H8"/>
        <path d="M16 13H8"/>
        <path d="M16 17H8"/>
    </svg>
`.trim(),yb=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/>
        <path d="M2 12h20"/>
    </svg>
`.trim(),wb=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="3" y="3" width="18" height="18" rx="2"/>
        <path d="M3 9h18"/>
        <path d="M3 15h18"/>
        <path d="M9 3v18"/>
        <path d="M15 3v18"/>
    </svg>
`.trim(),_b=`
    <svg
        class="pf-icon pf-nav-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true"
        focusable="false"
    >
        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
        <path d="M12 11h4"/>
        <path d="M12 16h4"/>
        <path d="M8 11h.01"/>
        <path d="M8 16h.01"/>
    </svg>
`.trim();function Xn(e){return e==null?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function gr(e,r){return`
        <div class="pf-labeled-btn">
            ${e}
            <span class="pf-btn-label">${r}</span>
        </div>
    `}function Za({textareaId:e,value:r,permanentId:t,isPermanent:a,hintId:n,saveButtonId:i,isSaved:s=!1,placeholder:o="Enter notes here..."}){let c=a?Bo:Lo,l=i?`<button type="button" class="pf-action-toggle pf-save-btn ${s?"is-saved":""}" id="${i}" data-save-input="${e}" title="Save notes">${Uf}</button>`:"",f=t?`<button type="button" class="pf-action-toggle pf-notes-lock ${a?"is-locked":""}" id="${t}" aria-pressed="${a}" title="Lock notes (retain after archive)">${c}</button>`:"";return`
        <article class="pf-step-card pf-step-detail pf-notes-card">
            <div class="pf-notes-header">
                <div>
                    <h3 class="pf-notes-title">Notes</h3>
                    <p class="pf-notes-subtext">Leave notes your future self will appreciate. Notes clear after archiving. Click lock to retain permanently.</p>
                </div>
            </div>
            <div class="pf-notes-body">
                <textarea id="${e}" rows="6" placeholder="${Xn(o)}">${Xn(r||"")}</textarea>
                ${n?`<p class="pf-signoff-hint" id="${n}"></p>`:""}
            </div>
            <div class="pf-notes-action">
                ${t?gr(f,"Lock"):""}
                ${i?gr(l,"Save"):""}
            </div>
        </article>
    `}function Qa({reviewerInputId:e,reviewerValue:r,signoffInputId:t,signoffValue:a,isComplete:n,saveButtonId:i,isSaved:s=!1,completeButtonId:o,subtext:c="Sign-off below. Click checkmark icon. Done.",prevButtonId:l=null,nextButtonId:f=null}){let d=l||`${o}-prev`,u=f||`${o}-next`,p=`<button type="button" class="pf-action-toggle ${n?"is-active":""}" id="${o}" aria-pressed="${!!n}" title="Mark step complete">${Wi}</button>`,m=`<button type="button" class="pf-action-toggle pf-nav-toggle" id="${d}" title="Previous step">${Gi}</button>`,h=`<button type="button" class="pf-action-toggle pf-nav-toggle" id="${u}" title="Next step">${zi}</button>`;return`
        <article class="pf-step-card pf-step-detail pf-config-card">
            <div class="pf-config-head pf-notes-header">
                <div>
                    <h3>Sign-off</h3>
                    <p class="pf-config-subtext">${Xn(c)}</p>
                </div>
            </div>
            <div class="pf-config-grid">
                <label class="pf-config-field">
                    <span>Reviewer Name</span>
                    <input type="text" id="${e}" value="${Xn(r)}" placeholder="Full name">
                </label>
                <label class="pf-config-field">
                    <span>Sign-off Date</span>
                    <input type="date" id="${t}" value="${Xn(a)}" readonly>
                </label>
            </div>
            <div class="pf-signoff-action">
                ${m?gr(m,"Prev"):""}
                ${gr(p,"Done")}
                ${h?gr(h,"Next"):""}
            </div>
        </article>
    `}function $o(e,r){e&&(e.classList.toggle("is-locked",r),e.setAttribute("aria-pressed",String(r)),e.innerHTML=r?Bo:Lo)}function Gr(e,r){e&&e.classList.toggle("is-saved",r)}function jo(e=document){let r=e.querySelectorAll(".pf-save-btn[data-save-input]"),t=[];return r.forEach(a=>{let n=a.getAttribute("data-save-input"),i=document.getElementById(n);if(!i)return;let s=()=>{Gr(a,!1)};i.addEventListener("input",s),t.push(()=>i.removeEventListener("input",s))}),()=>t.forEach(a=>a())}function Hf(e,r){if(e===0)return{canComplete:!0,blockedBy:null,message:""};for(let t=0;t<e;t++)if(!r[t])return{canComplete:!1,blockedBy:t,message:`Complete Step ${t} before signing off on this step.`};return{canComplete:!0,blockedBy:null,message:""}}function Vf(e){let r=document.querySelector(".pf-workflow-toast");r&&r.remove();let t=document.createElement("div");t.className="pf-workflow-toast pf-workflow-toast--warning",t.innerHTML=`
        <span class="pf-workflow-toast-icon">\u26A0\uFE0F</span>
        <span class="pf-workflow-toast-message">${e}</span>
    `,document.body.appendChild(t),requestAnimationFrame(()=>{t.classList.add("pf-workflow-toast--visible")}),setTimeout(()=>{t.classList.remove("pf-workflow-toast--visible"),setTimeout(()=>t.remove(),300)},4e3)}var Ho={fillColor:"#000000",fontColor:"#FFFFFF",bold:!0},Yi={currency:"$#,##0.00",currencyWithNegative:"$#,##0.00;($#,##0.00)",number:"#,##0.00",integer:"#,##0",percent:"0.00%",date:"yyyy-mm-dd",dateTime:"yyyy-mm-dd hh:mm"};function en(e){e.format.fill.color=Ho.fillColor,e.format.font.color=Ho.fontColor,e.format.font.bold=Ho.bold}function Yn(e,r,t,a=!1){if(t<=0)return;let n=e.getRangeByIndexes(1,r,t,1);n.numberFormat=[[a?Yi.currencyWithNegative:Yi.currency]]}function tn(e,r,t){if(t<=0)return;let a=e.getRangeByIndexes(1,r,t,1);a.numberFormat=[[Yi.number]]}function Wf(e,r,t,a=Yi.date){if(t<=0)return;let n=e.getRangeByIndexes(1,r,t,1);n.numberFormat=[[a]]}var gk="4423568",oa="pto-accrual";var nn="PTO Accrual",Ko="https://jgciqwzwacaesqjaoadc.supabase.co",an="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE";function Ne(e,r="info",t=4e3){document.querySelectorAll(".pf-toast").forEach(n=>n.remove());let a=document.createElement("div");if(a.className=`pf-toast pf-toast--${r}`,a.innerHTML=`
        <div class="pf-toast-content">
            <span class="pf-toast-icon">${r==="success"?"\u2705":r==="error"?"\u274C":"\u2139\uFE0F"}</span>
            <span class="pf-toast-message">${e.replace(/\n/g,"<br>")}</span>
        </div>
        <button class="pf-toast-close" onclick="this.parentElement.remove()">\xD7</button>
    `,!document.getElementById("pf-toast-styles")){let n=document.createElement("style");n.id="pf-toast-styles",n.textContent=`
            .pf-toast {
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #1a1a2e;
                color: white;
                padding: 16px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 90%;
                display: flex;
                align-items: flex-start;
                gap: 12px;
                animation: toastIn 0.3s ease;
            }
            .pf-toast--success { border-left: 4px solid #22c55e; }
            .pf-toast--error { border-left: 4px solid #ef4444; }
            .pf-toast--info { border-left: 4px solid #3b82f6; }
            .pf-toast-content { display: flex; align-items: flex-start; gap: 8px; flex: 1; }
            .pf-toast-icon { font-size: 18px; }
            .pf-toast-message { font-size: 14px; line-height: 1.4; }
            .pf-toast-close { background: none; border: none; color: #888; font-size: 20px; cursor: pointer; padding: 0; margin-left: 8px; }
            .pf-toast-close:hover { color: white; }
            @keyframes toastIn { from { opacity: 0; transform: translateX(-50%) translateY(-20px); } }
        `,document.head.appendChild(n)}return document.body.appendChild(a),t>0&&setTimeout(()=>a.remove(),t),a}var xk="Calculate your PTO liability, compare against last period, and generate a balanced journal entry\u2014all without leaving Excel.",vk="../module-selector/index.html",yk="pf-loader-overlay",ca=["SS_PF_Config"],_e={payrollProvider:"PTO_Payroll_Provider",payrollDate:"PTO_Analysis_Date",accountingPeriod:"PTO_Accounting_Period",journalEntryId:"PTO_Journal_Entry_ID",companyName:"SS_Company_Name",accountingSoftware:"SS_Accounting_Software",reviewerName:"PTO_Reviewer",validationDataBalance:"PTO_Validation_Data_Balance",validationCleanBalance:"PTO_Validation_Clean_Balance",validationDifference:"PTO_Validation_Difference",headcountRosterCount:"PTO_Headcount_Roster_Count",headcountPayrollCount:"PTO_Headcount_Payroll_Count",headcountDifference:"PTO_Headcount_Difference",journalDebitTotal:"PTO_JE_Debit_Total",journalCreditTotal:"PTO_JE_Credit_Total",journalDifference:"PTO_JE_Difference"},Fa="User opted to skip the headcount review this period.",es={0:{note:"PTO_Notes_Config",reviewer:"PTO_Reviewer_Config",signOff:"PTO_SignOff_Config"},1:{note:"PTO_Notes_Upload",reviewer:"PTO_Reviewer_Upload",signOff:"PTO_SignOff_Upload"},2:{note:"PTO_Notes_Review",reviewer:"PTO_Reviewer_Review",signOff:"PTO_SignOff_Review"},3:{note:"PTO_Notes_JE",reviewer:"PTO_Reviewer_JE",signOff:"PTO_SignOff_JE"},4:{note:"PTO_Notes_Archive",reviewer:"PTO_Reviewer_Archive",signOff:"PTO_SignOff_Archive"}},ou={0:"PTO_Complete_Config",1:"PTO_Complete_Upload",2:"PTO_Complete_Review",3:"PTO_Complete_JE",4:"PTO_Complete_Archive"};var vr=[{id:0,title:"Configuration",summary:"Auto-loaded from system. Review period-specific settings before each run.",description:"Configuration is loaded from your installation. Only period-specific fields (analysis date, accounting period) need review each run.",actionLabel:"Review Configuration",icon:"\u{1F9ED}",secondaryAction:{sheet:"SS_PF_Config",label:"Open Config Sheet"}},{id:1,title:"Upload & Validate PTO Data",summary:"Import PTO report, normalize headers, and run validation checks.",description:"Upload your Obsidian PTO report, auto-map headers using ada_payroll_dimensions, create PTO_Data_Clean, and review advisory validation checks.",actionLabel:"Upload PTO Report",icon:"\u{1F4E5}",secondaryAction:{sheet:"PTO_Data_Clean",label:"Open Clean Data"}},{id:2,title:"PTO Accrual Review",summary:"Review accrued, used, and balance metrics with executive-ready summary.",description:"Analyze PTO data grouped by employee and plan. Review totals, trends, and variances using PTO_Data_Clean as the source of truth.",actionLabel:"Generate Review",icon:"\u{1F4CA}",secondaryAction:{sheet:"PTO_Review",label:"Open Review Sheet"}},{id:3,title:"Journal Entry Prep",summary:"Generate accounting-ready journal entry output.",description:"Create journal entry draft using PTO_Data_Clean and GL mappings. Produces output ready for QuickBooks or your accounting system.",actionLabel:"Generate JE Draft",icon:"\u{1F9FE}",secondaryAction:{sheet:"PTO_JE_Draft",label:"Open JE Draft"}},{id:4,title:"Archive & Clear",summary:"Archive the period and reset for next run.",description:"Save a snapshot of this period's work, then clear working tabs to prepare for the next PTO analysis cycle.",actionLabel:"Archive Period",icon:"\u{1F5C2}\uFE0F",secondaryAction:{sheet:"PTO_Archive_Summary",label:"Open Archive"}}],wk={0:"PTO_Homepage",1:"PTO_Data_Clean",2:"PTO_Review",3:"PTO_JE_Draft",4:"PTO_Archive_Summary"};function Xo(e){if(typeof e=="number")return e;if(!e)return 0;let r=String(e).replace(/[$,]/g,"").trim(),t=parseFloat(r);return isNaN(t)?0:t}var _k=vr.reduce((e,r)=>(e[r.id]="pending",e),{}),rt={activeView:"home",activeStepId:null,focusedIndex:0,stepStatuses:_k},Ae={loaded:!1,steps:{},permanents:{},completes:{},values:{},overrides:{accountingPeriod:!1,journalId:!1}},Kn=null,Vo=null,qi=null,rn=new Map,De={skipAnalysis:!1,loading:!1,hasAnalyzed:!1,lastError:null,rosterCount:0,ptoCount:0,missingFromPto:[],extraInPto:[],roster:{rosterCount:null,payrollCount:null,difference:null,mismatches:[]}},Qe={debitTotal:null,creditTotal:null,difference:null,lineAmountSum:null,analysisChangeTotal:null,jeChangeTotal:null,loading:!1,lastError:null,validationRun:!1,issues:[]},ut={hasRun:!1,loading:!1,acknowledged:!1,balanceIssues:[],zeroBalances:[],accrualOutliers:[],totalIssues:0,totalEmployees:0,expandedSections:new Set},yr={cleanDataReady:!1,employeeCount:0,lastRun:null,loading:!1,lastError:null,missingPayRates:[],missingDepartments:[],ignoredMissingPayRates:new Set,completenessCheck:{accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null}},Je={loaded:!1,loading:!1,lastRun:null,totalCurrentLiability:0,totalPriorLiability:0,netChange:0,employeeCount:0,reconciliation:{reportLiabilityTotal:0,calcLiabilityTotal:0,negativeBalanceTotal:0,negativeBalanceCount:0,positiveBalanceCount:0,zeroBalanceCount:0,missingRateCount:0},coverage:{rosterCount:0,ptoReportCount:0,inBothCount:0,inPtoOnlyCount:0,inPtoOnlyNames:[],inPtoOnlyLiability:0,inRosterOnlyCount:0,inRosterOnlyNames:[]},reviewData:[],flagThresholds:{largeMove:500}},Re={loaded:!1,loading:!1,error:null,company_id:null,ss_company_name:null,pto_payroll_provider:null,ss_accounting_software:null,isValid:!1,validationErrors:[]};async function kk(){console.log("[PTO] Loading installation configuration from SS_PF_Config..."),Re.loading=!0,Re.error=null,Re.validationErrors=[];try{if(!xt())throw new Error("Excel runtime not available.");let e=await ai(["SS_PF_Config"]);console.log("[PTO] Config values loaded:",e),Re.company_id=(e==null?void 0:e.SS_Company_ID)||null,Re.ss_company_name=(e==null?void 0:e.SS_Company_Name)||null,Re.pto_payroll_provider=(e==null?void 0:e.PTO_Payroll_Provider)||null,Re.ss_accounting_software=(e==null?void 0:e.SS_Accounting_Software)||null,Ek(),Re.loaded=!0,Re.loading=!1,console.log("[PTO] Installation config loaded successfully:",{company_id:Re.company_id,company_name:Re.ss_company_name,provider:Re.pto_payroll_provider,isValid:Re.isValid})}catch(e){console.error("[PTO] Failed to load installation:",e),Re.error=e.message,Re.loading=!1,Re.loaded=!0,Re.isValid=!1,Re.validationErrors.push(e.message)}}function Ek(){Re.validationErrors=[],Re.company_id||Re.validationErrors.push("Company ID is not configured. Please open Module Selector to sync your configuration."),Re.isValid=Re.validationErrors.length===0,Re.isValid||console.error("[PTO] Installation validation failed:",Re.validationErrors)}async function bk(){if(xt())try{await Excel.run(async e=>{let r=e.workbook.worksheets;r.load("items/name"),await e.sync();let t=r.getItemOrNullObject("SS_PF_Config");if(t.load("isNullObject"),await e.sync(),t.isNullObject){console.log("[PTO] Creating SS_PF_Config sheet..."),t=r.add("SS_PF_Config");let a=["Category","Field","Value","Permanent"],n=t.getRange("A1:D1");n.values=[a],en(n);let i=[["module-prefix","PR_","payroll-recorder","Y"],["module-prefix","PTO_","pto-accrual","Y"],["module-prefix","SS_","system","Y"],["Run Settings","SS_Company_Name","","Y"],["Run Settings","SS_Company_ID","","Y"]],s=t.getRange(`A2:D${1+i.length}`);s.values=i,await e.sync();let o=t.getRange(`A1:D${1+i.length}`),c=t.tables.add(o,!0);c.name="SS_PF_Config",c.style="TableStyleMedium2",o.format.autofitColumns(),await e.sync(),console.log("[PTO] SS_PF_Config sheet and table created")}else{let a=e.workbook.tables;if(a.load("items/name"),await e.sync(),!a.items.some(i=>i.name==="SS_PF_Config")){console.log("[PTO] SS_PF_Config sheet exists but no table - creating table...");let i=t.getUsedRangeOrNullObject();if(i.load("address,rowCount"),await e.sync(),!i.isNullObject&&i.rowCount>0){let s=t.tables.add(i,!0);s.name="SS_PF_Config",s.style="TableStyleMedium2",await e.sync(),console.log("[PTO] SS_PF_Config table created from existing data")}else{let s=["Category","Field","Value","Permanent"],o=t.getRange("A1:D1");o.values=[s],o.format.font.bold=!0;let c=[["module-prefix","PR_","payroll-recorder","Y"],["module-prefix","PTO_","pto-accrual","Y"],["module-prefix","SS_","system","Y"],["Run Settings","SS_Company_Name","","Y"],["Run Settings","SS_Company_ID","","Y"]],l=t.getRange(`A2:D${1+c.length}`);l.values=c,await e.sync();let f=t.getRange(`A1:D${1+c.length}`),d=t.tables.add(f,!0);d.name="SS_PF_Config",d.style="TableStyleMedium2",f.format.autofitColumns(),await e.sync(),console.log("[PTO] SS_PF_Config table created with default data")}}}})}catch(e){console.error("[PTO] Error ensuring config sheet:",e)}}async function Tk(){var e;try{Kn=document.getElementById("app"),Vo=document.getElementById("loading"),await bk(),await kk(),Re.isValid||(console.warn("[PTO] Installation config incomplete:",Re.validationErrors),console.warn("[PTO] Continuing anyway - some features may be limited")),await Ck(),await cu(),(e=window.PrairieForge)!=null&&e.loadSharedConfig&&await window.PrairieForge.loadSharedConfig();let r=ci(oa);await oi(r.sheetName,r.title,r.subtitle),await Sk(),Vo&&Vo.remove(),Kn&&(Kn.hidden=!1),wt()}catch(r){throw console.error("[PTO] Module initialization failed:",r),r}}async function Sk(){console.log("[PTO] Worksheet change listener disabled (one-way sync mode)")}async function Ck(){try{await ni(oa),console.log(`[PTO] Tab visibility applied for ${oa}`)}catch(e){console.warn("[PTO] Could not apply tab visibility:",e)}}async function cu(){var e;if(!xt()){Ae.loaded=!0;return}try{let r=await ai(ca),t={};(e=window.PrairieForge)!=null&&e.loadSharedConfig&&(await window.PrairieForge.loadSharedConfig(),window.PrairieForge._sharedConfigCache&&window.PrairieForge._sharedConfigCache.forEach((i,s)=>{t[s]=i}));let a={...r},n={SS_Default_Reviewer:_e.reviewerName,Default_Reviewer:_e.reviewerName,PTO_Reviewer:_e.reviewerName,SS_Company_Name:_e.companyName,Company_Name:_e.companyName,SS_Payroll_Provider:_e.payrollProvider,Payroll_Provider_Link:_e.payrollProvider,SS_Accounting_Software:_e.accountingSoftware,Accounting_Software_Link:_e.accountingSoftware};Object.entries(n).forEach(([i,s])=>{t[i]&&!a[s]&&(a[s]=t[i])}),Object.entries(t).forEach(([i,s])=>{i.startsWith("PTO_")&&s&&(a[i]=s)}),Ae.permanents=await Ak(),Ae.values=a||{},Ae.overrides.accountingPeriod=!!(a!=null&&a[_e.accountingPeriod]),Ae.overrides.journalId=!!(a!=null&&a[_e.journalEntryId]),Object.entries(es).forEach(([i,s])=>{var o,c,l;Ae.steps[i]={notes:(o=a[s.note])!=null?o:"",reviewer:(c=a[s.reviewer])!=null?c:"",signOffDate:(l=a[s.signOff])!=null?l:""}}),Ae.completes=Object.entries(ou).reduce((i,[s,o])=>{var c;return i[s]=(c=a[o])!=null?c:"",i},{}),Ae.loaded=!0}catch(r){console.warn("PTO: unable to load configuration fields",r),Ae.loaded=!0}}async function Ak(){let e={};if(!xt())return e;let r=new Map;Object.entries(es).forEach(([t,a])=>{a.note&&r.set(a.note.trim(),Number(t))});try{await Excel.run(async t=>{let a=t.workbook.tables.getItemOrNullObject(ca[0]);if(await t.sync(),a.isNullObject)return;let n=a.getDataBodyRange(),i=a.getHeaderRowRange();n.load("values"),i.load("values"),await t.sync();let o=(i.values[0]||[]).map(l=>String(l||"").trim().toLowerCase()),c={field:o.findIndex(l=>l==="field"||l==="field name"||l==="setting"),permanent:o.findIndex(l=>l==="permanent"||l==="persist")};c.field===-1||c.permanent===-1||(n.values||[]).forEach(l=>{let f=String(l[c.field]||"").trim(),d=r.get(f);if(d==null)return;let u=jE(l[c.permanent]);e[d]=u})})}catch(t){console.warn("PTO: unable to load permanent flags",t)}return e}function Ok(){let e=document.getElementById("quick-access-modal");e&&e.remove();let r=document.createElement("div");r.id="quick-access-modal",r.className="pf-quick-modal hidden",r.style.cssText="position:fixed!important;top:0;left:0;right:0;bottom:0;z-index:2147483647;",r.innerHTML=`
        <div class="pf-quick-modal-backdrop" data-close></div>
        <div class="pf-quick-modal-card">
            <div class="pf-quick-modal-header">
                <h3 class="pf-quick-modal-title">Quick Access</h3>
                <button id="quick-access-close" class="pf-quick-modal-close pf-clickable" type="button" aria-label="Close">
                    ${Uo}
                </button>
            </div>
            <div class="pf-quick-modal-items">
                ${Re.pto_payroll_provider?`
                <a id="nav-provider-link" class="pf-quick-modal-item pf-clickable" href="${be(Re.pto_payroll_provider)}" target="_blank" rel="noopener">
                    ${jf}
                    <span>PTO Provider Report</span>
                </a>
                `:""}
                <button id="nav-accounting-software" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Mo}
                    <span>Accounting Software</span>
                </button>
                <button id="nav-employee-roster" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Nf}
                    <span>Employee Roster</span>
                </button>
                <button id="nav-chart-of-accounts" class="pf-quick-modal-item pf-clickable" type="button">
                    ${Df}
                    <span>Chart of Accounts</span>
                </button>
                <button id="nav-config" class="pf-quick-modal-item pf-clickable" type="button">
                    ${$f}
                    <span>Configuration</span>
                </button>
            </div>
        </div>
    `,document.body.appendChild(r)}function wt(){var o;if(!Kn)return;let e=rt.focusedIndex<=0?"disabled":"",r=rt.focusedIndex>=vr.length-1?"disabled":"",t=rt.activeView==="step"&&rt.activeStepId!=null,n=rt.activeView==="config"?lu():t?Hk(rt.activeStepId):`${Ik()}${Pk()}`;Kn.innerHTML=`
        <div class="pf-root">
            <div class="pf-brand-float" aria-hidden="true">
                <span class="pf-brand-wave"></span>
            </div>
            <header class="pf-banner">
                <div class="pf-nav-bar">
                    <button id="nav-prev" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Previous step" ${e}>
                        ${Gi}
                        <span class="sr-only">Previous step</span>
                    </button>
                    <button id="nav-home" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Home">
                        ${If}
                        <span class="sr-only">Module Home</span>
                    </button>
                    <button id="nav-selector" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Module Selector">
                        ${Pf}
                        <span class="sr-only">Module Selector</span>
                    </button>
                    <button id="nav-next" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" aria-label="Next step" ${r}>
                        ${zi}
                        <span class="sr-only">Next step</span>
                    </button>
                    <div class="pf-nav-divider"></div>
                    <button id="nav-quick-toggle" class="pf-nav-btn pf-nav-btn--icon pf-clickable" type="button" title="Quick Access">
                        ${Rf}
                        <span class="sr-only">Quick Access Menu</span>
                    </button>
                </div>
            </header>
            ${n}
            <footer class="pf-brand-footer">
                <div class="pf-brand-text">
                    <div class="pf-brand-label">prairie.forge</div>
                    <div class="pf-brand-meta"> Prairie Forge LLC, 2025. All rights reserved. Version ${gk}</div>
                </div>
            </footer>
        </div>
    `;let i=rt.activeView==="home"||rt.activeView!=="step"&&rt.activeView!=="config",s=document.getElementById("pf-info-fab-pto");if(i)s&&s.remove();else if((o=window.PrairieForge)!=null&&o.mountInfoFab){let c=Fk(rt.activeStepId);PrairieForge.mountInfoFab({title:c.title,content:c.content,buttonId:"pf-info-fab-pto"})}Ok(),Vk(),Xk(),i?hc():hs()}function Fk(e){switch(e){case 0:return{title:"Configuration",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Configuration is auto-loaded from your installation. Review period-specific settings before each PTO run.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Auto-Loaded (Read-Only)</h4>
                        <ul>
                            <li><strong>Company Name</strong> \u2014 From your installation</li>
                            <li><strong>Company ID</strong> \u2014 Used for GL mapping lookups</li>
                            <li><strong>Company ID</strong> \u2014 Required for GL mappings</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4DD} Period-Specific (Editable)</h4>
                        <ul>
                            <li><strong>Analysis Date</strong> \u2014 The period-end date (e.g., 11/30/2024)</li>
                            <li><strong>Accounting Period</strong> \u2014 Shows up in your JE description</li>
                            <li><strong>Journal Entry ID</strong> \u2014 Reference number for your accounting system</li>
                        </ul>
                    </div>
                `};case 1:return{title:"Upload & Validate PTO Data",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Upload your Obsidian PTO export, auto-normalize headers, create PTO_Data_Clean, and run advisory validation checks.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4E5} Upload Process</h4>
                        <ol>
                            <li>Download your PTO report from Obsidian</li>
                            <li>Click Upload and select the file</li>
                            <li>Headers are auto-normalized using ada_payroll_dimensions</li>
                            <li>PTO_Data_Clean is created with standardized columns</li>
                        </ol>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u2705 Validation Checks (Advisory)</h4>
                        <ul>
                            <li><strong>Employee Coverage</strong> \u2014 Compare against SS_Employee_Roster</li>
                            <li><strong>Data Quality</strong> \u2014 Negative balances, outliers, date consistency</li>
                        </ul>
                        <p class="pf-info-note">Validation is advisory and does not block the workflow.</p>
                    </div>
                `};case 2:return{title:"PTO Accrual Review",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Review PTO accrual metrics with an executive-ready summary. Uses PTO_Data_Clean as the single source of truth.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CA} Key Measures</h4>
                        <ul>
                            <li><strong>Accrual Rate</strong> \u2014 Hours accrued per pay period</li>
                            <li><strong>Carry Over</strong> \u2014 Hours carried from prior year</li>
                            <li><strong>YTD Accrued / Used</strong> \u2014 Year-to-date totals</li>
                            <li><strong>Pay Period Accrued / Used</strong> \u2014 Current period activity</li>
                            <li><strong>Balance</strong> \u2014 Current available hours</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4C8} Analysis View</h4>
                        <p>Data is grouped by Employee Name and Plan Description for detailed review.</p>
                    </div>
                `};case 3:return{title:"Journal Entry Prep",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Generates accounting-ready journal entry output from your PTO analysis.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4DD} JE Generation</h4>
                        <ul>
                            <li>Uses PTO_Data_Clean as the data source</li>
                            <li>GL accounts resolved via ada_customer_gl_mappings</li>
                            <li>Output ready for QuickBooks or your accounting system</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u2705 Validation</h4>
                        <ul>
                            <li><strong>Debits = Credits</strong> \u2014 Entry must balance</li>
                            <li><strong>All rows mapped</strong> \u2014 Every line has a GL account</li>
                        </ul>
                    </div>
                `};case 4:return{title:"Archive & Clear",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F3AF} What This Step Does</h4>
                        <p>Archive this period's results and reset working tabs for the next PTO cycle.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4E6} What Gets Archived</h4>
                        <ul>
                            <li><strong>PTO_Archive_Summary</strong> \u2014 Rolling summary of last 5 periods</li>
                            <li><strong>Excel Workbook</strong> \u2014 Full snapshot saved externally</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F9F9} What Gets Cleared</h4>
                        <ul>
                            <li>PTO_Data_Clean</li>
                            <li>PTO_Review</li>
                            <li>PTO_JE_Draft</li>
                        </ul>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u26A0\uFE0F Important</h4>
                        <p>Ensure you've exported any needed files before clearing. The external workbook is your permanent backup.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4A1} Tip</h4>
                        <p>Make sure your JE has been uploaded to your accounting system before archiving.</p>
                    </div>
                `};default:return{title:"PTO Accrual",content:`
                    <div class="pf-info-section">
                        <h4>\u{1F44B} Welcome to PTO Accrual</h4>
                        <p>This module helps you calculate PTO liabilities and generate journal entries each period.</p>
                    </div>
                    <div class="pf-info-section">
                        <h4>\u{1F4CB} Workflow Overview</h4>
                        <ol style="margin: 8px 0; padding-left: 20px;">
                            <li>Review period configuration (auto-loaded)</li>
                            <li>Upload & validate PTO data</li>
                            <li>Review PTO accrual metrics</li>
                            <li>Generate journal entry</li>
                            <li>Archive & clear for next period</li>
                        </ol>
                    </div>
                    <div class="pf-info-section">
                        <p>Click a step card to get started, or tap the <strong>\u24D8</strong> button on any step for detailed guidance.</p>
                    </div>
                `}}}function Ik(){return`
        <section class="pf-hero" id="pf-hero">
            <h2 class="pf-hero-title">PTO Accrual</h2>
            <p class="pf-hero-copy">${xk}</p>
        </section>
    `}function Pk(){return`
        <section class="pf-step-guide">
            <div class="pf-step-grid">
                ${vr.map((e,r)=>Rk(e,r)).join("")}
            </div>
        </section>
    `}function Rk(e,r){let t=rt.stepStatuses[e.id]||"pending",a=rt.activeView==="step"&&rt.focusedIndex===r?"pf-step-card--active":"",n=Lf(BE(e.id));return`
        <article class="pf-step-card pf-clickable ${a}" data-step-card data-step-index="${r}" data-step-id="${e.id}">
            <p class="pf-step-index">Step ${e.id}</p>
            <h3 class="pf-step-title">${n?`${n}`:""}${e.title}</h3>
        </article>
    `}function Nk(e){let r=vr.filter(i=>i.id!==4).map(i=>({id:i.id,title:i.title,complete:Yk(i.id)})),t=r.every(i=>i.complete),a=r.filter(i=>!i.complete).length,n=r.map(i=>`
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head pf-notes-header">
                    <span class="pf-action-toggle ${i.complete?"is-active":""}" aria-pressed="${i.complete}">
                        ${Wi}
                    </span>
                    <div>
                        <h3>${be(i.title)}</h3>
                        <p class="pf-config-subtext">${i.complete?"Complete":"Not complete"}</p>
                    </div>
                </div>
            </article>
        `).join("");return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${be(nn)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${be(e.title)}</h2>
            <p class="pf-hero-copy">${be(e.summary||"")}</p>
            <p class="pf-hero-hint"></p>
        </section>
        <section class="pf-step-guide">
            ${n}
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Archive & Reset</h3>
                    <p class="pf-config-subtext">Create an archive of this module's sheets and clear work tabs.</p>
                </div>
                ${t?"":`<p class="pf-step-note pf-step-note--info">\u26A0\uFE0F Complete all ${a} remaining step(s) before archiving.</p>`}
                <div class="pf-pill-row pf-config-actions">
                    <button type="button" class="pf-pill-btn" id="archive-run-btn" ${t?"":"disabled"}>Archive</button>
                </div>
            </article>
        </section>
    `}function lu(){if(!Ae.loaded)return`
            <section class="pf-step-guide">
                <article class="pf-step-card pf-step-detail">
                    <p class="pf-step-title">Loading configuration\u2026</p>
                </article>
            </section>
        `;let e=tu($t(_e.payrollDate)),r=tu($t(_e.accountingPeriod)),t=$t(_e.journalEntryId),a=$t(_e.reviewerName),n=Re.ss_company_name||$t(_e.companyName)||"",i=Re.company_id||"",s=Re.pto_payroll_provider||"",o=Re.ss_accounting_software||$t(_e.accountingSoftware)||"",c=ti(0),l=!!Ae.permanents[0],f=!!(_u(Ae.completes[0])||c.signOffDate),d=ei(c==null?void 0:c.reviewer),u=(c==null?void 0:c.signOffDate)||"";return`
        <section class="pf-hero" id="pf-config-hero">
            <p class="pf-hero-copy">${be(nn)} | Step 0</p>
            <h2 class="pf-hero-title">Configuration Setup</h2>
            <p class="pf-hero-copy">Make quick adjustments before every PTO run.</p>
        </section>
        <section class="pf-step-guide">
            <!-- Period Data (User editable) - FIRST, matches payroll-recorder -->
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Period Data</h3>
                    <p class="pf-config-subtext">Fields in this section may change each period.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Your Name (Used for sign-offs)</span>
                        <input type="text" id="config-user-name" value="${be(a)}" placeholder="Full name">
                    </label>
                    <label class="pf-config-field">
                        <span>PTO Analysis Date</span>
                        <input type="date" id="config-payroll-date" value="${be(e)}">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Period</span>
                        <input type="text" id="config-accounting-period" value="${be(r)}" placeholder="Nov 2025">
                    </label>
                    <label class="pf-config-field">
                        <span>Journal Entry ID</span>
                        <input type="text" id="config-journal-id" value="${be(t)}" placeholder="PTO-AUTO-YYYY-MM-DD">
                    </label>
                </div>
            </article>
            
            <!-- Static Data - SECOND, matches payroll-recorder naming/structure -->
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Static Data</h3>
                    <p class="pf-config-subtext">Fields rarely change but should be reviewed.</p>
                </div>
                <div class="pf-config-grid">
                    <label class="pf-config-field">
                        <span>Company Name</span>
                        <input type="text" id="config-company-name" value="${be(n)}" placeholder="Prairie Forge LLC">
                    </label>
                    <label class="pf-config-field">
                        <span>Company ID <span class="pf-field-hint">(from Prairie Forge CRM)</span></span>
                        <input type="text" id="config-company-id" value="${be(i)}" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                    </label>
                    <label class="pf-config-field">
                        <span>PTO Provider / Report Location</span>
                        <input type="url" id="config-pto-provider" value="${be(s)}" placeholder="https://\u2026">
                    </label>
                    <label class="pf-config-field">
                        <span>Accounting Software / Import Location</span>
                        <input type="url" id="config-accounting-link" value="${be(o)}" placeholder="https://\u2026">
                    </label>
                </div>
            </article>
            
            ${Za({textareaId:"config-notes",value:c.notes||"",permanentId:"config-notes-lock",isPermanent:l,hintId:"",saveButtonId:"config-notes-save"})}
            ${Qa({reviewerInputId:"config-reviewer",reviewerValue:d,signoffInputId:"config-signoff-date",signoffValue:u,isComplete:f,saveButtonId:"config-signoff-save",completeButtonId:"config-signoff-toggle"})}
        </section>
    `}function Dk(){let e=Pe.file||Pe.headers.length>0,r=Pe.loading;return console.log("[PTO-Upload] renderPtoFileUploadZone state:",{hasFile:e,isLoading:r,file:Pe.file?Pe.fileName:null,headersLength:Pe.headers.length,headers:Pe.headers.slice(0,3)}),r?`
            <div class="pf-upload-zone pf-upload-zone--analyzing">
                <div class="pf-upload-spinner"></div>
                <p class="pf-upload-status">Processing your PTO report\u2026</p>
            </div>
        `:e?`
            <div class="pf-upload-zone pf-upload-zone--ready">
                <div class="pf-upload-file-info">
                    <svg class="pf-upload-file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                    </svg>
                    <div class="pf-upload-file-details">
                        <span class="pf-upload-filename">${be(Pe.fileName)}</span>
                        <span class="pf-upload-meta">${Pe.headers.length} columns \u2022 ${(Pe.rowCount||0).toLocaleString()} rows</span>
                    </div>
                    <button type="button" class="pf-upload-clear" id="pto-upload-clear-btn" title="Remove file">\xD7</button>
                </div>
            </div>
        `:`
        <div class="pf-upload-zone" id="pto-upload-dropzone">
            <input type="file" id="pto-upload-file-input" accept=".csv,.xlsx,.xls" hidden>
            <div class="pf-upload-content">
                <svg class="pf-upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="17 8 12 3 7 8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
                <p class="pf-upload-text">Drop your PTO file here</p>
                <p class="pf-upload-hint">or <button type="button" class="pf-upload-browse" id="pto-upload-browse-btn">browse</button> to upload</p>
                <p class="pf-upload-formats">Supports CSV, XLSX, XLS</p>
            </div>
        </div>
    `}function Lk(){let e=De.hasAnalyzed,r=De.loading,t=De.rosterCount||0,a=De.ptoCount||0,n=De.missingFromPto||[],i=De.extraInPto||[],s=e&&n.length===0&&i.length===0,o="",c="";r?o='<span class="pf-status-badge pf-status-badge--pending" role="status">\u23F3 Loading</span>':De.lastError?(o='<span class="pf-status-badge pf-status-badge--unavailable" role="status">\u26A0 Unavailable</span>',c="pf-coverage-unavailable"):e?s?(o='<span class="pf-status-badge pf-status-badge--ok" role="status">\u2713 OK</span>',c="pf-coverage-ok"):(o='<span class="pf-status-badge pf-status-badge--review" role="status">\u26A0 Review</span>',c="pf-coverage-review"):o='<span class="pf-status-badge pf-status-badge--pending" role="status">\u25CB Pending</span>';let l="";return r?l='<p class="pf-subsection-hint">Analyzing coverage...</p>':De.lastError?l=`<p class="pf-subsection-hint pf-subsection-hint--warn">${be(De.lastError)}</p>`:e?(l='<div class="pf-recon-container">',l+=`
            <div class="pf-recon-row pf-recon-row--header">
                <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="summary">Roster Headcount</button>
                <span class="pf-recon-value">${t}</span>
            </div>
        `,(n.length>0||i.length>0)&&(l+='<div class="pf-recon-changes">',n.length>0&&(l+=`
                    <div class="pf-recon-row pf-recon-row--subtract">
                        <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="missing">
                            <span class="pf-recon-operator">\u2212</span> Missing from PTO
                </button>
                        <span class="pf-recon-value pf-recon-value--subtract">(${n.length})</span>
                    </div>
            `),i.length>0&&(l+=`
                    <div class="pf-recon-row pf-recon-row--add">
                        <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="extra">
                            <span class="pf-recon-operator">+</span> In PTO only
                </button>
                        <span class="pf-recon-value pf-recon-value--add">${i.length}</span>
                    </div>
                `),l+="</div>"),l+='<div class="pf-recon-divider"></div>',l+=`
            <div class="pf-recon-row pf-recon-row--footer">
                <button type="button" class="pf-recon-label pf-clickable" data-pto-coverage-detail="summary">PTO File Headcount</button>
                <span class="pf-recon-value">${a}${s?" \u2713":""}</span>
            </div>
        `,l+="</div>",s?l+=`
                <div class="pf-coverage-item pf-coverage-item--ok" style="margin-top: 8px;">
                    <span class="pf-coverage-item-icon">\u2713</span>
                    <span>All roster employees found in PTO data</span>
                </div>
            `:l+='<p class="pf-coverage-hint">Click any row to see employee details</p>'):l='<p class="pf-subsection-hint">Upload a PTO file to run this check.</p>',`
        <article class="pf-step-card pf-step-detail pf-config-card pf-employee-coverage-card ${c}" id="pto-coverage-card">
            <div class="pf-config-head" style="display: flex; align-items: center;">
                <div>
                    <h3>Employee Coverage ${o}</h3>
                    <p class="pf-config-subtext">Compare PTO employees against roster.</p>
                </div>
                <button type="button" class="pf-action-toggle pf-action-toggle--subtle pf-clickable" id="pto-check-coverage-btn" title="Run coverage check" style="margin-left: auto;">
                    ${Xi}
                </button>
            </div>
            ${l}
        </article>
    `}function Bk(e){let r=De.rosterCount||0,t=De.ptoCount||0,a=De.missingFromPto||[],n=De.extraInPto||[],i="",s="";switch(e){case"summary":i="Coverage Summary",s=Mk(r,t,a,n);break;case"missing":i=`${a.length} Active Employees Not in PTO Data`,s=Gf(a,"These employees are marked active in the roster but were not found in the PTO data. Verify they should have PTO balances.");break;case"extra":i=`${n.length} In PTO Data Only`,s=Gf(n,"These employees are in the PTO data but not found in the active roster. They may be terminated, on leave, or the roster needs updating.");break;default:return}Uk(i,s)}function Mk(e,r,t,a){let n=r-e,i=n===0?"Match":n>0?`+${n}`:`${n}`,s=n===0?"match":"mismatch";return`
        <div class="pf-coverage-detail-summary">
            <h4>Headcount Bridge</h4>
            <div class="pf-headcount-bridge">
                <div class="pf-bridge-row pf-bridge-row--base">
                    <span class="pf-bridge-label">Active in Roster</span>
                    <span class="pf-bridge-value">${e}</span>
                </div>
                ${a.length>0?`
                <div class="pf-bridge-row pf-bridge-row--add">
                    <span class="pf-bridge-label">+ In PTO data only (not in roster)</span>
                    <span class="pf-bridge-value">+${a.length}</span>
                </div>
                `:""}
                ${t.length>0?`
                <div class="pf-bridge-row pf-bridge-row--subtract">
                    <span class="pf-bridge-label">\u2212 Active but not in PTO data</span>
                    <span class="pf-bridge-value">\u2212${t.length}</span>
                </div>
                `:""}
                <div class="pf-bridge-row pf-bridge-row--total">
                    <span class="pf-bridge-label">In PTO Data</span>
                    <span class="pf-bridge-value">${r}</span>
                </div>
                <div class="pf-bridge-row pf-bridge-row--diff pf-bridge-row--${s}">
                    <span class="pf-bridge-label">Difference</span>
                    <span class="pf-bridge-value">${i}</span>
                </div>
            </div>
            
            <h4 style="margin-top: 20px;">What to Review</h4>
            <ul class="pf-coverage-review-list">
                ${t.length>0?`<li><strong>${t.length} not in PTO</strong> \u2014 Verify these active employees should have PTO balances</li>`:""}
                ${a.length>0?`<li><strong>${a.length} PTO only</strong> \u2014 Check if these are terminated/on leave, or update roster via Payroll Recorder</li>`:""}
                ${t.length===0&&a.length===0?"<li>\u2713 No issues found \u2014 roster and PTO data are in sync</li>":""}
            </ul>
        </div>
    `}function Gf(e,r){if(!e||e.length===0)return`<p>${r}</p><p><em>No employees in this category.</em></p>`;let t=`<p style="margin-bottom: 16px;">${r}</p>`;return t+='<div class="pf-employee-list">',e.forEach((a,n)=>{let i=a.name||a,s=a.department||null;t+=`
            <div class="pf-employee-list-item">
                <span class="pf-employee-index">${n+1}.</span>
                <span class="pf-employee-name">${be(i)}</span>
                ${s?`<span class="pf-employee-dept">${be(s)}</span>`:""}
            </div>
        `}),t+="</div>",t}function Uk(e,r){let t=document.getElementById("pto-coverage-detail-modal");t&&t.remove();let a=document.createElement("div");a.id="pto-coverage-detail-modal",a.className="pf-coverage-modal",a.innerHTML=`
        <div class="pf-coverage-modal-backdrop" data-close></div>
        <div class="pf-coverage-modal-card">
            <div class="pf-coverage-modal-header">
                <h3 class="pf-coverage-modal-title">${be(e)}</h3>
                <button class="pf-coverage-modal-close pf-clickable" type="button" aria-label="Close" data-close>
                    ${Uo}
                </button>
            </div>
            <div class="pf-coverage-modal-body">
                ${r}
            </div>
        </div>
    `,document.body.appendChild(a),a.querySelectorAll("[data-close]").forEach(i=>{i.addEventListener("click",()=>a.remove())});let n=i=>{i.key==="Escape"&&(a.remove(),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n)}function Wo(e,r,t,a){if(!(t!=null&&t.length))return"";let n=ut.expandedSections.has(e),i=n?"\u25BC":"\u25B6",s=n?`<div class="pf-quality-issue-details">
            ${t.map(a).join("")}
           </div>`:"";return`
        <div class="pf-quality-issue-row">
            <button type="button" class="pf-quality-issue-toggle pf-clickable" data-quality-section="${e}">
                <span class="pf-quality-chevron">${i}</span>
                <span class="pf-quality-issue-label">${t.length} ${r}</span>
            </button>
            ${s}
        </div>
    `}function $k(){let e=ut.hasRun,r=ut.totalIssues||0,t=r===0,a=e?t?'<span class="pf-status-badge pf-status-badge--ok" role="status">\u2713 OK</span>':'<span class="pf-status-badge pf-status-badge--review" role="status">\u26A0 Review</span>':'<span class="pf-status-badge pf-status-badge--pending" role="status">\u25CB Pending</span>',n=e?t?`${ut.totalEmployees||0} employees checked, no issues found`:`Found ${r} potential issue${r!==1?"s":""} to review`:"Check for negative balances, outliers, and data anomalies.",i="";if(e&&!t){let o=[];o.push(Wo("balanceIssues","negative balance(s)",ut.balanceIssues,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--warn">
                <span class="pf-quality-issue-name">${be(l.name)}</span>
                <span class="pf-quality-issue-value">${be(l.issue)}</span>
            </div>`)),o.push(Wo("zeroBalances","zero balance(s)",ut.zeroBalances,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--info">
                <span class="pf-quality-issue-name">${be(l.name)}</span>
                <span class="pf-quality-issue-value">0 hrs balance</span>
            </div>`)),o.push(Wo("accrualOutliers","accrual rate outlier(s)",ut.accrualOutliers,l=>`<div class="pf-quality-issue-item pf-quality-issue-item--info">
                <span class="pf-quality-issue-name">${be(l.name)}</span>
                <span class="pf-quality-issue-value">${l.accrualRate.toFixed(2)} hrs/period</span>
            </div>`));let c=o.filter(l=>l).join("");c&&(i=`
                <div class="pf-quality-issues-container">
                    ${c}
                </div>
            `)}return`
        <article class="pf-step-card pf-step-detail pf-config-card" id="pto-quality-card">
            <div class="pf-config-head" style="display: flex; align-items: center;">
                <div>
                    <h3>Data Quality ${a}</h3>
                    <p class="pf-config-subtext">${n}</p>
                </div>
                <button type="button" class="pf-action-toggle pf-action-toggle--subtle pf-clickable" id="pto-check-quality-btn" title="Run quality check" style="margin-left: auto;">
                    ${Xi}
                </button>
            </div>
            ${i}
            ${e?"":'<p class="pf-metric-hint pf-metric-hint--info" style="margin-top: 12px; font-style: italic;">Upload a PTO file above to run this check.</p>'}
        </article>
    `}function jk(e){let r=ti(1),t=!!Ae.permanents[1],a=ei(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(ts(Ae.completes[1])||n),s=Pe.error?`<p class="pf-upload-error">${be(Pe.error)}</p>`:"";return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${be(nn)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">Upload & Validate PTO Data</h2>
            <p class="pf-hero-copy">Upload your PTO export, create the data matrix, and verify coverage.</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Import</h3>
                    <p class="pf-config-subtext">Drop your PTO file to auto-normalize headers.</p>
                </div>
                ${Dk()}
                ${s}
            </article>
            
            <div class="pf-validation-section">
                <h3 class="pf-validation-header">Validation</h3>
                <p class="pf-validation-subtext">Advisory checks \u2014 review but not required to proceed.</p>
                ${Lk()}
                ${$k()}
            </div>
            
            ${Za({textareaId:"step-notes-1",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-1",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-1"})}
            ${Qa({reviewerInputId:"step-reviewer-1",reviewerValue:a,signoffInputId:"step-signoff-1",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-1",completeButtonId:"step-signoff-toggle-1"})}
        </section>
    `}function Hk(e){let r=vr.find(o=>o.id===e);if(!r)return"";switch(e){case 0:return lu();case 1:return jk(r);case 2:return GE(r);case 3:return zE(r);case 4:return Nk(r)}let t=ti(e),a=!!Ae.permanents[e],n=ei(t==null?void 0:t.reviewer),i=(t==null?void 0:t.signOffDate)||"",s=!!(ts(Ae.completes[e])||i);return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${be(nn)} | Step ${r.id}</p>
            <h2 class="pf-hero-title">${be(r.title)}</h2>
            <p class="pf-hero-copy">${be(r.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            ${Za({textareaId:`step-notes-${e}`,value:(t==null?void 0:t.notes)||"",permanentId:`step-notes-lock-${e}`,isPermanent:a,hintId:"",saveButtonId:`step-notes-save-${e}`})}
            ${Qa({reviewerInputId:`step-reviewer-${e}`,reviewerValue:n,signoffInputId:`step-signoff-${e}`,signoffValue:i,isComplete:s,saveButtonId:`step-signoff-save-${e}`,completeButtonId:`step-signoff-toggle-${e}`})}
        </section>
    `}function Vk(){var i,s,o,c,l,f,d,u;(i=document.getElementById("nav-home"))==null||i.addEventListener("click",async()=>{var m;let p=ci(oa);await oi(p.sheetName,p.title,p.subtitle),Qn({activeView:"home",activeStepId:null}),(m=document.getElementById("pf-hero"))==null||m.scrollIntoView({behavior:"smooth",block:"start"})}),(s=document.getElementById("nav-selector"))==null||s.addEventListener("click",()=>{window.location.href=vk}),(o=document.getElementById("nav-prev"))==null||o.addEventListener("click",()=>Zi(-1)),(c=document.getElementById("nav-next"))==null||c.addEventListener("click",()=>Zi(1));let e=document.getElementById("nav-quick-toggle"),r=document.getElementById("quick-access-modal"),t=document.getElementById("quick-access-close"),a=r==null?void 0:r.querySelector("[data-close]"),n=()=>{r==null||r.classList.add("hidden"),e==null||e.classList.remove("is-active")};e==null||e.addEventListener("click",p=>{p.stopPropagation(),r==null||r.classList.toggle("hidden"),e.classList.toggle("is-active")}),t==null||t.addEventListener("click",n),a==null||a.addEventListener("click",n),(l=document.getElementById("nav-accounting-software"))==null||l.addEventListener("click",async()=>{n(),await gu()}),(f=document.getElementById("nav-employee-roster"))==null||f.addEventListener("click",async()=>{n(),await Pa("SS_Employee_Roster"),Ne("Opened Employee Roster","success",2e3)}),(d=document.getElementById("nav-chart-of-accounts"))==null||d.addEventListener("click",async()=>{n(),await Pa("SS_Chart_of_Accounts"),Ne("Opened Chart of Accounts","success",2e3)}),(u=document.getElementById("nav-config"))==null||u.addEventListener("click",async()=>{n(),await Pa("SS_PF_Config"),Ne("Opened Configuration","success",2e3)}),document.querySelectorAll("[data-step-card]").forEach(p=>{let m=Number(p.getAttribute("data-step-index")),h=Number(p.getAttribute("data-step-id"));p.addEventListener("click",()=>Zn(m,h))}),rt.activeView==="config"?Gk():rt.activeView==="step"&&rt.activeStepId!=null&&Wk(rt.activeStepId)}function Wk(e){var u,p,m,h,g,v,y,x,I,R,P,k,D,N,U,W,L,J,ue,te;let r=document.getElementById(`step-notes-${e}`),t=document.getElementById(`step-reviewer-${e}`),a=document.getElementById(`step-signoff-${e}`),n=document.getElementById("step-back-btn"),i=document.getElementById(`step-notes-lock-${e}`),s=document.getElementById(`step-notes-save-${e}`);s==null||s.addEventListener("click",async()=>{let ne=(r==null?void 0:r.value)||"";await xr(e,"notes",ne),Gr(s,!0)});let o=document.getElementById(`step-signoff-save-${e}`);o==null||o.addEventListener("click",async()=>{let ne=(t==null?void 0:t.value)||"";await xr(e,"reviewer",ne),Gr(o,!0)}),jo();let c=`step-signoff-toggle-${e}`,l=`${c}-prev`,f=`${c}-next`,d=`step-signoff-${e}`;if(wu(e,{buttonId:c,inputId:d,canActivate:null,onComplete:zk(e)}),du(l,f),e===2){let ne=document.querySelector('[data-copilot="pto-copilot"]');ne&&fs(ne,{id:"pto-copilot",contextProvider:si({dataClean:"PTO_Data_Clean",analysis:"PTO_Analysis",review:"PTO_Review",config:"SS_PF_Config"}),onPrompt:mu})}if(n==null||n.addEventListener("click",async()=>{let ne=ci(oa);await oi(ne.sheetName,ne.title,ne.subtitle),Qn({activeView:"home",activeStepId:null})}),i==null||i.addEventListener("click",async()=>{let ne=!i.classList.contains("is-locked");$o(i,ne),await vu(e,ne)}),e===4&&((u=document.getElementById("archive-run-btn"))==null||u.addEventListener("click",()=>{AE()})),e===1){let ne=document.getElementById("pto-upload-dropzone"),Q=document.getElementById("pto-upload-file-input"),xe=document.getElementById("pto-upload-browse-btn"),se=document.getElementById("pto-upload-clear-btn");console.log("[PTO-Upload] bindStepView Step 1 - Element check:",{dropzone:!!ne,fileInput:!!Q,browseBtn:!!xe,clearBtn:!!se}),ne&&(ne.addEventListener("click",()=>{console.log("[PTO-Upload] Dropzone clicked, opening file picker"),Q==null||Q.click()}),ne.addEventListener("dragover",X=>{X.preventDefault(),X.stopPropagation(),ne.classList.add("pf-upload-zone--dragover")}),ne.addEventListener("dragleave",X=>{X.preventDefault(),X.stopPropagation(),ne.classList.remove("pf-upload-zone--dragover")}),ne.addEventListener("drop",X=>{var b,B;X.preventDefault(),X.stopPropagation(),ne.classList.remove("pf-upload-zone--dragover");let M=(B=(b=X.dataTransfer)==null?void 0:b.files)==null?void 0:B[0];M&&qf(M)})),xe==null||xe.addEventListener("click",X=>{X.stopPropagation(),console.log("[PTO-Upload] Browse button clicked"),Q==null||Q.click()}),Q==null||Q.addEventListener("change",X=>{var b;let M=(b=X.target.files)==null?void 0:b[0];console.log("[PTO-Upload] File selected:",M==null?void 0:M.name),M&&qf(M)}),se==null||se.addEventListener("click",()=>{console.log("[PTO-Upload] Clear button clicked"),Pe.file=null,Pe.fileName="",Pe.headers=[],Pe.rowCount=0,Pe.parsedData=null,Pe.error=null,wt()}),(p=document.getElementById("pto-check-coverage-btn"))==null||p.addEventListener("click",async()=>{Ne("Refreshing coverage check...","info",2e3);let X=window.scrollY;await Jn(),wt(),requestAnimationFrame(()=>window.scrollTo(0,X))}),document.querySelectorAll("[data-pto-coverage-detail]").forEach(X=>{X.addEventListener("click",M=>{M.preventDefault();let b=X.dataset.ptoCoverageDetail;Bk(b)})}),(m=document.getElementById("pto-check-quality-btn"))==null||m.addEventListener("click",async()=>{Ne("Refreshing quality check...","info",2e3);let X=window.scrollY;await Ji(),wt(),requestAnimationFrame(()=>window.scrollTo(0,X))}),document.querySelectorAll("[data-quality-section]").forEach(X=>{X.addEventListener("click",M=>{M.preventDefault();let b=X.dataset.qualitySection,B=window.scrollY;ut.expandedSections.has(b)?ut.expandedSections.delete(b):ut.expandedSections.add(b),wt(),requestAnimationFrame(()=>window.scrollTo(0,B))})})}e===2&&((h=document.getElementById("review-generate-btn"))==null||h.addEventListener("click",()=>sE()),(g=document.getElementById("review-open-btn"))==null||g.addEventListener("click",()=>LE("PTO_Review"))),e===2&&((v=document.getElementById("headcount-skip-btn"))==null||v.addEventListener("click",()=>{De.skipAnalysis=!De.skipAnalysis;let ne=document.getElementById("headcount-skip-btn");ne==null||ne.classList.toggle("is-active",De.skipAnalysis),De.skipAnalysis&&su(),iu()}),(y=document.getElementById("headcount-run-btn"))==null||y.addEventListener("click",()=>Jn()),(x=document.getElementById("headcount-refresh-btn"))==null||x.addEventListener("click",()=>Jn()),ZE(),De.skipAnalysis&&su(),iu()),e===3&&((I=document.getElementById("quality-run-btn"))==null||I.addEventListener("click",()=>Ji()),(R=document.getElementById("quality-refresh-btn"))==null||R.addEventListener("click",()=>Ji()),(P=document.getElementById("quality-acknowledge-btn"))==null||P.addEventListener("click",()=>_E())),e===4&&((k=document.getElementById("analysis-refresh-btn"))==null||k.addEventListener("click",()=>Zf()),(D=document.getElementById("analysis-run-btn"))==null||D.addEventListener("click",()=>Zf()),(N=document.getElementById("payrate-save-btn"))==null||N.addEventListener("click",zf),(U=document.getElementById("payrate-ignore-btn"))==null||U.addEventListener("click",qk),(W=document.getElementById("payrate-input"))==null||W.addEventListener("keydown",ne=>{ne.key==="Enter"&&zf()})),e===3&&((L=document.getElementById("je-create-btn"))==null||L.addEventListener("click",()=>TE()),(J=document.getElementById("je-run-btn"))==null||J.addEventListener("click",()=>hu()),(ue=document.getElementById("je-export-btn"))==null||ue.addEventListener("click",()=>SE()),(te=document.getElementById("je-upload-btn"))==null||te.addEventListener("click",()=>gu()))}function Gk(){var o,c,l,f,d;gc("config-payroll-date",{onChange:u=>{if(Nr(_e.payrollDate,u),!!u){if(Ae.overrides.accountingPeriod=!1,Ae.overrides.journalId=!1,!Ae.overrides.accountingPeriod){let p=UE(u);if(p){let m=document.getElementById("config-accounting-period");m&&(m.value=p),Nr(_e.accountingPeriod,p)}}if(!Ae.overrides.journalId){let p=$E(u);if(p){let m=document.getElementById("config-journal-id");m&&(m.value=p),Nr(_e.journalEntryId,p)}}}}});let e=document.getElementById("config-accounting-period");e==null||e.addEventListener("change",u=>{Ae.overrides.accountingPeriod=!!u.target.value,Nr(_e.accountingPeriod,u.target.value||"")});let r=document.getElementById("config-journal-id");r==null||r.addEventListener("change",u=>{Ae.overrides.journalId=!!u.target.value,Nr(_e.journalEntryId,u.target.value.trim())}),(o=document.getElementById("config-company-name"))==null||o.addEventListener("change",u=>{Nr(_e.companyName,u.target.value.trim())}),(c=document.getElementById("config-payroll-provider"))==null||c.addEventListener("change",u=>{Nr(_e.payrollProvider,u.target.value.trim())}),(l=document.getElementById("config-accounting-link"))==null||l.addEventListener("change",u=>{Nr(_e.accountingSoftware,u.target.value.trim())}),(f=document.getElementById("config-user-name"))==null||f.addEventListener("change",u=>{Nr(_e.reviewerName,u.target.value.trim())});let t=document.getElementById("config-notes");t==null||t.addEventListener("input",u=>{xr(0,"notes",u.target.value)});let a=document.getElementById("config-notes-lock");a==null||a.addEventListener("click",async()=>{let u=!a.classList.contains("is-locked");$o(a,u),await vu(0,u)});let n=document.getElementById("config-notes-save");n==null||n.addEventListener("click",async()=>{t&&(await xr(0,"notes",t.value),Gr(n,!0))});let i=document.getElementById("config-reviewer");i==null||i.addEventListener("change",u=>{let p=u.target.value.trim();xr(0,"reviewer",p);let m=document.getElementById("config-signoff-date");if(p&&m&&!m.value){let h=Zo();m.value=h,xr(0,"signOffDate",h),yu(0,!0)}}),(d=document.getElementById("config-signoff-date"))==null||d.addEventListener("change",u=>{xr(0,"signOffDate",u.target.value||"")});let s=document.getElementById("config-signoff-save");s==null||s.addEventListener("click",async()=>{var m,h;let u=((m=i==null?void 0:i.value)==null?void 0:m.trim())||"",p=((h=document.getElementById("config-signoff-date"))==null?void 0:h.value)||"";await xr(0,"reviewer",u),await xr(0,"signOffDate",p),Gr(s,!0)}),jo(),wu(0,{buttonId:"config-signoff-toggle",inputId:"config-signoff-date",onComplete:()=>{WE(),fu(0),uu()}}),du("config-signoff-toggle-prev","config-signoff-toggle-next")}function Zn(e,r=null){if(e<0||e>=vr.length)return;qi=e;let t=r!=null?r:vr[e].id;Qn({focusedIndex:e,activeView:t===0?"config":"step",activeStepId:t});let n=wk[t];n&&(console.log("[NAV] Step\u2192Sheet activation",{moduleKey:oa,stepIndex:e,stepId:t,targetSheetName:n}),Pa(n).then(()=>{console.log("[NAV] Step\u2192Sheet activation success",{moduleKey:oa,stepId:t,targetSheetName:n})}).catch(i=>{var s;console.warn("[NAV] Step\u2192Sheet activation failed",{moduleKey:oa,stepId:t,targetSheetName:n,error:(s=i==null?void 0:i.message)!=null?s:String(i)})})),t===2&&!De.hasAnalyzed&&(ku(),Jn())}function zk(e){return e===4?null:()=>fu(e)}function fu(e){let r=vr.findIndex(a=>a.id===e);if(r===-1)return;let t=r+1;t<vr.length&&(Zn(t,vr[t].id),uu())}function uu(){let e=[document.querySelector(".pf-root"),document.querySelector(".pf-step-guide"),document.body];for(let r of e)r&&r.scrollTo({top:0,behavior:"smooth"});window.scrollTo({top:0,behavior:"smooth"})}function Zi(e){let r=rt.focusedIndex+e,t=Math.max(0,Math.min(vr.length-1,r));Zn(t,vr[t].id),window.scrollTo({top:0,behavior:"smooth"})}function du(e,r){var t,a;(t=document.getElementById(e))==null||t.addEventListener("click",()=>Zi(-1)),(a=document.getElementById(r))==null||a.addEventListener("click",()=>Zi(1))}function Xk(){if(qi===null)return;let e=document.querySelector(`[data-step-index="${qi}"]`);qi=null,e==null||e.scrollIntoView({behavior:"smooth",block:"center"})}function Yk(e){var a;let r=_u(Ae.completes[e]),t=!!((a=Ae.steps[e])!=null&&a.signOffDate);return r||t}function Qn(e){e.stepStatuses&&(rt.stepStatuses={...rt.stepStatuses,...e.stepStatuses}),Object.assign(rt,{...e,stepStatuses:rt.stepStatuses}),wt()}function St(){return typeof Excel!="undefined"&&typeof Excel.run=="function"}async function zf(){let e=document.getElementById("payrate-input");if(!e)return;let r=parseFloat(e.value),t=e.dataset.employee,a=parseInt(e.dataset.row,10);if(isNaN(r)||r<=0){Ne("Please enter a valid pay rate greater than 0.","info");return}if(!t||isNaN(a)){console.error("Missing employee data on input");return}nr(!0,"Updating pay rate...");try{await Excel.run(async n=>{let i=n.workbook.worksheets.getItem("PTO_Analysis"),s=i.getCell(a-1,3);s.values=[[r]];let o=i.getCell(a-1,8);o.load("values"),await n.sync();let l=(Number(o.values[0][0])||0)*r,f=i.getCell(a-1,9);f.values=[[l]];let d=i.getCell(a-1,10);d.load("values"),await n.sync();let u=Number(d.values[0][0])||0,p=l-u,m=i.getCell(a-1,11);m.values=[[p]],await n.sync()}),yr.missingPayRates=yr.missingPayRates.filter(n=>n.name!==t),nr(!1),Zn(3,3)}catch(n){console.error("Failed to save pay rate:",n),Ne(`Failed to save pay rate: ${n.message}`,"error"),nr(!1)}}function qk(){let e=document.getElementById("payrate-input");if(!e)return;let r=e.dataset.employee;r&&(yr.ignoredMissingPayRates.add(r),yr.missingPayRates=yr.missingPayRates.filter(t=>t.name!==r)),Zn(3,3)}var sa={ROSTER_OVERRIDE:"Roster Override",ROSTER:"Roster",PAYROLL:"Payroll",DEFAULT:"Default",MISSING:"Missing"},Yo=2080;function sn(e){return e?String(e).trim().replace(/\s+/g," ").toUpperCase():""}var zt={loaded:!1,loading:!1,lastRun:null,rates:new Map,diagnostics:{fromRosterOverride:0,fromRoster:0,fromPayroll:0,fromDefault:0,missing:0,total:0,missingEmployees:[],topByLiability:[]}};async function Kk(){console.log("[RateEngine] Starting rate load..."),zt.loading=!0,zt.rates.clear();let e=zt.diagnostics;if(e.fromRosterOverride=0,e.fromRoster=0,e.fromPayroll=0,e.fromDefault=0,e.missing=0,e.total=0,e.missingEmployees=[],e.topByLiability=[],!St())return console.warn("[RateEngine] Excel not available"),zt.loading=!1,zt.rates;try{await Excel.run(async t=>{let a=await Jk(t),n=await Qk(t),i=await eE(t);for(let s of i){let o=sn(s.name);e.total++;let c=null,l=sa.MISSING,f="",d=a.get(o);if(d){if(d.isManuallyManaged&&d.hourlyRate>0)c=d.hourlyRate,l=sa.ROSTER_OVERRIDE,f=d.rateSource||"Manual override",e.fromRosterOverride++;else if(d.hourlyRate>0)c=d.hourlyRate,l=sa.ROSTER,f=d.rateSource||"Hourly_Rate column",e.fromRoster++;else if(d.salaryAnnual>0){let p=d.stdHoursPerYear||Yo;c=d.salaryAnnual/p,l=sa.ROSTER,f=`Salary ${d.salaryAnnual.toFixed(0)} / ${p} hrs`,e.fromRoster++}}if(!c&&n.has(o)){let p=n.get(o);p.rate>0&&(c=p.rate,l=sa.PAYROLL,f=`Fixed $${p.avgFixedPerPeriod.toFixed(0)} / ${Zk}hrs (${p.periods} periods)`,e.fromPayroll++)}c||(l=sa.MISSING,f="No rate source available",e.missing++,e.missingEmployees.push({name:s.name,key:o}));let u=(d==null?void 0:d.department)||"";zt.rates.set(o,{employeeName:s.name,rate:c||0,source:l,sourceDetail:f,balance:s.balance||0,department:u})}await t.sync()});let r=Array.from(zt.rates.values()).filter(t=>t.rate>0&&t.balance>0).map(t=>({name:t.employeeName,balance:t.balance,rate:t.rate,liability:t.balance*t.rate})).sort((t,a)=>a.liability-t.liability).slice(0,10);e.topByLiability=r,console.log("[RateEngine] Load complete:",{total:e.total,fromRosterOverride:e.fromRosterOverride,fromRoster:e.fromRoster,fromPayroll:e.fromPayroll,fromDefault:e.fromDefault,missing:e.missing,missingNames:e.missingEmployees.map(t=>t.name)}),console.log("[RateEngine] Top 10 by liability:",e.topByLiability),zt.loaded=!0,zt.loading=!1,zt.lastRun=new Date().toISOString()}catch(r){console.error("[RateEngine] Error loading rates:",r),zt.loading=!1}return zt.rates}async function Jk(e){let r=new Map,t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(t.load("isNullObject"),await e.sync(),t.isNullObject)return console.log("[RateEngine] SS_Employee_Roster not found"),r;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return console.log("[RateEngine] SS_Employee_Roster is empty"),r;let n=a.values[0].map(u=>String(u||"").toLowerCase().trim()),i=n.findIndex(u=>u==="employee_name"||u==="employee name"||u==="name"),s=n.findIndex(u=>u==="hourly_rate"||u==="hourly rate"||u==="pay_rate"||u==="pay rate"),o=n.findIndex(u=>u==="salary_annual"||u==="annual salary"||u==="salary"),c=n.findIndex(u=>u==="std_hours_per_year"||u==="standard hours"),l=n.findIndex(u=>u==="is_manually_managed"||u==="manual"),f=n.findIndex(u=>u==="rate_source"||u==="rate source"),d=n.findIndex(u=>u==="department"||u==="department_name"||u==="dept"||u.includes("department"));if(console.log("[RateEngine] Roster columns found:",{nameIdx:i,hourlyIdx:s,salaryIdx:o,stdHoursIdx:c,manualIdx:l,rateSourceIdx:f,deptIdx:d}),i<0)return console.warn("[RateEngine] No employee name column in roster"),r;for(let u=1;u<a.values.length;u++){let p=a.values[u],m=String(p[i]||"").trim();if(!m)continue;let h=sn(m),g=s>=0&&parseFloat(p[s])||0,v=o>=0&&parseFloat(p[o])||0,y=c>=0&&parseFloat(p[c])||Yo,x=l>=0?String(p[l]||"").toUpperCase()==="TRUE":!1,I=f>=0?String(p[f]||"").trim():"",R=d>=0?String(p[d]||"").trim():"";r.set(h,{name:m,hourlyRate:g,salaryAnnual:v,stdHoursPerYear:y,isManuallyManaged:x,rateSource:I,department:R,rowIndex:u})}return console.log(`[RateEngine] Loaded ${r.size} employees from roster`),r}var Zk=80;async function Qk(e,r=3){let t=new Map;return console.log("[RateEngine] loadPayrollDerivedRates: Rates now sourced from SS_Employee_Roster.Hourly_Rate"),t}async function eE(e){let r=[],t=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(t.load("isNullObject"),await e.sync(),t.isNullObject)return console.log("[RateEngine] PTO_Data_Clean not found"),r;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return r;let n=a.values[0].map(o=>String(o||"").toLowerCase().trim()),i=n.findIndex(o=>o==="employee_name"||o==="employee name"||o.includes("employee")),s=n.findIndex(o=>o==="balance"||o.includes("balance"));if(i<0)return console.warn("[RateEngine] No employee name column in PTO data"),r;for(let o=1;o<a.values.length;o++){let c=a.values[o],l=String(c[i]||"").trim();if(!l)continue;let f=s>=0&&parseFloat(c[s])||0;r.push({name:l,balance:f,rowIndex:o})}return console.log(`[RateEngine] Found ${r.length} employees in PTO data`),r}function tE(e){let r=sn(e);return zt.rates.get(r)||null}var Ki=["Analysis_Date","Employee_Key","Employee_Name","Department","Pay_Rate","Accrual_Rate","Carry_Over","YTD_Accrued","YTD_Used","Vested_Balance","Calc_Liability"],Xf=5;async function rE(){if(!St())return{ok:!1,error:"Excel unavailable"};try{return await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Archive_Summary");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.log("[PTOArchive] Creating PTO_Archive_Summary sheet"),r=e.workbook.worksheets.add("PTO_Archive_Summary");let a=r.getRangeByIndexes(0,0,1,Ki.length);return a.values=[Ki],a.format.font.bold=!0,await e.sync(),{ok:!0,created:!0}}let t=r.getUsedRangeOrNullObject();if(t.load("values"),await e.sync(),!t.isNullObject&&t.values&&t.values.length>0){let a=t.values[0].map(s=>String(s||"").trim()),n=new Set(a.map(s=>s.toLowerCase())),i=Ki.filter(s=>!n.has(s.toLowerCase()));if(i.length>0){console.log("[PTOArchive] Adding missing columns:",i);let s=a.length,o=r.getRangeByIndexes(0,s,1,i.length);o.values=[i],o.format.font.bold=!0;let c=t.values.length-1;if(c>0){let l=Array(c).fill(i.map(()=>0)),f=r.getRangeByIndexes(1,s,c,i.length);f.values=l}await e.sync()}}return{ok:!0}})}catch(e){return console.error("[PTOArchive] Error ensuring schema:",e),{ok:!1,error:e.message}}}async function aE(){let e=new Map;if(!St())return e;try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Archive_Summary");if(t.load("isNullObject"),await r.sync(),t.isNullObject){console.log("[PTOArchive] No archive sheet - all employees will show as NEW");return}let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)return;let n=a.values[0].map(u=>String(u||"").toLowerCase().trim()),i=n.findIndex(u=>u==="analysis_date"||u.includes("date")),s=n.findIndex(u=>u==="employee_key"),o=n.findIndex(u=>u==="employee_name"||u.includes("employee")),c=n.findIndex(u=>u==="calc_liability"||u==="liability_amount"||u.includes("liability")),l=n.findIndex(u=>u==="pay_rate"||u.includes("rate")),f=n.findIndex(u=>u==="vested_balance"||u==="balance");if(o<0&&s<0){console.warn("[PTOArchive] No employee identifier column");return}let d=new Map;for(let u=1;u<a.values.length;u++){let p=a.values[u],m=s>=0?String(p[s]||"").trim():sn(String(p[o]||""));if(!m)continue;let h=i>=0?String(p[i]||""):"",g=c>=0&&parseFloat(p[c])||0,v=l>=0&&parseFloat(p[l])||0,y=f>=0&&parseFloat(p[f])||0;d.has(m)||d.set(m,[]),d.get(m).push({analysisDate:h,liability:g,rate:v,balance:y})}for(let[u,p]of d)p.sort((m,h)=>String(h.analysisDate).localeCompare(String(m.analysisDate))),e.set(u,p[0]);console.log(`[PTOArchive] Loaded prior data for ${e.size} employees`)})}catch(r){console.error("[PTOArchive] Error loading prior data:",r)}return e}async function nE(e,r){if(!St()||!e||e.length===0)return{ok:!1,error:"No data to archive"};try{return await rE(),await Excel.run(async t=>{let a=t.workbook.worksheets.getItem("PTO_Archive_Summary"),n=a.getUsedRangeOrNullObject();n.load("values"),await t.sync();let i=Ki,s=[];!n.isNullObject&&n.values&&n.values.length>0&&(i=n.values[0].map(y=>String(y||"").trim()),s=n.values.slice(1));let o=i.map(y=>y.toLowerCase()),c=o.indexOf("analysis_date"),l=o.indexOf("employee_key"),f=new Map;for(let y of s){let x=c>=0?String(y[c]||""):"";x&&(f.has(x)||f.set(x,[]),f.get(x).push(y))}let d=String(r||"").substring(0,10);f.delete(d);let u=e.map(y=>{let x=new Array(i.length).fill("");return i.forEach((I,R)=>{var k,D,N,U;let P=I.toLowerCase();P==="analysis_date"?x[R]=d:P==="employee_key"?x[R]=sn(y.employeeName):P==="employee_name"?x[R]=y.employeeName||"":P==="department"?x[R]=y.department||"":P==="pay_rate"?x[R]=y.payRate||0:P==="accrual_rate"?x[R]=y.accrualRate||0:P==="carry_over"?x[R]=y.carryOver||0:P==="ytd_accrued"?x[R]=y.ytdAccrued||0:P==="ytd_used"?x[R]=y.ytdUsed||0:P==="vested_balance"||P==="balance"?x[R]=(D=(k=y.vestedBalance)!=null?k:y.balance)!=null?D:0:(P==="calc_liability"||P==="liability_amount")&&(x[R]=(U=(N=y.calculatedLiability)!=null?N:y.liabilityAmount)!=null?U:0)}),x});if(f.set(d,u),f.size>Xf){let x=Array.from(f.keys()).sort().slice(0,f.size-Xf);for(let I of x)console.log(`[PTOArchive] Removing oldest period: ${I}`),f.delete(I)}let p=[];for(let[,y]of f)p.push(...y);let m=a.getUsedRangeOrNullObject();await t.sync(),m.isNullObject||m.clear();let h=1+p.length,g=a.getRangeByIndexes(0,0,h,i.length);g.values=[i,...p];let v=a.getRangeByIndexes(0,0,1,i.length);return v.format.font.bold=!0,await t.sync(),console.log(`[PTOArchive] Saved ${u.length} rows for period ${d}`),{ok:!0,rowCount:u.length,periodCount:f.size}})}catch(t){return console.error("[PTOArchive] Error saving archive:",t),{ok:!1,error:t.message}}}var Go=["Analysis_Date","Employee_Name","Employee_ID","Department","Pay_Rate","Rate_Source","Accrual_Rate","Carry_Over","YTD_Accrued","YTD_Used","Vested_Balance","Register_Balance","Liability_Amount","Liability_Source","Report_Liability","Calc_Liability","Prior_Liability","Change","_Flags"];function Yf(e){return e?String(e).toUpperCase().replace(/,/g," ").replace(/\s+/g," ").trim():""}async function iE(e){let r={rosterCount:0,ptoReportCount:e.length,inBothCount:0,inPtoOnlyCount:0,inPtoOnlyNames:[],inPtoOnlyLiability:0,inRosterOnlyCount:0,inRosterOnlyNames:[]};if(!St())return r;try{await Excel.run(async t=>{let a=t.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(a.load("isNullObject"),await t.sync(),a.isNullObject){console.warn("[Coverage] SS_Employee_Roster not found");return}let n=a.getUsedRangeOrNullObject();if(n.load("values"),await t.sync(),n.isNullObject||!n.values||n.values.length<2)return;let i=n.values[0].map(u=>String(u||"").toLowerCase().trim()),s=i.findIndex(u=>u==="employee_name"||u.includes("employee")),o=i.findIndex(u=>u==="employment_status"||u.includes("status"));if(s<0){console.warn("[Coverage] Employee name column not found in roster");return}let c=new Map,l=new Set;for(let u=1;u<n.values.length;u++){let p=n.values[u],m=String(p[s]||"").trim(),h=Yf(m),g=o>=0?String(p[o]||"").toLowerCase():"";h&&!g.includes("terminated")&&!g.includes("inactive")&&(l.add(h),c.set(h,m))}r.rosterCount=l.size;let f=new Map,d=new Set;for(let u of e){let p=Yf(u.employeeName);p&&(d.add(p),f.set(p,u))}console.log("[Coverage] Roster employees:",l.size,"PTO employees:",d.size);for(let u of d)if(l.has(u))r.inBothCount++;else{r.inPtoOnlyCount++;let p=f.get(u);p&&(r.inPtoOnlyNames.push(p.employeeName),r.inPtoOnlyLiability+=p.calculatedLiability||0)}for(let u of l)if(!d.has(u)){r.inRosterOnlyCount++;let p=c.get(u);p&&r.inRosterOnlyNames.push(p)}await t.sync()})}catch(t){console.error("[Coverage] Error calculating employee coverage:",t)}return console.log("[Coverage] Results:",r),r}async function sE(){var e;console.log("[PTOReview] Starting review generation..."),Je.loading=!0,Ne("Generating PTO Accrual Review...","info",3e3);try{await Kk();let r=await aE(),t=await oE(r);await cE(t);let a=0,n=0,i=0,s=0,o=0,c=0,l=0,f=0,d=0;for(let p of t){a+=p.liabilityAmount||0,n+=p.priorLiability||0,i+=p.reportLiability||0;let m=p.calculatedLiability||0;s+=m;let h=(e=p.vestedBalance)!=null?e:0;h<0?(o+=m,c++):h>0?l++:f++,(!p.payRate||p.payRate<=0)&&d++}Je.reconciliation={reportLiabilityTotal:i,calcLiabilityTotal:s,negativeBalanceTotal:o,negativeBalanceCount:c,positiveBalanceCount:l,zeroBalanceCount:f,missingRateCount:d};let u=await iE(t);Je.coverage=u,Je.totalCurrentLiability=a,Je.totalPriorLiability=n,Je.netChange=a-n,Je.employeeCount=t.length,Je.reviewData=t,Je.loaded=!0,Je.loading=!1,Je.lastRun=new Date().toISOString(),console.log("[PTOReview] Generation complete:",{employees:t.length,totalCurrent:a,totalPrior:n,netChange:a-n,reconciliation:Je.reconciliation,coverage:Je.coverage}),Ne(`PTO Review generated: ${t.length} employees, ${lE(a)} total liability`,"success"),wt()}catch(r){console.error("[PTOReview] Error generating review:",r),Ne(`Error generating review: ${r.message}`,"error"),Je.loading=!1}}async function oE(e){let r=[],t=$t(_e.payrollDate)||new Date().toISOString().substring(0,10);return St()&&(await Excel.run(async a=>{let n=a.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(n.load("isNullObject"),await a.sync(),n.isNullObject)throw new Error("PTO_Data_Clean not found. Upload data in Step 1.");let i=n.getUsedRangeOrNullObject();if(i.load("values"),await a.sync(),i.isNullObject||!i.values||i.values.length<2)throw new Error("PTO_Data_Clean is empty.");let s=i.values[0].map(m=>String(m||"").toLowerCase().trim());console.log("[PTOReview] All headers from PTO_Data_Clean:",s);let o={employeeName:s.findIndex(m=>m==="employee_name"||m==="employee name"||m==="employeename"||m==="name"||m==="full_name"||m==="full name"),department:s.findIndex(m=>m==="department"||m==="department_name"),accrualRate:s.findIndex(m=>m==="accrual_rate"||m.includes("accrual")&&m.includes("rate")),carryOver:s.findIndex(m=>m==="carry_over"||m.includes("carry")),ytdAccrued:s.findIndex(m=>m==="ytd_accrued"||m.includes("ytd")&&m.includes("accrued")),ytdUsed:s.findIndex(m=>m==="ytd_used"||m.includes("ytd")&&m.includes("used")),balance:s.findIndex(m=>m==="balance")},c=s.findIndex(m=>m==="pay_rate_hourly"||m==="pay rate hourly"||m==="payratehourly"),l=s.findIndex(m=>m==="accrued_liability"||m==="accrued liability"||m==="accruedliability"),f=s.findIndex(m=>m==="as_of_date_balance"||m==="as of date balance"||m==="asofdatebalance"),d=s.findIndex(m=>m==="current_register_balance"||m==="current register balance"||m==="currentregisterbalance"),u=s.findIndex(m=>m==="employee_id"||m==="employee id"||m==="employeeid"),p=s.findIndex(m=>m==="department"||m==="department_name");if(console.log("[PTOReview] Column indexes:",o),console.log("[PTOReview] Employee name found at index:",o.employeeName,"header:",s[o.employeeName]),console.log("[PTOReview] Report columns detected:",{payRateHourly:c>=0,accruedLiability:l>=0,asOfDateBalance:f>=0,currentRegisterBalance:d>=0,employeeId:u>=0}),o.employeeName<0)throw console.error("[PTOReview] Could not find employee name column. Headers available:",s),new Error("Employee name column not found in PTO data. Check console for available headers.");for(let m=1;m<i.values.length;m++){let h=i.values[m],g=String(h[o.employeeName]||"").trim();if(!g)continue;let v=sn(g),y=tE(g),x=c>=0?Xo(h[c]):0,I=(y==null?void 0:y.rate)||0,R=x>0?x:I,P=x>0?"REPORT":(y==null?void 0:y.source)||sa.MISSING,k=p>=0?String(h[p]||"").trim():"",D=(y==null?void 0:y.department)||"",N=k||D,U=u>=0?String(h[u]||"").trim():"",W=o.accrualRate>=0&&parseFloat(h[o.accrualRate])||0,L=o.carryOver>=0&&parseFloat(h[o.carryOver])||0,J=o.ytdAccrued>=0&&parseFloat(h[o.ytdAccrued])||0,ue=o.ytdUsed>=0&&parseFloat(h[o.ytdUsed])||0,te=f>=0?parseFloat(h[f])||0:null,ne=d>=0?parseFloat(h[d])||0:o.balance>=0&&parseFloat(h[o.balance])||0,Q=te!==null?te:ne,xe=ne,se=0,X="NO_BALANCE",M=0,b=0;Q>0?(M=l>=0?Xo(h[l]):0,b=R>0?Q*R:0,M>0?(se=M,X="REPORT"):(se=b,X="CALCULATED")):Q<0?(se=0,X="NEGATIVE_BALANCE",b=Q*R):(se=0,X="NO_BALANCE"),console.log(`[PTOReview] ${g}: vestedBal=${Q}, displayBal=${xe}, liability=${se.toFixed(2)} (${X})`);let B=e.get(v),O=(B==null?void 0:B.liability)||0,T=b-O,z=[];B||z.push("NEW"),P===sa.MISSING&&z.push("MISSING_RATE"),Math.abs(T)>Je.flagThresholds.largeMove&&z.push("LARGE_MOVE"),Q<0&&z.push("NEG_BALANCE"),x>0&&I>0&&Math.abs(x-I)>5&&(z.push("RATE_VARIANCE"),console.log(`[PTOReview] Rate variance for ${g}: Report=$${x.toFixed(2)} vs Calc=$${I.toFixed(2)}`)),Q>0&&M>0&&b>0&&Math.abs(M-b)>100&&(z.push("LIABILITY_VARIANCE"),console.log(`[PTOReview] Liability variance for ${g}: Report=$${M.toFixed(2)} vs Calc=$${b.toFixed(2)}`)),r.push({analysisDate:t,employeeName:g,employeeId:U,department:N,payRate:R,rateSource:P,accrualRate:W,carryOver:L,ytdAccrued:J,ytdUsed:ue,vestedBalance:Q,displayBalance:xe,liabilityAmount:se,liabilitySource:X,reportLiability:M,calculatedLiability:b,priorLiability:O,change:T,flags:z.join(", ")})}await a.sync()}),r.sort((a,n)=>n.liabilityAmount-a.liabilityAmount)),r}async function cE(e){St()&&await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");t.load("isNullObject"),await r.sync(),t.isNullObject&&(t=r.workbook.worksheets.add("PTO_Review"));let a=t.getUsedRangeOrNullObject();await r.sync(),a.isNullObject||a.clear();let n=e.map(l=>[l.analysisDate,l.employeeName,l.employeeId||"",l.department,l.payRate,l.rateSource||"",l.accrualRate,l.carryOver,l.ytdAccrued,l.ytdUsed,l.vestedBalance,l.displayBalance,l.liabilityAmount,l.liabilitySource||"",l.reportLiability||0,l.calculatedLiability||0,l.priorLiability,l.change,l.flags]),i=[Go,...n],s=t.getRangeByIndexes(0,0,i.length,Go.length);s.values=i;let o=t.getRangeByIndexes(0,0,1,Go.length);en(o);let c="$#,##0.00";n.length>0&&(t.getRangeByIndexes(1,4,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,12,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,14,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,15,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,16,n.length,1).numberFormat=[[c]],t.getRangeByIndexes(1,17,n.length,1).numberFormat=[[c]]),s.format.autofitColumns(),t.freezePanes.freezeRows(1),await r.sync(),console.log(`[PTOReview] Wrote ${n.length} rows to PTO_Review sheet`)})}function lE(e){return(Number(e)||0).toLocaleString("en-US",{style:"currency",currency:"USD"})}var Pe={file:null,fileName:"",headers:[],rowCount:0,parsedData:null,mappings:null,unmappedHeaders:[],error:null,loading:!1},fE=["Company_Name","Form_Name","Selection_Criteria","Employee_Name","Plan_Description","Accrue_Through_Date","Year_Ending"],uE=["Accrual_Rate","Carry_Over","Pay_Period_Accrued","Pay_Period_Used","YTD_Accrued","YTD_Used","Balance"],Wb=[...fE,...uE];async function qf(e){if(e){await Kf(e);return}let r=document.getElementById("pto-file-input");r||(r=document.createElement("input"),r.type="file",r.id="pto-file-input",r.accept=".csv,.xlsx,.xls",r.style.display="none",document.body.appendChild(r),r.addEventListener("change",async t=>{var n;let a=(n=t.target.files)==null?void 0:n[0];a&&await Kf(a),r.value=""})),r.click()}async function Kf(e){let r=[".csv",".xlsx",".xls"],t=e.name.toLowerCase().slice(e.name.lastIndexOf("."));if(!r.includes(t)){Ne("Please upload a CSV or Excel file (.csv, .xlsx, .xls)","error");return}Pe.loading=!0,Pe.error=null,Pe.fileName=e.name,Pe.file=e,Ne(`Reading ${e.name}...`,"info",2e3),qn("Reading file...");try{let a=await hE(e);if(!a||a.length<2)throw new Error("File appears empty or has no data rows.");Pe.headers=a[0].map(u=>String(u||"").trim()),Pe.rowCount=a.length-1,Pe.parsedData=a,console.log(`[PTOUpload] Parsed ${Pe.headers.length} columns, ${Pe.rowCount} rows`),console.log("[PTOUpload] Raw headers:",Pe.headers),qn("Loading column mappings...");let n=$t("SS_Company_ID"),i=await pE(n,"pto-accrual"),s=await wE();console.log(`[PTOUpload] Loaded ${i.length} customer mappings, ${s.size} dimension mappings`);let{normalizedHeaders:o,includedIndexes:c,unmapped:l,excluded:f}=mE(Pe.headers,i,s);Pe.mappings=s,Pe.unmappedHeaders=l,l.length>0&&(console.warn("[PTOUpload] Unmapped headers:",l),Ne(`Warning: ${l.length} column(s) could not be mapped`,"warning",4e3)),f.length>0&&console.log("[PTOUpload] Excluded columns (include_in_matrix=false):",f),console.log("[PTOUpload] Normalized headers:",o),console.log("[PTOUpload] Included column indexes:",c),qn("Writing to PTO_Data_Clean..."),await yE(o,Pe.parsedData,c),Pe.loading=!1,Ne(`Successfully imported ${Pe.rowCount} rows to PTO_Data_Clean`,"success"),qn(`\u2713 ${Pe.rowCount} rows imported`),wt();let d=await dE();d.ok&&d.rowsUpdated>0?(console.log(`[PTO] Synced ${d.rowsUpdated} employees to roster (${d.idUpdates} IDs, ${d.rateUpdates} rates)`),Ne(`Updated ${d.rowsUpdated} employees in roster`,"success",2e3)):d.ok||console.warn("[PTO] Roster sync skipped:",d.error),Ne("Running validation checks...","info",2e3),await Promise.all([Jn(),Ji()]),wt(),Ne("Validation checks complete!","success")}catch(a){console.error("[PTOUpload] Error:",a),Pe.error=a.message,Pe.loading=!1,Ne(`Upload failed: ${a.message}`,"error"),qn(`Error: ${a.message}`)}}function qn(e){let r=document.getElementById("pto-upload-status");r&&(r.textContent=e)}async function dE(){if(!St())return console.log("[PTO-Roster Sync] Excel not available, skipping roster sync"),{ok:!1,error:"Excel not available"};console.log("[PTO-Roster Sync] Starting sync to SS_Employee_Roster...");try{return await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean"),t=e.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster");if(r.load("isNullObject"),t.load("isNullObject"),await e.sync(),r.isNullObject)return console.warn("[PTO-Roster Sync] PTO_Data_Clean not found"),{ok:!1,error:"PTO_Data_Clean not found"};if(t.isNullObject)return console.warn("[PTO-Roster Sync] SS_Employee_Roster not found"),{ok:!1,error:"SS_Employee_Roster not found"};let a=r.getUsedRangeOrNullObject(),n=t.getUsedRangeOrNullObject();if(a.load("values"),n.load("values"),await e.sync(),a.isNullObject||!a.values||a.values.length<2)return{ok:!1,error:"PTO_Data_Clean is empty"};if(n.isNullObject||!n.values||n.values.length<2)return{ok:!1,error:"SS_Employee_Roster is empty"};let i=a.values[0].map(m=>String(m||"").toLowerCase().trim()),s={employeeName:i.findIndex(m=>m==="employee_name"||m==="employee name"),employeeId:i.findIndex(m=>m==="employee_id"||m==="employee id"),payRateHourly:i.findIndex(m=>m==="pay_rate_hourly"||m==="pay rate hourly")};if(console.log("[PTO-Roster Sync] PTO column indexes:",s),s.employeeName<0)return{ok:!1,error:"Employee_Name column not found in PTO data"};let o=new Map;for(let m=1;m<a.values.length;m++){let h=a.values[m],g=String(h[s.employeeName]||"").trim();if(!g)continue;let v=g.toLowerCase();o.set(v,{employeeId:s.employeeId>=0?String(h[s.employeeId]||"").trim():"",payRateHourly:s.payRateHourly>=0?Xo(h[s.payRateHourly]):0})}console.log(`[PTO-Roster Sync] Loaded ${o.size} employees from PTO data`);let c=n.values[0].map(m=>String(m||"").toLowerCase().trim()),l={employeeName:c.findIndex(m=>m==="employee_name"),employeeId:c.findIndex(m=>m==="employee_id"),hourlyRatePrismhr:c.findIndex(m=>m==="hourly_rate_prismhr")};if(console.log("[PTO-Roster Sync] Roster column indexes:",l),l.hourlyRatePrismhr<0&&console.warn("[PTO-Roster Sync] Hourly_Rate_Prismhr column not found in roster - it may need to be added via payroll-recorder schema update"),l.employeeName<0)return{ok:!1,error:"Employee_Name column not found in roster"};let f=0,d=0,u=0;for(let m=1;m<n.values.length;m++){let h=n.values[m],g=String(h[l.employeeName]||"").trim();if(!g)continue;let v=g.toLowerCase(),y=o.get(v);if(!y)continue;let x=!1;if(l.employeeId>=0&&y.employeeId){let I=String(h[l.employeeId]||"").trim();(!I||I.includes(" "))&&(t.getRangeByIndexes(m,l.employeeId,1,1).values=[[y.employeeId]],x=!0,d++)}l.hourlyRatePrismhr>=0&&y.payRateHourly>0&&(t.getRangeByIndexes(m,l.hourlyRatePrismhr,1,1).values=[[y.payRateHourly]],x=!0,u++),x&&f++}await e.sync();let p={ok:!0,totalMatched:o.size,rowsUpdated:f,idUpdates:d,rateUpdates:u};return console.log("[PTO-Roster Sync] Complete:",p),p})}catch(e){return console.error("[PTO-Roster Sync] Error:",e),{ok:!1,error:e.message}}}async function hE(e){return new Promise((r,t)=>{let a=new FileReader;a.onload=n=>{try{let i=n.target.result,s=Pi(i,{type:"array"}),o=s.SheetNames[0];if(!o)throw new Error("No sheets found in workbook");let c=s.Sheets[o],l=Oa.sheet_to_json(c,{header:1,defval:""}),f=0;for(let d=0;d<Math.min(10,l.length);d++){let p=l[d].map(m=>String(m||"").toLowerCase()).join(" ");if(p.includes("employee")||p.includes("balance")||p.includes("accrual")){f=d;break}}console.log(`[PTOUpload] Header row detected at index ${f}`),r(l.slice(f))}catch(i){t(i)}},a.onerror=()=>t(new Error("Failed to read file")),a.readAsArrayBuffer(e)})}async function pE(e,r){if(!e)return console.warn("[PTOUpload] No companyId provided, skipping customer mappings"),[];console.log(`[PTOUpload] Loading customer column mappings for company=${e}, module=${r}`);try{let t=`${Ko}/rest/v1/ada_customer_column_mappings?company_id=eq.${encodeURIComponent(e)}&module=eq.${encodeURIComponent(r)}&select=raw_header,pf_column_name,include_in_matrix`,a=await fetch(t,{headers:{apikey:an,Authorization:`Bearer ${an}`,"Content-Type":"application/json"}});if(!a.ok)return console.warn(`[PTOUpload] Customer mappings API error: ${a.status}`),[];let n=await a.json();return console.log(`[PTOUpload] Loaded ${n.length} customer column mappings`),n}catch(t){return console.error("[PTOUpload] Error loading customer mappings:",t),[]}}function mE(e,r,t){let a=[],n=[],i=[],s=[],o=new Map;for(let c of r){let l=je(c.raw_header);o.set(l,c)}for(let c=0;c<e.length;c++){let l=e[c],f=je(l),d=o.get(f);if(d){let m=d.include_in_matrix;if(m===!1||m==="false"){s.push(l),console.log(`[PTOUpload] Excluding column "${l}" (include_in_matrix=false)`);continue}a.push(d.pf_column_name),n.push(c);continue}let u=t.get(f);if(u){a.push(u),n.push(c);continue}let p=l.trim().replace(/[^a-zA-Z0-9\s]/g,"").split(/\s+/).map(m=>m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()).join("_");a.push(p||`Column_${a.length+1}`),n.push(c),l.trim()&&i.push(l)}return{normalizedHeaders:a,includedIndexes:n,unmapped:i,excluded:s}}function gE(e){if(typeof e!="number"||e<1)return null;let r=new Date(1899,11,30);return new Date(r.getTime()+e*24*60*60*1e3)}function xE(e){if(!e)return"";if(typeof e=="string"){let r=e.trim();if(r.match(/^\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}$/))return r;if(r.match(/^\d{4}-\d{2}-\d{2}/)){let t=new Date(r);if(!isNaN(t.getTime()))return`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()}`}return r}if(typeof e=="number"&&e>1e3&&e<1e5){let r=gE(e);if(r)return`${r.getMonth()+1}/${r.getDate()}/${r.getFullYear()}`}return e instanceof Date&&!isNaN(e.getTime())?`${e.getMonth()+1}/${e.getDate()}/${e.getFullYear()}`:String(e)}function vE(e){let r=e.toLowerCase();return r.includes("balance")||r.includes("amount")||r.includes("liability")?!1:r.includes("_date")||r.includes("date_")||r==="date"||r.endsWith(" date")||r.startsWith("date ")||r.includes("hire")||r.includes("termination")||r.includes("start_date")||r.includes("end_date")||r==="as_of"}async function yE(e,r,t){if(!St())throw new Error("Excel runtime not available");let a=[];e.forEach((n,i)=>{vE(n)&&(a.push(i),console.log(`[PTOUpload] Detected date column: "${n}" at index ${i}`))}),await Excel.run(async n=>{let i=n.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");i.load("isNullObject"),await n.sync(),i.isNullObject&&(i=n.workbook.worksheets.add("PTO_Data_Clean"),console.log("[PTOUpload] Created PTO_Data_Clean sheet"));let s=i.getUsedRangeOrNullObject();await n.sync(),s.isNullObject||s.clear();let o=[e];for(let f=1;f<r.length;f++){let d=r[f],u=t.map((p,m)=>{let h=d[p];return a.includes(m)?xE(h):h!=null?h:""});o.push(u)}let c=i.getRangeByIndexes(0,0,o.length,e.length);c.values=o;let l=i.getRangeByIndexes(0,0,1,e.length);if(en(l),o.length>1&&a.length>0)for(let f of a){let d=i.getRangeByIndexes(1,f,o.length-1,1);d.numberFormat=[["mm/dd/yyyy"]]}c.format.autofitColumns(),i.freezePanes.freezeRows(1),await n.sync(),console.log(`[PTOUpload] Wrote ${o.length-1} rows, ${e.length} columns to PTO_Data_Clean`)})}async function wE(){console.log("[PTOUpload] Loading Obsidian dimension mappings from Supabase...");try{let e=`${Ko}/rest/v1/ada_payroll_dimensions?provider=eq.obsidian&select=raw_term,normalized_dimension`,r=await fetch(e,{headers:{apikey:an,Authorization:`Bearer ${an}`,"Content-Type":"application/json"}});if(!r.ok){let n=await r.text();throw new Error(`API error: ${r.status} - ${n}`)}let t=await r.json();console.log(`[PTOUpload] Loaded ${t.length} dimension mappings from Supabase`);let a=new Map;for(let n of t){let i=je(n.raw_term),s=n.normalized_dimension;i&&s&&a.set(i,s)}return console.log(`[PTOUpload] Built ${a.size} unique mappings`),a.size===0?(console.log("[PTOUpload] No DB mappings found, using fallback mappings"),Jf()):a}catch(e){return console.error("[PTOUpload] Error loading dimension mappings:",e),console.log("[PTOUpload] Using fallback mappings due to error"),Jf()}}function Jf(){let e=new Map;return e.set(je("Company Name"),"Company_Name"),e.set(je("Form Name"),"Form_Name"),e.set(je("Selection Criteria"),"Selection_Criteria"),e.set(je("Employee Name"),"Employee_Name"),e.set(je("Employee"),"Employee_Name"),e.set(je("Name"),"Employee_Name"),e.set(je("Plan Description"),"Plan_Description"),e.set(je("Plan"),"Plan_Description"),e.set(je("Accrue Through Date"),"Accrue_Through_Date"),e.set(je("Accrue Thru Date"),"Accrue_Through_Date"),e.set(je("Year Ending"),"Year_Ending"),e.set(je("Year End"),"Year_Ending"),e.set(je("Accrual Rate"),"Accrual_Rate"),e.set(je("Rate"),"Accrual_Rate"),e.set(je("Carry Over"),"Carry_Over"),e.set(je("Carryover"),"Carry_Over"),e.set(je("Pay Period Accrued"),"Pay_Period_Accrued"),e.set(je("PP Accrued"),"Pay_Period_Accrued"),e.set(je("Period Accrued"),"Pay_Period_Accrued"),e.set(je("Pay Period Used"),"Pay_Period_Used"),e.set(je("PP Used"),"Pay_Period_Used"),e.set(je("Period Used"),"Pay_Period_Used"),e.set(je("YTD Accrued"),"YTD_Accrued"),e.set(je("Year To Date Accrued"),"YTD_Accrued"),e.set(je("YTD Used"),"YTD_Used"),e.set(je("Year To Date Used"),"YTD_Used"),e.set(je("Balance"),"Balance"),e.set(je("Current Balance"),"Balance"),e.set(je("Available Balance"),"Balance"),console.log(`[PTOUpload] Fallback mappings: ${e.size} entries`),e}function je(e){return e?String(e).trim().toLowerCase().replace(/[_\-.]/g," ").replace(/\s+/g," "):""}async function Ji(){if(!St()){Ne("Excel is not available. Open this module inside Excel to run quality check.","info");return}ut.loading=!0,nr(!0,"Analyzing data quality..."),Gr(document.getElementById("quality-save-btn"),!1);try{await Excel.run(async r=>{var g;let t=r.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(t.load("isNullObject"),await r.sync(),t.isNullObject)throw new Error("PTO_Data_Clean not found. Upload data in Step 1.");let a=t.getUsedRangeOrNullObject();a.load("values"),await r.sync();let n=a.isNullObject?[]:a.values||[];if(!n.length||n.length<2)throw new Error("PTO_Data_Clean is empty or has no data rows.");let i=(n[0]||[]).map(v=>Ut(v));console.log("[Data Quality] PTO data headers:",n[0]);let s=i.findIndex(v=>v==="employee name"||v==="employeename");s===-1&&(s=i.findIndex(v=>v.includes("employee")&&v.includes("name"))),s===-1&&(s=i.findIndex(v=>v==="name"||v.includes("name")&&!v.includes("company")&&!v.includes("form"))),console.log("[Data Quality] Employee name column index:",s,"Header:",(g=n[0])==null?void 0:g[s]);let o=Tt(i,["balance"]),c=Tt(i,["accrual rate","accrualrate"]),l=Tt(i,["carry over","carryover"]),f=Tt(i,["ytd accrued","ytdaccrued"]),d=Tt(i,["ytd used","ytdused"]),u=[],p=[],m=[],h=n.slice(1);h.forEach((v,y)=>{let x=y+2,I=s!==-1?String(v[s]||"").trim():`Row ${x}`;if(!I)return;let R=o!==-1&&Number(v[o])||0,P=c!==-1&&Number(v[c])||0,k=l!==-1&&Number(v[l])||0,D=f!==-1&&Number(v[f])||0,N=d!==-1&&Number(v[d])||0,U=k+D;R<0?u.push({name:I,issue:`Negative balance: ${R.toFixed(2)} hrs`,rowIndex:x}):N>U&&U>0&&u.push({name:I,issue:`Used ${N.toFixed(0)} hrs but only ${U.toFixed(0)} available`,rowIndex:x}),R===0&&(k>0||D>0)&&p.push({name:I,rowIndex:x}),P>8&&m.push({name:I,accrualRate:P,rowIndex:x})}),ut.balanceIssues=u,ut.zeroBalances=p,ut.accrualOutliers=m,ut.totalIssues=u.length,ut.totalEmployees=h.filter(v=>v.some(y=>y!==null&&y!=="")).length,ut.hasRun=!0});let e=ut.balanceIssues.length>0;Qn({stepStatuses:{3:e?"blocked":"complete"}})}catch(e){console.error("Data quality check error:",e),Ne(`Quality check failed: ${e.message}`,"error"),ut.hasRun=!1}finally{ut.loading=!1,nr(!1),wt()}}function _E(){ut.acknowledged=!0,Qn({stepStatuses:{3:"complete"}}),wt()}async function kE(){if(St())try{await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.warn("[Completeness] PTO_Data_Clean not found");return}let t=e.workbook.worksheets.getItemOrNullObject("PTO_Analysis"),a=r.getUsedRangeOrNullObject();if(a.load("values"),t.load("isNullObject"),await e.sync(),t.isNullObject){yr.completenessCheck={accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null};return}let n=t.getUsedRangeOrNullObject();n.load("values"),await e.sync();let i=a.isNullObject?[]:a.values||[],s=n.isNullObject?[]:n.values||[];if(!i.length||!s.length){yr.completenessCheck={accrualRate:null,carryOver:null,ytdAccrued:null,ytdUsed:null,balance:null};return}let o=(f,d,u)=>{let p=(f[0]||[]).map(g=>Ut(g)),m=Tt(p,d);return m===-1?null:f.slice(1).reduce((g,v)=>g+(Number(v[m])||0),0)},c=[{key:"accrualRate",aliases:["accrual rate","accrualrate"]},{key:"carryOver",aliases:["carry over","carryover","carry_over"]},{key:"ytdAccrued",aliases:["ytd accrued","ytdaccrued","ytd_accrued"]},{key:"ytdUsed",aliases:["ytd used","ytdused","ytd_used"]},{key:"balance",aliases:["balance"]}],l={};for(let f of c){let d=o(i,f.aliases,"PTO_Data_Clean"),u=o(s,f.aliases,"PTO_Analysis");if(d===null||u===null)l[f.key]=null;else{let p=Math.abs(d-u)<.01;l[f.key]={match:p,ptoDataClean:d,ptoAnalysis:u}}}yr.completenessCheck=l})}catch(e){console.error("Completeness check failed:",e)}}async function Zf(){if(!St()){Ne("Excel is not available. Open this module inside Excel to run analysis.","info");return}nr(!0,"Running analysis...");try{await ku(),await kE(),yr.cleanDataReady=!0,wt()}catch(e){console.error("Full analysis error:",e),Ne(`Analysis failed: ${e.message}`,"error")}finally{nr(!1)}}async function hu(){if(!St()){Ne("Excel is not available. Open this module inside Excel to run journal checks.","info");return}Qe.loading=!0,Qe.lastError=null,Gr(document.getElementById("je-save-btn"),!1),wt();try{let e=await Excel.run(async r=>{let a=r.workbook.worksheets.getItem("PTO_JE_Draft").getUsedRangeOrNullObject();a.load("values");let n=r.workbook.worksheets.getItemOrNullObject("PTO_Analysis");n.load("isNullObject"),await r.sync();let i=a.isNullObject?[]:a.values||[];if(!i.length)throw new Error("PTO_JE_Draft is empty. Generate the JE first.");let s=(i[0]||[]).map(v=>Ut(v)),o=Tt(s,["debits","debit"]),c=Tt(s,["credits","credit"]),l=Tt(s,["account name","accountname"]);if(o===-1||c===-1)throw new Error("Could not find Debits and Credits columns in PTO_JE_Draft.");let f=0,d=0,u=0;i.slice(1).forEach(v=>{let y=Number(v[o])||0,x=Number(v[c])||0,I=l!==-1?String(v[l]||"").trim().toLowerCase():"";f+=y,d+=x,I&&!I.includes("clearing")&&(u+=y-x)});let p=0;if(!n.isNullObject){let v=n.getUsedRangeOrNullObject();v.load("values"),await r.sync();let y=v.isNullObject?[]:v.values||[];if(y.length>1){let x=(y[0]||[]).map(R=>Ut(R)),I=Tt(x,["change"]);I!==-1&&y.slice(1).forEach(R=>{p+=Number(R[I])||0})}}let m=f-d,h=[];Math.abs(m)>=.01?h.push({check:"Debits = Credits",passed:!1,detail:m>0?`Debits exceed credits by $${Math.abs(m).toLocaleString(void 0,{minimumFractionDigits:2})}`:`Credits exceed debits by $${Math.abs(m).toLocaleString(void 0,{minimumFractionDigits:2})}`}):h.push({check:"Debits = Credits",passed:!0,detail:""}),h.push({check:"Line Amounts Sum to Zero",passed:Math.abs(m)<.01,detail:Math.abs(m)<.01?"":`Difference: $${m.toFixed(2)}`});let g=Math.abs(u-p);return g>=.01?h.push({check:"JE Matches Analysis Total",passed:!1,detail:`JE expense total ($${u.toLocaleString(void 0,{minimumFractionDigits:2})}) differs from PTO_Analysis Change total ($${p.toLocaleString(void 0,{minimumFractionDigits:2})}) by $${g.toLocaleString(void 0,{minimumFractionDigits:2})}`}):h.push({check:"JE Matches Analysis Total",passed:!0,detail:""}),{debitTotal:f,creditTotal:d,difference:m,jeChangeTotal:u,analysisChangeTotal:p,issues:h,validationRun:!0}});Object.assign(Qe,e,{lastError:null})}catch(e){console.warn("PTO JE summary:",e),Qe.lastError=(e==null?void 0:e.message)||"Unable to calculate journal totals.",Qe.debitTotal=null,Qe.creditTotal=null,Qe.difference=null,Qe.jeChangeTotal=null,Qe.analysisChangeTotal=null,Qe.issues=[],Qe.validationRun=!1}finally{Qe.loading=!1,wt()}}var pu="PTO_Liability_Change",Qi="pto-accrual";function qo(e){return String(e!=null?e:"").replace(/\u00a0/g," ").trim().toLowerCase().replace(/\s+/g," ").replace(/&/g,"and")}async function EE(e){console.log("[PTO-JE] Loading GL mappings for company:",e);try{let r=`${Ko}/rest/v1/ada_customer_gl_mappings?company_id=eq.${e}&module=eq.${Qi}&pf_column_name=eq.${pu}&select=department,gl_account,gl_account_name`,t=await fetch(r,{headers:{apikey:an,Authorization:`Bearer ${an}`,"Content-Type":"application/json"}});if(!t.ok){let i=await t.text();throw new Error(`API error fetching GL mappings: ${t.status} - ${i}`)}let a=await t.json();console.log(`[PTO-JE] Fetched ${a.length} GL mapping rules`);let n=new Map;for(let i of a){let s=qo(i.department);s&&n.set(s,{gl_account:i.gl_account,gl_account_name:i.gl_account_name||""})}return console.log(`[PTO-JE] Built ${n.size} department -> GL mappings`),n}catch(r){throw console.error("[PTO-JE] Error loading GL mappings:",r),r}}async function bE(){let e=new Map;if(!St())throw new Error("Excel runtime not available");return await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");if(t.load("isNullObject"),await r.sync(),t.isNullObject)throw new Error("PTO_Review sheet not found. Run Step 2 (PTO Accrual Review) first.");let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)throw new Error("PTO_Review is empty. Run Step 2 first.");let n=a.values[0].map(o=>String(o||"").toLowerCase().trim()),i=n.findIndex(o=>o==="department"),s=n.findIndex(o=>o==="change");if(i<0||s<0)throw new Error(`Required columns not found in PTO_Review. Found: ${n.join(", ")}`);for(let o=1;o<a.values.length;o++){let c=a.values[o],l=String(c[i]||"").trim(),f=parseFloat(c[s])||0;if(!l||Math.abs(f)<.01)continue;let d=e.get(l)||0;e.set(l,d+f)}await r.sync()}),console.log("[PTO-JE] Department totals:",Object.fromEntries(e)),e}async function mu(e,r,t){let a,n,i,s;typeof e=="object"&&e!==null&&!Array.isArray(e)&&e.userPrompt!==void 0?{systemPrompt:a,userPrompt:n,contextPack:i,functionContext:s}=e:(n=e,i=r,s="analysis");let o="https://jgciqwzwacaesqjaoadc.supabase.co/functions/v1/copilot",c="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnY2lxd3p3YWNhZXNxamFvYWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzODgzMTIsImV4cCI6MjA3NTk2NDMxMn0.DsoUTHcm1Uv65t4icaoD0Tzf3ULIU54bFnoYw8hHScE",l=Re.company_id;try{console.log("[Ada] Calling copilot API...",{module:Qi,function:s||"analysis",customerId:l?"set":"not set"});let f=await fetch(o,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`,apikey:c},body:JSON.stringify({prompt:n,context:i,module:Qi,function:s||"analysis",customerId:l,...a?{systemPrompt:a}:{}})});if(!f.ok){let u=await f.text();throw console.error("[Ada] API error:",f.status,u),new Error(`API request failed: ${f.status}`)}let d=await f.json();return console.log("[Ada] API response received:",d.usage||"no usage info"),d.message||d.response?d.message||d.response:(console.warn("[Ada] No message in API response, using local generation"),Qf(params))}catch(f){return console.warn("[Ada] API call failed, using local generation:",f),Qf(params)}}function Qf(e){var n,i,s,o,c,l,f,d,u,p,m;let{userPrompt:r,contextPack:t}=e,a=(r||"").toLowerCase();return a.includes("diagnostic")||a.includes("check")?`**PTO Data Diagnostics:**

\u2713 **Data Completeness**: PTO file uploaded and processed successfully
\u2713 **Header Mapping**: All required columns identified and mapped
\u2713 **Rate Engine**: Pay rate calculations completed
\u2713 **Balance Calculations**: PTO balances computed for all employees

\u26A0\uFE0F **Potential Issues**:
\u2022 ${((n=t==null?void 0:t.summary)==null?void 0:n.missingRateCount)||0} employees missing pay rates
\u2022 Balance validation may be needed for large changes

**Next Steps:**
1. Review any missing pay rate warnings
2. Generate the accrual review table
3. Proceed to journal entry preparation`:a.includes("insight")||a.includes("analysis")?`**PTO Accrual Analysis:**

\u{1F4CA} **Key Metrics:**
\u2022 Total Current Liability: $${(((i=t==null?void 0:t.summary)==null?void 0:i.totalCurrent)||0).toLocaleString()}
\u2022 Total Prior Liability: $${(((s=t==null?void 0:t.summary)==null?void 0:s.totalPrior)||0).toLocaleString()}
\u2022 Net Change: $${(((o=t==null?void 0:t.summary)==null?void 0:o.netChange)||0).toLocaleString()}
\u2022 Active Employees: ${((c=t==null?void 0:t.summary)==null?void 0:c.employeeCount)||0}

\u{1F4A1} **Executive Insights:**
1. **Liability Trend**: ${(((l=t==null?void 0:t.summary)==null?void 0:l.netChange)||0)>=0?"Increasing":"Decreasing"} PTO liability
2. **Employee Coverage**: ${((f=t==null?void 0:t.summary)==null?void 0:f.employeeCount)||0} employees with PTO tracking
3. **Pay Rate Completeness**: ${(((d=t==null?void 0:t.summary)==null?void 0:d.missingRateCount)||0)===0?"Complete":"Missing rates for some employees"}

**Recommendations:**
\u2022 Review any employees with missing pay rates
\u2022 Monitor PTO liability trends quarter-over-quarter
\u2022 Ensure accurate employee headcount for future accruals`:`**PTO Analysis Assistant**

I can help you analyze your PTO accrual data. Try asking me about:

\u2022 **Diagnostics** - Check data quality and completeness
\u2022 **Insights** - Key findings and trends
\u2022 **Balances** - Employee PTO balance analysis
\u2022 **Accruals** - Liability calculation details

Your PTO data includes:
- ${((u=t==null?void 0:t.summary)==null?void 0:u.employeeCount)||0} employees
- Current liability: $${(((p=t==null?void 0:t.summary)==null?void 0:p.totalCurrent)||0).toLocaleString()}
- Net change: $${(((m=t==null?void 0:t.summary)==null?void 0:m.netChange)||0).toLocaleString()}

What would you like to explore?`}async function TE(){if(!St()){Ne("Excel is not available. Open this module inside Excel to create the journal entry.","info");return}nr(!0,"Creating PTO Journal Entry...");try{let e=Re.company_id;if(!e)throw new Error("Company ID not found. Please check your installation configuration.");let r=$t(_e.journalEntryId)||"",t=$t(_e.payrollDate)||"";if(console.log(`
\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550`),console.log("PTO JOURNAL ENTRY GENERATION (QuickBooks Format)"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log(`  Company ID: ${e}`),console.log(`  JournalNo (PTO_Journal_Entry_ID): ${r}`),console.log(`  JournalDate (PTO_Payroll_Date): ${t}`),!r)throw new Error("Journal Entry ID not set. Please enter a Journal Entry ID in the Configuration step.");if(!t)throw new Error("Payroll Date not set. Please enter a Payroll Date in the Configuration step.");let a=t;try{let h;if(typeof t=="number"||/^\d{4,5}$/.test(String(t).trim())){let g=Number(t),v=new Date(1899,11,30);h=new Date(v.getTime()+g*24*60*60*1e3)}else h=new Date(t);if(!isNaN(h.getTime())&&h.getFullYear()>1970){let g=String(h.getMonth()+1).padStart(2,"0"),v=String(h.getDate()).padStart(2,"0"),y=h.getFullYear();a=`${g}/${v}/${y}`}}catch{console.warn("[PTO-JE] Could not parse date, using as-is:",t)}let n=await EE(e);if(console.log(`  GL Mappings loaded: ${n.size}`),n.size===0)throw new Error(`No GL mappings found for PTO_Liability_Change.

Please configure GL mappings in ada_customer_gl_mappings:
  - company_id: ${e}
  - module: ${Qi}
  - pf_column_name: ${pu}
  - department: (your department names)
  - gl_account: (expense account numbers)`);let i=await bE();if(console.log(`  Departments with changes: ${i.size}`),i.size===0)throw new Error(`No department totals found with non-zero changes.

Please run Step 2 (PTO Accrual Review) first to generate change data.`);let s=[];for(let[h]of i){let g=qo(h);n.has(g)||s.push(h)}if(s.length>0)throw new Error(`Missing GL mappings for departments:
`+s.map(h=>`  \u2022 ${h}`).join(`
`)+`

Please add GL mappings for these departments in ada_customer_gl_mappings.`);let o=new Map;await Excel.run(async h=>{try{let g=h.workbook.worksheets.getItemOrNullObject("SS_Chart_of_Accounts");if(g.load("isNullObject"),await h.sync(),!g.isNullObject){let v=g.getUsedRangeOrNullObject();if(v.load("isNullObject"),await h.sync(),!v.isNullObject&&(v.load("values"),await h.sync(),v.values&&v.values.length>1)){let y=v.values[0],x=v.values.slice(1),I=y.findIndex(P=>{let k=String(P||"").toLowerCase().trim().replace(/[^a-z0-9]/g,"_");return k.includes("account")&&k.includes("num")||k==="account_number"||k==="number"}),R=y.findIndex(P=>{let k=String(P||"").toLowerCase().trim().replace(/[^a-z0-9]/g,"_");return k.includes("account")&&k.includes("name")||k==="account_name"||k==="name"});if(I>=0&&R>=0){for(let P of x){let k=String(P[I]||"").trim(),D=String(P[R]||"").trim();k&&o.set(k,D)}console.log(`  Chart of Accounts: ${o.size} accounts loaded`)}}}}catch(g){console.warn("[PTO-JE] Error reading SS_Chart_of_Accounts (non-fatal):",g.message)}});let c=["JournalNo","JournalDate","Account Name","Debits","Credits","Description"],l=[],f=0,d=0;for(let[h,g]of i){if(Math.abs(g)<.01)continue;let v=qo(h),y=n.get(v),x=String(y.gl_account||"").trim(),I,R=o.get(x);R?I=`${x} ${R}`:y.gl_account_name?I=`${x} ${y.gl_account_name}`:I=x;let P=Math.abs(g),k=`${h}${h?" - ":""}PTO Liability Change`;g>0?(f+=P,l.push([r,a,I,P,"",k])):(d+=P,l.push([r,a,I,"",P,k]))}let u="21540 Accrued Expenses:Accrued PTO Liability",p=f-d;if(Math.abs(p)>=.01&&(p>0?(l.push([r,a,u,"",p,"Accrued PTO Liability"]),d+=p):(l.push([r,a,u,Math.abs(p),"","Accrued PTO Liability"]),f+=Math.abs(p))),Math.abs(f-d)>.01)throw new Error(`JE is out of balance!
  Total Debits: ${f.toFixed(2)}
  Total Credits: ${d.toFixed(2)}
  Difference: ${(f-d).toFixed(2)}

Cannot write unbalanced journal entry.`);console.log(`  JE Lines: ${l.length}`),console.log(`  Total Debits: $${f.toFixed(2)}`),console.log(`  Total Credits: $${d.toFixed(2)}`),console.log(`\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550
`),await Excel.run(async h=>{let g=h.workbook.worksheets.getItemOrNullObject("PTO_JE_Draft");if(g.load("isNullObject"),await h.sync(),g.isNullObject)g=h.workbook.worksheets.add("PTO_JE_Draft"),console.log("[PTO-JE] Created PTO_JE_Draft sheet");else{g.visibility=Excel.SheetVisibility.visible;let R=g.getUsedRangeOrNullObject();await h.sync(),R.isNullObject||R.clear(),console.log("[PTO-JE] Cleared existing PTO_JE_Draft")}let v=[c,...l],y=g.getRangeByIndexes(0,0,v.length,c.length);y.values=v;let x=g.getRangeByIndexes(0,0,1,c.length);en(x);let I=l.length;if(I>0){let R="$#,##0.00";g.getRangeByIndexes(1,3,I,1).numberFormat=[[R]],g.getRangeByIndexes(1,4,I,1).numberFormat=[[R]]}y.format.autofitColumns(),g.freezePanes.freezeRows(1),g.activate(),await h.sync()}),Qe.debitTotal=f,Qe.creditTotal=d,Qe.validationRun=!0,Qe.lastError=null,await hu(),Ne(`Journal Entry created: ${l.length} lines (including offset), $${f.toFixed(2)} balanced \u2713`,"success"),wt()}catch(e){console.error("[PTO-JE] Error:",e),Qe.lastError=e.message,Ne(`Unable to create Journal Entry: ${e.message}`,"error")}finally{nr(!1)}}async function SE(){if(!St()){Ne("Excel is not available. Open this module inside Excel to export.","info");return}nr(!0,"Preparing JE CSV...");try{let{rows:e}=await Excel.run(async o=>{let l=o.workbook.worksheets.getItem("PTO_JE_Draft").getUsedRangeOrNullObject();l.load("values"),await o.sync();let f=l.isNullObject?[]:l.values||[];if(!f.length)throw new Error("PTO_JE_Draft is empty.");return{rows:f}}),r=(e[0]||[]).map(o=>String(o||"").trim().toLowerCase()),t=r.findIndex(o=>o.includes("debit")),a=r.findIndex(o=>o.includes("credit")),n=r.findIndex(o=>o.includes("journaldate")||o.includes("txndate")||o==="date"),i=e.map((o,c)=>{if(c===0)return o;let l=[...o||[]],f=u=>{if(u===null||u==="")return"";let p=Number(u);return Number.isFinite(p)?p.toFixed(2):""},d=u=>{if(u===null||u==="")return"";if(typeof u=="string"&&/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(u.trim()))return u.trim();if(typeof u=="number"&&Number.isFinite(u)){let p=Math.round((u-25569)*86400*1e3),m=new Date(p);if(Number.isFinite(m.getTime())){let h=String(m.getMonth()+1).padStart(2,"0"),g=String(m.getDate()).padStart(2,"0"),v=m.getFullYear();if(v>=1900&&v<=2100)return`${h}/${g}/${v}`}}if(u instanceof Date&&Number.isFinite(u.getTime())){let p=String(u.getMonth()+1).padStart(2,"0"),m=String(u.getDate()).padStart(2,"0"),h=u.getFullYear();return`${p}/${m}/${h}`}return String(u)};return t>=0&&(l[t]=f(l[t])),a>=0&&(l[a]=f(l[a])),n>=0&&(l[n]=d(l[n])),l}),s=KE(i);JE(`pto-je-draft-${Zo()}.csv`,s)}catch(e){console.error("PTO JE export:",e),Ne("Unable to export the JE draft. Confirm the sheet has data.","error")}finally{nr(!1)}}async function gu(){let e=$t(_e.accountingSoftware)||$t("SS_Accounting_Software");if(!e&&xt())try{let r=await ai(ca);e=r.SS_Accounting_Software||r.Accounting_Software||r[_e.accountingSoftware]}catch(r){console.warn("Error reading accounting software URL:",r)}if(!e){Ne("No accounting software URL configured. Add SS_Accounting_Software to SS_PF_Config.","info",5e3);return}!e.startsWith("http://")&&!e.startsWith("https://")&&(e="https://"+e),window.open(e,"_blank"),Ne("Opening accounting software...","success",2e3)}function CE(e,r={}){return new Promise(t=>{let{title:a="Confirm",confirmText:n="Confirm",cancelText:i="Cancel",icon:s="\u{1F4E6}"}=r;document.querySelectorAll(".pf-confirm-dialog").forEach(c=>c.remove());let o=document.createElement("div");if(o.className="pf-confirm-dialog",o.innerHTML=`
            <div class="pf-confirm-backdrop"></div>
            <div class="pf-confirm-content">
                <div class="pf-confirm-icon">${s}</div>
                <div class="pf-confirm-title">${be(a)}</div>
                <div class="pf-confirm-message">${be(e).replace(/\n/g,"<br>")}</div>
                <div class="pf-confirm-buttons">
                    <button type="button" class="pf-confirm-btn pf-confirm-btn--cancel">${be(i)}</button>
                    <button type="button" class="pf-confirm-btn pf-confirm-btn--confirm">${be(n)}</button>
                </div>
            </div>
        `,!document.getElementById("pf-confirm-dialog-styles")){let c=document.createElement("style");c.id="pf-confirm-dialog-styles",c.textContent=`
                .pf-confirm-dialog { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 10001; display: flex; align-items: center; justify-content: center; }
                .pf-confirm-backdrop { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); }
                .pf-confirm-content { position: relative; background: linear-gradient(145deg, rgba(30, 30, 50, 1), rgba(20, 20, 35, 1)); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 16px; padding: 24px; max-width: 320px; text-align: center; box-shadow: 0 24px 64px rgba(0,0,0,0.5); }
                .pf-confirm-icon { font-size: 40px; margin-bottom: 12px; }
                .pf-confirm-title { font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 12px; }
                .pf-confirm-message { font-size: 13px; color: rgba(255,255,255,0.7); line-height: 1.5; margin-bottom: 20px; text-align: left; }
                .pf-confirm-buttons { display: flex; gap: 12px; justify-content: center; }
                .pf-confirm-btn { padding: 10px 20px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; border: none; transition: all 0.2s; }
                .pf-confirm-btn--cancel { background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); }
                .pf-confirm-btn--cancel:hover { background: rgba(255,255,255,0.15); }
                .pf-confirm-btn--confirm { background: linear-gradient(145deg, #6366f1, #4f46e5); color: white; }
                .pf-confirm-btn--confirm:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4); }
            `,document.head.appendChild(c)}document.body.appendChild(o),o.querySelector(".pf-confirm-btn--cancel").addEventListener("click",()=>{o.remove(),t(!1)}),o.querySelector(".pf-confirm-btn--confirm").addEventListener("click",()=>{o.remove(),t(!0)}),o.querySelector(".pf-confirm-backdrop").addEventListener("click",()=>{o.remove(),t(!1)})})}async function AE(){if(!rt.workbookReady||!St()){Ne("Excel not available","error");return}if(!await CE(`This will:

\u2022 Download an Excel archive file
\u2022 Update PTO_Archive_Summary
\u2022 Clear working data from all sheets
\u2022 Reset non-permanent notes & config

Make sure you've completed all review steps.`,{title:"Archive PTO Run",icon:"\u{1F4E6}",confirmText:"Archive Now",cancelText:"Not Yet"})){console.log("[PTOArchive] User cancelled"),Ne("Archive cancelled","info",2e3);return}console.log("[PTOArchive] User confirmed, starting archive process..."),nr(!0,"Archiving PTO data...");try{if(console.log("[PTOArchive] Step 1: Creating archive workbook..."),!await OE()){console.log("[PTOArchive] Archive file creation failed");return}console.log("[PTOArchive] Step 1 complete: Archive file downloaded"),console.log("[PTOArchive] Step 2: Updating PTO_Archive_Summary...");let t=Je.reviewData;if((!t||t.length===0)&&(t=await FE()),t&&t.length>0){let a=$t(_e.payrollDate)||new Date().toISOString().substring(0,10),n=await nE(t,a);console.log("[PTOArchive] Archive summary result:",n)}else console.warn("[PTOArchive] No review data to archive");console.log("[PTOArchive] Step 2 complete: Archive summary updated"),console.log("[PTOArchive] Step 3: Clearing working data..."),await IE(),console.log("[PTOArchive] Step 3 complete: Working data cleared"),console.log("[PTOArchive] Step 4: Clearing non-permanent config..."),await PE(),console.log("[PTOArchive] Step 4 complete: Config reset"),console.log("[PTOArchive] Archive workflow complete!"),Je.loaded=!1,Je.reviewData=[],Je.totalCurrentLiability=0,Je.totalPriorLiability=0,Je.netChange=0,Je.employeeCount=0,zt.loaded=!1,zt.rates.clear(),Qe.validationRun=!1,Qe.debitTotal=null,Qe.creditTotal=null,await cu(),wt(),RE()}catch(r){console.error("[PTOArchive] Error during archive:",r),Ne("Archive Error: "+r.message,"error",1e4)}finally{nr(!1)}}async function OE(){try{let e=$t(_e.payrollDate)||new Date().toISOString().split("T")[0],r=`PTO_Archive_${e}.xlsx`;return console.log("[PTOArchive] Creating Excel archive file..."),await Excel.run(async t=>{let n=t.workbook.worksheets;n.load("items/name"),await t.sync();let i=["PTO_JE_Draft","PTO_Review","PTO_Data_Clean"],s=Oa.book_new(),o=0,c=[];c.push(["PTO Archive Summary"]),c.push(["Archived At",new Date().toISOString()]),c.push(["Analysis Date",e]),c.push(["Company",Re.ss_company_name||""]),c.push([""]),c.push(["Total Liability",Je.totalCurrentLiability||0]),c.push(["Employee Count",Je.employeeCount||0]);let l=Oa.aoa_to_sheet(c);Oa.book_append_sheet(s,l,"Summary");for(let m of i){let h=n.items.find(y=>y.name===m);if(!h){console.log(`[PTOArchive] Sheet not found: ${m}`);continue}let g=h.getUsedRangeOrNullObject();if(g.load("values"),await t.sync(),g.isNullObject||!g.values||g.values.length===0){console.log(`[PTOArchive] Sheet empty: ${m}`);continue}let v=Oa.aoa_to_sheet(g.values);Oa.book_append_sheet(s,v,m.substring(0,31)),o++}if(o===0)return console.warn("[PTOArchive] No sheets had data to archive"),Ne("No data to archive. Complete the PTO review first.","warning"),!1;let f=Io(s,{bookType:"xlsx",type:"array"}),d=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),u=URL.createObjectURL(d),p=document.createElement("a");return p.href=u,p.download=r,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(u),console.log(`[PTOArchive] Downloaded: ${r} (${o} sheets)`),Ne(`Archive downloaded: ${r}`,"success",3e3),!0})}catch(e){return console.error("[PTOArchive] Error creating archive:",e),Ne("Failed to create archive file: "+e.message,"error"),!1}}async function FE(){let e=[];try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItemOrNullObject("PTO_Review");if(t.load("isNullObject"),await r.sync(),t.isNullObject)return;let a=t.getUsedRangeOrNullObject();if(a.load("values"),await r.sync(),a.isNullObject||!a.values||a.values.length<2)return;let n=a.values[0].map(s=>String(s||"").toLowerCase().trim()),i={employeeName:n.findIndex(s=>s.includes("employee")),department:n.findIndex(s=>s==="department"),payRate:n.findIndex(s=>s.includes("pay")&&s.includes("rate")),accrualRate:n.findIndex(s=>s.includes("accrual")&&s.includes("rate")),carryOver:n.findIndex(s=>s.includes("carry")),ytdAccrued:n.findIndex(s=>s.includes("ytd")&&s.includes("accrued")),ytdUsed:n.findIndex(s=>s.includes("ytd")&&s.includes("used")),balance:n.findIndex(s=>s==="balance"),liabilityAmount:n.findIndex(s=>s.includes("liability")),priorLiability:n.findIndex(s=>s.includes("prior")),change:n.findIndex(s=>s==="change")};for(let s=1;s<a.values.length;s++){let o=a.values[s];e.push({employeeName:i.employeeName>=0?String(o[i.employeeName]||""):"",department:i.department>=0?String(o[i.department]||""):"",payRate:i.payRate>=0&&parseFloat(o[i.payRate])||0,accrualRate:i.accrualRate>=0&&parseFloat(o[i.accrualRate])||0,carryOver:i.carryOver>=0&&parseFloat(o[i.carryOver])||0,ytdAccrued:i.ytdAccrued>=0&&parseFloat(o[i.ytdAccrued])||0,ytdUsed:i.ytdUsed>=0&&parseFloat(o[i.ytdUsed])||0,balance:i.balance>=0&&parseFloat(o[i.balance])||0,liabilityAmount:i.liabilityAmount>=0&&parseFloat(o[i.liabilityAmount])||0})}await r.sync()})}catch(r){console.error("[PTOArchive] Error reading PTO_Review:",r)}return e}async function IE(){let e=["PTO_Data_Clean","PTO_Review","PTO_JE_Draft"];await Excel.run(async r=>{for(let t of e){let a=r.workbook.worksheets.getItemOrNullObject(t);if(a.load("isNullObject"),await r.sync(),a.isNullObject){console.log(`[PTOArchive] Sheet not found: ${t}`);continue}let n=a.getUsedRangeOrNullObject();if(n.load("rowCount,columnCount,address"),await r.sync(),n.isNullObject||n.rowCount<=1){console.log(`[PTOArchive] Sheet empty or headers only: ${t}`);continue}a.getRange(`A2:${String.fromCharCode(64+Math.min(n.columnCount,26))}${n.rowCount}`).clear(Excel.ClearApplyTo.contents),await r.sync(),console.log(`[PTOArchive] Cleared data from: ${t}`)}})}async function PE(){await Excel.run(async e=>{let r=e.workbook.worksheets.getItemOrNullObject("SS_PF_Config");if(r.load("isNullObject"),await e.sync(),r.isNullObject){console.warn("[PTOArchive] SS_PF_Config sheet not found");return}let t=r.getUsedRangeOrNullObject();if(t.load("values,rowCount,columnCount"),await e.sync(),t.isNullObject||!t.values||t.values.length<2)return;let a=t.values[0].map(f=>String(f||"").toLowerCase().trim()),n=a.findIndex(f=>f==="field"||f==="setting"||f==="key"),i=a.findIndex(f=>f==="value"),s=a.findIndex(f=>f==="permanent"||f==="persist");if(n<0||i<0){console.warn("[PTOArchive] Could not find field/value columns in config");return}let o=[_e.payrollDate,_e.accountingPeriod,_e.journalEntryId],c=t.values.map((f,d)=>{if(d===0)return f;let u=String(f[n]||"").trim(),p=s>=0&&String(f[s]||"").toUpperCase()==="Y";if(o.includes(u)&&!p){let m=[...f];return m[i]="",m}return f}),l=r.getRangeByIndexes(0,0,c.length,a.length);l.values=c,await e.sync(),console.log("[PTOArchive] Non-permanent config values cleared")})}function RE(){document.querySelectorAll(".pf-save-prompt").forEach(t=>t.remove());let e=document.createElement("div");if(e.className="pf-save-prompt",e.innerHTML=`
        <div class="pf-save-prompt-content">
            <div class="pf-save-prompt-title">Good work!</div>
            <div class="pf-save-prompt-subtitle">Ready to finalize?</div>
            <button type="button" class="pf-save-prompt-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
                Finalize
            </button>
        </div>
    `,!document.getElementById("pf-save-prompt-styles")){let t=document.createElement("style");t.id="pf-save-prompt-styles",t.textContent=`
            .pf-save-prompt {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(145deg, rgba(30, 30, 50, 0.98), rgba(20, 20, 35, 0.99));
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 32px 40px;
                border-radius: 20px;
                box-shadow: 
                    0 24px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 60px rgba(99, 102, 241, 0.1);
                z-index: 10002;
                text-align: center;
                animation: pf-prompt-fade-in 0.3s ease;
            }
            @keyframes pf-prompt-fade-in {
                from { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
                to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            }
            .pf-save-prompt-content {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            .pf-save-prompt-title {
                font-size: 20px;
                font-weight: 700;
                color: #fff;
            }
            .pf-save-prompt-subtitle {
                font-size: 14px;
                color: rgba(255, 255, 255, 0.6);
                margin-bottom: 12px;
            }
            .pf-save-prompt-btn {
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border: none;
                color: white;
                padding: 16px 40px;
                border-radius: 12px;
                font-size: 18px;
                font-weight: 700;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
                transition: all 0.2s ease;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4), 0 0 0 2px rgba(99, 102, 241, 0.2);
                margin-top: 8px;
            }
            .pf-save-prompt-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 12px 32px rgba(99, 102, 241, 0.5), 0 0 0 2px rgba(99, 102, 241, 0.3);
                background: linear-gradient(145deg, #7c3aed, #6366f1);
            }
            .pf-save-prompt-btn:active {
                transform: translateY(-1px);
            }
            .pf-save-prompt.closing {
                animation: pf-prompt-fade-out 0.2s ease forwards;
            }
            @keyframes pf-prompt-fade-out {
                to { opacity: 0; transform: translate(-50%, -50%) scale(0.95); }
            }
        `,document.head.appendChild(t)}document.body.appendChild(e),e.querySelector(".pf-save-prompt-btn").addEventListener("click",()=>{e.classList.add("closing"),setTimeout(()=>{e.remove(),NE()},200)})}function NE(){document.querySelectorAll(".pf-toast, .pf-success-toast").forEach(n=>n.remove());let e=[{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"/></svg>',title:"Done.",subtitle:"Efficiency unlocked."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"/><path d="m9 12 2 2 4-4"/></svg>',title:"Locked in.",subtitle:"You're good to go."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><path d="M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z"/><path d="M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z"/></svg>',title:"Stored.",subtitle:"Everything stays aligned."},{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>',title:"PTO archived.",subtitle:"Flow restored."}],r=e[Math.floor(Math.random()*e.length)],t=document.createElement("div");if(t.className="pf-success-toast",t.innerHTML=`
        <div class="pf-success-toast-icon">${r.icon}</div>
        <div class="pf-success-toast-text">
            <div class="pf-success-toast-title">${r.title}</div>
            <div class="pf-success-toast-subtitle">${r.subtitle}</div>
        </div>
        <div class="pf-success-toast-progress"></div>
    `,!document.getElementById("pf-success-toast-styles")){let n=document.createElement("style");n.id="pf-success-toast-styles",n.textContent=`
            .pf-success-toast {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(145deg, rgba(30, 30, 50, 0.98), rgba(20, 20, 35, 0.99));
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: white;
                padding: 36px 48px 24px;
                border-radius: 24px;
                box-shadow: 
                    0 32px 64px rgba(0, 0, 0, 0.5),
                    0 0 0 1px rgba(99, 102, 241, 0.2) inset,
                    0 0 80px rgba(99, 102, 241, 0.15);
                z-index: 10002;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 16px;
                animation: pf-success-in 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                overflow: hidden;
                text-align: center;
                min-width: 220px;
            }
            @keyframes pf-success-in {
                from { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.9);
                }
                to { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
            }
            @keyframes pf-success-out {
                from { 
                    opacity: 1; 
                    transform: translate(-50%, -50%) scale(1);
                }
                to { 
                    opacity: 0; 
                    transform: translate(-50%, -50%) scale(0.95) translateY(-20px);
                }
            }
            .pf-success-toast-icon {
                width: 64px;
                height: 64px;
                background: linear-gradient(145deg, #6366f1, #4f46e5);
                border-radius: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
                animation: pf-icon-pulse 2s ease-in-out infinite;
            }
            @keyframes pf-icon-pulse {
                0%, 100% { box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4); }
                50% { box-shadow: 0 8px 32px rgba(99, 102, 241, 0.6); }
            }
            .pf-success-toast-text {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
            }
            .pf-success-toast-title {
                font-size: 22px;
                font-weight: 700;
                color: #fff;
                letter-spacing: -0.5px;
            }
            .pf-success-toast-subtitle {
                font-size: 15px;
                color: rgba(255, 255, 255, 0.6);
                font-weight: 500;
            }
            .pf-success-toast-progress {
                position: absolute;
                bottom: 0;
                left: 0;
                height: 4px;
                background: linear-gradient(90deg, #6366f1, #a855f7, #6366f1);
                background-size: 200% 100%;
                animation: pf-progress-shrink 5s linear forwards, pf-progress-shimmer 1s linear infinite;
                border-radius: 0 0 24px 24px;
            }
            @keyframes pf-progress-shrink {
                from { width: 100%; }
                to { width: 0%; }
            }
            @keyframes pf-progress-shimmer {
                from { background-position: 200% 0; }
                to { background-position: -200% 0; }
            }
            .pf-success-toast.closing {
                animation: pf-success-out 0.3s ease forwards;
            }
            .pf-success-backdrop {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.4);
                backdrop-filter: blur(4px);
                -webkit-backdrop-filter: blur(4px);
                z-index: 10001;
                animation: pf-confirm-fade-in 0.2s ease;
            }
        `,document.head.appendChild(n)}let a=document.createElement("div");a.className="pf-success-backdrop",document.body.appendChild(a),document.body.appendChild(t),setTimeout(()=>{t.classList.add("closing"),a.style.opacity="0",a.style.transition="opacity 0.3s ease",setTimeout(()=>{t.remove(),a.remove(),DE()},300)},5e3)}async function DE(){try{await ni("module-selector")}catch(e){console.warn("[PTO] Could not apply module-selector tab visibility before redirect:",e)}window.location.href="../module-selector/index.html"}async function LE(e){if(!(!e||!St()))try{await Excel.run(async r=>{let t=r.workbook.worksheets.getItem(e);t.activate(),t.getRange("A1").select(),await r.sync()})}catch(r){console.error(r)}}function $t(e){var t,a;let r=String(e!=null?e:"").trim();return(a=(t=Ae.values)==null?void 0:t[r])!=null?a:""}function ei(e){var t;if(e)return e;let r=$t(_e.reviewerName);if(r)return r;if((t=window.PrairieForge)!=null&&t._sharedConfigCache){let a=window.PrairieForge._sharedConfigCache.get("SS_Default_Reviewer")||window.PrairieForge._sharedConfigCache.get("Default_Reviewer");if(a)return a}return""}function Nr(e,r,t={}){var s;let a=String(e!=null?e:"").trim();if(!a)return;Ae.values[a]=r!=null?r:"";let n=(s=t.debounceMs)!=null?s:0;if(!n){let o=rn.get(a);o&&clearTimeout(o),rn.delete(a),un(a,r!=null?r:"",ca);return}rn.has(a)&&clearTimeout(rn.get(a));let i=setTimeout(()=>{rn.delete(a),un(a,r!=null?r:"",ca)},n);rn.set(a,i)}function Ut(e){return String(e!=null?e:"").trim().toLowerCase()}function nr(e,r="Working..."){let t=document.getElementById(yk);t&&(t.style.display="none")}function zo(){Tk()}typeof Office!="undefined"&&Office.onReady?Office.onReady(()=>zo()).catch(()=>zo()):zo();function ti(e){return Ae.steps[e]||{notes:"",reviewer:"",signOffDate:""}}function xu(e){return es[e]||{}}function BE(e){return e===0?"config":e===1?"upload":e===2?"review":e===3?"journal":e===4?"archive":""}async function xr(e,r,t){let a=Ae.steps[e]||{notes:"",reviewer:"",signOffDate:""};a[r]=t,Ae.steps[e]=a;let n=xu(e),i=r==="notes"?n.note:r==="reviewer"?n.reviewer:n.signOff;if(i&&xt())try{await un(i,t,ca)}catch(s){console.warn("PTO: unable to save field",i,s)}}async function vu(e,r){Ae.permanents[e]=r;let t=xu(e);if(t!=null&&t.note&&xt())try{await Excel.run(async a=>{var u;let n=a.workbook.tables.getItemOrNullObject(ca[0]);if(await a.sync(),n.isNullObject)return;let i=n.getDataBodyRange(),s=n.getHeaderRowRange();i.load("values"),s.load("values"),await a.sync();let o=s.values[0]||[],c=o.map(p=>String(p||"").trim().toLowerCase()),l={field:c.findIndex(p=>p==="field"||p==="field name"||p==="setting"),permanent:c.findIndex(p=>p==="permanent"||p==="persist"),value:c.findIndex(p=>p==="value"||p==="setting value"),type:c.findIndex(p=>p==="type"||p==="category"),title:c.findIndex(p=>p==="title"||p==="display name")};if(l.field===-1)return;let d=(i.values||[]).findIndex(p=>String(p[l.field]||"").trim()===t.note);if(d>=0)l.permanent>=0&&(i.getCell(d,l.permanent).values=[[r?"Y":"N"]]);else{let p=new Array(o.length).fill("");l.type>=0&&(p[l.type]="Other"),l.title>=0&&(p[l.title]=""),p[l.field]=t.note,l.permanent>=0&&(p[l.permanent]=r?"Y":"N"),l.value>=0&&(p[l.value]=((u=Ae.steps[e])==null?void 0:u.notes)||""),n.rows.add(null,[p])}await a.sync()})}catch(a){console.warn("PTO: unable to update permanent flag",a)}}async function yu(e,r){let t=ou[e];if(t&&(Ae.completes[e]=r?"Y":"",!!xt()))try{await un(t,r?"Y":"",ca)}catch(a){console.warn("PTO: unable to save completion flag",t,a)}}function eu(e,r){e&&(e.classList.toggle("is-active",r),e.setAttribute("aria-pressed",String(r)))}function ME(){let e={};return Object.keys(es).forEach(r=>{var i;let t=parseInt(r,10),a=!!((i=Ae.steps[t])!=null&&i.signOffDate),n=!!Ae.completes[t];e[t]=a||n}),e}function wu(e,{buttonId:r,inputId:t,canActivate:a=null,onComplete:n=null}){var c;let i=document.getElementById(r);if(!i)return;let s=document.getElementById(t),o=!!((c=Ae.steps[e])!=null&&c.signOffDate)||!!Ae.completes[e];eu(i,o),i.addEventListener("click",()=>{if(!i.classList.contains("is-active")&&e>0){let d=ME(),{canComplete:u,message:p}=Hf(e,d);if(!u){Vf(p);return}}if(typeof a=="function"&&!a())return;let f=!i.classList.contains("is-active");eu(i,f),s&&(s.value=f?Zo():"",xr(e,"signOffDate",s.value)),yu(e,f),f&&window.scrollTo({top:0,behavior:"smooth"}),f&&typeof n=="function"&&n()})}function be(e){return String(e!=null?e:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function _u(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="true"||r==="y"||r==="yes"||r==="1"}function ts(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="true"||r==="y"||r==="yes"||r==="1"}function Jo(e){if(!e)return null;let r=/^(\d{4})-(\d{2})-(\d{2})$/.exec(String(e));if(!r)return null;let t=Number(r[1]),a=Number(r[2]),n=Number(r[3]);return!t||!a||!n?null:{year:t,month:a,day:n}}function tu(e){if(!e)return"";let r=Jo(e);if(!r)return"";let{year:t,month:a,day:n}=r;return`${t}-${String(a).padStart(2,"0")}-${String(n).padStart(2,"0")}`}function UE(e){let r=Jo(e);return r?`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.month-1]} ${r.year}`:""}function $E(e){let r=Jo(e);return r?`PTO-AUTO-${r.year}-${String(r.month).padStart(2,"0")}-${String(r.day).padStart(2,"0")}`:""}function Zo(){let e=new Date,r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`}function jE(e){let r=String(e!=null?e:"").trim().toLowerCase();return r==="y"||r==="yes"||r==="true"||r==="t"||r==="1"}function HE(e){if(e instanceof Date)return e.getTime();if(typeof e=="number"){let t=VE(e);return t?t.getTime():null}let r=new Date(e);return Number.isNaN(r.getTime())?null:r.getTime()}function VE(e){if(!Number.isFinite(e))return null;let r=new Date(Date.UTC(1899,11,30));return new Date(r.getTime()+e*24*60*60*1e3)}function WE(){let e=t=>{var a,n;return((n=(a=document.getElementById(t))==null?void 0:a.value)==null?void 0:n.trim())||""};[{id:"config-payroll-date",field:_e.payrollDate},{id:"config-accounting-period",field:_e.accountingPeriod},{id:"config-journal-id",field:_e.journalEntryId},{id:"config-company-name",field:_e.companyName},{id:"config-payroll-provider",field:_e.payrollProvider},{id:"config-accounting-link",field:_e.accountingSoftware},{id:"config-user-name",field:_e.reviewerName}].forEach(({id:t,field:a})=>{let n=e(t);a&&Nr(a,n)})}function Tt(e,r=[]){let t=r.map(a=>Ut(a));return e.findIndex(a=>t.some(n=>a.includes(n)))}function GE(e){let r=ti(2),t=!!Ae.permanents[2],a=ei(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(ts(Ae.completes[2])||n),s=Je||{},o=s.reconciliation||{},c=s.coverage||{},l=s.totalPriorLiability||0,f=s.employeeCount||0,d=o.reportLiabilityTotal||0,u=o.calcLiabilityTotal||0,p=o.negativeBalanceTotal||0,m=o.negativeBalanceCount||0,h=o.missingRateCount||0,g=u-l,v=R=>(Number(R)||0).toLocaleString("en-US",{style:"currency",currency:"USD"}),x=`
        <article class="pf-step-card pf-step-detail pf-config-card">
            <div class="pf-config-head">
                <h3>PTO Liability Reconciliation</h3>
                <p class="pf-config-subtext">Report \u2192 Adjustments \u2192 JE Amount</p>
            </div>
            
            ${s.loaded&&f>0?`
            <!-- Liability Reconciliation Section -->
            <div class="pf-liability-recon" style="margin-top: 16px; padding: 16px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.7);">Report Liability (PrismHR)</span>
                    <span style="font-weight: 600; color: #fff;">${v(d)}</span>
                </div>
                
                ${m>0?`
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; padding-left: 20px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">Negative Balances (${m} employees)</span>
                    <span style="color: #f87171; font-size: 13px;">${v(p)}</span>
                </div>
                `:""}
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-top: 2px solid rgba(255,255,255,0.2); margin-top: 4px;">
                    <span style="font-weight: 600; color: #fff;">Calculated Liability</span>
                    <span style="font-weight: 600; color: #fff;">${v(u)}</span>
                </div>
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="color: rgba(255,255,255,0.5);">Prior Period Liability</span>
                    <span style="color: rgba(255,255,255,0.7);">${v(l)}</span>
                </div>
                
                <div class="pf-recon-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-top: 2px solid rgba(255,255,255,0.2); margin-top: 4px;">
                    <span style="font-weight: 600; color: #fff;">Net Change (for JE)</span>
                    <span style="font-weight: 700; font-size: 18px; color: ${g>=0?"#4ade80":"#f87171"};">
                        ${g>=0?"+":""}${v(g)}
                    </span>
                    </div>
                </div>
            
            <!-- Employee Coverage Section -->
            <div class="pf-coverage-section" style="margin-top: 16px; padding: 16px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                <h4 style="margin: 0 0 12px 0; font-size: 14px; color: rgba(255,255,255,0.8);">Employee Coverage</h4>
                
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0;">
                    <span style="color: rgba(255,255,255,0.6);">Roster Headcount:</span>
                    <span style="color: #fff;">${c.rosterCount||0}</span>
                </div>
                
                ${c.inPtoOnlyCount>0?`
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0; padding-left: 20px;">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">+ In PTO only (not on roster):</span>
                    <span style="color: rgba(255,255,255,0.7); font-size: 13px;">+${c.inPtoOnlyCount}</span>
            </div>
                <div style="padding-left: 40px; font-size: 12px; color: rgba(255,255,255,0.4);">
                    (Liability: ${v(c.inPtoOnlyLiability||0)})
                </div>
                `:""}
                
                ${c.inRosterOnlyCount>0?`
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 6px 0; padding-left: 20px;">
                    <span style="color: rgba(255,255,255,0.5); font-size: 13px;">\u2212 On roster, not in PTO:</span>
                    <span style="color: rgba(255,255,255,0.7); font-size: 13px;">\u2212${c.inRosterOnlyCount}</span>
                </div>
                `:""}
                
                <div class="pf-coverage-row" style="display: flex; justify-content: space-between; padding: 8px 0; border-top: 1px solid rgba(255,255,255,0.15); margin-top: 8px;">
                    <span style="font-weight: 600; color: #fff;">PTO Report Headcount:</span>
                    <span style="font-weight: 600; color: #fff;">${f}</span>
                </div>
            </div>
            `:`
            <div style="margin-top: 16px; padding: 20px; text-align: center; color: rgba(255,255,255,0.5);">
                <p>Click "Generate" to calculate liability reconciliation</p>
            </div>
            `}
            
            ${h>0?`
                <div style="margin-top: 12px; padding: 10px; background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 8px; font-size: 13px;">
                    <strong style="color: #fbbf24;">${h}</strong> employee(s) missing pay rate
                </div>
            `:""}
        </article>
    `,I=ls({id:"pto-copilot",heading:"Ada",subtext:"Ask questions about PTO data, liabilities, and insights",welcomeMessage:"What would you like to explore about PTO accruals?",placeholder:"Ask about PTO balances, accrual rates, or liability trends...",quickActions:[{id:"diagnostics",label:"Run Diagnostics",prompt:"Run a diagnostic check on the PTO data. Check for completeness, missing rates, and data quality issues."},{id:"insights",label:"Generate Insights",prompt:"What are the key insights and findings from this PTO accrual analysis?"},{id:"balances",label:"Balance Analysis",prompt:"Analyze PTO balances by employee and department. Highlight any concerning balances."},{id:"accruals",label:"Accrual Trends",prompt:"Show PTO accrual trends and changes from the prior period."}],contextProvider:si({dataClean:"PTO_Data_Clean",analysis:"PTO_Analysis",review:"PTO_Review",config:"SS_PF_Config"}),onPrompt:mu});return`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${be(nn)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${be(e.title)}</h2>
            <p class="pf-hero-copy">${be(e.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Generate Review</h3>
                    <p class="pf-config-subtext">Calculate liabilities, load prior period, and compute variance.</p>
                </div>
                <div class="pf-signoff-action">
                    ${gr(`<button type="button" class="pf-action-toggle pf-clickable" id="review-generate-btn" title="Generate PTO review table">${Bf}</button>`,"Generate")}
                    ${gr(`<button type="button" class="pf-action-toggle pf-clickable" id="review-open-btn" title="Open PTO_Review sheet">${Do}</button>`,"Open Sheet")}
                </div>
            </article>
            ${x}
            ${I}
            ${Za({textareaId:"step-notes-2",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-2",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-2"})}
            ${Qa({reviewerInputId:"step-reviewer-2",reviewerValue:a,signoffInputId:"step-signoff-2",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-2",completeButtonId:"step-signoff-toggle-2"})}
        </section>
    `}function zE(e){let r=ti(3),t=!!Ae.permanents[3],a=ei(r==null?void 0:r.reviewer),n=(r==null?void 0:r.signOffDate)||"",i=!!(ts(Ae.completes[3])||n),s=Qe.lastError?`<p class="pf-step-note">${be(Qe.lastError)}</p>`:"",o=Qe.validationRun,c=Qe.issues||[],l=[{key:"Debits = Credits",desc:"\u2211 Debits = \u2211 Credits"},{key:"Line Amounts Sum to Zero",desc:"\u2211 Line Amount = $0.00"},{key:"JE Matches Analysis Total",desc:"\u2211 JE expense = \u2211 PTO_Analysis Change"}],f=m=>{let h=c.find(y=>y.check===m.key),g=!o,v;return g?v='<span class="pf-je-check-circle pf-je-circle--pending"></span>':h!=null&&h.passed?v=`<span class="pf-je-check-circle pf-je-circle--pass">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </span>`:v=`<span class="pf-je-check-circle pf-je-circle--fail">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </span>`,`
            <div class="pf-je-check-row">
                ${v}
                <span class="pf-je-check-desc-pill">${be(m.desc)}</span>
            </div>
        `},d=l.map(m=>f(m)).join(""),u=c.filter(m=>!m.passed),p="";return o&&u.length>0&&(p=`
            <article class="pf-step-card pf-step-detail pf-je-issues-card">
                <div class="pf-config-head">
                    <h3>\u26A0\uFE0F Issues Identified</h3>
                    <p class="pf-config-subtext">The following checks did not pass:</p>
                </div>
                <ul class="pf-je-issues-list">
                    ${u.map(m=>`<li><strong>${be(m.check)}:</strong> ${be(m.detail)}</li>`).join("")}
                </ul>
            </article>
        `),`
        <section class="pf-hero" id="pf-step-hero">
            <p class="pf-hero-copy">${be(nn)} | Step ${e.id}</p>
            <h2 class="pf-hero-title">${be(e.title)}</h2>
            <p class="pf-hero-copy">${be(e.summary||"")}</p>
        </section>
        <section class="pf-step-guide">
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Generate Journal Entry</h3>
                    <p class="pf-config-subtext">Create a balanced JE from your imported PTO data, grouped by department.</p>
                </div>
                <div class="pf-signoff-action">
                    ${gr(`<button type="button" class="pf-action-toggle pf-clickable" id="je-create-btn" title="Generate journal entry from PTO_Analysis">${Do}</button>`,"Generate")}
                    ${gr(`<button type="button" class="pf-action-toggle pf-clickable" id="je-run-btn" title="Refresh validation checks">${Xi}</button>`,"Refresh")}
                    ${gr(`<button type="button" class="pf-action-toggle pf-clickable" id="je-export-btn" title="Export journal draft as CSV">${Mf}</button>`,"Export")}
                    ${gr(`<button type="button" class="pf-action-toggle pf-clickable" id="je-upload-btn" title="Open accounting software upload">${Mo}</button>`,"Upload")}
                </div>
            </article>
            <article class="pf-step-card pf-step-detail pf-config-card">
                <div class="pf-config-head">
                    <h3>Validation Checks</h3>
                    <p class="pf-config-subtext">These checks run automatically after generating your JE.</p>
                </div>
                ${s}
                <div class="pf-je-checks-container">
                    ${d}
                </div>
            </article>
            ${p}
            ${Za({textareaId:"step-notes-3",value:(r==null?void 0:r.notes)||"",permanentId:"step-notes-lock-3",isPermanent:t,hintId:"",saveButtonId:"step-notes-save-3"})}
            ${Qa({reviewerInputId:"step-reviewer-3",reviewerValue:a,signoffInputId:"step-signoff-3",signoffValue:n,isComplete:i,saveButtonId:"step-signoff-save-3",completeButtonId:"step-signoff-toggle-3"})}
        </section>
    `}function XE(){var r,t;return Math.abs((t=(r=De.roster)==null?void 0:r.difference)!=null?t:0)>0}function YE(){return!De.skipAnalysis&&XE()}async function Jn(){if(!xt()){De.loading=!1,De.lastError="Excel runtime is unavailable.",wt();return}De.loading=!0,De.lastError=null,Gr(document.getElementById("headcount-save-btn"),!1),wt();try{let e=await Excel.run(async r=>{let t=r.workbook.worksheets.getItem("SS_Employee_Roster"),a=r.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(a.load("isNullObject"),await r.sync(),a.isNullObject)return console.warn("[Headcount] PTO_Data_Clean not found"),{rosterEmployees:[],ptoEmployees:[],missingFromPto:[],extraInPto:[]};let n=r.workbook.worksheets.getItemOrNullObject("PTO_Analysis"),i=t.getUsedRangeOrNullObject(),s=a.getUsedRangeOrNullObject();i.load("values"),s.load("values"),n.load("isNullObject"),await r.sync();let o=null;n.isNullObject||(o=n.getUsedRangeOrNullObject(),o.load("values")),await r.sync();let c=i.isNullObject?[]:i.values||[],l=s.isNullObject?[]:s.values||[],f=o&&!o.isNullObject?o.values||[]:[],d=f.length?f:l;return qE(c,d)});De.rosterCount=e.rosterCount,De.ptoCount=e.ptoCount,De.missingFromPto=e.missingFromPto,De.extraInPto=e.extraInPto,De.roster=e.roster,De.hasAnalyzed=!0,De.lastError=null}catch(e){console.warn("PTO headcount: unable to analyze data",e),De.lastError="Unable to analyze headcount data. Try re-running the analysis."}finally{De.loading=!1,wt()}}function ru(e){if(!e)return!0;let r=e.toLowerCase().trim();return r?["total","subtotal","sum","count","grand","average","avg"].some(a=>r.includes(a)):!0}function qE(e,r){let t={rosterCount:0,ptoCount:0,missingFromPto:[],extraInPto:[],roster:{rosterCount:0,payrollCount:0,difference:0,mismatches:[]}};if(((e==null?void 0:e.length)||0)<2||((r==null?void 0:r.length)||0)<2)return console.warn("Headcount: insufficient data rows",{rosterRows:(e==null?void 0:e.length)||0,payrollRows:(r==null?void 0:r.length)||0}),t;let a=au(e),n=au(r),i=a.headers,s=n.headers,o={employee:nu(i),department:i.findIndex(d=>d.includes("department")),status:i.findIndex(d=>d==="employment_status"||d==="status"),termination:i.findIndex(d=>d.includes("termination"))},c={employee:nu(s)};console.log("Headcount column detection:",{rosterEmployeeCol:o.employee,rosterDeptCol:o.department,rosterStatusCol:o.status,rosterTerminationCol:o.termination,payrollEmployeeCol:c.employee,rosterHeaders:i.slice(0,5),payrollHeaders:s.slice(0,5)});let l=new Map;for(let d=a.startIndex;d<e.length;d+=1){let u=e[d],p=o.employee>=0?zr(u[o.employee]):"";if(ru(p))continue;if(o.status>=0){let h=zr(u[o.status]).toLowerCase();if(h==="terminated"||h==="inactive"||h==="term")continue}if(o.termination>=0&&zr(u[o.termination]))continue;let m=p.toLowerCase();l.has(m)||l.set(m,{name:p,department:o.department>=0?zr(u[o.department]):""})}let f=new Map;for(let d=n.startIndex;d<r.length;d+=1){let u=r[d],p=c.employee>=0?zr(u[c.employee]):"";if(ru(p))continue;let m=p.toLowerCase();f.has(m)||f.set(m,{name:p})}return t.rosterCount=l.size,t.ptoCount=f.size,l.forEach((d,u)=>{f.has(u)||t.missingFromPto.push({name:d.name,department:d.department||"\u2014"})}),f.forEach((d,u)=>{l.has(u)||t.extraInPto.push({name:d.name})}),console.log("Headcount results:",{rosterCount:t.rosterCount,ptoCount:t.ptoCount,missingFromPto:t.missingFromPto.length,extraInPto:t.extraInPto.length}),t.roster.rosterCount=t.rosterCount,t.roster.payrollCount=t.ptoCount,t.roster.difference=t.ptoCount-t.rosterCount,t.roster.mismatches=[...t.missingFromPto.map(d=>`In roster, missing in PTO_Data_Clean: ${d.name}`),...t.extraInPto.map(d=>`In PTO_Data_Clean, missing in roster: ${d.name}`)],t}function au(e){if(!Array.isArray(e)||!e.length)return{headers:[],startIndex:1};let r=e.findIndex((n=[])=>n.some(i=>zr(i).toLowerCase().includes("employee"))),t=r===-1?0:r;return{headers:(e[t]||[]).map(n=>zr(n).toLowerCase()),startIndex:t+1}}function nu(e=[]){let r=-1,t=-1;return e.forEach((a,n)=>{let i=a.toLowerCase();if(!i.includes("employee"))return;let s=1;i.includes("name")?s=4:i.includes("id")?s=2:s=3,s>t&&(t=s,r=n)}),r}function zr(e){return e==null?"":String(e).trim()}async function ku(e=null){let r=async t=>{let a=t.workbook.worksheets.getItemOrNullObject("PTO_Data_Clean");if(a.load("isNullObject"),await t.sync(),a.isNullObject){console.warn("[SyncAnalysis] PTO_Data_Clean not found");return}let n=t.workbook.worksheets.getItemOrNullObject("PTO_Analysis"),i=t.workbook.worksheets.getItemOrNullObject("SS_Employee_Roster"),s=t.workbook.worksheets.getItemOrNullObject("PR_Archive_Summary"),o=t.workbook.worksheets.getItemOrNullObject("PTO_Archive_Summary"),c=a.getUsedRangeOrNullObject();c.load("values"),n.load("isNullObject"),i.load("isNullObject"),s.load("isNullObject"),o.load("isNullObject"),await t.sync();let l=c.isNullObject?[]:c.values||[];if(!l.length)return;let f=(l[0]||[]).map(X=>Ut(X)),d=f.findIndex(X=>X.includes("employee")&&X.includes("name")),u=d>=0?d:0,p=Tt(f,["accrual rate"]),m=Tt(f,["carry over","carryover"]),h=f.findIndex(X=>X.includes("ytd")&&(X.includes("accrued")||X.includes("accrual"))),g=f.findIndex(X=>X.includes("ytd")&&X.includes("used")),v=Tt(f,["balance","current balance","pto balance"]);console.log("[PTO Analysis] PTO_Data_Clean headers:",f),console.log("[PTO Analysis] Column indices found:",{employee:u,accrualRate:p,carryOver:m,ytdAccrued:h,ytdUsed:g,balance:v}),g>=0?console.log(`[PTO Analysis] YTD Used column: "${f[g]}" at index ${g}`):console.warn("[PTO Analysis] YTD Used column NOT FOUND. Headers:",f);let y=l.slice(1).map(X=>zr(X[u])).filter(X=>X&&!X.toLowerCase().includes("total")),x=new Map;l.slice(1).forEach(X=>{let M=Ut(X[u]);!M||M.includes("total")||x.set(M,X)});let I=new Map;if(i.isNullObject)console.warn("[PTO Analysis] SS_Employee_Roster sheet not found");else{let X=i.getUsedRangeOrNullObject();X.load("values"),await t.sync();let M=X.isNullObject?[]:X.values||[];if(M.length){let b=(M[0]||[]).map(T=>Ut(T));console.log("[PTO Analysis] SS_Employee_Roster headers:",b);let B=b.findIndex(T=>T.includes("employee")&&T.includes("name"));B<0&&(B=b.findIndex(T=>T==="employee"||T==="name"||T==="full name"));let O=b.findIndex(T=>T==="department_name"||T==="departmentname");if(O<0&&(O=b.findIndex(T=>T.includes("department")&&T.includes("name"))),O<0&&(O=b.findIndex(T=>T.includes("department")&&!T.includes("id")&&!T.includes("code"))),O<0&&(O=b.findIndex(T=>T.includes("department"))),console.log(`[PTO Analysis] Roster column indices - Name: ${B}, Dept: ${O}`),console.log(`[PTO Analysis] Department column header: "${O>=0?b[O]:"NOT FOUND"}"`),B>=0&&O>=0){M.slice(1).forEach(z=>{let ie=Ut(z[B]),ee=zr(z[O]);ie&&I.set(ie,ee)}),console.log(`[PTO Analysis] Built roster map with ${I.size} employees`);let T=Array.from(I.entries()).slice(0,3);console.log("[PTO Analysis] Sample roster entries:",T)}else console.warn("[PTO Analysis] Could not find Name or Department columns in SS_Employee_Roster")}}let R=new Map;if(!s.isNullObject){let X=s.getUsedRangeOrNullObject();X.load("values"),await t.sync();let M=X.isNullObject?[]:X.values||[];if(M.length){let b=(M[0]||[]).map(O=>Ut(O)),B={payrollDate:Tt(b,["payroll date"]),employee:Tt(b,["employee"]),category:Tt(b,["payroll category","category"]),amount:Tt(b,["amount","gross salary","gross_salary","earnings"])};B.employee>=0&&B.category>=0&&B.amount>=0&&M.slice(1).forEach(O=>{let T=Ut(O[B.employee]);if(!T)return;let z=Ut(O[B.category]);if(!z.includes("regular")||!z.includes("earn"))return;let ie=Number(O[B.amount])||0;if(!ie)return;let ee=HE(O[B.payrollDate]),re=R.get(T);(!re||ee!=null&&ee>re.timestamp)&&R.set(T,{payRate:ie/80,timestamp:ee})})}}let P=new Map;if(!o.isNullObject){let X=o.getUsedRangeOrNullObject();X.load("values"),await t.sync();let M=X.isNullObject?[]:X.values||[];if(M.length>1){let b=(M[0]||[]).map(T=>Ut(T)),B=b.findIndex(T=>T.includes("employee")&&T.includes("name")),O=Tt(b,["liability amount","liability","accrued pto"]);B>=0&&O>=0&&M.slice(1).forEach(T=>{let z=Ut(T[B]);if(!z)return;let ie=Number(T[O])||0;P.set(z,ie)})}}let k=$t(_e.payrollDate)||"",D=[],N=[];y.slice(0,3).forEach(X=>{let M=Ut(X),b=I.get(M);console.log(`[PTO Analysis] Lookup: "${X}" \u2192 normalized: "${M}" \u2192 dept: "${b||"NOT FOUND"}"`)});let W=y.map((X,M)=>{var Ue,Ce,he,Ze,jt,Jt,ir;let b=Ut(X),B=I.get(b)||"",O=(Ce=(Ue=R.get(b))==null?void 0:Ue.payRate)!=null?Ce:"",T=x.get(b),z=T&&p>=0&&(he=T[p])!=null?he:"",ie=T&&m>=0&&(Ze=T[m])!=null?Ze:"",ee=T&&h>=0&&(jt=T[h])!=null?jt:"",re=T&&g>=0&&(Jt=T[g])!=null?Jt:"";(b.includes("avalos")||b.includes("sarah"))&&console.log(`[PTO Debug] ${X}:`,{ytdUsedIdx:g,rawValue:T?T[g]:"no dataRow",ytdUsed:re,fullRow:T});let K=T&&v>=0&&Number(T[v])||0,we=M+2;!O&&typeof O!="number"&&D.push({name:X,rowIndex:we}),B||N.push({name:X,rowIndex:we});let F=typeof O=="number"&&K?K*O:0,Me=(ir=P.get(b))!=null?ir:0,Oe=(typeof F=="number"?F:0)-Me;return[k,X,B,O,z,ie,ee,re,K,F,Me,Oe]});yr.missingPayRates=D.filter(X=>!yr.ignoredMissingPayRates.has(X.name)),yr.missingDepartments=N,console.log(`[PTO Analysis] Data quality: ${D.length} missing pay rates, ${N.length} missing departments`);let L=[["Analysis Date","Employee Name","Department","Pay Rate","Accrual Rate","Carry Over","YTD Accrued","YTD Used","Balance","Liability Amount","Accrued PTO $ [Prior Period]","Change"],...W],J=n.isNullObject?t.workbook.worksheets.add("PTO_Analysis"):n,ue=J.getUsedRangeOrNullObject();ue.load("address"),await t.sync(),ue.isNullObject||ue.clear();let te=L[0].length,ne=L.length,Q=W.length,xe=J.getRangeByIndexes(0,0,ne,te);xe.values=L;let se=J.getRangeByIndexes(0,0,1,te);en(se),Q>0&&(Wf(J,0,Q),Yn(J,3,Q),tn(J,4,Q),tn(J,5,Q),tn(J,6,Q),tn(J,7,Q),tn(J,8,Q),Yn(J,9,Q),Yn(J,10,Q),Yn(J,11,Q,!0)),xe.format.autofitColumns(),J.getRange("A1").select(),await t.sync()};xt()&&(e?await r(e):await Excel.run(r))}function KE(e=[]){return e.map(r=>(r||[]).map(t=>{if(t==null)return"";let a=String(t);return/[",\n]/.test(a)?`"${a.replace(/"/g,'""')}"`:a}).join(",")).join(`
`)}function JE(e,r){let t=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=e,document.body.appendChild(n),n.click(),n.remove(),setTimeout(()=>URL.revokeObjectURL(a),1e3)}function iu(){let e=document.getElementById("headcount-signoff-toggle");if(!e)return;let r=YE(),t=document.getElementById("step-notes-input"),a=(t==null?void 0:t.value.trim())||"";e.disabled=r&&!a;let n=document.getElementById("headcount-notes-hint");n&&(n.textContent=r?"Please document outstanding differences before signing off.":"")}function su(){let e=document.getElementById("step-notes-input");if(!e)return;let r=e.value||"",t=r.startsWith(Fa)?r.slice(Fa.length).replace(/^\s+/,""):r.replace(new RegExp(`^${Fa}\\s*`,"i"),"").trimStart(),a=Fa+(t?`
${t}`:"");e.value!==a&&(e.value=a),xr(2,"notes",e.value)}function ZE(){let e=document.getElementById("step-notes-input");e&&e.addEventListener("input",()=>{if(!De.skipAnalysis)return;let r=e.value||"";if(!r.startsWith(Fa)){let t=r.replace(Fa,"").trimStart();e.value=Fa+(t?`
${t}`:"")}xr(2,"notes",e.value)})}})();
/*! Bundled license information:

xlsx/xlsx.mjs:
  (*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com *)

xlsx/xlsx.mjs:
  (*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com *)
*/
//# sourceMappingURL=app.bundle.js.map
